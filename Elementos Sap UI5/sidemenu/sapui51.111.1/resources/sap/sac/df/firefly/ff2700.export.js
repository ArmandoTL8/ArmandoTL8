/*!
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define(["sap/sac/df/firefly/ff0005.language.ext","sap/sac/df/firefly/ff0040.commons","sap/sac/df/firefly/ff0070.structures","sap/sac/df/firefly/ff2650.visualization.impl"],function(e){"use strict";e.ExportHandlerFactory=function(){};e.ExportHandlerFactory.prototype=new e.XObject;e.ExportHandlerFactory.prototype._ff_c="ExportHandlerFactory";e.ExportHandlerFactory.s_driverFactory=null;e.ExportHandlerFactory.create=function(){var t=null;if(e.notNull(e.ExportHandlerFactory.s_driverFactory)){t=e.ExportHandlerFactory.s_driverFactory.newExportHandler()}return t};e.ExportHandlerFactory.registerFactory=function(t){e.ExportHandlerFactory.s_driverFactory=t};e.Appendix=function(){};e.Appendix.prototype=new e.XObjectExt;e.Appendix.prototype._ff_c="Appendix";e.Appendix.create=function(t,o,r,n,i,l,a,p){var s=new e.Appendix;s.m_title=t;s.m_techTitle=o;s.m_tenantTitle=r;s.m_queryTitle=n;s.m_infoProvTitle=i;s.m_modelTitle=l;s.m_createdByTitle=a;s.m_createdOnTitle=p;s.m_techRow=e.PrFactory.createStructure();s.setTechRow();s.m_tenantRow=e.PrFactory.createStructure();s.m_queryRow=e.PrFactory.createStructure();s.m_infoProvRow=e.PrFactory.createStructure();s.m_modelRow=e.PrFactory.createStructure();s.m_createdByRow=e.PrFactory.createStructure();s.m_createdOnRow=e.PrFactory.createStructure();return s};e.Appendix.clearRow=function(t){if(t.size()>0){t.clear()}return t.putNewList(e.Model.TABLE_ROW_CELLS)};e.Appendix.getCells=function(t){return t.getListByKey(e.Model.TABLE_ROW_CELLS)};e.Appendix.getRowSize=function(t){if(e.notNull(t)&&t.size()>0){var o=e.Appendix.getCells(t);if(e.notNull(o)){return o.size()}}return 0};e.Appendix.addRowToTableRows=function(t,o,r){if(e.Appendix.getRowSize(t)>0){var n=e.Appendix.getCells(t);var i=n.size();while(i<r){i=i+1;e.Appendix.padWithEmptyCell(n)}o.add(t)}};e.Appendix.padWithEmptyCell=function(t){e.Appendix.addDataToCellsConditionally(t,"",true)};e.Appendix.addDataToCells=function(t,o){e.Appendix.addDataToCellsConditionally(t,o,false)};e.Appendix.addDataToCellsConditionally=function(t,o,r){if(r&&e.notNull(o)||!e.XStringUtils.isNullOrEmpty(o)){t.addNewStructure().putString(e.Model.FORMATTED_VALUE,o)}};e.Appendix.prototype.m_title=null;e.Appendix.prototype.m_techTitle=null;e.Appendix.prototype.m_tenantTitle=null;e.Appendix.prototype.m_queryTitle=null;e.Appendix.prototype.m_infoProvTitle=null;e.Appendix.prototype.m_modelTitle=null;e.Appendix.prototype.m_createdByTitle=null;e.Appendix.prototype.m_createdOnTitle=null;e.Appendix.prototype.m_techRow=null;e.Appendix.prototype.m_tenantRow=null;e.Appendix.prototype.m_queryRow=null;e.Appendix.prototype.m_infoProvRow=null;e.Appendix.prototype.m_modelRow=null;e.Appendix.prototype.m_createdByRow=null;e.Appendix.prototype.m_createdOnRow=null;e.Appendix.prototype.m_allRows=null;e.Appendix.prototype.getTitle=function(){return this.m_title};e.Appendix.prototype.getAllRows=function(){if(e.isNull(this.m_allRows)){this.m_allRows=e.XList.create();this.m_allRows.add(this.m_techRow);this.m_allRows.add(this.m_tenantRow);this.m_allRows.add(this.m_queryRow);this.m_allRows.add(this.m_infoProvRow);this.m_allRows.add(this.m_modelRow);this.m_allRows.add(this.m_createdByRow);this.m_allRows.add(this.m_createdOnRow)}return this.m_allRows};e.Appendix.prototype.getMaxRowSize=function(){var t=0;var o=this.getAllRows();for(var r=0;r<o.size();r++){t=e.XMath.max(t,e.Appendix.getRowSize(o.get(r)))}return t};e.Appendix.prototype.setTechRow=function(){var t=e.Appendix.clearRow(this.m_techRow);e.Appendix.addDataToCells(t,this.m_techTitle)};e.Appendix.prototype.setTenantData=function(t){if(e.notNull(t)){var o=e.Appendix.clearRow(this.m_tenantRow);e.Appendix.addDataToCells(o,this.m_tenantTitle);e.Appendix.addDataToCells(o,t.getUrlExt(true,false,false,false,false,true,true,false,false))}};e.Appendix.prototype.setQueryData=function(t,o,r){if(e.XStringUtils.isNotNullAndNotEmpty(t)||e.XStringUtils.isNotNullAndNotEmpty(o)){var n=e.XString.lastIndexOf(t,"[")+1;var i=e.XString.lastIndexOf(t,"]");var l=e.XString.substring(t,n,i);var a;if(e.notNull(r)&&r.isTypeOf(e.SystemType.ORCA)){a=e.Appendix.clearRow(this.m_modelRow);e.Appendix.addDataToCells(a,this.m_modelTitle)}else{a=e.Appendix.clearRow(this.m_queryRow);e.Appendix.addDataToCells(a,this.m_queryTitle)}e.Appendix.addDataToCells(a,l);if(!e.XString.isEqual(l,o)){e.Appendix.addDataToCells(a,o)}}};e.Appendix.prototype.setInfoProviderData=function(t,o){if(e.XStringUtils.isNotNullAndNotEmpty(t)||e.XStringUtils.isNotNullAndNotEmpty(o)){var r=e.Appendix.clearRow(this.m_infoProvRow);e.Appendix.addDataToCells(r,this.m_infoProvTitle);e.Appendix.addDataToCells(r,t);if(!e.XString.isEqual(t,o)){e.Appendix.addDataToCells(r,o)}}};e.Appendix.prototype.setCreatedBy=function(t){if(e.XStringUtils.isNotNullAndNotEmpty(t)){var o=e.Appendix.clearRow(this.m_createdByRow);e.Appendix.addDataToCells(o,this.m_createdByTitle);e.Appendix.addDataToCells(o,t)}};e.Appendix.prototype.setCreatedOn=function(t){if(e.notNull(t)){var o=e.Appendix.clearRow(this.m_createdOnRow);e.Appendix.addDataToCells(o,this.m_createdOnTitle);e.Appendix.addDataToCells(o,t.toIsoFormat())}};e.Appendix.prototype.populateTable=function(t){var o=t.getListByKey(e.Model.TABLE_ROWS_KEY);var r=this.getMaxRowSize();var n=t.putNewList(e.Model.COL_WIDTHS_KEY);var i=true;while(n.size()<r){if(i){i=false;n.addDouble(40)}else{n.addDouble(80)}}var l=this.getAllRows();for(var a=0;a<l.size();a++){e.Appendix.addRowToTableRows(l.get(a),o,r)}};e.Appendix.prototype.releaseObject=function(){e.XObjectExt.release(this.m_techRow);e.XObjectExt.release(this.m_tenantRow);e.XObjectExt.release(this.m_queryRow);e.XObjectExt.release(this.m_infoProvRow);e.XObjectExt.release(this.m_modelRow);e.XObjectExt.release(this.m_createdByRow);e.XObjectExt.release(this.m_createdOnRow);e.XObjectExt.release(this.m_allRows);e.XObjectExt.prototype.releaseObject.call(this)};e.BaseExportConfig=function(){};e.BaseExportConfig.prototype=new e.XObjectExt;e.BaseExportConfig.prototype._ff_c="BaseExportConfig";e.BaseExportConfig.CSV_EXPORT="CSV";e.BaseExportConfig.PDF_EXPORT="PDF";e.BaseExportConfig.XLSX_EXPORT="XLSX";e.BaseExportConfig.prototype.root=null;e.BaseExportConfig.prototype.m_fileName="";e.BaseExportConfig.prototype.m_flatten=false;e.BaseExportConfig.prototype.m_includeFormatting=false;e.BaseExportConfig.prototype.m_scope="";e.BaseExportConfig.prototype.m_expandHierarchy=false;e.BaseExportConfig.prototype.m_appendix=null;e.BaseExportConfig.prototype.m_enablePdfAppendix=false;e.BaseExportConfig.prototype.init=function(e){this.root=e};e.BaseExportConfig.prototype.getStructure=function(){return this.root};e.BaseExportConfig.prototype.setFileName=function(e){this.m_fileName=e};e.BaseExportConfig.prototype.getFileName=function(){return this.m_fileName};e.BaseExportConfig.prototype.setScope=function(e){this.m_scope=e};e.BaseExportConfig.prototype.getScope=function(){return this.m_scope};e.BaseExportConfig.prototype.setFlattenHierarchy=function(e){this.m_flatten=e};e.BaseExportConfig.prototype.getFlattenHierarchy=function(){return this.m_flatten};e.BaseExportConfig.prototype.setIncludeFormatting=function(e){this.m_includeFormatting=e};e.BaseExportConfig.prototype.getIncludeFormatting=function(){return this.m_includeFormatting};e.BaseExportConfig.prototype.setExpandHierarchy=function(e){this.m_expandHierarchy=e};e.BaseExportConfig.prototype.getExpandHierarchy=function(){return this.m_expandHierarchy};e.BaseExportConfig.prototype.setEnablePdfAppendix=function(e){this.m_enablePdfAppendix=e};e.BaseExportConfig.prototype.supportsAppendix=function(){return e.XString.isEqual(this.getType(),e.BaseExportConfig.XLSX_EXPORT)||e.XString.isEqual(this.getType(),e.BaseExportConfig.PDF_EXPORT)&&this.m_enablePdfAppendix};e.BaseExportConfig.prototype.includeAppendix=function(){return e.notNull(this.m_appendix)&&this.supportsAppendix()};e.BaseExportConfig.prototype.addAppendix=function(e){this.m_appendix=e};e.BaseExportConfig.prototype.getAppendix=function(){return this.m_appendix};e.BaseExportConfig.prototype.releaseObject=function(){e.XObjectExt.release(this.root);e.XObjectExt.release(this.m_appendix);e.XObjectExt.prototype.releaseObject.call(this)};e.Exporter=function(){};e.Exporter.prototype=new e.XObjectExt;e.Exporter.prototype._ff_c="Exporter";e.Exporter.create=function(){var t=new e.Exporter;t.exportHandler=e.ExportHandlerFactory.create();return t};e.Exporter.prototype.exportHandler=null;e.Exporter.prototype.exportCsv=function(e){this.exportHandler.exportCsv(e)};e.Exporter.prototype.exportXlsx=function(e){this.exportHandler.exportXlsx(e)};e.Exporter.prototype.exportPdf=function(e){this.exportHandler.exportPdf(e)};e.Model=function(){};e.Model.prototype=new e.XObjectExt;e.Model.prototype._ff_c="Model";e.Model.VALUE_KEY="value";e.Model.LINE_COLOR_KEY="lineColor";e.Model.CELL_STYLES_KEY="cellStyles";e.Model.TABLE_ROW_CELLS="cells";e.Model.FORMATTED_VALUE="formattedValue";e.Model.TABLE_ROWS_KEY="rows";e.Model.COL_WIDTHS_KEY="colWidths";e.Model.TABLE_TITLE_KEY="title";e.Model.MODEL_TABLES_KEY="tables";e.Model.PADDING_MIDDLE_KEY="middle";e.Model.PADDING_BOTTOM_KEY="bottom";e.Model.PADDING_TOP_KEY="top";e.Model.PADDING_CENTER_KEY="center";e.Model.XLSX_FORMAT_KEY="xlFormat";e.Model.TOTAL_WIDTH_KEY="totalWidth";e.Model.TOTAL_HEIGHT_KEY="totalHeight";e.Model.NUM_COLS_KEY="numCols";e.Model.PADDING_KEY="padding";e.Model.FONT_COLOR_KEY="fontColor";e.Model.LINE_SIZE_KEY="lineSize";e.Model.PADDING_LEFT_KEY="left";e.Model.PADDING_RIGHT_KEY="right";e.Model.STYLE_KEY="style";e.Model.FONT_WEIGHT_KEY="fontWeight";e.Model.HIER_PAD_RIGHT_KEY="hierPadRight";e.Model.HIER_PAD_LEFT_KEY="hierPadLeft";e.Model.HIER_PAD_TOP_KEY="hierPadTop";e.Model.FILE_NAME_KEY="fileName";e.Model.XLSX_CONF_KEY="xlsx";e.Model.CSV_CONF_KEY="csv";e.Model.PDF_CONF_KEY="pdf";e.Model.HOR_ALIGN_KEY="horAlign";e.Model.VERT_ALIGN_KEY="vertAlign";e.Model.NUM_HEADER_COLS="numHeaderCols";e.Model.NUM_HEADER_ROWS="numHeaderRows";e.Model.create=function(){var t=new e.Model;t.root=e.PrFactory.createStructure();t.setupModel();return t};e.Model.convertToMm=function(e){return e*.26458333};e.Model.parseColor=function(t,o){var r=e.XString.containsString(o,"rgba")?"rgba(":"rgb(";var n=e.XString.replace(o,r,"");var i=e.XString.replace(n,")","");var l=e.XStringTokenizer.splitString(i,",");t.putInteger("r",e.XInteger.convertFromString(l.get(0)));t.putInteger("g",e.XInteger.convertFromString(l.get(1)));t.putInteger("b",e.XInteger.convertFromString(l.get(2)))};e.Model.addRowsToModel=function(t,o,r,n,i,l,a){var p=e.XLinkedHashMapByString.create();for(var s=0;s<l.size();s++){var d=l.get(s);var _=i.addNewStructure();_.putDouble("height",e.Model.convertToMm(d.getHeight()));var u=_.putNewList(e.Model.TABLE_ROW_CELLS);var E=d.getCells();for(var g=0;g<E.size();g++){var f=E.get(g);var c=u.addNewStructure();var T=f.getFormatted();c.putString(e.Model.FORMATTED_VALUE,e.isNull(T)?"":T);if(f.getPlain()!==null&&f.getPlain().getValueType().isNumber()){c.putDouble(e.Model.VALUE_KEY,e.XValueUtil.getDouble(f.getPlain(),false,true))}c.putBoolean("rowHeaderCell",f.getType()===e.SacTableConstants.CT_ROW_DIM_HEADER);var y=f.getTableStyle();var C=e.PrFactory.createStructure();var M=f.getFormattingPattern();var A=-1;if(e.XStringUtils.isNotNullAndNotEmpty(M)&&e.XString.isEqual(o.getType(),e.BaseExportConfig.XLSX_EXPORT)){if(!p.containsKey(M)){A=o.addNumberFormat(M);p.put(M,e.XIntegerValue.create(A))}else{A=p.getByKey(M).getInteger()}C.putInteger(e.Model.XLSX_FORMAT_KEY,A)}if(e.notNull(y)&&y.getStyledLineBottom()!==null){e.Model.parseColor(C.putNewStructure(e.Model.LINE_COLOR_KEY),y.getStyledLineBottom().getColor());C.putDouble(e.Model.LINE_SIZE_KEY,.26458333);var S=C.putNewStructure(e.Model.PADDING_KEY);S.putDouble(e.Model.PADDING_RIGHT_KEY,1.06);S.putDouble(e.Model.PADDING_LEFT_KEY,1.06);S.putDouble(e.Model.PADDING_BOTTOM_KEY,1.06);S.putDouble(e.Model.PADDING_TOP_KEY,1.06);if(f.getHierarchyPaddingType()!==null){S.putDouble(e.Model.convertHierPadding(f.getHierarchyPaddingType()),e.Model.convertToMm(f.getHierarchyPaddingValue()))}var x=C.toString();if(!r.containsKey(x)){var m=n.size();r.put(x,e.XIntegerValue.create(m));n.add(C);c.putInteger(e.Model.STYLE_KEY,m)}else{var R=r.getByKey(x);c.putInteger(e.Model.STYLE_KEY,R.getInteger())}}}}};e.Model.setAlignments=function(t,o){var r=e.SacTableConstants.HA_LEFT;var n=e.SacTableConstants.VA_MIDDLE;if(e.notNull(t)){var i=t.getStructureByKey(e.SacTableConstants.ST_M_ALIGNMENT);if(e.notNull(i)){r=i.getIntegerByKey(e.SacTableConstants.STAL_N_HORIZONTAL);n=i.getIntegerByKey(e.SacTableConstants.STAL_N_VERTICAL)}}o.putString(e.Model.HOR_ALIGN_KEY,e.Model.getHorAlignment(r));o.putString(e.Model.VERT_ALIGN_KEY,e.Model.getVertAlignment(n))};e.Model.getHorAlignment=function(t){if(t===e.SacTableConstants.HA_CENTER){return e.Model.PADDING_CENTER_KEY}else if(t===e.SacTableConstants.HA_LEFT){return e.Model.PADDING_LEFT_KEY}else if(t===e.SacTableConstants.HA_RIGHT){return e.Model.PADDING_RIGHT_KEY}else{return e.Model.PADDING_CENTER_KEY}};e.Model.getVertAlignment=function(t){if(t===e.SacTableConstants.VA_TOP){return e.Model.PADDING_TOP_KEY}else if(t===e.SacTableConstants.VA_BOTTOM){return e.Model.PADDING_BOTTOM_KEY}else if(t===e.SacTableConstants.VA_MIDDLE){return e.Model.PADDING_MIDDLE_KEY}else{return e.Model.PADDING_MIDDLE_KEY}};e.Model.convertHierPadding=function(t){if(e.XString.isEqual(e.SacTableConstants.C_N_HIERARCHY_PADDING_LEFT,t)||e.XString.isEqual(e.SacTableConstants.C_N_HIERARCHY_PADDING_TOP,t)){return e.Model.HIER_PAD_LEFT_KEY}return e.Model.HIER_PAD_RIGHT_KEY};e.Model.prototype.root=null;e.Model.prototype.csvConf=null;e.Model.prototype.pdfConf=null;e.Model.prototype.xlsConf=null;e.Model.prototype.m_headerColumnsCellTypes=null;e.Model.prototype.m_headerRowsCellTypes=null;e.Model.prototype.asStructure=function(){return this.root};e.Model.prototype.setupModel=function(){var t=e.XList.create();t.add(e.XIntegerValue.create(e.SacTableConstants.CT_COL_DIM_HEADER));t.add(e.XIntegerValue.create(e.SacTableConstants.CT_COL_DIM_MEMBER));t.add(e.XIntegerValue.create(e.SacTableConstants.CT_ATTRIBUTE_COL_DIM_HEADER));t.add(e.XIntegerValue.create(e.SacTableConstants.CT_ATTRIBUTE_COL_DIM_MEMBER));t.add(e.XIntegerValue.create(e.SacTableConstants.CT_ROW_DIM_HEADER));t.add(e.XIntegerValue.create(e.SacTableConstants.CT_ATTRIBUTE_ROW_DIM_HEADER));this.m_headerRowsCellTypes=t;var o=e.XList.create();o.add(e.XIntegerValue.create(e.SacTableConstants.CT_ROW_DIM_HEADER));o.add(e.XIntegerValue.create(e.SacTableConstants.CT_ROW_DIM_MEMBER));o.add(e.XIntegerValue.create(e.SacTableConstants.CT_ATTRIBUTE_ROW_DIM_HEADER));o.add(e.XIntegerValue.create(e.SacTableConstants.CT_ATTRIBUTE_ROW_DIM_MEMBER));this.m_headerColumnsCellTypes=o};e.Model.prototype.setFileName=function(t){this.root.putString(e.Model.FILE_NAME_KEY,t)};e.Model.prototype.getFileName=function(){return this.root.getStringByKey(e.Model.FILE_NAME_KEY)};e.Model.prototype.setConfig=function(t){if(e.XString.isEqual(e.BaseExportConfig.CSV_EXPORT,t.getType())){this.root.put(e.Model.CSV_CONF_KEY,t.getStructure())}else if(e.XString.isEqual(e.BaseExportConfig.PDF_EXPORT,t.getType())){this.root.put(e.Model.PDF_CONF_KEY,t.getStructure())}else if(e.XString.isEqual(e.BaseExportConfig.XLSX_EXPORT,t.getType())){this.getXlsxConfigs().add(t.getStructure())}};e.Model.prototype.getXlsxConfigs=function(){var t;if(!this.root.containsKey(e.Model.XLSX_CONF_KEY)){t=this.root.putNewList(e.Model.XLSX_CONF_KEY)}else{t=this.root.getListByKey(e.Model.XLSX_CONF_KEY)}return t};e.Model.prototype.addTable=function(t){var o;if(!this.root.containsKey(e.Model.MODEL_TABLES_KEY)){o=this.root.putNewList(e.Model.MODEL_TABLES_KEY)}else{o=this.root.getListByKey(e.Model.MODEL_TABLES_KEY)}var r=o.addNewStructure();r.putNewList(e.Model.TABLE_ROWS_KEY);r.putString(e.Model.TABLE_TITLE_KEY,t);return r};e.Model.prototype.releaseObject=function(){e.XObjectExt.release(this.root);e.XObjectExt.release(this.csvConf);e.XObjectExt.release(this.pdfConf);e.XObjectExt.release(this.xlsConf);e.XObjectExt.prototype.releaseObject.call(this)};e.Model.prototype.toString=function(){return this.root.toString()};e.Model.prototype.parseTableJson=function(t,o){var r=o.getStructureByKey(e.Model.TABLE_TITLE_KEY).getStringByKey("titleText");this.setFileName(t.getFileName());this.setConfig(t);var n=this.addTable(r);if(t.supportsAppendix()&&t.getAppendix()!==null){var i=this.addTable(t.getAppendix().getTitle());t.getAppendix().populateTable(i)}var l=o.getListByKey("columnSettings");n.putInteger(e.Model.NUM_COLS_KEY,l.size());n.putDouble(e.Model.TOTAL_HEIGHT_KEY,e.Model.convertToMm(o.getIntegerByKey(e.Model.TOTAL_HEIGHT_KEY)));n.putDouble(e.Model.TOTAL_WIDTH_KEY,e.Model.convertToMm(o.getIntegerByKey(e.Model.TOTAL_WIDTH_KEY)));var a=o.getIntegerByKey("dataRegionCornerRow");var p=o.getIntegerByKey("dataRegionCornerCol");var s=e.XList.create();var d=e.XList.create();var _=n.putNewList(e.Model.COL_WIDTHS_KEY);for(var u=0;u<l.size();u++){var E=l.getStructureAt(u);_.addDouble(e.Model.convertToMm(E.getIntegerByKey("width")))}var g=e.XHashMapByString.create();var f=n.putNewList(e.Model.CELL_STYLES_KEY);var c=e.XLinkedHashMapByString.create();var T=n.getListByKey(e.Model.TABLE_ROWS_KEY);var y=o.getListByKey(e.Model.TABLE_ROWS_KEY);for(var C=0;C<y.size();C++){var M=y.getStructureAt(C);var A=T.addNewStructure();A.putDouble("height",e.Model.convertToMm(M.getIntegerByKey("height")));var S=A.putNewList(e.Model.TABLE_ROW_CELLS);var x=M.getListByKey(e.Model.TABLE_ROW_CELLS);for(var m=0;m<x.size();m++){var R=x.getStructureAt(m);var D=S.addNewStructure();var I=R.getStringByKey("formatted");D.putString(e.Model.FORMATTED_VALUE,e.isNull(I)?"":I);if(R.containsKey("plain")&&!R.hasStringByKey("plain")){D.putDouble(e.Model.VALUE_KEY,R.getDoubleByKey("plain"))}var L=R.getIntegerByKey("cellType");var N=L===e.SacTableConstants.CT_VALUE;var O=this.m_headerRowsCellTypes.contains(e.XIntegerValue.create(L));var P=this.m_headerColumnsCellTypes.contains(e.XIntegerValue.create(L));if(O&&!d.contains(e.XIntegerValue.create(C))){d.add(e.XIntegerValue.create(C))}if(P&&!s.contains(e.XIntegerValue.create(m))){s.add(e.XIntegerValue.create(m))}var h=R.getStructureByKey(e.Model.STYLE_KEY);var K=e.PrFactory.createStructure();var v=R.getStringByKey(e.SacTableConstants.C_S_FORMAT_STRING);var X=-1;if(e.XStringUtils.isNotNullAndNotEmpty(v)&&e.XString.isEqual(t.getType(),e.BaseExportConfig.XLSX_EXPORT)){if(!c.containsKey(v)&&e.XString.isEqual(t.getType(),e.BaseExportConfig.XLSX_EXPORT)){X=t.addNumberFormat(v);c.put(v,e.XIntegerValue.create(X))}else{X=c.getByKey(v).getInteger()}K.putInteger(e.Model.XLSX_FORMAT_KEY,X)}if(e.notNull(h)){var B=K.putNewStructure(e.Model.FONT_COLOR_KEY);if(N){e.Model.parseColor(B,"rgb(153,153,153)")}else{e.Model.parseColor(B,"rgb(51,51,51)")}e.Model.setAlignments(h,K);if(h.containsKey("font")){var F=h.getStructureByKey("font");if(F.containsKey("bold")&&F.getBooleanByKey("bold")===true){K.putInteger(e.Model.FONT_WEIGHT_KEY,700)}}if(C<=a&&m<=p&&!K.hasStringByKey(e.Model.FONT_WEIGHT_KEY)){K.putInteger(e.Model.FONT_WEIGHT_KEY,700)}var Y=e.PrFactory.createStructure();if(R.containsKey(e.SacTableConstants.C_N_HIERARCHY_PADDING_LEFT)){var w=R.getIntegerByKey(e.SacTableConstants.C_N_HIERARCHY_PADDING_LEFT);Y.putDouble(e.Model.HIER_PAD_LEFT_KEY,e.Model.convertToMm(w))}if(R.containsKey(e.SacTableConstants.C_N_HIERARCHY_PADDING_TOP)){var b=R.getIntegerByKey(e.SacTableConstants.C_N_HIERARCHY_PADDING_TOP);Y.putDouble(e.Model.HIER_PAD_TOP_KEY,e.Model.convertToMm(b))}if(h.containsKey("lines")){var H=h.getListByKey("lines").getStructureAt(0);e.Model.parseColor(K.putNewStructure(e.Model.LINE_COLOR_KEY),H.getStringByKey("color"));K.putDouble(e.Model.LINE_SIZE_KEY,e.Model.convertToMm(H.getIntegerByKey("size")));var G=H.getStructureByKey(e.Model.PADDING_KEY);Y.putDouble(e.Model.PADDING_RIGHT_KEY,e.Model.convertToMm(G.getIntegerByKey(e.Model.PADDING_RIGHT_KEY)));Y.putDouble(e.Model.PADDING_LEFT_KEY,e.Model.convertToMm(G.getIntegerByKey(e.Model.PADDING_LEFT_KEY)))}if(Y.hasElements()){K.put(e.Model.PADDING_KEY,Y)}var V=K.toString();if(!g.containsKey(V)){var z=f.size();g.put(V,e.XIntegerValue.create(z));f.add(K);D.putInteger(e.Model.STYLE_KEY,z)}else{var U=g.getByKey(V);D.putInteger(e.Model.STYLE_KEY,U.getInteger())}}}}n.putInteger(e.Model.NUM_HEADER_COLS,s.size());n.putInteger(e.Model.NUM_HEADER_ROWS,d.size())};e.Model.prototype.processTable=function(t,o){this.setFileName(t.getFileName());this.setConfig(t);var r=this.addTable(o.getTitle()===null?"DefaultTitle":o.getTitle());r.putInteger(e.Model.NUM_COLS_KEY,o.getColumnList().size());r.putDouble(e.Model.TOTAL_HEIGHT_KEY,e.Model.convertToMm(o.getHeight()));r.putDouble(e.Model.TOTAL_WIDTH_KEY,e.Model.convertToMm(o.getWidth()));var n=r.putNewList(e.Model.COL_WIDTHS_KEY);for(var i=0;i<o.getColumnList().size();i++){n.addDouble(e.Model.convertToMm(o.getColumnWidth(i)))}var l=e.XHashMapByString.create();var a=r.putNewList(e.Model.CELL_STYLES_KEY);var p=r.getListByKey(e.Model.TABLE_ROWS_KEY);e.Model.addRowsToModel(this,t,l,a,p,o.getHeaderRowList(),0);e.Model.addRowsToModel(this,t,l,a,p,o.getRowList(),o.getHeaderRowList().size()-1)};e.CsvConfig=function(){};e.CsvConfig.prototype=new e.BaseExportConfig;e.CsvConfig.prototype._ff_c="CsvConfig";e.CsvConfig.CSV_DEFAULT_DELIM=",";e.CsvConfig.CSV_DELIM_KEY="delimiter";e.CsvConfig.createDefault=function(t,o){var r=new e.CsvConfig;r.init(t);r.setDelimiter(e.CsvConfig.CSV_DEFAULT_DELIM);r.setFileName(o);return r};e.CsvConfig.wrap=function(t){var o=new e.CsvConfig;o.init(t);return o};e.CsvConfig.prototype.getType=function(){return e.BaseExportConfig.CSV_EXPORT};e.CsvConfig.prototype.setDelimiter=function(t){this.root.putString(e.CsvConfig.CSV_DELIM_KEY,t)};e.PdfConfig=function(){};e.PdfConfig.prototype=new e.BaseExportConfig;e.PdfConfig.prototype._ff_c="PdfConfig";e.PdfConfig.PDF_PAGE_SIZE_KEY="pageSize";e.PdfConfig.PDF_BUILTIN_FONT_KEY="builtInFont";e.PdfConfig.PDF_FONT_SIZE="fontSize";e.PdfConfig.PDF_AUTO_SIZE_KEY="autoSize";e.PdfConfig.PDF_FREEZE_ROWS_KEY="freezeRows";e.PdfConfig.PDF_PAGE_ORIENT_KEY="orientation";e.PdfConfig.PDF_PAGE_NUM_LOC_KEY="pageNumberLocation";e.PdfConfig.PDF_ORIENT_LANDSCAPE="landscape";e.PdfConfig.PDF_ORIENT_PORTRAIT="portrait";e.PdfConfig.createDefault=function(t,o){var r=new e.PdfConfig;r.setFileName(o);r.init(t);r.setOrientation(e.PdfConfig.PDF_ORIENT_LANDSCAPE);r.setPageSize("a4");r.setBuiltInFont("Helvetica");r.setAutoSize(true);r.setFontSize(6);return r};e.PdfConfig.wrap=function(t){var o=new e.PdfConfig;o.init(t);return o};e.PdfConfig.prototype.getType=function(){return e.BaseExportConfig.PDF_EXPORT};e.PdfConfig.prototype.setFontSize=function(t){this.root.putDouble(e.PdfConfig.PDF_FONT_SIZE,t)};e.PdfConfig.prototype.setOrientation=function(t){this.root.putString(e.PdfConfig.PDF_PAGE_ORIENT_KEY,t)};e.PdfConfig.prototype.getOrientation=function(){return this.root.getStringByKey(e.PdfConfig.PDF_PAGE_ORIENT_KEY)};e.PdfConfig.prototype.setPageSize=function(t){this.root.putString(e.PdfConfig.PDF_PAGE_SIZE_KEY,e.XString.toLowerCase(t))};e.PdfConfig.prototype.setBuiltInFont=function(t){this.root.putString(e.PdfConfig.PDF_BUILTIN_FONT_KEY,t)};e.PdfConfig.prototype.setAutoSize=function(t){this.root.putBoolean(e.PdfConfig.PDF_AUTO_SIZE_KEY,t)};e.PdfConfig.prototype.getAutoSize=function(){return this.root.getBooleanByKey(e.PdfConfig.PDF_AUTO_SIZE_KEY)};e.PdfConfig.prototype.setFreezeRows=function(t){this.root.putInteger(e.PdfConfig.PDF_FREEZE_ROWS_KEY,t)};e.PdfConfig.prototype.getFreezeRows=function(){return this.root.getIntegerByKey(e.PdfConfig.PDF_FREEZE_ROWS_KEY)};e.PdfConfig.prototype.setNumberLocation=function(t){this.root.putString(e.PdfConfig.PDF_PAGE_NUM_LOC_KEY,t)};e.PdfConfig.prototype.getNumberLocation=function(){return this.root.getStringByKey(e.PdfConfig.PDF_PAGE_NUM_LOC_KEY)};e.XlsConfig=function(){};e.XlsConfig.prototype=new e.BaseExportConfig;e.XlsConfig.prototype._ff_c="XlsConfig";e.XlsConfig.XLSX_AUTO_FILTER="autoFilter";e.XlsConfig.XLSX_NUMBER_FORMATS="numberFormats";e.XlsConfig.createDefault=function(t,o){var r=new e.XlsConfig;r.init(t);r.setAutoFilterActive(true);r.setFileName(o);return r};e.XlsConfig.wrap=function(t){var o=new e.XlsConfig;o.init(t);return o};e.XlsConfig.prototype.setAutoFilterActive=function(t){this.root.putBoolean(e.XlsConfig.XLSX_AUTO_FILTER,t)};e.XlsConfig.prototype.getType=function(){return e.BaseExportConfig.XLSX_EXPORT};e.XlsConfig.prototype.getNumberFormats=function(){if(this.root.containsKey(e.XlsConfig.XLSX_NUMBER_FORMATS)){return this.root.getListByKey(e.XlsConfig.XLSX_NUMBER_FORMATS)}return this.root.putNewList(e.XlsConfig.XLSX_NUMBER_FORMATS)};e.XlsConfig.prototype.addNumberFormat=function(e){var t=this.getNumberFormats();var o=t.size();this.getNumberFormats().addString(e);return o};e.ExportModule=function(){};e.ExportModule.prototype=new e.DfModule;e.ExportModule.prototype._ff_c="ExportModule";e.ExportModule.s_module=null;e.ExportModule.getInstance=function(){if(e.isNull(e.ExportModule.s_module)){e.DfModule.checkInitialized(e.LanguageExtModule.getInstance());e.DfModule.checkInitialized(e.CommonsModule.getInstance());e.DfModule.checkInitialized(e.VisualizationImplModule.getInstance());e.ExportModule.s_module=e.DfModule.startExt(new e.ExportModule);e.DfModule.stopExt(e.ExportModule.s_module)}return e.ExportModule.s_module};e.ExportModule.prototype.getName=function(){return"ff2700.export"};e.ExportModule.getInstance();return sap.firefly});
//# sourceMappingURL=ff2700.export.js.map