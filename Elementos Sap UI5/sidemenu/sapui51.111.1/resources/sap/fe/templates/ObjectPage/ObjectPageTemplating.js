/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/macros/CommonHelper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/internal/form/FormTemplating","sap/m/library","sap/ui/base/ManagedObject","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,o,i,a,r,s,l,u,c){"use strict";var d={};var f=s.getLabelForConnectedFields;var g=r.formatValueRecursively;var v=r.addTextArrangementToBindingExpression;var p=i.enhanceDataModelPath;var m=n.resolveBindingString;var b=n.or;var E=n.isEmpty;var T=n.ifElse;var $=n.getExpressionFromAnnotation;var y=n.constant;var h=n.concat;var A=n.compileExpression;var S=n.and;var C=t.UI;var D=t.Entity;var O=t.Draft;const F=l.ButtonType;const x=function(t,n,o,i){var a,r,s,l;const u=e.getTranslatedText("T_NEW_OBJECT",n.resourceBundle,undefined,n.entitySet);const c=e.getTranslatedText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE",n.resourceBundle,undefined,n.entitySet);const d=(t===null||t===void 0?void 0:t.Title)===undefined||(t===null||t===void 0?void 0:t.Title)===""||(t===null||t===void 0?void 0:(a=t.Title)===null||a===void 0?void 0:a.Value)==="";const b=!d?e.getTranslatedText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE_NO_HEADER_INFO",n.resourceBundle):"";let O,F,x=y(true),I;if((t===null||t===void 0?void 0:(r=t.Title)===null||r===void 0?void 0:r.$Type)==="com.sap.vocabularies.UI.v1.DataField"){var P,B,V,N,_,M,w,H,G,U,j;O=$(t===null||t===void 0?void 0:(P=t.Title)===null||P===void 0?void 0:P.Value);if(t!==null&&t!==void 0&&(B=t.Title)!==null&&B!==void 0&&(V=B.Value)!==null&&V!==void 0&&(N=V.$target)!==null&&N!==void 0&&(_=N.annotations)!==null&&_!==void 0&&(M=_.Common)!==null&&M!==void 0&&(w=M.Text)!==null&&w!==void 0&&(H=w.annotations)!==null&&H!==void 0&&(G=H.UI)!==null&&G!==void 0&&G.TextArrangement){O=v(O,o)}O=g(O,o);x=((U=O)===null||U===void 0?void 0:U._type)==="Constant"?y(!((j=O)!==null&&j!==void 0&&j.value)):E(O)}else if((t===null||t===void 0?void 0:(s=t.Title)===null||s===void 0?void 0:s.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&(t===null||t===void 0?void 0:(l=t.Title)===null||l===void 0?void 0:l.Target.$target.$Type)==="com.sap.vocabularies.UI.v1.ConnectedFieldsType"){var R,L;F=p(o,"$Type/@UI.HeaderInfo/Title/Target/$AnnotationPath");O=f(F,false);I=((R=O)===null||R===void 0?void 0:R._type)==="Constant"?y(!((L=O)!==null&&L!==void 0&&L.value)):E(O);x=O?I:y(true)}const Q=t!==null&&t!==void 0&&t.TypeName?h(c,": ",m(t.TypeName.toString())):u;const k=i?D.IsActive:true;return A(T(S(C.IsCreateMode,x),Q,T(S(k,x),b,O)))};d.getExpressionForTitle=x;const I=function(e,t){var n,o,i,a,r,s,l,u,c;let d=$(e===null||e===void 0?void 0:(n=e.Description)===null||n===void 0?void 0:n.Value);if(e!==null&&e!==void 0&&(o=e.Description)!==null&&o!==void 0&&(i=o.Value)!==null&&i!==void 0&&(a=i.$target)!==null&&a!==void 0&&(r=a.annotations)!==null&&r!==void 0&&(s=r.Common)!==null&&s!==void 0&&(l=s.Text)!==null&&l!==void 0&&(u=l.annotations)!==null&&u!==void 0&&(c=u.UI)!==null&&c!==void 0&&c.TextArrangement){d=v(d,t)}return A(g(d,t))};d.getExpressionForDescription=I;const P=function(t,n){var o;const i=e.getTranslatedText("T_OP_OBJECT_PAGE_SAVE",t.resourceBundle);const a=e.getTranslatedText("T_OP_OBJECT_PAGE_CREATE",t.resourceBundle);let r;if((o=n.startingEntitySet.annotations.Session)!==null&&o!==void 0&&o.StickySessionSupported){r=T(C.IsCreateMode,a,i)}else{r=T(O.IsNewObject,a,i)}return A(r)};d.getExpressionForSaveButton=P;const B=function(e,t){const n=e.filter(e=>N(e));let o;if(n.length){const e=n.map(e=>m(e.visible,"boolean"));o=b(...e);const i=V(t,true);return A(b(o,m(i,"boolean")))}return V(t,true)};d.getFooterVisible=B;const V=function(e,t){let n="";let o;const i=[];for(const t in e){const n=e[t];if(n.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&n.Determining===true){const e=n[`@${"com.sap.vocabularies.UI.v1.Hidden"}`];if(!e){return true}else if(e.$Path){if(i.indexOf(e.$Path)===-1){i.push(e.$Path)}}}}if(i.length){for(let e=0;e<i.length;e++){if(i[e]){o="(%{"+i[e]+"} === true ? false : true )"}if(e==i.length-1){n=n+o}else{n=n+o+"||"}}return"{= "+(t?"(":"")+n+(t?" || ${ui>/isEditable}) ":" ")+"&& ${internal>isCreateDialogOpen} !== true}"}else{return"{= "+(t?"${ui>/isEditable} && ":"")+"${internal>isCreateDialogOpen} !== true}"}};d.getDataFieldBasedFooterVisibility=V;const N=function(e){const t=["Primary","DefaultApply","Secondary","ForAction","ForNavigation","SwitchToActiveObject","SwitchToDraftObject","DraftActions","Copy"];return t.indexOf(e.type)<0};d.isManifestAction=N;const _=function(e){if(!e){return F.Emphasized}let t;let n,o,i="";e.forEach(function(e){const a=e.Criticality;const r=e["@com.sap.vocabularies.UI.v1.Hidden"];if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&!n&&a){if(!t&&r===true){t=F.Emphasized;return}if(r&&r.$Path){o=r.$Path;if(i){i=i+" && "}i=i+"%{"+o+"} === true";t="{= ("+i+") ? 'Emphasized' : 'Default' }"}switch(a.$EnumMember){case"com.sap.vocabularies.UI.v1.CriticalityType/Negative":case"com.sap.vocabularies.UI.v1.CriticalityType/Positive":case"1":case 1:case"3":case 3:if(!r){t=F.Default;n=true}t=t||F.Default;break;default:t=F.Emphasized}if(a.$Path){const e=i?"!("+i+") && ":"";t="{= "+e+"((${"+a.$Path+"} === 'com.sap.vocabularies.UI.v1.CriticalityType/Negative') || (${"+a.$Path+"} === '1') || (${"+a.$Path+"} === 1) "+"|| (${"+a.$Path+"} === 'com.sap.vocabularies.UI.v1.CriticalityType/Positive') || (${"+a.$Path+"} === '3') || (${"+a.$Path+"} === 3)) ? "+"'Default'"+" : "+"'Emphasized'"+" }"}}});return t||F.Emphasized};d.buildEmphasizedButtonExpression=_;const M=function(e){const t=c.getNavigationPath(e);if(t){return"{path:'"+t+"'}"}else{return"{path: ''}"}};d.getElementBinding=M;const w=function(e){if(e["@com.sap.vocabularies.Common.v1.DraftRoot"]&&e["@com.sap.vocabularies.Common.v1.DraftRoot"]["EditAction"]){return true}else{return false}};d.checkDraftState=w;const H=function(e){if(w(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( ${ui>/isEditable} && !${ui>createMode} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};d.getSwitchToActiveVisibility=H;const G=function(e){if(w(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( !(${ui>/isEditable}) && !${ui>createMode} && ${HasDraftEntity} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};d.getSwitchToDraftVisibility=G;const U=function(e){if(w(e)){return"{= (%{DraftAdministrativeData/DraftIsCreatedByMe}) ? ( !${ui>createMode} && %{DraftAdministrativeData/DraftIsCreatedByMe} ) : false }"}else{return false}};d.getSwitchDraftAndActiveVisibility=U;const j=function(e,t){let n;if(e&&e.length){n=e.find(function(e){return e.type===t})}return n};d._findAction=j;const R=function(e){const t=j(e,"Secondary");return t?t.enabled:"true"};d.getDeleteCommandExecutionEnabled=R;const L=function(e){const t=j(e,"Secondary");return t?t.visible:"true"};d.getDeleteCommandExecutionVisible=L;const Q=function(e){const t=j(e,"Primary");return t?t.visible:"false"};d.getEditCommandExecutionVisible=Q;const k=function(e){const t=j(e,"Primary");return t?t.enabled:"false"};d.getEditCommandExecutionEnabled=k;const J=function(e){const t=e.getPath();const n=t.split("/");const o="/"+n[1];const i=e.getObject(o+"@");const a=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftRoot");const r=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftNode");const s=i.hasOwnProperty("@com.sap.vocabularies.Session.v1.StickySessionSupported");let l;if(a){l=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftRoot/EditAction`)}else if(r){l=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftNode/EditAction`)}else if(s){l=e.getObject(`${o}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`)}return!l?l:`${o}/${l}`};d.getEditAction=J;const z=function(e,t){let n,o,i;if(e&&e["@Org.OData.Core.V1.Computed"]){n=e["@Org.OData.Core.V1.Computed"].Bool?e["@Org.OData.Core.V1.Computed"].Bool=="true":true}if(e&&e["@Org.OData.Core.V1.Immutable"]){o=e["@Org.OData.Core.V1.Immutable"].Bool?e["@Org.OData.Core.V1.Immutable"].Bool=="true":true}i=n||o;if(t){i=i||t=="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"}if(i){return true}else{return false}};d.isReadOnlyFromStaticAnnotations=z;const W=function(e){let t;if(e){if(u.bindingParser(e)){t="%"+e+" === 1 "}}if(t){return"{= "+t+"? false : true }"}else{return undefined}};d.readOnlyExpressionFromDynamicAnnotations=W;const q=function(e,t,n){if(e){if(e["targetOutbound"]&&e["targetOutbound"]["outbound"]||e["targetOutbound"]&&e["targetOutbound"]["outbound"]&&e["targetSections"]){return".handlers.onDataPointTitlePressed($controller, ${$source>/},'"+JSON.stringify(t)+"','"+e["targetOutbound"]["outbound"]+"','"+n+"' )"}else if(e["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(e["targetSections"])+"')"}else{return undefined}}};d.getExpressionForMicroChartTitlePress=q;const K=function(e){if(e&&(e["targetOutbound"]||e["targetOutbound"]&&e["targetSections"])){return"External"}else if(e&&e["targetSections"]){return"InPage"}else{return"None"}};d.getMicroChartTitleAsLink=K;const X=function(e,t,n){const o=e[t],i=["Heroes","Decoration","Workers","LongRunners"];let a=n;if(o&&o.requestGroupId&&i.some(function(e){return e===o.requestGroupId})){a="$auto."+o.requestGroupId}return a};d.getGroupIdFromConfig=X;const Y=function(e,t){const n=X(e,t);let o;if(n){o="{ path : '', parameters : { $$groupId : '"+n+"' } }"}return o};d.getBindingWithGroupIdFromConfig=Y;const Z=function(e){return e&&e.length===1&&!!e[0].isValueMultilineText};d.doesFieldGroupContainOnlyOneMultiLineDataField=Z;const ee=function(e){return e.showBreadCrumbs&&e.fclEnabled!==undefined?"{fclhelper>/breadCrumbIsVisible}":e.showBreadCrumbs};d.getVisibleExpressionForBreadcrumbs=ee;const te=function(e){let t="!${ui>createMode}";if(e.fclEnabled){t="${fclhelper>/showShareIcon} && "+t}return"{= "+t+" }"};d.getShareButtonVisibility=te;const ne=function(e,t,n,o){const i=e?z(e,n):true;const a=W(n);if(!i&&!a){return true}const r=t?z(t,o):true;const s=W(o);if(!r&&!s){return true}if(i&&r&&!a&&!s){return false}if(a&&!s){return a}else if(!a&&s){return s}else{return oe(n,o)}};d.getVisiblityOfHeaderInfo=ne;const oe=function(e,t){return"{= %"+e+" === 1 ? ( %"+t+" === 1 ? false : true ) : true }"};d.combineTitleAndDescriptionExpression=oe;const ie=function(e,t){const n="${$view>/getBindingContext}",i="${$view>/#fe::ObjectPage/getHeaderTitle/getExpandedHeading/getItems/1/getText}",r="${$view>/#fe::ObjectPage/getHeaderTitle/getExpandedContent/0/getItems/0/getText}";const s=t&&t.context;const l=s.getPath();const u=l.split("/").filter(o.filterOutNavPropBinding);const c=u.length>1?s.getModel().getObject(`/${u.join("/")}@sapui.name`):u[0];const d={title:i,entitySetName:a.addSingleQuotes(c),description:r};return a.generateFunction(".editFlow.deleteDocument",n,a.objectToString(d))};ie.requiresIContext=true;d.getPressExpressionForDelete=ie;const ae=function(e,t,n){const o=a.addSingleQuotes(e&&e.Action),i=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],r=i==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const s={contexts:"${$view>/getBindingContext}",entitySetName:a.addSingleQuotes(t),invocationGrouping:a.addSingleQuotes(r),model:"${$source>/}.getModel()",label:a.addSingleQuotes(e&&e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return a.generateFunction(".handlers.onCallAction","${$view>/}",o,a.objectToString(s))};d.getPressExpressionForEdit=ae;const re=function(e,t,n){const o=a.addSingleQuotes(e&&e.Action),i=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],r=i==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const s={contexts:"${$view>/#fe::ObjectPage/}.getBindingContext()",entitySetName:a.addSingleQuotes(t),invocationGrouping:a.addSingleQuotes(r),model:"${$source>/}.getModel()",label:a.addSingleQuotes(e&&e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return a.generateFunction(".handlers.onCallAction","${$view>/}",o,a.objectToString(s))};d.getPressExpressionForFooterAnnotationAction=re;const se=function(e,t,n,o,i,r,s){const l=a.addSingleQuotes(e&&e.Action),u=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],c=u==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const d={contexts:"${$view>/#fe::ObjectPage/}.getBindingContext()",entitySetName:t?a.addSingleQuotes(t):"",invocationGrouping:a.addSingleQuotes(c),model:"${$source>/}.getModel()",label:a.addSingleQuotes(e===null||e===void 0?void 0:e.Label,true),isNavigable:n===null||n===void 0?void 0:n.isNavigable,defaultValuesExtensionFunction:n!==null&&n!==void 0&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};const f={positiveActionVisible:o,positiveActionEnabled:i,editActionVisible:r,editActionEnabled:s};return a.generateFunction(".handlers.onPrimaryAction","$controller","${$view>/}","${$view>/getBindingContext}",l,a.objectToString(d),a.objectToString(f))};d.getPressExpressionForPrimaryAction=se;const le=function(e,t){if(t&&t.Facet&&t.Facet.targetAnnotationType==="DataPoint"){return Y(e,t.Facet.targetAnnotationValue)}};d.getStashableHBoxBinding=le;const ue=function(e,t){if(e){if(e["targetOutbound"]&&e["targetOutbound"]["outbound"]){return".handlers.onDataPointTitlePressed($controller, ${$source>}, "+JSON.stringify(t)+","+JSON.stringify(e["targetOutbound"]["outbound"])+")"}else if(e["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(e["targetSections"])+"')"}else{return undefined}}};d.getPressExpressionForLink=ue;const ce=function(e){var t;if((e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:t.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return undefined}return"Bare"};d.getHeaderFormHboxRenderType=ce;function de(e,t,n,o){if(t.defaultAction){try{switch(t.defaultAction.type){case"ForAction":{return ae(n,o,t.defaultAction)}case"ForNavigation":{if(t.defaultAction.command){return"cmd:"+t.defaultAction.command}else{return t.defaultAction.press}}default:{if(t.defaultAction.command){return"cmd:"+t.defaultAction.command}if(t.defaultAction.noWrap){return t.defaultAction.press}else{return a.buildActionWrapper(t.defaultAction,{id:"forTheObjectPage"})}}}}catch(e){return"binding for the default action is not working as expected"}}return undefined}d.getDefaultActionHandler=de;return d},false);
//# sourceMappingURL=ObjectPageTemplating.js.map