/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/ID","sap/fe/core/ExtensionAPI","sap/fe/core/helpers/ClassSupport","sap/ui/core/InvisibleMessage","sap/ui/core/library","sap/ui/core/message/Message"],function(e,t,n,s,i,r,o,a){"use strict";var c,g;var p=o.MessageType;var u=o.InvisibleMessageMode;var l=i.defineUI5Class;var d=n.getSideContentLayoutID;function f(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;y(e,t)}function y(e,t){y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return y(e,t)}let h=(c=l("sap.fe.templates.ObjectPage.ExtensionAPI"),c(g=function(n){f(s,n);function s(){return n.apply(this,arguments)||this}var i=s.prototype;i.refresh=function e(n){const s=this._view.getBindingContext();if(!s){return Promise.resolve()}const i=t.getAppComponent(this._view),r=i.getSideEffectsService(),o=s.getModel().getMetaModel(),a={TargetProperties:[],TargetEntities:[]};let c,g,p,u;if(n===undefined||n===null){a.TargetEntities.push({$NavigationPropertyPath:""})}else{c=Array.isArray(n)?n:[n];p=this._controller.getOwnerComponent().getEntitySet();for(let e=0;e<c.length;e++){g=c[e];if(g===""){a.TargetProperties.push({$PropertyPath:"*"})}else{u=o.getObject(`/${p}/${g}/$kind`);if(u==="NavigationProperty"){a.TargetEntities.push({$NavigationPropertyPath:g})}else if(u){a.TargetProperties.push({$PropertyPath:g})}else{return Promise.reject(`${g} is not a valid path to be refreshed`)}}}}return r.requestSideEffects(a.TargetEntities.concat(a.TargetProperties),s)};i.getSelectedContexts=function e(t){let n=this._view.byId(t);if(n&&n.isA("sap.fe.macros.table.TableAPI")){n=n.getContent()}return n&&n.isA("sap.ui.mdc.Table")&&n.getSelectedContexts()||[]};i.showSideContent=function e(t,n){const s=d(t),i=this._view.byId(s),r=n===undefined?!i.getShowSideContent():n;i.setShowSideContent(r,false)};i.getBindingContext=function e(){return this._view.getBindingContext()};i._buildOPMessage=async function e(t){const n=this._view;const s=await n.getModel("sap.fe.i18n").getResourceBundle();let i=null;switch(t.length){case 0:break;case 1:i=t[0];break;default:const e={Error:{id:2,count:0},Warning:{id:1,count:0},Information:{id:0,count:0}};i=t.reduce((t,n)=>{const s=n.getType();t.setType(e[s].id>e[t.getType()].id?s:t.getType());e[s].count++;return t},new a({type:p.Information}));if(e.Error.count===0&&e.Warning.count===0&&e.Information.count>0){i.setMessage(s.getText("OBJECTPAGESTATE_INFORMATION"))}else if(e.Error.count>0&&e.Warning.count>0||e.Information.count>0){i.setMessage(s.getText("OBJECTPAGESTATE_ISSUE"))}else{i.setMessage(s.getText(i.getType()===p.Error?"OBJECTPAGESTATE_ERROR":"OBJECTPAGESTATE_WARNING"))}}return i};i.showMessages=async function t(n){const s=this._view;const i=s.getBindingContext("internal");try{const e=await this._buildOPMessage(n);if(e){i===null||i===void 0?void 0:i.setProperty("OPMessageStripVisibility",true);i===null||i===void 0?void 0:i.setProperty("OPMessageStripText",e.getMessage());i===null||i===void 0?void 0:i.setProperty("OPMessageStripType",e.getType());r.getInstance().announce(e.getMessage(),u.Assertive)}else{this.hideMessage()}}catch(t){e.error("Cannot display ObjectPage message")}};i.hideMessage=function e(){const t=this._view;const n=t.getBindingContext("internal");n===null||n===void 0?void 0:n.setProperty("OPMessageStripVisibility",false)};return s}(s))||g);return h},false);
//# sourceMappingURL=ExtensionAPI.js.map