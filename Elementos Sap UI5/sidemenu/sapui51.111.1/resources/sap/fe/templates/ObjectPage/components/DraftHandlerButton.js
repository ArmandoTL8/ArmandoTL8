/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ClassSupport","sap/fe/templates/ObjectPage/ObjectPageTemplating","sap/m/Button","sap/m/ResponsivePopover","sap/m/SelectList","sap/ui/core/InvisibleText","sap/ui/core/Item","sap/fe/core/jsx-runtime/jsx","sap/fe/core/jsx-runtime/jsxs","sap/fe/core/jsx-runtime/Fragment"],function(e,t,i,r,n,o,a,c,l,s,p,f,u,d){"use strict";var v,_,T,h,b,A,g,O,w,m,C;var E={};var S=o.getSwitchDraftAndActiveVisibility;var y=n.defineReference;var I=r.pathInModel;var D=r.not;var P=r.ifElse;var B=r.and;var R=i.UI;var j=i.Entity;var x=e.defineBuildingBlock;var H=e.BuildingBlockBase;var V=e.blockAttribute;function z(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function K(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function M(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;F(e,t)}function F(e,t){F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return F(e,t)}function N(e,t,i,r,n){var o={};Object.keys(r).forEach(function(e){o[e]=r[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},o);if(n&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(n):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function W(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let Y=(v=x({name:"DraftHandlerButton",namespace:"sap.fe.templates.ObjectPage.components",isRuntime:true}),_=V({type:"string"}),T=V({type:"sap.ui.model.Context"}),h=y(),b=y(),v(A=(g=function(e){M(i,e);function i(i){var r;r=e.call(this,i)||this;r.SWITCH_TO_DRAFT_KEY="switchToDraft";r.SWITCH_TO_ACTIVE_KEY="switchToActive";z(r,"id",O,K(r));z(r,"contextPath",w,K(r));z(r,"switchToActiveRef",m,K(r));z(r,"switchToDraftRef",C,K(r));r.initialSelectedKey=r.SWITCH_TO_ACTIVE_KEY;r.handleSelectedItemChange=e=>{const t=e.getParameter("item").getProperty("key");if(t!==r.initialSelectedKey){r._containingView.getController().editFlow.toggleDraftActive(r._containingView.getBindingContext())}if(r.popover){r.popover.close();r.popover.destroy();delete r.popover}};r.openSwitchActivePopover=e=>{const i=e.getSource();const n=t.getTargetView(i);const o=n.getBindingContext();const a=o.getObject().IsActiveEntity;r.initialSelectedKey=a?r.SWITCH_TO_ACTIVE_KEY:r.SWITCH_TO_DRAFT_KEY;r.popover=r.createPopover();r._containingView=n;n.addDependent(r.popover);r.popover.openBy(i);r.popover.attachEventOnce("afterOpen",()=>{if(a){var e;(e=r.switchToDraftRef.current)===null||e===void 0?void 0:e.focus()}else{var t;(t=r.switchToActiveRef.current)===null||t===void 0?void 0:t.focus()}});return r.popover};return r}E=i;var r=i.prototype;r.createPopover=function e(){return f(c,{showHeader:false,contentWidth:"15.625rem",verticalScrolling:false,class:"sapUiNoContentPadding",placement:"Bottom",children:u(l,{selectedKey:this.initialSelectedKey,itemPress:this.handleSelectedItemChange,children:[f(p,{text:"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_DISPLAY_DRAFT_MIT}",ref:this.switchToDraftRef},this.SWITCH_TO_DRAFT_KEY),f(p,{text:"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_DISPLAY_SAVED_VERSION_MIT}",ref:this.switchToActiveRef},this.SWITCH_TO_ACTIVE_KEY)]})})};r.getContent=function e(){const t=P(B(D(R.IsEditable),D(R.IsCreateMode),j.HasDraft),I("C_COMMON_OBJECT_PAGE_SAVED_VERSION_BUT","sap.fe.i18n"),I("C_COMMON_OBJECT_PAGE_DRAFT_BUT","sap.fe.i18n"));const i=S(this.contextPath.getObject("@"));return u(d,{children:[f(a,{id:"fe::StandardAction::SwitchDraftAndActiveObject",text:t,visible:i,icon:"sap-icon://navigation-down-arrow",iconFirst:false,type:"Transparent",press:this.openSwitchActivePopover,ariaDescribedBy:["fe::StandardAction::SwitchDraftAndActiveObject::AriaTextDraftSwitcher"]}),f(s,{text:"{sap.fe.i18n>T_HEADER_DATAPOINT_TITLE_DRAFT_SWITCHER_ARIA_BUTTON}",id:"fe::StandardAction::SwitchDraftAndActiveObject::AriaTextDraftSwitcher"})]})};return i}(H),O=N(g.prototype,"id",[_],{configurable:true,enumerable:true,writable:true,initializer:null}),w=N(g.prototype,"contextPath",[T],{configurable:true,enumerable:true,writable:true,initializer:null}),m=N(g.prototype,"switchToActiveRef",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),C=N(g.prototype,"switchToDraftRef",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),g))||A);E=Y;return E},false);
//# sourceMappingURL=DraftHandlerButton.js.map