/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/merge","sap/fe/core/ActionRuntime","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/fe/core/controllerextensions/collaboration/Manage","sap/fe/core/controllerextensions/editFlow/draft","sap/fe/core/controllerextensions/IntentBasedNavigation","sap/fe/core/controllerextensions/InternalIntentBasedNavigation","sap/fe/core/controllerextensions/InternalRouting","sap/fe/core/controllerextensions/MassEdit","sap/fe/core/controllerextensions/MessageHandler","sap/fe/core/controllerextensions/PageReady","sap/fe/core/controllerextensions/Paginator","sap/fe/core/controllerextensions/Placeholder","sap/fe/core/controllerextensions/Share","sap/fe/core/controllerextensions/ViewState","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/ModelHelper","sap/fe/core/PageController","sap/fe/macros/CommonHelper","sap/fe/macros/DelegateUtil","sap/fe/macros/table/Utils","sap/fe/navigation/SelectionVariant","sap/fe/templates/ObjectPage/ExtensionAPI","sap/fe/templates/TableScroller","sap/m/InstanceManager","sap/m/Link","sap/m/MessageBox","sap/ui/core/Core","sap/ui/core/mvc/OverrideExecution","sap/ui/model/odata/v4/ODataListBinding","./overrides/IntentBasedNavigation","./overrides/InternalRouting","./overrides/MessageHandler","./overrides/Paginator","./overrides/Share","./overrides/ViewState"],function(t,e,n,i,o,s,a,r,c,l,g,u,d,f,h,p,b,m,C,y,w,S,v,P,x,E,A,B,_,I,M,V,O,D,F,T,R,j,k){"use strict";var L,N,z,$,H,U,G,q,J,K,W,Q,X,Y,Z,tt,et,nt,it,ot,st,at,rt,ct,lt,gt,ut;var dt=C.usingExtension;var ft=C.publicExtension;var ht=C.finalExtension;var pt=C.extensible;var bt=C.defineUI5Class;var mt=a.showUserDetails;var Ct=a.openManageDialog;var yt=s.isConnected;var wt=s.disconnect;var St=s.connect;function vt(t,e,n,i){if(!n)return;Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function Pt(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function xt(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;Et(t,e)}function Et(t,e){Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,n){e.__proto__=n;return e};return Et(t,e)}function At(t,e,n,i,o){var s={};Object.keys(i).forEach(function(t){s[t]=i[t]});s.enumerable=!!s.enumerable;s.configurable=!!s.configurable;if("value"in s||s.initializer){s.writable=true}s=n.slice().reverse().reduce(function(n,i){return i(t,e,n)||n},s);if(o&&s.initializer!==void 0){s.value=s.initializer?s.initializer.call(o):void 0;s.initializer=undefined}if(s.initializer===void 0){Object.defineProperty(t,e,s);s=null}return s}function Bt(t,e){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let _t=(L=bt("sap.fe.templates.ObjectPage.ObjectPageController"),N=dt(p),z=dt(b.override(j)),$=dt(g.override(F)),H=dt(h.override(R)),U=dt(d.override(T)),G=dt(c.override(D)),q=dt(l.override({getNavigationMode:function(){const t=this.getView().getController().getStickyEditMode&&this.getView().getController().getStickyEditMode();return t?"explace":undefined}})),J=dt(m.override(k)),K=dt(f.override({isContextExpected:function(){return true}})),W=dt(u),Q=ft(),X=ht(),Y=ft(),Z=pt(V.After),L(tt=(et=function(s){xt(a,s);function a(){var e;for(var n=arguments.length,o=new Array(n),a=0;a<n;a++){o[a]=arguments[a]}e=s.call(this,...o)||this;vt(e,"placeholder",nt,Pt(e));vt(e,"share",it,Pt(e));vt(e,"_routing",ot,Pt(e));vt(e,"paginator",st,Pt(e));vt(e,"messageHandler",at,Pt(e));vt(e,"intentBasedNavigation",rt,Pt(e));vt(e,"_intentBasedNavigation",ct,Pt(e));vt(e,"viewState",lt,Pt(e));vt(e,"pageReady",gt,Pt(e));vt(e,"massEdit",ut,Pt(e));e.handlers={onPrimaryAction(t,e,n,i,o,s){const a=t.getView().getViewData().viewLevel,r=t._getObjectPageLayoutControl();if(s.positiveActionVisible){if(s.positiveActionEnabled){t.handlers.onCallAction(e,i,o)}}else if(s.editActionVisible){if(s.editActionEnabled){t._editDocument(n)}}else if(a===1&&r.getModel("ui").getProperty("/isEditable")){t._saveDocument(n)}else if(r.getModel("ui").getProperty("/isEditable")){t._applyDocument(n)}},onTableContextChange(e){const n=e.getSource();let i;this._findTables().some(function(t){if(t.getRowBinding()===n){i=t;return true}return false});const o=this._editFlow.getCurrentActionPromise();if(o){let e;if(i.getType().getMetadata().isA("sap.ui.mdc.table.GridTableType")){e=n.getContexts(0)}else{e=n.getCurrentContexts()}if(!e[0]){return}o.then(t=>{if(!t||t.controlId!==i.sId){return}const n=t.oData;const o=t.keys;let s=-1;e.find(function(t,e){const i=t.getObject();const a=o.every(function(t){return i[t]===n[t]});if(a){s=e}return a});if(s!==-1){const t=B.getOpenDialogs();const e=t.length>0?t.find(t=>t.data("FullScreenDialog")!==true):null;if(e){e.attachEventOnce("afterClose",function(){i.focusRow(s,true)})}else{i.focusRow(s,true)}this._editFlow.deleteCurrentActionPromise()}}).catch(function(e){t.error(`An error occurs while scrolling to the newly created Item: ${e}`)})}this.messageButton.fireModelContextChange()},onCallAction(t,e,n){const i=t.getController();return i.editFlow.invokeAction(e,n).then(i._showMessagePopover.bind(i,undefined)).catch(i._showMessagePopover.bind(i))},onDataPointTitlePressed(t,e,n,o,s){n=typeof n==="string"?JSON.parse(n):n;const a=n[o],r=i.getSemanticObjectMapping(a),c=e.getBindingContext(),l=c.getModel().getMetaModel().getMetaPath(c.getPath());let g=t._getChartContextData(c,s);let u;g=g.map(function(t){return{data:t,metaPath:l+(s?`/${s}`:"")}});if(a&&a.parameters){const e=a.parameters&&t._intentBasedNavigation.getOutboundParams(a.parameters);if(Object.keys(e).length>0){u=e}}if(a&&a.semanticObject&&a.action){t._intentBasedNavigation.navigate(a.semanticObject,a.action,{navigationContexts:g,semanticObjectMapping:r,additionalNavigationParameters:u})}},onChevronPressNavigateOutBound(t,e,n,i){return t._intentBasedNavigation.onChevronPressNavigateOutBound(t,e,n,i)},onNavigateChange(t){this.getExtensionAPI().updateAppState();this.bSectionNavigated=true;const e=this.getView().getBindingContext("internal");const n=this._getObjectPageLayoutControl();if(n.getModel("ui").getProperty("/isEditable")&&this.getView().getViewData().sectionLayout==="Tabs"&&e.getProperty("errorNavigationSectionFlag")===false){const e=t.getParameter("subSection");this._updateFocusInEditMode([e])}},onVariantSelected:function(){this.getExtensionAPI().updateAppState()},onVariantSaved:function(){setTimeout(()=>{this.getExtensionAPI().updateAppState()},500)},navigateToSubSection:function(e,n){const o=typeof n==="string"?JSON.parse(n):n;const s=e.getView().byId("fe::ObjectPage");let a;let r;if(o.sectionId){a=e.getView().byId(o.sectionId);r=o.subSectionId?e.getView().byId(o.subSectionId):a&&a.getSubSections()&&a.getSubSections()[0]}else if(o.subSectionId){r=e.getView().byId(o.subSectionId);a=r&&r.getParent()}if(!a||!r||!a.getVisible()||!r.getVisible()){e.getView().getModel("sap.fe.i18n").getResourceBundle().then(function(n){const o=i.getTranslatedText("C_ROUTING_NAVIGATION_DISABLED_TITLE",n,undefined,e.getView().getViewData().entitySet);t.error(o);I.error(o)}).catch(function(e){t.error(e)})}else{s.scrollToSection(r.getId());s.fireNavigate({section:a,subSection:r})}},onStateChange(){this.getExtensionAPI().updateAppState()},closeOPMessageStrip:function(){this.getExtensionAPI().hideMessage()}};return e}var c=a.prototype;c.getExtensionAPI=function t(e){if(e){this.mCustomSectionExtensionAPIs=this.mCustomSectionExtensionAPIs||{};if(!this.mCustomSectionExtensionAPIs[e]){this.mCustomSectionExtensionAPIs[e]=new E(this,e)}return this.mCustomSectionExtensionAPIs[e]}else{if(!this.extensionAPI){this.extensionAPI=new E(this)}return this.extensionAPI}};c.onInit=function t(){s.prototype.onInit.call(this);const e=this._getObjectPageLayoutControl();const n=this.getView().getBindingContext("internal");n===null||n===void 0?void 0:n.setProperty("externalNavigationContext",{page:true});n===null||n===void 0?void 0:n.setProperty("relatedApps",{visibility:false,items:null});n===null||n===void 0?void 0:n.setProperty("batchGroups",this._getBatchGroupsForView());n===null||n===void 0?void 0:n.setProperty("errorNavigationSectionFlag",false);if(!this.getView().getViewData().useNewLazyLoading&&e.getEnableLazyLoading()){e.attachEvent("subSectionEnteredViewPort",this._handleSubSectionEnteredViewPort.bind(this))}this.messageButton=this.getView().byId("fe::FooterBar::MessageButton");this.messageButton.oItemBinding.attachChange(this._fnShowOPMessage,this);n===null||n===void 0?void 0:n.setProperty("rootEditEnabled",true);n===null||n===void 0?void 0:n.setProperty("rootEditVisible",true)};c.onExit=function t(){if(this.mCustomSectionExtensionAPIs){for(const t of Object.keys(this.mCustomSectionExtensionAPIs)){if(this.mCustomSectionExtensionAPIs[t]){this.mCustomSectionExtensionAPIs[t].destroy()}}delete this.mCustomSectionExtensionAPIs}if(this.extensionAPI){this.extensionAPI.destroy()}delete this.extensionAPI;const e=this.messageButton?this.messageButton.oMessagePopover:null;if(e&&e.isOpen()){e.close()}const n=this.getView().getBindingContext();if(n&&n.isKeepAlive()){n.setKeepAlive(false)}if(yt(this.getView())){wt(this.getView())}};c._fnShowOPMessage=function t(){const e=this.getExtensionAPI();const n=this.getView();const i=this.messageButton.oMessagePopover.getItems().map(t=>t.getBindingContext("message").getObject()).filter(t=>{var e;return t.getTargets()[0]===((e=n.getBindingContext())===null||e===void 0?void 0:e.getPath())});if(e){e.showMessages(i)}};c._getTableBinding=function t(e){return e&&e.getRowBinding()};c.onBeforeRendering=function t(){var e;w.prototype.onBeforeRendering.apply(this);if((e=this.oView.oViewData)!==null&&e!==void 0&&e.retrieveTextFromValueList&&S.getMetaModel()===undefined){S.setMetaModel(this.getAppComponent().getMetaModel())}};c.onAfterRendering=function e(){this.getView().getModel("sap.fe.i18n").getResourceBundle().then(t=>{this.oResourceBundle=t}).catch(function(e){t.error("Error while retrieving the resource bundle",e)})};c._onBeforeBinding=function t(e,n){const i=this._findTables(),o=this._getObjectPageLayoutControl(),s=this.getView().getBindingContext("internal"),a=this.getView().getModel("internal"),r=s.getProperty("batchGroups"),c=this.getView().getViewData().viewLevel;let l;r.push("$auto");if(n.bDraftNavigation!==true){this._closeSideContent()}const g=o.getBindingContext();if(g&&g.hasPendingChanges()&&!r.some(g.getModel().hasPendingChanges.bind(g.getModel()))){g.getBinding().resetChanges()}for(let t=0;t<i.length;t++){l=i[t].getCreationRow();if(l){l.setBindingContext(null)}}const u=function(){if(!o.isFirstRendering()&&!n.bPersistOPScroll){o.setSelectedSection(null)}};o.attachEventOnce("modelContextChange",u);const d={onAfterRendering:u};o.addEventDelegate(d,this);this.pageReady.attachEventOnce("pageReady",function(){o.removeEventDelegate(d)});if(c>1){let t=n&&n.listBinding;const i=a.getProperty("/paginatorCurrentContext");if(i){const t=i.getBinding();this.paginator.initialize(t,i);a.setProperty("/paginatorCurrentContext",null)}else if(t){if(t.isA("sap.ui.model.odata.v4.ODataListBinding")){this.paginator.initialize(t,e)}else{const n=t.getPath();if(/\([^\)]*\)$/.test(n)){const i=n.replace(/\([^\)]*\)$/,"");t=new O(t.oModel,i);const o=()=>{if(t.getContexts().length>0){this.paginator.initialize(t,e);t.detachEvent("change",o)}};t.getContexts(0);t.attachEvent("change",o)}else{this.paginator.initialize(undefined)}}}}if(!this.getView().getViewData().useNewLazyLoading&&o.getEnableLazyLoading()){const t=o.getSections();const e=o.getUseIconTabBar();let n=2;const i=o.getModel("ui").getProperty("/isEditable");const s=this.getView().getViewData().editableHeaderContent;for(let o=0;o<t.length;o++){const a=t[o];const r=a.getSubSections();for(let t=0;t<r.length;t++,n--){if(n<1||e&&(o>1||o===1&&!s&&!i)){const e=r[t];if(e.data().isVisibilityDynamic!=="true"){e.setBindingContext(null)}}}}}if(this.placeholder.isPlaceholderEnabled()&&n.showPlaceholder){const t=this.getView();const e=t.getParent().oContainer.getParent();if(e){e.showPlaceholder({})}}};c._getFirstClickableElement=function t(e){let n;const i=e.getHeaderTitle()&&e.getHeaderTitle().getActions();if(i&&i.length){n=i.find(function(t){if(t.isA("sap.fe.macros.ShareAPI")){return t.getVisible()}else if(!t.isA("sap.ui.core.InvisibleText")&&!t.isA("sap.m.ToolbarSpacer")){return t.getVisible()&&t.getEnabled()}})}return n};c._getFirstEmptyMandatoryFieldFromSubSection=function e(n){if(n){for(let e=0;e<n.length;e++){const i=n[e].getBlocks();if(i){for(let e=0;e<i.length;e++){let n;if(i[e].isA("sap.ui.layout.form.Form")){n=i[e].getFormContainers()}else if(i[e].getContent&&i[e].getContent()&&i[e].getContent().isA("sap.ui.layout.form.Form")){n=i[e].getContent().getFormContainers()}if(n){for(let e=0;e<n.length;e++){const i=n[e].getFormElements();if(i){for(let e=0;e<i.length;e++){const n=i[e].getFields();try{if(n[0].getRequired&&n[0].getRequired()&&!n[0].getValue()){return n[0]}}catch(e){t.debug(`Error when searching for mandaotry empty field: ${e}`)}}}}}}}}}return undefined};c._updateFocusInEditMode=function t(e){const n=this._getObjectPageLayoutControl();const i=this._getFirstEmptyMandatoryFieldFromSubSection(e);let o;if(i){o=i.content.getContentEdit()[0]}else{o=n._getFirstEditableInput()||this._getFirstClickableElement(n)}if(o){setTimeout(function(){o.focus()},0)}};c._handleSubSectionEnteredViewPort=function t(e){const n=e.getParameter("subSection");n.setBindingContext(undefined)};c._onBackNavigationInDraft=function t(e){this.messageHandler.removeTransitionMessages();if(this.getAppComponent().getRouterProxy().checkIfBackHasSameContext()){history.back()}else{r.processDataLossOrDraftDiscardConfirmation(function(){history.back()},Function.prototype,e,this,false,r.NavigationType.BackNavigation)}};c._onAfterBinding=function e(o,s){const a=this._getObjectPageLayoutControl();const r=this._findTables();this._sideEffects.clearFieldGroupsValidity();o=a.getBindingContext();let c=[];a.getSections().forEach(function(t){t.getSubSections().forEach(function(t){c=i.getIBNActions(t,c)})});r.forEach(function(t){const e=t.getBindingContext("internal");e.setProperty("creationRowFieldValidity",{});e.setProperty("creationRowCustomValidity",{});c=i.getIBNActions(t,c);const o=t.getRowBinding();if(o){if(y.isStickySessionSupported(o.getModel().getMetaModel())){o.removeCachesAndMessages("")}}const s=JSON.parse(S.parseCustomData(v.getCustomData(t,"operationAvailableMap"))),a=t.getSelectedContexts();n.setActionEnablement(e,s,a,"table");t.clearSelection()});i.getSemanticTargetsFromPageModel(this,"_pageModel");const l=a.getHeaderTitle();let g=[];g=i.getIBNActions(l,g);c=c.concat(g);i.updateDataFieldForIBNButtonsVisibility(c,this.getView());let u,d;async function f(e,n){const i=e.getCreationRow();let o,s;if(i){try{await d;if(i.getModel("ui").getProperty("/isEditable")){o=u.bindList(n.getPath(),n.getContext(),[],[],{$$updateGroupId:"doNotSubmit",$$groupId:"doNotSubmit"});o.refreshInternal=function(){};s=o.create();i.setBindingContext(s);try{await s.created()}catch(e){t.trace("transient fast creation context deleted")}}}catch(e){t.error("Error while computing the final UI state",e)}}}const h=e=>{const n=this._getTableBinding(e),i=function(){f(e,n)};if(!n){t.error(`Expected binding missing for table: ${e.getId()}`);return}if(n.oContext){i()}else{const t=function(){if(n.oContext){i();n.detachChange(t)}};n.attachChange(t)}};if(o){u=o.getModel();d=this._editFlow.computeEditMode(o);if(y.isCollaborationDraftSupported(u.getMetaModel())){d.then(()=>{if(this.getView().getModel("ui").getProperty("/isEditable")){St(this.getView())}else if(yt(this.getView())){wt(this.getView())}}).catch(function(e){t.error("Error while waiting for the final UI State",e)})}if(o.getBinding().oCache){this._updateRelatedApps()}else{const t=()=>{this._updateRelatedApps();o.getBinding().detachDataReceived(t)};o.getBinding().attachDataReceived(t)}const e=o.getBinding&&o.getBinding()||o;if(this.currentBinding!==e){e.attachEvent("patchSent",this.editFlow.handlePatchSent,this);this.currentBinding=e}r.forEach(function(e){P.whenBound(e).then(h).catch(function(e){t.error("Error while waiting for the table to be bound",e)})});if(!this.getView().getViewData().useNewLazyLoading){a._triggerVisibleSubSectionsEvents()}n.updateEditButtonVisibilityAndEnablement(this.getView())}};c.onPageReady=function e(n){const o=()=>{const t=this._getObjectPageLayoutControl();const e=!t.getModel("ui").getProperty("/isEditable");if(e){const e=this._getFirstClickableElement(t);if(e){e.focus()}}else{const e=M.byId(t.getSelectedSection());if(e){this._updateFocusInEditMode(e.getSubSections())}}};const s=this.getView();const a=s.getBindingContext("internal");const r=s.getBindingContext();if(r){const t=y.isStickySessionSupported(r.getModel().getMetaModel());if(!t){const t=i.getAppComponent(s);t.getShellServices().setBackNavigation(()=>this._onBackNavigationInDraft(r))}}const c=this.getView().getId();this.getAppComponent().getAppStateHandler().applyAppState(c,this.getView()).then(()=>{if(n.forceFocus){o()}}).catch(function(e){t.error("Error while setting the focus",e)});a.setProperty("errorNavigationSectionFlag",false);this._checkDataPointTitleForExternalNavigation()};c.getStickyEditMode=function t(){const e=this.getView().getBindingContext&&this.getView().getBindingContext();let n=false;if(e){const t=y.isStickySessionSupported(e.getModel().getMetaModel());if(t){n=this.getView().getModel("ui").getProperty("/isEditable")}}return n};c._getObjectPageLayoutControl=function t(){return this.byId("fe::ObjectPage")};c._getPageTitleInformation=function t(){const e=this._getObjectPageLayoutControl();const n=e.getCustomData().find(function(t){return t.getKey()==="ObjectPageSubtitle"});return{title:e.data("ObjectPageTitle")||"",subtitle:n&&n.getValue(),intent:"",icon:""}};c._executeHeaderShortcut=function t(e){const n=`${this.getView().getId()}--${e}`,o=this._getObjectPageLayoutControl().getHeaderTitle().getActions().find(function(t){return t.getId()===n});if(o){i.fireButtonPress(o)}};c._executeFooterShortcut=function t(e){const n=`${this.getView().getId()}--${e}`,o=this._getObjectPageLayoutControl().getFooter().getContent().find(function(t){return t.getMetadata().getName()==="sap.m.Button"&&t.getId()===n});i.fireButtonPress(o)};c._executeTabShortCut=function t(e){const n=this._getObjectPageLayoutControl(),i=n.getSections(),o=i.length-1,s=e.oSource.getCommand();let a,r=n.indexOfSection(this.byId(n.getSelectedSection()));if(r!==-1&&o>0){if(s==="NextTab"){if(r<=o-1){a=i[++r]}}else if(r!==0){a=i[--r]}if(a){n.setSelectedSection(a);a.focus()}}};c._getFooterVisibility=function t(){const e=this.getView().getBindingContext("internal");const n=this.getView().getId();e.setProperty("messageFooterContainsErrors",false);sap.ui.getCore().getMessageManager().getMessageModel().getData().forEach(function(t){if(t.validation&&t.type==="Error"&&t.target.indexOf(n)>-1){e.setProperty("messageFooterContainsErrors",true)}})};c._showMessagePopover=function e(n,i){if(n){t.error(n)}const o=this.getAppComponent().getRootViewController();const s=o.isFclEnabled()?o.getRightmostView():this.getAppComponent().getRootContainer().getCurrentPage();if(!s.isA("sap.m.MessagePage")){const t=this.messageButton,e=t.oMessagePopover,n=e.getBinding("items");if(n.getLength()>0&&!e.isOpen()){t.setVisible(true);setTimeout(function(){e.openBy(t)},0)}}return i};c._editDocument=function t(e){const n=this.getView().getModel("ui");o.lock(n);return this.editFlow.editDocument.apply(this.editFlow,[e]).finally(function(){o.unlock(n)})};c.getDraftRootContext=async function t(){const e=this.getView();const n=e.getBindingContext();if(n){const t=y.getDraftRootPath(n);let a;if(t){var o,s;const r=(o=this.getAppComponent().getRootViewController().getInstancedViews().find(e=>{var n;return((n=e.getBindingContext())===null||n===void 0?void 0:n.getPath())===t}))===null||o===void 0?void 0:o.getBindingContext();if(r){return r}const c=e.getModel("internal");a=c.getProperty("/simpleDraftRootContext");if(((s=a)===null||s===void 0?void 0:s.getPath())===t){return a}const l=n.getModel();a=l.bindContext(t).getBoundContext();await i.waitForContextRequested(a);c.setProperty("/simpleDraftRootContext",a);return a}return undefined}return undefined};c._validateDocument=async function t(){const e=M.byId(M.getCurrentFocusedControlId());const n=e===null||e===void 0?void 0:e.getBindingContext();if(n&&!n.isTransient()){await this._editFlow.syncTask();const t=this.getAppComponent();const e=t.getSideEffectsService();const i=e.getEntityTypeFromContext(n);const o=i?e.getGlobalODataEntitySideEffects(i):[];if(o.length){return Promise.all(o.map(t=>this._sideEffects.requestSideEffects(t,n)))}else{const e=await this.getDraftRootContext();if(e){return r.executeDraftValidation(e,t,yt(this.getView()))}}}return undefined};c._saveDocument=async function t(e){const n=this.getView().getModel("ui"),i=[];let s=false;o.lock(n);this._findTables().forEach(t=>{const e=this._getTableBinding(t);const n={creationMode:t.data("creationMode"),creationRow:t.getCreationRow(),createAtEnd:t.data("createAtEnd")==="true"};const o=n.creationRow&&n.creationRow.getBindingContext()&&Object.keys(n.creationRow.getBindingContext().getObject()).length>1;if(o){n.bSkipSideEffects=true;s=true;i.push(this.editFlow.createDocument(e,n).then(function(){return e}))}});try{const t=await Promise.all(i);const a={bExecuteSideEffectsOnError:s,bindings:t};try{await this.editFlow.saveDocument(e,a)}catch(t){this._showMessagePopover(t);throw t}}finally{if(o.isLocked(n)){o.unlock(n)}}};c._manageCollaboration=function t(){Ct(this.getView())};c._showCollaborationUserDetails=function t(e){mt(e,this.getView())};c._cancelDocument=function t(e,n){n.cancelButton=this.getView().byId(n.cancelButton);return this.editFlow.cancelDocument(e,n)};c._applyDocument=function t(e){return this.editFlow.applyDocument(e).catch(()=>this._showMessagePopover())};c._updateRelatedApps=function t(){const e=this._getObjectPageLayoutControl();if(i.resolveStringtoBoolean(e.data("showRelatedApps"))){i.updateRelatedAppsDetails(e)}};c._findControlInSubSection=function t(e,n,i,o){const s=[];for(let t=0;t<e.length;t++){let n=e[t].getContent instanceof Function&&e[t].getContent();if(o){if(n&&n.mAggregations&&n.getAggregation("items")){const t=n.getAggregation("items");t.forEach(function(t){if(t.isA("sap.fe.macros.chart.ChartAPI")){n=t}})}}if(n&&n.isA&&n.isA("sap.ui.layout.DynamicSideContent")){n=n.getMainContent instanceof Function&&n.getMainContent();if(n&&n.length>0){n=n[0]}}if(n&&n.isA&&n.isA("sap.fe.macros.table.TableAPI")){n=n.getContent instanceof Function&&n.getContent();if(n&&n.length>0){n=n[0]}}if(n&&n.isA&&n.isA("sap.ui.mdc.Table")){i.push(n);s.push({table:n,gridTable:n.getType().isA("sap.ui.mdc.table.GridTableType")})}if(n&&n.isA&&n.isA("sap.fe.macros.chart.ChartAPI")){n=n.getContent instanceof Function&&n.getContent();if(n&&n.length>0){n=n[0]}}if(n&&n.isA&&n.isA("sap.ui.mdc.Chart")){i.push(n)}}if(s.length===1&&e.length===1&&s[0].gridTable&&!n.hasStyleClass("sapUxAPObjectPageSubSectionFitContainer")){n.addStyleClass("sapUxAPObjectPageSubSectionFitContainer")}};c._getAllSubSections=function t(){const e=this._getObjectPageLayoutControl();let n=[];e.getSections().forEach(function(t){n=n.concat(t.getSubSections())});return n};c._getAllBlocks=function t(){let e=[];this._getAllSubSections().forEach(function(t){e=e.concat(t.getBlocks())});return e};c._findTables=function t(){const e=this._getAllSubSections();const n=[];for(let t=0;t<e.length;t++){this._findControlInSubSection(e[t].getBlocks(),e[t],n);this._findControlInSubSection(e[t].getMoreBlocks(),e[t],n)}return n};c._findCharts=function t(){const e=this._getAllSubSections();const n=[];for(let t=0;t<e.length;t++){this._findControlInSubSection(e[t].getBlocks(),e[t],n,true);this._findControlInSubSection(e[t].getMoreBlocks(),e[t],n,true)}return n};c._closeSideContent=function t(){this._getAllBlocks().forEach(function(t){const e=t.getContent instanceof Function&&t.getContent();if(e&&e.isA&&e.isA("sap.ui.layout.DynamicSideContent")){if(e.setShowSideContent instanceof Function){e.setShowSideContent(false)}}})};c._getChartContextData=function t(e,n){const i=e.getObject();let o=[i];if(e&&n){if(i[n]){o=i[n];delete i[n];o.push(i)}}return o};c._scrollTablesToRow=function t(e){if(this._findTables&&this._findTables().length>0){const t=this._findTables();for(let n=0;n<t.length;n++){A.scrollTableToRow(t[n],e)}}};c._mergeMultipleContexts=function t(e,n,o){let s=[],a=[],r,c,l;const g=e.getPath();const u=e&&e.getModel()&&e.getModel().getMetaModel();const d=u&&u.getMetaPath(g).replace(/^\/*/,"");if(n&&n.length){r=n[0];l=r.getPath();c=u&&u.getMetaPath(l).replace(/^\/*/,"");n.forEach(t=>{if(o){const e=this._getChartContextData(t,o);if(e){s=e.map(function(t){return{contextData:t,entitySet:`${d}/${o}`}})}}else{s.push({contextData:t.getObject(),entitySet:c})}})}a.push({contextData:e.getObject(),entitySet:d});a=i.removeSensitiveData(a,u);const f=i.addPageContextToSelectionVariant(new x,a,this.getView());s=i.removeSensitiveData(s,u);return{selectionVariant:f,attributes:s}};c._getBatchGroupsForView=function t(){const e=this.getView().getViewData(),n=e.controlConfiguration,i=n&&Object.keys(n),o=["$auto.Heroes","$auto.Decoration","$auto.Workers"];if(i&&i.length>0){i.forEach(function(t){const e=n[t];if(e.requestGroupId==="LongRunners"){o.push("$auto.LongRunners")}})}return o};c._setBreadcrumbLinks=async function e(n){const i=n.getBindingContext(),o=this.getAppComponent(),s=[],a=[],r=i===null||i===void 0?void 0:i.getPath(),c=(r===null||r===void 0?void 0:r.split("/"))??[],l=o&&o.getMetaModel();let g="";try{c.shift();c.splice(-1,1);c.forEach(function(t){g+=`/${t}`;const e=o.getRootViewController();const n=l.getMetaPath(g);const i=l.getObject(`${n}/@com.sap.vocabularies.Common.v1.ResultContext`);if(i){a.push(1);return}else{a.push(0)}s.push(e.getTitleInfoFromPath(g))});const t=await Promise.all(s);let e,i,r;for(const o of t){i=t.indexOf(o);e=i-a[i];r=n.getLinks()[e]?n.getLinks()[e]:new _;r.setText(o.subtitle||o.title);r.setHref(encodeURI(o.intent));if(!n.getLinks()[e]){n.addLink(r)}}}catch(e){t.error("Error while setting the breadcrumb links:"+e)}};c._checkDataPointTitleForExternalNavigation=function n(){const o=this.getView();const s=o.getBindingContext("internal");const a=i.getHeaderFacetItemConfigForExternalNavigation(o.getViewData(),this.getAppComponent().getRoutingService().getOutbounds());const r=this.getAppComponent().getShellServices();const c=o&&o.getBindingContext();s.setProperty("isHeaderDPLinkVisible",{});if(c){c.requestObject().then(function(t){u(a,t)}).catch(function(e){t.error("Cannot retrieve the links from the shell service",e)})}function l(e){t.error(e)}function g(t,e){const n=t;if(e&&e.length===1&&e[0].supported){s.setProperty(`isHeaderDPLinkVisible/${n}`,true)}}function u(t,n){for(const i in t){const s=t[i];const a={};const c=o.byId(i);if(!c){continue}const u=c.getBindingContext();const d=u&&u.getObject();let f=e({},n,d);if(s.semanticObjectMapping){const t=s.semanticObjectMapping;for(const n in t){const i=t[n];const o=i["LocalProperty"]["$PropertyPath"];const s=i["SemanticObjectProperty"];if(o!==s){if(f.hasOwnProperty(o)){const t={};t[s]=f[o];f=e({},f,t);delete f[o]}}}}if(f){for(const t in f){if(t.indexOf("_")!==0&&t.indexOf("odata.context")===-1){a[t]=f[t]}}}r.isNavigationSupported([{target:{semanticObject:s.semanticObject,action:s.action},params:a}]).then(t=>g(i,t)).catch(l)}}};return a}(w),nt=At(et.prototype,"placeholder",[N],{configurable:true,enumerable:true,writable:true,initializer:null}),it=At(et.prototype,"share",[z],{configurable:true,enumerable:true,writable:true,initializer:null}),ot=At(et.prototype,"_routing",[$],{configurable:true,enumerable:true,writable:true,initializer:null}),st=At(et.prototype,"paginator",[H],{configurable:true,enumerable:true,writable:true,initializer:null}),at=At(et.prototype,"messageHandler",[U],{configurable:true,enumerable:true,writable:true,initializer:null}),rt=At(et.prototype,"intentBasedNavigation",[G],{configurable:true,enumerable:true,writable:true,initializer:null}),ct=At(et.prototype,"_intentBasedNavigation",[q],{configurable:true,enumerable:true,writable:true,initializer:null}),lt=At(et.prototype,"viewState",[J],{configurable:true,enumerable:true,writable:true,initializer:null}),gt=At(et.prototype,"pageReady",[K],{configurable:true,enumerable:true,writable:true,initializer:null}),ut=At(et.prototype,"massEdit",[W],{configurable:true,enumerable:true,writable:true,initializer:null}),At(et.prototype,"getExtensionAPI",[Q,X],Object.getOwnPropertyDescriptor(et.prototype,"getExtensionAPI"),et.prototype),At(et.prototype,"onPageReady",[Y,Z],Object.getOwnPropertyDescriptor(et.prototype,"onPageReady"),et.prototype),et))||tt);return _t},false);
//# sourceMappingURL=ObjectPageController.controller.js.map