/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/ClassSupport","sap/fe/macros/ResourceModel","sap/m/BusyDialog","./FieldWrapper"],function(e,t,i,r,l,n){"use strict";var a,o,s,u,p,f,c,d,h,y,b,g,v,m,w,_,C,P,B,E,z,U,x;var S=i.property;var A=i.defineUI5Class;var T=i.aggregation;function I(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function L(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function D(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;O(e,t)}function O(e,t){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return O(e,t)}function M(e,t,i,r,l){var n={};Object.keys(r).forEach(function(e){n[e]=r[e]});n.enumerable=!!n.enumerable;n.configurable=!!n.configurable;if("value"in n||n.initializer){n.writable=true}n=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},n);if(l&&n.initializer!==void 0){n.value=n.initializer?n.initializer.call(l):void 0;n.initializer=undefined}if(n.initializer===void 0){Object.defineProperty(e,t,n);n=null}return n}function j(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let k=(a=A("sap.fe.core.controls.FileWrapper"),o=S({type:"sap.ui.core.URI"}),s=S({type:"string"}),u=S({type:"string"}),p=S({type:"string"}),f=T({type:"sap.m.Avatar",multiple:false}),c=T({type:"sap.ui.core.Icon",multiple:false}),d=T({type:"sap.m.Link",multiple:false}),h=T({type:"sap.m.Text",multiple:false}),y=T({type:"sap.ui.unified.FileUploader",multiple:false}),b=T({type:"sap.m.Button",multiple:false}),a(g=(v=function(i){D(a,i);function a(){var e;for(var t=arguments.length,r=new Array(t),l=0;l<t;l++){r[l]=arguments[l]}e=i.call(this,...r)||this;I(e,"uploadUrl",m,L(e));I(e,"propertyPath",w,L(e));I(e,"filename",_,L(e));I(e,"mediaType",C,L(e));I(e,"avatar",P,L(e));I(e,"icon",B,L(e));I(e,"link",E,L(e));I(e,"text",z,L(e));I(e,"fileUploader",U,L(e));I(e,"deleteButton",x,L(e));e._busy=false;return e}var o=a.prototype;o.getAccessibilityInfo=function e(){const t=[];if(this.avatar){t.push(this.avatar)}if(this.icon){t.push(this.icon)}if(this.link){t.push(this.link)}if(this.text){t.push(this.text)}if(this.fileUploader){t.push(this.fileUploader)}if(this.deleteButton){t.push(this.deleteButton)}return{children:t}};o.onBeforeRendering=function e(){this._setAriaLabels();this._addSideEffects()};o._setAriaLabels=function e(){this._setAriaLabelledBy(this.avatar);this._setAriaLabelledBy(this.icon);this._setAriaLabelledBy(this.link);this._setAriaLabelledBy(this.text);this._setAriaLabelledBy(this.fileUploader);this._setAriaLabelledBy(this.deleteButton)};o._addSideEffects=function i(){var r;const l=[],n=e.getTargetView(this),a=n.getViewData().fullContextPath,o=n.getModel().getMetaModel(),s=o.getMetaPath(a),u=o.getContext(a),p=t.getInvolvedDataModelObjects(u),f=this.data("sourcePath"),c=f.replace(`${s}`,""),d=c.replace(this.propertyPath,"");l.push({$NavigationPropertyPath:c});if(this.filename){l.push({$NavigationPropertyPath:d+this.filename})}if(this.mediaType){l.push({$NavigationPropertyPath:d+this.mediaType})}(r=this._getSideEffectController())===null||r===void 0?void 0:r.addControlSideEffects(p.targetEntityType.fullyQualifiedName,{SourceProperties:[c],TargetEntities:l,sourceControlId:this.getId()})};o._getSideEffectController=function e(){const t=this._getViewController();return t?t._sideEffects:undefined};o._getViewController=function t(){const i=e.getTargetView(this);return i&&i.getController()};o.getUploadUrl=function e(){const t=this.getBindingContext();return t&&this.uploadUrl?this.uploadUrl.replace(t.getPath(),t.getCanonicalPath()):""};o.setUIBusy=function e(t){const i=this;this._busy=t;if(t){if(!this.busyDialog){this.busyDialog=new l({text:r.getText("M_FILEWRAPPER_BUSY_DIALOG_TITLE"),showCancelButton:false})}setTimeout(function(){if(i._busy){var e;(e=i.busyDialog)===null||e===void 0?void 0:e.open()}},1e3)}else{var n;(n=this.busyDialog)===null||n===void 0?void 0:n.close(false)}};o.getUIBusy=function e(){return this._busy};a.render=function e(t,i){t.openStart("div",i);t.style("width",i.width);t.openEnd();t.openStart("div");t.style("display","flex");t.style("box-sizing","border-box");t.style("justify-content","space-between");t.style("align-items","center");t.style("flex-wrap","wrap");t.style("align-content","stretch");t.style("width","100%");t.openEnd();t.openStart("div");t.style("display","flex");t.style("align-items","center");t.openEnd();if(i.avatar){t.renderControl(i.avatar)}else{t.renderControl(i.icon);t.renderControl(i.link);t.renderControl(i.text)}t.close("div");t.openStart("div");t.style("display","flex");t.style("align-items","center");t.openEnd();t.renderControl(i.fileUploader);t.renderControl(i.deleteButton);t.close("div");t.close("div");t.close("div")};o.destroy=function e(t){const i=this._getSideEffectController();if(i){i.removeControlSideEffects(this)}delete this.busyDialog;n.prototype.destroy.apply(this,[t])};return a}(n),m=M(v.prototype,"uploadUrl",[o],{configurable:true,enumerable:true,writable:true,initializer:null}),w=M(v.prototype,"propertyPath",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),_=M(v.prototype,"filename",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),C=M(v.prototype,"mediaType",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),P=M(v.prototype,"avatar",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),B=M(v.prototype,"icon",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),E=M(v.prototype,"link",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),z=M(v.prototype,"text",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),U=M(v.prototype,"fileUploader",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),x=M(v.prototype,"deleteButton",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),v))||g);return k},false);
//# sourceMappingURL=FileWrapper.js.map