//@ui5-bundle sap/fe/core/library-preload.js
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/ActionRuntime-dbg", ["sap/base/util/merge", "sap/fe/core/CommonUtils", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "./controls/AnyElement", "./converters/ConverterContext", "./converters/objectPage/HeaderAndFooterAction"], function (merge, CommonUtils, BindingToolkit, ModelHelper, AnyElement, ConverterContext, HeaderAndFooterAction) {
  "use strict";

  var getHiddenExpression = HeaderAndFooterAction.getHiddenExpression;
  var getEditButtonEnabled = HeaderAndFooterAction.getEditButtonEnabled;
  var transformRecursively = BindingToolkit.transformRecursively;
  var equal = BindingToolkit.equal;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  const ActionRuntime = {
    /**
     * Sets the action enablement.
     *
     * @function
     * @name setActionEnablement
     * @param oInternalModelContext Object containing the context model
     * @param oActionOperationAvailableMap Map containing the operation availability of actions
     * @param aSelectedContexts Array containing selected contexts of the chart
     * @param sControl Control name
     * @returns The action enablement promises
     * @ui5-restricted
     */
    setActionEnablement: function (oInternalModelContext, oActionOperationAvailableMap, aSelectedContexts, sControl) {
      const aPromises = [];
      for (const sAction in oActionOperationAvailableMap) {
        let aRequestPromises = [];
        oInternalModelContext.setProperty(sAction, false);
        const sProperty = oActionOperationAvailableMap[sAction];
        for (let i = 0; i < aSelectedContexts.length; i++) {
          const oSelectedContext = aSelectedContexts[i];
          if (oSelectedContext) {
            const oContextData = oSelectedContext.getObject();
            if (sControl === "chart") {
              if (sProperty === null && !!oContextData[`#${sAction}`] || oSelectedContext.getObject(sProperty)) {
                //look for action advertisement if present and its value is not null
                oInternalModelContext.setProperty(sAction, true);
                break;
              }
            } else if (sControl === "table") {
              aRequestPromises = this._setActionEnablementForTable(oSelectedContext, oInternalModelContext, sAction, sProperty, aRequestPromises);
            }
          }
        }
        if (sControl === "table") {
          if (!aSelectedContexts.length) {
            oInternalModelContext.setProperty(`dynamicActions/${sAction}`, {
              bEnabled: false,
              aApplicable: [],
              aNotApplicable: []
            });
            aPromises.push(CommonUtils.setContextsBasedOnOperationAvailable(oInternalModelContext, []));
          } else if (aSelectedContexts.length && typeof sProperty === "string") {
            // When all property values have been retrieved, set
            // The applicable and not-applicable selected contexts for each action and
            // The enabled property of the dynamic action in internal model context.
            aPromises.push(CommonUtils.setContextsBasedOnOperationAvailable(oInternalModelContext, aRequestPromises));
          }
        }
      }
      return Promise.all(aPromises);
    },
    setActionEnablementAfterPatch: function (oView, oListBinding, oInternalModelContext) {
      const oInternalModelContextData = oInternalModelContext === null || oInternalModelContext === void 0 ? void 0 : oInternalModelContext.getObject();
      const oControls = (oInternalModelContextData === null || oInternalModelContextData === void 0 ? void 0 : oInternalModelContextData.controls) || {};
      for (const sKey in oControls) {
        if (oControls[sKey] && oControls[sKey].controlId) {
          const oTable = oView.byId(sKey);
          if (oTable && oTable.isA("sap.ui.mdc.Table")) {
            const oRowBinding = oTable.getRowBinding();
            if (oRowBinding == oListBinding) {
              ActionRuntime.setActionEnablement(oTable.getBindingContext("internal"), JSON.parse(oTable.data("operationAvailableMap").customData), oTable.getSelectedContexts(), "table");
            }
          }
        }
      }
    },
    updateEditButtonVisibilityAndEnablement(oView) {
      var _oView$getViewData;
      const iViewLevel = (_oView$getViewData = oView.getViewData()) === null || _oView$getViewData === void 0 ? void 0 : _oView$getViewData.viewLevel;
      if (iViewLevel > 1) {
        var _oContext$getModel, _oContext$getModel$ge, _annotations$UI, _annotations$UI$Updat;
        const oContext = oView.getBindingContext();
        const oAppComponent = CommonUtils.getAppComponent(oView);
        const sMetaPath = ModelHelper.getMetaPathForContext(oContext);
        const sEntitySet = ModelHelper.getRootEntitySetPath(sMetaPath);
        const metaContext = oContext === null || oContext === void 0 ? void 0 : (_oContext$getModel = oContext.getModel()) === null || _oContext$getModel === void 0 ? void 0 : (_oContext$getModel$ge = _oContext$getModel.getMetaModel()) === null || _oContext$getModel$ge === void 0 ? void 0 : _oContext$getModel$ge.getContext(oContext === null || oContext === void 0 ? void 0 : oContext.getPath());
        const converterContext = ConverterContext === null || ConverterContext === void 0 ? void 0 : ConverterContext.createConverterContextForMacro(sEntitySet, metaContext, oAppComponent.getDiagnostics(), merge, undefined);
        const entitySet = converterContext.getEntitySet();
        const entityType = converterContext.getEntityType();
        let updateHidden;
        //Find the Update Hidden of the root entity set and bind the property to AnyElement, any changes in the path of the root UpdateHidden will be updated via the property, internal model context is updated based on the property
        const bUpdateHidden = entitySet && !ModelHelper.isSingleton(entitySet) && ((_annotations$UI = entitySet.annotations.UI) === null || _annotations$UI === void 0 ? void 0 : (_annotations$UI$Updat = _annotations$UI.UpdateHidden) === null || _annotations$UI$Updat === void 0 ? void 0 : _annotations$UI$Updat.valueOf());
        if (bUpdateHidden !== true) {
          updateHidden = ModelHelper.isUpdateHidden(entitySet, entityType);
        }
        //Find the operation available property of the root edit configuration and fetch the property using AnyElement
        const sEditEnableBinding = getEditButtonEnabled(converterContext, undefined);
        const draftRootPath = ModelHelper.getDraftRootPath(oContext);
        const sStickyRootPath = ModelHelper.getStickyRootPath(oContext);
        const sPath = draftRootPath || sStickyRootPath;
        const oInternalModelContext = oView.getBindingContext("internal");
        if (sPath) {
          const oRootContext = oView.getModel().bindContext(sPath).getBoundContext();
          if (updateHidden !== undefined) {
            const sHiddenExpression = compileExpression(equal(getHiddenExpression(converterContext, updateHidden), false));
            this.updateEditModelContext(sHiddenExpression, oView, oRootContext, "rootEditVisible", oInternalModelContext);
          }
          if (sEditEnableBinding) {
            this.updateEditModelContext(sEditEnableBinding, oView, oRootContext, "rootEditEnabled", oInternalModelContext);
          }
        }
      }
    },
    updateEditModelContext: function (sBindingExpression, oView, oRootContext, sProperty, oInternalModelContext) {
      if (sBindingExpression) {
        var _oHiddenElement$getMo, _oHiddenElement$getMo2, _oHiddenElement$getBi;
        const oHiddenElement = new AnyElement({
          anyText: sBindingExpression
        });
        oHiddenElement.setBindingContext(null);
        oView.addDependent(oHiddenElement);
        oHiddenElement.getBinding("anyText");
        const oContext = (_oHiddenElement$getMo = oHiddenElement.getModel()) === null || _oHiddenElement$getMo === void 0 ? void 0 : (_oHiddenElement$getMo2 = _oHiddenElement$getMo.bindContext(oRootContext.getPath(), oRootContext, {
          $$groupId: "$auto.Heroes"
        })) === null || _oHiddenElement$getMo2 === void 0 ? void 0 : _oHiddenElement$getMo2.getBoundContext();
        oHiddenElement.setBindingContext(oContext);
        oHiddenElement === null || oHiddenElement === void 0 ? void 0 : (_oHiddenElement$getBi = oHiddenElement.getBinding("anyText")) === null || _oHiddenElement$getBi === void 0 ? void 0 : _oHiddenElement$getBi.attachChange(oEvent => {
          const oNewValue = oEvent.getSource().getExternalValue();
          oInternalModelContext.setProperty(sProperty, oNewValue);
        });
      }
    },
    _setActionEnablementForTable: function (oSelectedContext, oInternalModelContext, sAction, sProperty, aRequestPromises) {
      // Reset all properties before computation
      oInternalModelContext.setProperty(`dynamicActions/${sAction}`, {
        bEnabled: false,
        aApplicable: [],
        aNotApplicable: []
      });
      // Note that non dynamic actions are not processed here. They are enabled because
      // one or more are selected and the second part of the condition in the templating
      // is then undefined and thus the button takes the default enabling, which is true!
      const aApplicable = [],
        aNotApplicable = [],
        sDynamicActionEnabledPath = `${oInternalModelContext.getPath()}/dynamicActions/${sAction}/bEnabled`;
      if (typeof sProperty === "object" && sProperty !== null && sProperty !== undefined) {
        if (oSelectedContext) {
          const oContextData = oSelectedContext.getObject();
          const oTransformedBinding = transformRecursively(sProperty, "PathInModel",
          // eslint-disable-next-line no-loop-func
          function (oBindingExpression) {
            return oContextData ? constant(oContextData[oBindingExpression.path]) : constant(false);
          }, true);
          const sResult = compileExpression(oTransformedBinding);
          if (sResult === "true") {
            oInternalModelContext.getModel().setProperty(sDynamicActionEnabledPath, true);
            aApplicable.push(oSelectedContext);
          } else {
            aNotApplicable.push(oSelectedContext);
          }
        }
        CommonUtils.setDynamicActionContexts(oInternalModelContext, sAction, aApplicable, aNotApplicable);
      } else {
        const oContextData = oSelectedContext === null || oSelectedContext === void 0 ? void 0 : oSelectedContext.getObject();
        if (sProperty === null && !!oContextData[`#${sAction}`]) {
          //look for action advertisement if present and its value is not null
          oInternalModelContext.getModel().setProperty(sDynamicActionEnabledPath, true);
        } else if (oSelectedContext !== undefined) {
          // Collect promises to retrieve singleton or normal property value asynchronously
          aRequestPromises.push(CommonUtils.requestProperty(oSelectedContext, sAction, sProperty, sDynamicActionEnabledPath));
        }
      }
      return aRequestPromises;
    }
  };
  return ActionRuntime;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/ActionRuntime", ["sap/base/util/merge","sap/fe/core/CommonUtils","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","./controls/AnyElement","./converters/ConverterContext","./converters/objectPage/HeaderAndFooterAction"],function(t,e,n,o,i,l,s){"use strict";var a=s.getHiddenExpression;var d=s.getEditButtonEnabled;var r=n.transformRecursively;var c=n.equal;var u=n.constant;var g=n.compileExpression;const p={setActionEnablement:function(t,n,o,i){const l=[];for(const s in n){let a=[];t.setProperty(s,false);const d=n[s];for(let e=0;e<o.length;e++){const n=o[e];if(n){const e=n.getObject();if(i==="chart"){if(d===null&&!!e[`#${s}`]||n.getObject(d)){t.setProperty(s,true);break}}else if(i==="table"){a=this._setActionEnablementForTable(n,t,s,d,a)}}}if(i==="table"){if(!o.length){t.setProperty(`dynamicActions/${s}`,{bEnabled:false,aApplicable:[],aNotApplicable:[]});l.push(e.setContextsBasedOnOperationAvailable(t,[]))}else if(o.length&&typeof d==="string"){l.push(e.setContextsBasedOnOperationAvailable(t,a))}}}return Promise.all(l)},setActionEnablementAfterPatch:function(t,e,n){const o=n===null||n===void 0?void 0:n.getObject();const i=(o===null||o===void 0?void 0:o.controls)||{};for(const n in i){if(i[n]&&i[n].controlId){const o=t.byId(n);if(o&&o.isA("sap.ui.mdc.Table")){const t=o.getRowBinding();if(t==e){p.setActionEnablement(o.getBindingContext("internal"),JSON.parse(o.data("operationAvailableMap").customData),o.getSelectedContexts(),"table")}}}}},updateEditButtonVisibilityAndEnablement(n){var i;const s=(i=n.getViewData())===null||i===void 0?void 0:i.viewLevel;if(s>1){var r,u,p,f;const i=n.getBindingContext();const s=e.getAppComponent(n);const v=o.getMetaPathForContext(i);const b=o.getRootEntitySetPath(v);const h=i===null||i===void 0?void 0:(r=i.getModel())===null||r===void 0?void 0:(u=r.getMetaModel())===null||u===void 0?void 0:u.getContext(i===null||i===void 0?void 0:i.getPath());const x=l===null||l===void 0?void 0:l.createConverterContextForMacro(b,h,s.getDiagnostics(),t,undefined);const y=x.getEntitySet();const C=x.getEntityType();let E;const A=y&&!o.isSingleton(y)&&((p=y.annotations.UI)===null||p===void 0?void 0:(f=p.UpdateHidden)===null||f===void 0?void 0:f.valueOf());if(A!==true){E=o.isUpdateHidden(y,C)}const m=d(x,undefined);const P=o.getDraftRootPath(i);const B=o.getStickyRootPath(i);const M=P||B;const O=n.getBindingContext("internal");if(M){const t=n.getModel().bindContext(M).getBoundContext();if(E!==undefined){const e=g(c(a(x,E),false));this.updateEditModelContext(e,n,t,"rootEditVisible",O)}if(m){this.updateEditModelContext(m,n,t,"rootEditEnabled",O)}}}},updateEditModelContext:function(t,e,n,o,l){if(t){var s,a,d;const r=new i({anyText:t});r.setBindingContext(null);e.addDependent(r);r.getBinding("anyText");const c=(s=r.getModel())===null||s===void 0?void 0:(a=s.bindContext(n.getPath(),n,{$$groupId:"$auto.Heroes"}))===null||a===void 0?void 0:a.getBoundContext();r.setBindingContext(c);r===null||r===void 0?void 0:(d=r.getBinding("anyText"))===null||d===void 0?void 0:d.attachChange(t=>{const e=t.getSource().getExternalValue();l.setProperty(o,e)})}},_setActionEnablementForTable:function(t,n,o,i,l){n.setProperty(`dynamicActions/${o}`,{bEnabled:false,aApplicable:[],aNotApplicable:[]});const s=[],a=[],d=`${n.getPath()}/dynamicActions/${o}/bEnabled`;if(typeof i==="object"&&i!==null&&i!==undefined){if(t){const e=t.getObject();const o=r(i,"PathInModel",function(t){return e?u(e[t.path]):u(false)},true);const l=g(o);if(l==="true"){n.getModel().setProperty(d,true);s.push(t)}else{a.push(t)}}e.setDynamicActionContexts(n,o,s,a)}else{const s=t===null||t===void 0?void 0:t.getObject();if(i===null&&!!s[`#${o}`]){n.getModel().setProperty(d,true)}else if(t!==undefined){l.push(e.requestProperty(t,o,i,d))}}return l}};return p},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/AppComponent-dbg", ["sap/base/Log", "sap/fe/core/AppStateHandler", "sap/fe/core/controllerextensions/routing/RouterProxy", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/library", "sap/fe/core/manifestMerger/ChangePageConfiguration", "sap/fe/core/support/Diagnostics", "sap/ui/core/Core", "sap/ui/core/UIComponent", "sap/ui/model/json/JSONModel", "./converters/MetaModelConverter", "./helpers/SemanticDateOperators"], function (Log, AppStateHandler, RouterProxy, ClassSupport, ModelHelper, library, ChangePageConfiguration, Diagnostics, Core, UIComponent, JSONModel, MetaModelConverter, SemanticDateOperators) {
  "use strict";

  var _dec, _class, _class2;
  var deleteModelCacheData = MetaModelConverter.deleteModelCacheData;
  var changeConfiguration = ChangePageConfiguration.changeConfiguration;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  const StartupMode = library.StartupMode;
  const NAVCONF = {
    FCL: {
      VIEWNAME: "sap.fe.core.rootView.Fcl",
      VIEWNAME_COMPATIBILITY: "sap.fe.templates.RootContainer.view.Fcl",
      ROUTERCLASS: "sap.f.routing.Router"
    },
    NAVCONTAINER: {
      VIEWNAME: "sap.fe.core.rootView.NavContainer",
      VIEWNAME_COMPATIBILITY: "sap.fe.templates.RootContainer.view.NavContainer",
      ROUTERCLASS: "sap.m.routing.Router"
    }
  };
  /**
   * Main class for components used for an application in SAP Fiori elements.
   *
   * Application developers using the templates and building blocks provided by SAP Fiori elements should create their apps by extending this component.
   * This ensures that all the necessary services that you need for the building blocks and templates to work properly are started.
   *
   * When you use sap.fe.core.AppComponent as the base component, you also need to use a rootView. SAP Fiori elements provides two options: <br/>
   *  - sap.fe.core.rootView.NavContainer when using sap.m.routing.Router <br/>
   *  - sap.fe.core.rootView.Fcl when using sap.f.routing.Router (FCL use case) <br/>
   *
   * @hideconstructor
   * @public
   * @name sap.fe.core.AppComponent
   */
  let AppComponent = (_dec = defineUI5Class("sap.fe.core.AppComponent", {
    interfaces: ["sap.ui.core.IAsyncContentCreation"],
    config: {
      fullWidth: true
    },
    manifest: {
      "sap.ui5": {
        services: {
          resourceModel: {
            factoryName: "sap.fe.core.services.ResourceModelService",
            startup: "waitFor",
            settings: {
              bundles: ["sap.fe.core.messagebundle"],
              modelName: "sap.fe.i18n"
            }
          },
          routingService: {
            factoryName: "sap.fe.core.services.RoutingService",
            startup: "waitFor"
          },
          shellServices: {
            factoryName: "sap.fe.core.services.ShellServices",
            startup: "waitFor"
          },
          ShellUIService: {
            factoryName: "sap.ushell.ui5service.ShellUIService"
          },
          navigationService: {
            factoryName: "sap.fe.core.services.NavigationService",
            startup: "waitFor"
          },
          environmentCapabilities: {
            factoryName: "sap.fe.core.services.EnvironmentService",
            startup: "waitFor"
          },
          sideEffectsService: {
            factoryName: "sap.fe.core.services.SideEffectsService",
            startup: "waitFor"
          },
          asyncComponentService: {
            factoryName: "sap.fe.core.services.AsyncComponentService",
            startup: "waitFor"
          }
        },
        rootView: {
          viewName: NAVCONF.NAVCONTAINER.VIEWNAME,
          type: "XML",
          async: true,
          id: "appRootView"
        },
        routing: {
          config: {
            controlId: "appContent",
            routerClass: NAVCONF.NAVCONTAINER.ROUTERCLASS,
            viewType: "XML",
            controlAggregation: "pages",
            async: true,
            containerOptions: {
              propagateModel: true
            }
          }
        }
      }
    },
    designtime: "sap/fe/core/designtime/AppComponent.designtime",
    library: "sap.fe.core"
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_UIComponent) {
    _inheritsLoose(AppComponent, _UIComponent);
    function AppComponent() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _UIComponent.call(this, ...args) || this;
      _this.startupMode = StartupMode.Normal;
      return _this;
    }
    var _proto = AppComponent.prototype;
    /**
     * @private
     * @name sap.fe.core.AppComponent.getMetadata
     * @function
     */
    _proto._isFclEnabled = function _isFclEnabled() {
      var _oManifestUI5$routing, _oManifestUI5$routing2;
      const oManifestUI5 = this.getManifestEntry("sap.ui5");
      return (oManifestUI5 === null || oManifestUI5 === void 0 ? void 0 : (_oManifestUI5$routing = oManifestUI5.routing) === null || _oManifestUI5$routing === void 0 ? void 0 : (_oManifestUI5$routing2 = _oManifestUI5$routing.config) === null || _oManifestUI5$routing2 === void 0 ? void 0 : _oManifestUI5$routing2.routerClass) === NAVCONF.FCL.ROUTERCLASS;
    }

    /**
     * Provides a hook to initialize feature toggles.
     *
     * This hook is being called by the SAP Fiori elements AppComponent at the time feature toggles can be initialized.
     * To change page configuration use the {@link sap.fe.core.AppComponent#changePageConfiguration} method.
     *
     * @function
     * @name sap.fe.core.AppComponent#initializeFeatureToggles
     * @memberof sap.fe.core.AppComponent
     * @public
     */;
    _proto.initializeFeatureToggles = function initializeFeatureToggles() {
      // this method can be overridden by applications
    }

    /**
     * Changes the page configuration of SAP Fiori elements.
     *
     * This method enables you to change the page configuration of SAP Fiori elements.
     *
     * @function
     * @name sap.fe.core.AppComponent#changePageConfiguration
     * @memberof sap.fe.core.AppComponent
     * @param pageId The ID of the page for which the configuration is to be changed.
     * @param path The path in the page settings for which the configuration is to be changed.
     * @param value The new value of the configuration. This could be a plain value like a string, or a Boolean, or a structured object.
     * @public
     */;
    _proto.changePageConfiguration = function changePageConfiguration(pageId, path, value) {
      changeConfiguration(this.getManifest(), pageId, path, value);
    }

    /**
     * Get a reference to the RouterProxy.
     *
     * @function
     * @name sap.fe.core.AppComponent#getRouterProxy
     * @memberof sap.fe.core.AppComponent
     * @returns A Reference to the RouterProxy
     * @ui5-restricted
     * @final
     */;
    _proto.getRouterProxy = function getRouterProxy() {
      return this._oRouterProxy;
    }

    /**
     * Get a reference to the AppStateHandler.
     *
     * @function
     * @name sap.fe.core.AppComponent#getAppStateHandler
     * @memberof sap.fe.core.AppComponent
     * @returns A reference to the AppStateHandler
     * @ui5-restricted
     * @final
     */;
    _proto.getAppStateHandler = function getAppStateHandler() {
      return this._oAppStateHandler;
    }

    /**
     * Get a reference to the nav/FCL Controller.
     *
     * @function
     * @name sap.fe.core.AppComponent#getRootViewController
     * @memberof sap.fe.core.AppComponent
     * @returns  A reference to the FCL Controller
     * @ui5-restricted
     * @final
     */;
    _proto.getRootViewController = function getRootViewController() {
      return this.getRootControl().getController();
    }

    /**
     * Get the NavContainer control or the FCL control.
     *
     * @function
     * @name sap.fe.core.AppComponent#getRootContainer
     * @memberof sap.fe.core.AppComponent
     * @returns  A reference to NavContainer control or the FCL control
     * @ui5-restricted
     * @final
     */;
    _proto.getRootContainer = function getRootContainer() {
      return this.getRootControl().getContent()[0];
    }

    /**
     * Get the startup mode of the app.
     *
     * @returns The startup mode
     * @private
     */;
    _proto.getStartupMode = function getStartupMode() {
      return this.startupMode;
    }

    /**
     * Set the startup mode for the app to 'Create'.
     *
     * @private
     */;
    _proto.setStartupModeCreate = function setStartupModeCreate() {
      this.startupMode = StartupMode.Create;
    }

    /**
     * Set the startup mode for the app to 'AutoCreate'.
     *
     * @private
     */;
    _proto.setStartupModeAutoCreate = function setStartupModeAutoCreate() {
      this.startupMode = StartupMode.AutoCreate;
    }

    /**
     * Set the startup mode for the app to 'Deeplink'.
     *
     * @private
     */;
    _proto.setStartupModeDeeplink = function setStartupModeDeeplink() {
      this.startupMode = StartupMode.Deeplink;
    };
    _proto.init = function init() {
      var _oModel$isA, _oManifestUI5$rootVie;
      this.initializeFeatureToggles();
      const uiModel = new JSONModel({
        editMode: library.EditMode.Display,
        isEditable: false,
        draftStatus: library.DraftStatus.Clear,
        busy: false,
        busyLocal: {},
        pages: {}
      });
      const oInternalModel = new JSONModel({
        pages: {}
      });
      // set the binding OneWay for uiModel to prevent changes if controller extensions modify a bound property of a control
      uiModel.setDefaultBindingMode("OneWay");
      // for internal model binding needs to be two way
      ModelHelper.enhanceUiJSONModel(uiModel, library);
      ModelHelper.enhanceInternalJSONModel(oInternalModel);
      this.setModel(uiModel, "ui");
      this.setModel(oInternalModel, "internal");
      this.bInitializeRouting = this.bInitializeRouting !== undefined ? this.bInitializeRouting : true;
      this._oRouterProxy = new RouterProxy();
      this._oAppStateHandler = new AppStateHandler(this);
      this._oDiagnostics = new Diagnostics();
      const oModel = this.getModel();
      if (oModel !== null && oModel !== void 0 && (_oModel$isA = oModel.isA) !== null && _oModel$isA !== void 0 && _oModel$isA.call(oModel, "sap.ui.model.odata.v4.ODataModel")) {
        this.entityContainer = oModel.getMetaModel().requestObject("/$EntityContainer/");
      } else {
        // not an OData v4 service
        this.entityContainer = Promise.resolve();
      }
      const oManifestUI5 = this.getManifest()["sap.ui5"];
      if (oManifestUI5 !== null && oManifestUI5 !== void 0 && (_oManifestUI5$rootVie = oManifestUI5.rootView) !== null && _oManifestUI5$rootVie !== void 0 && _oManifestUI5$rootVie.viewName) {
        var _oManifestUI5$routing3, _oManifestUI5$routing4, _oManifestUI5$routing5, _oManifestUI5$routing6, _oManifestUI5$rootVie2, _oManifestUI5$rootVie3;
        // The application specified an own root view in the manifest

        // Root View was moved from sap.fe.templates to sap.fe.core - keep it compatible
        if (oManifestUI5.rootView.viewName === NAVCONF.FCL.VIEWNAME_COMPATIBILITY) {
          oManifestUI5.rootView.viewName = NAVCONF.FCL.VIEWNAME;
        } else if (oManifestUI5.rootView.viewName === NAVCONF.NAVCONTAINER.VIEWNAME_COMPATIBILITY) {
          oManifestUI5.rootView.viewName = NAVCONF.NAVCONTAINER.VIEWNAME;
        }
        if (oManifestUI5.rootView.viewName === NAVCONF.FCL.VIEWNAME && ((_oManifestUI5$routing3 = oManifestUI5.routing) === null || _oManifestUI5$routing3 === void 0 ? void 0 : (_oManifestUI5$routing4 = _oManifestUI5$routing3.config) === null || _oManifestUI5$routing4 === void 0 ? void 0 : _oManifestUI5$routing4.routerClass) === NAVCONF.FCL.ROUTERCLASS) {
          Log.info(`Rootcontainer: "${NAVCONF.FCL.VIEWNAME}" - Routerclass: "${NAVCONF.FCL.ROUTERCLASS}"`);
        } else if (oManifestUI5.rootView.viewName === NAVCONF.NAVCONTAINER.VIEWNAME && ((_oManifestUI5$routing5 = oManifestUI5.routing) === null || _oManifestUI5$routing5 === void 0 ? void 0 : (_oManifestUI5$routing6 = _oManifestUI5$routing5.config) === null || _oManifestUI5$routing6 === void 0 ? void 0 : _oManifestUI5$routing6.routerClass) === NAVCONF.NAVCONTAINER.ROUTERCLASS) {
          Log.info(`Rootcontainer: "${NAVCONF.NAVCONTAINER.VIEWNAME}" - Routerclass: "${NAVCONF.NAVCONTAINER.ROUTERCLASS}"`);
        } else if (((_oManifestUI5$rootVie2 = oManifestUI5.rootView) === null || _oManifestUI5$rootVie2 === void 0 ? void 0 : (_oManifestUI5$rootVie3 = _oManifestUI5$rootVie2.viewName) === null || _oManifestUI5$rootVie3 === void 0 ? void 0 : _oManifestUI5$rootVie3.indexOf("sap.fe.core.rootView")) !== -1) {
          var _oManifestUI5$routing7, _oManifestUI5$routing8;
          throw Error(`\nWrong configuration for the couple (rootView/routerClass) in manifest file.\n` + `Current values are :(${oManifestUI5.rootView.viewName}/${(_oManifestUI5$routing7 = oManifestUI5.routing) === null || _oManifestUI5$routing7 === void 0 ? void 0 : (_oManifestUI5$routing8 = _oManifestUI5$routing7.config) === null || _oManifestUI5$routing8 === void 0 ? void 0 : _oManifestUI5$routing8.routerClass})\n` + `Expected values are \n` + `\t - (${NAVCONF.NAVCONTAINER.VIEWNAME}/${NAVCONF.NAVCONTAINER.ROUTERCLASS})\n` + `\t - (${NAVCONF.FCL.VIEWNAME}/${NAVCONF.FCL.ROUTERCLASS})`);
        } else {
          Log.info(`Rootcontainer: "${oManifestUI5.rootView.viewName}" - Routerclass: "${NAVCONF.NAVCONTAINER.ROUTERCLASS}"`);
        }
      }

      // Adding Semantic Date Operators
      // Commenting since it is not needed for SingleRange
      SemanticDateOperators.addSemanticDateOperators();

      // the init function configures the routing according to the settings above
      // it will call the createContent function to instantiate the RootView and add it to the UIComponent aggregations

      _UIComponent.prototype.init.call(this);
      AppComponent.instanceMap[this.getId()] = this;
    };
    _proto.onServicesStarted = function onServicesStarted() {
      //router must be started once the rootcontainer is initialized
      //starting of the router
      const finalizedRoutingInitialization = () => {
        this.entityContainer.then(() => {
          if (this.getRootViewController().attachRouteMatchers) {
            this.getRootViewController().attachRouteMatchers();
          }
          this.getRouter().initialize();
          this.getRouterProxy().init(this, this._isFclEnabled());
        }).catch(error => {
          const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
          this.getRootViewController().displayErrorPage(oResourceBundle.getText("C_APP_COMPONENT_SAPFE_APPSTART_TECHNICAL_ISSUES"), {
            title: oResourceBundle.getText("C_COMMON_SAPFE_ERROR"),
            description: error.message,
            FCLLevel: 0
          });
        });
      };
      if (this.bInitializeRouting) {
        return this.getRoutingService().initializeRouting().then(() => {
          if (this.getRootViewController()) {
            return finalizedRoutingInitialization();
          } else {
            this.getRootControl().attachAfterInit(function () {
              finalizedRoutingInitialization();
            });
          }
        }).catch(function (err) {
          Log.error(`cannot cannot initialize routing: ${err}`);
        });
      }
    };
    _proto.exit = function exit() {
      this._oAppStateHandler.destroy();
      this._oRouterProxy.destroy();
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      delete this._oAppStateHandler;
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      delete this._oRouterProxy;
      deleteModelCacheData(this.getMetaModel());
      this.getModel("ui").destroy();
    };
    _proto.getMetaModel = function getMetaModel() {
      return this.getModel().getMetaModel();
    };
    _proto.getDiagnostics = function getDiagnostics() {
      return this._oDiagnostics;
    };
    _proto.destroy = function destroy(bSuppressInvalidate) {
      var _this$getRoutingServi;
      // LEAKS, with workaround for some Flex / MDC issue
      try {
        // 	// This one is only a leak if you don't go back to the same component in the long run
        //delete sap.ui.fl.FlexControllerFactory._componentInstantiationPromises[this.getId()];

        delete AppComponent.instanceMap[this.getId()];

        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        // @ts-ignore
        delete window._routing;
      } catch (e) {
        Log.info(e);
      }

      //WORKAROUND for sticky discard request : due to async callback, request triggered by the exitApplication will be send after the UIComponent.prototype.destroy
      //so we need to copy the Requestor headers as it will be destroy

      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      const oMainModel = this.oModels[undefined];
      let oHeaders;
      if (oMainModel.oRequestor) {
        oHeaders = jQuery.extend({}, oMainModel.oRequestor.mHeaders);
      }

      // As we need to cleanup the application / handle the dirty object we need to call our cleanup before the models are destroyed
      (_this$getRoutingServi = this.getRoutingService()) === null || _this$getRoutingServi === void 0 ? void 0 : _this$getRoutingServi.beforeExit();
      _UIComponent.prototype.destroy.call(this, bSuppressInvalidate);
      if (oHeaders && oMainModel.oRequestor) {
        oMainModel.oRequestor.mHeaders = oHeaders;
      }
    };
    _proto.getRoutingService = function getRoutingService() {
      return {}; // overriden at runtime
    };
    _proto.getShellServices = function getShellServices() {
      return {}; // overriden at runtime
    };
    _proto.getNavigationService = function getNavigationService() {
      return {}; // overriden at runtime
    };
    _proto.getSideEffectsService = function getSideEffectsService() {
      return {};
    };
    _proto.getEnvironmentCapabilities = function getEnvironmentCapabilities() {
      return {};
    };
    _proto.getStartupParameters = async function getStartupParameters() {
      const oComponentData = this.getComponentData();
      return Promise.resolve(oComponentData && oComponentData.startupParameters || {});
    };
    _proto.restore = function restore() {
      // called by FLP when app sap-keep-alive is enabled and app is restored
      this.getRootViewController().viewState.onRestore();
    };
    _proto.suspend = function suspend() {
      // called by FLP when app sap-keep-alive is enabled and app is suspended
      this.getRootViewController().viewState.onSuspend();
    };
    return AppComponent;
  }(UIComponent), _class2.instanceMap = {}, _class2)) || _class);
  return AppComponent;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/AppComponent", ["sap/base/Log","sap/fe/core/AppStateHandler","sap/fe/core/controllerextensions/routing/RouterProxy","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/ModelHelper","sap/fe/core/library","sap/fe/core/manifestMerger/ChangePageConfiguration","sap/fe/core/support/Diagnostics","sap/ui/core/Core","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","./converters/MetaModelConverter","./helpers/SemanticDateOperators"],function(e,t,o,i,r,n,a,s,u,c,l,p,f){"use strict";var d,g,v;var C=p.deleteModelCacheData;var R=a.changeConfiguration;var h=i.defineUI5Class;function N(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;S(e,t)}function S(e,t){S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return S(e,t)}const A=n.StartupMode;const E={FCL:{VIEWNAME:"sap.fe.core.rootView.Fcl",VIEWNAME_COMPATIBILITY:"sap.fe.templates.RootContainer.view.Fcl",ROUTERCLASS:"sap.f.routing.Router"},NAVCONTAINER:{VIEWNAME:"sap.fe.core.rootView.NavContainer",VIEWNAME_COMPATIBILITY:"sap.fe.templates.RootContainer.view.NavContainer",ROUTERCLASS:"sap.m.routing.Router"}};let M=(d=h("sap.fe.core.AppComponent",{interfaces:["sap.ui.core.IAsyncContentCreation"],config:{fullWidth:true},manifest:{"sap.ui5":{services:{resourceModel:{factoryName:"sap.fe.core.services.ResourceModelService",startup:"waitFor",settings:{bundles:["sap.fe.core.messagebundle"],modelName:"sap.fe.i18n"}},routingService:{factoryName:"sap.fe.core.services.RoutingService",startup:"waitFor"},shellServices:{factoryName:"sap.fe.core.services.ShellServices",startup:"waitFor"},ShellUIService:{factoryName:"sap.ushell.ui5service.ShellUIService"},navigationService:{factoryName:"sap.fe.core.services.NavigationService",startup:"waitFor"},environmentCapabilities:{factoryName:"sap.fe.core.services.EnvironmentService",startup:"waitFor"},sideEffectsService:{factoryName:"sap.fe.core.services.SideEffectsService",startup:"waitFor"},asyncComponentService:{factoryName:"sap.fe.core.services.AsyncComponentService",startup:"waitFor"}},rootView:{viewName:E.NAVCONTAINER.VIEWNAME,type:"XML",async:true,id:"appRootView"},routing:{config:{controlId:"appContent",routerClass:E.NAVCONTAINER.ROUTERCLASS,viewType:"XML",controlAggregation:"pages",async:true,containerOptions:{propagateModel:true}}}}},designtime:"sap/fe/core/designtime/AppComponent.designtime",library:"sap.fe.core"}),d(g=(v=function(i){N(a,i);function a(){var e;for(var t=arguments.length,o=new Array(t),r=0;r<t;r++){o[r]=arguments[r]}e=i.call(this,...o)||this;e.startupMode=A.Normal;return e}var c=a.prototype;c._isFclEnabled=function e(){var t,o;const i=this.getManifestEntry("sap.ui5");return(i===null||i===void 0?void 0:(t=i.routing)===null||t===void 0?void 0:(o=t.config)===null||o===void 0?void 0:o.routerClass)===E.FCL.ROUTERCLASS};c.initializeFeatureToggles=function e(){};c.changePageConfiguration=function e(t,o,i){R(this.getManifest(),t,o,i)};c.getRouterProxy=function e(){return this._oRouterProxy};c.getAppStateHandler=function e(){return this._oAppStateHandler};c.getRootViewController=function e(){return this.getRootControl().getController()};c.getRootContainer=function e(){return this.getRootControl().getContent()[0]};c.getStartupMode=function e(){return this.startupMode};c.setStartupModeCreate=function e(){this.startupMode=A.Create};c.setStartupModeAutoCreate=function e(){this.startupMode=A.AutoCreate};c.setStartupModeDeeplink=function e(){this.startupMode=A.Deeplink};c.init=function u(){var c,p;this.initializeFeatureToggles();const d=new l({editMode:n.EditMode.Display,isEditable:false,draftStatus:n.DraftStatus.Clear,busy:false,busyLocal:{},pages:{}});const g=new l({pages:{}});d.setDefaultBindingMode("OneWay");r.enhanceUiJSONModel(d,n);r.enhanceInternalJSONModel(g);this.setModel(d,"ui");this.setModel(g,"internal");this.bInitializeRouting=this.bInitializeRouting!==undefined?this.bInitializeRouting:true;this._oRouterProxy=new o;this._oAppStateHandler=new t(this);this._oDiagnostics=new s;const v=this.getModel();if(v!==null&&v!==void 0&&(c=v.isA)!==null&&c!==void 0&&c.call(v,"sap.ui.model.odata.v4.ODataModel")){this.entityContainer=v.getMetaModel().requestObject("/$EntityContainer/")}else{this.entityContainer=Promise.resolve()}const C=this.getManifest()["sap.ui5"];if(C!==null&&C!==void 0&&(p=C.rootView)!==null&&p!==void 0&&p.viewName){var R,h,N,S,A,M;if(C.rootView.viewName===E.FCL.VIEWNAME_COMPATIBILITY){C.rootView.viewName=E.FCL.VIEWNAME}else if(C.rootView.viewName===E.NAVCONTAINER.VIEWNAME_COMPATIBILITY){C.rootView.viewName=E.NAVCONTAINER.VIEWNAME}if(C.rootView.viewName===E.FCL.VIEWNAME&&((R=C.routing)===null||R===void 0?void 0:(h=R.config)===null||h===void 0?void 0:h.routerClass)===E.FCL.ROUTERCLASS){e.info(`Rootcontainer: "${E.FCL.VIEWNAME}" - Routerclass: "${E.FCL.ROUTERCLASS}"`)}else if(C.rootView.viewName===E.NAVCONTAINER.VIEWNAME&&((N=C.routing)===null||N===void 0?void 0:(S=N.config)===null||S===void 0?void 0:S.routerClass)===E.NAVCONTAINER.ROUTERCLASS){e.info(`Rootcontainer: "${E.NAVCONTAINER.VIEWNAME}" - Routerclass: "${E.NAVCONTAINER.ROUTERCLASS}"`)}else if(((A=C.rootView)===null||A===void 0?void 0:(M=A.viewName)===null||M===void 0?void 0:M.indexOf("sap.fe.core.rootView"))!==-1){var w,I;throw Error(`\nWrong configuration for the couple (rootView/routerClass) in manifest file.\n`+`Current values are :(${C.rootView.viewName}/${(w=C.routing)===null||w===void 0?void 0:(I=w.config)===null||I===void 0?void 0:I.routerClass})\n`+`Expected values are \n`+`\t - (${E.NAVCONTAINER.VIEWNAME}/${E.NAVCONTAINER.ROUTERCLASS})\n`+`\t - (${E.FCL.VIEWNAME}/${E.FCL.ROUTERCLASS})`)}else{e.info(`Rootcontainer: "${C.rootView.viewName}" - Routerclass: "${E.NAVCONTAINER.ROUTERCLASS}"`)}}f.addSemanticDateOperators();i.prototype.init.call(this);a.instanceMap[this.getId()]=this};c.onServicesStarted=function t(){const o=()=>{this.entityContainer.then(()=>{if(this.getRootViewController().attachRouteMatchers){this.getRootViewController().attachRouteMatchers()}this.getRouter().initialize();this.getRouterProxy().init(this,this._isFclEnabled())}).catch(e=>{const t=u.getLibraryResourceBundle("sap.fe.core");this.getRootViewController().displayErrorPage(t.getText("C_APP_COMPONENT_SAPFE_APPSTART_TECHNICAL_ISSUES"),{title:t.getText("C_COMMON_SAPFE_ERROR"),description:e.message,FCLLevel:0})})};if(this.bInitializeRouting){return this.getRoutingService().initializeRouting().then(()=>{if(this.getRootViewController()){return o()}else{this.getRootControl().attachAfterInit(function(){o()})}}).catch(function(t){e.error(`cannot cannot initialize routing: ${t}`)})}};c.exit=function e(){this._oAppStateHandler.destroy();this._oRouterProxy.destroy();delete this._oAppStateHandler;delete this._oRouterProxy;C(this.getMetaModel());this.getModel("ui").destroy()};c.getMetaModel=function e(){return this.getModel().getMetaModel()};c.getDiagnostics=function e(){return this._oDiagnostics};c.destroy=function t(o){var r;try{delete a.instanceMap[this.getId()];delete window._routing}catch(t){e.info(t)}const n=this.oModels[undefined];let s;if(n.oRequestor){s=jQuery.extend({},n.oRequestor.mHeaders)}(r=this.getRoutingService())===null||r===void 0?void 0:r.beforeExit();i.prototype.destroy.call(this,o);if(s&&n.oRequestor){n.oRequestor.mHeaders=s}};c.getRoutingService=function e(){return{}};c.getShellServices=function e(){return{}};c.getNavigationService=function e(){return{}};c.getSideEffectsService=function e(){return{}};c.getEnvironmentCapabilities=function e(){return{}};c.getStartupParameters=async function e(){const t=this.getComponentData();return Promise.resolve(t&&t.startupParameters||{})};c.restore=function e(){this.getRootViewController().viewState.onRestore()};c.suspend=function e(){this.getRootViewController().viewState.onSuspend()};return a}(c),v.instanceMap={},v))||g);return M},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/AppStateHandler-dbg", ["sap/base/Log", "sap/base/util/deepEqual", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/ToES6Promise", "sap/fe/navigation/library", "sap/ui/base/Object", "./controllerextensions/BusyLocker", "./helpers/ModelHelper"], function (Log, deepEqual, ClassSupport, toES6Promise, library, BaseObject, BusyLocker, ModelHelper) {
  "use strict";

  var _dec, _class;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  const NavType = library.NavType;
  let AppStateHandler = (_dec = defineUI5Class("sap.fe.core.AppStateHandler"), _dec(_class = /*#__PURE__*/function (_BaseObject) {
    _inheritsLoose(AppStateHandler, _BaseObject);
    function AppStateHandler(oAppComponent) {
      var _this;
      _this = _BaseObject.call(this) || this;
      _this._mCurrentAppState = {};
      _this.oAppComponent = oAppComponent;
      _this.sId = `${oAppComponent.getId()}/AppStateHandler`;
      _this.nbSimultaneousCreateRequest = 0;
      _this.bNoRouteChange = false;
      Log.info("APPSTATE : Appstate handler initialized");
      return _this;
    }
    var _proto = AppStateHandler.prototype;
    _proto.getId = function getId() {
      return this.sId;
    }
    /**
     * Creates or updates the appstate.
     *
     * @returns A promise resolving the stored data
     * @ui5-restricted
     */;
    _proto.createAppState = async function createAppState() {
      if (!this.oAppComponent.getEnvironmentCapabilities().getCapabilities().AppState || BusyLocker.isLocked(this)) {
        return;
      }
      const oNavigationService = this.oAppComponent.getNavigationService(),
        oRouterProxy = this.oAppComponent.getRouterProxy(),
        sHash = oRouterProxy.getHash(),
        oController = this.oAppComponent.getRootControl().getController(),
        bIsStickyMode = ModelHelper.isStickySessionSupported(this.oAppComponent.getMetaModel());
      if (!oController.viewState) {
        throw new Error(`viewState controller extension not available for controller: ${oController.getMetadata().getName()}`);
      }
      const mInnerAppState = await oController.viewState.retrieveViewState();
      const oStoreData = {
        appState: mInnerAppState
      };
      if (mInnerAppState && !deepEqual(this._mCurrentAppState, mInnerAppState)) {
        this._mCurrentAppState = mInnerAppState;
        try {
          this.nbSimultaneousCreateRequest++;
          const sAppStateKey = await oNavigationService.storeInnerAppStateAsync(oStoreData, true, true);
          Log.info("APPSTATE: Appstate stored");
          const sNewHash = oNavigationService.replaceInnerAppStateKey(sHash, sAppStateKey);
          this.nbSimultaneousCreateRequest--;
          if (this.nbSimultaneousCreateRequest === 0 && sNewHash !== sHash) {
            oRouterProxy.navToHash(sNewHash, undefined, undefined, undefined, !bIsStickyMode);
            this.bNoRouteChange = true;
          }
          Log.info("APPSTATE: navToHash");
        } catch (oError) {
          Log.error(oError);
        }
      }
      return oStoreData;
    };
    _proto._createNavigationParameters = function _createNavigationParameters(oAppData, sNavType) {
      return Object.assign({}, oAppData, {
        selectionVariantDefaults: oAppData.oDefaultedSelectionVariant,
        selectionVariant: oAppData.oSelectionVariant,
        requiresStandardVariant: !oAppData.bNavSelVarHasDefaultsOnly,
        navigationType: sNavType
      });
    };
    _proto._checkIfLastSeenRecord = function _checkIfLastSeenRecord(view) {
      //getting the internal model context in order to fetch the technicalkeys of last seen record and close column flag set in the internalrouting for retaining settings in persistence mode
      const internalModelContext = view && view.getBindingContext("internal");
      if (internalModelContext && internalModelContext.getProperty("fclColumnClosed") === true) {
        const technicalKeysObject = internalModelContext && internalModelContext.getProperty("technicalKeysOfLastSeenRecord");
        const bindingContext = view === null || view === void 0 ? void 0 : view.getBindingContext();
        const path = bindingContext && bindingContext.getPath() || "";
        const metaModel = bindingContext === null || bindingContext === void 0 ? void 0 : bindingContext.getModel().getMetaModel();
        const metaPath = metaModel === null || metaModel === void 0 ? void 0 : metaModel.getMetaPath(path);
        const technicalKeys = metaModel === null || metaModel === void 0 ? void 0 : metaModel.getObject(`${metaPath}/$Type/$Key`);
        for (let i = 0; i < technicalKeys.length; i++) {
          const keyValue = bindingContext.getObject()[technicalKeys[i]];
          if (keyValue !== technicalKeysObject[technicalKeys[i]]) {
            internalModelContext.setProperty("fclColumnClosed", false);
            return true;
          }
        }
        //the record opened is not the last seen one : no need to persist the changes, reset to default instead
      }

      return false;
    };
    _proto._getAppStateData = function _getAppStateData(oAppData, viewId) {
      let key = "",
        i = 0;
      if (oAppData && oAppData.appState) {
        for (i = 0; i < Object.keys(oAppData.appState).length; i++) {
          if (Object.keys(oAppData.appState)[i] === viewId) {
            key = Object.keys(oAppData.appState)[i];
            break;
          }
        }
      }
      if (oAppData.appState) {
        return {
          [Object.keys(oAppData.appState)[i]]: oAppData.appState[key] || {}
        };
      }
    }

    /**
     * Applies an appstate by fetching appdata and passing it to _applyAppstateToPage.
     *
     * @param viewId
     * @param view
     * @function
     * @static
     * @memberof sap.fe.core.AppStateHandler
     * @returns A promise for async handling
     * @private
     * @ui5-restricted
     */;
    _proto.applyAppState = async function applyAppState(viewId, view) {
      if (!this.oAppComponent.getEnvironmentCapabilities().getCapabilities().AppState || BusyLocker.isLocked(this)) {
        return Promise.resolve();
      }
      const checkIfLastSeenRecord = this._checkIfLastSeenRecord(view);
      if (checkIfLastSeenRecord === true) {
        return Promise.resolve();
      }
      BusyLocker.lock(this);
      // Done for busy indicator
      BusyLocker.lock(this.oAppComponent.getRootControl());
      const oNavigationService = this.oAppComponent.getNavigationService();
      // TODO oNavigationService.parseNavigation() should return ES6 promise instead jQuery.promise
      return toES6Promise(oNavigationService.parseNavigation()).catch(function (aErrorData) {
        if (!aErrorData) {
          aErrorData = [];
        }
        Log.warning("APPSTATE: Parse Navigation failed", aErrorData[0]);
        return [{
          /* app data */
        }, aErrorData[1], aErrorData[2]];
      }).then(aResults => {
        Log.info("APPSTATE: Parse Navigation done");

        // aResults[1] => oStartupParameters (not evaluated)
        const oAppData = aResults[0] || {},
          sNavType = aResults[2] || NavType.initial,
          oRootController = this.oAppComponent.getRootControl().getController();
        // apply the appstate depending upon the view (LR/OP)
        const appStateData = this._getAppStateData(oAppData, viewId);
        this._mCurrentAppState = sNavType === NavType.iAppState ? appStateData : undefined;
        if (!oRootController.viewState) {
          throw new Error(`viewState extension required for controller ${oRootController.getMetadata().getName()}`);
        }
        if (!oAppData && sNavType == NavType.iAppState) {
          return {};
        }
        return oRootController.viewState.applyViewState(this._mCurrentAppState, this._createNavigationParameters(oAppData, sNavType));
      }).catch(function (oError) {
        Log.error("appState could not be applied", oError);
        throw oError;
      }).finally(() => {
        BusyLocker.unlock(this);
        BusyLocker.unlock(this.oAppComponent.getRootControl());
      });
    }
    /**
     * To check is route is changed by change in the iAPPState.
     *
     * @returns `true` if the route has chnaged
     */;
    _proto.checkIfRouteChangedByIApp = function checkIfRouteChangedByIApp() {
      return this.bNoRouteChange;
    }
    /**
     * Reset the route changed by iAPPState.
     */;
    _proto.resetRouteChangedByIApp = function resetRouteChangedByIApp() {
      if (this.bNoRouteChange) {
        this.bNoRouteChange = false;
      }
    };
    return AppStateHandler;
  }(BaseObject)) || _class);
  /**
   * @global
   */
  return AppStateHandler;
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/AppStateHandler", ["sap/base/Log","sap/base/util/deepEqual","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/ToES6Promise","sap/fe/navigation/library","sap/ui/base/Object","./controllerextensions/BusyLocker","./helpers/ModelHelper"],function(t,e,n,o,a,i,r,s){"use strict";var p,c;var l=n.defineUI5Class;function u(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;f(t,e)}function f(t,e){f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,n){e.__proto__=n;return e};return f(t,e)}const h=a.NavType;let S=(p=l("sap.fe.core.AppStateHandler"),p(c=function(n){u(a,n);function a(e){var o;o=n.call(this)||this;o._mCurrentAppState={};o.oAppComponent=e;o.sId=`${e.getId()}/AppStateHandler`;o.nbSimultaneousCreateRequest=0;o.bNoRouteChange=false;t.info("APPSTATE : Appstate handler initialized");return o}var i=a.prototype;i.getId=function t(){return this.sId};i.createAppState=async function n(){if(!this.oAppComponent.getEnvironmentCapabilities().getCapabilities().AppState||r.isLocked(this)){return}const o=this.oAppComponent.getNavigationService(),a=this.oAppComponent.getRouterProxy(),i=a.getHash(),p=this.oAppComponent.getRootControl().getController(),c=s.isStickySessionSupported(this.oAppComponent.getMetaModel());if(!p.viewState){throw new Error(`viewState controller extension not available for controller: ${p.getMetadata().getName()}`)}const l=await p.viewState.retrieveViewState();const u={appState:l};if(l&&!e(this._mCurrentAppState,l)){this._mCurrentAppState=l;try{this.nbSimultaneousCreateRequest++;const e=await o.storeInnerAppStateAsync(u,true,true);t.info("APPSTATE: Appstate stored");const n=o.replaceInnerAppStateKey(i,e);this.nbSimultaneousCreateRequest--;if(this.nbSimultaneousCreateRequest===0&&n!==i){a.navToHash(n,undefined,undefined,undefined,!c);this.bNoRouteChange=true}t.info("APPSTATE: navToHash")}catch(e){t.error(e)}}return u};i._createNavigationParameters=function t(e,n){return Object.assign({},e,{selectionVariantDefaults:e.oDefaultedSelectionVariant,selectionVariant:e.oSelectionVariant,requiresStandardVariant:!e.bNavSelVarHasDefaultsOnly,navigationType:n})};i._checkIfLastSeenRecord=function t(e){const n=e&&e.getBindingContext("internal");if(n&&n.getProperty("fclColumnClosed")===true){const t=n&&n.getProperty("technicalKeysOfLastSeenRecord");const o=e===null||e===void 0?void 0:e.getBindingContext();const a=o&&o.getPath()||"";const i=o===null||o===void 0?void 0:o.getModel().getMetaModel();const r=i===null||i===void 0?void 0:i.getMetaPath(a);const s=i===null||i===void 0?void 0:i.getObject(`${r}/$Type/$Key`);for(let e=0;e<s.length;e++){const a=o.getObject()[s[e]];if(a!==t[s[e]]){n.setProperty("fclColumnClosed",false);return true}}}return false};i._getAppStateData=function t(e,n){let o="",a=0;if(e&&e.appState){for(a=0;a<Object.keys(e.appState).length;a++){if(Object.keys(e.appState)[a]===n){o=Object.keys(e.appState)[a];break}}}if(e.appState){return{[Object.keys(e.appState)[a]]:e.appState[o]||{}}}};i.applyAppState=async function e(n,a){if(!this.oAppComponent.getEnvironmentCapabilities().getCapabilities().AppState||r.isLocked(this)){return Promise.resolve()}const i=this._checkIfLastSeenRecord(a);if(i===true){return Promise.resolve()}r.lock(this);r.lock(this.oAppComponent.getRootControl());const s=this.oAppComponent.getNavigationService();return o(s.parseNavigation()).catch(function(e){if(!e){e=[]}t.warning("APPSTATE: Parse Navigation failed",e[0]);return[{},e[1],e[2]]}).then(e=>{t.info("APPSTATE: Parse Navigation done");const o=e[0]||{},a=e[2]||h.initial,i=this.oAppComponent.getRootControl().getController();const r=this._getAppStateData(o,n);this._mCurrentAppState=a===h.iAppState?r:undefined;if(!i.viewState){throw new Error(`viewState extension required for controller ${i.getMetadata().getName()}`)}if(!o&&a==h.iAppState){return{}}return i.viewState.applyViewState(this._mCurrentAppState,this._createNavigationParameters(o,a))}).catch(function(e){t.error("appState could not be applied",e);throw e}).finally(()=>{r.unlock(this);r.unlock(this.oAppComponent.getRootControl())})};i.checkIfRouteChangedByIApp=function t(){return this.bNoRouteChange};i.resetRouteChangedByIApp=function t(){if(this.bNoRouteChange){this.bNoRouteChange=false}};return a}(i))||c);return S},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/BaseController-dbg", ["sap/fe/core/CommonUtils", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/mvc/Controller"], function (CommonUtils, ClassSupport, Controller) {
  "use strict";

  var _dec, _dec2, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * Internal base controller class for SAP Fiori elements application.
   *
   * If you want to extend a base controller for your custom page, please use for sap.fe.core.PageController.
   *
   * @hideconstructor
   * @public
   * @since 1.90.0
   */
  let BaseController = (_dec = defineUI5Class("sap.fe.core.BaseController"), _dec2 = publicExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_Controller) {
    _inheritsLoose(BaseController, _Controller);
    function BaseController() {
      return _Controller.apply(this, arguments) || this;
    }
    var _proto = BaseController.prototype;
    /**
     * Returns the current app component.
     *
     * @returns The app component or, if not found, null
     * @alias sap.fe.core.BaseController#getAppComponent
     * @public
     * @since 1.91.0
     */
    _proto.getAppComponent = function getAppComponent() {
      if (!this._oAppComponent) {
        this._oAppComponent = CommonUtils.getAppComponent(this.getView());
      }
      return this._oAppComponent;
    }

    /**
     * Convenience method provided by SAP Fiori elements to enable applications to include the view model by name into each controller.
     *
     * @public
     * @param sName The model name
     * @returns The model instance
     */;
    _proto.getModel = function getModel(sName) {
      return this.getView().getModel(sName);
    }

    /**
     * Convenience method for setting the view model in every controller of the application.
     *
     * @public
     * @param oModel The model instance
     * @param sName The model name
     * @returns The view instance
     */;
    _proto.setModel = function setModel(oModel, sName) {
      return this.getView().setModel(oModel, sName);
    };
    _proto.getResourceBundle = function getResourceBundle(sI18nModelName) {
      if (!sI18nModelName) {
        sI18nModelName = "i18n";
      }
      return this.getAppComponent().getModel(sI18nModelName).getResourceBundle();
    };
    return BaseController;
  }(Controller), (_applyDecoratedDescriptor(_class2.prototype, "getAppComponent", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "getAppComponent"), _class2.prototype)), _class2)) || _class);
  return BaseController;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/BaseController", ["sap/fe/core/CommonUtils","sap/fe/core/helpers/ClassSupport","sap/ui/core/mvc/Controller"],function(e,t,o){"use strict";var n,i,r,p;var u=t.publicExtension;var c=t.defineUI5Class;function l(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;s(e,t)}function s(e,t){s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return s(e,t)}function a(e,t,o,n,i){var r={};Object.keys(n).forEach(function(e){r[e]=n[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}let f=(n=c("sap.fe.core.BaseController"),i=u(),n(r=(p=function(t){l(o,t);function o(){return t.apply(this,arguments)||this}var n=o.prototype;n.getAppComponent=function t(){if(!this._oAppComponent){this._oAppComponent=e.getAppComponent(this.getView())}return this._oAppComponent};n.getModel=function e(t){return this.getView().getModel(t)};n.setModel=function e(t,o){return this.getView().setModel(t,o)};n.getResourceBundle=function e(t){if(!t){t="i18n"}return this.getAppComponent().getModel(t).getResourceBundle()};return o}(o),a(p.prototype,"getAppComponent",[i],Object.getOwnPropertyDescriptor(p.prototype,"getAppComponent"),p.prototype),p))||r);return f},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/CommonUtils-dbg", ["sap/base/Log", "sap/base/util/array/uniqueSort", "sap/base/util/merge", "sap/fe/core/converters/ConverterContext", "sap/fe/core/converters/helpers/IssueManager", "sap/fe/core/converters/MetaModelConverter", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/helpers/SemanticDateOperators", "sap/fe/core/helpers/StableIdHelper", "sap/fe/core/type/EDM", "sap/fe/core/type/TypeUtil", "sap/fe/macros/ODataMetaModelUtil", "sap/ui/core/Component", "sap/ui/core/Core", "sap/ui/core/Fragment", "sap/ui/core/util/XMLPreprocessor", "sap/ui/core/XMLTemplateProcessor", "sap/ui/Device", "sap/ui/mdc/condition/FilterOperatorUtil", "sap/ui/mdc/condition/RangeOperator", "./controls/AnyElement", "./templating/FilterHelper"], function (Log, uniqueSort, mergeObjects, ConverterContext, IssueManager, MetaModelConverter, BindingToolkit, ModelHelper, SemanticDateOperators, StableIdHelper, EDM, TypeUtil, metaModelUtil, Component, Core, Fragment, XMLPreprocessor, XMLTemplateProcessor, Device, FilterOperatorUtil, RangeOperator, AnyElement, FilterHelper) {
  "use strict";

  var _exports = {};
  var getConditions = FilterHelper.getConditions;
  var system = Device.system;
  var isTypeFilterable = EDM.isTypeFilterable;
  var generate = StableIdHelper.generate;
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var not = BindingToolkit.not;
  var compileExpression = BindingToolkit.compileExpression;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategoryType = IssueManager.IssueCategoryType;
  var IssueCategory = IssueManager.IssueCategory;
  function normalizeSearchTerm(sSearchTerm) {
    if (!sSearchTerm) {
      return undefined;
    }
    return sSearchTerm.replace(/"/g, " ").replace(/\\/g, "\\\\") //escape backslash characters. Can be removed if odata/binding handles backend errors responds.
    .split(/\s+/).reduce(function (sNormalized, sCurrentWord) {
      if (sCurrentWord !== "") {
        sNormalized = `${sNormalized ? `${sNormalized} ` : ""}"${sCurrentWord}"`;
      }
      return sNormalized;
    }, undefined);
  }
  function getPropertyDataType(oNavigationContext) {
    let sDataType = oNavigationContext.getProperty("$Type");
    // if $kind exists, it's not a DataField and we have the final type already
    if (!oNavigationContext.getProperty("$kind")) {
      switch (sDataType) {
        case "com.sap.vocabularies.UI.v1.DataFieldForAction":
        case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
          sDataType = undefined;
          break;
        case "com.sap.vocabularies.UI.v1.DataField":
        case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
        case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
        case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
        case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
          sDataType = oNavigationContext.getProperty("Value/$Path/$Type");
          break;
        case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
        default:
          const sAnnotationPath = oNavigationContext.getProperty("Target/$AnnotationPath");
          if (sAnnotationPath) {
            if (sAnnotationPath.indexOf("com.sap.vocabularies.Communication.v1.Contact") > -1) {
              sDataType = oNavigationContext.getProperty("Target/$AnnotationPath/fn/$Path/$Type");
            } else if (sAnnotationPath.indexOf("com.sap.vocabularies.UI.v1.DataPoint") > -1) {
              sDataType = oNavigationContext.getProperty("Value/$Path/$Type");
            } else {
              // e.g. FieldGroup or Chart
              sDataType = undefined;
            }
          } else {
            sDataType = undefined;
          }
          break;
      }
    }
    return sDataType;
  }
  async function waitForContextRequested(bindingContext) {
    var _dataModel$targetEnti;
    const model = bindingContext.getModel();
    const metaModel = model.getMetaModel();
    const entityPath = metaModel.getMetaPath(bindingContext.getPath());
    const dataModel = MetaModelConverter.getInvolvedDataModelObjects(metaModel.getContext(entityPath));
    await bindingContext.requestProperty((_dataModel$targetEnti = dataModel.targetEntityType.keys[0]) === null || _dataModel$targetEnti === void 0 ? void 0 : _dataModel$targetEnti.name);
  }
  function fnHasTransientContexts(oListBinding) {
    let bHasTransientContexts = false;
    if (oListBinding) {
      oListBinding.getCurrentContexts().forEach(function (oContext) {
        if (oContext && oContext.isTransient()) {
          bHasTransientContexts = true;
        }
      });
    }
    return bHasTransientContexts;
  }
  function getSearchRestrictions(sFullPath, oMetaModelContext) {
    let oSearchRestrictions;
    let oNavigationSearchRestrictions;
    const navigationText = "$NavigationPropertyBinding";
    const searchRestrictionsTerm = "@Org.OData.Capabilities.V1.SearchRestrictions";
    const entityTypePathParts = sFullPath.replaceAll("%2F", "/").split("/").filter(ModelHelper.filterOutNavPropBinding);
    const entitySetPath = ModelHelper.getEntitySetPath(sFullPath, oMetaModelContext);
    const entitySetPathParts = entitySetPath.split("/").filter(ModelHelper.filterOutNavPropBinding);
    const isContainment = oMetaModelContext.getObject(`/${entityTypePathParts.join("/")}/$ContainsTarget`);
    const containmentNavPath = isContainment && entityTypePathParts[entityTypePathParts.length - 1];

    //LEAST PRIORITY - Search restrictions directly at Entity Set
    //e.g. FR in "NS.EntityContainer/SalesOrderManage" ContextPath: /SalesOrderManage
    if (!isContainment) {
      oSearchRestrictions = oMetaModelContext.getObject(`${entitySetPath}${searchRestrictionsTerm}`);
    }
    if (entityTypePathParts.length > 1) {
      const navPath = isContainment ? containmentNavPath : entitySetPathParts[entitySetPathParts.length - 1];
      // In case of containment we take entitySet provided as parent. And in case of normal we would remove the last navigation from entitySetPath.
      const parentEntitySetPath = isContainment ? entitySetPath : `/${entitySetPathParts.slice(0, -1).join(`/${navigationText}/`)}`;

      //HIGHEST priority - Navigation restrictions
      //e.g. Parent "/Customer" with NavigationPropertyPath="Set" ContextPath: Customer/Set
      const oNavigationRestrictions = CommonUtils.getNavigationRestrictions(oMetaModelContext, parentEntitySetPath, navPath.replaceAll("%2F", "/"));
      oNavigationSearchRestrictions = oNavigationRestrictions && oNavigationRestrictions["SearchRestrictions"];
    }
    return oNavigationSearchRestrictions || oSearchRestrictions;
  }
  function getNavigationRestrictions(oMetaModelContext, sEntitySetPath, sNavigationPath) {
    const oNavigationRestrictions = oMetaModelContext.getObject(`${sEntitySetPath}@Org.OData.Capabilities.V1.NavigationRestrictions`);
    const aRestrictedProperties = oNavigationRestrictions && oNavigationRestrictions.RestrictedProperties;
    return aRestrictedProperties && aRestrictedProperties.find(function (oRestrictedProperty) {
      return oRestrictedProperty && oRestrictedProperty.NavigationProperty && oRestrictedProperty.NavigationProperty.$NavigationPropertyPath === sNavigationPath;
    });
  }
  function _isInNonFilterableProperties(metamodelContext, sEntitySetPath, sContextPath) {
    let bIsNotFilterable = false;
    const oAnnotation = metamodelContext.getObject(`${sEntitySetPath}@Org.OData.Capabilities.V1.FilterRestrictions`);
    if (oAnnotation && oAnnotation.NonFilterableProperties) {
      bIsNotFilterable = oAnnotation.NonFilterableProperties.some(function (property) {
        return property.$NavigationPropertyPath === sContextPath || property.$PropertyPath === sContextPath;
      });
    }
    return bIsNotFilterable;
  }
  function _isCustomAggregate(metamodelContext, sEntitySetPath, sContextPath) {
    let bCustomAggregate = false;
    const bApplySupported = metamodelContext !== null && metamodelContext !== void 0 && metamodelContext.getObject(sEntitySetPath + "@Org.OData.Aggregation.V1.ApplySupported") ? true : false;
    if (bApplySupported) {
      const oAnnotations = metamodelContext.getObject(`${sEntitySetPath}@`);
      const oCustomAggreggates = metaModelUtil.getAllCustomAggregates(oAnnotations);
      const aCustomAggregates = oCustomAggreggates ? Object.keys(oCustomAggreggates) : undefined;
      if (aCustomAggregates && (aCustomAggregates === null || aCustomAggregates === void 0 ? void 0 : aCustomAggregates.indexOf(sContextPath)) > -1) {
        bCustomAggregate = true;
      }
    }
    return bCustomAggregate;
  }

  // TODO rework this!
  function _isContextPathFilterable(oModelContext, sEntitySetPath, sContexPath) {
    const sFullPath = `${sEntitySetPath}/${sContexPath}`,
      aESParts = sFullPath.split("/").splice(0, 2),
      aContext = sFullPath.split("/").splice(2);
    let bIsNotFilterable = false,
      sContext = "";
    sEntitySetPath = aESParts.join("/");
    bIsNotFilterable = aContext.some(function (item, index, array) {
      if (sContext.length > 0) {
        sContext += `/${item}`;
      } else {
        sContext = item;
      }
      if (index === array.length - 2) {
        // In case of "/Customer/Set/Property" this is to check navigation restrictions of "Customer" for non-filterable properties in "Set"
        const oNavigationRestrictions = getNavigationRestrictions(oModelContext, sEntitySetPath, item);
        const oFilterRestrictions = oNavigationRestrictions && oNavigationRestrictions.FilterRestrictions;
        const aNonFilterableProperties = oFilterRestrictions && oFilterRestrictions.NonFilterableProperties;
        const sTargetPropertyPath = array[array.length - 1];
        if (aNonFilterableProperties && aNonFilterableProperties.find(function (oPropertyPath) {
          return oPropertyPath.$PropertyPath === sTargetPropertyPath;
        })) {
          return true;
        }
      }
      if (index === array.length - 1) {
        //last path segment
        bIsNotFilterable = _isInNonFilterableProperties(oModelContext, sEntitySetPath, sContext);
      } else if (oModelContext.getObject(`${sEntitySetPath}/$NavigationPropertyBinding/${item}`)) {
        //check existing context path and initialize it
        bIsNotFilterable = _isInNonFilterableProperties(oModelContext, sEntitySetPath, sContext);
        sContext = "";
        //set the new EntitySet
        sEntitySetPath = `/${oModelContext.getObject(`${sEntitySetPath}/$NavigationPropertyBinding/${item}`)}`;
      }
      return bIsNotFilterable === true;
    });
    return bIsNotFilterable;
  }

  // TODO check used places and rework this
  function isPropertyFilterable(metaModelContext, sEntitySetPath, sProperty, bSkipHiddenFilter) {
    var _metaModelContext$get;
    if (typeof sProperty !== "string") {
      throw new Error("sProperty parameter must be a string");
    }
    let bIsFilterable;

    // Parameters should be rendered as filterfields
    if (((_metaModelContext$get = metaModelContext.getObject(`${sEntitySetPath}/@com.sap.vocabularies.Common.v1.ResultContext`)) === null || _metaModelContext$get === void 0 ? void 0 : _metaModelContext$get.valueOf()) === true) {
      return true;
    }
    const oNavigationContext = metaModelContext.createBindingContext(`${sEntitySetPath}/${sProperty}`);
    if (!bSkipHiddenFilter) {
      if (oNavigationContext.getProperty("@com.sap.vocabularies.UI.v1.Hidden") === true || oNavigationContext.getProperty("@com.sap.vocabularies.UI.v1.HiddenFilter") === true) {
        return false;
      }
      const sHiddenPath = oNavigationContext.getProperty("@com.sap.vocabularies.UI.v1.Hidden/$Path");
      const sHiddenFilterPath = oNavigationContext.getProperty("@com.sap.vocabularies.UI.v1.HiddenFilter/$Path");
      if (sHiddenPath && sHiddenFilterPath) {
        return compileExpression(not(or(pathInModel(sHiddenPath), pathInModel(sHiddenFilterPath))));
      } else if (sHiddenPath) {
        return compileExpression(not(pathInModel(sHiddenPath)));
      } else if (sHiddenFilterPath) {
        return compileExpression(not(pathInModel(sHiddenFilterPath)));
      }
    }

    // there is no navigation in entitySet path and property path
    bIsFilterable = sEntitySetPath.split("/").length === 2 && sProperty.indexOf("/") < 0 ? !_isInNonFilterableProperties(metaModelContext, sEntitySetPath, sProperty) && !_isCustomAggregate(metaModelContext, sEntitySetPath, sProperty) : !_isContextPathFilterable(metaModelContext, sEntitySetPath, sProperty);
    // check if type can be used for filtering
    if (bIsFilterable && oNavigationContext) {
      const sPropertyDataType = getPropertyDataType(oNavigationContext);
      if (sPropertyDataType) {
        bIsFilterable = sPropertyDataType ? isTypeFilterable(sPropertyDataType) : false;
      } else {
        bIsFilterable = false;
      }
    }
    return bIsFilterable;
  }
  function getShellServices(oControl) {
    return getAppComponent(oControl).getShellServices();
  }
  function getHash() {
    const sHash = window.location.hash;
    return sHash.split("&")[0];
  }
  async function _getSOIntents(oShellServiceHelper, oObjectPageLayout, oSemanticObject, oParam) {
    return oShellServiceHelper.getLinks({
      semanticObject: oSemanticObject,
      params: oParam
    });
  }

  // TO-DO add this as part of applySemanticObjectmappings logic in IntentBasednavigation controller extension
  function _createMappings(oMapping) {
    const aSOMappings = [];
    const aMappingKeys = Object.keys(oMapping);
    let oSemanticMapping;
    for (let i = 0; i < aMappingKeys.length; i++) {
      oSemanticMapping = {
        LocalProperty: {
          $PropertyPath: aMappingKeys[i]
        },
        SemanticObjectProperty: oMapping[aMappingKeys[i]]
      };
      aSOMappings.push(oSemanticMapping);
    }
    return aSOMappings;
  }
  /**
   * @param aLinks
   * @param aExcludedActions
   * @param oTargetParams
   * @param aItems
   * @param aAllowedActions
   */
  function _getRelatedAppsMenuItems(aLinks, aExcludedActions, oTargetParams, aItems, aAllowedActions) {
    for (let i = 0; i < aLinks.length; i++) {
      const oLink = aLinks[i];
      const sIntent = oLink.intent;
      const sAction = sIntent.split("-")[1].split("?")[0];
      if (aAllowedActions && aAllowedActions.includes(sAction)) {
        aItems.push({
          text: oLink.text,
          targetSemObject: sIntent.split("#")[1].split("-")[0],
          targetAction: sAction.split("~")[0],
          targetParams: oTargetParams
        });
      } else if (!aAllowedActions && aExcludedActions && aExcludedActions.indexOf(sAction) === -1) {
        aItems.push({
          text: oLink.text,
          targetSemObject: sIntent.split("#")[1].split("-")[0],
          targetAction: sAction.split("~")[0],
          targetParams: oTargetParams
        });
      }
    }
  }
  function _getRelatedIntents(oAdditionalSemanticObjects, oBindingContext, aManifestSOItems, aLinks) {
    if (aLinks && aLinks.length > 0) {
      const aAllowedActions = oAdditionalSemanticObjects.allowedActions || undefined;
      const aExcludedActions = oAdditionalSemanticObjects.unavailableActions ? oAdditionalSemanticObjects.unavailableActions : [];
      const aSOMappings = oAdditionalSemanticObjects.mapping ? _createMappings(oAdditionalSemanticObjects.mapping) : [];
      const oTargetParams = {
        navigationContexts: oBindingContext,
        semanticObjectMapping: aSOMappings
      };
      _getRelatedAppsMenuItems(aLinks, aExcludedActions, oTargetParams, aManifestSOItems, aAllowedActions);
    }
  }
  async function updateRelateAppsModel(oBindingContext, oEntry, oObjectPageLayout, aSemKeys, oMetaModel, oMetaPath) {
    const oShellServiceHelper = getShellServices(oObjectPageLayout);
    const oParam = {};
    let sCurrentSemObj = "",
      sCurrentAction = "";
    let oSemanticObjectAnnotations;
    let aRelatedAppsMenuItems = [];
    let aExcludedActions = [];
    let aManifestSOKeys;
    async function fnGetParseShellHashAndGetLinks() {
      const oParsedUrl = oShellServiceHelper.parseShellHash(document.location.hash);
      sCurrentSemObj = oParsedUrl.semanticObject; // Current Semantic Object
      sCurrentAction = oParsedUrl.action;
      return _getSOIntents(oShellServiceHelper, oObjectPageLayout, sCurrentSemObj, oParam);
    }
    try {
      if (oEntry) {
        if (aSemKeys && aSemKeys.length > 0) {
          for (let j = 0; j < aSemKeys.length; j++) {
            const sSemKey = aSemKeys[j].$PropertyPath;
            if (!oParam[sSemKey]) {
              oParam[sSemKey] = {
                value: oEntry[sSemKey]
              };
            }
          }
        } else {
          // fallback to Technical Keys if no Semantic Key is present
          const aTechnicalKeys = oMetaModel.getObject(`${oMetaPath}/$Type/$Key`);
          for (const key in aTechnicalKeys) {
            const sObjKey = aTechnicalKeys[key];
            if (!oParam[sObjKey]) {
              oParam[sObjKey] = {
                value: oEntry[sObjKey]
              };
            }
          }
        }
      }
      // Logic to read additional SO from manifest and updated relatedapps model

      const oManifestData = getTargetView(oObjectPageLayout).getViewData();
      const aManifestSOItems = [];
      let semanticObjectIntents;
      if (oManifestData.additionalSemanticObjects) {
        aManifestSOKeys = Object.keys(oManifestData.additionalSemanticObjects);
        for (let key = 0; key < aManifestSOKeys.length; key++) {
          semanticObjectIntents = await Promise.resolve(_getSOIntents(oShellServiceHelper, oObjectPageLayout, aManifestSOKeys[key], oParam));
          _getRelatedIntents(oManifestData.additionalSemanticObjects[aManifestSOKeys[key]], oBindingContext, aManifestSOItems, semanticObjectIntents);
        }
      }
      const internalModelContext = oObjectPageLayout.getBindingContext("internal");
      const aLinks = await fnGetParseShellHashAndGetLinks();
      if (aLinks) {
        if (aLinks.length > 0) {
          var _oManifestData$additi;
          let isSemanticObjectHasSameTargetInManifest = false;
          const oTargetParams = {};
          const aAnnotationsSOItems = [];
          const sEntitySetPath = `${oMetaPath}@`;
          const sEntityTypePath = `${oMetaPath}/@`;
          const oEntitySetAnnotations = oMetaModel.getObject(sEntitySetPath);
          oSemanticObjectAnnotations = CommonUtils.getSemanticObjectAnnotations(oEntitySetAnnotations, sCurrentSemObj);
          if (!oSemanticObjectAnnotations.bHasEntitySetSO) {
            const oEntityTypeAnnotations = oMetaModel.getObject(sEntityTypePath);
            oSemanticObjectAnnotations = CommonUtils.getSemanticObjectAnnotations(oEntityTypeAnnotations, sCurrentSemObj);
          }
          aExcludedActions = oSemanticObjectAnnotations.aUnavailableActions;
          //Skip same application from Related Apps
          aExcludedActions.push(sCurrentAction);
          oTargetParams.navigationContexts = oBindingContext;
          oTargetParams.semanticObjectMapping = oSemanticObjectAnnotations.aMappings;
          _getRelatedAppsMenuItems(aLinks, aExcludedActions, oTargetParams, aAnnotationsSOItems);
          aManifestSOItems.forEach(function (_ref) {
            let {
              targetSemObject
            } = _ref;
            if (aAnnotationsSOItems[0].targetSemObject === targetSemObject) {
              isSemanticObjectHasSameTargetInManifest = true;
            }
          });

          // remove all actions from current hash application if manifest contains empty allowedActions
          if (oManifestData.additionalSemanticObjects && oManifestData.additionalSemanticObjects[aAnnotationsSOItems[0].targetSemObject] && ((_oManifestData$additi = oManifestData.additionalSemanticObjects[aAnnotationsSOItems[0].targetSemObject].allowedActions) === null || _oManifestData$additi === void 0 ? void 0 : _oManifestData$additi.length) === 0) {
            isSemanticObjectHasSameTargetInManifest = true;
          }
          aRelatedAppsMenuItems = isSemanticObjectHasSameTargetInManifest ? aManifestSOItems : aManifestSOItems.concat(aAnnotationsSOItems);
          // If no app in list, related apps button will be hidden
          internalModelContext.setProperty("relatedApps/visibility", aRelatedAppsMenuItems.length > 0);
          internalModelContext.setProperty("relatedApps/items", aRelatedAppsMenuItems);
        } else {
          internalModelContext.setProperty("relatedApps/visibility", false);
        }
      } else {
        internalModelContext.setProperty("relatedApps/visibility", false);
      }
    } catch (error) {
      Log.error("Cannot read links", error);
    }
    return aRelatedAppsMenuItems;
  }
  function _getSemanticObjectAnnotations(oEntityAnnotations, sCurrentSemObj) {
    const oSemanticObjectAnnotations = {
      bHasEntitySetSO: false,
      aAllowedActions: [],
      aUnavailableActions: [],
      aMappings: []
    };
    let sAnnotationMappingTerm, sAnnotationActionTerm;
    let sQualifier;
    for (const key in oEntityAnnotations) {
      if (key.indexOf("com.sap.vocabularies.Common.v1.SemanticObject") > -1 && oEntityAnnotations[key] === sCurrentSemObj) {
        oSemanticObjectAnnotations.bHasEntitySetSO = true;
        sAnnotationMappingTerm = `@${"com.sap.vocabularies.Common.v1.SemanticObjectMapping"}`;
        sAnnotationActionTerm = `@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}`;
        if (key.indexOf("#") > -1) {
          sQualifier = key.split("#")[1];
          sAnnotationMappingTerm = `${sAnnotationMappingTerm}#${sQualifier}`;
          sAnnotationActionTerm = `${sAnnotationActionTerm}#${sQualifier}`;
        }
        if (oEntityAnnotations[sAnnotationMappingTerm]) {
          oSemanticObjectAnnotations.aMappings = oSemanticObjectAnnotations.aMappings.concat(oEntityAnnotations[sAnnotationMappingTerm]);
        }
        if (oEntityAnnotations[sAnnotationActionTerm]) {
          oSemanticObjectAnnotations.aUnavailableActions = oSemanticObjectAnnotations.aUnavailableActions.concat(oEntityAnnotations[sAnnotationActionTerm]);
        }
        break;
      }
    }
    return oSemanticObjectAnnotations;
  }
  function fnUpdateRelatedAppsDetails(oObjectPageLayout) {
    const oMetaModel = oObjectPageLayout.getModel().getMetaModel();
    const oBindingContext = oObjectPageLayout.getBindingContext();
    const path = oBindingContext && oBindingContext.getPath() || "";
    const oMetaPath = oMetaModel.getMetaPath(path);
    // Semantic Key Vocabulary
    const sSemanticKeyVocabulary = `${oMetaPath}/` + `@com.sap.vocabularies.Common.v1.SemanticKey`;
    //Semantic Keys
    const aSemKeys = oMetaModel.getObject(sSemanticKeyVocabulary);
    // Unavailable Actions
    const oEntry = oBindingContext === null || oBindingContext === void 0 ? void 0 : oBindingContext.getObject();
    if (!oEntry && oBindingContext) {
      oBindingContext.requestObject().then(async function (requestedObject) {
        return updateRelateAppsModel(oBindingContext, requestedObject, oObjectPageLayout, aSemKeys, oMetaModel, oMetaPath);
      }).catch(function (oError) {
        Log.error("Cannot update the related app details", oError);
      });
    } else {
      return updateRelateAppsModel(oBindingContext, oEntry, oObjectPageLayout, aSemKeys, oMetaModel, oMetaPath);
    }
  }

  /**
   * @param oButton
   */
  function fnFireButtonPress(oButton) {
    if (oButton && oButton.isA(["sap.m.Button", "sap.m.OverflowToolbarButton"]) && oButton.getVisible() && oButton.getEnabled()) {
      oButton.firePress();
    }
  }
  function fnResolveStringtoBoolean(sValue) {
    if (sValue === "true" || sValue === true) {
      return true;
    } else {
      return false;
    }
  }
  function getAppComponent(oControl) {
    if (oControl.isA("sap.fe.core.AppComponent")) {
      return oControl;
    }
    const oOwner = Component.getOwnerComponentFor(oControl);
    if (!oOwner) {
      throw new Error("There should be a sap.fe.core.AppComponent as owner of the control");
    } else {
      return getAppComponent(oOwner);
    }
  }
  function getCurrentPageView(oAppComponent) {
    const rootViewController = oAppComponent.getRootViewController();
    return rootViewController.isFclEnabled() ? rootViewController.getRightmostView() : CommonUtils.getTargetView(oAppComponent.getRootContainer().getCurrentPage());
  }
  function getTargetView(oControl) {
    if (oControl && oControl.isA("sap.ui.core.ComponentContainer")) {
      const oComponent = oControl.getComponentInstance();
      oControl = oComponent && oComponent.getRootControl();
    }
    while (oControl && !oControl.isA("sap.ui.core.mvc.View")) {
      oControl = oControl.getParent();
    }
    return oControl;
  }
  function isFieldControlPathInapplicable(sFieldControlPath, oAttribute) {
    let bInapplicable = false;
    const aParts = sFieldControlPath.split("/");
    // sensitive data is removed only if the path has already been resolved.
    if (aParts.length > 1) {
      bInapplicable = oAttribute[aParts[0]] !== undefined && oAttribute[aParts[0]].hasOwnProperty(aParts[1]) && oAttribute[aParts[0]][aParts[1]] === 0;
    } else {
      bInapplicable = oAttribute[sFieldControlPath] === 0;
    }
    return bInapplicable;
  }
  function removeSensitiveData(aAttributes, oMetaModel) {
    const aOutAttributes = [];
    for (let i = 0; i < aAttributes.length; i++) {
      const sEntitySet = aAttributes[i].entitySet,
        oAttribute = aAttributes[i].contextData;
      delete oAttribute["@odata.context"];
      delete oAttribute["%40odata.context"];
      delete oAttribute["@odata.metadataEtag"];
      delete oAttribute["%40odata.metadataEtag"];
      delete oAttribute["SAP__Messages"];
      const aProperties = Object.keys(oAttribute);
      for (let j = 0; j < aProperties.length; j++) {
        const sProp = aProperties[j],
          aPropertyAnnotations = oMetaModel.getObject(`/${sEntitySet}/${sProp}@`);
        if (aPropertyAnnotations) {
          if (aPropertyAnnotations["@com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"] || aPropertyAnnotations["@com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"] || aPropertyAnnotations["@com.sap.vocabularies.Analytics.v1.Measure"]) {
            delete oAttribute[sProp];
          } else if (aPropertyAnnotations["@com.sap.vocabularies.Common.v1.FieldControl"]) {
            const oFieldControl = aPropertyAnnotations["@com.sap.vocabularies.Common.v1.FieldControl"];
            if (oFieldControl["$EnumMember"] && oFieldControl["$EnumMember"].split("/")[1] === "Inapplicable") {
              delete oAttribute[sProp];
            } else if (oFieldControl["$Path"] && CommonUtils.isFieldControlPathInapplicable(oFieldControl["$Path"], oAttribute)) {
              delete oAttribute[sProp];
            }
          }
        }
      }
      aOutAttributes.push(oAttribute);
    }
    return aOutAttributes;
  }
  function _fnCheckIsMatch(oObject, oKeysToCheck) {
    for (const sKey in oKeysToCheck) {
      if (oKeysToCheck[sKey] !== oObject[sKey]) {
        return false;
      }
    }
    return true;
  }
  function fnGetContextPathProperties(metaModelContext, sContextPath, oFilter) {
    const oEntityType = metaModelContext.getObject(`${sContextPath}/`) || {},
      oProperties = {};
    for (const sKey in oEntityType) {
      if (oEntityType.hasOwnProperty(sKey) && !/^\$/i.test(sKey) && oEntityType[sKey].$kind && _fnCheckIsMatch(oEntityType[sKey], oFilter || {
        $kind: "Property"
      })) {
        oProperties[sKey] = oEntityType[sKey];
      }
    }
    return oProperties;
  }
  function fnGetMandatoryFilterFields(oMetaModel, sContextPath) {
    let aMandatoryFilterFields = [];
    if (oMetaModel && sContextPath) {
      aMandatoryFilterFields = oMetaModel.getObject(`${sContextPath}@Org.OData.Capabilities.V1.FilterRestrictions/RequiredProperties`);
    }
    return aMandatoryFilterFields;
  }
  function fnGetIBNActions(oControl, aIBNActions) {
    const aActions = oControl && oControl.getActions();
    if (aActions) {
      aActions.forEach(function (oAction) {
        if (oAction.isA("sap.ui.mdc.actiontoolbar.ActionToolbarAction")) {
          oAction = oAction.getAction();
        }
        if (oAction.isA("sap.m.MenuButton")) {
          const oMenu = oAction.getMenu();
          const aItems = oMenu.getItems();
          aItems.forEach(oItem => {
            if (oItem.data("IBNData")) {
              aIBNActions.push(oItem);
            }
          });
        } else if (oAction.data("IBNData")) {
          aIBNActions.push(oAction);
        }
      });
    }
    return aIBNActions;
  }

  /**
   * @param aIBNActions
   * @param oView
   */
  function fnUpdateDataFieldForIBNButtonsVisibility(aIBNActions, oView) {
    const oParams = {};
    const isSticky = ModelHelper.isStickySessionSupported(oView.getModel().getMetaModel());
    const fnGetLinks = function (oData) {
      if (oData) {
        const aKeys = Object.keys(oData);
        aKeys.forEach(function (sKey) {
          if (sKey.indexOf("_") !== 0 && sKey.indexOf("odata.context") === -1) {
            oParams[sKey] = {
              value: oData[sKey]
            };
          }
        });
      }
      if (aIBNActions.length) {
        aIBNActions.forEach(function (oIBNAction) {
          const sSemanticObject = oIBNAction.data("IBNData").semanticObject;
          const sAction = oIBNAction.data("IBNData").action;
          CommonUtils.getShellServices(oView).getLinks({
            semanticObject: sSemanticObject,
            action: sAction,
            params: oParams
          }).then(function (aLink) {
            oIBNAction.setVisible(oIBNAction.getVisible() && aLink && aLink.length === 1);
            if (isSticky) {
              oIBNAction.getBindingContext("internal").setProperty(oIBNAction.getId().split("--")[1], {
                shellNavigationNotAvailable: !(aLink && aLink.length === 1)
              });
            }
          }).catch(function (oError) {
            Log.error("Cannot retrieve the links from the shell service", oError);
          });
        });
      }
    };
    if (oView && oView.getBindingContext()) {
      var _oView$getBindingCont;
      (_oView$getBindingCont = oView.getBindingContext()) === null || _oView$getBindingCont === void 0 ? void 0 : _oView$getBindingCont.requestObject().then(function (oData) {
        return fnGetLinks(oData);
      }).catch(function (oError) {
        Log.error("Cannot retrieve the links from the shell service", oError);
      });
    } else {
      fnGetLinks();
    }
  }
  function getTranslatedText(sFrameworkKey, oResourceBundle, parameters, sEntitySetName) {
    let sResourceKey = sFrameworkKey;
    if (oResourceBundle) {
      if (sEntitySetName) {
        // There are console errors logged when making calls to getText for keys that are not defined in the resource bundle
        // for instance keys which are supposed to be provided by the application, e.g, <key>|<entitySet> to override instance specific text
        // hence check if text exists (using "hasText") in the resource bundle before calling "getText"

        // "hasText" only checks for the key in the immediate resource bundle and not it's custom bundles
        // hence we need to do this recurrsively to check if the key exists in any of the bundles the forms the FE resource bundle
        const bResourceKeyExists = checkIfResourceKeyExists(oResourceBundle.aCustomBundles, `${sFrameworkKey}|${sEntitySetName}`);

        // if resource key with entity set name for instance specific text overriding is provided by the application
        // then use the same key otherwise use the Framework key
        sResourceKey = bResourceKeyExists ? `${sFrameworkKey}|${sEntitySetName}` : sFrameworkKey;
      }
      return oResourceBundle.getText(sResourceKey, parameters);
    }

    // do not allow override so get text from the internal bundle directly
    oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
    return oResourceBundle.getText(sResourceKey, parameters);
  }
  function checkIfResourceKeyExists(aCustomBundles, sKey) {
    if (aCustomBundles.length) {
      for (let i = aCustomBundles.length - 1; i >= 0; i--) {
        const sValue = aCustomBundles[i].hasText(sKey);
        // text found return true
        if (sValue) {
          return true;
        }
        checkIfResourceKeyExists(aCustomBundles[i].aCustomBundles, sKey);
      }
    }
    return false;
  }
  function getActionPath(actionContext, bReturnOnlyPath, sActionName, bCheckStaticValue) {
    sActionName = !sActionName ? actionContext.getObject(actionContext.getPath()).toString() : sActionName;
    let sContextPath = actionContext.getPath().split("/@")[0];
    const sEntityTypeName = actionContext.getObject(sContextPath).$Type;
    const sEntityName = getEntitySetName(actionContext.getModel(), sEntityTypeName);
    if (sEntityName) {
      sContextPath = `/${sEntityName}`;
    }
    if (bCheckStaticValue) {
      return actionContext.getObject(`${sContextPath}/${sActionName}@Org.OData.Core.V1.OperationAvailable`);
    }
    if (bReturnOnlyPath) {
      return `${sContextPath}/${sActionName}`;
    } else {
      return {
        sContextPath: sContextPath,
        sProperty: actionContext.getObject(`${sContextPath}/${sActionName}@Org.OData.Core.V1.OperationAvailable/$Path`),
        sBindingParameter: actionContext.getObject(`${sContextPath}/${sActionName}/@$ui5.overload/0/$Parameter/0/$Name`)
      };
    }
  }
  function getEntitySetName(oMetaModel, sEntityType) {
    const oEntityContainer = oMetaModel.getObject("/");
    for (const key in oEntityContainer) {
      if (typeof oEntityContainer[key] === "object" && oEntityContainer[key].$Type === sEntityType) {
        return key;
      }
    }
  }
  function computeDisplayMode(oPropertyAnnotations, oCollectionAnnotations) {
    const oTextAnnotation = oPropertyAnnotations["@com.sap.vocabularies.Common.v1.Text"],
      oTextArrangementAnnotation = oTextAnnotation && (oPropertyAnnotations && oPropertyAnnotations["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"] || oCollectionAnnotations && oCollectionAnnotations["@com.sap.vocabularies.UI.v1.TextArrangement"]);
    if (oTextArrangementAnnotation) {
      if (oTextArrangementAnnotation.$EnumMember === "com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly") {
        return "Description";
      } else if (oTextArrangementAnnotation.$EnumMember === "com.sap.vocabularies.UI.v1.TextArrangementType/TextLast") {
        return "ValueDescription";
      } else if (oTextArrangementAnnotation.$EnumMember === "com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate") {
        return "Value";
      }
      //Default should be TextFirst if there is a Text annotation and neither TextOnly nor TextLast are set
      return "DescriptionValue";
    }
    return oTextAnnotation ? "DescriptionValue" : "Value";
  }
  function _getEntityType(oContext) {
    const oMetaModel = oContext.getModel().getMetaModel();
    return oMetaModel.getObject(`${oMetaModel.getMetaPath(oContext.getPath())}/$Type`);
  }
  async function _requestObject(sAction, oSelectedContext, sProperty) {
    let oContext = oSelectedContext;
    const nBracketIndex = sAction.indexOf("(");
    if (nBracketIndex > -1) {
      const sTargetType = sAction.slice(nBracketIndex + 1, -1);
      let sCurrentType = _getEntityType(oContext);
      while (sCurrentType !== sTargetType) {
        // Find parent binding context and retrieve entity type
        oContext = oContext.getBinding().getContext();
        if (oContext) {
          sCurrentType = _getEntityType(oContext);
        } else {
          Log.warning("Cannot determine target type to request property value for bound action invocation");
          return Promise.resolve(undefined);
        }
      }
    }
    return oContext.requestObject(sProperty);
  }
  async function requestProperty(oSelectedContext, sAction, sProperty, sDynamicActionEnabledPath) {
    const oPromise = sProperty && sProperty.indexOf("/") === 0 ? requestSingletonProperty(sProperty, oSelectedContext.getModel()) : _requestObject(sAction, oSelectedContext, sProperty);
    return oPromise.then(async function (vPropertyValue) {
      return Promise.resolve({
        vPropertyValue: vPropertyValue,
        oSelectedContext: oSelectedContext,
        sAction: sAction,
        sDynamicActionEnabledPath: sDynamicActionEnabledPath
      });
    });
  }
  async function setContextsBasedOnOperationAvailable(oInternalModelContext, aRequestPromises) {
    return Promise.all(aRequestPromises).then(function (aResults) {
      if (aResults.length) {
        const aApplicableContexts = [],
          aNotApplicableContexts = [];
        aResults.forEach(function (aResult) {
          if (aResult) {
            if (aResult.vPropertyValue) {
              oInternalModelContext.getModel().setProperty(aResult.sDynamicActionEnabledPath, true);
              aApplicableContexts.push(aResult.oSelectedContext);
            } else {
              aNotApplicableContexts.push(aResult.oSelectedContext);
            }
          }
        });
        setDynamicActionContexts(oInternalModelContext, aResults[0].sAction, aApplicableContexts, aNotApplicableContexts);
      }
    }).catch(function (oError) {
      Log.trace("Cannot retrieve property value from path", oError);
    });
  }

  /**
   * @param oInternalModelContext
   * @param sAction
   * @param aApplicable
   * @param aNotApplicable
   */
  function setDynamicActionContexts(oInternalModelContext, sAction, aApplicable, aNotApplicable) {
    const sDynamicActionPathPrefix = `${oInternalModelContext.getPath()}/dynamicActions/${sAction}`,
      oInternalModel = oInternalModelContext.getModel();
    oInternalModel.setProperty(`${sDynamicActionPathPrefix}/aApplicable`, aApplicable);
    oInternalModel.setProperty(`${sDynamicActionPathPrefix}/aNotApplicable`, aNotApplicable);
  }
  function _getDefaultOperators(sPropertyType) {
    // mdc defines the full set of operations that are meaningful for each Edm Type
    // TODO Replace with model / internal way of retrieving the actual model type used for the property
    const oDataClass = TypeUtil.getDataTypeClassName(sPropertyType);
    // TODO need to pass proper formatOptions, constraints here
    const oBaseType = TypeUtil.getBaseType(oDataClass, {}, {});
    return FilterOperatorUtil.getOperatorsForType(oBaseType);
  }
  function _getRestrictions(aDefaultOps, aExpressionOps) {
    // From the default set of Operators for the Base Type, select those that are defined in the Allowed Value.
    // In case that no operators are found, return undefined so that the default set is used.
    return aDefaultOps.filter(function (sElement) {
      return aExpressionOps.indexOf(sElement) > -1;
    });
  }
  function getSpecificAllowedExpression(aExpressions) {
    const aAllowedExpressionsPriority = CommonUtils.AllowedExpressionsPrio;
    aExpressions.sort(function (a, b) {
      return aAllowedExpressionsPriority.indexOf(a) - aAllowedExpressionsPriority.indexOf(b);
    });
    return aExpressions[0];
  }

  /**
   * Method to fetch the correct operators based on the filter restrictions that can be annotated on an entity set or a navigation property.
   * We return the correct operators based on the specified restriction and also check for the operators defined in the manifest to include or exclude them.
   *
   * @param sProperty String name of the property
   * @param sEntitySetPath String path to the entity set
   * @param oContext Context used during templating
   * @param sType String data type od the property, for example edm.Date
   * @param bUseSemanticDateRange Boolean passed from the manifest for semantic date range
   * @param sSettings Stringified object of the property settings
   * @returns An array of strings representing operators for filtering
   */
  function getOperatorsForProperty(sProperty, sEntitySetPath, oContext, sType, bUseSemanticDateRange, sSettings) {
    const oFilterRestrictions = CommonUtils.getFilterRestrictionsByPath(sEntitySetPath, oContext);
    const aEqualsOps = ["EQ"];
    const aSingleRangeOps = ["EQ", "GE", "LE", "LT", "GT", "BT", "NOTLE", "NOTLT", "NOTGE", "NOTGT"];
    const aSingleRangeDTBasicOps = ["EQ", "BT"];
    const aSingleValueDateOps = ["TODAY", "TOMORROW", "YESTERDAY", "DATE", "FIRSTDAYWEEK", "LASTDAYWEEK", "FIRSTDAYMONTH", "LASTDAYMONTH", "FIRSTDAYQUARTER", "LASTDAYQUARTER", "FIRSTDAYYEAR", "LASTDAYYEAR"];
    const aBasicDateTimeOps = ["EQ", "BT"];
    const aMultiRangeOps = ["EQ", "GE", "LE", "LT", "GT", "BT", "NE", "NOTBT", "NOTLE", "NOTLT", "NOTGE", "NOTGT"];
    const aSearchExpressionOps = ["Contains", "NotContains", "StartsWith", "NotStartsWith", "EndsWith", "NotEndsWith"];
    const aSemanticDateOpsExt = SemanticDateOperators.getSupportedOperations();
    const bSemanticDateRange = bUseSemanticDateRange === "true" || bUseSemanticDateRange === true;
    let aSemanticDateOps = [];
    const oSettings = sSettings && typeof sSettings === "string" ? JSON.parse(sSettings).customData : sSettings;
    if (oContext.getObject(`${sEntitySetPath}/@com.sap.vocabularies.Common.v1.ResultContext`) === true) {
      return aEqualsOps;
    }
    if (oSettings && oSettings.operatorConfiguration && oSettings.operatorConfiguration.length > 0) {
      aSemanticDateOps = SemanticDateOperators.getFilterOperations(oSettings.operatorConfiguration);
    } else {
      aSemanticDateOps = SemanticDateOperators.getSemanticDateOperations();
    }
    // Get the default Operators for this Property Type
    let aDefaultOperators = _getDefaultOperators(sType);
    if (bSemanticDateRange) {
      aDefaultOperators = aSemanticDateOpsExt.concat(aDefaultOperators);
    }
    let restrictions = [];

    // Is there a Filter Restriction defined for this property?
    if (oFilterRestrictions && oFilterRestrictions.FilterAllowedExpressions && oFilterRestrictions.FilterAllowedExpressions[sProperty]) {
      // Extending the default operators list with Semantic Date options DATERANGE, DATE, FROM and TO
      const sAllowedExpression = CommonUtils.getSpecificAllowedExpression(oFilterRestrictions.FilterAllowedExpressions[sProperty]);
      // In case more than one Allowed Expressions has been defined for a property
      // choose the most restrictive Allowed Expression

      // MultiValue has same Operator as SingleValue, but there can be more than one (maxConditions)
      switch (sAllowedExpression) {
        case "SingleValue":
          const aSingleValueOps = sType === "Edm.Date" && bSemanticDateRange ? aSingleValueDateOps : aEqualsOps;
          restrictions = _getRestrictions(aDefaultOperators, aSingleValueOps);
          break;
        case "MultiValue":
          restrictions = _getRestrictions(aDefaultOperators, aEqualsOps);
          break;
        case "SingleRange":
          let aExpressionOps;
          if (bSemanticDateRange) {
            if (sType === "Edm.Date") {
              aExpressionOps = aSemanticDateOps;
            } else if (sType === "Edm.DateTimeOffset") {
              aExpressionOps = aSemanticDateOps.concat(aBasicDateTimeOps);
            } else {
              aExpressionOps = aSingleRangeOps;
            }
          } else if (sType === "Edm.DateTimeOffset") {
            aExpressionOps = aSingleRangeDTBasicOps;
          } else {
            aExpressionOps = aSingleRangeOps;
          }
          const sOperators = _getRestrictions(aDefaultOperators, aExpressionOps);
          restrictions = sOperators;
          break;
        case "MultiRange":
          restrictions = _getRestrictions(aDefaultOperators, aMultiRangeOps);
          break;
        case "SearchExpression":
          restrictions = _getRestrictions(aDefaultOperators, aSearchExpressionOps);
          break;
        case "MultiRangeOrSearchExpression":
          restrictions = _getRestrictions(aDefaultOperators, aSearchExpressionOps.concat(aMultiRangeOps));
          break;
        default:
          break;
      }
      // In case AllowedExpressions is not recognised, undefined in return results in the default set of
      // operators for the type.
    }

    return restrictions;
  }

  /**
   * Method to return allowed operators for type Guid.
   *
   * @function
   * @name getOperatorsForGuidProperty
   * @returns Allowed operators for type Guid
   */
  _exports.getOperatorsForProperty = getOperatorsForProperty;
  function getOperatorsForGuidProperty() {
    const allowedOperatorsForGuid = ["EQ", "NE"];
    return allowedOperatorsForGuid.toString();
  }
  function getOperatorsForDateProperty(propertyType) {
    // In case AllowedExpressions is not provided for type Edm.Date then all the default
    // operators for the type should be returned excluding semantic operators from the list.
    const aDefaultOperators = _getDefaultOperators(propertyType);
    const aMultiRangeOps = ["EQ", "GE", "LE", "LT", "GT", "BT", "NE", "NOTBT", "NOTLE", "NOTLT", "NOTGE", "NOTGT"];
    return _getRestrictions(aDefaultOperators, aMultiRangeOps);
  }
  function getParameterInfo(metaModelContext, sContextPath) {
    const sParameterContextPath = sContextPath.substring(0, sContextPath.lastIndexOf("/"));
    const bResultContext = metaModelContext.getObject(`${sParameterContextPath}/@com.sap.vocabularies.Common.v1.ResultContext`);
    const oParameterInfo = {};
    if (bResultContext && sParameterContextPath !== sContextPath) {
      oParameterInfo.contextPath = sParameterContextPath;
      oParameterInfo.parameterProperties = CommonUtils.getContextPathProperties(metaModelContext, sParameterContextPath);
    }
    return oParameterInfo;
  }

  /**
   * Method to add the select Options to filter conditions.
   *
   * @function
   * @name addSelectOptionToConditions
   * @param oPropertyMetadata Property metadata information
   * @param aValidOperators Operators for all the data types
   * @param aSemanticDateOperators Operators for the Date type
   * @param aCumulativeConditions Filter conditions
   * @param oSelectOption Selectoption of selection variant
   * @returns The filter conditions
   */
  function addSelectOptionToConditions(oPropertyMetadata, aValidOperators, aSemanticDateOperators, aCumulativeConditions, oSelectOption) {
    var _oSelectOption$Semant;
    const oCondition = getConditions(oSelectOption, oPropertyMetadata);
    if (oSelectOption !== null && oSelectOption !== void 0 && oSelectOption.SemanticDates && aSemanticDateOperators && aSemanticDateOperators.indexOf(oSelectOption === null || oSelectOption === void 0 ? void 0 : (_oSelectOption$Semant = oSelectOption.SemanticDates) === null || _oSelectOption$Semant === void 0 ? void 0 : _oSelectOption$Semant.operator) > -1) {
      const semanticDates = CommonUtils.addSemanticDatesToConditions(oSelectOption === null || oSelectOption === void 0 ? void 0 : oSelectOption.SemanticDates);
      if (semanticDates && Object.keys(semanticDates).length > 0) {
        aCumulativeConditions.push(semanticDates);
      }
    } else if (oCondition) {
      if (aValidOperators.length === 0 || aValidOperators.indexOf(oCondition.operator) > -1) {
        aCumulativeConditions.push(oCondition);
      }
    }
    return aCumulativeConditions;
  }

  /**
   * Method to add the semantic dates to filter conditions
   *
   * @function
   * @name addSemanticDatesToConditions
   * @param oSemanticDates Semantic date infomation
   * @returns The filter conditions containing semantic dates
   */

  function addSemanticDatesToConditions(oSemanticDates) {
    const values = [];
    if (oSemanticDates !== null && oSemanticDates !== void 0 && oSemanticDates.high) {
      values.push(oSemanticDates === null || oSemanticDates === void 0 ? void 0 : oSemanticDates.high);
    }
    if (oSemanticDates !== null && oSemanticDates !== void 0 && oSemanticDates.low) {
      values.push(oSemanticDates === null || oSemanticDates === void 0 ? void 0 : oSemanticDates.low);
    }
    return {
      values: values,
      operator: oSemanticDates === null || oSemanticDates === void 0 ? void 0 : oSemanticDates.operator,
      isEmpty: undefined
    };
  }
  function addSelectOptionsToConditions(sContextPath, oSelectionVariant, sSelectOptionProp, oConditions, sConditionPath, sConditionProp, oValidProperties, metaModelContext, isParameter, bIsFLPValuePresent, bUseSemanticDateRange, oViewData) {
    let aConditions = [],
      aSelectOptions,
      aValidOperators,
      aSemanticDateOperators = [];
    if (isParameter || CommonUtils.isPropertyFilterable(metaModelContext, sContextPath, sConditionProp, true)) {
      const oPropertyMetadata = oValidProperties[sConditionProp];
      aSelectOptions = oSelectionVariant.getSelectOption(sSelectOptionProp);
      const settings = getFilterConfigurationSetting(oViewData, sConditionProp);
      aValidOperators = isParameter ? ["EQ"] : CommonUtils.getOperatorsForProperty(sConditionProp, sContextPath, metaModelContext);
      if (bUseSemanticDateRange) {
        aSemanticDateOperators = isParameter ? ["EQ"] : CommonUtils.getOperatorsForProperty(sConditionProp, sContextPath, metaModelContext, oPropertyMetadata === null || oPropertyMetadata === void 0 ? void 0 : oPropertyMetadata.$Type, bUseSemanticDateRange, settings);
      }
      // Create conditions for all the selectOptions of the property
      aConditions = isParameter ? CommonUtils.addSelectOptionToConditions(oPropertyMetadata, aValidOperators, aSemanticDateOperators, aConditions, aSelectOptions[0]) : aSelectOptions.reduce(CommonUtils.addSelectOptionToConditions.bind(null, oPropertyMetadata, aValidOperators, aSemanticDateOperators), aConditions);
      if (aConditions.length) {
        if (sConditionPath) {
          oConditions[sConditionPath + sConditionProp] = oConditions.hasOwnProperty(sConditionPath + sConditionProp) ? oConditions[sConditionPath + sConditionProp].concat(aConditions) : aConditions;
        } else if (bIsFLPValuePresent) {
          // If FLP values are present replace it with FLP values
          aConditions.forEach(element => {
            element["filtered"] = true;
          });
          if (oConditions.hasOwnProperty(sConditionProp)) {
            oConditions[sConditionProp].forEach(element => {
              element["filtered"] = false;
            });
            oConditions[sConditionProp] = oConditions[sConditionProp].concat(aConditions);
          } else {
            oConditions[sConditionProp] = aConditions;
          }
        } else {
          oConditions[sConditionProp] = oConditions.hasOwnProperty(sConditionProp) ? oConditions[sConditionProp].concat(aConditions) : aConditions;
        }
      }
    }
  }

  /**
   * Method to create the semantic dates from filter conditions
   *
   * @function
   * @name createSemanticDatesFromConditions
   * @param oCondition Filter field condition
   * @param sFilterName Filter Field Path
   * @returns The Semantic date conditions
   */

  function createSemanticDatesFromConditions(oCondition) {
    var _oCondition$values, _oCondition$values2;
    return {
      high: (oCondition === null || oCondition === void 0 ? void 0 : (_oCondition$values = oCondition.values) === null || _oCondition$values === void 0 ? void 0 : _oCondition$values[0]) || null,
      low: (oCondition === null || oCondition === void 0 ? void 0 : (_oCondition$values2 = oCondition.values) === null || _oCondition$values2 === void 0 ? void 0 : _oCondition$values2[1]) || null,
      operator: oCondition === null || oCondition === void 0 ? void 0 : oCondition.operator
    };
  }

  /**
   * Method to Return the filter configuration
   *
   * @function
   * @name getFilterConfigurationSetting
   * @param oViewData manifest Configuration
   * @param sProperty Filter Field Path
   * @returns The Filter Field Configuration
   */

  function getFilterConfigurationSetting() {
    var _oConfig$ComSapVoc, _filterConfig$sProper;
    let oViewData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    let sProperty = arguments.length > 1 ? arguments[1] : undefined;
    const oConfig = oViewData === null || oViewData === void 0 ? void 0 : oViewData.controlConfiguration;
    const filterConfig = oConfig && ((_oConfig$ComSapVoc = oConfig["@com.sap.vocabularies.UI.v1.SelectionFields"]) === null || _oConfig$ComSapVoc === void 0 ? void 0 : _oConfig$ComSapVoc.filterFields);
    return filterConfig !== null && filterConfig !== void 0 && filterConfig[sProperty] ? (_filterConfig$sProper = filterConfig[sProperty]) === null || _filterConfig$sProper === void 0 ? void 0 : _filterConfig$sProper.settings : undefined;
  }
  function addSelectionVariantToConditions(oSelectionVariant, oConditions, oMetaModelContext, sContextPath, bIsFLPValues, bUseSemanticDateRange, oViewData) {
    const aSelectOptionsPropertyNames = oSelectionVariant.getSelectOptionsPropertyNames(),
      oValidProperties = CommonUtils.getContextPathProperties(oMetaModelContext, sContextPath),
      aMetadatProperties = Object.keys(oValidProperties),
      oParameterInfo = CommonUtils.getParameterInfo(oMetaModelContext, sContextPath),
      sParameterContextPath = oParameterInfo.contextPath,
      oValidParameterProperties = oParameterInfo.parameterProperties;
    if (sParameterContextPath !== undefined && oValidParameterProperties && Object.keys(oValidParameterProperties).length > 0) {
      const aMetadataParameters = Object.keys(oValidParameterProperties);
      aMetadataParameters.forEach(function (sMetadataParameter) {
        let sSelectOptionName;
        if (aSelectOptionsPropertyNames.includes(`$Parameter.${sMetadataParameter}`)) {
          sSelectOptionName = `$Parameter.${sMetadataParameter}`;
        } else if (aSelectOptionsPropertyNames.includes(sMetadataParameter)) {
          sSelectOptionName = sMetadataParameter;
        } else if (sMetadataParameter.startsWith("P_") && aSelectOptionsPropertyNames.includes(`$Parameter.${sMetadataParameter.slice(2, sMetadataParameter.length)}`)) {
          sSelectOptionName = `$Parameter.${sMetadataParameter.slice(2, sMetadataParameter.length)}`;
        } else if (sMetadataParameter.startsWith("P_") && aSelectOptionsPropertyNames.includes(sMetadataParameter.slice(2, sMetadataParameter.length))) {
          sSelectOptionName = sMetadataParameter.slice(2, sMetadataParameter.length);
        } else if (aSelectOptionsPropertyNames.includes(`$Parameter.P_${sMetadataParameter}`)) {
          sSelectOptionName = `$Parameter.P_${sMetadataParameter}`;
        } else if (aSelectOptionsPropertyNames.includes(`P_${sMetadataParameter}`)) {
          sSelectOptionName = `P_${sMetadataParameter}`;
        }
        if (sSelectOptionName) {
          addSelectOptionsToConditions(sParameterContextPath, oSelectionVariant, sSelectOptionName, oConditions, undefined, sMetadataParameter, oValidParameterProperties, oMetaModelContext, true, bIsFLPValues, bUseSemanticDateRange, oViewData);
        }
      });
    }
    aMetadatProperties.forEach(function (sMetadataProperty) {
      let sSelectOptionName;
      if (aSelectOptionsPropertyNames.includes(sMetadataProperty)) {
        sSelectOptionName = sMetadataProperty;
      } else if (sMetadataProperty.startsWith("P_") && aSelectOptionsPropertyNames.includes(sMetadataProperty.slice(2, sMetadataProperty.length))) {
        sSelectOptionName = sMetadataProperty.slice(2, sMetadataProperty.length);
      } else if (aSelectOptionsPropertyNames.includes(`P_${sMetadataProperty}`)) {
        sSelectOptionName = `P_${sMetadataProperty}`;
      }
      if (sSelectOptionName) {
        addSelectOptionsToConditions(sContextPath, oSelectionVariant, sSelectOptionName, oConditions, undefined, sMetadataProperty, oValidProperties, oMetaModelContext, false, bIsFLPValues, bUseSemanticDateRange, oViewData);
      }
    });
    aSelectOptionsPropertyNames.forEach(function (sSelectOption) {
      if (sSelectOption.indexOf(".") > 0 && !sSelectOption.includes("$Parameter")) {
        const sReplacedOption = sSelectOption.replaceAll(".", "/");
        const sFullContextPath = `/${sReplacedOption}`.startsWith(sContextPath) ? `/${sReplacedOption}` : `${sContextPath}/${sReplacedOption}`; // check if the full path, eg SalesOrderManage._Item.Material exists in the metamodel
        if (oMetaModelContext.getObject(sFullContextPath.replace("P_", ""))) {
          _createConditionsForNavProperties(sFullContextPath, sContextPath, oSelectionVariant, sSelectOption, oMetaModelContext, oConditions, bIsFLPValues, bUseSemanticDateRange, oViewData);
        }
      }
    });
    return oConditions;
  }
  function _createConditionsForNavProperties(sFullContextPath, sMainEntitySetPath, oSelectionVariant, sSelectOption, oMetaModelContext, oConditions, bIsFLPValuePresent, bSemanticDateRange, oViewData) {
    let aNavObjectNames = sSelectOption.split(".");
    // Eg: "SalesOrderManage._Item._Material.Material" or "_Item.Material"
    if (`/${sSelectOption.replaceAll(".", "/")}`.startsWith(sMainEntitySetPath)) {
      const sFullPath = `/${sSelectOption}`.replaceAll(".", "/"),
        sNavPath = sFullPath.replace(`${sMainEntitySetPath}/`, "");
      aNavObjectNames = sNavPath.split("/");
    }
    let sConditionPath = "";
    const sPropertyName = aNavObjectNames[aNavObjectNames.length - 1]; // Material from SalesOrderManage._Item.Material
    for (let i = 0; i < aNavObjectNames.length - 1; i++) {
      if (oMetaModelContext.getObject(`${sMainEntitySetPath}/${aNavObjectNames[i].replace("P_", "")}`).$isCollection) {
        sConditionPath = `${sConditionPath + aNavObjectNames[i]}*/`; // _Item*/ in case of 1:n cardinality
      } else {
        sConditionPath = `${sConditionPath + aNavObjectNames[i]}/`; // _Item/ in case of 1:1 cardinality
      }

      sMainEntitySetPath = `${sMainEntitySetPath}/${aNavObjectNames[i]}`;
    }
    const sNavPropertyPath = sFullContextPath.slice(0, sFullContextPath.lastIndexOf("/")),
      oValidProperties = CommonUtils.getContextPathProperties(oMetaModelContext, sNavPropertyPath),
      aSelectOptionsPropertyNames = oSelectionVariant.getSelectOptionsPropertyNames();
    let sSelectOptionName = sPropertyName;
    if (oValidProperties[sPropertyName]) {
      sSelectOptionName = sPropertyName;
    } else if (sPropertyName.startsWith("P_") && oValidProperties[sPropertyName.replace("P_", "")]) {
      sSelectOptionName = sPropertyName.replace("P_", "");
    } else if (oValidProperties[`P_${sPropertyName}`] && aSelectOptionsPropertyNames.includes(`P_${sPropertyName}`)) {
      sSelectOptionName = `P_${sPropertyName}`;
    }
    if (sPropertyName.startsWith("P_") && oConditions[sConditionPath + sSelectOptionName]) {
      // if there is no SalesOrderManage._Item.Material yet in the oConditions
    } else if (!sPropertyName.startsWith("P_") && oConditions[sConditionPath + sSelectOptionName]) {
      delete oConditions[sConditionPath + sSelectOptionName];
      addSelectOptionsToConditions(sNavPropertyPath, oSelectionVariant, sSelectOption, oConditions, sConditionPath, sSelectOptionName, oValidProperties, oMetaModelContext, false, bIsFLPValuePresent, bSemanticDateRange, oViewData);
    } else {
      addSelectOptionsToConditions(sNavPropertyPath, oSelectionVariant, sSelectOption, oConditions, sConditionPath, sSelectOptionName, oValidProperties, oMetaModelContext, false, bIsFLPValuePresent, bSemanticDateRange, oViewData);
    }
  }
  function addPageContextToSelectionVariant(oSelectionVariant, mPageContext, oView) {
    const oAppComponent = CommonUtils.getAppComponent(oView);
    const oNavigationService = oAppComponent.getNavigationService();
    return oNavigationService.mixAttributesAndSelectionVariant(mPageContext, oSelectionVariant.toJSONString());
  }
  function addExternalStateFiltersToSelectionVariant(oSelectionVariant, mFilters, oTargetInfo, oFilterBar) {
    let sFilter;
    const fnGetSignAndOption = function (sOperator, sLowValue, sHighValue) {
      const oSelectOptionState = {
        option: "",
        sign: "I",
        low: sLowValue,
        high: sHighValue
      };
      switch (sOperator) {
        case "Contains":
          oSelectOptionState.option = "CP";
          break;
        case "StartsWith":
          oSelectOptionState.option = "CP";
          oSelectOptionState.low += "*";
          break;
        case "EndsWith":
          oSelectOptionState.option = "CP";
          oSelectOptionState.low = `*${oSelectOptionState.low}`;
          break;
        case "BT":
        case "LE":
        case "LT":
        case "GT":
        case "NE":
        case "EQ":
          oSelectOptionState.option = sOperator;
          break;
        case "DATE":
          oSelectOptionState.option = "EQ";
          break;
        case "DATERANGE":
          oSelectOptionState.option = "BT";
          break;
        case "FROM":
          oSelectOptionState.option = "GE";
          break;
        case "TO":
          oSelectOptionState.option = "LE";
          break;
        case "EEQ":
          oSelectOptionState.option = "EQ";
          break;
        case "Empty":
          oSelectOptionState.option = "EQ";
          oSelectOptionState.low = "";
          break;
        case "NotContains":
          oSelectOptionState.option = "CP";
          oSelectOptionState.sign = "E";
          break;
        case "NOTBT":
          oSelectOptionState.option = "BT";
          oSelectOptionState.sign = "E";
          break;
        case "NotStartsWith":
          oSelectOptionState.option = "CP";
          oSelectOptionState.low += "*";
          oSelectOptionState.sign = "E";
          break;
        case "NotEndsWith":
          oSelectOptionState.option = "CP";
          oSelectOptionState.low = `*${oSelectOptionState.low}`;
          oSelectOptionState.sign = "E";
          break;
        case "NotEmpty":
          oSelectOptionState.option = "NE";
          oSelectOptionState.low = "";
          break;
        case "NOTLE":
          oSelectOptionState.option = "LE";
          oSelectOptionState.sign = "E";
          break;
        case "NOTGE":
          oSelectOptionState.option = "GE";
          oSelectOptionState.sign = "E";
          break;
        case "NOTLT":
          oSelectOptionState.option = "LT";
          oSelectOptionState.sign = "E";
          break;
        case "NOTGT":
          oSelectOptionState.option = "GT";
          oSelectOptionState.sign = "E";
          break;
        default:
          Log.warning(`${sOperator} is not supported. ${sFilter} could not be added to the navigation context`);
      }
      return oSelectOptionState;
    };
    const oFilterConditions = mFilters.filterConditions;
    const oFiltersWithoutConflict = mFilters.filterConditionsWithoutConflict ? mFilters.filterConditionsWithoutConflict : {};
    const oTablePropertiesWithoutConflict = oTargetInfo.propertiesWithoutConflict ? oTargetInfo.propertiesWithoutConflict : {};
    const addFiltersToSelectionVariant = function (selectionVariant, sFilterName, sPath) {
      const aConditions = oFilterConditions[sFilterName];
      const oPropertyInfo = oFilterBar && oFilterBar.getPropertyHelper().getProperty(sFilterName);
      const oTypeConfig = oPropertyInfo === null || oPropertyInfo === void 0 ? void 0 : oPropertyInfo.typeConfig;
      const oTypeUtil = oFilterBar && oFilterBar.getControlDelegate().getTypeUtil();
      for (const item in aConditions) {
        const oCondition = aConditions[item];
        let option = "",
          sign = "I",
          low = "",
          high = null,
          semanticDates;
        const oOperator = FilterOperatorUtil.getOperator(oCondition.operator);
        if (oOperator instanceof RangeOperator) {
          var _oModelFilter$getFilt;
          semanticDates = CommonUtils.createSemanticDatesFromConditions(oCondition);
          // handling of Date RangeOperators
          const oModelFilter = oOperator.getModelFilter(oCondition, sFilterName, oTypeConfig === null || oTypeConfig === void 0 ? void 0 : oTypeConfig.typeInstance, false, oTypeConfig === null || oTypeConfig === void 0 ? void 0 : oTypeConfig.baseType);
          if (!(oModelFilter !== null && oModelFilter !== void 0 && oModelFilter.getFilters()) && !(oModelFilter !== null && oModelFilter !== void 0 && (_oModelFilter$getFilt = oModelFilter.getFilters()) !== null && _oModelFilter$getFilt !== void 0 && _oModelFilter$getFilt.length)) {
            sign = oOperator.exclude ? "E" : "I";
            low = oTypeUtil.externalizeValue(oModelFilter.getValue1(), oTypeConfig.typeInstance);
            high = oTypeUtil.externalizeValue(oModelFilter.getValue2(), oTypeConfig.typeInstance);
            option = oModelFilter.getOperator();
          }
        } else {
          const aSemanticDateOpsExt = SemanticDateOperators.getSupportedOperations();
          if (aSemanticDateOpsExt.includes(oCondition === null || oCondition === void 0 ? void 0 : oCondition.operator)) {
            semanticDates = CommonUtils.createSemanticDatesFromConditions(oCondition);
          }
          const value1 = oCondition.values[0] && oCondition.values[0].toString() || "";
          const value2 = oCondition.values[1] && oCondition.values[1].toString() || null;
          const oSelectOption = fnGetSignAndOption(oCondition.operator, value1, value2);
          sign = oOperator !== null && oOperator !== void 0 && oOperator.exclude ? "E" : "I";
          low = oSelectOption === null || oSelectOption === void 0 ? void 0 : oSelectOption.low;
          high = oSelectOption === null || oSelectOption === void 0 ? void 0 : oSelectOption.high;
          option = oSelectOption === null || oSelectOption === void 0 ? void 0 : oSelectOption.option;
        }
        if (option && semanticDates) {
          selectionVariant.addSelectOption(sPath ? sPath : sFilterName, sign, option, low, high, undefined, semanticDates);
        } else if (option) {
          selectionVariant.addSelectOption(sPath ? sPath : sFilterName, sign, option, low, high);
        }
      }
    };
    for (sFilter in oFilterConditions) {
      // only add the filter values if it is not already present in the SV already
      if (!oSelectionVariant.getSelectOption(sFilter)) {
        // TODO : custom filters should be ignored more generically
        if (sFilter === "$editState") {
          continue;
        }
        addFiltersToSelectionVariant(oSelectionVariant, sFilter);
      } else {
        if (oTablePropertiesWithoutConflict && sFilter in oTablePropertiesWithoutConflict) {
          addFiltersToSelectionVariant(oSelectionVariant, sFilter, oTablePropertiesWithoutConflict[sFilter]);
        }
        // if property was without conflict in page context then add path from page context to SV
        if (sFilter in oFiltersWithoutConflict) {
          addFiltersToSelectionVariant(oSelectionVariant, sFilter, oFiltersWithoutConflict[sFilter]);
        }
      }
    }
    return oSelectionVariant;
  }
  function isStickyEditMode(oControl) {
    const bIsStickyMode = ModelHelper.isStickySessionSupported(oControl.getModel().getMetaModel());
    const bUIEditable = oControl.getModel("ui").getProperty("/isEditable");
    return bIsStickyMode && bUIEditable;
  }

  /**
   * @param aMandatoryFilterFields
   * @param oSelectionVariant
   * @param oSelectionVariantDefaults
   */
  function addDefaultDisplayCurrency(aMandatoryFilterFields, oSelectionVariant, oSelectionVariantDefaults) {
    if (oSelectionVariant && aMandatoryFilterFields && aMandatoryFilterFields.length) {
      for (let i = 0; i < aMandatoryFilterFields.length; i++) {
        const aSVOption = oSelectionVariant.getSelectOption("DisplayCurrency"),
          aDefaultSVOption = oSelectionVariantDefaults && oSelectionVariantDefaults.getSelectOption("DisplayCurrency");
        if (aMandatoryFilterFields[i].$PropertyPath === "DisplayCurrency" && (!aSVOption || !aSVOption.length) && aDefaultSVOption && aDefaultSVOption.length) {
          const displayCurrencySelectOption = aDefaultSVOption[0];
          const sSign = displayCurrencySelectOption["Sign"];
          const sOption = displayCurrencySelectOption["Option"];
          const sLow = displayCurrencySelectOption["Low"];
          const sHigh = displayCurrencySelectOption["High"];
          oSelectionVariant.addSelectOption("DisplayCurrency", sSign, sOption, sLow, sHigh);
        }
      }
    }
  }
  function getNonComputedVisibleFields(metaModelContext, sPath, oView) {
    const aTechnicalKeys = metaModelContext.getObject(`${sPath}/`).$Key;
    const aNonComputedVisibleFields = [];
    const aImmutableVisibleFields = [];
    const oEntityType = metaModelContext.getObject(`${sPath}/`);
    for (const item in oEntityType) {
      if (oEntityType[item].$kind && oEntityType[item].$kind === "Property") {
        const oAnnotations = metaModelContext.getObject(`${sPath}/${item}@`) || {},
          bIsKey = aTechnicalKeys.indexOf(item) > -1,
          bIsImmutable = oAnnotations["@Org.OData.Core.V1.Immutable"],
          bIsNonComputed = !oAnnotations["@Org.OData.Core.V1.Computed"],
          bIsVisible = !oAnnotations["@com.sap.vocabularies.UI.v1.Hidden"],
          bIsComputedDefaultValue = oAnnotations["@Org.OData.Core.V1.ComputedDefaultValue"],
          bIsKeyComputedDefaultValueWithText = bIsKey && oEntityType[item].$Type === "Edm.Guid" ? bIsComputedDefaultValue && oAnnotations["@com.sap.vocabularies.Common.v1.Text"] : false;
        if ((bIsKeyComputedDefaultValueWithText || bIsKey && oEntityType[item].$Type !== "Edm.Guid") && bIsNonComputed && bIsVisible) {
          aNonComputedVisibleFields.push(item);
        } else if (bIsImmutable && bIsNonComputed && bIsVisible) {
          aImmutableVisibleFields.push(item);
        }
        if (!bIsNonComputed && bIsComputedDefaultValue && oView) {
          var _IssueCategoryType$An;
          const oDiagnostics = getAppComponent(oView).getDiagnostics();
          const sMessage = "Core.ComputedDefaultValue is ignored as Core.Computed is already set to true";
          oDiagnostics.addIssue(IssueCategory.Annotation, IssueSeverity.Medium, sMessage, IssueCategoryType, IssueCategoryType === null || IssueCategoryType === void 0 ? void 0 : (_IssueCategoryType$An = IssueCategoryType.Annotations) === null || _IssueCategoryType$An === void 0 ? void 0 : _IssueCategoryType$An.IgnoredAnnotation);
        }
      }
    }
    const aRequiredProperties = CommonUtils.getRequiredPropertiesFromInsertRestrictions(sPath, metaModelContext);
    if (aRequiredProperties.length) {
      aRequiredProperties.forEach(function (sProperty) {
        const oAnnotations = metaModelContext.getObject(`${sPath}/${sProperty}@`),
          bIsVisible = !oAnnotations || !oAnnotations["@com.sap.vocabularies.UI.v1.Hidden"];
        if (bIsVisible && aNonComputedVisibleFields.indexOf(sProperty) === -1 && aImmutableVisibleFields.indexOf(sProperty) === -1) {
          aNonComputedVisibleFields.push(sProperty);
        }
      });
    }
    return aNonComputedVisibleFields.concat(aImmutableVisibleFields);
  }
  function getRequiredProperties(sPath, metaModelContext) {
    let bCheckUpdateRestrictions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    const aRequiredProperties = [];
    let aRequiredPropertiesWithPaths = [];
    const navigationText = "$NavigationPropertyBinding";
    let oEntitySetAnnotations;
    if (sPath.endsWith("$")) {
      // if sPath comes with a $ in the end, removing it as it is of no significance
      sPath = sPath.replace("/$", "");
    }
    const entityTypePathParts = sPath.replaceAll("%2F", "/").split("/").filter(ModelHelper.filterOutNavPropBinding);
    const entitySetPath = ModelHelper.getEntitySetPath(sPath, metaModelContext);
    const entitySetPathParts = entitySetPath.split("/").filter(ModelHelper.filterOutNavPropBinding);
    const isContainment = metaModelContext.getObject(`/${entityTypePathParts.join("/")}/$ContainsTarget`);
    const containmentNavPath = isContainment && entityTypePathParts[entityTypePathParts.length - 1];

    //Restrictions directly at Entity Set
    //e.g. FR in "NS.EntityContainer/SalesOrderManage" ContextPath: /SalesOrderManage
    if (!isContainment) {
      oEntitySetAnnotations = metaModelContext.getObject(`${entitySetPath}@`);
    }
    if (entityTypePathParts.length > 1) {
      const navPath = isContainment ? containmentNavPath : entitySetPathParts[entitySetPathParts.length - 1];
      const parentEntitySetPath = isContainment ? entitySetPath : `/${entitySetPathParts.slice(0, -1).join(`/${navigationText}/`)}`;
      //Navigation restrictions
      //e.g. Parent "/Customer" with NavigationPropertyPath="Set" ContextPath: Customer/Set
      const oNavRest = CommonUtils.getNavigationRestrictions(metaModelContext, parentEntitySetPath, navPath.replaceAll("%2F", "/"));
      if (oNavRest !== undefined && CommonUtils.hasRestrictedPropertiesInAnnotations(oNavRest, true, bCheckUpdateRestrictions)) {
        aRequiredPropertiesWithPaths = bCheckUpdateRestrictions ? oNavRest["UpdateRestrictions"].RequiredProperties || [] : oNavRest["InsertRestrictions"].RequiredProperties || [];
      }
      if ((!aRequiredPropertiesWithPaths || !aRequiredPropertiesWithPaths.length) && CommonUtils.hasRestrictedPropertiesInAnnotations(oEntitySetAnnotations, false, bCheckUpdateRestrictions)) {
        aRequiredPropertiesWithPaths = CommonUtils.getRequiredPropertiesFromAnnotations(oEntitySetAnnotations, bCheckUpdateRestrictions);
      }
    } else if (CommonUtils.hasRestrictedPropertiesInAnnotations(oEntitySetAnnotations, false, bCheckUpdateRestrictions)) {
      aRequiredPropertiesWithPaths = CommonUtils.getRequiredPropertiesFromAnnotations(oEntitySetAnnotations, bCheckUpdateRestrictions);
    }
    aRequiredPropertiesWithPaths.forEach(function (oRequiredProperty) {
      const sProperty = oRequiredProperty.$PropertyPath;
      aRequiredProperties.push(sProperty);
    });
    return aRequiredProperties;
  }
  function getRequiredPropertiesFromInsertRestrictions(sPath, oMetaModelContext) {
    return CommonUtils.getRequiredProperties(sPath, oMetaModelContext);
  }
  function getRequiredPropertiesFromUpdateRestrictions(sPath, oMetaModelContext) {
    return CommonUtils.getRequiredProperties(sPath, oMetaModelContext, true);
  }
  function getRequiredPropertiesFromAnnotations(oAnnotations) {
    var _oAnnotations$OrgOD2;
    let bCheckUpdateRestrictions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    if (bCheckUpdateRestrictions) {
      var _oAnnotations$OrgOD;
      return ((_oAnnotations$OrgOD = oAnnotations["@Org.OData.Capabilities.V1.UpdateRestrictions"]) === null || _oAnnotations$OrgOD === void 0 ? void 0 : _oAnnotations$OrgOD.RequiredProperties) || [];
    }
    return ((_oAnnotations$OrgOD2 = oAnnotations["@Org.OData.Capabilities.V1.InsertRestrictions"]) === null || _oAnnotations$OrgOD2 === void 0 ? void 0 : _oAnnotations$OrgOD2.RequiredProperties) || [];
  }
  function hasRestrictedPropertiesInAnnotations(oAnnotations) {
    let bIsNavigationRestrictions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let bCheckUpdateRestrictions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    if (bIsNavigationRestrictions) {
      const oNavAnnotations = oAnnotations;
      if (bCheckUpdateRestrictions) {
        return oNavAnnotations && oNavAnnotations["UpdateRestrictions"] && oNavAnnotations["UpdateRestrictions"].RequiredProperties ? true : false;
      }
      return oNavAnnotations && oNavAnnotations["InsertRestrictions"] && oNavAnnotations["InsertRestrictions"].RequiredProperties ? true : false;
    } else if (bCheckUpdateRestrictions) {
      const oEntityAnnotation = oAnnotations;
      return oEntityAnnotation && oEntityAnnotation["@Org.OData.Capabilities.V1.UpdateRestrictions"] && oEntityAnnotation["@Org.OData.Capabilities.V1.UpdateRestrictions"].RequiredProperties ? true : false;
    }
    const oEntityAnnotation = oAnnotations;
    return oEntityAnnotation && oEntityAnnotation["@Org.OData.Capabilities.V1.InsertRestrictions"] && oEntityAnnotation["@Org.OData.Capabilities.V1.InsertRestrictions"].RequiredProperties ? true : false;
  }
  async function setUserDefaults(oAppComponent, aParameters, oModel, bIsAction, bIsCreate, oActionDefaultValues) {
    return new Promise(function (resolve) {
      const oComponentData = oAppComponent.getComponentData(),
        oStartupParameters = oComponentData && oComponentData.startupParameters || {},
        oShellServices = oAppComponent.getShellServices();
      if (!oShellServices.hasUShell()) {
        aParameters.forEach(function (oParameter) {
          var _oParameter$getPath;
          const sPropertyName = bIsAction ? `/${oParameter.$Name}` : (_oParameter$getPath = oParameter.getPath) === null || _oParameter$getPath === void 0 ? void 0 : _oParameter$getPath.call(oParameter).slice(oParameter.getPath().lastIndexOf("/") + 1);
          const sParameterName = bIsAction ? sPropertyName.slice(1) : sPropertyName;
          if (oActionDefaultValues && bIsCreate) {
            if (oActionDefaultValues[sParameterName]) {
              oModel.setProperty(sPropertyName, oActionDefaultValues[sParameterName]);
            }
          } else if (oStartupParameters[sParameterName]) {
            oModel.setProperty(sPropertyName, oStartupParameters[sParameterName][0]);
          }
        });
        return resolve(true);
      }
      return oShellServices.getStartupAppState(oAppComponent).then(function (oStartupAppState) {
        const oData = (oStartupAppState === null || oStartupAppState === void 0 ? void 0 : oStartupAppState.getData()) || {},
          aExtendedParameters = oData.selectionVariant && oData.selectionVariant.SelectOptions || [];
        aParameters.forEach(function (oParameter) {
          var _oParameter$getPath2;
          const sPropertyName = bIsAction ? `/${oParameter.$Name}` : (_oParameter$getPath2 = oParameter.getPath) === null || _oParameter$getPath2 === void 0 ? void 0 : _oParameter$getPath2.call(oParameter).slice(oParameter.getPath().lastIndexOf("/") + 1);
          const sParameterName = bIsAction ? sPropertyName.slice(1) : sPropertyName;
          if (oActionDefaultValues && bIsCreate) {
            if (oActionDefaultValues[sParameterName]) {
              oModel.setProperty(sPropertyName, oActionDefaultValues[sParameterName]);
            }
          } else if (oStartupParameters[sParameterName]) {
            oModel.setProperty(sPropertyName, oStartupParameters[sParameterName][0]);
          } else if (aExtendedParameters.length > 0) {
            for (const i in aExtendedParameters) {
              const oExtendedParameter = aExtendedParameters[i];
              if (oExtendedParameter.PropertyName === sParameterName) {
                const oRange = oExtendedParameter.Ranges.length ? oExtendedParameter.Ranges[oExtendedParameter.Ranges.length - 1] : undefined;
                if (oRange && oRange.Sign === "I" && oRange.Option === "EQ") {
                  oModel.setProperty(sPropertyName, oRange.Low); // high is ignored when Option=EQ
                }
              }
            }
          }
        });

        return resolve(true);
      });
    });
  }
  function getAdditionalParamsForCreate(oStartupParameters, oInboundParameters) {
    const oInbounds = oInboundParameters,
      aCreateParameters = oInbounds !== undefined ? Object.keys(oInbounds).filter(function (sParameter) {
        return oInbounds[sParameter].useForCreate;
      }) : [];
    let oRet;
    for (let i = 0; i < aCreateParameters.length; i++) {
      const sCreateParameter = aCreateParameters[i];
      const aValues = oStartupParameters && oStartupParameters[sCreateParameter];
      if (aValues && aValues.length === 1) {
        oRet = oRet || Object.create(null);
        oRet[sCreateParameter] = aValues[0];
      }
    }
    return oRet;
  }
  function getSemanticObjectMapping(oOutbound) {
    const aSemanticObjectMapping = [];
    if (oOutbound.parameters) {
      const aParameters = Object.keys(oOutbound.parameters) || [];
      if (aParameters.length > 0) {
        aParameters.forEach(function (sParam) {
          const oMapping = oOutbound.parameters[sParam];
          if (oMapping.value && oMapping.value.value && oMapping.value.format === "binding") {
            // using the format of UI.Mapping
            const oSemanticMapping = {
              LocalProperty: {
                $PropertyPath: oMapping.value.value
              },
              SemanticObjectProperty: sParam
            };
            if (aSemanticObjectMapping.length > 0) {
              // To check if the semanticObject Mapping is done for the same local property more that once then first one will be considered
              for (let i = 0; i < aSemanticObjectMapping.length; i++) {
                var _aSemanticObjectMappi;
                if (((_aSemanticObjectMappi = aSemanticObjectMapping[i].LocalProperty) === null || _aSemanticObjectMappi === void 0 ? void 0 : _aSemanticObjectMappi.$PropertyPath) !== oSemanticMapping.LocalProperty.$PropertyPath) {
                  aSemanticObjectMapping.push(oSemanticMapping);
                }
              }
            } else {
              aSemanticObjectMapping.push(oSemanticMapping);
            }
          }
        });
      }
    }
    return aSemanticObjectMapping;
  }
  function getHeaderFacetItemConfigForExternalNavigation(oViewData, oCrossNav) {
    const oHeaderFacetItems = {};
    let sId;
    const oControlConfig = oViewData.controlConfiguration;
    for (const config in oControlConfig) {
      if (config.indexOf("@com.sap.vocabularies.UI.v1.DataPoint") > -1 || config.indexOf("@com.sap.vocabularies.UI.v1.Chart") > -1) {
        var _oControlConfig$confi, _oControlConfig$confi2;
        const sOutbound = (_oControlConfig$confi = oControlConfig[config].navigation) === null || _oControlConfig$confi === void 0 ? void 0 : (_oControlConfig$confi2 = _oControlConfig$confi.targetOutbound) === null || _oControlConfig$confi2 === void 0 ? void 0 : _oControlConfig$confi2.outbound;
        if (sOutbound !== undefined) {
          const oOutbound = oCrossNav[sOutbound];
          if (oOutbound.semanticObject && oOutbound.action) {
            if (config.indexOf("Chart") > -1) {
              sId = generate(["fe", "MicroChartLink", config]);
            } else {
              sId = generate(["fe", "HeaderDPLink", config]);
            }
            const aSemanticObjectMapping = CommonUtils.getSemanticObjectMapping(oOutbound);
            oHeaderFacetItems[sId] = {
              semanticObject: oOutbound.semanticObject,
              action: oOutbound.action,
              semanticObjectMapping: aSemanticObjectMapping
            };
          } else {
            Log.error(`Cross navigation outbound is configured without semantic object and action for ${sOutbound}`);
          }
        }
      }
    }
    return oHeaderFacetItems;
  }
  function setSemanticObjectMappings(oSelectionVariant, vMappings) {
    const oMappings = typeof vMappings === "string" ? JSON.parse(vMappings) : vMappings;
    for (let i = 0; i < oMappings.length; i++) {
      const sLocalProperty = oMappings[i]["LocalProperty"] && oMappings[i]["LocalProperty"]["$PropertyPath"] || oMappings[i]["@com.sap.vocabularies.Common.v1.LocalProperty"] && oMappings[i]["@com.sap.vocabularies.Common.v1.LocalProperty"]["$Path"];
      const sSemanticObjectProperty = oMappings[i]["SemanticObjectProperty"] || oMappings[i]["@com.sap.vocabularies.Common.v1.SemanticObjectProperty"];
      const oSelectOption = oSelectionVariant.getSelectOption(sLocalProperty);
      if (oSelectOption) {
        //Create a new SelectOption with sSemanticObjectProperty as the property Name and remove the older one
        oSelectionVariant.removeSelectOption(sLocalProperty);
        oSelectionVariant.massAddSelectOption(sSemanticObjectProperty, oSelectOption);
      }
    }
    return oSelectionVariant;
  }
  async function fnGetSemanticObjectsFromPath(oMetaModel, sPath, sQualifier) {
    return new Promise(function (resolve) {
      let sSemanticObject, aSemanticObjectUnavailableActions;
      if (sQualifier === "") {
        sSemanticObject = oMetaModel.getObject(`${sPath}@${"com.sap.vocabularies.Common.v1.SemanticObject"}`);
        aSemanticObjectUnavailableActions = oMetaModel.getObject(`${sPath}@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}`);
      } else {
        sSemanticObject = oMetaModel.getObject(`${sPath}@${"com.sap.vocabularies.Common.v1.SemanticObject"}#${sQualifier}`);
        aSemanticObjectUnavailableActions = oMetaModel.getObject(`${sPath}@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}#${sQualifier}`);
      }
      const aSemanticObjectForGetLinks = [{
        semanticObject: sSemanticObject
      }];
      const oSemanticObject = {
        semanticObject: sSemanticObject
      };
      resolve({
        semanticObjectPath: sPath,
        semanticObjectForGetLinks: aSemanticObjectForGetLinks,
        semanticObject: oSemanticObject,
        unavailableActions: aSemanticObjectUnavailableActions
      });
    });
  }
  async function fnUpdateSemanticTargetsModel(aGetLinksPromises, aSemanticObjects, oInternalModelContext, sCurrentHash) {
    return Promise.all(aGetLinksPromises).then(function (aValues) {
      let aLinks,
        _oLink,
        _sLinkIntentAction,
        aFinalLinks = [];
      let oFinalSemanticObjects = {};
      const bIntentHasActions = function (sIntent, aActions) {
        for (const intent in aActions) {
          if (intent === sIntent) {
            return true;
          } else {
            return false;
          }
        }
      };
      for (let k = 0; k < aValues.length; k++) {
        aLinks = aValues[k];
        if (aLinks && aLinks.length > 0 && aLinks[0] !== undefined) {
          const oSemanticObject = {};
          let oTmp;
          let sAlternatePath;
          for (let i = 0; i < aLinks.length; i++) {
            aFinalLinks.push([]);
            let hasTargetsNotFiltered = false;
            let hasTargets = false;
            for (let iLinkCount = 0; iLinkCount < aLinks[i][0].length; iLinkCount++) {
              _oLink = aLinks[i][0][iLinkCount];
              _sLinkIntentAction = _oLink && _oLink.intent.split("?")[0].split("-")[1];
              if (!(_oLink && _oLink.intent && _oLink.intent.indexOf(sCurrentHash) === 0)) {
                hasTargetsNotFiltered = true;
                if (!bIntentHasActions(_sLinkIntentAction, aSemanticObjects[k].unavailableActions)) {
                  aFinalLinks[i].push(_oLink);
                  hasTargets = true;
                }
              }
            }
            oTmp = {
              semanticObject: aSemanticObjects[k].semanticObject,
              path: aSemanticObjects[k].path,
              HasTargets: hasTargets,
              HasTargetsNotFiltered: hasTargetsNotFiltered
            };
            if (oSemanticObject[aSemanticObjects[k].semanticObject] === undefined) {
              oSemanticObject[aSemanticObjects[k].semanticObject] = {};
            }
            sAlternatePath = aSemanticObjects[k].path.replace(/\//g, "_");
            if (oSemanticObject[aSemanticObjects[k].semanticObject][sAlternatePath] === undefined) {
              oSemanticObject[aSemanticObjects[k].semanticObject][sAlternatePath] = {};
            }
            oSemanticObject[aSemanticObjects[k].semanticObject][sAlternatePath] = Object.assign(oSemanticObject[aSemanticObjects[k].semanticObject][sAlternatePath], oTmp);
          }
          const sSemanticObjectName = Object.keys(oSemanticObject)[0];
          if (Object.keys(oFinalSemanticObjects).includes(sSemanticObjectName)) {
            oFinalSemanticObjects[sSemanticObjectName] = Object.assign(oFinalSemanticObjects[sSemanticObjectName], oSemanticObject[sSemanticObjectName]);
          } else {
            oFinalSemanticObjects = Object.assign(oFinalSemanticObjects, oSemanticObject);
          }
          aFinalLinks = [];
        }
      }
      if (Object.keys(oFinalSemanticObjects).length > 0) {
        oInternalModelContext.setProperty("semanticsTargets", mergeObjects(oFinalSemanticObjects, oInternalModelContext.getProperty("semanticsTargets")));
        return oFinalSemanticObjects;
      }
    }).catch(function (oError) {
      Log.error("fnUpdateSemanticTargetsModel: Cannot read links", oError);
    });
  }
  async function fnGetSemanticObjectPromise(oAppComponent, oView, oMetaModel, sPath, sQualifier) {
    return CommonUtils.getSemanticObjectsFromPath(oMetaModel, sPath, sQualifier);
  }
  function fnPrepareSemanticObjectsPromises(_oAppComponent, _oView, _oMetaModel, _aSemanticObjectsFound, _aSemanticObjectsPromises) {
    let _Keys, sPath;
    let sQualifier, regexResult;
    for (let i = 0; i < _aSemanticObjectsFound.length; i++) {
      sPath = _aSemanticObjectsFound[i];
      _Keys = Object.keys(_oMetaModel.getObject(sPath + "@"));
      for (let index = 0; index < _Keys.length; index++) {
        if (_Keys[index].indexOf(`@${"com.sap.vocabularies.Common.v1.SemanticObject"}`) === 0 && _Keys[index].indexOf(`@${"com.sap.vocabularies.Common.v1.SemanticObjectMapping"}`) === -1 && _Keys[index].indexOf(`@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}`) === -1) {
          regexResult = /#(.*)/.exec(_Keys[index]);
          sQualifier = regexResult ? regexResult[1] : "";
          _aSemanticObjectsPromises.push(CommonUtils.getSemanticObjectPromise(_oAppComponent, _oView, _oMetaModel, sPath, sQualifier));
        }
      }
    }
  }
  function fnGetSemanticTargetsFromPageModel(oController, sPageModel) {
    const _fnfindValuesHelper = function (obj, key, list) {
      if (!obj) {
        return list;
      }
      if (obj instanceof Array) {
        for (const i in obj) {
          list = list.concat(_fnfindValuesHelper(obj[i], key, []));
        }
        return list;
      }
      if (obj[key]) {
        list.push(obj[key]);
      }
      if (typeof obj == "object" && obj !== null) {
        const children = Object.keys(obj);
        if (children.length > 0) {
          for (let i = 0; i < children.length; i++) {
            list = list.concat(_fnfindValuesHelper(obj[children[i]], key, []));
          }
        }
      }
      return list;
    };
    const _fnfindValues = function (obj, key) {
      return _fnfindValuesHelper(obj, key, []);
    };
    const _fnDeleteDuplicateSemanticObjects = function (aSemanticObjectPath) {
      return aSemanticObjectPath.filter(function (value, index) {
        return aSemanticObjectPath.indexOf(value) === index;
      });
    };
    const oView = oController.getView();
    const oInternalModelContext = oView.getBindingContext("internal");
    if (oInternalModelContext) {
      const aSemanticObjectsPromises = [];
      const oComponent = oController.getOwnerComponent();
      const oAppComponent = Component.getOwnerComponentFor(oComponent);
      const oMetaModel = oAppComponent.getMetaModel();
      let oPageModel = oComponent.getModel(sPageModel).getData();
      if (JSON.stringify(oPageModel) === "{}") {
        oPageModel = oComponent.getModel(sPageModel)._getObject("/", undefined);
      }
      let aSemanticObjectsFound = _fnfindValues(oPageModel, "semanticObjectPath");
      aSemanticObjectsFound = _fnDeleteDuplicateSemanticObjects(aSemanticObjectsFound);
      const oShellServiceHelper = CommonUtils.getShellServices(oAppComponent);
      let sCurrentHash = CommonUtils.getHash();
      const aSemanticObjectsForGetLinks = [];
      const aSemanticObjects = [];
      let _oSemanticObject;
      if (sCurrentHash && sCurrentHash.indexOf("?") !== -1) {
        // sCurrentHash can contain query string, cut it off!
        sCurrentHash = sCurrentHash.split("?")[0];
      }
      fnPrepareSemanticObjectsPromises(oAppComponent, oView, oMetaModel, aSemanticObjectsFound, aSemanticObjectsPromises);
      if (aSemanticObjectsPromises.length === 0) {
        return Promise.resolve();
      } else {
        Promise.all(aSemanticObjectsPromises).then(async function (aValues) {
          const aGetLinksPromises = [];
          let sSemObjExpression;
          const aSemanticObjectsResolved = aValues.filter(function (element) {
            if (element.semanticObject !== undefined && element.semanticObject.semanticObject && typeof element.semanticObject.semanticObject === "object") {
              sSemObjExpression = compileExpression(pathInModel(element.semanticObject.semanticObject.$Path));
              element.semanticObject.semanticObject = sSemObjExpression;
              element.semanticObjectForGetLinks[0].semanticObject = sSemObjExpression;
              return true;
            } else if (element) {
              return element.semanticObject !== undefined;
            } else {
              return false;
            }
          });
          for (let j = 0; j < aSemanticObjectsResolved.length; j++) {
            _oSemanticObject = aSemanticObjectsResolved[j];
            if (_oSemanticObject && _oSemanticObject.semanticObject && !(_oSemanticObject.semanticObject.semanticObject.indexOf("{") === 0)) {
              aSemanticObjectsForGetLinks.push(_oSemanticObject.semanticObjectForGetLinks);
              aSemanticObjects.push({
                semanticObject: _oSemanticObject.semanticObject.semanticObject,
                unavailableActions: _oSemanticObject.unavailableActions,
                path: aSemanticObjectsResolved[j].semanticObjectPath
              });
              aGetLinksPromises.push(oShellServiceHelper.getLinksWithCache([_oSemanticObject.semanticObjectForGetLinks]));
            }
          }
          return CommonUtils.updateSemanticTargets(aGetLinksPromises, aSemanticObjects, oInternalModelContext, sCurrentHash);
        }).catch(function (oError) {
          Log.error("fnGetSemanticTargetsFromTable: Cannot get Semantic Objects", oError);
        });
      }
    } else {
      return Promise.resolve();
    }
  }
  function getFilterAllowedExpression(oFilterRestrictionsAnnotation) {
    const mAllowedExpressions = {};
    if (oFilterRestrictionsAnnotation && oFilterRestrictionsAnnotation.FilterExpressionRestrictions !== undefined) {
      oFilterRestrictionsAnnotation.FilterExpressionRestrictions.forEach(function (oProperty) {
        if (oProperty.Property && oProperty.AllowedExpressions !== undefined) {
          //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
          if (mAllowedExpressions[oProperty.Property.$PropertyPath] !== undefined) {
            mAllowedExpressions[oProperty.Property.$PropertyPath].push(oProperty.AllowedExpressions);
          } else {
            mAllowedExpressions[oProperty.Property.$PropertyPath] = [oProperty.AllowedExpressions];
          }
        }
      });
    }
    return mAllowedExpressions;
  }
  function getFilterRestrictions(oFilterRestrictionsAnnotation, sRestriction) {
    let aProps = [];
    if (oFilterRestrictionsAnnotation && oFilterRestrictionsAnnotation[sRestriction]) {
      aProps = oFilterRestrictionsAnnotation[sRestriction].map(function (oProperty) {
        return oProperty.$PropertyPath;
      });
    }
    return aProps;
  }
  function _fetchPropertiesForNavPath(paths, navPath, props) {
    const navPathPrefix = navPath + "/";
    return paths.reduce((outPaths, pathToCheck) => {
      if (pathToCheck.startsWith(navPathPrefix)) {
        const outPath = pathToCheck.replace(navPathPrefix, "");
        if (outPaths.indexOf(outPath) === -1) {
          outPaths.push(outPath);
        }
      }
      return outPaths;
    }, props);
  }
  function getFilterRestrictionsByPath(entityPath, oContext) {
    const oRet = {
      RequiredProperties: [],
      NonFilterableProperties: [],
      FilterAllowedExpressions: {}
    };
    let oFilterRestrictions;
    const navigationText = "$NavigationPropertyBinding";
    const frTerm = "@Org.OData.Capabilities.V1.FilterRestrictions";
    const entityTypePathParts = entityPath.replaceAll("%2F", "/").split("/").filter(ModelHelper.filterOutNavPropBinding);
    const entityTypePath = `/${entityTypePathParts.join("/")}/`;
    const entitySetPath = ModelHelper.getEntitySetPath(entityPath, oContext);
    const entitySetPathParts = entitySetPath.split("/").filter(ModelHelper.filterOutNavPropBinding);
    const isContainment = oContext.getObject(`${entityTypePath}$ContainsTarget`);
    const containmentNavPath = isContainment && entityTypePathParts[entityTypePathParts.length - 1];

    //LEAST PRIORITY - Filter restrictions directly at Entity Set
    //e.g. FR in "NS.EntityContainer/SalesOrderManage" ContextPath: /SalesOrderManage
    if (!isContainment) {
      oFilterRestrictions = oContext.getObject(`${entitySetPath}${frTerm}`);
      oRet.RequiredProperties = getFilterRestrictions(oFilterRestrictions, "RequiredProperties") || [];
      const resultContextCheck = oContext.getObject(`${entityTypePath}@com.sap.vocabularies.Common.v1.ResultContext`);
      if (!resultContextCheck) {
        oRet.NonFilterableProperties = getFilterRestrictions(oFilterRestrictions, "NonFilterableProperties") || [];
      }
      //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
      oRet.FilterAllowedExpressions = getFilterAllowedExpression(oFilterRestrictions) || {};
    }
    if (entityTypePathParts.length > 1) {
      const navPath = isContainment ? containmentNavPath : entitySetPathParts[entitySetPathParts.length - 1];
      // In case of containment we take entitySet provided as parent. And in case of normal we would remove the last navigation from entitySetPath.
      const parentEntitySetPath = isContainment ? entitySetPath : `/${entitySetPathParts.slice(0, -1).join(`/${navigationText}/`)}`;
      //THIRD HIGHEST PRIORITY - Reading property path restrictions - Annotation at main entity but directly on navigation property path
      //e.g. Parent Customer with PropertyPath="Set/CityName" ContextPath: Customer/Set
      const oParentRet = {
        RequiredProperties: [],
        NonFilterableProperties: [],
        FilterAllowedExpressions: {}
      };
      if (!navPath.includes("%2F")) {
        const oParentFR = oContext.getObject(`${parentEntitySetPath}${frTerm}`);
        oRet.RequiredProperties = _fetchPropertiesForNavPath(getFilterRestrictions(oParentFR, "RequiredProperties") || [], navPath, oRet.RequiredProperties || []);
        oRet.NonFilterableProperties = _fetchPropertiesForNavPath(getFilterRestrictions(oParentFR, "NonFilterableProperties") || [], navPath, oRet.NonFilterableProperties || []);
        //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
        const completeAllowedExps = getFilterAllowedExpression(oParentFR) || {};
        oParentRet.FilterAllowedExpressions = Object.keys(completeAllowedExps).reduce((outProp, propPath) => {
          if (propPath.startsWith(navPath + "/")) {
            const outPropPath = propPath.replace(navPath + "/", "");
            outProp[outPropPath] = completeAllowedExps[propPath];
          }
          return outProp;
        }, {});
      }

      //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
      oRet.FilterAllowedExpressions = mergeObjects({}, oRet.FilterAllowedExpressions || {}, oParentRet.FilterAllowedExpressions || {});

      //SECOND HIGHEST priority - Navigation restrictions
      //e.g. Parent "/Customer" with NavigationPropertyPath="Set" ContextPath: Customer/Set
      const oNavRestrictions = CommonUtils.getNavigationRestrictions(oContext, parentEntitySetPath, navPath.replaceAll("%2F", "/"));
      const oNavFilterRest = oNavRestrictions && oNavRestrictions["FilterRestrictions"];
      const navResReqProps = getFilterRestrictions(oNavFilterRest, "RequiredProperties") || [];
      oRet.RequiredProperties = uniqueSort(oRet.RequiredProperties.concat(navResReqProps));
      const navNonFilterProps = getFilterRestrictions(oNavFilterRest, "NonFilterableProperties") || [];
      oRet.NonFilterableProperties = uniqueSort(oRet.NonFilterableProperties.concat(navNonFilterProps));
      //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
      oRet.FilterAllowedExpressions = mergeObjects({}, oRet.FilterAllowedExpressions || {}, getFilterAllowedExpression(oNavFilterRest) || {});

      //HIGHEST priority - Restrictions having target with navigation association entity
      // e.g. FR in "CustomerParameters/Set" ContextPath: "Customer/Set"
      const navAssociationEntityRest = oContext.getObject(`/${entityTypePathParts.join("/")}${frTerm}`);
      const navAssocReqProps = getFilterRestrictions(navAssociationEntityRest, "RequiredProperties") || [];
      oRet.RequiredProperties = uniqueSort(oRet.RequiredProperties.concat(navAssocReqProps));
      const navAssocNonFilterProps = getFilterRestrictions(navAssociationEntityRest, "NonFilterableProperties") || [];
      oRet.NonFilterableProperties = uniqueSort(oRet.NonFilterableProperties.concat(navAssocNonFilterProps));
      //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
      oRet.FilterAllowedExpressions = mergeObjects({}, oRet.FilterAllowedExpressions, getFilterAllowedExpression(navAssociationEntityRest) || {});
    }
    return oRet;
  }
  async function templateControlFragment(sFragmentName, oPreprocessorSettings, oOptions, oModifier) {
    oOptions = oOptions || {};
    if (oModifier) {
      return oModifier.templateControlFragment(sFragmentName, oPreprocessorSettings, oOptions.view).then(function (oFragment) {
        // This is required as Flex returns an HTMLCollection as templating result in XML time.
        return oModifier.targets === "xmlTree" && oFragment.length > 0 ? oFragment[0] : oFragment;
      });
    } else {
      return loadMacroLibrary().then(async function () {
        return XMLPreprocessor.process(XMLTemplateProcessor.loadTemplate(sFragmentName, "fragment"), {
          name: sFragmentName
        }, oPreprocessorSettings);
      }).then(async function (oFragment) {
        const oControl = oFragment.firstElementChild;
        if (!!oOptions.isXML && oControl) {
          return Promise.resolve(oControl);
        }
        return Fragment.load({
          id: oOptions.id,
          definition: oFragment,
          controller: oOptions.controller
        });
      });
    }
  }
  function getSingletonPath(path, metaModel) {
    const parts = path.split("/").filter(Boolean),
      propertyName = parts.pop(),
      navigationPath = parts.join("/"),
      entitySet = navigationPath && metaModel.getObject(`/${navigationPath}`);
    if ((entitySet === null || entitySet === void 0 ? void 0 : entitySet.$kind) === "Singleton") {
      const singletonName = parts[parts.length - 1];
      return `/${singletonName}/${propertyName}`;
    }
    return undefined;
  }
  async function requestSingletonProperty(path, model) {
    if (!path || !model) {
      return Promise.resolve(null);
    }
    const metaModel = model.getMetaModel();
    // Find the underlying entity set from the property path and check whether it is a singleton.
    const resolvedPath = getSingletonPath(path, metaModel);
    if (resolvedPath) {
      const propertyBinding = model.bindProperty(resolvedPath);
      return propertyBinding.requestValue();
    }
    return Promise.resolve(null);
  }
  function addEventToBindingInfo(oControl, sEventName, fHandler) {
    let oBindingInfo;
    const setBindingInfo = function () {
      if (oBindingInfo) {
        if (!oBindingInfo.events) {
          oBindingInfo.events = {};
        }
        if (!oBindingInfo.events[sEventName]) {
          oBindingInfo.events[sEventName] = fHandler;
        } else {
          const fOriginalHandler = oBindingInfo.events[sEventName];
          oBindingInfo.events[sEventName] = function () {
            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
              args[_key] = arguments[_key];
            }
            fHandler.apply(this, ...args);
            fOriginalHandler.apply(this, ...args);
          };
        }
      }
    };
    if (oControl.isA("sap.ui.mdc.Chart")) {
      oControl.innerChartBound().then(function () {
        oBindingInfo = oControl.getControlDelegate()._getChart(oControl).getBindingInfo("data");
        setBindingInfo();
      }).catch(function (sError) {
        Log.error(sError);
      });
    } else {
      oBindingInfo = oControl.data("rowsBindingInfo");
      setBindingInfo();
    }
  }
  async function loadMacroLibrary() {
    return new Promise(function (resolve) {
      sap.ui.require(["sap/fe/macros/macroLibrary"], function /*macroLibrary*/
      () {
        resolve();
      });
    });
  }

  // Get the path for action parameters that is needed to read the annotations
  function getParameterPath(sPath, sParameter) {
    let sContext;
    if (sPath.indexOf("@$ui5.overload") > -1) {
      sContext = sPath.split("@$ui5.overload")[0];
    } else {
      // For Unbound Actions in Action Parameter Dialogs
      const aAction = sPath.split("/0")[0].split(".");
      sContext = `/${aAction[aAction.length - 1]}/`;
    }
    return sContext + sParameter;
  }

  /**
   * Get resolved expression binding used for texts at runtime.
   *
   * @param expBinding
   * @param control
   * @function
   * @static
   * @memberof sap.fe.core.CommonUtils
   * @returns A string after resolution.
   * @ui5-restricted
   */
  function _fntranslatedTextFromExpBindingString(expBinding, control) {
    // The idea here is to create dummy element with the expresion binding.
    // Adding it as dependent to the view/control would propagate all the models to the dummy element and resolve the binding.
    // We remove the dummy element after that and destroy it.

    const anyResourceText = new AnyElement({
      anyText: expBinding
    });
    control.addDependent(anyResourceText);
    const resultText = anyResourceText.getAnyText();
    control.removeDependent(anyResourceText);
    anyResourceText.destroy();
    return resultText;
  }
  /**
   * Check if the current device has a small screen.
   *
   * @returns A Boolean.
   * @private
   */
  function isSmallDevice() {
    return !system.desktop || Device.resize.width <= 320;
  }
  function getConverterContextForPath(sMetaPath, oMetaModel, sEntitySet, oDiagnostics) {
    const oContext = oMetaModel.createBindingContext(sMetaPath);
    return ConverterContext === null || ConverterContext === void 0 ? void 0 : ConverterContext.createConverterContextForMacro(sEntitySet, oContext || oMetaModel, oDiagnostics, mergeObjects, undefined);
  }
  const CommonUtils = {
    isPropertyFilterable: isPropertyFilterable,
    isFieldControlPathInapplicable: isFieldControlPathInapplicable,
    removeSensitiveData: removeSensitiveData,
    fireButtonPress: fnFireButtonPress,
    getTargetView: getTargetView,
    getCurrentPageView: getCurrentPageView,
    hasTransientContext: fnHasTransientContexts,
    updateRelatedAppsDetails: fnUpdateRelatedAppsDetails,
    resolveStringtoBoolean: fnResolveStringtoBoolean,
    getAppComponent: getAppComponent,
    getMandatoryFilterFields: fnGetMandatoryFilterFields,
    getContextPathProperties: fnGetContextPathProperties,
    getParameterInfo: getParameterInfo,
    updateDataFieldForIBNButtonsVisibility: fnUpdateDataFieldForIBNButtonsVisibility,
    getTranslatedText: getTranslatedText,
    getEntitySetName: getEntitySetName,
    getActionPath: getActionPath,
    computeDisplayMode: computeDisplayMode,
    isStickyEditMode: isStickyEditMode,
    getOperatorsForProperty: getOperatorsForProperty,
    getOperatorsForDateProperty: getOperatorsForDateProperty,
    getOperatorsForGuidProperty: getOperatorsForGuidProperty,
    addSelectionVariantToConditions: addSelectionVariantToConditions,
    addExternalStateFiltersToSelectionVariant: addExternalStateFiltersToSelectionVariant,
    addPageContextToSelectionVariant: addPageContextToSelectionVariant,
    addDefaultDisplayCurrency: addDefaultDisplayCurrency,
    getNonComputedVisibleFields: getNonComputedVisibleFields,
    setUserDefaults: setUserDefaults,
    getShellServices: getShellServices,
    getHash: getHash,
    getIBNActions: fnGetIBNActions,
    getHeaderFacetItemConfigForExternalNavigation: getHeaderFacetItemConfigForExternalNavigation,
    getSemanticObjectMapping: getSemanticObjectMapping,
    setSemanticObjectMappings: setSemanticObjectMappings,
    getSemanticObjectPromise: fnGetSemanticObjectPromise,
    getSemanticTargetsFromPageModel: fnGetSemanticTargetsFromPageModel,
    getSemanticObjectsFromPath: fnGetSemanticObjectsFromPath,
    updateSemanticTargets: fnUpdateSemanticTargetsModel,
    getPropertyDataType: getPropertyDataType,
    waitForContextRequested: waitForContextRequested,
    getNavigationRestrictions: getNavigationRestrictions,
    getSearchRestrictions: getSearchRestrictions,
    getFilterRestrictionsByPath: getFilterRestrictionsByPath,
    getSpecificAllowedExpression: getSpecificAllowedExpression,
    getAdditionalParamsForCreate: getAdditionalParamsForCreate,
    requestSingletonProperty: requestSingletonProperty,
    templateControlFragment: templateControlFragment,
    addEventToBindingInfo: addEventToBindingInfo,
    FilterRestrictions: {
      REQUIRED_PROPERTIES: "RequiredProperties",
      NON_FILTERABLE_PROPERTIES: "NonFilterableProperties",
      ALLOWED_EXPRESSIONS: "FilterAllowedExpressions"
    },
    AllowedExpressionsPrio: ["SingleValue", "MultiValue", "SingleRange", "MultiRange", "SearchExpression", "MultiRangeOrSearchExpression"],
    normalizeSearchTerm: normalizeSearchTerm,
    getSingletonPath: getSingletonPath,
    getRequiredPropertiesFromUpdateRestrictions: getRequiredPropertiesFromUpdateRestrictions,
    getRequiredPropertiesFromInsertRestrictions: getRequiredPropertiesFromInsertRestrictions,
    hasRestrictedPropertiesInAnnotations: hasRestrictedPropertiesInAnnotations,
    getRequiredPropertiesFromAnnotations: getRequiredPropertiesFromAnnotations,
    getRequiredProperties: getRequiredProperties,
    checkIfResourceKeyExists: checkIfResourceKeyExists,
    setContextsBasedOnOperationAvailable: setContextsBasedOnOperationAvailable,
    setDynamicActionContexts: setDynamicActionContexts,
    requestProperty: requestProperty,
    getParameterPath: getParameterPath,
    getRelatedAppsMenuItems: _getRelatedAppsMenuItems,
    getTranslatedTextFromExpBindingString: _fntranslatedTextFromExpBindingString,
    addSemanticDatesToConditions: addSemanticDatesToConditions,
    addSelectOptionToConditions: addSelectOptionToConditions,
    createSemanticDatesFromConditions: createSemanticDatesFromConditions,
    updateRelateAppsModel: updateRelateAppsModel,
    getSemanticObjectAnnotations: _getSemanticObjectAnnotations,
    isCustomAggregate: _isCustomAggregate,
    isSmallDevice,
    getConverterContextForPath
  };
  return CommonUtils;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/CommonUtils", ["sap/base/Log","sap/base/util/array/uniqueSort","sap/base/util/merge","sap/fe/core/converters/ConverterContext","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SemanticDateOperators","sap/fe/core/helpers/StableIdHelper","sap/fe/core/type/EDM","sap/fe/core/type/TypeUtil","sap/fe/macros/ODataMetaModelUtil","sap/ui/core/Component","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/Device","sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/mdc/condition/RangeOperator","./controls/AnyElement","./templating/FilterHelper"],function(e,t,n,i,o,r,s,a,c,l,u,p,f,d,g,m,v,b,h,O,P,y,$){"use strict";var C={};var S=$.getConditions;var E=h.system;var j=u.isTypeFilterable;var T=l.generate;var A=s.pathInModel;var x=s.or;var F=s.not;var R=s.compileExpression;var N=o.IssueSeverity;var D=o.IssueCategoryType;var I=o.IssueCategory;function w(e){if(!e){return undefined}return e.replace(/"/g," ").replace(/\\/g,"\\\\").split(/\s+/).reduce(function(e,t){if(t!==""){e=`${e?`${e} `:""}"${t}"`}return e},undefined)}function M(e){let t=e.getProperty("$Type");if(!e.getProperty("$kind")){switch(t){case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":t=undefined;break;case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":t=e.getProperty("Value/$Path/$Type");break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":default:const n=e.getProperty("Target/$AnnotationPath");if(n){if(n.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){t=e.getProperty("Target/$AnnotationPath/fn/$Path/$Type")}else if(n.indexOf("com.sap.vocabularies.UI.v1.DataPoint")>-1){t=e.getProperty("Value/$Path/$Type")}else{t=undefined}}else{t=undefined}break}}return t}async function k(e){var t;const n=e.getModel();const i=n.getMetaModel();const o=i.getMetaPath(e.getPath());const s=r.getInvolvedDataModelObjects(i.getContext(o));await e.requestProperty((t=s.targetEntityType.keys[0])===null||t===void 0?void 0:t.name)}function B(e){let t=false;if(e){e.getCurrentContexts().forEach(function(e){if(e&&e.isTransient()){t=true}})}return t}function V(e,t){let n;let i;const o="$NavigationPropertyBinding";const r="@Org.OData.Capabilities.V1.SearchRestrictions";const s=e.replaceAll("%2F","/").split("/").filter(a.filterOutNavPropBinding);const c=a.getEntitySetPath(e,t);const l=c.split("/").filter(a.filterOutNavPropBinding);const u=t.getObject(`/${s.join("/")}/$ContainsTarget`);const p=u&&s[s.length-1];if(!u){n=t.getObject(`${c}${r}`)}if(s.length>1){const e=u?p:l[l.length-1];const n=u?c:`/${l.slice(0,-1).join(`/${o}/`)}`;const r=mt.getNavigationRestrictions(t,n,e.replaceAll("%2F","/"));i=r&&r["SearchRestrictions"]}return i||n}function L(e,t,n){const i=e.getObject(`${t}@Org.OData.Capabilities.V1.NavigationRestrictions`);const o=i&&i.RestrictedProperties;return o&&o.find(function(e){return e&&e.NavigationProperty&&e.NavigationProperty.$NavigationPropertyPath===n})}function U(e,t,n){let i=false;const o=e.getObject(`${t}@Org.OData.Capabilities.V1.FilterRestrictions`);if(o&&o.NonFilterableProperties){i=o.NonFilterableProperties.some(function(e){return e.$NavigationPropertyPath===n||e.$PropertyPath===n})}return i}function q(e,t,n){let i=false;const o=e!==null&&e!==void 0&&e.getObject(t+"@Org.OData.Aggregation.V1.ApplySupported")?true:false;if(o){const o=e.getObject(`${t}@`);const r=f.getAllCustomAggregates(o);const s=r?Object.keys(r):undefined;if(s&&(s===null||s===void 0?void 0:s.indexOf(n))>-1){i=true}}return i}function W(e,t,n){const i=`${t}/${n}`,o=i.split("/").splice(0,2),r=i.split("/").splice(2);let s=false,a="";t=o.join("/");s=r.some(function(n,i,o){if(a.length>0){a+=`/${n}`}else{a=n}if(i===o.length-2){const i=L(e,t,n);const r=i&&i.FilterRestrictions;const s=r&&r.NonFilterableProperties;const a=o[o.length-1];if(s&&s.find(function(e){return e.$PropertyPath===a})){return true}}if(i===o.length-1){s=U(e,t,a)}else if(e.getObject(`${t}/$NavigationPropertyBinding/${n}`)){s=U(e,t,a);a="";t=`/${e.getObject(`${t}/$NavigationPropertyBinding/${n}`)}`}return s===true});return s}function _(e,t,n,i){var o;if(typeof n!=="string"){throw new Error("sProperty parameter must be a string")}let r;if(((o=e.getObject(`${t}/@com.sap.vocabularies.Common.v1.ResultContext`))===null||o===void 0?void 0:o.valueOf())===true){return true}const s=e.createBindingContext(`${t}/${n}`);if(!i){if(s.getProperty("@com.sap.vocabularies.UI.v1.Hidden")===true||s.getProperty("@com.sap.vocabularies.UI.v1.HiddenFilter")===true){return false}const e=s.getProperty("@com.sap.vocabularies.UI.v1.Hidden/$Path");const t=s.getProperty("@com.sap.vocabularies.UI.v1.HiddenFilter/$Path");if(e&&t){return R(F(x(A(e),A(t))))}else if(e){return R(F(A(e)))}else if(t){return R(F(A(t)))}}r=t.split("/").length===2&&n.indexOf("/")<0?!U(e,t,n)&&!q(e,t,n):!W(e,t,n);if(r&&s){const e=M(s);if(e){r=e?j(e):false}else{r=false}}return r}function G(e){return ne(e).getShellServices()}function H(){const e=window.location.hash;return e.split("&")[0]}async function Q(e,t,n,i){return e.getLinks({semanticObject:n,params:i})}function Y(e){const t=[];const n=Object.keys(e);let i;for(let o=0;o<n.length;o++){i={LocalProperty:{$PropertyPath:n[o]},SemanticObjectProperty:e[n[o]]};t.push(i)}return t}function K(e,t,n,i,o){for(let r=0;r<e.length;r++){const s=e[r];const a=s.intent;const c=a.split("-")[1].split("?")[0];if(o&&o.includes(c)){i.push({text:s.text,targetSemObject:a.split("#")[1].split("-")[0],targetAction:c.split("~")[0],targetParams:n})}else if(!o&&t&&t.indexOf(c)===-1){i.push({text:s.text,targetSemObject:a.split("#")[1].split("-")[0],targetAction:c.split("~")[0],targetParams:n})}}}function z(e,t,n,i){if(i&&i.length>0){const o=e.allowedActions||undefined;const r=e.unavailableActions?e.unavailableActions:[];const s=e.mapping?Y(e.mapping):[];const a={navigationContexts:t,semanticObjectMapping:s};K(i,r,a,n,o)}}async function J(t,n,i,o,r,s){const a=G(i);const c={};let l="",u="";let p;let f=[];let d=[];let g;async function m(){const e=a.parseShellHash(document.location.hash);l=e.semanticObject;u=e.action;return Q(a,i,l,c)}try{if(n){if(o&&o.length>0){for(let e=0;e<o.length;e++){const t=o[e].$PropertyPath;if(!c[t]){c[t]={value:n[t]}}}}else{const e=r.getObject(`${s}/$Type/$Key`);for(const t in e){const i=e[t];if(!c[i]){c[i]={value:n[i]}}}}}const e=oe(i).getViewData();const b=[];let h;if(e.additionalSemanticObjects){g=Object.keys(e.additionalSemanticObjects);for(let n=0;n<g.length;n++){h=await Promise.resolve(Q(a,i,g[n],c));z(e.additionalSemanticObjects[g[n]],t,b,h)}}const O=i.getBindingContext("internal");const P=await m();if(P){if(P.length>0){var v;let n=false;const i={};const o=[];const a=`${s}@`;const c=`${s}/@`;const g=r.getObject(a);p=mt.getSemanticObjectAnnotations(g,l);if(!p.bHasEntitySetSO){const e=r.getObject(c);p=mt.getSemanticObjectAnnotations(e,l)}d=p.aUnavailableActions;d.push(u);i.navigationContexts=t;i.semanticObjectMapping=p.aMappings;K(P,d,i,o);b.forEach(function(e){let{targetSemObject:t}=e;if(o[0].targetSemObject===t){n=true}});if(e.additionalSemanticObjects&&e.additionalSemanticObjects[o[0].targetSemObject]&&((v=e.additionalSemanticObjects[o[0].targetSemObject].allowedActions)===null||v===void 0?void 0:v.length)===0){n=true}f=n?b:b.concat(o);O.setProperty("relatedApps/visibility",f.length>0);O.setProperty("relatedApps/items",f)}else{O.setProperty("relatedApps/visibility",false)}}else{O.setProperty("relatedApps/visibility",false)}}catch(t){e.error("Cannot read links",t)}return f}function X(e,t){const n={bHasEntitySetSO:false,aAllowedActions:[],aUnavailableActions:[],aMappings:[]};let i,o;let r;for(const s in e){if(s.indexOf("com.sap.vocabularies.Common.v1.SemanticObject")>-1&&e[s]===t){n.bHasEntitySetSO=true;i=`@${"com.sap.vocabularies.Common.v1.SemanticObjectMapping"}`;o=`@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}`;if(s.indexOf("#")>-1){r=s.split("#")[1];i=`${i}#${r}`;o=`${o}#${r}`}if(e[i]){n.aMappings=n.aMappings.concat(e[i])}if(e[o]){n.aUnavailableActions=n.aUnavailableActions.concat(e[o])}break}}return n}function Z(t){const n=t.getModel().getMetaModel();const i=t.getBindingContext();const o=i&&i.getPath()||"";const r=n.getMetaPath(o);const s=`${r}/`+`@com.sap.vocabularies.Common.v1.SemanticKey`;const a=n.getObject(s);const c=i===null||i===void 0?void 0:i.getObject();if(!c&&i){i.requestObject().then(async function(e){return J(i,e,t,a,n,r)}).catch(function(t){e.error("Cannot update the related app details",t)})}else{return J(i,c,t,a,n,r)}}function ee(e){if(e&&e.isA(["sap.m.Button","sap.m.OverflowToolbarButton"])&&e.getVisible()&&e.getEnabled()){e.firePress()}}function te(e){if(e==="true"||e===true){return true}else{return false}}function ne(e){if(e.isA("sap.fe.core.AppComponent")){return e}const t=d.getOwnerComponentFor(e);if(!t){throw new Error("There should be a sap.fe.core.AppComponent as owner of the control")}else{return ne(t)}}function ie(e){const t=e.getRootViewController();return t.isFclEnabled()?t.getRightmostView():mt.getTargetView(e.getRootContainer().getCurrentPage())}function oe(e){if(e&&e.isA("sap.ui.core.ComponentContainer")){const t=e.getComponentInstance();e=t&&t.getRootControl()}while(e&&!e.isA("sap.ui.core.mvc.View")){e=e.getParent()}return e}function re(e,t){let n=false;const i=e.split("/");if(i.length>1){n=t[i[0]]!==undefined&&t[i[0]].hasOwnProperty(i[1])&&t[i[0]][i[1]]===0}else{n=t[e]===0}return n}function se(e,t){const n=[];for(let i=0;i<e.length;i++){const o=e[i].entitySet,r=e[i].contextData;delete r["@odata.context"];delete r["%40odata.context"];delete r["@odata.metadataEtag"];delete r["%40odata.metadataEtag"];delete r["SAP__Messages"];const s=Object.keys(r);for(let e=0;e<s.length;e++){const n=s[e],i=t.getObject(`/${o}/${n}@`);if(i){if(i["@com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]||i["@com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]||i["@com.sap.vocabularies.Analytics.v1.Measure"]){delete r[n]}else if(i["@com.sap.vocabularies.Common.v1.FieldControl"]){const e=i["@com.sap.vocabularies.Common.v1.FieldControl"];if(e["$EnumMember"]&&e["$EnumMember"].split("/")[1]==="Inapplicable"){delete r[n]}else if(e["$Path"]&&mt.isFieldControlPathInapplicable(e["$Path"],r)){delete r[n]}}}}n.push(r)}return n}function ae(e,t){for(const n in t){if(t[n]!==e[n]){return false}}return true}function ce(e,t,n){const i=e.getObject(`${t}/`)||{},o={};for(const e in i){if(i.hasOwnProperty(e)&&!/^\$/i.test(e)&&i[e].$kind&&ae(i[e],n||{$kind:"Property"})){o[e]=i[e]}}return o}function le(e,t){let n=[];if(e&&t){n=e.getObject(`${t}@Org.OData.Capabilities.V1.FilterRestrictions/RequiredProperties`)}return n}function ue(e,t){const n=e&&e.getActions();if(n){n.forEach(function(e){if(e.isA("sap.ui.mdc.actiontoolbar.ActionToolbarAction")){e=e.getAction()}if(e.isA("sap.m.MenuButton")){const n=e.getMenu();const i=n.getItems();i.forEach(e=>{if(e.data("IBNData")){t.push(e)}})}else if(e.data("IBNData")){t.push(e)}})}return t}function pe(t,n){const i={};const o=a.isStickySessionSupported(n.getModel().getMetaModel());const r=function(r){if(r){const e=Object.keys(r);e.forEach(function(e){if(e.indexOf("_")!==0&&e.indexOf("odata.context")===-1){i[e]={value:r[e]}}})}if(t.length){t.forEach(function(t){const r=t.data("IBNData").semanticObject;const s=t.data("IBNData").action;mt.getShellServices(n).getLinks({semanticObject:r,action:s,params:i}).then(function(e){t.setVisible(t.getVisible()&&e&&e.length===1);if(o){t.getBindingContext("internal").setProperty(t.getId().split("--")[1],{shellNavigationNotAvailable:!(e&&e.length===1)})}}).catch(function(t){e.error("Cannot retrieve the links from the shell service",t)})})}};if(n&&n.getBindingContext()){var s;(s=n.getBindingContext())===null||s===void 0?void 0:s.requestObject().then(function(e){return r(e)}).catch(function(t){e.error("Cannot retrieve the links from the shell service",t)})}else{r()}}function fe(e,t,n,i){let o=e;if(t){if(i){const n=de(t.aCustomBundles,`${e}|${i}`);o=n?`${e}|${i}`:e}return t.getText(o,n)}t=g.getLibraryResourceBundle("sap.fe.core");return t.getText(o,n)}function de(e,t){if(e.length){for(let n=e.length-1;n>=0;n--){const i=e[n].hasText(t);if(i){return true}de(e[n].aCustomBundles,t)}}return false}function ge(e,t,n,i){n=!n?e.getObject(e.getPath()).toString():n;let o=e.getPath().split("/@")[0];const r=e.getObject(o).$Type;const s=me(e.getModel(),r);if(s){o=`/${s}`}if(i){return e.getObject(`${o}/${n}@Org.OData.Core.V1.OperationAvailable`)}if(t){return`${o}/${n}`}else{return{sContextPath:o,sProperty:e.getObject(`${o}/${n}@Org.OData.Core.V1.OperationAvailable/$Path`),sBindingParameter:e.getObject(`${o}/${n}/@$ui5.overload/0/$Parameter/0/$Name`)}}}function me(e,t){const n=e.getObject("/");for(const e in n){if(typeof n[e]==="object"&&n[e].$Type===t){return e}}}function ve(e,t){const n=e["@com.sap.vocabularies.Common.v1.Text"],i=n&&(e&&e["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]||t&&t["@com.sap.vocabularies.UI.v1.TextArrangement"]);if(i){if(i.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){return"Description"}else if(i.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"ValueDescription"}else if(i.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"){return"Value"}return"DescriptionValue"}return n?"DescriptionValue":"Value"}function be(e){const t=e.getModel().getMetaModel();return t.getObject(`${t.getMetaPath(e.getPath())}/$Type`)}async function he(t,n,i){let o=n;const r=t.indexOf("(");if(r>-1){const n=t.slice(r+1,-1);let i=be(o);while(i!==n){o=o.getBinding().getContext();if(o){i=be(o)}else{e.warning("Cannot determine target type to request property value for bound action invocation");return Promise.resolve(undefined)}}}return o.requestObject(i)}async function Oe(e,t,n,i){const o=n&&n.indexOf("/")===0?ct(n,e.getModel()):he(t,e,n);return o.then(async function(n){return Promise.resolve({vPropertyValue:n,oSelectedContext:e,sAction:t,sDynamicActionEnabledPath:i})})}async function Pe(t,n){return Promise.all(n).then(function(e){if(e.length){const n=[],i=[];e.forEach(function(e){if(e){if(e.vPropertyValue){t.getModel().setProperty(e.sDynamicActionEnabledPath,true);n.push(e.oSelectedContext)}else{i.push(e.oSelectedContext)}}});ye(t,e[0].sAction,n,i)}}).catch(function(t){e.trace("Cannot retrieve property value from path",t)})}function ye(e,t,n,i){const o=`${e.getPath()}/dynamicActions/${t}`,r=e.getModel();r.setProperty(`${o}/aApplicable`,n);r.setProperty(`${o}/aNotApplicable`,i)}function $e(e){const t=p.getDataTypeClassName(e);const n=p.getBaseType(t,{},{});return O.getOperatorsForType(n)}function Ce(e,t){return e.filter(function(e){return t.indexOf(e)>-1})}function Se(e){const t=mt.AllowedExpressionsPrio;e.sort(function(e,n){return t.indexOf(e)-t.indexOf(n)});return e[0]}function Ee(e,t,n,i,o,r){const s=mt.getFilterRestrictionsByPath(t,n);const a=["EQ"];const l=["EQ","GE","LE","LT","GT","BT","NOTLE","NOTLT","NOTGE","NOTGT"];const u=["EQ","BT"];const p=["TODAY","TOMORROW","YESTERDAY","DATE","FIRSTDAYWEEK","LASTDAYWEEK","FIRSTDAYMONTH","LASTDAYMONTH","FIRSTDAYQUARTER","LASTDAYQUARTER","FIRSTDAYYEAR","LASTDAYYEAR"];const f=["EQ","BT"];const d=["EQ","GE","LE","LT","GT","BT","NE","NOTBT","NOTLE","NOTLT","NOTGE","NOTGT"];const g=["Contains","NotContains","StartsWith","NotStartsWith","EndsWith","NotEndsWith"];const m=c.getSupportedOperations();const v=o==="true"||o===true;let b=[];const h=r&&typeof r==="string"?JSON.parse(r).customData:r;if(n.getObject(`${t}/@com.sap.vocabularies.Common.v1.ResultContext`)===true){return a}if(h&&h.operatorConfiguration&&h.operatorConfiguration.length>0){b=c.getFilterOperations(h.operatorConfiguration)}else{b=c.getSemanticDateOperations()}let O=$e(i);if(v){O=m.concat(O)}let P=[];if(s&&s.FilterAllowedExpressions&&s.FilterAllowedExpressions[e]){const t=mt.getSpecificAllowedExpression(s.FilterAllowedExpressions[e]);switch(t){case"SingleValue":const e=i==="Edm.Date"&&v?p:a;P=Ce(O,e);break;case"MultiValue":P=Ce(O,a);break;case"SingleRange":let t;if(v){if(i==="Edm.Date"){t=b}else if(i==="Edm.DateTimeOffset"){t=b.concat(f)}else{t=l}}else if(i==="Edm.DateTimeOffset"){t=u}else{t=l}const n=Ce(O,t);P=n;break;case"MultiRange":P=Ce(O,d);break;case"SearchExpression":P=Ce(O,g);break;case"MultiRangeOrSearchExpression":P=Ce(O,g.concat(d));break;default:break}}return P}C.getOperatorsForProperty=Ee;function je(){const e=["EQ","NE"];return e.toString()}function Te(e){const t=$e(e);const n=["EQ","GE","LE","LT","GT","BT","NE","NOTBT","NOTLE","NOTLT","NOTGE","NOTGT"];return Ce(t,n)}function Ae(e,t){const n=t.substring(0,t.lastIndexOf("/"));const i=e.getObject(`${n}/@com.sap.vocabularies.Common.v1.ResultContext`);const o={};if(i&&n!==t){o.contextPath=n;o.parameterProperties=mt.getContextPathProperties(e,n)}return o}function xe(e,t,n,i,o){var r;const s=S(o,e);if(o!==null&&o!==void 0&&o.SemanticDates&&n&&n.indexOf(o===null||o===void 0?void 0:(r=o.SemanticDates)===null||r===void 0?void 0:r.operator)>-1){const e=mt.addSemanticDatesToConditions(o===null||o===void 0?void 0:o.SemanticDates);if(e&&Object.keys(e).length>0){i.push(e)}}else if(s){if(t.length===0||t.indexOf(s.operator)>-1){i.push(s)}}return i}function Fe(e){const t=[];if(e!==null&&e!==void 0&&e.high){t.push(e===null||e===void 0?void 0:e.high)}if(e!==null&&e!==void 0&&e.low){t.push(e===null||e===void 0?void 0:e.low)}return{values:t,operator:e===null||e===void 0?void 0:e.operator,isEmpty:undefined}}function Re(e,t,n,i,o,r,s,a,c,l,u,p){let f=[],d,g,m=[];if(c||mt.isPropertyFilterable(a,e,r,true)){const v=s[r];d=t.getSelectOption(n);const b=De(p,r);g=c?["EQ"]:mt.getOperatorsForProperty(r,e,a);if(u){m=c?["EQ"]:mt.getOperatorsForProperty(r,e,a,v===null||v===void 0?void 0:v.$Type,u,b)}f=c?mt.addSelectOptionToConditions(v,g,m,f,d[0]):d.reduce(mt.addSelectOptionToConditions.bind(null,v,g,m),f);if(f.length){if(o){i[o+r]=i.hasOwnProperty(o+r)?i[o+r].concat(f):f}else if(l){f.forEach(e=>{e["filtered"]=true});if(i.hasOwnProperty(r)){i[r].forEach(e=>{e["filtered"]=false});i[r]=i[r].concat(f)}else{i[r]=f}}else{i[r]=i.hasOwnProperty(r)?i[r].concat(f):f}}}}function Ne(e){var t,n;return{high:(e===null||e===void 0?void 0:(t=e.values)===null||t===void 0?void 0:t[0])||null,low:(e===null||e===void 0?void 0:(n=e.values)===null||n===void 0?void 0:n[1])||null,operator:e===null||e===void 0?void 0:e.operator}}function De(){var e,t;let n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let i=arguments.length>1?arguments[1]:undefined;const o=n===null||n===void 0?void 0:n.controlConfiguration;const r=o&&((e=o["@com.sap.vocabularies.UI.v1.SelectionFields"])===null||e===void 0?void 0:e.filterFields);return r!==null&&r!==void 0&&r[i]?(t=r[i])===null||t===void 0?void 0:t.settings:undefined}function Ie(e,t,n,i,o,r,s){const a=e.getSelectOptionsPropertyNames(),c=mt.getContextPathProperties(n,i),l=Object.keys(c),u=mt.getParameterInfo(n,i),p=u.contextPath,f=u.parameterProperties;if(p!==undefined&&f&&Object.keys(f).length>0){const i=Object.keys(f);i.forEach(function(i){let c;if(a.includes(`$Parameter.${i}`)){c=`$Parameter.${i}`}else if(a.includes(i)){c=i}else if(i.startsWith("P_")&&a.includes(`$Parameter.${i.slice(2,i.length)}`)){c=`$Parameter.${i.slice(2,i.length)}`}else if(i.startsWith("P_")&&a.includes(i.slice(2,i.length))){c=i.slice(2,i.length)}else if(a.includes(`$Parameter.P_${i}`)){c=`$Parameter.P_${i}`}else if(a.includes(`P_${i}`)){c=`P_${i}`}if(c){Re(p,e,c,t,undefined,i,f,n,true,o,r,s)}})}l.forEach(function(l){let u;if(a.includes(l)){u=l}else if(l.startsWith("P_")&&a.includes(l.slice(2,l.length))){u=l.slice(2,l.length)}else if(a.includes(`P_${l}`)){u=`P_${l}`}if(u){Re(i,e,u,t,undefined,l,c,n,false,o,r,s)}});a.forEach(function(a){if(a.indexOf(".")>0&&!a.includes("$Parameter")){const c=a.replaceAll(".","/");const l=`/${c}`.startsWith(i)?`/${c}`:`${i}/${c}`;if(n.getObject(l.replace("P_",""))){we(l,i,e,a,n,t,o,r,s)}}});return t}function we(e,t,n,i,o,r,s,a,c){let l=i.split(".");if(`/${i.replaceAll(".","/")}`.startsWith(t)){const e=`/${i}`.replaceAll(".","/"),n=e.replace(`${t}/`,"");l=n.split("/")}let u="";const p=l[l.length-1];for(let e=0;e<l.length-1;e++){if(o.getObject(`${t}/${l[e].replace("P_","")}`).$isCollection){u=`${u+l[e]}*/`}else{u=`${u+l[e]}/`}t=`${t}/${l[e]}`}const f=e.slice(0,e.lastIndexOf("/")),d=mt.getContextPathProperties(o,f),g=n.getSelectOptionsPropertyNames();let m=p;if(d[p]){m=p}else if(p.startsWith("P_")&&d[p.replace("P_","")]){m=p.replace("P_","")}else if(d[`P_${p}`]&&g.includes(`P_${p}`)){m=`P_${p}`}if(p.startsWith("P_")&&r[u+m]){}else if(!p.startsWith("P_")&&r[u+m]){delete r[u+m];Re(f,n,i,r,u,m,d,o,false,s,a,c)}else{Re(f,n,i,r,u,m,d,o,false,s,a,c)}}function Me(e,t,n){const i=mt.getAppComponent(n);const o=i.getNavigationService();return o.mixAttributesAndSelectionVariant(t,e.toJSONString())}function ke(t,n,i,o){let r;const s=function(t,n,i){const o={option:"",sign:"I",low:n,high:i};switch(t){case"Contains":o.option="CP";break;case"StartsWith":o.option="CP";o.low+="*";break;case"EndsWith":o.option="CP";o.low=`*${o.low}`;break;case"BT":case"LE":case"LT":case"GT":case"NE":case"EQ":o.option=t;break;case"DATE":o.option="EQ";break;case"DATERANGE":o.option="BT";break;case"FROM":o.option="GE";break;case"TO":o.option="LE";break;case"EEQ":o.option="EQ";break;case"Empty":o.option="EQ";o.low="";break;case"NotContains":o.option="CP";o.sign="E";break;case"NOTBT":o.option="BT";o.sign="E";break;case"NotStartsWith":o.option="CP";o.low+="*";o.sign="E";break;case"NotEndsWith":o.option="CP";o.low=`*${o.low}`;o.sign="E";break;case"NotEmpty":o.option="NE";o.low="";break;case"NOTLE":o.option="LE";o.sign="E";break;case"NOTGE":o.option="GE";o.sign="E";break;case"NOTLT":o.option="LT";o.sign="E";break;case"NOTGT":o.option="GT";o.sign="E";break;default:e.warning(`${t} is not supported. ${r} could not be added to the navigation context`)}return o};const a=n.filterConditions;const l=n.filterConditionsWithoutConflict?n.filterConditionsWithoutConflict:{};const u=i.propertiesWithoutConflict?i.propertiesWithoutConflict:{};const p=function(e,t,n){const i=a[t];const r=o&&o.getPropertyHelper().getProperty(t);const l=r===null||r===void 0?void 0:r.typeConfig;const u=o&&o.getControlDelegate().getTypeUtil();for(const o in i){const r=i[o];let a="",f="I",d="",g=null,m;const v=O.getOperator(r.operator);if(v instanceof P){var p;m=mt.createSemanticDatesFromConditions(r);const e=v.getModelFilter(r,t,l===null||l===void 0?void 0:l.typeInstance,false,l===null||l===void 0?void 0:l.baseType);if(!(e!==null&&e!==void 0&&e.getFilters())&&!(e!==null&&e!==void 0&&(p=e.getFilters())!==null&&p!==void 0&&p.length)){f=v.exclude?"E":"I";d=u.externalizeValue(e.getValue1(),l.typeInstance);g=u.externalizeValue(e.getValue2(),l.typeInstance);a=e.getOperator()}}else{const e=c.getSupportedOperations();if(e.includes(r===null||r===void 0?void 0:r.operator)){m=mt.createSemanticDatesFromConditions(r)}const t=r.values[0]&&r.values[0].toString()||"";const n=r.values[1]&&r.values[1].toString()||null;const i=s(r.operator,t,n);f=v!==null&&v!==void 0&&v.exclude?"E":"I";d=i===null||i===void 0?void 0:i.low;g=i===null||i===void 0?void 0:i.high;a=i===null||i===void 0?void 0:i.option}if(a&&m){e.addSelectOption(n?n:t,f,a,d,g,undefined,m)}else if(a){e.addSelectOption(n?n:t,f,a,d,g)}}};for(r in a){if(!t.getSelectOption(r)){if(r==="$editState"){continue}p(t,r)}else{if(u&&r in u){p(t,r,u[r])}if(r in l){p(t,r,l[r])}}}return t}function Be(e){const t=a.isStickySessionSupported(e.getModel().getMetaModel());const n=e.getModel("ui").getProperty("/isEditable");return t&&n}function Ve(e,t,n){if(t&&e&&e.length){for(let i=0;i<e.length;i++){const o=t.getSelectOption("DisplayCurrency"),r=n&&n.getSelectOption("DisplayCurrency");if(e[i].$PropertyPath==="DisplayCurrency"&&(!o||!o.length)&&r&&r.length){const e=r[0];const n=e["Sign"];const i=e["Option"];const o=e["Low"];const s=e["High"];t.addSelectOption("DisplayCurrency",n,i,o,s)}}}}function Le(e,t,n){const i=e.getObject(`${t}/`).$Key;const o=[];const r=[];const s=e.getObject(`${t}/`);for(const c in s){if(s[c].$kind&&s[c].$kind==="Property"){const l=e.getObject(`${t}/${c}@`)||{},u=i.indexOf(c)>-1,p=l["@Org.OData.Core.V1.Immutable"],f=!l["@Org.OData.Core.V1.Computed"],d=!l["@com.sap.vocabularies.UI.v1.Hidden"],g=l["@Org.OData.Core.V1.ComputedDefaultValue"],m=u&&s[c].$Type==="Edm.Guid"?g&&l["@com.sap.vocabularies.Common.v1.Text"]:false;if((m||u&&s[c].$Type!=="Edm.Guid")&&f&&d){o.push(c)}else if(p&&f&&d){r.push(c)}if(!f&&g&&n){var a;const e=ne(n).getDiagnostics();const t="Core.ComputedDefaultValue is ignored as Core.Computed is already set to true";e.addIssue(I.Annotation,N.Medium,t,D,D===null||D===void 0?void 0:(a=D.Annotations)===null||a===void 0?void 0:a.IgnoredAnnotation)}}}const c=mt.getRequiredPropertiesFromInsertRestrictions(t,e);if(c.length){c.forEach(function(n){const i=e.getObject(`${t}/${n}@`),s=!i||!i["@com.sap.vocabularies.UI.v1.Hidden"];if(s&&o.indexOf(n)===-1&&r.indexOf(n)===-1){o.push(n)}})}return o.concat(r)}function Ue(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const i=[];let o=[];const r="$NavigationPropertyBinding";let s;if(e.endsWith("$")){e=e.replace("/$","")}const c=e.replaceAll("%2F","/").split("/").filter(a.filterOutNavPropBinding);const l=a.getEntitySetPath(e,t);const u=l.split("/").filter(a.filterOutNavPropBinding);const p=t.getObject(`/${c.join("/")}/$ContainsTarget`);const f=p&&c[c.length-1];if(!p){s=t.getObject(`${l}@`)}if(c.length>1){const e=p?f:u[u.length-1];const i=p?l:`/${u.slice(0,-1).join(`/${r}/`)}`;const a=mt.getNavigationRestrictions(t,i,e.replaceAll("%2F","/"));if(a!==undefined&&mt.hasRestrictedPropertiesInAnnotations(a,true,n)){o=n?a["UpdateRestrictions"].RequiredProperties||[]:a["InsertRestrictions"].RequiredProperties||[]}if((!o||!o.length)&&mt.hasRestrictedPropertiesInAnnotations(s,false,n)){o=mt.getRequiredPropertiesFromAnnotations(s,n)}}else if(mt.hasRestrictedPropertiesInAnnotations(s,false,n)){o=mt.getRequiredPropertiesFromAnnotations(s,n)}o.forEach(function(e){const t=e.$PropertyPath;i.push(t)});return i}function qe(e,t){return mt.getRequiredProperties(e,t)}function We(e,t){return mt.getRequiredProperties(e,t,true)}function _e(e){var t;let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(n){var i;return((i=e["@Org.OData.Capabilities.V1.UpdateRestrictions"])===null||i===void 0?void 0:i.RequiredProperties)||[]}return((t=e["@Org.OData.Capabilities.V1.InsertRestrictions"])===null||t===void 0?void 0:t.RequiredProperties)||[]}function Ge(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(t){const t=e;if(n){return t&&t["UpdateRestrictions"]&&t["UpdateRestrictions"].RequiredProperties?true:false}return t&&t["InsertRestrictions"]&&t["InsertRestrictions"].RequiredProperties?true:false}else if(n){const t=e;return t&&t["@Org.OData.Capabilities.V1.UpdateRestrictions"]&&t["@Org.OData.Capabilities.V1.UpdateRestrictions"].RequiredProperties?true:false}const i=e;return i&&i["@Org.OData.Capabilities.V1.InsertRestrictions"]&&i["@Org.OData.Capabilities.V1.InsertRestrictions"].RequiredProperties?true:false}async function He(e,t,n,i,o,r){return new Promise(function(s){const a=e.getComponentData(),c=a&&a.startupParameters||{},l=e.getShellServices();if(!l.hasUShell()){t.forEach(function(e){var t;const s=i?`/${e.$Name}`:(t=e.getPath)===null||t===void 0?void 0:t.call(e).slice(e.getPath().lastIndexOf("/")+1);const a=i?s.slice(1):s;if(r&&o){if(r[a]){n.setProperty(s,r[a])}}else if(c[a]){n.setProperty(s,c[a][0])}});return s(true)}return l.getStartupAppState(e).then(function(e){const a=(e===null||e===void 0?void 0:e.getData())||{},l=a.selectionVariant&&a.selectionVariant.SelectOptions||[];t.forEach(function(e){var t;const s=i?`/${e.$Name}`:(t=e.getPath)===null||t===void 0?void 0:t.call(e).slice(e.getPath().lastIndexOf("/")+1);const a=i?s.slice(1):s;if(r&&o){if(r[a]){n.setProperty(s,r[a])}}else if(c[a]){n.setProperty(s,c[a][0])}else if(l.length>0){for(const e in l){const t=l[e];if(t.PropertyName===a){const e=t.Ranges.length?t.Ranges[t.Ranges.length-1]:undefined;if(e&&e.Sign==="I"&&e.Option==="EQ"){n.setProperty(s,e.Low)}}}}});return s(true)})})}function Qe(e,t){const n=t,i=n!==undefined?Object.keys(n).filter(function(e){return n[e].useForCreate}):[];let o;for(let t=0;t<i.length;t++){const n=i[t];const r=e&&e[n];if(r&&r.length===1){o=o||Object.create(null);o[n]=r[0]}}return o}function Ye(e){const t=[];if(e.parameters){const n=Object.keys(e.parameters)||[];if(n.length>0){n.forEach(function(n){const i=e.parameters[n];if(i.value&&i.value.value&&i.value.format==="binding"){const e={LocalProperty:{$PropertyPath:i.value.value},SemanticObjectProperty:n};if(t.length>0){for(let n=0;n<t.length;n++){var o;if(((o=t[n].LocalProperty)===null||o===void 0?void 0:o.$PropertyPath)!==e.LocalProperty.$PropertyPath){t.push(e)}}}else{t.push(e)}}})}}return t}function Ke(t,n){const i={};let o;const r=t.controlConfiguration;for(const t in r){if(t.indexOf("@com.sap.vocabularies.UI.v1.DataPoint")>-1||t.indexOf("@com.sap.vocabularies.UI.v1.Chart")>-1){var s,a;const c=(s=r[t].navigation)===null||s===void 0?void 0:(a=s.targetOutbound)===null||a===void 0?void 0:a.outbound;if(c!==undefined){const r=n[c];if(r.semanticObject&&r.action){if(t.indexOf("Chart")>-1){o=T(["fe","MicroChartLink",t])}else{o=T(["fe","HeaderDPLink",t])}const e=mt.getSemanticObjectMapping(r);i[o]={semanticObject:r.semanticObject,action:r.action,semanticObjectMapping:e}}else{e.error(`Cross navigation outbound is configured without semantic object and action for ${c}`)}}}}return i}function ze(e,t){const n=typeof t==="string"?JSON.parse(t):t;for(let t=0;t<n.length;t++){const i=n[t]["LocalProperty"]&&n[t]["LocalProperty"]["$PropertyPath"]||n[t]["@com.sap.vocabularies.Common.v1.LocalProperty"]&&n[t]["@com.sap.vocabularies.Common.v1.LocalProperty"]["$Path"];const o=n[t]["SemanticObjectProperty"]||n[t]["@com.sap.vocabularies.Common.v1.SemanticObjectProperty"];const r=e.getSelectOption(i);if(r){e.removeSelectOption(i);e.massAddSelectOption(o,r)}}return e}async function Je(e,t,n){return new Promise(function(i){let o,r;if(n===""){o=e.getObject(`${t}@${"com.sap.vocabularies.Common.v1.SemanticObject"}`);r=e.getObject(`${t}@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}`)}else{o=e.getObject(`${t}@${"com.sap.vocabularies.Common.v1.SemanticObject"}#${n}`);r=e.getObject(`${t}@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}#${n}`)}const s=[{semanticObject:o}];const a={semanticObject:o};i({semanticObjectPath:t,semanticObjectForGetLinks:s,semanticObject:a,unavailableActions:r})})}async function Xe(t,i,o,r){return Promise.all(t).then(function(e){let t,s,a,c=[];let l={};const u=function(e,t){for(const n in t){if(n===e){return true}else{return false}}};for(let n=0;n<e.length;n++){t=e[n];if(t&&t.length>0&&t[0]!==undefined){const e={};let o;let p;for(let l=0;l<t.length;l++){c.push([]);let f=false;let d=false;for(let e=0;e<t[l][0].length;e++){s=t[l][0][e];a=s&&s.intent.split("?")[0].split("-")[1];if(!(s&&s.intent&&s.intent.indexOf(r)===0)){f=true;if(!u(a,i[n].unavailableActions)){c[l].push(s);d=true}}}o={semanticObject:i[n].semanticObject,path:i[n].path,HasTargets:d,HasTargetsNotFiltered:f};if(e[i[n].semanticObject]===undefined){e[i[n].semanticObject]={}}p=i[n].path.replace(/\//g,"_");if(e[i[n].semanticObject][p]===undefined){e[i[n].semanticObject][p]={}}e[i[n].semanticObject][p]=Object.assign(e[i[n].semanticObject][p],o)}const f=Object.keys(e)[0];if(Object.keys(l).includes(f)){l[f]=Object.assign(l[f],e[f])}else{l=Object.assign(l,e)}c=[]}}if(Object.keys(l).length>0){o.setProperty("semanticsTargets",n(l,o.getProperty("semanticsTargets")));return l}}).catch(function(t){e.error("fnUpdateSemanticTargetsModel: Cannot read links",t)})}async function Ze(e,t,n,i,o){return mt.getSemanticObjectsFromPath(n,i,o)}function et(e,t,n,i,o){let r,s;let a,c;for(let l=0;l<i.length;l++){s=i[l];r=Object.keys(n.getObject(s+"@"));for(let i=0;i<r.length;i++){if(r[i].indexOf(`@${"com.sap.vocabularies.Common.v1.SemanticObject"}`)===0&&r[i].indexOf(`@${"com.sap.vocabularies.Common.v1.SemanticObjectMapping"}`)===-1&&r[i].indexOf(`@${"com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"}`)===-1){c=/#(.*)/.exec(r[i]);a=c?c[1]:"";o.push(mt.getSemanticObjectPromise(e,t,n,s,a))}}}}function tt(t,n){const i=function(e,t,n){if(!e){return n}if(e instanceof Array){for(const o in e){n=n.concat(i(e[o],t,[]))}return n}if(e[t]){n.push(e[t])}if(typeof e=="object"&&e!==null){const o=Object.keys(e);if(o.length>0){for(let r=0;r<o.length;r++){n=n.concat(i(e[o[r]],t,[]))}}}return n};const o=function(e,t){return i(e,t,[])};const r=function(e){return e.filter(function(t,n){return e.indexOf(t)===n})};const s=t.getView();const a=s.getBindingContext("internal");if(a){const i=[];const c=t.getOwnerComponent();const l=d.getOwnerComponentFor(c);const u=l.getMetaModel();let p=c.getModel(n).getData();if(JSON.stringify(p)==="{}"){p=c.getModel(n)._getObject("/",undefined)}let f=o(p,"semanticObjectPath");f=r(f);const g=mt.getShellServices(l);let m=mt.getHash();const v=[];const b=[];let h;if(m&&m.indexOf("?")!==-1){m=m.split("?")[0]}et(l,s,u,f,i);if(i.length===0){return Promise.resolve()}else{Promise.all(i).then(async function(e){const t=[];let n;const i=e.filter(function(e){if(e.semanticObject!==undefined&&e.semanticObject.semanticObject&&typeof e.semanticObject.semanticObject==="object"){n=R(A(e.semanticObject.semanticObject.$Path));e.semanticObject.semanticObject=n;e.semanticObjectForGetLinks[0].semanticObject=n;return true}else if(e){return e.semanticObject!==undefined}else{return false}});for(let e=0;e<i.length;e++){h=i[e];if(h&&h.semanticObject&&!(h.semanticObject.semanticObject.indexOf("{")===0)){v.push(h.semanticObjectForGetLinks);b.push({semanticObject:h.semanticObject.semanticObject,unavailableActions:h.unavailableActions,path:i[e].semanticObjectPath});t.push(g.getLinksWithCache([h.semanticObjectForGetLinks]))}}return mt.updateSemanticTargets(t,b,a,m)}).catch(function(t){e.error("fnGetSemanticTargetsFromTable: Cannot get Semantic Objects",t)})}}else{return Promise.resolve()}}function nt(e){const t={};if(e&&e.FilterExpressionRestrictions!==undefined){e.FilterExpressionRestrictions.forEach(function(e){if(e.Property&&e.AllowedExpressions!==undefined){if(t[e.Property.$PropertyPath]!==undefined){t[e.Property.$PropertyPath].push(e.AllowedExpressions)}else{t[e.Property.$PropertyPath]=[e.AllowedExpressions]}}})}return t}function it(e,t){let n=[];if(e&&e[t]){n=e[t].map(function(e){return e.$PropertyPath})}return n}function ot(e,t,n){const i=t+"/";return e.reduce((e,t)=>{if(t.startsWith(i)){const n=t.replace(i,"");if(e.indexOf(n)===-1){e.push(n)}}return e},n)}function rt(e,i){const o={RequiredProperties:[],NonFilterableProperties:[],FilterAllowedExpressions:{}};let r;const s="$NavigationPropertyBinding";const c="@Org.OData.Capabilities.V1.FilterRestrictions";const l=e.replaceAll("%2F","/").split("/").filter(a.filterOutNavPropBinding);const u=`/${l.join("/")}/`;const p=a.getEntitySetPath(e,i);const f=p.split("/").filter(a.filterOutNavPropBinding);const d=i.getObject(`${u}$ContainsTarget`);const g=d&&l[l.length-1];if(!d){r=i.getObject(`${p}${c}`);o.RequiredProperties=it(r,"RequiredProperties")||[];const e=i.getObject(`${u}@com.sap.vocabularies.Common.v1.ResultContext`);if(!e){o.NonFilterableProperties=it(r,"NonFilterableProperties")||[]}o.FilterAllowedExpressions=nt(r)||{}}if(l.length>1){const e=d?g:f[f.length-1];const r=d?p:`/${f.slice(0,-1).join(`/${s}/`)}`;const a={RequiredProperties:[],NonFilterableProperties:[],FilterAllowedExpressions:{}};if(!e.includes("%2F")){const t=i.getObject(`${r}${c}`);o.RequiredProperties=ot(it(t,"RequiredProperties")||[],e,o.RequiredProperties||[]);o.NonFilterableProperties=ot(it(t,"NonFilterableProperties")||[],e,o.NonFilterableProperties||[]);const n=nt(t)||{};a.FilterAllowedExpressions=Object.keys(n).reduce((t,i)=>{if(i.startsWith(e+"/")){const o=i.replace(e+"/","");t[o]=n[i]}return t},{})}o.FilterAllowedExpressions=n({},o.FilterAllowedExpressions||{},a.FilterAllowedExpressions||{});const u=mt.getNavigationRestrictions(i,r,e.replaceAll("%2F","/"));const m=u&&u["FilterRestrictions"];const v=it(m,"RequiredProperties")||[];o.RequiredProperties=t(o.RequiredProperties.concat(v));const b=it(m,"NonFilterableProperties")||[];o.NonFilterableProperties=t(o.NonFilterableProperties.concat(b));o.FilterAllowedExpressions=n({},o.FilterAllowedExpressions||{},nt(m)||{});const h=i.getObject(`/${l.join("/")}${c}`);const O=it(h,"RequiredProperties")||[];o.RequiredProperties=t(o.RequiredProperties.concat(O));const P=it(h,"NonFilterableProperties")||[];o.NonFilterableProperties=t(o.NonFilterableProperties.concat(P));o.FilterAllowedExpressions=n({},o.FilterAllowedExpressions,nt(h)||{})}return o}async function st(e,t,n,i){n=n||{};if(i){return i.templateControlFragment(e,t,n.view).then(function(e){return i.targets==="xmlTree"&&e.length>0?e[0]:e})}else{return ut().then(async function(){return v.process(b.loadTemplate(e,"fragment"),{name:e},t)}).then(async function(e){const t=e.firstElementChild;if(!!n.isXML&&t){return Promise.resolve(t)}return m.load({id:n.id,definition:e,controller:n.controller})})}}function at(e,t){const n=e.split("/").filter(Boolean),i=n.pop(),o=n.join("/"),r=o&&t.getObject(`/${o}`);if((r===null||r===void 0?void 0:r.$kind)==="Singleton"){const e=n[n.length-1];return`/${e}/${i}`}return undefined}async function ct(e,t){if(!e||!t){return Promise.resolve(null)}const n=t.getMetaModel();const i=at(e,n);if(i){const e=t.bindProperty(i);return e.requestValue()}return Promise.resolve(null)}function lt(t,n,i){let o;const r=function(){if(o){if(!o.events){o.events={}}if(!o.events[n]){o.events[n]=i}else{const e=o.events[n];o.events[n]=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++){n[o]=arguments[o]}i.apply(this,...n);e.apply(this,...n)}}}};if(t.isA("sap.ui.mdc.Chart")){t.innerChartBound().then(function(){o=t.getControlDelegate()._getChart(t).getBindingInfo("data");r()}).catch(function(t){e.error(t)})}else{o=t.data("rowsBindingInfo");r()}}async function ut(){return new Promise(function(e){sap.ui.require(["sap/fe/macros/macroLibrary"],function(){e()})})}function pt(e,t){let n;if(e.indexOf("@$ui5.overload")>-1){n=e.split("@$ui5.overload")[0]}else{const t=e.split("/0")[0].split(".");n=`/${t[t.length-1]}/`}return n+t}function ft(e,t){const n=new y({anyText:e});t.addDependent(n);const i=n.getAnyText();t.removeDependent(n);n.destroy();return i}function dt(){return!E.desktop||h.resize.width<=320}function gt(e,t,o,r){const s=t.createBindingContext(e);return i===null||i===void 0?void 0:i.createConverterContextForMacro(o,s||t,r,n,undefined)}const mt={isPropertyFilterable:_,isFieldControlPathInapplicable:re,removeSensitiveData:se,fireButtonPress:ee,getTargetView:oe,getCurrentPageView:ie,hasTransientContext:B,updateRelatedAppsDetails:Z,resolveStringtoBoolean:te,getAppComponent:ne,getMandatoryFilterFields:le,getContextPathProperties:ce,getParameterInfo:Ae,updateDataFieldForIBNButtonsVisibility:pe,getTranslatedText:fe,getEntitySetName:me,getActionPath:ge,computeDisplayMode:ve,isStickyEditMode:Be,getOperatorsForProperty:Ee,getOperatorsForDateProperty:Te,getOperatorsForGuidProperty:je,addSelectionVariantToConditions:Ie,addExternalStateFiltersToSelectionVariant:ke,addPageContextToSelectionVariant:Me,addDefaultDisplayCurrency:Ve,getNonComputedVisibleFields:Le,setUserDefaults:He,getShellServices:G,getHash:H,getIBNActions:ue,getHeaderFacetItemConfigForExternalNavigation:Ke,getSemanticObjectMapping:Ye,setSemanticObjectMappings:ze,getSemanticObjectPromise:Ze,getSemanticTargetsFromPageModel:tt,getSemanticObjectsFromPath:Je,updateSemanticTargets:Xe,getPropertyDataType:M,waitForContextRequested:k,getNavigationRestrictions:L,getSearchRestrictions:V,getFilterRestrictionsByPath:rt,getSpecificAllowedExpression:Se,getAdditionalParamsForCreate:Qe,requestSingletonProperty:ct,templateControlFragment:st,addEventToBindingInfo:lt,FilterRestrictions:{REQUIRED_PROPERTIES:"RequiredProperties",NON_FILTERABLE_PROPERTIES:"NonFilterableProperties",ALLOWED_EXPRESSIONS:"FilterAllowedExpressions"},AllowedExpressionsPrio:["SingleValue","MultiValue","SingleRange","MultiRange","SearchExpression","MultiRangeOrSearchExpression"],normalizeSearchTerm:w,getSingletonPath:at,getRequiredPropertiesFromUpdateRestrictions:We,getRequiredPropertiesFromInsertRestrictions:qe,hasRestrictedPropertiesInAnnotations:Ge,getRequiredPropertiesFromAnnotations:_e,getRequiredProperties:Ue,checkIfResourceKeyExists:de,setContextsBasedOnOperationAvailable:Pe,setDynamicActionContexts:ye,requestProperty:Oe,getParameterPath:pt,getRelatedAppsMenuItems:K,getTranslatedTextFromExpBindingString:ft,addSemanticDatesToConditions:Fe,addSelectOptionToConditions:xe,createSemanticDatesFromConditions:Ne,updateRelateAppsModel:J,getSemanticObjectAnnotations:X,isCustomAggregate:q,isSmallDevice:dt,getConverterContextForPath:gt};return mt},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/ExtensionAPI-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/ui/base/Object", "sap/ui/core/Component", "sap/ui/model/json/JSONModel", "./helpers/ClassSupport"], function (Log, CommonUtils, BaseObject, Component, JSONModel, ClassSupport) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _class, _class2, _descriptor, _descriptor2, _descriptor3;
  var property = ClassSupport.property;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  /**
   * Common Extension API for all pages of SAP Fiori elements for OData V4.
   *
   * @alias sap.fe.core.ExtensionAPI
   * @public
   * @hideconstructor
   * @extends sap.ui.base.Object
   * @since 1.79.0
   */
  let ExtensionAPI = (_dec = defineUI5Class("sap.fe.core.ExtensionAPI"), _dec2 = property({
    type: "sap/fe/core/controllerextensions/EditFlow"
  }), _dec3 = property({
    type: "sap/fe/core/controllerextensions/Routing"
  }), _dec4 = property({
    type: "sap/fe/core/controllerextensions/IntentBasedNavigation"
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_BaseObject) {
    _inheritsLoose(ExtensionAPI, _BaseObject);
    /**
     * A controller extension offering hooks into the edit flow of the application.
     *
     * @public
     */

    /**
     * A controller extension offering hooks into the routing flow of the application.
     *
     * @public
     */

    /**
     * ExtensionAPI for intent-based navigation
     *
     * @public
     */

    function ExtensionAPI(oController, sId) {
      var _this;
      _this = _BaseObject.call(this) || this;
      _initializerDefineProperty(_this, "editFlow", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "routing", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "intentBasedNavigation", _descriptor3, _assertThisInitialized(_this));
      _this._controller = oController;
      _this._view = oController.getView();
      _this.extension = _this._controller.extension;
      _this.editFlow = _this._controller.editFlow;
      _this.routing = _this._controller.routing;
      _this._routing = _this._controller._routing;
      _this.intentBasedNavigation = _this._controller.intentBasedNavigation;
      _this._prefix = sId;
      return _this;
    }
    var _proto = ExtensionAPI.prototype;
    _proto.destroy = function destroy() {
      // delete this._controller;
      // delete this._view;
      // delete this.editFlow._controller;
      // delete this.intentBasedNavigation._controller;
    }

    /**
     * Retrieves the editFlow controller extension for this page.
     *
     * @public
     * @returns The editFlow controller extension
     */;
    _proto.getEditFlow = function getEditFlow() {
      return this.editFlow;
    }

    /**
     * Retrieves the routing controller extension for this page.
     *
     * @public
     * @returns The routing controller extension
     */;
    _proto.getRouting = function getRouting() {
      return this.routing;
    }

    /**
     * Retrieves the intentBasedNavigation controller extension for this page.
     *
     * @public
     * @returns The intentBasedNavigation controller extension
     */;
    _proto.getIntentBasedNavigation = function getIntentBasedNavigation() {
      return this.intentBasedNavigation;
    }

    /**
     * Access any control by ID.
     *
     * @alias sap.fe.core.ExtensionAPI#byId
     * @param sId ID of the control without the view prefix. Either the ID prefixed by SAP Fiori elements
     * (for example with the section) or the control ID only. The latter works only for an extension running in
     * the same context (like in the same section). You can use the prefix for SAP Fiori elements to also access other controls located in different sections.
     * @returns The requested control, if found in the view.
     * @private
     */;
    _proto.byId = function byId(sId) {
      let oControl = this._view.byId(sId);
      if (!oControl && this._prefix) {
        // give it a try with the prefix
        oControl = this._view.byId(`${this._prefix}--${sId}`);
      }
      return oControl;
    }

    /**
     * Get access to models managed by SAP Fiori elements.<br>
     * The following models can be accessed:
     * <ul>
     * <li>undefined: the undefined model returns the SAPUI5 OData V4 model bound to this page</li>
     * <li>i18n / further data models defined in the manifest</li>
     * <li>ui: returns a SAPUI5 JSON model containing UI information.
     * Only the following properties are public and supported:
     * 	<ul>
     *     <li>isEditable: set to true if the application is in edit mode</li>
     *  </ul>
     * </li>
     * </ul>.
     * editMode is deprecated and should not be used anymore. Use isEditable instead.
     *
     * @alias sap.fe.core.ExtensionAPI#getModel
     * @param sModelName Name of the model
     * @returns The required model
     * @public
     */;
    _proto.getModel = function getModel(sModelName) {
      let oAppComponent;
      if (sModelName && sModelName !== "ui") {
        oAppComponent = CommonUtils.getAppComponent(this._view);
        if (!oAppComponent.getManifestEntry("sap.ui5").models[sModelName]) {
          // don't allow access to our internal models
          return undefined;
        }
      }
      return this._view.getModel(sModelName);
    }

    /**
     * Add any control as a dependent control to this SAP Fiori elements page.
     *
     * @alias sap.fe.core.ExtensionAPI#addDependent
     * @param oControl Control to be added as a dependent control
     * @public
     */;
    _proto.addDependent = function addDependent(oControl) {
      this._view.addDependent(oControl);
    }

    /**
     * Remove a dependent control from this SAP Fiori elements page.
     *
     * @alias sap.fe.core.ExtensionAPI#removeDependent
     * @param oControl Control to be added as a dependent control
     * @public
     */;
    _proto.removeDependent = function removeDependent(oControl) {
      this._view.removeDependent(oControl);
    }

    /**
     * Navigate to another target.
     *
     * @alias sap.fe.core.ExtensionAPI#navigateToTarget
     * @param sTarget Name of the target route
     * @param [oContext] Context instance
     * @public
     */;
    _proto.navigateToTarget = function navigateToTarget(sTarget, oContext) {
      this._controller._routing.navigateToTarget(oContext, sTarget);
    }

    /**
     * Load a fragment and go through the template preprocessor with the current page context.
     *
     * @alias sap.fe.core.ExtensionAPI#loadFragment
     * @param mSettings The settings object
     * @param mSettings.id The ID of the fragment itself
     * @param mSettings.name The name of the fragment to be loaded
     * @param mSettings.controller The controller to be attached to the fragment
     * @param mSettings.contextPath The contextPath to be used for the templating process
     * @param mSettings.initialBindingContext The initial binding context
     * @returns The fragment definition
     * @public
     */;
    _proto.loadFragment = async function loadFragment(mSettings) {
      var _this$getModel;
      const oTemplateComponent = Component.getOwnerComponentFor(this._view);
      const oPageModel = this._view.getModel("_pageModel");
      const oMetaModel = (_this$getModel = this.getModel()) === null || _this$getModel === void 0 ? void 0 : _this$getModel.getMetaModel();
      const mViewData = oTemplateComponent.getViewData();
      const oViewDataModel = new JSONModel(mViewData),
        oPreprocessorSettings = {
          bindingContexts: {
            contextPath: oMetaModel === null || oMetaModel === void 0 ? void 0 : oMetaModel.createBindingContext(mSettings.contextPath || `/${oTemplateComponent.getEntitySet()}`),
            converterContext: oPageModel.createBindingContext("/", undefined, {
              noResolve: true
            }),
            viewData: mViewData ? oViewDataModel.createBindingContext("/") : null
          },
          models: {
            contextPath: oMetaModel,
            converterContext: oPageModel,
            metaModel: oMetaModel,
            viewData: oViewDataModel
          },
          appComponent: CommonUtils.getAppComponent(this._view)
        };
      const oTemplatePromise = CommonUtils.templateControlFragment(mSettings.name, oPreprocessorSettings, {
        controller: mSettings.controller || this,
        isXML: false,
        id: mSettings.id
      });
      oTemplatePromise.then(oFragment => {
        if (mSettings.initialBindingContext !== undefined) {
          oFragment.setBindingContext(mSettings.initialBindingContext);
        }
        this.addDependent(oFragment);
      }).catch(function (oError) {
        Log.error(oError);
      });
      return oTemplatePromise;
    }

    /**
     * Triggers an update of the app state.
     * Should be called if the state of a control, or any other state-relevant information, was changed.
     *
     * @alias sap.fe.core.ExtensionAPI#updateAppState
     * @returns A promise that resolves with the new app state object.
     * @public
     */;
    _proto.updateAppState = async function updateAppState() {
      return this._controller.getAppComponent().getAppStateHandler().createAppState();
    };
    return ExtensionAPI;
  }(BaseObject), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "editFlow", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "routing", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "intentBasedNavigation", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return ExtensionAPI;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/ExtensionAPI", ["sap/base/Log","sap/fe/core/CommonUtils","sap/ui/base/Object","sap/ui/core/Component","sap/ui/model/json/JSONModel","./helpers/ClassSupport"],function(e,t,n,i,o,r){"use strict";var a,l,u,s,c,d,p,f,g;var v=r.property;var b=r.defineUI5Class;function h(e,t,n,i){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function w(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function _(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;m(e,t)}function m(e,t){m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return m(e,t)}function y(e,t,n,i,o){var r={};Object.keys(i).forEach(function(e){r[e]=i[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=n.slice().reverse().reduce(function(n,i){return i(e,t,n)||n},r);if(o&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(o):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}function x(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let C=(a=b("sap.fe.core.ExtensionAPI"),l=v({type:"sap/fe/core/controllerextensions/EditFlow"}),u=v({type:"sap/fe/core/controllerextensions/Routing"}),s=v({type:"sap/fe/core/controllerextensions/IntentBasedNavigation"}),a(c=(d=function(n){_(r,n);function r(e,t){var i;i=n.call(this)||this;h(i,"editFlow",p,w(i));h(i,"routing",f,w(i));h(i,"intentBasedNavigation",g,w(i));i._controller=e;i._view=e.getView();i.extension=i._controller.extension;i.editFlow=i._controller.editFlow;i.routing=i._controller.routing;i._routing=i._controller._routing;i.intentBasedNavigation=i._controller.intentBasedNavigation;i._prefix=t;return i}var a=r.prototype;a.destroy=function e(){};a.getEditFlow=function e(){return this.editFlow};a.getRouting=function e(){return this.routing};a.getIntentBasedNavigation=function e(){return this.intentBasedNavigation};a.byId=function e(t){let n=this._view.byId(t);if(!n&&this._prefix){n=this._view.byId(`${this._prefix}--${t}`)}return n};a.getModel=function e(n){let i;if(n&&n!=="ui"){i=t.getAppComponent(this._view);if(!i.getManifestEntry("sap.ui5").models[n]){return undefined}}return this._view.getModel(n)};a.addDependent=function e(t){this._view.addDependent(t)};a.removeDependent=function e(t){this._view.removeDependent(t)};a.navigateToTarget=function e(t,n){this._controller._routing.navigateToTarget(n,t)};a.loadFragment=async function n(r){var a;const l=i.getOwnerComponentFor(this._view);const u=this._view.getModel("_pageModel");const s=(a=this.getModel())===null||a===void 0?void 0:a.getMetaModel();const c=l.getViewData();const d=new o(c),p={bindingContexts:{contextPath:s===null||s===void 0?void 0:s.createBindingContext(r.contextPath||`/${l.getEntitySet()}`),converterContext:u.createBindingContext("/",undefined,{noResolve:true}),viewData:c?d.createBindingContext("/"):null},models:{contextPath:s,converterContext:u,metaModel:s,viewData:d},appComponent:t.getAppComponent(this._view)};const f=t.templateControlFragment(r.name,p,{controller:r.controller||this,isXML:false,id:r.id});f.then(e=>{if(r.initialBindingContext!==undefined){e.setBindingContext(r.initialBindingContext)}this.addDependent(e)}).catch(function(t){e.error(t)});return f};a.updateAppState=async function e(){return this._controller.getAppComponent().getAppStateHandler().createAppState()};return r}(n),p=y(d.prototype,"editFlow",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),f=y(d.prototype,"routing",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),g=y(d.prototype,"intentBasedNavigation",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),d))||c);return C},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/PageController-dbg", ["sap/fe/core/BaseController", "sap/fe/core/controllerextensions/EditFlow", "sap/fe/core/controllerextensions/IntentBasedNavigation", "sap/fe/core/controllerextensions/InternalEditFlow", "sap/fe/core/controllerextensions/InternalIntentBasedNavigation", "sap/fe/core/controllerextensions/InternalRouting", "sap/fe/core/controllerextensions/MassEdit", "sap/fe/core/controllerextensions/MessageHandler", "sap/fe/core/controllerextensions/PageReady", "sap/fe/core/controllerextensions/Paginator", "sap/fe/core/controllerextensions/Placeholder", "sap/fe/core/controllerextensions/Routing", "sap/fe/core/controllerextensions/Share", "sap/fe/core/controllerextensions/SideEffects", "sap/fe/core/controllerextensions/ViewState", "sap/fe/core/ExtensionAPI", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/Component", "sap/ui/core/mvc/OverrideExecution"], function (BaseController, EditFlow, IntentBasedNavigation, InternalEditFlow, InternalIntentBasedNavigation, InternalRouting, MassEdit, MessageHandler, PageReady, Paginator, Placeholder, Routing, Share, SideEffects, ViewState, ExtensionAPI, ClassSupport, Component, OverrideExecution) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _descriptor11, _descriptor12, _descriptor13, _descriptor14;
  var usingExtension = ClassSupport.usingExtension;
  var publicExtension = ClassSupport.publicExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  /**
   * Base controller class for your custom page used inside an SAP Fiori elements application.
   *
   * This controller provides preconfigured extensions that will ensure you have the basic functionalities required to use the building blocks.
   *
   * @hideconstructor
   * @public
   * @since 1.88.0
   */
  let PageController = (_dec = defineUI5Class("sap.fe.core.PageController"), _dec2 = usingExtension(Routing), _dec3 = usingExtension(InternalRouting), _dec4 = usingExtension(EditFlow), _dec5 = usingExtension(InternalEditFlow), _dec6 = usingExtension(IntentBasedNavigation), _dec7 = usingExtension(InternalIntentBasedNavigation), _dec8 = usingExtension(PageReady), _dec9 = usingExtension(MessageHandler), _dec10 = usingExtension(Share), _dec11 = usingExtension(Paginator), _dec12 = usingExtension(ViewState), _dec13 = usingExtension(Placeholder), _dec14 = usingExtension(SideEffects), _dec15 = usingExtension(MassEdit), _dec16 = publicExtension(), _dec17 = publicExtension(), _dec18 = publicExtension(), _dec19 = publicExtension(), _dec20 = extensible(OverrideExecution.After), _dec(_class = (_class2 = /*#__PURE__*/function (_BaseController) {
    _inheritsLoose(PageController, _BaseController);
    function PageController() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _BaseController.call(this, ...args) || this;
      _initializerDefineProperty(_this, "routing", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "_routing", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "editFlow", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "_editFlow", _descriptor4, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "intentBasedNavigation", _descriptor5, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "_intentBasedNavigation", _descriptor6, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "pageReady", _descriptor7, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "messageHandler", _descriptor8, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "share", _descriptor9, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "paginator", _descriptor10, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "viewState", _descriptor11, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "placeholder", _descriptor12, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "_sideEffects", _descriptor13, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "massEdit", _descriptor14, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = PageController.prototype;
    /**
     * @private
     * @name sap.fe.core.PageController.getMetadata
     * @function
     */
    /**
     * @private
     * @name sap.fe.core.PageController.extend
     * @function
     */
    _proto.onInit = function onInit() {
      const oUIModel = this.getAppComponent().getModel("ui"),
        oInternalModel = this.getAppComponent().getModel("internal"),
        sPath = `/pages/${this.getView().getId()}`;
      oUIModel.setProperty(sPath, {
        controls: {}
      });
      oInternalModel.setProperty(sPath, {
        controls: {},
        collaboration: {}
      });
      this.getView().bindElement({
        path: sPath,
        model: "ui"
      });
      this.getView().bindElement({
        path: sPath,
        model: "internal"
      });

      // for the time being provide it also pageInternal as some macros access it - to be removed
      this.getView().bindElement({
        path: sPath,
        model: "pageInternal"
      });
      this.getView().setModel(oInternalModel, "pageInternal");

      // as the model propagation happens after init but we actually want to access the binding context in the
      // init phase already setting the model here
      this.getView().setModel(oUIModel, "ui");
      this.getView().setModel(oInternalModel, "internal");
    };
    _proto.onBeforeRendering = function onBeforeRendering() {
      if (this.placeholder.attachHideCallback) {
        this.placeholder.attachHideCallback();
      }
    }

    /**
     * Get the extension API for the current page.
     *
     * @public
     * @returns The extension API.
     */;
    _proto.getExtensionAPI = function getExtensionAPI() {
      if (!this.extensionAPI) {
        this.extensionAPI = new ExtensionAPI(this);
      }
      return this.extensionAPI;
    }
    // We specify the extensibility here the same way as it is done in the object page controller
    // since the specification here overrides it and if we do not specify anything here, the
    // behavior defaults to an execute instead!
    // TODO This may not be ideal, since it also influences the list report controller but currently it's the best solution.
    ;
    _proto.onPageReady = function onPageReady(_mParameters) {
      // Apply app state only after the page is ready with the first section selected
      this.getAppComponent().getAppStateHandler().applyAppState();
    };
    _proto._getPageTitleInformation = function _getPageTitleInformation() {
      return {};
    };
    _proto._getPageModel = function _getPageModel() {
      const pageComponent = Component.getOwnerComponentFor(this.getView());
      return pageComponent === null || pageComponent === void 0 ? void 0 : pageComponent.getModel("_pageModel");
    };
    return PageController;
  }(BaseController), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "routing", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "_routing", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "editFlow", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "_editFlow", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "intentBasedNavigation", [_dec6], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "_intentBasedNavigation", [_dec7], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "pageReady", [_dec8], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "messageHandler", [_dec9], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "share", [_dec10], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor10 = _applyDecoratedDescriptor(_class2.prototype, "paginator", [_dec11], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor11 = _applyDecoratedDescriptor(_class2.prototype, "viewState", [_dec12], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor12 = _applyDecoratedDescriptor(_class2.prototype, "placeholder", [_dec13], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor13 = _applyDecoratedDescriptor(_class2.prototype, "_sideEffects", [_dec14], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor14 = _applyDecoratedDescriptor(_class2.prototype, "massEdit", [_dec15], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec16], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeRendering", [_dec17], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeRendering"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getExtensionAPI", [_dec18], Object.getOwnPropertyDescriptor(_class2.prototype, "getExtensionAPI"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onPageReady", [_dec19, _dec20], Object.getOwnPropertyDescriptor(_class2.prototype, "onPageReady"), _class2.prototype)), _class2)) || _class);
  return PageController;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/PageController", ["sap/fe/core/BaseController","sap/fe/core/controllerextensions/EditFlow","sap/fe/core/controllerextensions/IntentBasedNavigation","sap/fe/core/controllerextensions/InternalEditFlow","sap/fe/core/controllerextensions/InternalIntentBasedNavigation","sap/fe/core/controllerextensions/InternalRouting","sap/fe/core/controllerextensions/MassEdit","sap/fe/core/controllerextensions/MessageHandler","sap/fe/core/controllerextensions/PageReady","sap/fe/core/controllerextensions/Paginator","sap/fe/core/controllerextensions/Placeholder","sap/fe/core/controllerextensions/Routing","sap/fe/core/controllerextensions/Share","sap/fe/core/controllerextensions/SideEffects","sap/fe/core/controllerextensions/ViewState","sap/fe/core/ExtensionAPI","sap/fe/core/helpers/ClassSupport","sap/ui/core/Component","sap/ui/core/mvc/OverrideExecution"],function(e,t,r,n,i,o,a,l,u,s,p,c,f,g,b,d,y,w,h){"use strict";var m,v,P,x,z,E,I,O,_,A,R,C,j,B,M,V,S,F,H,N,D,k,T,U,$,q,G,J,K,L,Q,W,X,Y,Z,ee;var te=y.usingExtension;var re=y.publicExtension;var ne=y.extensible;var ie=y.defineUI5Class;function oe(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function ae(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function le(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;ue(e,t)}function ue(e,t){ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return ue(e,t)}function se(e,t,r,n,i){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o);if(i&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(i):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function pe(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let ce=(m=ie("sap.fe.core.PageController"),v=te(c),P=te(o),x=te(t),z=te(n),E=te(r),I=te(i),O=te(u),_=te(l),A=te(f),R=te(s),C=te(b),j=te(p),B=te(g),M=te(a),V=re(),S=re(),F=re(),H=re(),N=ne(h.After),m(D=(k=function(e){le(t,e);function t(){var t;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++){n[i]=arguments[i]}t=e.call(this,...n)||this;oe(t,"routing",T,ae(t));oe(t,"_routing",U,ae(t));oe(t,"editFlow",$,ae(t));oe(t,"_editFlow",q,ae(t));oe(t,"intentBasedNavigation",G,ae(t));oe(t,"_intentBasedNavigation",J,ae(t));oe(t,"pageReady",K,ae(t));oe(t,"messageHandler",L,ae(t));oe(t,"share",Q,ae(t));oe(t,"paginator",W,ae(t));oe(t,"viewState",X,ae(t));oe(t,"placeholder",Y,ae(t));oe(t,"_sideEffects",Z,ae(t));oe(t,"massEdit",ee,ae(t));return t}var r=t.prototype;r.onInit=function e(){const t=this.getAppComponent().getModel("ui"),r=this.getAppComponent().getModel("internal"),n=`/pages/${this.getView().getId()}`;t.setProperty(n,{controls:{}});r.setProperty(n,{controls:{},collaboration:{}});this.getView().bindElement({path:n,model:"ui"});this.getView().bindElement({path:n,model:"internal"});this.getView().bindElement({path:n,model:"pageInternal"});this.getView().setModel(r,"pageInternal");this.getView().setModel(t,"ui");this.getView().setModel(r,"internal")};r.onBeforeRendering=function e(){if(this.placeholder.attachHideCallback){this.placeholder.attachHideCallback()}};r.getExtensionAPI=function e(){if(!this.extensionAPI){this.extensionAPI=new d(this)}return this.extensionAPI};r.onPageReady=function e(t){this.getAppComponent().getAppStateHandler().applyAppState()};r._getPageTitleInformation=function e(){return{}};r._getPageModel=function e(){const t=w.getOwnerComponentFor(this.getView());return t===null||t===void 0?void 0:t.getModel("_pageModel")};return t}(e),T=se(k.prototype,"routing",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),U=se(k.prototype,"_routing",[P],{configurable:true,enumerable:true,writable:true,initializer:null}),$=se(k.prototype,"editFlow",[x],{configurable:true,enumerable:true,writable:true,initializer:null}),q=se(k.prototype,"_editFlow",[z],{configurable:true,enumerable:true,writable:true,initializer:null}),G=se(k.prototype,"intentBasedNavigation",[E],{configurable:true,enumerable:true,writable:true,initializer:null}),J=se(k.prototype,"_intentBasedNavigation",[I],{configurable:true,enumerable:true,writable:true,initializer:null}),K=se(k.prototype,"pageReady",[O],{configurable:true,enumerable:true,writable:true,initializer:null}),L=se(k.prototype,"messageHandler",[_],{configurable:true,enumerable:true,writable:true,initializer:null}),Q=se(k.prototype,"share",[A],{configurable:true,enumerable:true,writable:true,initializer:null}),W=se(k.prototype,"paginator",[R],{configurable:true,enumerable:true,writable:true,initializer:null}),X=se(k.prototype,"viewState",[C],{configurable:true,enumerable:true,writable:true,initializer:null}),Y=se(k.prototype,"placeholder",[j],{configurable:true,enumerable:true,writable:true,initializer:null}),Z=se(k.prototype,"_sideEffects",[B],{configurable:true,enumerable:true,writable:true,initializer:null}),ee=se(k.prototype,"massEdit",[M],{configurable:true,enumerable:true,writable:true,initializer:null}),se(k.prototype,"onInit",[V],Object.getOwnPropertyDescriptor(k.prototype,"onInit"),k.prototype),se(k.prototype,"onBeforeRendering",[S],Object.getOwnPropertyDescriptor(k.prototype,"onBeforeRendering"),k.prototype),se(k.prototype,"getExtensionAPI",[F],Object.getOwnPropertyDescriptor(k.prototype,"getExtensionAPI"),k.prototype),se(k.prototype,"onPageReady",[H,N],Object.getOwnPropertyDescriptor(k.prototype,"onPageReady"),k.prototype),k))||D);return ce},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/TemplateComponent-dbg", ["sap/fe/core/CommonUtils", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/UIComponent", "sap/ui/mdc/p13n/StateUtil"], function (CommonUtils, ClassSupport, UIComponent, StateUtil) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _descriptor11, _descriptor12, _descriptor13, _descriptor14;
  var property = ClassSupport.property;
  var implementInterface = ClassSupport.implementInterface;
  var event = ClassSupport.event;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let TemplateComponent = (_dec = defineUI5Class("sap.fe.core.TemplateComponent"), _dec2 = implementInterface("sap.ui.core.IAsyncContentCreation"), _dec3 = property({
    type: "string",
    defaultValue: null
  }), _dec4 = property({
    type: "string",
    defaultValue: null
  }), _dec5 = property({
    type: "string"
  }), _dec6 = property({
    type: "object"
  }), _dec7 = property({
    type: "string[]"
  }), _dec8 = property({
    type: "object"
  }), _dec9 = property({
    type: "object"
  }), _dec10 = property({
    type: "boolean"
  }), _dec11 = property({
    type: "object"
  }), _dec12 = property({
    type: "string"
  }), _dec13 = event(), _dec14 = event(), _dec15 = event(), _dec(_class = (_class2 = /*#__PURE__*/function (_UIComponent) {
    _inheritsLoose(TemplateComponent, _UIComponent);
    function TemplateComponent() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _UIComponent.call(this, ...args) || this;
      _initializerDefineProperty(_this, "__implements__sap_ui_core_IAsyncContentCreation", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "entitySet", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "contextPath", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "bindingContextPattern", _descriptor4, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "navigation", _descriptor5, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "enhanceI18n", _descriptor6, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "controlConfiguration", _descriptor7, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "content", _descriptor8, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "allowDeepLinking", _descriptor9, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "refreshStrategyOnAppRestore", _descriptor10, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "viewType", _descriptor11, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "containerDefined", _descriptor12, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "heroesBatchReceived", _descriptor13, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "workersBatchReceived", _descriptor14, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = TemplateComponent.prototype;
    _proto.setContainer = function setContainer(oContainer) {
      _UIComponent.prototype.setContainer.call(this, oContainer);
      this.fireEvent("containerDefined", {
        container: oContainer
      });
      return this;
    };
    _proto.init = function init() {
      this.oAppComponent = CommonUtils.getAppComponent(this);
      _UIComponent.prototype.init.call(this);
      const oStateChangeHandler = function (oEvent) {
        const oControl = oEvent.getParameter("control");
        if (oControl.isA("sap.ui.mdc.Table") || oControl.isA("sap.ui.mdc.FilterBar") || oControl.isA("sap.ui.mdc.Chart")) {
          const oMacroAPI = oControl.getParent();
          if (oMacroAPI !== null && oMacroAPI !== void 0 && oMacroAPI.fireStateChange) {
            oMacroAPI.fireStateChange();
          }
        }
      };
      StateUtil.detachStateChange(oStateChangeHandler);
      StateUtil.attachStateChange(oStateChangeHandler);
    }

    // This method is called by UI5 core to access to the component containing the customizing configuration.
    // as controller extensions are defined in the manifest for the app component and not for the
    // template component we return the app component.
    ;
    _proto.getExtensionComponent = function getExtensionComponent() {
      return this.oAppComponent;
    };
    _proto.getRootController = function getRootController() {
      const rootControl = this.getRootControl();
      let rootController;
      if (rootControl && rootControl.getController) {
        rootController = rootControl.getController();
      }
      return rootController;
    };
    _proto.onPageReady = function onPageReady(mParameters) {
      const rootController = this.getRootController();
      if (rootController && rootController.onPageReady) {
        rootController.onPageReady(mParameters);
      }
    };
    _proto.getNavigationConfiguration = function getNavigationConfiguration(sTargetPath) {
      const mNavigation = this.navigation;
      return mNavigation[sTargetPath];
    };
    _proto.getViewData = function getViewData() {
      const mProperties = this.getMetadata().getAllProperties();
      const oViewData = Object.keys(mProperties).reduce((mViewData, sPropertyName) => {
        mViewData[sPropertyName] = mProperties[sPropertyName].get(this);
        return mViewData;
      }, {});

      // Access the internal _isFclEnabled which will be there
      oViewData.fclEnabled = this.oAppComponent._isFclEnabled();
      return oViewData;
    };
    _proto._getPageTitleInformation = function _getPageTitleInformation() {
      const rootControl = this.getRootControl();
      if (rootControl && rootControl.getController() && rootControl.getController()._getPageTitleInformation) {
        return rootControl.getController()._getPageTitleInformation();
      } else {
        return {};
      }
    };
    _proto.getExtensionAPI = function getExtensionAPI() {
      return this.getRootControl().getController().getExtensionAPI();
    };
    return TemplateComponent;
  }(UIComponent), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "__implements__sap_ui_core_IAsyncContentCreation", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return true;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "entitySet", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return null;
    }
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "contextPath", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return null;
    }
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "bindingContextPattern", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "navigation", [_dec6], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "enhanceI18n", [_dec7], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "controlConfiguration", [_dec8], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "content", [_dec9], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "allowDeepLinking", [_dec10], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor10 = _applyDecoratedDescriptor(_class2.prototype, "refreshStrategyOnAppRestore", [_dec11], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor11 = _applyDecoratedDescriptor(_class2.prototype, "viewType", [_dec12], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return "XML";
    }
  }), _descriptor12 = _applyDecoratedDescriptor(_class2.prototype, "containerDefined", [_dec13], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor13 = _applyDecoratedDescriptor(_class2.prototype, "heroesBatchReceived", [_dec14], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor14 = _applyDecoratedDescriptor(_class2.prototype, "workersBatchReceived", [_dec15], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return TemplateComponent;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/TemplateComponent", ["sap/fe/core/CommonUtils","sap/fe/core/helpers/ClassSupport","sap/ui/core/UIComponent","sap/ui/mdc/p13n/StateUtil"],function(e,t,n,r){"use strict";var i,o,a,l,u,c,p,s,f,b,g,y,h,d,m,C,v,w,z,_,P,A,R,I,j,O,S,E,x,D,T;var k=t.property;var B=t.implementInterface;var U=t.event;var L=t.defineUI5Class;function V(e,t,n,r){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function F(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function M(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;N(e,t)}function N(e,t){N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return N(e,t)}function X(e,t,n,r,i){var o={};Object.keys(r).forEach(function(e){o[e]=r[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o);if(i&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(i):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function q(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let G=(i=L("sap.fe.core.TemplateComponent"),o=B("sap.ui.core.IAsyncContentCreation"),a=k({type:"string",defaultValue:null}),l=k({type:"string",defaultValue:null}),u=k({type:"string"}),c=k({type:"object"}),p=k({type:"string[]"}),s=k({type:"object"}),f=k({type:"object"}),b=k({type:"boolean"}),g=k({type:"object"}),y=k({type:"string"}),h=U(),d=U(),m=U(),i(C=(v=function(t){M(n,t);function n(){var e;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++){r[i]=arguments[i]}e=t.call(this,...r)||this;V(e,"__implements__sap_ui_core_IAsyncContentCreation",w,F(e));V(e,"entitySet",z,F(e));V(e,"contextPath",_,F(e));V(e,"bindingContextPattern",P,F(e));V(e,"navigation",A,F(e));V(e,"enhanceI18n",R,F(e));V(e,"controlConfiguration",I,F(e));V(e,"content",j,F(e));V(e,"allowDeepLinking",O,F(e));V(e,"refreshStrategyOnAppRestore",S,F(e));V(e,"viewType",E,F(e));V(e,"containerDefined",x,F(e));V(e,"heroesBatchReceived",D,F(e));V(e,"workersBatchReceived",T,F(e));return e}var i=n.prototype;i.setContainer=function e(n){t.prototype.setContainer.call(this,n);this.fireEvent("containerDefined",{container:n});return this};i.init=function n(){this.oAppComponent=e.getAppComponent(this);t.prototype.init.call(this);const i=function(e){const t=e.getParameter("control");if(t.isA("sap.ui.mdc.Table")||t.isA("sap.ui.mdc.FilterBar")||t.isA("sap.ui.mdc.Chart")){const e=t.getParent();if(e!==null&&e!==void 0&&e.fireStateChange){e.fireStateChange()}}};r.detachStateChange(i);r.attachStateChange(i)};i.getExtensionComponent=function e(){return this.oAppComponent};i.getRootController=function e(){const t=this.getRootControl();let n;if(t&&t.getController){n=t.getController()}return n};i.onPageReady=function e(t){const n=this.getRootController();if(n&&n.onPageReady){n.onPageReady(t)}};i.getNavigationConfiguration=function e(t){const n=this.navigation;return n[t]};i.getViewData=function e(){const t=this.getMetadata().getAllProperties();const n=Object.keys(t).reduce((e,n)=>{e[n]=t[n].get(this);return e},{});n.fclEnabled=this.oAppComponent._isFclEnabled();return n};i._getPageTitleInformation=function e(){const t=this.getRootControl();if(t&&t.getController()&&t.getController()._getPageTitleInformation){return t.getController()._getPageTitleInformation()}else{return{}}};i.getExtensionAPI=function e(){return this.getRootControl().getController().getExtensionAPI()};return n}(n),w=X(v.prototype,"__implements__sap_ui_core_IAsyncContentCreation",[o],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),z=X(v.prototype,"entitySet",[a],{configurable:true,enumerable:true,writable:true,initializer:function(){return null}}),_=X(v.prototype,"contextPath",[l],{configurable:true,enumerable:true,writable:true,initializer:function(){return null}}),P=X(v.prototype,"bindingContextPattern",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),A=X(v.prototype,"navigation",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),R=X(v.prototype,"enhanceI18n",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),I=X(v.prototype,"controlConfiguration",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),j=X(v.prototype,"content",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),O=X(v.prototype,"allowDeepLinking",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),S=X(v.prototype,"refreshStrategyOnAppRestore",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),E=X(v.prototype,"viewType",[y],{configurable:true,enumerable:true,writable:true,initializer:function(){return"XML"}}),x=X(v.prototype,"containerDefined",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),D=X(v.prototype,"heroesBatchReceived",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),T=X(v.prototype,"workersBatchReceived",[m],{configurable:true,enumerable:true,writable:true,initializer:null}),v))||C);return G},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/TemplateModel-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/base/Object", "sap/ui/model/json/JSONModel"], function (ClassSupport, BaseObject, JSONModel) {
  "use strict";

  var _dec, _class;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let TemplateModel = (_dec = defineUI5Class("sap.fe.core.TemplateModel"), _dec(_class = /*#__PURE__*/function (_BaseObject) {
    _inheritsLoose(TemplateModel, _BaseObject);
    function TemplateModel(pageConfig, oMetaModel) {
      var _this;
      _this = _BaseObject.call(this) || this;
      _this.oMetaModel = oMetaModel;
      _this.oConfigModel = new JSONModel();
      // don't limit aggregation bindings
      _this.oConfigModel.setSizeLimit(Number.MAX_VALUE);
      _this.bConfigLoaded = false;
      // eslint-disable-next-line @typescript-eslint/no-this-alias
      const that = _assertThisInitialized(_this);
      if (typeof pageConfig === "function") {
        const fnGetObject = _this.oConfigModel._getObject.bind(_this.oConfigModel);
        _this.oConfigModel._getObject = function (sPath, oContext) {
          if (!that.bConfigLoaded) {
            this.setData(pageConfig());
          }
          return fnGetObject(sPath, oContext);
        };
      } else {
        _this.oConfigModel.setData(pageConfig);
      }
      _this.fnCreateMetaBindingContext = _this.oMetaModel.createBindingContext.bind(_this.oMetaModel);
      _this.fnCreateConfigBindingContext = _this.oConfigModel.createBindingContext.bind(_this.oConfigModel);
      _this.fnSetData = _this.oConfigModel.setData.bind(_this.oConfigModel);
      _this.oConfigModel.createBindingContext = _this.createBindingContext.bind(_assertThisInitialized(_this));
      _this.oConfigModel.setData = _this.setData.bind(_assertThisInitialized(_this));
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      return _this.oConfigModel || _assertThisInitialized(_this);
    }

    /**
     * Overwrite the standard setData to keep track whether the external configuration has been loaded or not.
     *
     * @param dataToSet The data to set to the json model containing the configuration
     */
    var _proto = TemplateModel.prototype;
    _proto.setData = function setData(dataToSet) {
      this.fnSetData(dataToSet);
      this.bConfigLoaded = true;
    };
    _proto.createBindingContext = function createBindingContext(sPath, oContext, mParameters, fnCallBack) {
      var _oBindingContext;
      let oBindingContext;
      const bNoResolve = mParameters && mParameters.noResolve;
      oBindingContext = this.fnCreateConfigBindingContext(sPath, oContext, mParameters, fnCallBack);
      const sResolvedPath = !bNoResolve && ((_oBindingContext = oBindingContext) === null || _oBindingContext === void 0 ? void 0 : _oBindingContext.getObject());
      if (sResolvedPath && typeof sResolvedPath === "string") {
        oBindingContext = this.fnCreateMetaBindingContext(sResolvedPath, oContext, mParameters, fnCallBack);
      }
      return oBindingContext;
    };
    _proto.destroy = function destroy() {
      this.oConfigModel.destroy();
      JSONModel.prototype.destroy.apply(this);
    };
    return TemplateModel;
  }(BaseObject)) || _class);
  return TemplateModel;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/TemplateModel", ["sap/fe/core/helpers/ClassSupport","sap/ui/base/Object","sap/ui/model/json/JSONModel"],function(e,t,o){"use strict";var n,i;var r=e.defineUI5Class;function a(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function d(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;f(e,t)}function f(e,t){f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return f(e,t)}let s=(n=r("sap.fe.core.TemplateModel"),n(i=function(e){d(t,e);function t(t,n){var i;i=e.call(this)||this;i.oMetaModel=n;i.oConfigModel=new o;i.oConfigModel.setSizeLimit(Number.MAX_VALUE);i.bConfigLoaded=false;const r=a(i);if(typeof t==="function"){const e=i.oConfigModel._getObject.bind(i.oConfigModel);i.oConfigModel._getObject=function(o,n){if(!r.bConfigLoaded){this.setData(t())}return e(o,n)}}else{i.oConfigModel.setData(t)}i.fnCreateMetaBindingContext=i.oMetaModel.createBindingContext.bind(i.oMetaModel);i.fnCreateConfigBindingContext=i.oConfigModel.createBindingContext.bind(i.oConfigModel);i.fnSetData=i.oConfigModel.setData.bind(i.oConfigModel);i.oConfigModel.createBindingContext=i.createBindingContext.bind(a(i));i.oConfigModel.setData=i.setData.bind(a(i));return i.oConfigModel||a(i)}var n=t.prototype;n.setData=function e(t){this.fnSetData(t);this.bConfigLoaded=true};n.createBindingContext=function e(t,o,n,i){var r;let a;const d=n&&n.noResolve;a=this.fnCreateConfigBindingContext(t,o,n,i);const f=!d&&((r=a)===null||r===void 0?void 0:r.getObject());if(f&&typeof f==="string"){a=this.fnCreateMetaBindingContext(f,o,n,i)}return a};n.destroy=function e(){this.oConfigModel.destroy();o.prototype.destroy.apply(this)};return t}(t))||i);return s},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/AttributeModel-dbg", ["sap/base/Log", "sap/base/util/ObjectPath", "sap/ui/model/json/JSONModel"], function (Log, ObjectPath, JSONModel) {
  "use strict";

  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  /**
   * Special JSONModel that is used to store the attribute model for the building block.
   * It has specific handling for undefinedValue mapping
   */
  let AttributeModel = /*#__PURE__*/function (_JSONModel) {
    _inheritsLoose(AttributeModel, _JSONModel);
    function AttributeModel(oNode, oProps, buildingBlockDefinition) {
      var _this;
      _this = _JSONModel.call(this) || this;
      _this.oNode = oNode;
      _this.oProps = oProps;
      _this.buildingBlockDefinition = buildingBlockDefinition;
      _this.$$valueAsPromise = true;
      return _this;
    }
    var _proto = AttributeModel.prototype;
    _proto._getObject = function _getObject(sPath, oContext) {
      if (sPath === undefined || sPath === "") {
        if (oContext !== undefined && oContext.getPath() !== "/") {
          return this._getObject(oContext.getPath(sPath));
        }
        return this.oProps;
      }
      if (sPath === "/undefinedValue" || sPath === "undefinedValue") {
        return undefined;
      }
      // just return the attribute - we can't validate them, and we don't support aggregations for now
      const oValue = ObjectPath.get(sPath.replace(/\//g, "."), this.oProps);
      if (oValue !== undefined) {
        return oValue;
      }
      // Deal with undefined properties
      if (this.oProps.hasOwnProperty(sPath)) {
        return this.oProps[sPath];
      }
      if (sPath.indexOf(":") === -1 && sPath.indexOf("/") === -1) {
        // Gloves are off, if you have this error you forgot to define your property on your metadata but are still using it in the underlying code
        Log.error(`Missing property ${sPath} on building block metadata ${this.buildingBlockDefinition.name}`);
        //throw new Error(`Missing property ${sPath} on macro metadata ${this.buildingBlockDefinition.name}`);
      }

      return this.oNode.getAttribute(sPath);
    };
    return AttributeModel;
  }(JSONModel);
  return AttributeModel;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/AttributeModel", ["sap/base/Log","sap/base/util/ObjectPath","sap/ui/model/json/JSONModel"],function(t,e,n){"use strict";function i(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;o(t,e)}function o(t,e){o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,n){e.__proto__=n;return e};return o(t,e)}let r=function(n){i(o,n);function o(t,e,i){var o;o=n.call(this)||this;o.oNode=t;o.oProps=e;o.buildingBlockDefinition=i;o.$$valueAsPromise=true;return o}var r=o.prototype;r._getObject=function n(i,o){if(i===undefined||i===""){if(o!==undefined&&o.getPath()!=="/"){return this._getObject(o.getPath(i))}return this.oProps}if(i==="/undefinedValue"||i==="undefinedValue"){return undefined}const r=e.get(i.replace(/\//g,"."),this.oProps);if(r!==undefined){return r}if(this.oProps.hasOwnProperty(i)){return this.oProps[i]}if(i.indexOf(":")===-1&&i.indexOf("/")===-1){t.error(`Missing property ${i} on building block metadata ${this.buildingBlockDefinition.name}`)}return this.oNode.getAttribute(i)};return o}(n);return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlock-dbg", ["sap/base/util/deepClone", "sap/base/util/merge", "sap/base/util/ObjectPath", "sap/fe/core/buildingBlocks/BuildingBlockFragment", "sap/fe/core/buildingBlocks/BuildingBlockRuntime", "sap/fe/core/CommonUtils", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/StableIdHelper", "sap/fe/core/helpers/TypeGuards", "sap/fe/core/jsx-runtime/jsx", "sap/ui/base/ManagedObject", "sap/ui/core/Component", "sap/ui/core/util/XMLPreprocessor", "../converters/ConverterContext"], function (deepClone, merge, ObjectPath, BuildingBlockFragment, BuildingBlockRuntime, CommonUtils, BindingToolkit, StableIdHelper, TypeGuards, jsx, ManagedObject, Component, XMLPreprocessor, ConverterContext) {
  "use strict";

  var _exports = {};
  var isContext = TypeGuards.isContext;
  var generate = StableIdHelper.generate;
  var resolveBindingString = BindingToolkit.resolveBindingString;
  var isUndefinedExpression = BindingToolkit.isUndefinedExpression;
  var xml = BuildingBlockRuntime.xml;
  var registerBuildingBlock = BuildingBlockRuntime.registerBuildingBlock;
  /**
   * Base class for Building Block
   */
  let BuildingBlockBase = /*#__PURE__*/function () {
    function BuildingBlockBase(props, _oControlConfig, _oSettings) {
      this.isPublic = false;
      this.getConverterContext = function (dataModelObjectPath, contextPath, settings, extraParams) {
        var _settings$models$view;
        const appComponent = settings.appComponent;
        const originalViewData = (_settings$models$view = settings.models.viewData) === null || _settings$models$view === void 0 ? void 0 : _settings$models$view.getData();
        let viewData = Object.assign({}, originalViewData);
        delete viewData.resourceBundle;
        viewData = deepClone(viewData);
        viewData.controlConfiguration = merge(viewData.controlConfiguration, extraParams || {});
        return ConverterContext.createConverterContextForMacro(dataModelObjectPath.startingEntitySet.name, settings.models.metaModel, appComponent === null || appComponent === void 0 ? void 0 : appComponent.getDiagnostics(), merge, dataModelObjectPath.contextLocation, viewData);
      };
      Object.keys(props).forEach(propName => {
        this[propName] = props[propName];
      });
    }
    /**
     * Only used internally
     *
     * @private
     */
    _exports.BuildingBlockBase = BuildingBlockBase;
    var _proto = BuildingBlockBase.prototype;
    /**
     * Convert the given local element ID to a globally unique ID by prefixing with the Building Block ID.
     *
     * @param stringParts
     * @returns Either the global ID or undefined if the Building Block doesn't have an ID
     * @private
     */
    _proto.createId = function createId() {
      // If the child instance has an ID property use it otherwise return undefined
      if (this.id) {
        for (var _len = arguments.length, stringParts = new Array(_len), _key = 0; _key < _len; _key++) {
          stringParts[_key] = arguments[_key];
        }
        return generate([this.id, ...stringParts]);
      }
      return undefined;
    };
    /**
     * Only used internally.
     *
     * @returns All the properties defined on the object with their values
     * @private
     */
    _proto.getProperties = function getProperties() {
      const allProperties = {};
      for (const oInstanceKey in this) {
        if (this.hasOwnProperty(oInstanceKey)) {
          allProperties[oInstanceKey] = this[oInstanceKey];
        }
      }
      return allProperties;
    };
    BuildingBlockBase.register = function register() {
      // To be overriden
    };
    BuildingBlockBase.unregister = function unregister() {
      // To be overriden
    }

    /**
     * Add a part of string based on the condition.
     *
     * @param condition
     * @param partToAdd
     * @returns The part to add if the condition is true, otherwise an empty string
     * @private
     */;
    _proto.addConditionally = function addConditionally(condition, partToAdd) {
      if (condition) {
        return partToAdd;
      } else {
        return "";
      }
    }
    /**
     * Add an attribute depending on the current value of the property.
     * If it's undefined the attribute is not added.
     *
     * @param attributeName
     * @param value
     * @returns The attribute to add if the value is not undefined, otherwise an empty string
     * @private
     */;
    _proto.attr = function attr(attributeName, value) {
      if (value !== undefined && !isUndefinedExpression(value)) {
        return () => xml`${attributeName}="${value}"`;
      } else {
        return () => "";
      }
    };
    return BuildingBlockBase;
  }();
  /**
   * Base class for runtime building blocks
   */
  _exports.BuildingBlockBase = BuildingBlockBase;
  const ensureMetadata = function (target) {
    if (!target.hasOwnProperty("metadata")) {
      target.metadata = deepClone(target.metadata || {
        properties: {},
        aggregations: {},
        events: {},
        stereotype: "xmlmacro",
        designtime: ""
      });
    }
    return target.metadata;
  };

  /**
   * Decorator for building blocks.
   *
   * @param attributeDefinition
   * @deprecated use `blockAttribute` instead
   * @returns The decorated property
   */
  function xmlAttribute(attributeDefinition) {
    return function (target, propertyKey, propertyDescriptor) {
      const metadata = ensureMetadata(target.constructor);
      if (attributeDefinition.defaultValue === undefined) {
        var _propertyDescriptor$i;
        // If there is no defaultValue we can take the value from the initializer (natural way of defining defaults)
        attributeDefinition.defaultValue = (_propertyDescriptor$i = propertyDescriptor.initializer) === null || _propertyDescriptor$i === void 0 ? void 0 : _propertyDescriptor$i.call(propertyDescriptor);
      }
      delete propertyDescriptor.initializer;
      if (metadata.properties[propertyKey.toString()] === undefined) {
        metadata.properties[propertyKey.toString()] = attributeDefinition;
      }
      return propertyDescriptor;
    }; // Needed to make TS happy with those decorators;
  }

  /**
   * Indicates that the property shall be declared as an xml attribute that can be used from the outside of the building block.
   *
   * If defining a runtime Building Block, please make sure to use the correct typings: Depending on its metadata,
   * a property can either be a {@link sap.ui.model.Context} (<code>type: 'sap.ui.model.Context'</code>),
   * a constant (<code>bindable: false</code>), or a {@link BindingToolkitExpression} (<code>bindable: true</code>).
   *
   * @param attributeDefinition
   * @returns The decorated property
   */
  _exports.xmlAttribute = xmlAttribute;
  function blockAttribute(attributeDefinition) {
    return xmlAttribute(attributeDefinition);
  }

  /**
   * Decorator for building blocks.
   *
   * @deprecated use `blockEvent` instead
   * @returns The decorated property
   */
  _exports.blockAttribute = blockAttribute;
  function xmlEvent() {
    return function (target, propertyKey, propertyDescriptor) {
      const metadata = ensureMetadata(target.constructor);
      delete propertyDescriptor.initializer;
      if (metadata.events[propertyKey.toString()] === undefined) {
        metadata.events[propertyKey.toString()] = {
          type: "function"
        };
      }
      return propertyDescriptor;
    }; // Needed to make TS happy with those decorators;
  }
  _exports.xmlEvent = xmlEvent;
  function blockEvent() {
    return xmlEvent();
  }

  /**
   * Decorator for building blocks.
   *
   * @param aggregationDefinition
   * @returns The decorated property
   * @deprecated use `blockAggregation` instead
   */
  _exports.blockEvent = blockEvent;
  function xmlAggregation(aggregationDefinition) {
    return function (target, propertyKey, propertyDescriptor) {
      const metadata = ensureMetadata(target.constructor);
      delete propertyDescriptor.initializer;
      if (metadata.aggregations[propertyKey] === undefined) {
        metadata.aggregations[propertyKey] = aggregationDefinition;
      }
      return propertyDescriptor;
    };
  }
  /**
   * Indicates that the property shall be declared as an xml aggregation that can be used from the outside of the building block.
   *
   * @param aggregationDefinition
   * @returns The decorated property
   */
  _exports.xmlAggregation = xmlAggregation;
  function blockAggregation(aggregationDefinition) {
    return xmlAggregation(aggregationDefinition);
  }
  _exports.blockAggregation = blockAggregation;
  const RUNTIME_BLOCKS = {};
  function defineBuildingBlock(oBuildingBlockDefinition) {
    return function (classDefinition) {
      const metadata = ensureMetadata(classDefinition);
      metadata.designtime = oBuildingBlockDefinition.designtime;
      classDefinition.xmlTag = oBuildingBlockDefinition.name;
      classDefinition.namespace = oBuildingBlockDefinition.namespace;
      classDefinition.publicNamespace = oBuildingBlockDefinition.publicNamespace;
      classDefinition.fragment = oBuildingBlockDefinition.fragment;
      classDefinition.isOpen = oBuildingBlockDefinition.isOpen;
      classDefinition.isRuntime = oBuildingBlockDefinition.isRuntime;
      classDefinition.apiVersion = 2;
      if (classDefinition.isRuntime === true) {
        classDefinition.prototype.getTemplate = function (oNode) {
          const className = `${oBuildingBlockDefinition.namespace}.${oBuildingBlockDefinition.name}`;
          const extraProps = [];
          // Function are defined as string but need to be resolved by UI5, as such we store them in an `event` property and will redispatch them later
          const functionHolderDefinition = [];
          const propertiesAssignedToFunction = [];
          const functionStringInOrder = [];
          for (const propertiesKey in metadata.properties) {
            let propertyValue = this[propertiesKey];
            if (propertyValue !== undefined && propertyValue !== null) {
              if (isContext(propertyValue)) {
                propertyValue = propertyValue.getPath();
              }
              if (metadata.properties[propertiesKey].type === "function") {
                functionHolderDefinition.push(propertyValue);
                functionStringInOrder.push(propertyValue);
                propertiesAssignedToFunction.push(propertiesKey);
              } else {
                extraProps.push(xml`feBB:${propertiesKey}="${propertyValue}"`);
              }
            }
          }
          if (functionHolderDefinition.length > 0) {
            extraProps.push(xml`functionHolder="${functionHolderDefinition.join(";")}"`);
            extraProps.push(xml`feBB:functionStringInOrder="${functionStringInOrder.join(",")}"`);
            extraProps.push(xml`feBB:propertiesAssignedToFunction="${propertiesAssignedToFunction.join(",")}"`);
          }
          for (const eventsKey in metadata.events) {
            const eventsValue = this[eventsKey];
            if (eventsValue !== undefined) {
              extraProps.push(xml`feBB:${eventsKey}="${eventsValue}"`);
            }
          }
          // core:require need to be defined on the node itself to be picked up due to the templating step
          const coreRequire = oNode.getAttribute("core:require") || undefined;
          if (coreRequire) {
            extraProps.push(xml`core:require="${coreRequire}"`);
          }
          return xml`<feBB:BuildingBlockFragment
					xmlns:core="sap.ui.core"
					xmlns:feBB="sap.fe.core.buildingBlocks"
					fragmentName="${className}"

					id="{this>id}"
					type="FE_COMPONENTS"
					${extraProps}
				>
				</feBB:BuildingBlockFragment>`;
        };
      }
      classDefinition.register = function () {
        registerBuildingBlock(classDefinition);
        if (classDefinition.isRuntime === true) {
          RUNTIME_BLOCKS[`${oBuildingBlockDefinition.namespace}.${oBuildingBlockDefinition.name}`] = classDefinition;
        }
      };
      classDefinition.unregister = function () {
        XMLPreprocessor.plugIn(null, classDefinition.namespace, classDefinition.name);
        XMLPreprocessor.plugIn(null, classDefinition.publicNamespace, classDefinition.name);
      };
    };
  }
  _exports.defineBuildingBlock = defineBuildingBlock;
  BuildingBlockFragment.registerType("FE_COMPONENTS", {
    load: async function (mSettings) {
      return Promise.resolve(RUNTIME_BLOCKS[mSettings.fragmentName]);
    },
    init: function (mSettings) {
      var _mSettings$customData, _mSettings$customData2, _mSettings$customData3, _mSettings$customData4, _mSettings$containing, _mSettings$containing2, _feCustomData$functio, _feCustomData$propert;
      let MyClass = mSettings.fragmentContent;
      if (!MyClass) {
        // In some case we might have been called here synchronously (unstash case for instance), which means we didn't go through the load function
        MyClass = RUNTIME_BLOCKS[mSettings.fragmentName];
      }
      const classSettings = {};
      const feCustomData = (mSettings === null || mSettings === void 0 ? void 0 : (_mSettings$customData = mSettings.customData) === null || _mSettings$customData === void 0 ? void 0 : (_mSettings$customData2 = _mSettings$customData[0]) === null || _mSettings$customData2 === void 0 ? void 0 : (_mSettings$customData3 = _mSettings$customData2.mProperties) === null || _mSettings$customData3 === void 0 ? void 0 : (_mSettings$customData4 = _mSettings$customData3.value) === null || _mSettings$customData4 === void 0 ? void 0 : _mSettings$customData4["sap.fe.core.buildingBlocks"]) || {};
      delete mSettings.customData;
      const functionHolder = mSettings.functionHolder ?? [];
      delete mSettings.functionHolder;

      // containingView can also be a fragment, so we have to use the controller to be sure to get the actual view
      const containingView = ((_mSettings$containing = (_mSettings$containing2 = mSettings.containingView).getController) === null || _mSettings$containing === void 0 ? void 0 : _mSettings$containing.call(_mSettings$containing2).getView()) ?? mSettings.containingView;
      const pageComponent = Component.getOwnerComponentFor(containingView);
      const appComponent = CommonUtils.getAppComponent(containingView);
      const metaModel = appComponent.getMetaModel();
      const pageModel = pageComponent.getModel("_pageModel");
      const functionStringInOrder = (_feCustomData$functio = feCustomData.functionStringInOrder) === null || _feCustomData$functio === void 0 ? void 0 : _feCustomData$functio.split(",");
      const propertiesAssignedToFunction = (_feCustomData$propert = feCustomData.propertiesAssignedToFunction) === null || _feCustomData$propert === void 0 ? void 0 : _feCustomData$propert.split(",");
      for (const propertyName in MyClass.metadata.properties) {
        const propertyMetadata = MyClass.metadata.properties[propertyName];
        const pageModelContext = pageModel.createBindingContext(feCustomData[propertyName]);
        if (pageModelContext === null) {
          // value cannot be resolved, so it is either a runtime binding or a constant
          let value = feCustomData[propertyName];
          if (typeof value === "string") {
            if (propertyMetadata.bindable !== true) {
              // runtime bindings are not allowed, so convert strings into actual primitive types
              switch (propertyMetadata.type) {
                case "boolean":
                  value = value === "true";
                  break;
                case "number":
                  value = Number(value);
                  break;
              }
            } else {
              // runtime bindings are allowed, so resolve the values as BindingToolkit expressions
              value = resolveBindingString(value, propertyMetadata.type);
            }
          } else if (propertyMetadata.type === "function") {
            const functionIndex = propertiesAssignedToFunction.indexOf(propertyName);
            const functionString = functionStringInOrder[functionIndex];
            const targetFunction = functionHolder === null || functionHolder === void 0 ? void 0 : functionHolder.find(functionDef => {
              var _functionDef$;
              return ((_functionDef$ = functionDef[0]) === null || _functionDef$ === void 0 ? void 0 : _functionDef$._sapui_handlerName) === functionString;
            });
            // We use the _sapui_handlerName to identify which function is the one we want to bind here
            if (targetFunction && targetFunction.length > 1) {
              value = targetFunction[0].bind(targetFunction[1]);
            }
          }
          classSettings[propertyName] = value;
        } else if (pageModelContext.getObject() !== undefined) {
          // get value from page model
          classSettings[propertyName] = pageModelContext.getObject();
        } else {
          // bind to metamodel
          classSettings[propertyName] = metaModel.createBindingContext(feCustomData[propertyName]);
        }
      }
      for (const eventName in MyClass.metadata.events) {
        if (feCustomData[eventName] !== undefined && feCustomData[eventName].startsWith(".")) {
          classSettings[eventName] = ObjectPath.get(feCustomData[eventName].substring(1), containingView.getController());
        } else {
          classSettings[eventName] = ""; // For now, might need to resolve more stuff
        }
      }

      return ManagedObject.runWithPreprocessors(() => {
        const renderedControl = jsx.withContext({
          view: containingView,
          appComponent: appComponent
        }, () => {
          return new MyClass(classSettings, {}, {
            isRuntimeInstantiation: true,
            isPublic: false,
            appComponent: appComponent
          }).getContent(containingView, appComponent);
        });
        if (!this._bAsync) {
          this._aContent = renderedControl;
        }
        return renderedControl;
      }, {
        id: function (sId) {
          return containingView.createId(sId);
        },
        settings: function (controlSettings) {
          const allAssociations = this.getMetadata().getAssociations();
          for (const associationDetailName of Object.keys(allAssociations)) {
            if (controlSettings[associationDetailName] !== undefined) {
              // The associated elements are indicated via local IDs; we need to change the references to global ones
              const associations = Array.isArray(controlSettings[associationDetailName]) ? controlSettings[associationDetailName] : [controlSettings[associationDetailName]];

              // Create global IDs for associations given as strings, not for already resolved ManagedObjects
              controlSettings[associationDetailName] = associations.map(association => typeof association === "string" ? mSettings.containingView.createId(association) : association);
            }
          }
          return controlSettings;
        }
      });
    }
  });
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlock", ["sap/base/util/deepClone","sap/base/util/merge","sap/base/util/ObjectPath","sap/fe/core/buildingBlocks/BuildingBlockFragment","sap/fe/core/buildingBlocks/BuildingBlockRuntime","sap/fe/core/CommonUtils","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/jsx-runtime/jsx","sap/ui/base/ManagedObject","sap/ui/core/Component","sap/ui/core/util/XMLPreprocessor","../converters/ConverterContext"],function(e,n,t,i,o,r,s,a,u,c,l,d,f,p){"use strict";var g={};var m=u.isContext;var v=a.generate;var B=s.resolveBindingString;var h=s.isUndefinedExpression;var b=o.xml;var C=o.registerBuildingBlock;let y=function(){function t(t,i,o){this.isPublic=false;this.getConverterContext=function(t,i,o,r){var s;const a=o.appComponent;const u=(s=o.models.viewData)===null||s===void 0?void 0:s.getData();let c=Object.assign({},u);delete c.resourceBundle;c=e(c);c.controlConfiguration=n(c.controlConfiguration,r||{});return p.createConverterContextForMacro(t.startingEntitySet.name,o.models.metaModel,a===null||a===void 0?void 0:a.getDiagnostics(),n,t.contextLocation,c)};Object.keys(t).forEach(e=>{this[e]=t[e]})}g.BuildingBlockBase=t;var i=t.prototype;i.createId=function e(){if(this.id){for(var n=arguments.length,t=new Array(n),i=0;i<n;i++){t[i]=arguments[i]}return v([this.id,...t])}return undefined};i.getProperties=function e(){const n={};for(const e in this){if(this.hasOwnProperty(e)){n[e]=this[e]}}return n};t.register=function e(){};t.unregister=function e(){};i.addConditionally=function e(n,t){if(n){return t}else{return""}};i.attr=function e(n,t){if(t!==undefined&&!h(t)){return()=>b`${n}="${t}"`}else{return()=>""}};return t}();g.BuildingBlockBase=y;const k=function(n){if(!n.hasOwnProperty("metadata")){n.metadata=e(n.metadata||{properties:{},aggregations:{},events:{},stereotype:"xmlmacro",designtime:""})}return n.metadata};function x(e){return function(n,t,i){const o=k(n.constructor);if(e.defaultValue===undefined){var r;e.defaultValue=(r=i.initializer)===null||r===void 0?void 0:r.call(i)}delete i.initializer;if(o.properties[t.toString()]===undefined){o.properties[t.toString()]=e}return i}}g.xmlAttribute=x;function O(e){return x(e)}g.blockAttribute=O;function $(){return function(e,n,t){const i=k(e.constructor);delete t.initializer;if(i.events[n.toString()]===undefined){i.events[n.toString()]={type:"function"}}return t}}g.xmlEvent=$;function w(){return $()}g.blockEvent=w;function A(e){return function(n,t,i){const o=k(n.constructor);delete i.initializer;if(o.aggregations[t]===undefined){o.aggregations[t]=e}return i}}g.xmlAggregation=A;function P(e){return A(e)}g.blockAggregation=P;const j={};function N(e){return function(n){const t=k(n);t.designtime=e.designtime;n.xmlTag=e.name;n.namespace=e.namespace;n.publicNamespace=e.publicNamespace;n.fragment=e.fragment;n.isOpen=e.isOpen;n.isRuntime=e.isRuntime;n.apiVersion=2;if(n.isRuntime===true){n.prototype.getTemplate=function(n){const i=`${e.namespace}.${e.name}`;const o=[];const r=[];const s=[];const a=[];for(const e in t.properties){let n=this[e];if(n!==undefined&&n!==null){if(m(n)){n=n.getPath()}if(t.properties[e].type==="function"){r.push(n);a.push(n);s.push(e)}else{o.push(b`feBB:${e}="${n}"`)}}}if(r.length>0){o.push(b`functionHolder="${r.join(";")}"`);o.push(b`feBB:functionStringInOrder="${a.join(",")}"`);o.push(b`feBB:propertiesAssignedToFunction="${s.join(",")}"`)}for(const e in t.events){const n=this[e];if(n!==undefined){o.push(b`feBB:${e}="${n}"`)}}const u=n.getAttribute("core:require")||undefined;if(u){o.push(b`core:require="${u}"`)}return b`<feBB:BuildingBlockFragment
					xmlns:core="sap.ui.core"
					xmlns:feBB="sap.fe.core.buildingBlocks"
					fragmentName="${i}"

					id="{this>id}"
					type="FE_COMPONENTS"
					${o}
				>
				</feBB:BuildingBlockFragment>`}}n.register=function(){C(n);if(n.isRuntime===true){j[`${e.namespace}.${e.name}`]=n}};n.unregister=function(){f.plugIn(null,n.namespace,n.name);f.plugIn(null,n.publicNamespace,n.name)}}}g.defineBuildingBlock=N;i.registerType("FE_COMPONENTS",{load:async function(e){return Promise.resolve(j[e.fragmentName])},init:function(e){var n,i,o,s,a,u,f,p;let g=e.fragmentContent;if(!g){g=j[e.fragmentName]}const m={};const v=(e===null||e===void 0?void 0:(n=e.customData)===null||n===void 0?void 0:(i=n[0])===null||i===void 0?void 0:(o=i.mProperties)===null||o===void 0?void 0:(s=o.value)===null||s===void 0?void 0:s["sap.fe.core.buildingBlocks"])||{};delete e.customData;const h=e.functionHolder??[];delete e.functionHolder;const b=((a=(u=e.containingView).getController)===null||a===void 0?void 0:a.call(u).getView())??e.containingView;const C=d.getOwnerComponentFor(b);const y=r.getAppComponent(b);const k=y.getMetaModel();const x=C.getModel("_pageModel");const O=(f=v.functionStringInOrder)===null||f===void 0?void 0:f.split(",");const $=(p=v.propertiesAssignedToFunction)===null||p===void 0?void 0:p.split(",");for(const e in g.metadata.properties){const n=g.metadata.properties[e];const t=x.createBindingContext(v[e]);if(t===null){let t=v[e];if(typeof t==="string"){if(n.bindable!==true){switch(n.type){case"boolean":t=t==="true";break;case"number":t=Number(t);break}}else{t=B(t,n.type)}}else if(n.type==="function"){const n=$.indexOf(e);const i=O[n];const o=h===null||h===void 0?void 0:h.find(e=>{var n;return((n=e[0])===null||n===void 0?void 0:n._sapui_handlerName)===i});if(o&&o.length>1){t=o[0].bind(o[1])}}m[e]=t}else if(t.getObject()!==undefined){m[e]=t.getObject()}else{m[e]=k.createBindingContext(v[e])}}for(const e in g.metadata.events){if(v[e]!==undefined&&v[e].startsWith(".")){m[e]=t.get(v[e].substring(1),b.getController())}else{m[e]=""}}return l.runWithPreprocessors(()=>{const e=c.withContext({view:b,appComponent:y},()=>new g(m,{},{isRuntimeInstantiation:true,isPublic:false,appComponent:y}).getContent(b,y));if(!this._bAsync){this._aContent=e}return e},{id:function(e){return b.createId(e)},settings:function(n){const t=this.getMetadata().getAssociations();for(const i of Object.keys(t)){if(n[i]!==undefined){const t=Array.isArray(n[i])?n[i]:[n[i]];n[i]=t.map(n=>typeof n==="string"?e.containingView.createId(n):n)}}return n}})}});return g},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlockFormatter-dbg", [], function () {
  "use strict";

  return {
    base64Decode: base64 => {
      return atob(base64);
    }
  };
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlockFormatter", [],function(){"use strict";return{base64Decode:e=>atob(e)}},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlockFragment-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/core/Fragment"], function (ClassSupport, Fragment) {
  "use strict";

  var _dec, _dec2, _class, _class2, _descriptor;
  var _exports = {};
  var event = ClassSupport.event;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let BuildingBlockFragment = (
  /**
   * Internal extension to the Fragment class in order to add some place to hold functions for runtime building blocks
   */
  _dec = defineUI5Class("sap.fe.core.buildingBlocks.BuildingBlockFragment"), _dec2 = event(), _dec(_class = (_class2 = /*#__PURE__*/function (_Fragment) {
    _inheritsLoose(BuildingBlockFragment, _Fragment);
    function BuildingBlockFragment() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _Fragment.call(this, ...args) || this;
      _initializerDefineProperty(_this, "functionHolder", _descriptor, _assertThisInitialized(_this));
      return _this;
    }
    _exports = BuildingBlockFragment;
    return BuildingBlockFragment;
  }(Fragment), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "functionHolder", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  _exports = BuildingBlockFragment;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlockFragment", ["sap/fe/core/helpers/ClassSupport","sap/ui/core/Fragment"],function(e,r){"use strict";var i,t,n,a,o;var l={};var u=e.event;var c=e.defineUI5Class;function f(e,r,i,t){if(!i)return;Object.defineProperty(e,r,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(t):void 0})}function s(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function p(e,r){e.prototype=Object.create(r.prototype);e.prototype.constructor=e;b(e,r)}function b(e,r){b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(r,i){r.__proto__=i;return r};return b(e,r)}function d(e,r,i,t,n){var a={};Object.keys(t).forEach(function(e){a[e]=t[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=i.slice().reverse().reduce(function(i,t){return t(e,r,i)||i},a);if(n&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(n):void 0;a.initializer=undefined}if(a.initializer===void 0){Object.defineProperty(e,r,a);a=null}return a}function v(e,r){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let h=(i=c("sap.fe.core.buildingBlocks.BuildingBlockFragment"),t=u(),i(n=(a=function(e){p(r,e);function r(){var r;for(var i=arguments.length,t=new Array(i),n=0;n<i;n++){t[n]=arguments[n]}r=e.call(this,...t)||this;f(r,"functionHolder",o,s(r));return r}l=r;return r}(r),o=d(a.prototype,"functionHolder",[t],{configurable:true,enumerable:true,writable:true,initializer:null}),a))||n);l=h;return l},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlockRuntime-dbg", ["sap/base/Log", "sap/base/util/deepClone", "sap/base/util/uid", "sap/fe/core/buildingBlocks/AttributeModel", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/TypeGuards", "sap/fe/macros/ResourceModel", "sap/ui/base/BindingParser", "sap/ui/core/util/XMLPreprocessor", "./TraceInfo"], function (Log, deepClone, uid, AttributeModel, ConfigurableObject, BindingToolkit, TypeGuards, ResourceModel, BindingParser, XMLPreprocessor, TraceInfo) {
  "use strict";

  var _exports = {};
  var isFunctionArray = TypeGuards.isFunctionArray;
  var isContext = TypeGuards.isContext;
  var isBindingToolkitExpression = BindingToolkit.isBindingToolkitExpression;
  var compileExpression = BindingToolkit.compileExpression;
  var Placement = ConfigurableObject.Placement;
  const LOGGER_SCOPE = "sap.fe.core.buildingBlocks.BuildingBlockRuntime";
  const XMLTEMPLATING_NS = "http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1";
  const DOMParserInstance = new DOMParser();
  let isTraceMode = false;
  /**
   * Typeguard for checking if a building block uses API 1.
   *
   * @param buildingBlockDefinition
   * @returns `true` if the building block is using API 1.
   */
  function isV1MacroDef(buildingBlockDefinition) {
    return buildingBlockDefinition.apiVersion === undefined || buildingBlockDefinition.apiVersion === 1;
  }
  function validateMacroMetadataContext(sName, mContexts, oContextSettings, sKey) {
    const oContext = mContexts[sKey];
    const oContextObject = oContext === null || oContext === void 0 ? void 0 : oContext.getObject();
    if (oContextSettings.required === true && (!oContext || oContextObject === null)) {
      throw new Error(`${sName}: Required metadataContext '${sKey}' is missing`);
    } else if (oContextObject) {
      // If context object has $kind property, $Type should not be checked
      // Therefore remove from context settings
      if (oContextObject.hasOwnProperty("$kind") && oContextObject.$kind !== undefined && oContextSettings.$kind !== undefined) {
        // Check if the $kind is part of the allowed ones
        if (oContextSettings.$kind.indexOf(oContextObject.$kind) === -1) {
          throw new Error(`${sName}: '${sKey}' must be '$kind' '${oContextSettings["$kind"]}' but is '${oContextObject.$kind}': ${oContext.getPath()}`);
        }
      } else if (oContextObject.hasOwnProperty("$Type") && oContextObject.$Type !== undefined && oContextSettings.$Type) {
        // Check only $Type
        if (oContextSettings.$Type.indexOf(oContextObject.$Type) === -1) {
          throw new Error(`${sName}: '${sKey}' must be '$Type' '${oContextSettings["$Type"]}' but is '${oContextObject.$Type}': ${oContext.getPath()}`);
        }
      }
    }
  }
  function validateMacroSignature(sName, oMetadata, mContexts, oNode) {
    const aMetadataContextKeys = oMetadata.metadataContexts && Object.keys(oMetadata.metadataContexts) || [],
      aProperties = oMetadata.properties && Object.keys(oMetadata.properties) || [],
      oAttributeNames = {};

    // collect all attributes to find unchecked properties
    const attributeNames = oNode.getAttributeNames();
    for (const attributeName of attributeNames) {
      oAttributeNames[attributeName] = true;
    }

    //Check metadataContexts
    aMetadataContextKeys.forEach(function (sKey) {
      const oContextSettings = oMetadata.metadataContexts[sKey];
      validateMacroMetadataContext(sName, mContexts, oContextSettings, sKey);
      delete oAttributeNames[sKey];
    });
    //Check properties
    aProperties.forEach(function (sKey) {
      const oPropertySettings = oMetadata.properties[sKey];
      if (!oNode.hasAttribute(sKey)) {
        if (oPropertySettings.required && !oPropertySettings.hasOwnProperty("defaultValue")) {
          throw new Error(`${sName}: ` + `Required property '${sKey}' is missing`);
        }
      } else {
        delete oAttributeNames[sKey];
      }
    });

    // Unchecked properties
    Object.keys(oAttributeNames).forEach(function (sKey) {
      // no check for properties which contain a colon ":" (different namespace), e.g. xmlns:trace, trace:macroID, unittest:id
      if (sKey.indexOf(":") < 0 && !sKey.startsWith("xmlns")) {
        Log.warning(`Unchecked parameter: ${sName}: ${sKey}`, undefined, LOGGER_SCOPE);
      }
    });
  }
  _exports.validateMacroSignature = validateMacroSignature;
  const SAP_UI_CORE_ELEMENT = "sap.ui.core.Element";
  const SAP_UI_MODEL_CONTEXT = "sap.ui.model.Context";

  /**
   * Ensures that the metadata for the building block are properly defined.
   *
   * @param buildingBlockMetadata The metadata received from the input
   * @param isOpen Whether the building block is open or not
   * @param apiVersion
   * @returns A set of completed metadata for further processing
   */
  _exports.SAP_UI_MODEL_CONTEXT = SAP_UI_MODEL_CONTEXT;
  function prepareMetadata(buildingBlockMetadata) {
    let isOpen = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let apiVersion = arguments.length > 2 ? arguments[2] : undefined;
    if (buildingBlockMetadata) {
      const oProperties = {};
      const oAggregations = {
        dependents: {
          type: SAP_UI_CORE_ELEMENT
        },
        customData: {
          type: SAP_UI_CORE_ELEMENT
        }
      };
      if (apiVersion === 2) {
        oAggregations.dependents.slot = "dependents";
        oAggregations.customData.slot = "customData";
      }
      const oMetadataContexts = {};
      let foundDefaultAggregation;
      Object.keys(buildingBlockMetadata.properties).forEach(function (sPropertyName) {
        if (buildingBlockMetadata.properties[sPropertyName].type !== SAP_UI_MODEL_CONTEXT) {
          oProperties[sPropertyName] = buildingBlockMetadata.properties[sPropertyName];
        } else {
          oMetadataContexts[sPropertyName] = buildingBlockMetadata.properties[sPropertyName];
        }
      });
      // Merge events into properties as they are handled identically
      if (buildingBlockMetadata.events !== undefined) {
        Object.keys(buildingBlockMetadata.events).forEach(function (sEventName) {
          oProperties[sEventName] = {
            type: "function",
            ...buildingBlockMetadata.events[sEventName]
          };
        });
      }
      if (buildingBlockMetadata.aggregations !== undefined) {
        Object.keys(buildingBlockMetadata.aggregations).forEach(function (sPropertyName) {
          oAggregations[sPropertyName] = buildingBlockMetadata.aggregations[sPropertyName];
          if (oAggregations[sPropertyName].isDefault) {
            foundDefaultAggregation = sPropertyName;
          }
        });
      }
      return {
        properties: oProperties,
        aggregations: oAggregations,
        defaultAggregation: foundDefaultAggregation,
        metadataContexts: oMetadataContexts,
        isOpen: isOpen
      };
    } else {
      return {
        metadataContexts: {},
        aggregations: {
          dependents: {
            type: SAP_UI_CORE_ELEMENT
          },
          customData: {
            type: SAP_UI_CORE_ELEMENT
          }
        },
        properties: {},
        isOpen: isOpen
      };
    }
  }

  /**
   * Checks the absolute or context paths and returns an appropriate MetaContext.
   *
   * @param oSettings Additional settings
   * @param sAttributeValue The attribute value
   * @returns The meta data context object
   */
  function _checkAbsoluteAndContextPaths(oSettings, sAttributeValue) {
    let sMetaPath;
    if (sAttributeValue && sAttributeValue.startsWith("/")) {
      // absolute path - we just use this one
      sMetaPath = sAttributeValue;
    } else {
      let sContextPath = oSettings.currentContextPath.getPath();
      if (!sContextPath.endsWith("/")) {
        sContextPath += "/";
      }
      sMetaPath = sContextPath + sAttributeValue;
    }
    return {
      model: "metaModel",
      path: sMetaPath
    };
  }

  /**
   * This method helps to create the metadata context in case it is not yet available in the store.
   *
   * @param oSettings Additional settings
   * @param sAttributeName The attribute name
   * @param sAttributeValue The attribute value
   * @returns The meta data context object
   */
  function _createInitialMetadataContext(oSettings, sAttributeName, sAttributeValue) {
    let returnContext;
    if (sAttributeValue.startsWith("/uid--")) {
      const oData = myStore[sAttributeValue];
      oSettings.models.converterContext.setProperty(sAttributeValue, oData);
      returnContext = {
        model: "converterContext",
        path: sAttributeValue
      };
      delete myStore[sAttributeValue];
    } else if (sAttributeName === "metaPath" && oSettings.currentContextPath || sAttributeName === "contextPath") {
      returnContext = _checkAbsoluteAndContextPaths(oSettings, sAttributeValue);
    } else if (sAttributeValue && sAttributeValue.startsWith("/")) {
      // absolute path - we just use this one
      returnContext = {
        model: "metaModel",
        path: sAttributeValue
      };
    } else {
      returnContext = {
        model: "metaModel",
        path: oSettings.bindingContexts.entitySet ? oSettings.bindingContexts.entitySet.getPath(sAttributeValue) : sAttributeValue
      };
    }
    return returnContext;
  }
  function _getMetadataContext(oSettings, oNode, sAttributeName, oVisitor, bDoNotResolve, isOpen) {
    let oMetadataContext;
    if (!bDoNotResolve && oNode.hasAttribute(sAttributeName)) {
      const sAttributeValue = oNode.getAttribute(sAttributeName);
      oMetadataContext = BindingParser.complexParser(sAttributeValue);
      if (!oMetadataContext) {
        oMetadataContext = _createInitialMetadataContext(oSettings, sAttributeName, sAttributeValue);
      }
    } else if (oSettings.bindingContexts.hasOwnProperty(sAttributeName)) {
      oMetadataContext = {
        model: sAttributeName,
        path: ""
      };
    } else if (isOpen) {
      try {
        if (oVisitor.getContext(`${sAttributeName}>`)) {
          oMetadataContext = {
            model: sAttributeName,
            path: ""
          };
        }
      } catch (e) {
        return undefined;
      }
    }
    return oMetadataContext;
  }

  /**
   * Parse the incoming XML node and try to resolve the properties defined there.
   *
   * @param oMetadata The metadata for the building block
   * @param oNode The XML node to parse
   * @param isPublic Whether the building block is used in a public context or not
   * @param oVisitor The visitor instance
   * @param apiVersion The API version of the building block
   */
  async function processProperties(oMetadata, oNode, isPublic, oVisitor, apiVersion) {
    const oDefinitionProperties = oMetadata.properties;

    // Retrieve properties values
    const aDefinitionPropertiesKeys = Object.keys(oDefinitionProperties);
    const propertyValues = {};
    for (const sKeyValue of aDefinitionPropertiesKeys) {
      if (oDefinitionProperties[sKeyValue].type === "object") {
        propertyValues[sKeyValue] = deepClone(oDefinitionProperties[sKeyValue].defaultValue || {}); // To avoid values being reused across macros
      } else {
        propertyValues[sKeyValue] = oDefinitionProperties[sKeyValue].defaultValue;
      }
      if (oNode.hasAttribute(sKeyValue) && isPublic && oDefinitionProperties[sKeyValue].isPublic === false) {
        Log.error(`Property ${sKeyValue} was ignored as it is not intended for public usage`);
      } else if (oNode.hasAttribute(sKeyValue)) {
        await oVisitor.visitAttribute(oNode, oNode.attributes.getNamedItem(sKeyValue));
        let value = oNode.getAttribute(sKeyValue);
        if (value !== undefined && value !== null) {
          if (apiVersion === 2 && typeof value === "string" && !value.startsWith("{")) {
            switch (oDefinitionProperties[sKeyValue].type) {
              case "boolean":
                value = value === "true";
                break;
              case "number":
                value = Number(value);
                break;
            }
          }
          value = value === null ? undefined : value;
          propertyValues[sKeyValue] = value;
        }
      }
    }
    return propertyValues;
  }

  /**
   * Parse the incoming XML node and try to resolve the binding contexts defined inside.
   *
   * @param oMetadata The metadata for the building block
   * @param oSettings The settings object
   * @param oNode The XML node to parse
   * @param isPublic Whether the building block is used in a public context or not
   * @param oVisitor The visitor instance
   * @param mContexts The contexts to be used
   * @param oMetadataContexts	The metadata contexts to be used
   * @returns The processed and missing contexts
   */
  function processContexts(oMetadata, oSettings, oNode, isPublic, oVisitor, mContexts, oMetadataContexts) {
    oSettings.currentContextPath = oSettings.bindingContexts.contextPath;
    const mMissingContext = {};
    const propertyValues = {};
    const oDefinitionContexts = oMetadata.metadataContexts;
    const aDefinitionContextsKeys = Object.keys(oDefinitionContexts);
    // Since the metaPath and other property can be relative to the contextPath we need to evaluate the current contextPath first
    const contextPathIndex = aDefinitionContextsKeys.indexOf("contextPath");
    if (contextPathIndex !== -1) {
      // If it is defined we extract it and reinsert it in the first position of the array
      const contextPathDefinition = aDefinitionContextsKeys.splice(contextPathIndex, 1);
      aDefinitionContextsKeys.splice(0, 0, contextPathDefinition[0]);
    }
    for (const sAttributeName of aDefinitionContextsKeys) {
      const bDoNotResolve = isPublic && oDefinitionContexts[sAttributeName].isPublic === false && oNode.hasAttribute(sAttributeName);
      const oMetadataContext = _getMetadataContext(oSettings, oNode, sAttributeName, oVisitor, bDoNotResolve, oMetadata.isOpen);
      if (oMetadataContext) {
        oMetadataContext.name = sAttributeName;
        addSingleContext(mContexts, oVisitor, oMetadataContext, oMetadataContexts);
        if ((sAttributeName === "entitySet" || sAttributeName === "contextPath") && !oSettings.bindingContexts.hasOwnProperty(sAttributeName)) {
          oSettings.bindingContexts[sAttributeName] = mContexts[sAttributeName];
        }
        if (sAttributeName === "contextPath") {
          oSettings.currentContextPath = mContexts[sAttributeName];
        }
        propertyValues[sAttributeName] = mContexts[sAttributeName];
      } else {
        mMissingContext[sAttributeName] = true;
      }
    }
    return {
      mMissingContext,
      propertyValues: propertyValues
    };
  }
  function parseAggregation(oAggregation, processAggregations) {
    const oOutObjects = {};
    if (oAggregation && oAggregation.children.length > 0) {
      const children = oAggregation.children;
      for (let childIdx = 0; childIdx < children.length; childIdx++) {
        const childDefinition = children[childIdx];
        let childKey = childDefinition.getAttribute("key") || childDefinition.getAttribute("id");
        if (childKey) {
          childKey = `InlineXML_${childKey}`;
          childDefinition.setAttribute("key", childKey);
          let aggregationObject = {
            key: childKey,
            position: {
              placement: childDefinition.getAttribute("placement") || Placement.After,
              anchor: childDefinition.getAttribute("anchor") || undefined
            },
            type: "Slot"
          };
          if (processAggregations) {
            aggregationObject = processAggregations(childDefinition, aggregationObject);
          }
          oOutObjects[aggregationObject.key] = aggregationObject;
        }
      }
    }
    return oOutObjects;
  }

  /**
   * Processes the child nodes of the building block and parses them as either aggregations or object-/array-based values.
   *
   * @param oNode The XML node for which to process the children
   * @param oVisitor The visitor instance
   * @param oMetadata The metadata for the building block
   * @param isPublic Whether the building block is used in a public context or not
   * @param propertyValues The values of already parsed property
   * @param apiVersion The API version of the building block
   */
  async function processChildren(oNode, oVisitor, oMetadata, isPublic, propertyValues, apiVersion) {
    const oAggregations = {};
    if (oNode.firstElementChild !== null) {
      let oFirstElementChild = oNode.firstElementChild;
      if (apiVersion === 2) {
        while (oFirstElementChild !== null) {
          if (oFirstElementChild.namespaceURI === XMLTEMPLATING_NS) {
            // In case we encounter a templating tag, run the visitor on it and continue with the resulting child
            const oParent = oFirstElementChild.parentNode;
            let iChildIndex;
            if (oParent) {
              iChildIndex = Array.from(oParent.children).indexOf(oFirstElementChild);
              await oVisitor.visitNode(oFirstElementChild);
              oFirstElementChild = oParent.children[iChildIndex] ? oParent.children[iChildIndex] : null;
            } else {
              // Not sure how this could happen but i also don't want to create infinite loops
              oFirstElementChild = oFirstElementChild.nextElementSibling;
            }
          } else {
            const sChildName = oFirstElementChild.localName;
            let sAggregationName = sChildName;
            if (sAggregationName[0].toUpperCase() === sAggregationName[0]) {
              // not a sub aggregation, go back to default Aggregation
              sAggregationName = oMetadata.defaultAggregation || "";
            }
            const aggregationDefinition = oMetadata.aggregations[sAggregationName];
            if (aggregationDefinition !== undefined && !aggregationDefinition.slot) {
              const parsedAggregation = parseAggregation(oFirstElementChild, aggregationDefinition.processAggregations);
              propertyValues[sAggregationName] = parsedAggregation;
              for (const parsedAggregationKey in parsedAggregation) {
                oMetadata.aggregations[parsedAggregationKey] = parsedAggregation[parsedAggregationKey];
              }
            }
            oFirstElementChild = oFirstElementChild.nextElementSibling;
          }
        }
      }
      if (apiVersion !== 2) {
        // If there are aggregation we need to visit the childNodes to resolve templating instructions
        await oVisitor.visitChildNodes(oNode);
      }
      oFirstElementChild = oNode.firstElementChild;
      while (oFirstElementChild !== null) {
        const oNextChild = oFirstElementChild.nextElementSibling;
        const sChildName = oFirstElementChild.localName;
        let sAggregationName = sChildName;
        if (sAggregationName[0].toUpperCase() === sAggregationName[0]) {
          // not a sub aggregation, go back to default Aggregation
          sAggregationName = oMetadata.defaultAggregation || "";
        }
        if (Object.keys(oMetadata.aggregations).indexOf(sAggregationName) !== -1 && (!isPublic || oMetadata.aggregations[sAggregationName].isPublic === true)) {
          if (apiVersion === 2) {
            const aggregationDefinition = oMetadata.aggregations[sAggregationName];
            if (!aggregationDefinition.slot && oFirstElementChild !== null && oFirstElementChild.children.length > 0) {
              await oVisitor.visitNode(oFirstElementChild);
              let childDefinition = oFirstElementChild.firstElementChild;
              while (childDefinition) {
                const nextChild = childDefinition.nextElementSibling;
                if (!aggregationDefinition.hasVirtualNode) {
                  const childWrapper = document.createElementNS(oNode.namespaceURI, childDefinition.getAttribute("key"));
                  childWrapper.appendChild(childDefinition);
                  oAggregations[childDefinition.getAttribute("key")] = childWrapper;
                } else {
                  oAggregations[childDefinition.getAttribute("key")] = childDefinition;
                }
                childDefinition.removeAttribute("key");
                childDefinition = nextChild;
              }
            } else if (aggregationDefinition.slot) {
              if (sAggregationName !== sChildName) {
                if (!oAggregations[sAggregationName]) {
                  const oNewChild = document.createElementNS(oNode.namespaceURI, sAggregationName);
                  oAggregations[sAggregationName] = oNewChild;
                }
                oAggregations[sAggregationName].appendChild(oFirstElementChild);
              } else {
                oAggregations[sAggregationName] = oFirstElementChild;
              }
            }
          } else {
            await oVisitor.visitNode(oFirstElementChild);
            oAggregations[oFirstElementChild.localName] = oFirstElementChild;
          }
        } else if (Object.keys(oMetadata.properties).indexOf(sAggregationName) !== -1) {
          await oVisitor.visitNode(oFirstElementChild);
          if (oMetadata.properties[sAggregationName].type === "object") {
            // Object Type properties
            const aggregationPropertyValues = {};
            const attributeNames = oFirstElementChild.getAttributeNames();
            for (const attributeName of attributeNames) {
              aggregationPropertyValues[attributeName] = oFirstElementChild.getAttribute(attributeName);
            }
            if (oFirstElementChild.children.length) {
              //retrieve one level subObject properties
              for (let childIndex = 0; childIndex < oFirstElementChild.children.length; childIndex++) {
                const subChild = oFirstElementChild.children[childIndex];
                const subObjectKey = subChild.localName;
                const subObject = {};
                const subChildAttributeNames = subChild.getAttributeNames();
                for (const subChildAttributeName of subChildAttributeNames) {
                  subObject[subChildAttributeName] = subChild.getAttribute(subChildAttributeName);
                }
                aggregationPropertyValues[subObjectKey] = subObject;
              }
            }
            propertyValues[sAggregationName] = aggregationPropertyValues;
          } else if (oMetadata.properties[sAggregationName].type === "array") {
            if (oFirstElementChild !== null && oFirstElementChild.children.length > 0) {
              const children = oFirstElementChild.children;
              const oOutObjects = [];
              for (let childIdx = 0; childIdx < children.length; childIdx++) {
                const childDefinition = children[childIdx];
                // non keyed child, just add it to the aggregation
                const myChild = {};
                const attributeNames = childDefinition.getAttributeNames();
                for (const attributeName of attributeNames) {
                  myChild[attributeName] = childDefinition.getAttribute(attributeName);
                }
                oOutObjects.push(myChild);
              }
              propertyValues[sAggregationName] = oOutObjects;
            }
          }
        }
        oFirstElementChild = oNextChild;
      }
    }
    return oAggregations;
  }
  function processSlots(oAggregations, oMetadataAggregations, oNode) {
    let processCustomData = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    if (Object.keys(oAggregations).length > 0) {
      Object.keys(oAggregations).forEach(function (sAggregationName) {
        const oAggregationElement = oAggregations[sAggregationName];
        if (oNode !== null && oNode !== undefined && oAggregationElement) {
          // slots can have :: as keys which is not a valid aggregation name therefore replacing them
          const oElementChild = oAggregationElement.firstElementChild;
          if (sAggregationName !== "customData" && sAggregationName !== "dependents") {
            const sSlotName = oMetadataAggregations[sAggregationName] !== undefined && oMetadataAggregations[sAggregationName].slot || sAggregationName;
            const oTargetElement = oNode.querySelector(`slot[name='${sSlotName}']`);
            if (oTargetElement !== null) {
              const oNewChild = prepareAggregationElement(oNode, sAggregationName, oElementChild);
              oTargetElement.replaceWith(...oNewChild.children); // Somehow TS doesn't like this but the documentation says is should work
            }
          } else if (processCustomData && oElementChild !== null) {
            const oNewChild = prepareAggregationElement(oNode, sAggregationName, oElementChild);
            oNode.appendChild(oNewChild);
          }
        }
      });
    }
  }
  function prepareAggregationElement(oNode, sAggregationName, oElementChild) {
    const oNewChild = document.createElementNS(oNode.namespaceURI, sAggregationName.replace(/:/gi, "_"));
    while (oElementChild) {
      const oNextChild = oElementChild.nextElementSibling;
      oNewChild.appendChild(oElementChild);
      oElementChild = oNextChild;
    }
    return oNewChild;
  }
  async function processBuildingBlock(buildingBlockDefinition, oNode, oVisitor) {
    let isPublic = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    const sFragmentName = buildingBlockDefinition.fragment || `${buildingBlockDefinition.namespace}.${buildingBlockDefinition.xmlTag || buildingBlockDefinition.name}`;
    const sName = "this";
    const mContexts = {};
    const oMetadataContexts = {};
    const oSettings = oVisitor.getSettings();
    // TODO 0001 Move this elsewhere this is weird :)
    if (oSettings.models["sap.fe.i18n"]) {
      oSettings.models["sap.fe.i18n"].getResourceBundle().then(function (oResourceBundle) {
        ResourceModel.setApplicationI18nBundle(oResourceBundle);
      }).catch(function (error) {
        Log.error(error);
      });
    }
    const oMetadata = prepareMetadata(buildingBlockDefinition.metadata, buildingBlockDefinition.isOpen, buildingBlockDefinition.apiVersion);

    //Inject storage for macros
    if (!oSettings[sFragmentName]) {
      oSettings[sFragmentName] = {};
    }

    // First of all we need to visit the attributes to resolve the properties and the metadata contexts
    let propertyValues = await processProperties(oMetadata, oNode, isPublic, oVisitor, buildingBlockDefinition.apiVersion);
    const {
      mMissingContext,
      propertyValues: extraPropertyValues
    } = processContexts(oMetadata, oSettings, oNode, isPublic, oVisitor, mContexts, oMetadataContexts);
    propertyValues = Object.assign(propertyValues, extraPropertyValues);
    const initialKeys = Object.keys(propertyValues);
    try {
      // Aggregation and complex type support
      const oAggregations = await processChildren(oNode, oVisitor, oMetadata, isPublic, propertyValues, buildingBlockDefinition.apiVersion);
      let oInstance;
      let oControlConfig = {};
      if (oSettings.models.viewData) {
        // Only used in the Field macro and even then maybe not really useful
        oControlConfig = oSettings.models.viewData.getProperty("/controlConfiguration");
      }
      let processedPropertyValues = propertyValues;
      if (isV1MacroDef(buildingBlockDefinition) && buildingBlockDefinition.create) {
        processedPropertyValues = buildingBlockDefinition.create.call(buildingBlockDefinition, propertyValues, oControlConfig, oSettings, oAggregations, isPublic);
        Object.keys(oMetadata.metadataContexts).forEach(function (sMetadataName) {
          if (oMetadata.metadataContexts[sMetadataName].computed === true) {
            mContexts[sMetadataName] = processedPropertyValues[sMetadataName];
          }
        });
        Object.keys(mMissingContext).forEach(function (sContextName) {
          if (processedPropertyValues.hasOwnProperty(sContextName)) {
            mContexts[sContextName] = processedPropertyValues[sContextName];
          }
        });
      } else if (buildingBlockDefinition.apiVersion === 2) {
        Object.keys(propertyValues).forEach(propName => {
          var _buildingBlockDefinit, _oData, _oData$isA;
          let oData = propertyValues[propName];
          //check for additional processing function to validate / overwrite parameters
          const originalDefinition = buildingBlockDefinition === null || buildingBlockDefinition === void 0 ? void 0 : (_buildingBlockDefinit = buildingBlockDefinition.metadata) === null || _buildingBlockDefinit === void 0 ? void 0 : _buildingBlockDefinit.properties[propName];
          if (originalDefinition !== null && originalDefinition !== void 0 && originalDefinition.validate) {
            oData = originalDefinition.validate(oData) || oData;
          }
          if ((_oData = oData) !== null && _oData !== void 0 && (_oData$isA = _oData.isA) !== null && _oData$isA !== void 0 && _oData$isA.call(_oData, SAP_UI_MODEL_CONTEXT) && !oData.getModel().isA("sap.ui.model.odata.v4.ODataMetaModel")) {
            propertyValues[propName] = oData.getObject();
          }
        });
        const BuildingBlockClass = buildingBlockDefinition;
        propertyValues.isPublic = isPublic;
        oInstance = new BuildingBlockClass({
          ...propertyValues,
          ...oAggregations
        }, oControlConfig, oSettings
        /*, oControlConfig, oSettings, oAggregations, isPublic*/);

        processedPropertyValues = oInstance.getProperties();
        Object.keys(oMetadata.metadataContexts).forEach(function (sContextName) {
          if (processedPropertyValues.hasOwnProperty(sContextName)) {
            const targetObject = processedPropertyValues[sContextName];
            if (typeof targetObject === "object" && !isContext(targetObject)) {
              const sAttributeValue = storeValue(targetObject);
              oSettings.models.converterContext.setProperty(sAttributeValue, targetObject);
              const newContext = oSettings.models.converterContext.createBindingContext(sAttributeValue);
              delete myStore[sAttributeValue];
              mContexts[sContextName] = newContext;
            } else if (!mContexts.hasOwnProperty(sContextName) && targetObject !== undefined) {
              mContexts[sContextName] = targetObject;
            }
          }
        });
      }
      const oAttributesModel = new AttributeModel(oNode, processedPropertyValues, buildingBlockDefinition);
      mContexts[sName] = oAttributesModel.createBindingContext("/");
      let oPreviousMacroInfo;

      // Keep track
      if (TraceInfo.isTraceInfoActive()) {
        const oTraceInfo = TraceInfo.traceMacroCalls(sFragmentName, oMetadata, mContexts, oNode, oVisitor);
        if (oTraceInfo !== null && oTraceInfo !== void 0 && oTraceInfo.macroInfo) {
          oPreviousMacroInfo = oSettings["_macroInfo"];
          oSettings["_macroInfo"] = oTraceInfo.macroInfo;
        }
      }
      validateMacroSignature(sFragmentName, oMetadata, mContexts, oNode);
      const oContextVisitor = oVisitor.with(mContexts, buildingBlockDefinition.isOpen !== undefined ? !buildingBlockDefinition.isOpen : true);
      const oParent = oNode.parentNode;
      let iChildIndex;
      let oPromise;
      let processCustomData = true;
      if (oParent) {
        iChildIndex = Array.from(oParent.children).indexOf(oNode);
        if (isV1MacroDef(buildingBlockDefinition) && buildingBlockDefinition.getTemplate || buildingBlockDefinition.apiVersion === 2 && !buildingBlockDefinition.fragment) {
          let templateString;
          let addDefaultNamespace = false;
          if (buildingBlockDefinition.apiVersion === 2 && oInstance !== undefined) {
            templateString = await oInstance.getTemplate(oNode);
            if (buildingBlockDefinition.isRuntime === true) {
              // For runtime building blocks, we need to attach all objects to the converterContext directly, as the actual rendering takes place at runtime
              for (const myStoreKey in myStore) {
                const oData = myStore[myStoreKey];
                oSettings.models.converterContext.setProperty(myStoreKey, oData);
                delete myStore[myStoreKey];
              }
            }
            addDefaultNamespace = true;
          } else if (buildingBlockDefinition.getTemplate) {
            templateString = await buildingBlockDefinition.getTemplate(processedPropertyValues);
          }
          let hasError = "";
          if (templateString) {
            let hasParseError = false;
            let parsedTemplate = parseXMLString(templateString, addDefaultNamespace);
            // For safety purpose we try to detect trailing text in between XML Tags
            for (const element of parsedTemplate) {
              const iter = document.createNodeIterator(element, NodeFilter.SHOW_TEXT);
              let textnode = iter.nextNode();
              if (element.localName === "parsererror") {
                hasParseError = true;
              }
              while (textnode) {
                if (textnode.textContent && textnode.textContent.trim().length > 0) {
                  hasError = textnode.textContent;
                }
                textnode = iter.nextNode();
              }
            }
            if (hasParseError) {
              // If there is a parseerror while processing the XML it means the XML itself is malformed, as such we rerun the template process
              // Setting isTraceMode true will make it so that each xml` expression is checked for validity from XML perspective
              // If an error is found it's returned instead of the normal fragment
              Log.error(`Error while processing building block ${buildingBlockDefinition.xmlTag || buildingBlockDefinition.name}`);
              try {
                var _oInstance;
                isTraceMode = true;
                const initialTemplate = (_oInstance = oInstance) !== null && _oInstance !== void 0 && _oInstance.getTemplate ? await oInstance.getTemplate(oNode) : await buildingBlockDefinition.getTemplate(processedPropertyValues);
                parsedTemplate = parseXMLString(initialTemplate, true);
              } finally {
                isTraceMode = false;
              }
            } else if (hasError.length > 0) {
              // If there is trailing text we create a standard error and display it.
              Log.error(`Error while processing building block ${buildingBlockDefinition.xmlTag || buildingBlockDefinition.name}`);
              const oErrorText = createErrorXML([`Error while processing building block ${buildingBlockDefinition.xmlTag || buildingBlockDefinition.name}`, `Trailing text was found in the XML: ${hasError}`], parsedTemplate.map(template => template.outerHTML).join("\n"));
              parsedTemplate = parseXMLString(oErrorText, true);
            }
            oNode.replaceWith(...parsedTemplate);
            oNode = oParent.children[iChildIndex];
            processSlots(oAggregations, oMetadata.aggregations, oNode, processCustomData);
            processCustomData = false;
            oPromise = oContextVisitor.visitNode(oNode);
          } else {
            oNode.remove();
            oPromise = Promise.resolve();
          }
        } else {
          oPromise = oContextVisitor.insertFragment(sFragmentName, oNode);
        }
        await oPromise;
        const oMacroElement = oParent.children[iChildIndex];
        processSlots(oAggregations, oMetadata.aggregations, oMacroElement, processCustomData);
        if (oMacroElement !== undefined) {
          const oRemainingSlots = oMacroElement.querySelectorAll("slot");
          oRemainingSlots.forEach(function (oSlotElement) {
            oSlotElement.remove();
          });
        }
      }
      if (oPreviousMacroInfo) {
        //restore macro info if available
        oSettings["_macroInfo"] = oPreviousMacroInfo;
      } else {
        delete oSettings["_macroInfo"];
      }
    } catch (e) {
      // In case there is a generic error (usually code error), we retrieve the current context information and create a dedicated error message
      const traceDetails = {
        initialProperties: {},
        resolvedProperties: {},
        missingContexts: mMissingContext
      };
      for (const propertyName of initialKeys) {
        const propertyValue = propertyValues[propertyName];
        if (isContext(propertyValue)) {
          traceDetails.initialProperties[propertyName] = {
            path: propertyValue.getPath(),
            value: propertyValue.getObject()
          };
        } else {
          traceDetails.initialProperties[propertyName] = propertyValue;
        }
      }
      for (const propertyName in propertyValues) {
        const propertyValue = propertyValues[propertyName];
        if (!initialKeys.includes(propertyName)) {
          if (isContext(propertyValue)) {
            traceDetails.resolvedProperties[propertyName] = {
              path: propertyValue.getPath(),
              value: propertyValue.getObject()
            };
          } else {
            traceDetails.resolvedProperties[propertyName] = propertyValue;
          }
        }
      }
      Log.error(e);
      const oError = createErrorXML([`Error while processing building block ${buildingBlockDefinition.name}`], oNode.outerHTML, traceDetails, e.stack);
      const oTemplate = parseXMLString(oError, true);
      oNode.replaceWith(...oTemplate);
    }
  }
  function addSingleContext(mContexts, oVisitor, oCtx, oMetadataContexts) {
    const sKey = oCtx.name || oCtx.model || undefined;
    if (oMetadataContexts[sKey]) {
      return; // do not add twice
    }

    try {
      let sContextPath = oCtx.path;
      if (oCtx.model !== null) {
        sContextPath = `${oCtx.model}>${sContextPath}`;
      }
      const mSetting = oVisitor.getSettings();
      if (oCtx.model === "converterContext" && oCtx.path.length > 0) {
        mContexts[sKey] = mSetting.models[oCtx.model].getContext(oCtx.path /*, mSetting.bindingContexts[oCtx.model]*/); // add the context to the visitor
      } else if (!mSetting.bindingContexts[oCtx.model] && mSetting.models[oCtx.model]) {
        mContexts[sKey] = mSetting.models[oCtx.model].getContext(oCtx.path); // add the context to the visitor
      } else {
        mContexts[sKey] = oVisitor.getContext(sContextPath); // add the context to the visitor
      }

      oMetadataContexts[sKey] = mContexts[sKey]; // make it available inside metadataContexts JSON object
    } catch (ex) {
      //console.error(ex);
      // ignore the context as this can only be the case if the model is not ready, i.e. not a preprocessing model but maybe a model for
      // providing afterwards
      // TODO 0002 not yet implemented
      //mContexts["_$error"].oModel.setProperty("/" + sKey, ex);
    }
  }

  /**
   * Register a building block definition to be used inside the xml template processor.
   *
   * @param buildingBlockDefinition The building block definition
   */
  function registerBuildingBlock(buildingBlockDefinition) {
    XMLPreprocessor.plugIn(async (oNode, oVisitor) => processBuildingBlock(buildingBlockDefinition, oNode, oVisitor), buildingBlockDefinition.namespace, buildingBlockDefinition.xmlTag || buildingBlockDefinition.name);
    if (buildingBlockDefinition.publicNamespace) {
      XMLPreprocessor.plugIn(async (oNode, oVisitor) => processBuildingBlock(buildingBlockDefinition, oNode, oVisitor, true), buildingBlockDefinition.publicNamespace, buildingBlockDefinition.xmlTag || buildingBlockDefinition.name);
    }
  }
  _exports.registerBuildingBlock = registerBuildingBlock;
  function createErrorXML(errorMessages, xmlFragment, additionalData, stack) {
    const errorLabels = errorMessages.map(errorMessage => xml`<m:Label text="${escapeXMLAttributeValue(errorMessage)}"/>`);
    let errorStack = "";
    if (stack) {
      const stackFormatted = btoa(`<pre>${stack}</pre>`);
      errorStack = xml`<m:FormattedText htmlText="${`{= BBF.base64Decode('${stackFormatted}') }`}" />`;
    }
    let additionalText = "";
    if (additionalData) {
      additionalText = xml`<m:VBox>
						<m:Label text="Trace Info"/>
						<code:CodeEditor type="json"  value="${`{= BBF.base64Decode('${btoa(JSON.stringify(additionalData, null, 4))}') }`}" height="300px" />
					</m:VBox>`;
    }
    return xml`<m:VBox xmlns:m="sap.m" xmlns:code="sap.ui.codeeditor" core:require="{BBF:'sap/fe/core/buildingBlocks/BuildingBlockFormatter'}">
				${errorLabels}
				${errorStack}
				<grid:CSSGrid gridTemplateRows="fr" gridTemplateColumns="repeat(2,1fr)" gridGap="1rem" xmlns:grid="sap.ui.layout.cssgrid" >
					<m:VBox>
						<m:Label text="How the building block was called"/>
						<code:CodeEditor type="xml" value="${`{= BBF.base64Decode('${btoa(xmlFragment.replaceAll("&gt;", ">"))}') }`}" height="300px" />
					</m:VBox>
					${additionalText}
				</grid:CSSGrid>
			</m:VBox>`;
  }
  const myStore = {};
  function storeValue(values) {
    const propertyUID = `/uid--${uid()}`;
    myStore[propertyUID] = values;
    return propertyUID;
  }

  /**
   * Parse an XML string and return the associated document.
   *
   * @param xmlString The xml string
   * @param [addDefaultNamespaces] Whether or not default namespaces should be added
   * @returns The XML document.
   */
  function parseXMLString(xmlString) {
    var _output2, _output3;
    let addDefaultNamespaces = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    if (addDefaultNamespaces) {
      xmlString = `<template
						xmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"
						xmlns:m="sap.m"
						xmlns:macros="sap.fe.macros"
						xmlns:core="sap.ui.core"
						xmlns:mdc="sap.ui.mdc"
						xmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">${xmlString}</template>`;
    }
    const xmlDocument = DOMParserInstance.parseFromString(xmlString, "text/xml");
    let output = xmlDocument.firstElementChild;
    while (((_output = output) === null || _output === void 0 ? void 0 : _output.localName) === "template") {
      var _output;
      output = output.firstElementChild;
    }
    const children = (_output2 = output) !== null && _output2 !== void 0 && _output2.parentElement ? (_output3 = output) === null || _output3 === void 0 ? void 0 : _output3.parentElement.children : [output];
    return Array.from(children);
  }

  /**
   * Escape an XML attribute value.
   *
   * @param value The attribute value to escape.
   * @returns The escaped string.
   */
  _exports.parseXMLString = parseXMLString;
  function escapeXMLAttributeValue(value) {
    return value === null || value === void 0 ? void 0 : value.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/"/g, "&quot;").replace(/'/g, "&apos;");
  }
  _exports.escapeXMLAttributeValue = escapeXMLAttributeValue;
  function renderInTraceMode(outStr) {
    var _xmlResult$;
    const xmlResult = parseXMLString(outStr, true);
    if ((xmlResult === null || xmlResult === void 0 ? void 0 : xmlResult.length) > 0 && ((_xmlResult$ = xmlResult[0]) === null || _xmlResult$ === void 0 ? void 0 : _xmlResult$.localName) === "parsererror") {
      const errorMessage = xmlResult[0].innerText || xmlResult[0].innerHTML;
      return createErrorXML([errorMessage.split("\n")[0]], outStr);
    } else {
      return outStr;
    }
  }
  /**
   * Create a string representation of the template literal while handling special object case.
   *
   * @param strings The string parts of the template literal
   * @param values The values part of the template literal
   * @returns The XML string document representing the string that was used.
   */
  const xml = function (strings) {
    let outStr = "";
    let i;
    for (var _len = arguments.length, values = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      values[_key - 1] = arguments[_key];
    }
    for (i = 0; i < values.length; i++) {
      outStr += strings[i];

      // Handle the different case of object, if it's an array we join them, if it's a binding expression then we compile it.
      const value = values[i];
      if (Array.isArray(value) && value.length > 0 && typeof value[0] === "string") {
        outStr += value.flat(5).join("\n").trim();
      } else if (isFunctionArray(value)) {
        outStr += value.map(valuefn => valuefn()).join("\n");
      } else if (isBindingToolkitExpression(value)) {
        const compiledExpression = compileExpression(value);
        outStr += escapeXMLAttributeValue(compiledExpression);
      } else if (typeof value === "undefined") {
        outStr += "{this>undefinedValue}";
      } else if (typeof value === "function") {
        outStr += value();
      } else if (typeof value === "object" && value !== null) {
        if (isContext(value)) {
          outStr += value.getPath();
        } else {
          const propertyUId = storeValue(value);
          outStr += `${propertyUId}`;
        }
      } else if (value && typeof value === "string" && !value.startsWith("<") && !value.startsWith("&lt;")) {
        outStr += escapeXMLAttributeValue(value);
      } else {
        outStr += value;
      }
    }
    outStr += strings[i];
    outStr = outStr.trim();
    if (isTraceMode) {
      return renderInTraceMode(outStr);
    }
    return outStr;
  };
  _exports.xml = xml;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/BuildingBlockRuntime", ["sap/base/Log","sap/base/util/deepClone","sap/base/util/uid","sap/fe/core/buildingBlocks/AttributeModel","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/TypeGuards","sap/fe/macros/ResourceModel","sap/ui/base/BindingParser","sap/ui/core/util/XMLPreprocessor","./TraceInfo"],function(e,t,n,i,o,s,r,a,l,c,f){"use strict";var d={};var u=r.isFunctionArray;var p=r.isContext;var m=s.isBindingToolkitExpression;var g=s.compileExpression;var h=o.Placement;const b="sap.fe.core.buildingBlocks.BuildingBlockRuntime";const x="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1";const y=new DOMParser;let v=false;function C(e){return e.apiVersion===undefined||e.apiVersion===1}function $(e,t,n,i){const o=t[i];const s=o===null||o===void 0?void 0:o.getObject();if(n.required===true&&(!o||s===null)){throw new Error(`${e}: Required metadataContext '${i}' is missing`)}else if(s){if(s.hasOwnProperty("$kind")&&s.$kind!==undefined&&n.$kind!==undefined){if(n.$kind.indexOf(s.$kind)===-1){throw new Error(`${e}: '${i}' must be '$kind' '${n["$kind"]}' but is '${s.$kind}': ${o.getPath()}`)}}else if(s.hasOwnProperty("$Type")&&s.$Type!==undefined&&n.$Type){if(n.$Type.indexOf(s.$Type)===-1){throw new Error(`${e}: '${i}' must be '$Type' '${n["$Type"]}' but is '${s.$Type}': ${o.getPath()}`)}}}}function w(t,n,i,o){const s=n.metadataContexts&&Object.keys(n.metadataContexts)||[],r=n.properties&&Object.keys(n.properties)||[],a={};const l=o.getAttributeNames();for(const e of l){a[e]=true}s.forEach(function(e){const o=n.metadataContexts[e];$(t,i,o,e);delete a[e]});r.forEach(function(e){const i=n.properties[e];if(!o.hasAttribute(e)){if(i.required&&!i.hasOwnProperty("defaultValue")){throw new Error(`${t}: `+`Required property '${e}' is missing`)}}else{delete a[e]}});Object.keys(a).forEach(function(n){if(n.indexOf(":")<0&&!n.startsWith("xmlns")){e.warning(`Unchecked parameter: ${t}: ${n}`,undefined,b)}})}d.validateMacroSignature=w;const O="sap.ui.core.Element";const k="sap.ui.model.Context";d.SAP_UI_MODEL_CONTEXT=k;function P(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n=arguments.length>2?arguments[2]:undefined;if(e){const i={};const o={dependents:{type:O},customData:{type:O}};if(n===2){o.dependents.slot="dependents";o.customData.slot="customData"}const s={};let r;Object.keys(e.properties).forEach(function(t){if(e.properties[t].type!==k){i[t]=e.properties[t]}else{s[t]=e.properties[t]}});if(e.events!==undefined){Object.keys(e.events).forEach(function(t){i[t]={type:"function",...e.events[t]}})}if(e.aggregations!==undefined){Object.keys(e.aggregations).forEach(function(t){o[t]=e.aggregations[t];if(o[t].isDefault){r=t}})}return{properties:i,aggregations:o,defaultAggregation:r,metadataContexts:s,isOpen:t}}else{return{metadataContexts:{},aggregations:{dependents:{type:O},customData:{type:O}},properties:{},isOpen:t}}}function A(e,t){let n;if(t&&t.startsWith("/")){n=t}else{let i=e.currentContextPath.getPath();if(!i.endsWith("/")){i+="/"}n=i+t}return{model:"metaModel",path:n}}function E(e,t,n){let i;if(n.startsWith("/uid--")){const t=R[n];e.models.converterContext.setProperty(n,t);i={model:"converterContext",path:n};delete R[n]}else if(t==="metaPath"&&e.currentContextPath||t==="contextPath"){i=A(e,n)}else if(n&&n.startsWith("/")){i={model:"metaModel",path:n}}else{i={model:"metaModel",path:e.bindingContexts.entitySet?e.bindingContexts.entitySet.getPath(n):n}}return i}function T(e,t,n,i,o,s){let r;if(!o&&t.hasAttribute(n)){const i=t.getAttribute(n);r=l.complexParser(i);if(!r){r=E(e,n,i)}}else if(e.bindingContexts.hasOwnProperty(n)){r={model:n,path:""}}else if(s){try{if(i.getContext(`${n}>`)){r={model:n,path:""}}}catch(e){return undefined}}return r}async function N(n,i,o,s,r){const a=n.properties;const l=Object.keys(a);const c={};for(const n of l){if(a[n].type==="object"){c[n]=t(a[n].defaultValue||{})}else{c[n]=a[n].defaultValue}if(i.hasAttribute(n)&&o&&a[n].isPublic===false){e.error(`Property ${n} was ignored as it is not intended for public usage`)}else if(i.hasAttribute(n)){await s.visitAttribute(i,i.attributes.getNamedItem(n));let e=i.getAttribute(n);if(e!==undefined&&e!==null){if(r===2&&typeof e==="string"&&!e.startsWith("{")){switch(a[n].type){case"boolean":e=e==="true";break;case"number":e=Number(e);break}}e=e===null?undefined:e;c[n]=e}}}return c}function j(e,t,n,i,o,s,r){t.currentContextPath=t.bindingContexts.contextPath;const a={};const l={};const c=e.metadataContexts;const f=Object.keys(c);const d=f.indexOf("contextPath");if(d!==-1){const e=f.splice(d,1);f.splice(0,0,e[0])}for(const d of f){const f=i&&c[d].isPublic===false&&n.hasAttribute(d);const u=T(t,n,d,o,f,e.isOpen);if(u){u.name=d;D(s,o,u,r);if((d==="entitySet"||d==="contextPath")&&!t.bindingContexts.hasOwnProperty(d)){t.bindingContexts[d]=s[d]}if(d==="contextPath"){t.currentContextPath=s[d]}l[d]=s[d]}else{a[d]=true}}return{mMissingContext:a,propertyValues:l}}function B(e,t){const n={};if(e&&e.children.length>0){const i=e.children;for(let e=0;e<i.length;e++){const o=i[e];let s=o.getAttribute("key")||o.getAttribute("id");if(s){s=`InlineXML_${s}`;o.setAttribute("key",s);let e={key:s,position:{placement:o.getAttribute("placement")||h.After,anchor:o.getAttribute("anchor")||undefined},type:"Slot"};if(t){e=t(o,e)}n[e.key]=e}}}return n}async function S(e,t,n,i,o,s){const r={};if(e.firstElementChild!==null){let a=e.firstElementChild;if(s===2){while(a!==null){if(a.namespaceURI===x){const e=a.parentNode;let n;if(e){n=Array.from(e.children).indexOf(a);await t.visitNode(a);a=e.children[n]?e.children[n]:null}else{a=a.nextElementSibling}}else{const e=a.localName;let t=e;if(t[0].toUpperCase()===t[0]){t=n.defaultAggregation||""}const i=n.aggregations[t];if(i!==undefined&&!i.slot){const e=B(a,i.processAggregations);o[t]=e;for(const t in e){n.aggregations[t]=e[t]}}a=a.nextElementSibling}}}if(s!==2){await t.visitChildNodes(e)}a=e.firstElementChild;while(a!==null){const l=a.nextElementSibling;const c=a.localName;let f=c;if(f[0].toUpperCase()===f[0]){f=n.defaultAggregation||""}if(Object.keys(n.aggregations).indexOf(f)!==-1&&(!i||n.aggregations[f].isPublic===true)){if(s===2){const i=n.aggregations[f];if(!i.slot&&a!==null&&a.children.length>0){await t.visitNode(a);let n=a.firstElementChild;while(n){const t=n.nextElementSibling;if(!i.hasVirtualNode){const t=document.createElementNS(e.namespaceURI,n.getAttribute("key"));t.appendChild(n);r[n.getAttribute("key")]=t}else{r[n.getAttribute("key")]=n}n.removeAttribute("key");n=t}}else if(i.slot){if(f!==c){if(!r[f]){const t=document.createElementNS(e.namespaceURI,f);r[f]=t}r[f].appendChild(a)}else{r[f]=a}}}else{await t.visitNode(a);r[a.localName]=a}}else if(Object.keys(n.properties).indexOf(f)!==-1){await t.visitNode(a);if(n.properties[f].type==="object"){const e={};const t=a.getAttributeNames();for(const n of t){e[n]=a.getAttribute(n)}if(a.children.length){for(let t=0;t<a.children.length;t++){const n=a.children[t];const i=n.localName;const o={};const s=n.getAttributeNames();for(const e of s){o[e]=n.getAttribute(e)}e[i]=o}}o[f]=e}else if(n.properties[f].type==="array"){if(a!==null&&a.children.length>0){const e=a.children;const t=[];for(let n=0;n<e.length;n++){const i=e[n];const o={};const s=i.getAttributeNames();for(const e of s){o[e]=i.getAttribute(e)}t.push(o)}o[f]=t}}}a=l}}return r}function M(e,t,n){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(Object.keys(e).length>0){Object.keys(e).forEach(function(o){const s=e[o];if(n!==null&&n!==undefined&&s){const e=s.firstElementChild;if(o!=="customData"&&o!=="dependents"){const i=t[o]!==undefined&&t[o].slot||o;const s=n.querySelector(`slot[name='${i}']`);if(s!==null){const t=V(n,o,e);s.replaceWith(...t.children)}}else if(i&&e!==null){const t=V(n,o,e);n.appendChild(t)}}})}}function V(e,t,n){const i=document.createElementNS(e.namespaceURI,t.replace(/:/gi,"_"));while(n){const e=n.nextElementSibling;i.appendChild(n);n=e}return i}async function I(t,n,o){let s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const r=t.fragment||`${t.namespace}.${t.xmlTag||t.name}`;const l="this";const c={};const d={};const u=o.getSettings();if(u.models["sap.fe.i18n"]){u.models["sap.fe.i18n"].getResourceBundle().then(function(e){a.setApplicationI18nBundle(e)}).catch(function(t){e.error(t)})}const m=P(t.metadata,t.isOpen,t.apiVersion);if(!u[r]){u[r]={}}let g=await N(m,n,s,o,t.apiVersion);const{mMissingContext:h,propertyValues:b}=j(m,u,n,s,o,c,d);g=Object.assign(g,b);const x=Object.keys(g);try{const a=await S(n,o,m,s,g,t.apiVersion);let d;let b={};if(u.models.viewData){b=u.models.viewData.getProperty("/controlConfiguration")}let x=g;if(C(t)&&t.create){x=t.create.call(t,g,b,u,a,s);Object.keys(m.metadataContexts).forEach(function(e){if(m.metadataContexts[e].computed===true){c[e]=x[e]}});Object.keys(h).forEach(function(e){if(x.hasOwnProperty(e)){c[e]=x[e]}})}else if(t.apiVersion===2){Object.keys(g).forEach(e=>{var n,i,o;let s=g[e];const r=t===null||t===void 0?void 0:(n=t.metadata)===null||n===void 0?void 0:n.properties[e];if(r!==null&&r!==void 0&&r.validate){s=r.validate(s)||s}if((i=s)!==null&&i!==void 0&&(o=i.isA)!==null&&o!==void 0&&o.call(i,k)&&!s.getModel().isA("sap.ui.model.odata.v4.ODataMetaModel")){g[e]=s.getObject()}});const e=t;g.isPublic=s;d=new e({...g,...a},b,u);x=d.getProperties();Object.keys(m.metadataContexts).forEach(function(e){if(x.hasOwnProperty(e)){const t=x[e];if(typeof t==="object"&&!p(t)){const n=F(t);u.models.converterContext.setProperty(n,t);const i=u.models.converterContext.createBindingContext(n);delete R[n];c[e]=i}else if(!c.hasOwnProperty(e)&&t!==undefined){c[e]=t}}})}const $=new i(n,x,t);c[l]=$.createBindingContext("/");let O;if(f.isTraceInfoActive()){const e=f.traceMacroCalls(r,m,c,n,o);if(e!==null&&e!==void 0&&e.macroInfo){O=u["_macroInfo"];u["_macroInfo"]=e.macroInfo}}w(r,m,c,n);const P=o.with(c,t.isOpen!==undefined?!t.isOpen:true);const A=n.parentNode;let E;let T;let N=true;if(A){E=Array.from(A.children).indexOf(n);if(C(t)&&t.getTemplate||t.apiVersion===2&&!t.fragment){let i;let o=false;if(t.apiVersion===2&&d!==undefined){i=await d.getTemplate(n);if(t.isRuntime===true){for(const e in R){const t=R[e];u.models.converterContext.setProperty(e,t);delete R[e]}}o=true}else if(t.getTemplate){i=await t.getTemplate(x)}let s="";if(i){let r=false;let l=_(i,o);for(const e of l){const t=document.createNodeIterator(e,NodeFilter.SHOW_TEXT);let n=t.nextNode();if(e.localName==="parsererror"){r=true}while(n){if(n.textContent&&n.textContent.trim().length>0){s=n.textContent}n=t.nextNode()}}if(r){e.error(`Error while processing building block ${t.xmlTag||t.name}`);try{var y;v=true;const e=(y=d)!==null&&y!==void 0&&y.getTemplate?await d.getTemplate(n):await t.getTemplate(x);l=_(e,true)}finally{v=false}}else if(s.length>0){e.error(`Error while processing building block ${t.xmlTag||t.name}`);const n=W([`Error while processing building block ${t.xmlTag||t.name}`,`Trailing text was found in the XML: ${s}`],l.map(e=>e.outerHTML).join("\n"));l=_(n,true)}n.replaceWith(...l);n=A.children[E];M(a,m.aggregations,n,N);N=false;T=P.visitNode(n)}else{n.remove();T=Promise.resolve()}}else{T=P.insertFragment(r,n)}await T;const i=A.children[E];M(a,m.aggregations,i,N);if(i!==undefined){const e=i.querySelectorAll("slot");e.forEach(function(e){e.remove()})}}if(O){u["_macroInfo"]=O}else{delete u["_macroInfo"]}}catch(i){const o={initialProperties:{},resolvedProperties:{},missingContexts:h};for(const e of x){const t=g[e];if(p(t)){o.initialProperties[e]={path:t.getPath(),value:t.getObject()}}else{o.initialProperties[e]=t}}for(const e in g){const t=g[e];if(!x.includes(e)){if(p(t)){o.resolvedProperties[e]={path:t.getPath(),value:t.getObject()}}else{o.resolvedProperties[e]=t}}}e.error(i);const s=W([`Error while processing building block ${t.name}`],n.outerHTML,o,i.stack);const r=_(s,true);n.replaceWith(...r)}}function D(e,t,n,i){const o=n.name||n.model||undefined;if(i[o]){return}try{let s=n.path;if(n.model!==null){s=`${n.model}>${s}`}const r=t.getSettings();if(n.model==="converterContext"&&n.path.length>0){e[o]=r.models[n.model].getContext(n.path)}else if(!r.bindingContexts[n.model]&&r.models[n.model]){e[o]=r.models[n.model].getContext(n.path)}else{e[o]=t.getContext(s)}i[o]=e[o]}catch(e){}}function L(e){c.plugIn(async(t,n)=>I(e,t,n),e.namespace,e.xmlTag||e.name);if(e.publicNamespace){c.plugIn(async(t,n)=>I(e,t,n,true),e.publicNamespace,e.xmlTag||e.name)}}d.registerBuildingBlock=L;function W(e,t,n,i){const o=e.map(e=>X`<m:Label text="${q(e)}"/>`);let s="";if(i){const e=btoa(`<pre>${i}</pre>`);s=X`<m:FormattedText htmlText="${`{= BBF.base64Decode('${e}') }`}" />`}let r="";if(n){r=X`<m:VBox>
						<m:Label text="Trace Info"/>
						<code:CodeEditor type="json"  value="${`{= BBF.base64Decode('${btoa(JSON.stringify(n,null,4))}') }`}" height="300px" />
					</m:VBox>`}return X`<m:VBox xmlns:m="sap.m" xmlns:code="sap.ui.codeeditor" core:require="{BBF:'sap/fe/core/buildingBlocks/BuildingBlockFormatter'}">
				${o}
				${s}
				<grid:CSSGrid gridTemplateRows="fr" gridTemplateColumns="repeat(2,1fr)" gridGap="1rem" xmlns:grid="sap.ui.layout.cssgrid" >
					<m:VBox>
						<m:Label text="How the building block was called"/>
						<code:CodeEditor type="xml" value="${`{= BBF.base64Decode('${btoa(t.replaceAll("&gt;",">"))}') }`}" height="300px" />
					</m:VBox>
					${r}
				</grid:CSSGrid>
			</m:VBox>`}const R={};function F(e){const t=`/uid--${n()}`;R[t]=e;return t}function _(e){var t,n;let i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(i){e=`<template\n\t\t\t\t\t\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\t\t\t\t\t\txmlns:m="sap.m"\n\t\t\t\t\t\txmlns:macros="sap.fe.macros"\n\t\t\t\t\t\txmlns:core="sap.ui.core"\n\t\t\t\t\t\txmlns:mdc="sap.ui.mdc"\n\t\t\t\t\t\txmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">${e}</template>`}const o=y.parseFromString(e,"text/xml");let s=o.firstElementChild;while(((r=s)===null||r===void 0?void 0:r.localName)==="template"){var r;s=s.firstElementChild}const a=(t=s)!==null&&t!==void 0&&t.parentElement?(n=s)===null||n===void 0?void 0:n.parentElement.children:[s];return Array.from(a)}d.parseXMLString=_;function q(e){return e===null||e===void 0?void 0:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}d.escapeXMLAttributeValue=q;function U(e){var t;const n=_(e,true);if((n===null||n===void 0?void 0:n.length)>0&&((t=n[0])===null||t===void 0?void 0:t.localName)==="parsererror"){const t=n[0].innerText||n[0].innerHTML;return W([t.split("\n")[0]],e)}else{return e}}const X=function(e){let t="";let n;for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++){o[s-1]=arguments[s]}for(n=0;n<o.length;n++){t+=e[n];const i=o[n];if(Array.isArray(i)&&i.length>0&&typeof i[0]==="string"){t+=i.flat(5).join("\n").trim()}else if(u(i)){t+=i.map(e=>e()).join("\n")}else if(m(i)){const e=g(i);t+=q(e)}else if(typeof i==="undefined"){t+="{this>undefinedValue}"}else if(typeof i==="function"){t+=i()}else if(typeof i==="object"&&i!==null){if(p(i)){t+=i.getPath()}else{const e=F(i);t+=`${e}`}}else if(i&&typeof i==="string"&&!i.startsWith("<")&&!i.startsWith("&lt;")){t+=q(i)}else{t+=i}}t+=e[n];t=t.trim();if(v){return U(t)}return t};d.xml=X;return d},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/TraceInfo-dbg", ["sap/base/Log", "sap/ui/base/ManagedObject", "sap/ui/core/util/XMLPreprocessor"], function (Log, ManagedObject, XMLPreprocessor) {
  "use strict";

  var bindingParser = ManagedObject.bindingParser;
  //Trace information
  const aTraceInfo = [
    /* Structure for a macro
    		{
    			macro: '', //name of macro
    			metaDataContexts: [ //Properties of type sap.ui.model.Context
    				{
    					name: '', //context property name / key
    					path: '', //from oContext.getPath()
    				}
    			],
    			properties: { // Other properties which become part of {this>}
    				property1: value,
    				property2: value
    			}
    			viewInfo: {
    				viewInfo: {} // As specified in view or fragment creation
    			},
    			traceID: this.index, //ID for this trace information,
    			macroInfo: {
    				macroID: index, // traceID of this macro (redundant for macros)
    				parentMacroID, index // traceID of the parent macro (if it has a parent)
    			}
    		}
    		// Structure for a control
    		{
    			control: '', //control class
    			properties: { // Other properties which become part of {this>}
    				property1: {
    					originalValue: '', //Value before templating
    					resolvedValue: '' //Value after templating
    				}
    			}
    			contexts: { //Models and Contexts used during templating
    				// Model or context name used for this control
    				modelName1: { // For ODataMetaModel
    					path1: {
    						path: '', //absolut path within metamodel
    						data: '', //data of path unless type Object
    					}
    				modelName2: {
    					// for other model types
    					{
    						property1: value,
    						property2: value
    					}
    					// In case binding cannot be resolved -> mark as runtime binding
    					// This is not always true, e.g. in case the path is metamodelpath
    					{
    						"bindingFor": "Runtime"
    					}
    				}
    			},
    			viewInfo: {
    				viewInfo: {} // As specified in view or fragment creation
    			},
    			macroInfo: {
    				macroID: index, // traceID of the macro that created this control
    				parentMacroID, index // traceID of the macro's parent macro
    			},
    			traceID: this.index //ID for this trace information
    		}
    		*/
  ];
  const traceNamespace = "http://schemas.sap.com/sapui5/extension/sap.fe.info/1",
    xmlns = "http://www.w3.org/2000/xmlns/",
    /**
     * Switch is currently based on url parameter
     */
    traceIsOn = location.search.indexOf("sap-ui-xx-feTraceInfo=true") > -1,
    /**
     * Specify all namespaces that shall be traced during templating
     */
    aNamespaces = ["sap.m", "sap.uxap", "sap.ui.unified", "sap.f", "sap.ui.table", "sap.suite.ui.microchart", "sap.ui.layout.form", "sap.ui.mdc", "sap.ui.mdc.link", "sap.ui.mdc.field", "sap.fe.fpm"],
    oCallbacks = {};
  function fnClone(oObject) {
    return JSON.parse(JSON.stringify(oObject));
  }
  async function collectContextInfo(sValue, oContexts, oVisitor, oNode) {
    let aContexts;
    const aPromises = [];
    try {
      aContexts = bindingParser(sValue, undefined, false, true) || [];
    } catch (e) {
      aContexts = [];
    }
    aContexts = Array.isArray(aContexts) ? aContexts : [aContexts];
    aContexts.filter(function (oContext) {
      return oContext.path || oContext.parts;
    }).forEach(function (oContext) {
      const aParts = oContext.parts || [oContext];
      aParts.filter(function (oPartContext) {
        return oPartContext.path;
      }).forEach(function (oPartContext) {
        const oModel = oContexts[oPartContext.model] = oContexts[oPartContext.model] || {};
        const sSimplePath = oPartContext.path.indexOf(">") < 0 ? (oPartContext.model && `${oPartContext.model}>`) + oPartContext.path : oPartContext.path;
        let oRealContext;
        let aInnerParts;
        if (typeof oPartContext.model === "undefined" && sSimplePath.indexOf(">") > -1) {
          aInnerParts = sSimplePath.split(">");
          oPartContext.model = aInnerParts[0];
          oPartContext.path = aInnerParts[1];
        }
        try {
          oRealContext = oVisitor.getContext(sSimplePath);
          const visitorResult = oVisitor.getResult(`{${sSimplePath}}`, oNode);
          aPromises.push(visitorResult.then(function (oResult) {
            var _oRealContext;
            if (((_oRealContext = oRealContext) === null || _oRealContext === void 0 ? void 0 : _oRealContext.getModel().getMetadata().getName()) === "sap.ui.model.json.JSONModel") {
              if (!oResult.getModel()) {
                oModel[oPartContext.path] = oResult; //oRealContext.getObject(oContext.path);
              } else {
                oModel[oPartContext.path] = `Context from ${oResult.getPath()}`;
              }
            } else {
              oModel[oPartContext.path] = {
                path: oRealContext.getPath(),
                data: typeof oResult === "object" ? "[ctrl/cmd-click] on path to see data" : oResult
              };
            }
          }).catch(function () {
            oModel[oPartContext.path] = {
              bindingFor: "Runtime"
            };
          }));
        } catch (exc) {
          oModel[oPartContext.path] = {
            bindingFor: "Runtime"
          };
        }
      });
    });
    return Promise.all(aPromises);
  }
  async function fillAttributes(oResults, oAttributes, sName, sValue) {
    return oResults.then(function (result) {
      oAttributes[sName] = sValue !== result ? {
        originalValue: sValue,
        resolvedValue: result
      } : sValue;
    }).catch(function (e) {
      const error = e;
      oAttributes[sName] = {
        originalValue: sValue,
        error: error.stack && error.stack.toString() || e
      };
    });
  }
  async function collectInfo(oNode, oVisitor) {
    const oAttributes = {};
    const aPromises = [];
    const oContexts = {};
    let oResults;
    for (let i = oNode.attributes.length >>> 0; i--;) {
      const oAttribute = oNode.attributes[i],
        sName = oAttribute.nodeName,
        sValue = oNode.getAttribute(sName);
      if (!["core:require"].includes(sName)) {
        aPromises.push(collectContextInfo(sValue, oContexts, oVisitor, oNode));
        oResults = oVisitor.getResult(sValue, oNode);
        if (oResults) {
          aPromises.push(fillAttributes(oResults, oAttributes, sName, sValue));
        } else {
          //What
        }
      }
    }
    return Promise.all(aPromises).then(function () {
      return {
        properties: oAttributes,
        contexts: oContexts
      };
    });
  }
  async function resolve(oNode, oVisitor) {
    try {
      const sControlName = oNode.nodeName.split(":")[1] || oNode.nodeName,
        bIsControl = /^[A-Z]/.test(sControlName),
        oTraceMetadataContext = {
          isError: false,
          control: `${oNode.namespaceURI}.${oNode.nodeName.split(":")[1] || oNode.nodeName}`,
          metaDataContexts: [],
          properties: {}
        };
      if (bIsControl) {
        const firstChild = [...oNode.ownerDocument.children].find(node => !node.nodeName.startsWith("#"));
        if (firstChild && !firstChild.getAttribute("xmlns:trace")) {
          firstChild.setAttributeNS(xmlns, "xmlns:trace", traceNamespace);
          firstChild.setAttributeNS(traceNamespace, "trace:is", "on");
        }
        return await collectInfo(oNode, oVisitor).then(async function (result) {
          const bRelevant = Object.keys(result.contexts).length > 0; //If no context was used it is not relevant so we ignore Object.keys(result.properties).length
          if (bRelevant) {
            Object.assign(oTraceMetadataContext, result);
            oTraceMetadataContext.viewInfo = oVisitor.getViewInfo();
            oTraceMetadataContext.macroInfo = oVisitor.getSettings()["_macroInfo"];
            oTraceMetadataContext.traceID = aTraceInfo.length;
            oNode.setAttributeNS(traceNamespace, "trace:traceID", oTraceMetadataContext.traceID.toString());
            aTraceInfo.push(oTraceMetadataContext);
          }
          return oVisitor.visitAttributes(oNode);
        }).then(async function () {
          return oVisitor.visitChildNodes(oNode);
        }).catch(function (exc) {
          oTraceMetadataContext.error = {
            exception: exc,
            node: new XMLSerializer().serializeToString(oNode)
          };
        });
      } else {
        await oVisitor.visitAttributes(oNode);
        await oVisitor.visitChildNodes(oNode);
      }
    } catch (exc) {
      Log.error(`Error while tracing '${oNode === null || oNode === void 0 ? void 0 : oNode.nodeName}': ${exc.message}`, "TraceInfo");
      return oVisitor.visitAttributes(oNode).then(async function () {
        return oVisitor.visitChildNodes(oNode);
      });
    }
  }
  /**
   * Register path-through XMLPreprocessor plugin for all namespaces
   * given above in aNamespaces
   */
  if (traceIsOn) {
    aNamespaces.forEach(function (namespace) {
      oCallbacks[namespace] = XMLPreprocessor.plugIn(resolve.bind(namespace), namespace);
    });
  }

  /**
   * Adds information about the processing of one macro to the collection.
   *
   * @name sap.fe.macros.TraceInfo.traceMacroCalls
   * @param sName Macro class name
   * @param oMetadata Definition from (macro).metadata.js
   * @param mContexts Available named contexts
   * @param oNode
   * @param oVisitor
   * @returns The traced metadata context
   * @private
   * @ui5-restricted
   * @static
   */

  function traceMacroCalls(sName, oMetadata, mContexts, oNode, oVisitor) {
    try {
      let aMetadataContextKeys = oMetadata.metadataContexts && Object.keys(oMetadata.metadataContexts) || [];
      const aProperties = oMetadata.properties && Object.keys(oMetadata.properties) || [];
      const macroInfo = fnClone(oVisitor.getSettings()["_macroInfo"] || {});
      const oTraceMetadataContext = {
        isError: false,
        macro: sName,
        metaDataContexts: [],
        properties: {}
      };
      if (aMetadataContextKeys.length === 0) {
        //In case the macro has no metadata.js we take all metadataContexts except this
        aMetadataContextKeys = Object.keys(mContexts).filter(function (name) {
          return name !== "this";
        });
      }
      if (!oNode.getAttribute("xmlns:trace")) {
        oNode.setAttributeNS(xmlns, "xmlns:trace", traceNamespace);
      }
      if (aMetadataContextKeys.length > 0) {
        aMetadataContextKeys.forEach(function (sKey) {
          const oContext = mContexts[sKey],
            oMetaDataContext = oContext && {
              name: sKey,
              path: oContext.getPath()
              //data: JSON.stringify(oContext.getObject(),null,2)
            };

          if (oMetaDataContext) {
            oTraceMetadataContext.metaDataContexts.push(oMetaDataContext);
          }
        });
        aProperties.forEach(function (sKey) {
          const
          //oPropertySettings = oMetadata.properties[sKey],
          oProperty = mContexts.this.getObject(sKey);
          // (oNode.hasAttribute(sKey) && oNode.getAttribute(sKey)) ||
          // (oPropertySettings.hasOwnProperty("defaultValue") && oPropertySettings.define) ||
          // false;

          if (oProperty) {
            oTraceMetadataContext.properties[sKey] = oProperty;
          }
        });
        oTraceMetadataContext.viewInfo = oVisitor.getViewInfo();
        oTraceMetadataContext.traceID = aTraceInfo.length;
        macroInfo.parentMacroID = macroInfo.macroID;
        macroInfo.macroID = oTraceMetadataContext.traceID.toString();
        oTraceMetadataContext.macroInfo = macroInfo;
        oNode.setAttributeNS(traceNamespace, "trace:macroID", oTraceMetadataContext.traceID.toString());
        aTraceInfo.push(oTraceMetadataContext);
        return oTraceMetadataContext;
      }
    } catch (exc) {
      var _oVisitor$getContext;
      return {
        isError: true,
        error: exc,
        name: sName,
        node: new XMLSerializer().serializeToString(oNode),
        contextPath: oVisitor === null || oVisitor === void 0 ? void 0 : (_oVisitor$getContext = oVisitor.getContext()) === null || _oVisitor$getContext === void 0 ? void 0 : _oVisitor$getContext.getPath()
      };
    }
  }
  /**
   * Returns the globally stored trace information for the macro or
   * control marked with the given id.
   *
   * Returns all trace information if no id is specified
   *
   *
  <pre>Structure for a macro
  {
  	macro: '', //name of macro
  	metaDataContexts: [ //Properties of type sap.ui.model.Context
  		{
  			name: '', //context property name / key
  			path: '', //from oContext.getPath()
  		}
  	],
  	properties: { // Other properties which become part of {this>}
  		property1: value,
  		property2: value
  	}
  	viewInfo: {
  		viewInfo: {} // As specified in view or fragment creation
  	},
  	traceID: this.index, //ID for this trace information,
  	macroInfo: {
  		macroID: index, // traceID of this macro (redundant for macros)
  		parentMacroID, index // traceID of the parent macro (if it has a parent)
  	}
  }
  Structure for a control
  {
  	control: '', //control class
  	properties: { // Other properties which become part of {this>}
  		property1: {
  			originalValue: '', //Value before templating
  			resolvedValue: '' //Value after templating
  		}
  	}
  	contexts: { //Models and Contexts used during templating
  		// Model or context name used for this control
  		modelName1: { // For ODataMetaModel
  			path1: {
  				path: '', //absolut path within metamodel
  				data: '', //data of path unless type Object
  			}
  		modelName2: {
  			// for other model types
  			{
  				property1: value,
  				property2: value
  			}
  			// In case binding cannot be resolved -> mark as runtime binding
  			// This is not always true, e.g. in case the path is metamodelpath
  			{
  				"bindingFor": "Runtime"
  			}
  		}
  	},
  	viewInfo: {
  		viewInfo: {} // As specified in view or fragment creation
  	},
  	macroInfo: {
  		macroID: index, // traceID of the macro that created this control
  		parentMacroID, index // traceID of the macro's parent macro
  	},
  	traceID: this.index //ID for this trace information
  }</pre>.
   *
   * @function
   * @name sap.fe.macros.TraceInfo.getTraceInfo
   * @param id TraceInfo id
   * @returns Object / Array for TraceInfo
   * @private
   * @static
   */
  function getTraceInfo(id) {
    if (id) {
      return aTraceInfo[id];
    }
    const aErrors = aTraceInfo.filter(function (traceInfo) {
      return traceInfo.error;
    });
    return aErrors.length > 0 && aErrors || aTraceInfo;
  }
  /**
   * Returns true if TraceInfo is active.
   *
   * @function
   * @name sap.fe.macros.TraceInfo.isTraceInfoActive
   * @returns `true` when active
   * @private
   * @static
   */
  function isTraceInfoActive() {
    return traceIsOn;
  }
  /**
   * @typedef sap.fe.macros.TraceInfo
   * TraceInfo for SAP Fiori elements
   *
   * Once traces is switched, information about macros and controls
   * that are processed during xml preprocessing ( @see {@link sap.ui.core.util.XMLPreprocessor})
   * will be collected within this singleton
   * @namespace
   * @private
   * @global
   * @experimental This module is only for experimental use! <br/><b>This is only a POC and maybe deleted</b>
   * @since 1.74.0
   */
  return {
    isTraceInfoActive: isTraceInfoActive,
    traceMacroCalls: traceMacroCalls,
    getTraceInfo: getTraceInfo
  };
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/buildingBlocks/TraceInfo", ["sap/base/Log","sap/ui/base/ManagedObject","sap/ui/core/util/XMLPreprocessor"],function(t,e,n){"use strict";var r=e.bindingParser;const i=[];const o="http://schemas.sap.com/sapui5/extension/sap.fe.info/1",a="http://www.w3.org/2000/xmlns/",s=location.search.indexOf("sap-ui-xx-feTraceInfo=true")>-1,c=["sap.m","sap.uxap","sap.ui.unified","sap.f","sap.ui.table","sap.suite.ui.microchart","sap.ui.layout.form","sap.ui.mdc","sap.ui.mdc.link","sap.ui.mdc.field","sap.fe.fpm"],u={};function f(t){return JSON.parse(JSON.stringify(t))}async function l(t,e,n,i){let o;const a=[];try{o=r(t,undefined,false,true)||[]}catch(t){o=[]}o=Array.isArray(o)?o:[o];o.filter(function(t){return t.path||t.parts}).forEach(function(t){const r=t.parts||[t];r.filter(function(t){return t.path}).forEach(function(t){const r=e[t.model]=e[t.model]||{};const o=t.path.indexOf(">")<0?(t.model&&`${t.model}>`)+t.path:t.path;let s;let c;if(typeof t.model==="undefined"&&o.indexOf(">")>-1){c=o.split(">");t.model=c[0];t.path=c[1]}try{s=n.getContext(o);const e=n.getResult(`{${o}}`,i);a.push(e.then(function(e){var n;if(((n=s)===null||n===void 0?void 0:n.getModel().getMetadata().getName())==="sap.ui.model.json.JSONModel"){if(!e.getModel()){r[t.path]=e}else{r[t.path]=`Context from ${e.getPath()}`}}else{r[t.path]={path:s.getPath(),data:typeof e==="object"?"[ctrl/cmd-click] on path to see data":e}}}).catch(function(){r[t.path]={bindingFor:"Runtime"}}))}catch(e){r[t.path]={bindingFor:"Runtime"}}})});return Promise.all(a)}async function p(t,e,n,r){return t.then(function(t){e[n]=r!==t?{originalValue:r,resolvedValue:t}:r}).catch(function(t){const i=t;e[n]={originalValue:r,error:i.stack&&i.stack.toString()||t}})}async function h(t,e){const n={};const r=[];const i={};let o;for(let a=t.attributes.length>>>0;a--;){const s=t.attributes[a],c=s.nodeName,u=t.getAttribute(c);if(!["core:require"].includes(c)){r.push(l(u,i,e,t));o=e.getResult(u,t);if(o){r.push(p(o,n,c,u))}else{}}}return Promise.all(r).then(function(){return{properties:n,contexts:i}})}async function d(e,n){try{const t=e.nodeName.split(":")[1]||e.nodeName,r=/^[A-Z]/.test(t),s={isError:false,control:`${e.namespaceURI}.${e.nodeName.split(":")[1]||e.nodeName}`,metaDataContexts:[],properties:{}};if(r){const t=[...e.ownerDocument.children].find(t=>!t.nodeName.startsWith("#"));if(t&&!t.getAttribute("xmlns:trace")){t.setAttributeNS(a,"xmlns:trace",o);t.setAttributeNS(o,"trace:is","on")}return await h(e,n).then(async function(t){const r=Object.keys(t.contexts).length>0;if(r){Object.assign(s,t);s.viewInfo=n.getViewInfo();s.macroInfo=n.getSettings()["_macroInfo"];s.traceID=i.length;e.setAttributeNS(o,"trace:traceID",s.traceID.toString());i.push(s)}return n.visitAttributes(e)}).then(async function(){return n.visitChildNodes(e)}).catch(function(t){s.error={exception:t,node:(new XMLSerializer).serializeToString(e)}})}else{await n.visitAttributes(e);await n.visitChildNodes(e)}}catch(r){t.error(`Error while tracing '${e===null||e===void 0?void 0:e.nodeName}': ${r.message}`,"TraceInfo");return n.visitAttributes(e).then(async function(){return n.visitChildNodes(e)})}}if(s){c.forEach(function(t){u[t]=n.plugIn(d.bind(t),t)})}function m(t,e,n,r,s){try{let c=e.metadataContexts&&Object.keys(e.metadataContexts)||[];const u=e.properties&&Object.keys(e.properties)||[];const l=f(s.getSettings()["_macroInfo"]||{});const p={isError:false,macro:t,metaDataContexts:[],properties:{}};if(c.length===0){c=Object.keys(n).filter(function(t){return t!=="this"})}if(!r.getAttribute("xmlns:trace")){r.setAttributeNS(a,"xmlns:trace",o)}if(c.length>0){c.forEach(function(t){const e=n[t],r=e&&{name:t,path:e.getPath()};if(r){p.metaDataContexts.push(r)}});u.forEach(function(t){const e=n.this.getObject(t);if(e){p.properties[t]=e}});p.viewInfo=s.getViewInfo();p.traceID=i.length;l.parentMacroID=l.macroID;l.macroID=p.traceID.toString();p.macroInfo=l;r.setAttributeNS(o,"trace:macroID",p.traceID.toString());i.push(p);return p}}catch(e){var c;return{isError:true,error:e,name:t,node:(new XMLSerializer).serializeToString(r),contextPath:s===null||s===void 0?void 0:(c=s.getContext())===null||c===void 0?void 0:c.getPath()}}}function g(t){if(t){return i[t]}const e=i.filter(function(t){return t.error});return e.length>0&&e||i}function b(){return s}return{isTraceInfoActive:b,traceMacroCalls:m,getTraceInfo:g}},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/BusyLocker-dbg", ["sap/base/Log"], function (Log) {
  "use strict";

  const _iTimeoutInSeconds = 30,
    _mLockCounters = {},
    _oReferenceDummy = {
      getId: function () {
        return "BusyLocker.ReferenceDummy";
      },
      setBusy: function (bBusy) {
        Log.info(`setBusy(${bBusy}) triggered on dummy reference`);
      }
    };
  function getLockCountId(oReference, sPath) {
    return oReference.getId() + (sPath || "/busy");
  }
  function isLocked(oReference, sPath) {
    return getLockCountId(oReference, sPath) in _mLockCounters;
  }
  function getLockCountEntry(oReference, sPath) {
    if (!oReference || !oReference.getId) {
      Log.warning("No reference for BusyLocker, using dummy reference");
      oReference = _oReferenceDummy;
    }
    sPath = sPath || "/busy";
    const sId = getLockCountId(oReference, sPath);
    if (!(sId in _mLockCounters)) {
      _mLockCounters[sId] = {
        id: sId,
        path: sPath,
        reference: oReference,
        count: 0
      };
    }
    return _mLockCounters[sId];
  }
  /**
   * @param mLockCountEntry
   */
  function deleteLockCountEntry(mLockCountEntry) {
    delete _mLockCounters[mLockCountEntry.id];
  }
  function applyLockState(mLockCountEntry) {
    const bIsModel = mLockCountEntry.reference.isA && mLockCountEntry.reference.isA("sap.ui.model.Model"),
      bBusy = mLockCountEntry.count !== 0;
    if (bIsModel) {
      mLockCountEntry.reference.setProperty(mLockCountEntry.path, bBusy, undefined, true);
    } else if (mLockCountEntry.reference.setBusy) {
      mLockCountEntry.reference.setBusy(bBusy);
    }
    clearTimeout(mLockCountEntry.timeout);
    if (bBusy) {
      mLockCountEntry.timeout = setTimeout(function () {
        Log.error(`busy lock for ${mLockCountEntry.id} with value ${mLockCountEntry.count} timed out after ${_iTimeoutInSeconds} seconds!`);
      }, _iTimeoutInSeconds * 1000);
    } else {
      deleteLockCountEntry(mLockCountEntry);
    }
    return bBusy;
  }
  function changeLockCount(mLockCountEntry, iDelta) {
    if (iDelta === 0) {
      mLockCountEntry.count = 0;
      Log.info(`busy lock count '${mLockCountEntry.id}' was reset to 0`);
    } else {
      mLockCountEntry.count += iDelta;
      Log.info(`busy lock count '${mLockCountEntry.id}' is ${mLockCountEntry.count}`);
    }
  }
  const BusyLocker = {
    lock: function (oModelOrControl, sPath) {
      return this._updateLock(oModelOrControl, sPath, 1);
    },
    unlock: function (oModelOrControl, sPath) {
      return this._updateLock(oModelOrControl, sPath, -1);
    },
    isLocked: function (oModelOrControl, sPath) {
      return isLocked(oModelOrControl, sPath);
    },
    _updateLock: function (oReference, sPath, iDelta) {
      const mLockCountEntry = getLockCountEntry(oReference, sPath);
      changeLockCount(mLockCountEntry, iDelta);
      return applyLockState(mLockCountEntry);
    }
  };
  return BusyLocker;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/BusyLocker", ["sap/base/Log"],function(e){"use strict";const n=30,t={},u={getId:function(){return"BusyLocker.ReferenceDummy"},setBusy:function(n){e.info(`setBusy(${n}) triggered on dummy reference`)}};function o(e,n){return e.getId()+(n||"/busy")}function r(e,n){return o(e,n)in t}function c(n,r){if(!n||!n.getId){e.warning("No reference for BusyLocker, using dummy reference");n=u}r=r||"/busy";const c=o(n,r);if(!(c in t)){t[c]={id:c,path:r,reference:n,count:0}}return t[c]}function i(e){delete t[e.id]}function s(t){const u=t.reference.isA&&t.reference.isA("sap.ui.model.Model"),o=t.count!==0;if(u){t.reference.setProperty(t.path,o,undefined,true)}else if(t.reference.setBusy){t.reference.setBusy(o)}clearTimeout(t.timeout);if(o){t.timeout=setTimeout(function(){e.error(`busy lock for ${t.id} with value ${t.count} timed out after ${n} seconds!`)},n*1e3)}else{i(t)}return o}function f(n,t){if(t===0){n.count=0;e.info(`busy lock count '${n.id}' was reset to 0`)}else{n.count+=t;e.info(`busy lock count '${n.id}' is ${n.count}`)}}const d={lock:function(e,n){return this._updateLock(e,n,1)},unlock:function(e,n){return this._updateLock(e,n,-1)},isLocked:function(e,n){return r(e,n)},_updateLock:function(e,n,t){const u=c(e,n);f(u,t);return s(u)}};return d},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/EditFlow-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/controllerextensions/collaboration/ActivitySync", "sap/fe/core/controllerextensions/collaboration/CollaborationCommon", "sap/fe/core/controllerextensions/editFlow/draft", "sap/fe/core/controllerextensions/Feedback", "sap/fe/core/converters/MetaModelConverter", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/EditState", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/helpers/SemanticKeyHelper", "sap/fe/core/library", "sap/ui/core/Core", "sap/ui/core/library", "sap/ui/core/message/Message", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "sap/ui/model/odata/v4/ODataListBinding", "../ActionRuntime"], function (Log, CommonUtils, BusyLocker, ActivitySync, CollaborationCommon, draft, Feedback, MetaModelConverter, ClassSupport, EditState, ModelHelper, SemanticKeyHelper, FELibrary, Core, coreLibrary, Message, ControllerExtension, OverrideExecution, ODataListBinding, ActionRuntime) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _dec22, _dec23, _dec24, _dec25, _dec26, _dec27, _dec28, _dec29, _dec30, _dec31, _dec32, _dec33, _dec34, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  var TriggerType = Feedback.TriggerType;
  var triggerConfiguredSurvey = Feedback.triggerConfiguredSurvey;
  var StandardActions = Feedback.StandardActions;
  var shareObject = CollaborationCommon.shareObject;
  var Activity = CollaborationCommon.Activity;
  var send = ActivitySync.send;
  var isConnected = ActivitySync.isConnected;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  const CreationMode = FELibrary.CreationMode,
    ProgrammingModel = FELibrary.ProgrammingModel,
    Constants = FELibrary.Constants,
    DraftStatus = FELibrary.DraftStatus,
    EditMode = FELibrary.EditMode,
    StartupMode = FELibrary.StartupMode,
    MessageType = coreLibrary.MessageType;

  /**
   * A controller extension offering hooks into the edit flow of the application
   *
   * @hideconstructor
   * @public
   * @since 1.90.0
   */
  let EditFlow = (_dec = defineUI5Class("sap.fe.core.controllerextensions.EditFlow"), _dec2 = publicExtension(), _dec3 = finalExtension(), _dec4 = publicExtension(), _dec5 = finalExtension(), _dec6 = publicExtension(), _dec7 = finalExtension(), _dec8 = publicExtension(), _dec9 = finalExtension(), _dec10 = publicExtension(), _dec11 = extensible(OverrideExecution.After), _dec12 = publicExtension(), _dec13 = extensible(OverrideExecution.After), _dec14 = publicExtension(), _dec15 = extensible(OverrideExecution.After), _dec16 = publicExtension(), _dec17 = extensible(OverrideExecution.After), _dec18 = publicExtension(), _dec19 = extensible(OverrideExecution.After), _dec20 = publicExtension(), _dec21 = finalExtension(), _dec22 = publicExtension(), _dec23 = finalExtension(), _dec24 = publicExtension(), _dec25 = finalExtension(), _dec26 = publicExtension(), _dec27 = finalExtension(), _dec28 = publicExtension(), _dec29 = finalExtension(), _dec30 = publicExtension(), _dec31 = finalExtension(), _dec32 = publicExtension(), _dec33 = finalExtension(), _dec34 = publicExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(EditFlow, _ControllerExtension);
    function EditFlow() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = EditFlow.prototype;
    //////////////////////////////////////
    // Public methods
    //////////////////////////////////////
    _proto.getAppComponent = function getAppComponent() {
      return this.base.getAppComponent();
    }
    /**
     * Gets the InternalEditFlow extension.
     *
     * @returns The internalEditFlow controller extension
     */;
    _proto.getInternalEditFlow = function getInternalEditFlow() {
      return this.base.getView().getController()._editFlow;
    }

    /**
     * Creates a draft document for an existing active document.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param oContext Context of the active document
     * @returns Promise resolves once the editable document is available
     * @alias sap.fe.core.controllerextensions.EditFlow#editDocument
     * @public
     * @since 1.90.0
     */;
    _proto.editDocument = async function editDocument(oContext) {
      const bDraftNavigation = true;
      const transactionHelper = this._getTransactionHelper();
      const oRootViewController = this._getRootViewController();
      const model = oContext.getModel();
      let rightmostContext, siblingInfo;
      const oViewData = this.getView().getViewData();
      const sProgrammingModel = this._getProgrammingModel(oContext);
      let oRootContext = oContext;
      const oView = this.getView();
      try {
        if ((oViewData === null || oViewData === void 0 ? void 0 : oViewData.viewLevel) > 1) {
          if (sProgrammingModel === ProgrammingModel.Draft) {
            const draftRootPath = ModelHelper.getDraftRootPath(oContext);
            oRootContext = oView.getModel().bindContext(draftRootPath).getBoundContext();
            await oRootContext.requestObject(draftRootPath);
          } else if (sProgrammingModel === ProgrammingModel.Sticky) {
            const sStickyRootPath = ModelHelper.getStickyRootPath(oContext);
            oRootContext = oView.getModel().bindContext(sStickyRootPath).getBoundContext();
            await oRootContext.requestObject(sStickyRootPath);
          }
        }
        await this.base.editFlow.onBeforeEdit({
          context: oRootContext
        });
        const oNewDocumentContext = await transactionHelper.editDocument(oRootContext, this.getView(), this.getAppComponent(), this._getMessageHandler());
        this._setStickySessionInternalProperties(sProgrammingModel, model);
        if (oNewDocumentContext) {
          this._setEditMode(EditMode.Editable, false);
          this._setDocumentModified(false);
          this._getMessageHandler().showMessageDialog();
          if (oNewDocumentContext !== oRootContext) {
            let contextToNavigate = oNewDocumentContext;
            if (this._isFclEnabled()) {
              rightmostContext = oRootViewController.getRightmostContext();
              siblingInfo = await this._computeSiblingInformation(oRootContext, rightmostContext, sProgrammingModel, true);
              siblingInfo = siblingInfo ?? this._createSiblingInfo(oContext, oNewDocumentContext);
              this._updatePathsInHistory(siblingInfo.pathMapping);
              if (siblingInfo.targetContext.getPath() != oNewDocumentContext.getPath()) {
                contextToNavigate = siblingInfo.targetContext;
              }
            } else if ((oViewData === null || oViewData === void 0 ? void 0 : oViewData.viewLevel) > 1) {
              siblingInfo = await this._computeSiblingInformation(oRootContext, oContext, sProgrammingModel, true);
              contextToNavigate = this._getNavigationTargetForEdit(oContext, oNewDocumentContext, siblingInfo);
            }
            await this._handleNewContext(contextToNavigate, true, false, bDraftNavigation, true);
            if (sProgrammingModel === ProgrammingModel.Sticky) {
              // The stickyOn handler must be set after the navigation has been done,
              // as the URL may change in the case of FCL
              let stickyContext;
              if (this._isFclEnabled()) {
                // We need to use the kept-alive context used to bind the page
                stickyContext = oNewDocumentContext.getModel().getKeepAliveContext(oNewDocumentContext.getPath());
              } else {
                stickyContext = oNewDocumentContext;
              }
              this._handleStickyOn(stickyContext);
            } else if (ModelHelper.isCollaborationDraftSupported(model.getMetaModel())) {
              // according to UX in case of enabled collaboration draft we share the object immediately
              await shareObject(oNewDocumentContext);
            }
          }
        }
      } catch (oError) {
        Log.error("Error while editing the document", oError);
      }
    };
    _proto.deleteMultipleDocuments = function deleteMultipleDocuments(aContexts, mParameters) {
      if (mParameters) {
        mParameters.beforeDeleteCallBack = this.base.editFlow.onBeforeDelete;
      } else {
        mParameters = {
          beforeDeleteCallBack: this.base.editFlow.onBeforeDelete
        };
      }
      return this.getInternalEditFlow().deleteMultipleDocuments(aContexts, mParameters);
    }

    /**
     * Updates the draft status and displays the error messages if there are errors during an update.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param updatedContext Context of the updated field
     * @param updatePromise Promise to determine when the update operation is completed. The promise should be resolved when the update operation is completed, so the draft status can be updated.
     * @returns Promise resolves once draft status has been updated
     * @alias sap.fe.core.controllerextensions.EditFlow#updateDocument
     * @public
     * @since 1.90.0
     */;
    _proto.updateDocument = function updateDocument(updatedContext, updatePromise) {
      const originalBindingContext = this.getView().getBindingContext();
      const isDraft = this._getProgrammingModel(updatedContext) === ProgrammingModel.Draft;
      this._getMessageHandler().removeTransitionMessages();
      return this._syncTask(async () => {
        if (originalBindingContext) {
          this._setDocumentModified(true);
          if (!this._isFclEnabled()) {
            EditState.setEditStateDirty();
          }
          if (isDraft) {
            this._setDraftStatus(DraftStatus.Saving);
          }
        }
        try {
          await updatePromise;
          const currentBindingContext = this.getView().getBindingContext();
          if (!isDraft || !currentBindingContext || currentBindingContext !== originalBindingContext) {
            // If a navigation happened while oPromise was being resolved, the binding context of the page changed
            return;
          }

          // We're still on the same context
          const metaModel = currentBindingContext.getModel().getMetaModel();
          const entitySetName = metaModel.getMetaContext(currentBindingContext.getPath()).getObject("@sapui.name");
          const semanticKeys = SemanticKeyHelper.getSemanticKeys(metaModel, entitySetName);
          if (semanticKeys !== null && semanticKeys !== void 0 && semanticKeys.length) {
            const currentSemanticMapping = this._getSemanticMapping();
            const currentSemanticPath = currentSemanticMapping === null || currentSemanticMapping === void 0 ? void 0 : currentSemanticMapping.semanticPath,
              sChangedPath = SemanticKeyHelper.getSemanticPath(currentBindingContext, true);
            // currentSemanticPath could be null if we have navigated via deep link then there are no semanticMappings to calculate it from
            if (currentSemanticPath && currentSemanticPath !== sChangedPath) {
              await this._handleNewContext(currentBindingContext, true, false, true);
            }
          }
          this._setDraftStatus(DraftStatus.Saved);
        } catch (error) {
          Log.error("Error while updating the document", error);
          if (isDraft && originalBindingContext) {
            this._setDraftStatus(DraftStatus.Clear);
          }
        } finally {
          await this._getMessageHandler().showMessages();
        }
      });
    }

    // Internal only params ---
    // * @param {string} mParameters.creationMode The creation mode using one of the following:
    // *                    Sync - the creation is triggered and once the document is created, the navigation is done
    // *                    Async - the creation and the navigation to the instance are done in parallel
    // *                    Deferred - the creation is done on the target page
    // *                    CreationRow - The creation is done inline async so the user is not blocked
    // mParameters.creationRow Instance of the creation row - (TODO: get rid but use list bindings only)

    /**
     * Creates a new document.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param vListBinding  ODataListBinding object or the binding path for a temporary list binding
     * @param mInParameters Contains the following attributes:
     * @param mInParameters.creationMode The creation mode using one of the following:
     *                    NewPage - the created document is shown in a new page, depending on whether metadata 'Sync', 'Async' or 'Deferred' is used
     *                    Inline - The creation is done inline (in a table)
     *                    External - The creation is done in a different application specified via the parameter 'outbound'
     * @param mInParameters.outbound The navigation target where the document is created in case of creationMode 'External'
     * @param mInParameters.createAtEnd Specifies if the new entry should be created at the top or bottom of a table in case of creationMode 'Inline'
     * @returns Promise resolves once the object has been created
     * @alias sap.fe.core.controllerextensions.EditFlow#createDocument
     * @public
     * @since 1.90.0
     */;
    _proto.createDocument = async function createDocument(vListBinding, mInParameters) {
      const transactionHelper = this._getTransactionHelper(),
        oLockObject = this._getGlobalUIModel();
      let oTable; //should be Table but there are missing methods into the def
      let mParameters = mInParameters;
      const bShouldBusyLock = !mParameters || mParameters.creationMode !== CreationMode.Inline && mParameters.creationMode !== CreationMode.CreationRow && mParameters.creationMode !== CreationMode.External;
      let oExecCustomValidation = Promise.resolve([]);
      const oAppComponent = CommonUtils.getAppComponent(this.getView());
      oAppComponent.getRouterProxy().removeIAppStateKey();
      if (mParameters.creationMode === CreationMode.External) {
        // Create by navigating to an external target
        // TODO: Call appropriate function (currently using the same as for outbound chevron nav, and without any context - 3rd param)
        await this._syncTask();
        const oController = this.getView().getController();
        const sCreatePath = ModelHelper.getAbsoluteMetaPathForListBinding(this.getView(), vListBinding);
        oController.handlers.onChevronPressNavigateOutBound(oController, mParameters.outbound, undefined, sCreatePath);
        return;
      }
      if (mParameters.creationMode === CreationMode.CreationRow && mParameters.creationRow) {
        const oCreationRowObjects = mParameters.creationRow.getBindingContext().getObject();
        delete oCreationRowObjects["@$ui5.context.isTransient"];
        oTable = mParameters.creationRow.getParent();
        oExecCustomValidation = transactionHelper.validateDocument(oTable.getBindingContext(), {
          data: oCreationRowObjects,
          customValidationFunction: oTable.getCreationRow().data("customValidationFunction")
        }, this.base.getView());

        // disableAddRowButtonForEmptyData is set to false in manifest converter (Table.ts) if customValidationFunction exists
        if (oTable.getCreationRow().data("disableAddRowButtonForEmptyData") === "true") {
          const oInternalModelContext = oTable.getBindingContext("internal");
          oInternalModelContext.setProperty("creationRowFieldValidity", {});
        }
      }
      if (mParameters.creationMode === CreationMode.Inline && mParameters.tableId) {
        oTable = this.getView().byId(mParameters.tableId);
      }
      if (oTable && oTable.isA("sap.ui.mdc.Table")) {
        const fnFocusOrScroll = mParameters.creationMode === CreationMode.Inline ? oTable.focusRow.bind(oTable) : oTable.scrollToIndex.bind(oTable);
        oTable.getRowBinding().attachEventOnce("change", function () {
          fnFocusOrScroll(mParameters.createAtEnd ? oTable.getRowBinding().getLength() : 0, true);
        });
      }
      const handleSideEffects = async (oListBinding, oCreationPromise) => {
        try {
          const oNewContext = await oCreationPromise;
          // transient contexts are reliably removed once oNewContext.created() is resolved
          await oNewContext.created();
          const oBindingContext = this.getView().getBindingContext();
          // if there are transient contexts, we must avoid requesting side effects
          // this is avoid a potential list refresh, there could be a side effect that refreshes the list binding
          // if list binding is refreshed, transient contexts might be lost
          if (!CommonUtils.hasTransientContext(oListBinding)) {
            const appComponent = CommonUtils.getAppComponent(this.getView());
            appComponent.getSideEffectsService().requestSideEffectsForNavigationProperty(oListBinding.getPath(), oBindingContext);
          }
        } catch (oError) {
          Log.error("Error while creating the document", oError);
        }
      };

      /**
       * @param aValidationMessages Error messages from custom validation function
       */
      const createCustomValidationMessages = aValidationMessages => {
        var _oTable$getBindingCon;
        const sCustomValidationFunction = oTable && oTable.getCreationRow().data("customValidationFunction");
        const mCustomValidity = oTable && ((_oTable$getBindingCon = oTable.getBindingContext("internal")) === null || _oTable$getBindingCon === void 0 ? void 0 : _oTable$getBindingCon.getProperty("creationRowCustomValidity"));
        const oMessageManager = Core.getMessageManager();
        const aCustomMessages = [];
        let oFieldControl;
        let sTarget;

        // Remove existing CustomValidation message
        oMessageManager.getMessageModel().getData().forEach(function (oMessage) {
          if (oMessage.code === sCustomValidationFunction) {
            oMessageManager.removeMessages(oMessage);
          }
        });
        aValidationMessages.forEach(oValidationMessage => {
          // Handle Bound CustomValidation message
          if (oValidationMessage.messageTarget) {
            var _oFieldControl$getBin;
            oFieldControl = Core.getControl(mCustomValidity[oValidationMessage.messageTarget].fieldId);
            sTarget = `${(_oFieldControl$getBin = oFieldControl.getBindingContext()) === null || _oFieldControl$getBin === void 0 ? void 0 : _oFieldControl$getBin.getPath()}/${oFieldControl.getBindingPath("value")}`;
            // Add validation message if still not exists
            if (oMessageManager.getMessageModel().getData().filter(function (oMessage) {
              return oMessage.target === sTarget;
            }).length === 0) {
              oMessageManager.addMessages(new Message({
                message: oValidationMessage.messageText,
                processor: this.getView().getModel(),
                type: MessageType.Error,
                code: sCustomValidationFunction,
                technical: false,
                persistent: false,
                target: sTarget
              }));
            }
            // Add controlId in order to get the focus handling of the error popover runable
            const aExistingValidationMessages = oMessageManager.getMessageModel().getData().filter(function (oMessage) {
              return oMessage.target === sTarget;
            });
            aExistingValidationMessages[0].addControlId(mCustomValidity[oValidationMessage.messageTarget].fieldId);

            // Handle Unbound CustomValidation message
          } else {
            aCustomMessages.push({
              code: sCustomValidationFunction,
              text: oValidationMessage.messageText,
              persistent: true,
              type: MessageType.Error
            });
          }
        });
        if (aCustomMessages.length > 0) {
          this._getMessageHandler().showMessageDialog({
            customMessages: aCustomMessages
          });
        }
      };
      const resolveCreationMode = (initialCreationMode, programmingModel, oListBinding, oMetaModel) => {
        if (initialCreationMode && initialCreationMode !== CreationMode.NewPage) {
          // use the passed creation mode
          return initialCreationMode;
        } else {
          // NewAction is not yet supported for NavigationProperty collection
          if (!oListBinding.isRelative()) {
            const sPath = oListBinding.getPath(),
              // if NewAction with parameters is present, then creation is 'Deferred'
              // in the absence of NewAction or NewAction with parameters, creation is async
              sNewAction = programmingModel === ProgrammingModel.Draft ? oMetaModel.getObject(`${sPath}@com.sap.vocabularies.Common.v1.DraftRoot/NewAction`) : oMetaModel.getObject(`${sPath}@com.sap.vocabularies.Session.v1.StickySessionSupported/NewAction`);
            if (sNewAction) {
              const aParameters = oMetaModel.getObject(`/${sNewAction}/@$ui5.overload/0/$Parameter`) || [];
              // binding parameter (eg: _it) is not considered
              if (aParameters.length > 1) {
                return CreationMode.Deferred;
              }
            }
          }
          const sMetaPath = oMetaModel.getMetaPath(oListBinding === null || oListBinding === void 0 ? void 0 : oListBinding.getHeaderContext().getPath());
          const aNonComputedVisibleKeyFields = CommonUtils.getNonComputedVisibleFields(oMetaModel, sMetaPath, this.getView());
          if (aNonComputedVisibleKeyFields.length > 0) {
            return CreationMode.Deferred;
          }
          return CreationMode.Async;
        }
      };
      if (bShouldBusyLock) {
        BusyLocker.lock(oLockObject);
      }
      try {
        const aValidationMessages = await this._syncTask(oExecCustomValidation);
        if (aValidationMessages.length > 0) {
          createCustomValidationMessages(aValidationMessages);
          Log.error("Custom Validation failed");
          // if custom validation fails, we leave the method immediately
          return;
        }
        let oListBinding;
        mParameters = mParameters || {};
        if (vListBinding && typeof vListBinding === "object") {
          // we already get a list binding use this one
          oListBinding = vListBinding;
        } else if (typeof vListBinding === "string") {
          oListBinding = new ODataListBinding(this.getView().getModel(), vListBinding);
          mParameters.creationMode = CreationMode.Sync;
          delete mParameters.createAtEnd;
        } else {
          throw new Error("Binding object or path expected");
        }
        const oModel = oListBinding.getModel();
        const sProgrammingModel = this._getProgrammingModel(oListBinding);
        const resolvedCreationMode = resolveCreationMode(mParameters.creationMode, sProgrammingModel, oListBinding, oModel.getMetaModel());
        let oCreation;
        let mArgs;
        const oCreationRow = mParameters.creationRow;
        let oCreationRowContext;
        let oPayload;
        let sMetaPath;
        const oMetaModel = oModel.getMetaModel();
        const oRoutingListener = this._getRoutingListener();
        if (resolvedCreationMode !== CreationMode.Deferred) {
          if (resolvedCreationMode === CreationMode.CreationRow) {
            oCreationRowContext = oCreationRow.getBindingContext();
            sMetaPath = oMetaModel.getMetaPath(oCreationRowContext.getPath());
            // prefill data from creation row
            oPayload = oCreationRowContext.getObject();
            mParameters.data = {};
            Object.keys(oPayload).forEach(function (sPropertyPath) {
              const oProperty = oMetaModel.getObject(`${sMetaPath}/${sPropertyPath}`);
              // ensure navigation properties are not part of the payload, deep create not supported
              if (oProperty && oProperty.$kind === "NavigationProperty") {
                return;
              }
              mParameters.data[sPropertyPath] = oPayload[sPropertyPath];
            });
            await this._checkForValidationErrors( /*oCreationRowContext*/);
          }
          if (resolvedCreationMode === CreationMode.CreationRow || resolvedCreationMode === CreationMode.Inline) {
            var _oTable, _oTable$getParent, _oTable$getParent$get;
            mParameters.keepTransientContextOnFailed = false; // currently not fully supported
            // busy handling shall be done locally only
            mParameters.busyMode = "Local";
            mParameters.busyId = (_oTable = oTable) === null || _oTable === void 0 ? void 0 : (_oTable$getParent = _oTable.getParent()) === null || _oTable$getParent === void 0 ? void 0 : (_oTable$getParent$get = _oTable$getParent.getTableDefinition()) === null || _oTable$getParent$get === void 0 ? void 0 : _oTable$getParent$get.annotation.id;

            // take care on message handling, draft indicator (in case of draft)
            // Attach the create sent and create completed event to the object page binding so that we can react
            this._handleCreateEvents(oListBinding);
          }
          if (!mParameters.parentControl) {
            mParameters.parentControl = this.getView();
          }
          mParameters.beforeCreateCallBack = this.base.editFlow.onBeforeCreate;

          // In case the application was called with preferredMode=autoCreateWith, we want to skip the
          // action parameter dialog
          mParameters.skipParameterDialog = oAppComponent.getStartupMode() === StartupMode.AutoCreate;
          oCreation = transactionHelper.createDocument(oListBinding, mParameters, this.getAppComponent(), this._getMessageHandler(), false, this.getView());
        }
        let oNavigation;
        switch (resolvedCreationMode) {
          case CreationMode.Deferred:
            oNavigation = oRoutingListener.navigateForwardToContext(oListBinding, {
              bDeferredContext: true,
              editable: true,
              bForceFocus: true
            });
            break;
          case CreationMode.Async:
            oNavigation = oRoutingListener.navigateForwardToContext(oListBinding, {
              asyncContext: oCreation,
              editable: true,
              bForceFocus: true
            });
            break;
          case CreationMode.Sync:
            mArgs = {
              editable: true,
              bForceFocus: true
            };
            if (sProgrammingModel == ProgrammingModel.Sticky || mParameters.createAction) {
              mArgs.transient = true;
            }
            oNavigation = oCreation.then(function (oNewDocumentContext) {
              if (!oNewDocumentContext) {
                const coreResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
                return oRoutingListener.navigateToMessagePage(coreResourceBundle.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR"), {
                  title: coreResourceBundle.getText("C_COMMON_SAPFE_ERROR"),
                  description: coreResourceBundle.getText("C_EDITFLOW_SAPFE_CREATION_FAILED_DESCRIPTION")
                });
              } else {
                // In case the Sync creation was triggered for a deferred creation, we don't navigate forward
                // as we're already on the corresponding ObjectPage
                return mParameters.bFromDeferred ? oRoutingListener.navigateToContext(oNewDocumentContext, mArgs) : oRoutingListener.navigateForwardToContext(oNewDocumentContext, mArgs);
              }
            });
            break;
          case CreationMode.Inline:
            handleSideEffects(oListBinding, oCreation);
            this._syncTask(oCreation);
            break;
          case CreationMode.CreationRow:
            // the creation row shall be cleared once the validation check was successful and
            // therefore the POST can be sent async to the backend
            try {
              const oCreationRowListBinding = oCreationRowContext.getBinding();
              if (!mParameters.bSkipSideEffects) {
                handleSideEffects(oListBinding, oCreation);
              }
              const oNewTransientContext = oCreationRowListBinding.create();
              oCreationRow.setBindingContext(oNewTransientContext);

              // this is needed to avoid console errors TO be checked with model colleagues
              oNewTransientContext.created().catch(function () {
                Log.trace("transient fast creation context deleted");
              });
              oNavigation = oCreationRowContext.delete("$direct");
            } catch (oError) {
              // Reset busy indicator after a validation error
              if (BusyLocker.isLocked(this.getView().getModel("ui"))) {
                BusyLocker.unlock(this.getView().getModel("ui"));
              }
              Log.error("CreationRow navigation error: ", oError);
            }
            break;
          default:
            oNavigation = Promise.reject(`Unhandled creationMode ${resolvedCreationMode}`);
            break;
        }
        if (oCreation) {
          try {
            const aParams = await Promise.all([oCreation, oNavigation]);
            this._setStickySessionInternalProperties(sProgrammingModel, oModel);
            this._setEditMode(EditMode.Editable); // The createMode flag will be set in InternalEditFlow#computeEditMode
            if (!oListBinding.isRelative() && sProgrammingModel === ProgrammingModel.Sticky) {
              var _entitySet$annotation, _entitySet$annotation2;
              // Workaround to tell the OP that we've created a new object from the LR
              const metaModel = oListBinding.getModel().getMetaModel();
              const metaContext = metaModel.bindContext(metaModel.getMetaPath(oListBinding.getPath()));
              const entitySet = getInvolvedDataModelObjects(metaContext).startingEntitySet;
              const newAction = entitySet === null || entitySet === void 0 ? void 0 : (_entitySet$annotation = entitySet.annotations.Session) === null || _entitySet$annotation === void 0 ? void 0 : (_entitySet$annotation2 = _entitySet$annotation.StickySessionSupported) === null || _entitySet$annotation2 === void 0 ? void 0 : _entitySet$annotation2.NewAction;
              this._getInternalModel().setProperty("/lastInvokedAction", newAction);
            }
            const oNewDocumentContext = aParams[0];
            if (oNewDocumentContext) {
              this._setDocumentModifiedOnCreate(oListBinding);
              if (!this._isFclEnabled()) {
                EditState.setEditStateDirty();
              }
              this._sendActivity(Activity.Create, oNewDocumentContext);
              if (ModelHelper.isCollaborationDraftSupported(oModel.getMetaModel())) {
                // according to UX in case of enabled collaboration draft we share the object immediately
                await shareObject(oNewDocumentContext);
              }
            }
          } catch (error) {
            // TODO: currently, the only errors handled here are raised as string - should be changed to Error objects
            if (error === Constants.CancelActionDialog || error === Constants.ActionExecutionFailed || error === Constants.CreationFailed) {
              // creation has been cancelled by user or failed in backend => in case we have navigated to transient context before, navigate back
              // the switch-statement above seems to indicate that this happens in creationModes deferred and async. But in fact, in these cases after the navigation from routeMatched in OP component
              // createDeferredContext is triggerd, which calls this method (createDocument) again - this time with creationMode sync. Therefore, also in that mode we need to trigger back navigation.
              // The other cases might still be needed in case the navigation fails.
              if (resolvedCreationMode === CreationMode.Sync || resolvedCreationMode === CreationMode.Deferred || resolvedCreationMode === CreationMode.Async) {
                oRoutingListener.navigateBackFromTransientState();
              }
            }
            throw error;
          }
        }
      } finally {
        if (bShouldBusyLock) {
          BusyLocker.unlock(oLockObject);
        }
      }
    }

    /**
     * This function can be used to intercept the 'Save' action. You can execute custom coding in this function.
     * The framework waits for the returned promise to be resolved before continuing the 'Save' action.
     * If you reject the promise, the 'Save' action is stopped and the user stays in edit mode.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param _mParameters Object containing the parameters passed to onBeforeSave
     * @param _mParameters.context Page context that is going to be saved.
     * @returns A promise to be returned by the overridden method. If resolved, the 'Save' action is triggered. If rejected, the 'Save' action is not triggered and the user stays in edit mode.
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @alias sap.fe.core.controllerextensions.EditFlow#onBeforeSave
     * @public
     * @since 1.90.0
     */;
    _proto.onBeforeSave = function onBeforeSave(_mParameters) {
      // to be overridden
      return Promise.resolve();
    }
    /**
     * This function can be used to intercept the 'Create' action. You can execute custom coding in this function.
     * The framework waits for the returned promise to be resolved before continuing the 'Create' action.
     * If you reject the promise, the 'Create' action is stopped.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param _mParameters Object containing the parameters passed to onBeforeCreate
     * @param _mParameters.contextPath Path pointing to the context on which Create action is triggered
     * @param _mParameters.createParameters Array of values that are filled in the Action Parameter Dialog
     * @returns A promise to be returned by the overridden method. If resolved, the 'Create' action is triggered. If rejected, the 'Create' action is not triggered.
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @alias sap.fe.core.controllerextensions.EditFlow#onBeforeCreate
     * @public
     * @since 1.98.0
     */;
    _proto.onBeforeCreate = function onBeforeCreate(_mParameters) {
      // to be overridden
      return Promise.resolve();
    }
    /**
     * This function can be used to intercept the 'Edit' action. You can execute custom coding in this function.
     * The framework waits for the returned promise to be resolved before continuing the 'Edit' action.
     * If you reject the promise, the 'Edit' action is stopped and the user stays in display mode.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param _mParameters Object containing the parameters passed to onBeforeEdit
     * @param _mParameters.context Page context that is going to be edited.
     * @returns A promise to be returned by the overridden method. If resolved, the 'Edit' action is triggered. If rejected, the 'Edit' action is not triggered and the user stays in display mode.
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @alias sap.fe.core.controllerextensions.EditFlow#onBeforeEdit
     * @public
     * @since 1.98.0
     */;
    _proto.onBeforeEdit = function onBeforeEdit(_mParameters) {
      // to be overridden
      return Promise.resolve();
    }
    /**
     * This function can be used to intercept the 'Discard' action. You can execute custom coding in this function.
     * The framework waits for the returned promise to be resolved before continuing the 'Discard' action.
     * If you reject the promise, the 'Discard' action is stopped and the user stays in edit mode.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param _mParameters Object containing the parameters passed to onBeforeDiscard
     * @param _mParameters.context Page context that is going to be discarded.
     * @returns A promise to be returned by the overridden method. If resolved, the 'Discard' action is triggered. If rejected, the 'Discard' action is not triggered and the user stays in edit mode.
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @alias sap.fe.core.controllerextensions.EditFlow#onBeforeDiscard
     * @public
     * @since 1.98.0
     */;
    _proto.onBeforeDiscard = function onBeforeDiscard(_mParameters) {
      // to be overridden
      return Promise.resolve();
    }
    /**
     * This function can be used to intercept the 'Delete' action. You can execute custom coding in this function.
     * The framework waits for the returned promise to be resolved before continuing the 'Delete' action.
     * If you reject the promise, the 'Delete' action is stopped.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param _mParameters Object containing the parameters passed to onBeforeDelete
     * @param _mParameters.contexts An array of contexts that are going to be deleted
     * @returns A promise to be returned by the overridden method. If resolved, the 'Delete' action is triggered. If rejected, the 'Delete' action is not triggered.
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @alias sap.fe.core.controllerextensions.EditFlow#onBeforeDelete
     * @public
     * @since 1.98.0
     */;
    _proto.onBeforeDelete = function onBeforeDelete(_mParameters) {
      // to be overridden
      return Promise.resolve();
    }

    // Internal only params ---
    // @param {boolean} mParameters.bExecuteSideEffectsOnError Indicates whether SideEffects need to be ignored when user clicks on Save during an Inline creation
    // @param {object} mParameters.bindings List bindings of the tables in the view.
    // Both of the above parameters are for the same purpose. User can enter some information in the creation row(s) but does not 'Add row', instead clicks Save.
    // There can be more than one in the view.

    /**
     * Saves a new document after checking it.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param oContext  Context of the editable document
     * @param mParameters PRIVATE
     * @returns Promise resolves once save is complete
     * @alias sap.fe.core.controllerextensions.EditFlow#saveDocument
     * @public
     * @since 1.90.0
     */;
    _proto.saveDocument = async function saveDocument(oContext, mParameters) {
      mParameters = mParameters || {};
      const bExecuteSideEffectsOnError = mParameters.bExecuteSideEffectsOnError || undefined;
      const bDraftNavigation = true;
      const transactionHelper = this._getTransactionHelper();
      const oResourceBundle = this._getResourceBundle();
      const aBindings = mParameters.bindings;
      try {
        await this._syncTask();
        await this._submitOpenChanges(oContext);
        await this._checkForValidationErrors();
        await this.base.editFlow.onBeforeSave({
          context: oContext
        });
        const sProgrammingModel = this._getProgrammingModel(oContext);
        const oRootViewController = this._getRootViewController();
        let siblingInfo;
        if ((sProgrammingModel === ProgrammingModel.Sticky || oContext.getProperty("HasActiveEntity")) && oRootViewController.isFclEnabled()) {
          // No need to try to get rightmost context in case of a new object
          siblingInfo = await this._computeSiblingInformation(oContext, oRootViewController.getRightmostContext(), sProgrammingModel, true);
        }
        const activeDocumentContext = await transactionHelper.saveDocument(oContext, this.getAppComponent(), oResourceBundle, bExecuteSideEffectsOnError, aBindings, this._getMessageHandler(), this._getCreationMode());
        this._removeStickySessionInternalProperties(sProgrammingModel);
        this._sendActivity(Activity.Activate, activeDocumentContext);
        this._triggerConfiguredSurvey(StandardActions.save, TriggerType.standardAction);
        this._setDocumentModified(false);
        this._setEditMode(EditMode.Display, false);
        this._getMessageHandler().showMessageDialog();
        if (activeDocumentContext !== oContext) {
          let contextToNavigate = activeDocumentContext;
          if (oRootViewController.isFclEnabled()) {
            siblingInfo = siblingInfo ?? this._createSiblingInfo(oContext, activeDocumentContext);
            this._updatePathsInHistory(siblingInfo.pathMapping);
            if (siblingInfo.targetContext.getPath() !== activeDocumentContext.getPath()) {
              contextToNavigate = siblingInfo.targetContext;
            }
          }
          await this._handleNewContext(contextToNavigate, false, false, bDraftNavigation, true);
        }
      } catch (oError) {
        if (!(oError && oError.canceled)) {
          Log.error("Error while saving the document", oError);
        }
        throw oError;
      }
    };
    _proto.toggleDraftActive = async function toggleDraftActive(oContext) {
      const oContextData = oContext.getObject();
      let bEditable;
      const bIsDraft = oContext && this._getProgrammingModel(oContext) === ProgrammingModel.Draft;

      //toggle between draft and active document is only available for edit drafts and active documents with draft)
      if (!bIsDraft || !(!oContextData.IsActiveEntity && oContextData.HasActiveEntity || oContextData.IsActiveEntity && oContextData.HasDraftEntity)) {
        return;
      }
      if (!oContextData.IsActiveEntity && oContextData.HasActiveEntity) {
        //start Point: edit draft
        bEditable = false;
      } else {
        // start point active document
        bEditable = true;
      }
      try {
        const oRootViewController = this._getRootViewController();
        const oRightmostContext = oRootViewController.isFclEnabled() ? oRootViewController.getRightmostContext() : oContext;
        const siblingInfo = await this._computeSiblingInformation(oContext, oRightmostContext, ProgrammingModel.Draft, false);
        if (siblingInfo) {
          this._setEditMode(bEditable ? EditMode.Editable : EditMode.Display, false); //switch to edit mode only if a draft is available

          if (oRootViewController.isFclEnabled()) {
            const lastSemanticMapping = this._getSemanticMapping();
            if ((lastSemanticMapping === null || lastSemanticMapping === void 0 ? void 0 : lastSemanticMapping.technicalPath) === oContext.getPath()) {
              const targetPath = siblingInfo.pathMapping[siblingInfo.pathMapping.length - 1].newPath;
              siblingInfo.pathMapping.push({
                oldPath: lastSemanticMapping.semanticPath,
                newPath: targetPath
              });
            }
            this._updatePathsInHistory(siblingInfo.pathMapping);
          }
          await this._handleNewContext(siblingInfo.targetContext, bEditable, true, true, true);
        } else {
          return Promise.reject("Error in EditFlow.toggleDraftActive - Cannot find sibling");
        }
      } catch (oError) {
        return Promise.reject(`Error in EditFlow.toggleDraftActive:${oError}`);
      }
    }

    // Internal only params ---
    // @param {sap.m.Button} mParameters.cancelButton - Currently this is passed as cancelButton internally (replaced by mParameters.control in the JSDoc below). Currently it is also mandatory.
    // Plan - This should not be mandatory. If not provided, we should have a default that can act as reference control for the discard popover OR we can show a dialog instead of a popover.

    /**
     * Discard the editable document.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param oContext  Context of the editable document
     * @param mParameters Can contain the following attributes:
     * @param mParameters.control This is the control used to open the discard popover
     * @param mParameters.skipDiscardPopover Optional, supresses the discard popover and allows custom handling
     * @returns Promise resolves once editable document has been discarded
     * @alias sap.fe.core.controllerextensions.EditFlow#cancelDocument
     * @public
     * @since 1.90.0
     */;
    _proto.cancelDocument = async function cancelDocument(oContext, mParameters) {
      const transactionHelper = this._getTransactionHelper();
      const oResourceBundle = this._getResourceBundle();
      const mInParameters = mParameters;
      let siblingInfo;
      mInParameters.cancelButton = mParameters.control || mInParameters.cancelButton;
      mInParameters.beforeCancelCallBack = this.base.editFlow.onBeforeDiscard;
      try {
        await this._syncTask();
        const sProgrammingModel = this._getProgrammingModel(oContext);
        if ((sProgrammingModel === ProgrammingModel.Sticky || oContext.getProperty("HasActiveEntity")) && this._isFclEnabled()) {
          const oRootViewController = this._getRootViewController();

          // No need to try to get rightmost context in case of a new object
          siblingInfo = await this._computeSiblingInformation(oContext, oRootViewController.getRightmostContext(), sProgrammingModel, true);
        }
        const cancelResult = await transactionHelper.cancelDocument(oContext, mInParameters, this.getAppComponent(), oResourceBundle, this._getMessageHandler(), this._getCreationMode(), this._isDocumentModified());
        const bDraftNavigation = true;
        this._removeStickySessionInternalProperties(sProgrammingModel);
        this._setEditMode(EditMode.Display, false);
        this._setDocumentModified(false);
        this._setDraftStatus(DraftStatus.Clear);
        // we force the edit state even for FCL because the draft discard might not be implemented
        // and we may just delete the draft
        EditState.setEditStateDirty();
        if (!cancelResult) {
          this._sendActivity(Activity.Discard, undefined);
          //in case of a new document, no activeContext is returned --> navigate back.
          if (!mInParameters.skipBackNavigation) {
            await this._getRoutingListener().navigateBackFromContext(oContext);
          }
        } else {
          const oActiveDocumentContext = cancelResult;
          this._sendActivity(Activity.Discard, oActiveDocumentContext);
          let contextToNavigate = oActiveDocumentContext;
          if (this._isFclEnabled()) {
            siblingInfo = siblingInfo ?? this._createSiblingInfo(oContext, oActiveDocumentContext);
            this._updatePathsInHistory(siblingInfo.pathMapping);
            if (siblingInfo.targetContext.getPath() !== oActiveDocumentContext.getPath()) {
              contextToNavigate = siblingInfo.targetContext;
            }
          }
          if (sProgrammingModel === ProgrammingModel.Draft) {
            // We need to load the semantic keys of the active context, as we need them
            // for the navigation
            await this._fetchSemanticKeyValues(oActiveDocumentContext);
            // We force the recreation of the context, so that it's created and bound in the same microtask,
            // so that all properties are loaded together by autoExpandSelect, so that when switching back to Edit mode
            // $$inheritExpandSelect takes all loaded properties into account (BCP 2070462265)
            if (!mInParameters.skipBindingToView) {
              await this._handleNewContext(contextToNavigate, false, true, bDraftNavigation, true);
            } else {
              return oActiveDocumentContext;
            }
          } else {
            //active context is returned in case of cancel of existing document
            await this._handleNewContext(contextToNavigate, false, false, bDraftNavigation, true);
          }
        }
      } catch (oError) {
        Log.error("Error while discarding the document", oError);
      }
    }

    /**
     * Checks if a context corresponds to a draft root.
     *
     * @param context The context to check
     * @returns True if the context points to a draft root
     * @private
     */;
    _proto.isDraftRoot = function isDraftRoot(context) {
      const metaModel = context.getModel().getMetaModel();
      const metaContext = metaModel.getMetaContext(context.getPath());
      return ModelHelper.isDraftRoot(getInvolvedDataModelObjects(metaContext).targetEntitySet);
    }

    // Internal only params ---
    // @param {string} mParameters.entitySetName Name of the EntitySet to which the object belongs

    /**
     * Deletes the document.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param oContext  Context of the document
     * @param mInParameters Can contain the following attributes:
     * @param mInParameters.title Title of the object being deleted
     * @param mInParameters.description Description of the object being deleted
     * @returns Promise resolves once document has been deleted
     * @alias sap.fe.core.controllerextensions.EditFlow#deleteDocument
     * @public
     * @since 1.90.0
     */;
    _proto.deleteDocument = async function deleteDocument(oContext, mInParameters) {
      const oAppComponent = CommonUtils.getAppComponent(this.getView());
      let mParameters = mInParameters;
      if (!mParameters) {
        mParameters = {
          bFindActiveContexts: false
        };
      } else {
        mParameters.bFindActiveContexts = false;
      }
      mParameters.beforeDeleteCallBack = this.base.editFlow.onBeforeDelete;
      try {
        if (this._isFclEnabled() && this.isDraftRoot(oContext) && oContext.getIndex() === undefined && oContext.getProperty("IsActiveEntity") === true && oContext.getProperty("HasDraftEntity") === true) {
          // Deleting an active entity which has a draft that could potentially be displayed in the ListReport (FCL case)
          // --> need to remove the draft from the LR and replace it with the active version, so that the ListBinding is properly refreshed
          // The condition 'oContext.getIndex() === undefined' makes sure the active version isn't already displayed in the LR
          mParameters.beforeDeleteCallBack = async parameters => {
            await this.base.editFlow.onBeforeDelete(parameters);
            try {
              const model = oContext.getModel();
              const siblingContext = model.bindContext(`${oContext.getPath()}/SiblingEntity`).getBoundContext();
              const draftPath = await siblingContext.requestCanonicalPath();
              const draftContextToRemove = model.getKeepAliveContext(draftPath);
              draftContextToRemove.replaceWith(oContext);
            } catch (error) {
              Log.error("Error while replacing the draft instance in the LR ODLB", error);
            }
          };
        }
        await this._deleteDocumentTransaction(oContext, mParameters);

        // Single objet deletion is triggered from an OP header button (not from a list)
        // --> Mark UI dirty and navigate back to dismiss the OP
        if (!this._isFclEnabled()) {
          EditState.setEditStateDirty();
        }
        this._sendActivity(Activity.Delete, oContext);

        // After delete is successfull, we need to detach the setBackNavigation Methods
        if (oAppComponent) {
          oAppComponent.getShellServices().setBackNavigation();
        }
        if ((oAppComponent === null || oAppComponent === void 0 ? void 0 : oAppComponent.getStartupMode()) === StartupMode.Deeplink && !this._isFclEnabled()) {
          // In case the app has been launched with semantic keys, deleting the object we've landed on shall navigate back
          // to the app we came from (except for FCL, where we navigate to LR as usual)
          oAppComponent.getRouterProxy().exitFromApp();
        } else {
          this._getRoutingListener().navigateBackFromContext(oContext);
        }
      } catch (error) {
        Log.error("Error while deleting the document", error);
      }
    }

    /**
     * Submit the current set of changes and navigate back.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param oContext  Context of the document
     * @returns Promise resolves once the changes have been saved
     * @alias sap.fe.core.controllerextensions.EditFlow#applyDocument
     * @public
     * @since 1.90.0
     */;
    _proto.applyDocument = async function applyDocument(oContext) {
      const oLockObject = this._getGlobalUIModel();
      BusyLocker.lock(oLockObject);
      try {
        await this._syncTask();
        await this._submitOpenChanges(oContext);
        await this._checkForValidationErrors();
        await this._getMessageHandler().showMessageDialog();
        await this._getRoutingListener().navigateBackFromContext(oContext);
      } finally {
        if (BusyLocker.isLocked(oLockObject)) {
          BusyLocker.unlock(oLockObject);
        }
      }
    }

    // Internal only params ---
    // @param {boolean} [mParameters.bStaticAction] Boolean value for static action, undefined for other actions
    // @param {boolean} [mParameters.isNavigable] Boolean value indicating whether navigation is required after the action has been executed
    // Currently the parameter isNavigable is used internally and should be changed to requiresNavigation as it is a more apt name for this param

    /**
     * Invokes an action (bound or unbound) and tracks the changes so that other pages can be refreshed and show the updated data upon navigation.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param sActionName The name of the action to be called
     * @param mInParameters Contains the following attributes:
     * @param mInParameters.parameterValues A map of action parameter names and provided values
     * @param mInParameters.parameterValues.name Name of the parameter
     * @param mInParameters.parameterValues.value Value of the parameter
     * @param mInParameters.skipParameterDialog Skips the action parameter dialog if values are provided for all of them in parameterValues
     * @param mInParameters.contexts For a bound action, a context or an array with contexts for which the action is to be called must be provided
     * @param mInParameters.model For an unbound action, an instance of an OData V4 model must be provided
     * @param mInParameters.requiresNavigation Boolean value indicating whether navigation is required after the action has been executed. Navigation takes place to the context returned by the action
     * @param mInParameters.label A human-readable label for the action. This is needed in case the action has a parameter and a parameter dialog is shown to the user. The label will be used for the title of the dialog and for the confirmation button
     * @param mInParameters.invocationGrouping Mode how actions are to be called: 'ChangeSet' to put all action calls into one changeset, 'Isolated' to put them into separate changesets
     * @param mExtraParams PRIVATE
     * @returns A promise which resolves once the action has been executed, providing the response
     * @alias sap.fe.core.controllerextensions.EditFlow#invokeAction
     * @public
     * @since 1.90.0
     * @final
     */;
    _proto.invokeAction = async function invokeAction(sActionName, mInParameters, mExtraParams) {
      var _model$getMetaModel;
      let oControl;
      const transactionHelper = this._getTransactionHelper();
      let aParts;
      let sOverloadEntityType;
      let oCurrentActionCallBacks;
      const oView = this.getView();
      let mParameters = mInParameters || {};
      // Due to a mistake the invokeAction in the extensionAPI had a different API than this one.
      // The one from the extensionAPI doesn't exist anymore as we expose the full edit flow now but
      // due to compatibility reasons we still need to support the old signature
      if (mParameters.isA && mParameters.isA("sap.ui.model.odata.v4.Context") || Array.isArray(mParameters) || mExtraParams !== undefined) {
        const contexts = mParameters;
        mParameters = mExtraParams || {};
        if (contexts) {
          mParameters.contexts = contexts;
        } else {
          mParameters.model = this.getView().getModel();
        }
      }
      mParameters.isNavigable = mParameters.requiresNavigation || mParameters.isNavigable;

      // Determine if the action is bound or unbound
      const model = this.getView().getModel();
      const actionMetaData = model === null || model === void 0 ? void 0 : (_model$getMetaModel = model.getMetaModel()) === null || _model$getMetaModel === void 0 ? void 0 : _model$getMetaModel.getObject("/" + sActionName.split("(")[0]);
      if (actionMetaData) {
        if (!Array.isArray(actionMetaData)) {
          mParameters.isBound = actionMetaData.$IsBound ? actionMetaData.$IsBound : false;
        } else if (actionMetaData[0].$kind === "Action" && actionMetaData[0].$IsBound === true) {
          mParameters.isBound = true;
        }
      } else {
        throw new Error("Error in EditFlow.invokeAction: The specified action could not be found");
      }
      if (!mParameters.parentControl) {
        mParameters.parentControl = this.getView();
      }
      if (mParameters.controlId) {
        oControl = this.getView().byId(mParameters.controlId);
        if (oControl) {
          // TODO: currently this selected contexts update is done within the operation, should be moved out
          mParameters.internalModelContext = oControl.getBindingContext("internal");
        }
      } else {
        mParameters.internalModelContext = oView.getBindingContext("internal");
      }
      if (sActionName && sActionName.indexOf("(") > -1) {
        // get entity type of action overload and remove it from the action path
        // Example sActionName = "<ActionName>(Collection(<OverloadEntityType>))"
        // sActionName = aParts[0] --> <ActionName>
        // sOverloadEntityType = aParts[2] --> <OverloadEntityType>
        aParts = sActionName.split("(");
        sActionName = aParts[0];
        sOverloadEntityType = aParts[aParts.length - 1].replaceAll(")", "");
      }
      if (mParameters.bStaticAction) {
        if (oControl.isTableBound()) {
          mParameters.contexts = oControl.getRowBinding().getHeaderContext();
        } else {
          const sBindingPath = oControl.data("rowsBindingInfo").path,
            oListBinding = new ODataListBinding(this.getView().getModel(), sBindingPath);
          mParameters.contexts = oListBinding.getHeaderContext();
        }
        if (sOverloadEntityType && oControl.getBindingContext()) {
          mParameters.contexts = this._getActionOverloadContextFromMetadataPath(oControl.getBindingContext(), oControl.getRowBinding(), sOverloadEntityType);
        }
        if (mParameters.enableAutoScroll) {
          oCurrentActionCallBacks = this._createActionPromise(sActionName, oControl.sId);
        }
      }
      mParameters.bGetBoundContext = this._getBoundContext(oView, mParameters);
      // Need to know that the action is called from ObjectPage for changeSet Isolated workaround
      mParameters.bObjectPage = oView.getViewData().converterType === "ObjectPage";
      try {
        await this._syncTask();
        const oResponse = await transactionHelper.callAction(sActionName, mParameters, this.getView(), this.getAppComponent(), this._getMessageHandler());
        if (mParameters.contexts && mParameters.isBound === true) {
          await this._refreshListIfRequired(this._getActionResponseDataAndKeys(sActionName, oResponse), mParameters.contexts[0]);
        }
        this._sendActivity(Activity.Action, mParameters.contexts, sActionName);
        this._triggerConfiguredSurvey(sActionName, TriggerType.action);
        if (oCurrentActionCallBacks) {
          oCurrentActionCallBacks.fResolver(oResponse);
        }
        /*
        		We set the (upper) pages to dirty after an execution of an action
        		TODO: get rid of this workaround
        		This workaround is only needed as long as the model does not support the synchronization.
        		Once this is supported we don't need to set the pages to dirty anymore as the context itself
        		is already refreshed (it's just not reflected in the object page)
        		we explicitly don't call this method from the list report but only call it from the object page
        		as if it is called in the list report it's not needed - as we anyway will remove this logic
        		we can live with this
        		we need a context to set the upper pages to dirty - if there are more than one we use the
        		first one as they are anyway siblings
        		*/
        if (mParameters.contexts) {
          if (!this._isFclEnabled()) {
            EditState.setEditStateDirty();
          }
          this._getInternalModel().setProperty("/lastInvokedAction", sActionName);
        }
        if (mParameters.isNavigable) {
          let vContext = oResponse;
          if (Array.isArray(vContext) && vContext.length === 1) {
            vContext = vContext[0].value;
          }
          if (vContext && !Array.isArray(vContext)) {
            const oMetaModel = oView.getModel().getMetaModel();
            const sContextMetaPath = oMetaModel.getMetaPath(vContext.getPath());
            const _fnValidContexts = (contexts, applicableContexts) => {
              return contexts.filter(element => {
                if (applicableContexts) {
                  return applicableContexts.indexOf(element) > -1;
                }
                return true;
              });
            };
            const oActionContext = Array.isArray(mParameters.contexts) ? _fnValidContexts(mParameters.contexts, mParameters.applicableContext)[0] : mParameters.contexts;
            const sActionContextMetaPath = oActionContext && oMetaModel.getMetaPath(oActionContext.getPath());
            if (sContextMetaPath != undefined && sContextMetaPath === sActionContextMetaPath) {
              if (oActionContext.getPath() !== vContext.getPath()) {
                this._getRoutingListener().navigateForwardToContext(vContext, {
                  checkNoHashChange: true,
                  noHistoryEntry: false
                });
              } else {
                Log.info("Navigation to the same context is not allowed");
              }
            }
          }
        }
        return oResponse;
      } catch (err) {
        if (oCurrentActionCallBacks) {
          oCurrentActionCallBacks.fRejector();
        }
        // FIXME: in most situations there is no handler for the rejected promises returnedq
        if (err === Constants.CancelActionDialog) {
          // This leads to console error. Actually the error is already handled (currently directly in press handler of end button in dialog), so it should not be forwarded
          // up to here. However, when dialog handling and backend execution are separated, information whether dialog was cancelled, or backend execution has failed needs
          // to be transported to the place responsible for connecting these two things.
          // TODO: remove special handling one dialog handling and backend execution are separated
          throw new Error("Dialog cancelled");
        } else if (!(err && (err.canceled || err.rejectedItems && err.rejectedItems[0].canceled))) {
          // TODO: analyze, whether this is of the same category as above
          throw new Error(`Error in EditFlow.invokeAction:${err}`);
        }
        // TODO: Any unexpected errors probably should not be ignored!
      }
    }

    /**
     * Secured execution of the given function. Ensures that the function is only executed when certain conditions are fulfilled.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param fnFunction The function to be executed. Should return a promise that is settled after completion of the execution. If nothing is returned, immediate completion is assumed.
     * @param mParameters Definitions of the preconditions to be checked before execution
     * @param mParameters.busy Defines the busy indicator
     * @param mParameters.busy.set Triggers a busy indicator when the function is executed.
     * @param mParameters.busy.check Executes function only if application isn't busy.
     * @param mParameters.updatesDocument This operation updates the current document without using the bound model and context. As a result, the draft status is updated if a draft document exists, and the user has to confirm the cancellation of the editing process.
     * @returns A promise that is rejected if the execution is prohibited and resolved by the promise returned by the fnFunction.
     * @alias sap.fe.core.controllerextensions.EditFlow#securedExecution
     * @public
     * @experimental As of version 1.90.0
     * @since 1.90.0
     */;
    _proto.securedExecution = function securedExecution(fnFunction, mParameters) {
      const bBusySet = mParameters && mParameters.busy && mParameters.busy.set !== undefined ? mParameters.busy.set : true,
        bBusyCheck = mParameters && mParameters.busy && mParameters.busy.check !== undefined ? mParameters.busy.check : true,
        bUpdatesDocument = mParameters && mParameters.updatesDocument || false,
        oLockObject = this._getGlobalUIModel(),
        oContext = this.base.getView().getBindingContext(),
        bIsDraft = oContext && this._getProgrammingModel(oContext) === ProgrammingModel.Draft;
      if (bBusyCheck && BusyLocker.isLocked(oLockObject)) {
        return Promise.reject("Application already busy therefore execution rejected");
      }

      // we have to set busy and draft indicator immediately also the function might be executed later in queue
      if (bBusySet) {
        BusyLocker.lock(oLockObject);
      }
      if (bUpdatesDocument && bIsDraft) {
        this._setDraftStatus(DraftStatus.Saving);
      }
      this._getMessageHandler().removeTransitionMessages();
      return this._syncTask(fnFunction).then(() => {
        if (bUpdatesDocument) {
          this._setDocumentModified(true);
          if (!this._isFclEnabled()) {
            EditState.setEditStateDirty();
          }
          if (bIsDraft) {
            this._setDraftStatus(DraftStatus.Saved);
          }
        }
      }).catch(oError => {
        if (bUpdatesDocument && bIsDraft) {
          this._setDraftStatus(DraftStatus.Clear);
        }
        return Promise.reject(oError);
      }).finally(() => {
        if (bBusySet) {
          BusyLocker.unlock(oLockObject);
        }
        this._getMessageHandler().showMessageDialog();
      });
    }

    /**
     * Handles the patchSent event: register document modification.
     *
     * @param oEvent The event sent by the binding
     */;
    _proto.handlePatchSent = function handlePatchSent(oEvent) {
      var _this$getView, _this$getView$getBind;
      // In collaborative draft, disable ETag check for PATCH requests
      const isInCollaborativeDraft = isConnected(this.getView());
      if (isInCollaborativeDraft) {
        oEvent.getSource().getModel().setIgnoreETag(true);
      }
      if (!((_this$getView = this.getView()) !== null && _this$getView !== void 0 && (_this$getView$getBind = _this$getView.getBindingContext("internal")) !== null && _this$getView$getBind !== void 0 && _this$getView$getBind.getProperty("skipPatchHandlers"))) {
        // Create a promise that will be resolved or rejected when the path is completed
        const oPatchPromise = new Promise((resolve, reject) => {
          oEvent.getSource().attachEventOnce("patchCompleted", patchCompletedEvent => {
            // Re-enable ETag checks
            if (isInCollaborativeDraft) {
              oEvent.getSource().getModel().setIgnoreETag(false);
            }
            if (oEvent.getSource().isA("sap.ui.model.odata.v4.ODataListBinding")) {
              var _this$getView2;
              ActionRuntime.setActionEnablementAfterPatch(this.getView(), oEvent.getSource(), (_this$getView2 = this.getView()) === null || _this$getView2 === void 0 ? void 0 : _this$getView2.getBindingContext("internal"));
            }
            const bSuccess = patchCompletedEvent.getParameter("success");
            if (bSuccess) {
              resolve();
            } else {
              reject();
            }
          });
        });
        this.updateDocument(oEvent.getSource(), oPatchPromise);
      }
    }

    /**
     * Handles the CreateActivate event.
     *
     * @param oEvent The event sent by the binding
     */;
    _proto.handleCreateActivate = async function handleCreateActivate(oEvent) {
      const oBinding = oEvent.getSource();
      const transactionHelper = this._getTransactionHelper();
      const bAtEnd = true;
      const bInactive = true;
      const oParams = {
        creationMode: CreationMode.Inline,
        createAtEnd: bAtEnd,
        inactive: bInactive,
        keepTransientContextOnFailed: false,
        // currently not fully supported
        busyMode: "None"
      };
      try {
        var _activatedContext$cre;
        // Send notification to other users only after the creation has been finalized
        const activatedContext = oEvent.getParameter("context");
        (_activatedContext$cre = activatedContext.created()) === null || _activatedContext$cre === void 0 ? void 0 : _activatedContext$cre.then(() => {
          this._sendActivity(Activity.Create, activatedContext);
        }).catch(() => {
          Log.warning(`Failed to activate context ${activatedContext.getPath()}`);
        });

        // Create a new inactive context (empty row in the table)
        const newInactiveContext = await transactionHelper.createDocument(oBinding, oParams, this.getAppComponent(), this._getMessageHandler(), false, this.getView());
        if (newInactiveContext) {
          if (!this._isFclEnabled()) {
            EditState.setEditStateDirty();
          }
        }
      } catch (error) {
        Log.error("Failed to activate new row -", error);
      }
    }

    //////////////////////////////////////
    // Private methods
    //////////////////////////////////////

    /*
    		 TO BE CHECKED / DISCUSSED
    		 _createMultipleDocuments and deleteMultiDocument - couldn't we combine them with create and delete document?
    		 _createActionPromise and deleteCurrentActionPromise -> next step
    			 */;
    _proto._setEditMode = function _setEditMode(sEditMode, bCreationMode) {
      this.getInternalEditFlow().setEditMode(sEditMode, bCreationMode);
    };
    _proto._getCreationMode = function _getCreationMode() {
      return this.getInternalEditFlow().getCreationMode();
    };
    _proto._isDocumentModified = function _isDocumentModified() {
      return this.getInternalEditFlow().isDocumentModified();
    };
    _proto._setDocumentModified = function _setDocumentModified(modified) {
      this.getInternalEditFlow().setDocumentModified(modified);
    };
    _proto._setDocumentModifiedOnCreate = function _setDocumentModifiedOnCreate(listBinding) {
      this.getInternalEditFlow().setDocumentModifiedOnCreate(listBinding);
    };
    _proto._setDraftStatus = function _setDraftStatus(sDraftState) {
      this.getInternalEditFlow().setDraftStatus(sDraftState);
    };
    _proto._getRoutingListener = function _getRoutingListener() {
      return this.getInternalEditFlow().getRoutingListener();
    };
    _proto._getGlobalUIModel = function _getGlobalUIModel() {
      return this.getInternalEditFlow().getGlobalUIModel();
    };
    _proto._syncTask = function _syncTask(vTask) {
      return this.getInternalEditFlow().syncTask(vTask);
    };
    _proto._getProgrammingModel = function _getProgrammingModel(oContext) {
      return this.getInternalEditFlow().getProgrammingModel(oContext);
    };
    _proto._deleteDocumentTransaction = function _deleteDocumentTransaction(oContext, mParameters) {
      return this.getInternalEditFlow().deleteDocumentTransaction(oContext, mParameters);
    };
    _proto._handleCreateEvents = function _handleCreateEvents(oBinding) {
      this.getInternalEditFlow().handleCreateEvents(oBinding);
    };
    _proto._getTransactionHelper = function _getTransactionHelper() {
      return this.getInternalEditFlow().getTransactionHelper();
    };
    _proto._getInternalModel = function _getInternalModel() {
      return this.getInternalEditFlow().getInternalModel();
    };
    _proto._getRootViewController = function _getRootViewController() {
      return this.getAppComponent().getRootViewController();
    };
    _proto._getResourceBundle = function _getResourceBundle() {
      return this.getView().getController().oResourceBundle;
    };
    _proto._getSemanticMapping = function _getSemanticMapping() {
      return this.getAppComponent().getRoutingService().getLastSemanticMapping();
    }

    /**
     * Creates a new promise to wait for an action to be executed
     *
     * @function
     * @name _createActionPromise
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @returns {Function} The resolver function which can be used to externally resolve the promise
     */;
    _proto._createActionPromise = function _createActionPromise(sActionName, sControlId) {
      return this.getInternalEditFlow().createActionPromise(sActionName, sControlId);
    };
    _proto._getCurrentActionPromise = function _getCurrentActionPromise() {
      return this.getInternalEditFlow().getCurrentActionPromise();
    };
    _proto._deleteCurrentActionPromise = function _deleteCurrentActionPromise() {
      return this.getInternalEditFlow().deleteCurrentActionPromise();
    };
    _proto._getMessageHandler = function _getMessageHandler() {
      return this.getInternalEditFlow().getMessageHandler();
    };
    _proto._sendActivity = function _sendActivity(action, relatedContexts, actionName) {
      const content = Array.isArray(relatedContexts) ? relatedContexts.map(context => context.getPath()) : relatedContexts === null || relatedContexts === void 0 ? void 0 : relatedContexts.getPath();
      send(this.getView(), action, content, actionName);
    };
    _proto._triggerConfiguredSurvey = function _triggerConfiguredSurvey(sActionName, triggerType) {
      triggerConfiguredSurvey(this.getView(), sActionName, triggerType);
    }

    /**
     * @function
     * @name _getActionResponseDataAndKeys
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param sActionName The name of the action that is executed
     * @param oResponse The bound action's response data or response context
     * @returns Object with data and names of the key fields of the response
     */;
    _proto._getActionResponseDataAndKeys = function _getActionResponseDataAndKeys(sActionName, oResponse) {
      return this.getInternalEditFlow().getActionResponseDataAndKeys(sActionName, oResponse);
    };
    _proto._submitOpenChanges = async function _submitOpenChanges(oContext) {
      const oModel = oContext.getModel(),
        oLockObject = this._getGlobalUIModel();
      try {
        // Submit any leftover changes that are not yet submitted
        // Currently we are using only 1 updateGroupId, hence submitting the batch directly here
        await oModel.submitBatch("$auto");

        // Wait for all currently running changes
        // For the time being we agreed with the v4 model team to use an internal method. We'll replace it once
        // a public or restricted method was provided
        await oModel.oRequestor.waitForRunningChangeRequests("$auto");

        // Check if all changes were submitted successfully
        if (oModel.hasPendingChanges("$auto")) {
          throw new Error("submit of open changes failed");
        }
      } finally {
        if (BusyLocker.isLocked(oLockObject)) {
          BusyLocker.unlock(oLockObject);
        }
      }
    };
    _proto._handleStickyOn = function _handleStickyOn(oContext) {
      return this.getInternalEditFlow().handleStickyOn(oContext);
    };
    _proto._handleStickyOff = function _handleStickyOff() {
      return this.getInternalEditFlow().handleStickyOff();
    };
    _proto._onBackNavigationInSession = function _onBackNavigationInSession() {
      return this.getInternalEditFlow().onBackNavigationInSession();
    };
    _proto._setStickySessionInternalProperties = function _setStickySessionInternalProperties(programmingModel, model) {
      if (programmingModel === ProgrammingModel.Sticky) {
        const internalModel = this._getInternalModel();
        internalModel.setProperty("/sessionOn", true);
        internalModel.setProperty("/stickySessionToken", model.getHttpHeaders(true)["SAP-ContextId"]);
      }
    };
    _proto._removeStickySessionInternalProperties = function _removeStickySessionInternalProperties(programmingModel) {
      if (programmingModel === ProgrammingModel.Sticky) {
        const internalModel = this._getInternalModel();
        internalModel.setProperty("/sessionOn", false);
        internalModel.setProperty("/stickySessionToken", undefined);
        this._handleStickyOff( /*oContext*/);
      }
    };
    _proto._handleNewContext = async function _handleNewContext(oContext, bEditable, bRecreateContext, bDraftNavigation) {
      let bForceFocus = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
      if (!this._isFclEnabled()) {
        EditState.setEditStateDirty();
      }
      await this._getRoutingListener().navigateToContext(oContext, {
        checkNoHashChange: true,
        editable: bEditable,
        bPersistOPScroll: true,
        bRecreateContext: bRecreateContext,
        bDraftNavigation: bDraftNavigation,
        showPlaceholder: false,
        bForceFocus: bForceFocus,
        keepCurrentLayout: true
      });
    };
    _proto._getBoundContext = function _getBoundContext(view, params) {
      const viewLevel = view.getViewData().viewLevel;
      const bRefreshAfterAction = viewLevel > 1 || viewLevel === 1 && params.controlId;
      return !params.isNavigable || !!bRefreshAfterAction;
    }

    /**
     * Checks if there are validation (parse) errors for controls bound to a given context
     *
     * @function
     * @name _checkForValidationErrors
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @returns {Promise} Promise resolves if there are no validation errors, and rejects if there are validation errors
     */;
    _proto._checkForValidationErrors = function _checkForValidationErrors() {
      return this._syncTask().then(() => {
        const sViewId = this.base.getView().getId();
        const aMessages = sap.ui.getCore().getMessageManager().getMessageModel().getData();
        let oControl;
        let oMessage;
        if (!aMessages.length) {
          return Promise.resolve("No validation errors found");
        }
        for (let i = 0; i < aMessages.length; i++) {
          oMessage = aMessages[i];
          if (oMessage.validation) {
            oControl = Core.byId(oMessage.getControlId());
            while (oControl) {
              if (oControl.getId() === sViewId) {
                return Promise.reject("validation errors exist");
              }
              oControl = oControl.getParent();
            }
          }
        }
      });
    }

    /**
     * @function
     * @name _refreshListIfRequired
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param oResponse The response of the bound action and the names of the key fields
     * @param oContext The bound context on which the action was executed
     * @returns Always resolves to param oResponse
     */;
    _proto._refreshListIfRequired = function _refreshListIfRequired(oResponse, oContext) {
      if (!oContext || !oResponse || !oResponse.oData) {
        return Promise.resolve();
      }
      const oBinding = oContext.getBinding();
      // refresh only lists
      if (oBinding && oBinding.isA("sap.ui.model.odata.v4.ODataListBinding")) {
        const oContextData = oResponse.oData;
        const aKeys = oResponse.keys;
        const oCurrentData = oContext.getObject();
        let bReturnedContextIsSame = true;
        // ensure context is in the response
        if (Object.keys(oContextData).length) {
          // check if context in response is different than the bound context
          bReturnedContextIsSame = aKeys.every(function (sKey) {
            return oCurrentData[sKey] === oContextData[sKey];
          });
          if (!bReturnedContextIsSame) {
            return new Promise(resolve => {
              if (oBinding.isRoot()) {
                oBinding.attachEventOnce("dataReceived", function () {
                  resolve();
                });
                oBinding.refresh();
              } else {
                const oAppComponent = CommonUtils.getAppComponent(this.getView());
                oAppComponent.getSideEffectsService().requestSideEffects([{
                  $NavigationPropertyPath: oBinding.getPath()
                }], oBinding.getContext()).then(function () {
                  resolve();
                }, function () {
                  Log.error("Error while refreshing the table");
                  resolve();
                }).catch(function (e) {
                  Log.error("Error while refreshing the table", e);
                });
              }
            });
          }
        }
      }
      // resolve with oResponse to not disturb the promise chain afterwards
      return Promise.resolve();
    };
    _proto._fetchSemanticKeyValues = function _fetchSemanticKeyValues(oContext) {
      const oMetaModel = oContext.getModel().getMetaModel(),
        sEntitySetName = oMetaModel.getMetaContext(oContext.getPath()).getObject("@sapui.name"),
        aSemanticKeys = SemanticKeyHelper.getSemanticKeys(oMetaModel, sEntitySetName);
      if (aSemanticKeys && aSemanticKeys.length) {
        const aRequestPromises = aSemanticKeys.map(function (oKey) {
          return oContext.requestObject(oKey.$PropertyPath);
        });
        return Promise.all(aRequestPromises);
      } else {
        return Promise.resolve();
      }
    }

    /**
     * Provides the latest context in the metadata hierarchy from rootBinding to given context pointing to given entityType
     * if any such context exists. Otherwise, it returns the original context.
     * Note: It is only needed as work-around for incorrect modelling. Correct modelling would imply a DataFieldForAction in a LineItem
     * to point to an overload defined either on the corresponding EntityType or a collection of the same.
     *
     * @param rootContext The context to start searching from
     * @param listBinding The listBinding of the table
     * @param overloadEntityType The ActionOverload entity type to search for
     * @returns Returns the context of the ActionOverload entity
     */;
    _proto._getActionOverloadContextFromMetadataPath = function _getActionOverloadContextFromMetadataPath(rootContext, listBinding, overloadEntityType) {
      const model = rootContext.getModel();
      const metaModel = model.getMetaModel();
      let contextSegments = listBinding.getPath().split("/");
      let currentContext = rootContext;

      // We expect that the last segment of the listBinding is the ListBinding of the table. Remove this from contextSegments
      // because it is incorrect to execute bindContext on a list. We do not anyway need to search this context for the overload.
      contextSegments.pop();
      if (contextSegments.length === 0) {
        contextSegments = [""]; // Don't leave contextSegments undefined
      }

      if (contextSegments[0] !== "") {
        contextSegments.unshift(""); // to also get the root context, i.e. the bindingContext of the table
      }
      // load all the parent contexts into an array
      const parentContexts = contextSegments.map(pathSegment => {
        if (pathSegment !== "") {
          currentContext = model.bindContext(pathSegment, currentContext).getBoundContext();
        } else {
          // Creating a new context using bindContext(...).getBoundContext() does not work if the etag is needed. According to model colleagues,
          // we should always use an existing context if possible.
          // Currently, the only example we know about is using the rootContext - and in this case, we can obviously reuse that existing context.
          // If other examples should come up, the best possible work around would be to request some data to get an existing context. To keep the
          // request as small and fast as possible, we should request only the first key property. As this would introduce asynchronism, and anyway
          // the whole logic is only part of work-around for incorrect modelling, we wait until we have an example needing it before implementing this.
          currentContext = rootContext;
        }
        return currentContext;
      }).reverse();
      // search for context backwards
      const overloadContext = parentContexts.find(parentContext => metaModel.getMetaContext(parentContext.getPath()).getObject("$Type") === overloadEntityType);
      return overloadContext || listBinding.getHeaderContext();
    };
    _proto._createSiblingInfo = function _createSiblingInfo(currentContext, newContext) {
      return {
        targetContext: newContext,
        pathMapping: [{
          oldPath: currentContext.getPath(),
          newPath: newContext.getPath()
        }]
      };
    };
    _proto._updatePathsInHistory = function _updatePathsInHistory(mappings) {
      const oAppComponent = this.getAppComponent();
      oAppComponent.getRouterProxy().setPathMapping(mappings);

      // Also update the semantic mapping in the routing service
      const lastSemanticMapping = this._getSemanticMapping();
      if (mappings.length && (lastSemanticMapping === null || lastSemanticMapping === void 0 ? void 0 : lastSemanticMapping.technicalPath) === mappings[mappings.length - 1].oldPath) {
        lastSemanticMapping.technicalPath = mappings[mappings.length - 1].newPath;
      }
    };
    _proto._getNavigationTargetForEdit = function _getNavigationTargetForEdit(context, newDocumentContext, siblingInfo) {
      let contextToNavigate;
      siblingInfo = siblingInfo ?? this._createSiblingInfo(context, newDocumentContext);
      this._updatePathsInHistory(siblingInfo.pathMapping);
      if (siblingInfo.targetContext.getPath() != newDocumentContext.getPath()) {
        contextToNavigate = siblingInfo.targetContext;
      }
      return contextToNavigate;
    }
    /**
     * This method creates a sibling context for a subobject page, and calculates a sibling path
     * for all intermediate paths between the object page and the subobject page.
     *
     * @param rootCurrentContext The context for the root of the draft
     * @param rightmostCurrentContext The context of the subobject
     * @param sProgrammingModel The programming model
     * @param doNotComputeIfRoot If true, we don't compute siblingInfo if the root and the rightmost contexts are the same
     * @returns Returns the siblingInformation object
     */;
    _proto._computeSiblingInformation = async function _computeSiblingInformation(rootCurrentContext, rightmostCurrentContext, sProgrammingModel, doNotComputeIfRoot) {
      rightmostCurrentContext = rightmostCurrentContext ?? rootCurrentContext;
      if (!rightmostCurrentContext.getPath().startsWith(rootCurrentContext.getPath())) {
        // Wrong usage !!
        Log.error("Cannot compute rightmost sibling context");
        throw new Error("Cannot compute rightmost sibling context");
      }
      if (doNotComputeIfRoot && rightmostCurrentContext.getPath() === rootCurrentContext.getPath()) {
        return Promise.resolve(undefined);
      }
      const model = rootCurrentContext.getModel();
      if (sProgrammingModel === ProgrammingModel.Draft) {
        return draft.computeSiblingInformation(rootCurrentContext, rightmostCurrentContext);
      } else {
        // If not in draft mode, we just recreate a context from the path of the rightmost context
        // No path mapping is needed
        return {
          targetContext: model.bindContext(rightmostCurrentContext.getPath()).getBoundContext(),
          pathMapping: []
        };
      }
    };
    _proto._isFclEnabled = function _isFclEnabled() {
      return CommonUtils.getAppComponent(this.getView())._isFclEnabled();
    };
    return EditFlow;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "editDocument", [_dec2, _dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "editDocument"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "deleteMultipleDocuments", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "deleteMultipleDocuments"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "updateDocument", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "updateDocument"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "createDocument", [_dec8, _dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "createDocument"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeSave", [_dec10, _dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeSave"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeCreate", [_dec12, _dec13], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeCreate"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeEdit", [_dec14, _dec15], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeEdit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeDiscard", [_dec16, _dec17], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeDiscard"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeDelete", [_dec18, _dec19], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeDelete"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "saveDocument", [_dec20, _dec21], Object.getOwnPropertyDescriptor(_class2.prototype, "saveDocument"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "toggleDraftActive", [_dec22, _dec23], Object.getOwnPropertyDescriptor(_class2.prototype, "toggleDraftActive"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "cancelDocument", [_dec24, _dec25], Object.getOwnPropertyDescriptor(_class2.prototype, "cancelDocument"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "deleteDocument", [_dec26, _dec27], Object.getOwnPropertyDescriptor(_class2.prototype, "deleteDocument"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "applyDocument", [_dec28, _dec29], Object.getOwnPropertyDescriptor(_class2.prototype, "applyDocument"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "invokeAction", [_dec30, _dec31], Object.getOwnPropertyDescriptor(_class2.prototype, "invokeAction"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "securedExecution", [_dec32, _dec33], Object.getOwnPropertyDescriptor(_class2.prototype, "securedExecution"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "handlePatchSent", [_dec34], Object.getOwnPropertyDescriptor(_class2.prototype, "handlePatchSent"), _class2.prototype)), _class2)) || _class);
  return EditFlow;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/EditFlow", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/fe/core/controllerextensions/collaboration/CollaborationCommon","sap/fe/core/controllerextensions/editFlow/draft","sap/fe/core/controllerextensions/Feedback","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/EditState","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SemanticKeyHelper","sap/fe/core/library","sap/ui/core/Core","sap/ui/core/library","sap/ui/core/message/Message","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","sap/ui/model/odata/v4/ODataListBinding","../ActionRuntime"],function(t,e,n,i,o,r,a,s,c,l,g,d,u,h,f,p,y,w,v,m){"use strict";var C,_,b,M,P,D,E,x,S,A,I,F,k,O,B,R,T,V,j,H,N,L,$,q,K,U,G,z,W,J,Q,X,Y,Z,tt,et;var nt=c.publicExtension;var it=c.finalExtension;var ot=c.extensible;var rt=c.defineUI5Class;var at=s.getInvolvedDataModelObjects;var st=a.TriggerType;var ct=a.triggerConfiguredSurvey;var lt=a.StandardActions;var gt=o.shareObject;var dt=o.Activity;var ut=i.send;var ht=i.isConnected;function ft(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;pt(t,e)}function pt(t,e){pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,n){e.__proto__=n;return e};return pt(t,e)}function yt(t,e,n,i,o){var r={};Object.keys(i).forEach(function(t){r[t]=i[t]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=n.slice().reverse().reduce(function(n,i){return i(t,e,n)||n},r);if(o&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(o):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(t,e,r);r=null}return r}const wt=u.CreationMode,vt=u.ProgrammingModel,mt=u.Constants,Ct=u.DraftStatus,_t=u.EditMode,bt=u.StartupMode,Mt=f.MessageType;let Pt=(C=rt("sap.fe.core.controllerextensions.EditFlow"),_=nt(),b=it(),M=nt(),P=it(),D=nt(),E=it(),x=nt(),S=it(),A=nt(),I=ot(w.After),F=nt(),k=ot(w.After),O=nt(),B=ot(w.After),R=nt(),T=ot(w.After),V=nt(),j=ot(w.After),H=nt(),N=it(),L=nt(),$=it(),q=nt(),K=it(),U=nt(),G=it(),z=nt(),W=it(),J=nt(),Q=it(),X=nt(),Y=it(),Z=nt(),C(tt=(et=function(i){ft(o,i);function o(){return i.apply(this,arguments)||this}var a=o.prototype;a.getAppComponent=function t(){return this.base.getAppComponent()};a.getInternalEditFlow=function t(){return this.base.getView().getController()._editFlow};a.editDocument=async function e(n){const i=true;const o=this._getTransactionHelper();const r=this._getRootViewController();const a=n.getModel();let s,c;const l=this.getView().getViewData();const d=this._getProgrammingModel(n);let u=n;const h=this.getView();try{if((l===null||l===void 0?void 0:l.viewLevel)>1){if(d===vt.Draft){const t=g.getDraftRootPath(n);u=h.getModel().bindContext(t).getBoundContext();await u.requestObject(t)}else if(d===vt.Sticky){const t=g.getStickyRootPath(n);u=h.getModel().bindContext(t).getBoundContext();await u.requestObject(t)}}await this.base.editFlow.onBeforeEdit({context:u});const t=await o.editDocument(u,this.getView(),this.getAppComponent(),this._getMessageHandler());this._setStickySessionInternalProperties(d,a);if(t){this._setEditMode(_t.Editable,false);this._setDocumentModified(false);this._getMessageHandler().showMessageDialog();if(t!==u){let e=t;if(this._isFclEnabled()){s=r.getRightmostContext();c=await this._computeSiblingInformation(u,s,d,true);c=c??this._createSiblingInfo(n,t);this._updatePathsInHistory(c.pathMapping);if(c.targetContext.getPath()!=t.getPath()){e=c.targetContext}}else if((l===null||l===void 0?void 0:l.viewLevel)>1){c=await this._computeSiblingInformation(u,n,d,true);e=this._getNavigationTargetForEdit(n,t,c)}await this._handleNewContext(e,true,false,i,true);if(d===vt.Sticky){let e;if(this._isFclEnabled()){e=t.getModel().getKeepAliveContext(t.getPath())}else{e=t}this._handleStickyOn(e)}else if(g.isCollaborationDraftSupported(a.getMetaModel())){await gt(t)}}}}catch(e){t.error("Error while editing the document",e)}};a.deleteMultipleDocuments=function t(e,n){if(n){n.beforeDeleteCallBack=this.base.editFlow.onBeforeDelete}else{n={beforeDeleteCallBack:this.base.editFlow.onBeforeDelete}}return this.getInternalEditFlow().deleteMultipleDocuments(e,n)};a.updateDocument=function e(n,i){const o=this.getView().getBindingContext();const r=this._getProgrammingModel(n)===vt.Draft;this._getMessageHandler().removeTransitionMessages();return this._syncTask(async()=>{if(o){this._setDocumentModified(true);if(!this._isFclEnabled()){l.setEditStateDirty()}if(r){this._setDraftStatus(Ct.Saving)}}try{await i;const t=this.getView().getBindingContext();if(!r||!t||t!==o){return}const e=t.getModel().getMetaModel();const n=e.getMetaContext(t.getPath()).getObject("@sapui.name");const a=d.getSemanticKeys(e,n);if(a!==null&&a!==void 0&&a.length){const e=this._getSemanticMapping();const n=e===null||e===void 0?void 0:e.semanticPath,i=d.getSemanticPath(t,true);if(n&&n!==i){await this._handleNewContext(t,true,false,true)}}this._setDraftStatus(Ct.Saved)}catch(e){t.error("Error while updating the document",e);if(r&&o){this._setDraftStatus(Ct.Clear)}}finally{await this._getMessageHandler().showMessages()}})};a.createDocument=async function i(o,r){const a=this._getTransactionHelper(),s=this._getGlobalUIModel();let c;let d=r;const u=!d||d.creationMode!==wt.Inline&&d.creationMode!==wt.CreationRow&&d.creationMode!==wt.External;let f=Promise.resolve([]);const y=e.getAppComponent(this.getView());y.getRouterProxy().removeIAppStateKey();if(d.creationMode===wt.External){await this._syncTask();const t=this.getView().getController();const e=g.getAbsoluteMetaPathForListBinding(this.getView(),o);t.handlers.onChevronPressNavigateOutBound(t,d.outbound,undefined,e);return}if(d.creationMode===wt.CreationRow&&d.creationRow){const t=d.creationRow.getBindingContext().getObject();delete t["@$ui5.context.isTransient"];c=d.creationRow.getParent();f=a.validateDocument(c.getBindingContext(),{data:t,customValidationFunction:c.getCreationRow().data("customValidationFunction")},this.base.getView());if(c.getCreationRow().data("disableAddRowButtonForEmptyData")==="true"){const t=c.getBindingContext("internal");t.setProperty("creationRowFieldValidity",{})}}if(d.creationMode===wt.Inline&&d.tableId){c=this.getView().byId(d.tableId)}if(c&&c.isA("sap.ui.mdc.Table")){const t=d.creationMode===wt.Inline?c.focusRow.bind(c):c.scrollToIndex.bind(c);c.getRowBinding().attachEventOnce("change",function(){t(d.createAtEnd?c.getRowBinding().getLength():0,true)})}const w=async(n,i)=>{try{const t=await i;await t.created();const o=this.getView().getBindingContext();if(!e.hasTransientContext(n)){const t=e.getAppComponent(this.getView());t.getSideEffectsService().requestSideEffectsForNavigationProperty(n.getPath(),o)}}catch(e){t.error("Error while creating the document",e)}};const m=t=>{var e;const n=c&&c.getCreationRow().data("customValidationFunction");const i=c&&((e=c.getBindingContext("internal"))===null||e===void 0?void 0:e.getProperty("creationRowCustomValidity"));const o=h.getMessageManager();const r=[];let a;let s;o.getMessageModel().getData().forEach(function(t){if(t.code===n){o.removeMessages(t)}});t.forEach(t=>{if(t.messageTarget){var e;a=h.getControl(i[t.messageTarget].fieldId);s=`${(e=a.getBindingContext())===null||e===void 0?void 0:e.getPath()}/${a.getBindingPath("value")}`;if(o.getMessageModel().getData().filter(function(t){return t.target===s}).length===0){o.addMessages(new p({message:t.messageText,processor:this.getView().getModel(),type:Mt.Error,code:n,technical:false,persistent:false,target:s}))}const r=o.getMessageModel().getData().filter(function(t){return t.target===s});r[0].addControlId(i[t.messageTarget].fieldId)}else{r.push({code:n,text:t.messageText,persistent:true,type:Mt.Error})}});if(r.length>0){this._getMessageHandler().showMessageDialog({customMessages:r})}};const C=(t,n,i,o)=>{if(t&&t!==wt.NewPage){return t}else{if(!i.isRelative()){const t=i.getPath(),e=n===vt.Draft?o.getObject(`${t}@com.sap.vocabularies.Common.v1.DraftRoot/NewAction`):o.getObject(`${t}@com.sap.vocabularies.Session.v1.StickySessionSupported/NewAction`);if(e){const t=o.getObject(`/${e}/@$ui5.overload/0/$Parameter`)||[];if(t.length>1){return wt.Deferred}}}const t=o.getMetaPath(i===null||i===void 0?void 0:i.getHeaderContext().getPath());const r=e.getNonComputedVisibleFields(o,t,this.getView());if(r.length>0){return wt.Deferred}return wt.Async}};if(u){n.lock(s)}try{const e=await this._syncTask(f);if(e.length>0){m(e);t.error("Custom Validation failed");return}let i;d=d||{};if(o&&typeof o==="object"){i=o}else if(typeof o==="string"){i=new v(this.getView().getModel(),o);d.creationMode=wt.Sync;delete d.createAtEnd}else{throw new Error("Binding object or path expected")}const r=i.getModel();const p=this._getProgrammingModel(i);const E=C(d.creationMode,p,i,r.getMetaModel());let x;let S;const A=d.creationRow;let I;let F;let k;const O=r.getMetaModel();const B=this._getRoutingListener();if(E!==wt.Deferred){if(E===wt.CreationRow){I=A.getBindingContext();k=O.getMetaPath(I.getPath());F=I.getObject();d.data={};Object.keys(F).forEach(function(t){const e=O.getObject(`${k}/${t}`);if(e&&e.$kind==="NavigationProperty"){return}d.data[t]=F[t]});await this._checkForValidationErrors()}if(E===wt.CreationRow||E===wt.Inline){var _,b,M;d.keepTransientContextOnFailed=false;d.busyMode="Local";d.busyId=(_=c)===null||_===void 0?void 0:(b=_.getParent())===null||b===void 0?void 0:(M=b.getTableDefinition())===null||M===void 0?void 0:M.annotation.id;this._handleCreateEvents(i)}if(!d.parentControl){d.parentControl=this.getView()}d.beforeCreateCallBack=this.base.editFlow.onBeforeCreate;d.skipParameterDialog=y.getStartupMode()===bt.AutoCreate;x=a.createDocument(i,d,this.getAppComponent(),this._getMessageHandler(),false,this.getView())}let R;switch(E){case wt.Deferred:R=B.navigateForwardToContext(i,{bDeferredContext:true,editable:true,bForceFocus:true});break;case wt.Async:R=B.navigateForwardToContext(i,{asyncContext:x,editable:true,bForceFocus:true});break;case wt.Sync:S={editable:true,bForceFocus:true};if(p==vt.Sticky||d.createAction){S.transient=true}R=x.then(function(t){if(!t){const t=h.getLibraryResourceBundle("sap.fe.core");return B.navigateToMessagePage(t.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR"),{title:t.getText("C_COMMON_SAPFE_ERROR"),description:t.getText("C_EDITFLOW_SAPFE_CREATION_FAILED_DESCRIPTION")})}else{return d.bFromDeferred?B.navigateToContext(t,S):B.navigateForwardToContext(t,S)}});break;case wt.Inline:w(i,x);this._syncTask(x);break;case wt.CreationRow:try{const e=I.getBinding();if(!d.bSkipSideEffects){w(i,x)}const n=e.create();A.setBindingContext(n);n.created().catch(function(){t.trace("transient fast creation context deleted")});R=I.delete("$direct")}catch(e){if(n.isLocked(this.getView().getModel("ui"))){n.unlock(this.getView().getModel("ui"))}t.error("CreationRow navigation error: ",e)}break;default:R=Promise.reject(`Unhandled creationMode ${E}`);break}if(x){try{const t=await Promise.all([x,R]);this._setStickySessionInternalProperties(p,r);this._setEditMode(_t.Editable);if(!i.isRelative()&&p===vt.Sticky){var P,D;const t=i.getModel().getMetaModel();const e=t.bindContext(t.getMetaPath(i.getPath()));const n=at(e).startingEntitySet;const o=n===null||n===void 0?void 0:(P=n.annotations.Session)===null||P===void 0?void 0:(D=P.StickySessionSupported)===null||D===void 0?void 0:D.NewAction;this._getInternalModel().setProperty("/lastInvokedAction",o)}const e=t[0];if(e){this._setDocumentModifiedOnCreate(i);if(!this._isFclEnabled()){l.setEditStateDirty()}this._sendActivity(dt.Create,e);if(g.isCollaborationDraftSupported(r.getMetaModel())){await gt(e)}}}catch(t){if(t===mt.CancelActionDialog||t===mt.ActionExecutionFailed||t===mt.CreationFailed){if(E===wt.Sync||E===wt.Deferred||E===wt.Async){B.navigateBackFromTransientState()}}throw t}}}finally{if(u){n.unlock(s)}}};a.onBeforeSave=function t(e){return Promise.resolve()};a.onBeforeCreate=function t(e){return Promise.resolve()};a.onBeforeEdit=function t(e){return Promise.resolve()};a.onBeforeDiscard=function t(e){return Promise.resolve()};a.onBeforeDelete=function t(e){return Promise.resolve()};a.saveDocument=async function e(n,i){i=i||{};const o=i.bExecuteSideEffectsOnError||undefined;const r=true;const a=this._getTransactionHelper();const s=this._getResourceBundle();const c=i.bindings;try{await this._syncTask();await this._submitOpenChanges(n);await this._checkForValidationErrors();await this.base.editFlow.onBeforeSave({context:n});const t=this._getProgrammingModel(n);const e=this._getRootViewController();let i;if((t===vt.Sticky||n.getProperty("HasActiveEntity"))&&e.isFclEnabled()){i=await this._computeSiblingInformation(n,e.getRightmostContext(),t,true)}const l=await a.saveDocument(n,this.getAppComponent(),s,o,c,this._getMessageHandler(),this._getCreationMode());this._removeStickySessionInternalProperties(t);this._sendActivity(dt.Activate,l);this._triggerConfiguredSurvey(lt.save,st.standardAction);this._setDocumentModified(false);this._setEditMode(_t.Display,false);this._getMessageHandler().showMessageDialog();if(l!==n){let t=l;if(e.isFclEnabled()){i=i??this._createSiblingInfo(n,l);this._updatePathsInHistory(i.pathMapping);if(i.targetContext.getPath()!==l.getPath()){t=i.targetContext}}await this._handleNewContext(t,false,false,r,true)}}catch(e){if(!(e&&e.canceled)){t.error("Error while saving the document",e)}throw e}};a.toggleDraftActive=async function t(e){const n=e.getObject();let i;const o=e&&this._getProgrammingModel(e)===vt.Draft;if(!o||!(!n.IsActiveEntity&&n.HasActiveEntity||n.IsActiveEntity&&n.HasDraftEntity)){return}if(!n.IsActiveEntity&&n.HasActiveEntity){i=false}else{i=true}try{const t=this._getRootViewController();const n=t.isFclEnabled()?t.getRightmostContext():e;const o=await this._computeSiblingInformation(e,n,vt.Draft,false);if(o){this._setEditMode(i?_t.Editable:_t.Display,false);if(t.isFclEnabled()){const t=this._getSemanticMapping();if((t===null||t===void 0?void 0:t.technicalPath)===e.getPath()){const e=o.pathMapping[o.pathMapping.length-1].newPath;o.pathMapping.push({oldPath:t.semanticPath,newPath:e})}this._updatePathsInHistory(o.pathMapping)}await this._handleNewContext(o.targetContext,i,true,true,true)}else{return Promise.reject("Error in EditFlow.toggleDraftActive - Cannot find sibling")}}catch(t){return Promise.reject(`Error in EditFlow.toggleDraftActive:${t}`)}};a.cancelDocument=async function e(n,i){const o=this._getTransactionHelper();const r=this._getResourceBundle();const a=i;let s;a.cancelButton=i.control||a.cancelButton;a.beforeCancelCallBack=this.base.editFlow.onBeforeDiscard;try{await this._syncTask();const t=this._getProgrammingModel(n);if((t===vt.Sticky||n.getProperty("HasActiveEntity"))&&this._isFclEnabled()){const e=this._getRootViewController();s=await this._computeSiblingInformation(n,e.getRightmostContext(),t,true)}const e=await o.cancelDocument(n,a,this.getAppComponent(),r,this._getMessageHandler(),this._getCreationMode(),this._isDocumentModified());const i=true;this._removeStickySessionInternalProperties(t);this._setEditMode(_t.Display,false);this._setDocumentModified(false);this._setDraftStatus(Ct.Clear);l.setEditStateDirty();if(!e){this._sendActivity(dt.Discard,undefined);if(!a.skipBackNavigation){await this._getRoutingListener().navigateBackFromContext(n)}}else{const o=e;this._sendActivity(dt.Discard,o);let r=o;if(this._isFclEnabled()){s=s??this._createSiblingInfo(n,o);this._updatePathsInHistory(s.pathMapping);if(s.targetContext.getPath()!==o.getPath()){r=s.targetContext}}if(t===vt.Draft){await this._fetchSemanticKeyValues(o);if(!a.skipBindingToView){await this._handleNewContext(r,false,true,i,true)}else{return o}}else{await this._handleNewContext(r,false,false,i,true)}}}catch(e){t.error("Error while discarding the document",e)}};a.isDraftRoot=function t(e){const n=e.getModel().getMetaModel();const i=n.getMetaContext(e.getPath());return g.isDraftRoot(at(i).targetEntitySet)};a.deleteDocument=async function n(i,o){const r=e.getAppComponent(this.getView());let a=o;if(!a){a={bFindActiveContexts:false}}else{a.bFindActiveContexts=false}a.beforeDeleteCallBack=this.base.editFlow.onBeforeDelete;try{if(this._isFclEnabled()&&this.isDraftRoot(i)&&i.getIndex()===undefined&&i.getProperty("IsActiveEntity")===true&&i.getProperty("HasDraftEntity")===true){a.beforeDeleteCallBack=async e=>{await this.base.editFlow.onBeforeDelete(e);try{const t=i.getModel();const e=t.bindContext(`${i.getPath()}/SiblingEntity`).getBoundContext();const n=await e.requestCanonicalPath();const o=t.getKeepAliveContext(n);o.replaceWith(i)}catch(e){t.error("Error while replacing the draft instance in the LR ODLB",e)}}}await this._deleteDocumentTransaction(i,a);if(!this._isFclEnabled()){l.setEditStateDirty()}this._sendActivity(dt.Delete,i);if(r){r.getShellServices().setBackNavigation()}if((r===null||r===void 0?void 0:r.getStartupMode())===bt.Deeplink&&!this._isFclEnabled()){r.getRouterProxy().exitFromApp()}else{this._getRoutingListener().navigateBackFromContext(i)}}catch(e){t.error("Error while deleting the document",e)}};a.applyDocument=async function t(e){const i=this._getGlobalUIModel();n.lock(i);try{await this._syncTask();await this._submitOpenChanges(e);await this._checkForValidationErrors();await this._getMessageHandler().showMessageDialog();await this._getRoutingListener().navigateBackFromContext(e)}finally{if(n.isLocked(i)){n.unlock(i)}}};a.invokeAction=async function e(n,i,o){var r;let a;const s=this._getTransactionHelper();let c;let g;let d;const u=this.getView();let h=i||{};if(h.isA&&h.isA("sap.ui.model.odata.v4.Context")||Array.isArray(h)||o!==undefined){const t=h;h=o||{};if(t){h.contexts=t}else{h.model=this.getView().getModel()}}h.isNavigable=h.requiresNavigation||h.isNavigable;const f=this.getView().getModel();const p=f===null||f===void 0?void 0:(r=f.getMetaModel())===null||r===void 0?void 0:r.getObject("/"+n.split("(")[0]);if(p){if(!Array.isArray(p)){h.isBound=p.$IsBound?p.$IsBound:false}else if(p[0].$kind==="Action"&&p[0].$IsBound===true){h.isBound=true}}else{throw new Error("Error in EditFlow.invokeAction: The specified action could not be found")}if(!h.parentControl){h.parentControl=this.getView()}if(h.controlId){a=this.getView().byId(h.controlId);if(a){h.internalModelContext=a.getBindingContext("internal")}}else{h.internalModelContext=u.getBindingContext("internal")}if(n&&n.indexOf("(")>-1){c=n.split("(");n=c[0];g=c[c.length-1].replaceAll(")","")}if(h.bStaticAction){if(a.isTableBound()){h.contexts=a.getRowBinding().getHeaderContext()}else{const t=a.data("rowsBindingInfo").path,e=new v(this.getView().getModel(),t);h.contexts=e.getHeaderContext()}if(g&&a.getBindingContext()){h.contexts=this._getActionOverloadContextFromMetadataPath(a.getBindingContext(),a.getRowBinding(),g)}if(h.enableAutoScroll){d=this._createActionPromise(n,a.sId)}}h.bGetBoundContext=this._getBoundContext(u,h);h.bObjectPage=u.getViewData().converterType==="ObjectPage";try{await this._syncTask();const e=await s.callAction(n,h,this.getView(),this.getAppComponent(),this._getMessageHandler());if(h.contexts&&h.isBound===true){await this._refreshListIfRequired(this._getActionResponseDataAndKeys(n,e),h.contexts[0])}this._sendActivity(dt.Action,h.contexts,n);this._triggerConfiguredSurvey(n,st.action);if(d){d.fResolver(e)}if(h.contexts){if(!this._isFclEnabled()){l.setEditStateDirty()}this._getInternalModel().setProperty("/lastInvokedAction",n)}if(h.isNavigable){let n=e;if(Array.isArray(n)&&n.length===1){n=n[0].value}if(n&&!Array.isArray(n)){const e=u.getModel().getMetaModel();const i=e.getMetaPath(n.getPath());const o=(t,e)=>t.filter(t=>{if(e){return e.indexOf(t)>-1}return true});const r=Array.isArray(h.contexts)?o(h.contexts,h.applicableContext)[0]:h.contexts;const a=r&&e.getMetaPath(r.getPath());if(i!=undefined&&i===a){if(r.getPath()!==n.getPath()){this._getRoutingListener().navigateForwardToContext(n,{checkNoHashChange:true,noHistoryEntry:false})}else{t.info("Navigation to the same context is not allowed")}}}}return e}catch(t){if(d){d.fRejector()}if(t===mt.CancelActionDialog){throw new Error("Dialog cancelled")}else if(!(t&&(t.canceled||t.rejectedItems&&t.rejectedItems[0].canceled))){throw new Error(`Error in EditFlow.invokeAction:${t}`)}}};a.securedExecution=function t(e,i){const o=i&&i.busy&&i.busy.set!==undefined?i.busy.set:true,r=i&&i.busy&&i.busy.check!==undefined?i.busy.check:true,a=i&&i.updatesDocument||false,s=this._getGlobalUIModel(),c=this.base.getView().getBindingContext(),g=c&&this._getProgrammingModel(c)===vt.Draft;if(r&&n.isLocked(s)){return Promise.reject("Application already busy therefore execution rejected")}if(o){n.lock(s)}if(a&&g){this._setDraftStatus(Ct.Saving)}this._getMessageHandler().removeTransitionMessages();return this._syncTask(e).then(()=>{if(a){this._setDocumentModified(true);if(!this._isFclEnabled()){l.setEditStateDirty()}if(g){this._setDraftStatus(Ct.Saved)}}}).catch(t=>{if(a&&g){this._setDraftStatus(Ct.Clear)}return Promise.reject(t)}).finally(()=>{if(o){n.unlock(s)}this._getMessageHandler().showMessageDialog()})};a.handlePatchSent=function t(e){var n,i;const o=ht(this.getView());if(o){e.getSource().getModel().setIgnoreETag(true)}if(!((n=this.getView())!==null&&n!==void 0&&(i=n.getBindingContext("internal"))!==null&&i!==void 0&&i.getProperty("skipPatchHandlers"))){const t=new Promise((t,n)=>{e.getSource().attachEventOnce("patchCompleted",i=>{if(o){e.getSource().getModel().setIgnoreETag(false)}if(e.getSource().isA("sap.ui.model.odata.v4.ODataListBinding")){var r;m.setActionEnablementAfterPatch(this.getView(),e.getSource(),(r=this.getView())===null||r===void 0?void 0:r.getBindingContext("internal"))}const a=i.getParameter("success");if(a){t()}else{n()}})});this.updateDocument(e.getSource(),t)}};a.handleCreateActivate=async function e(n){const i=n.getSource();const o=this._getTransactionHelper();const r=true;const a=true;const s={creationMode:wt.Inline,createAtEnd:r,inactive:a,keepTransientContextOnFailed:false,busyMode:"None"};try{var c;const e=n.getParameter("context");(c=e.created())===null||c===void 0?void 0:c.then(()=>{this._sendActivity(dt.Create,e)}).catch(()=>{t.warning(`Failed to activate context ${e.getPath()}`)});const r=await o.createDocument(i,s,this.getAppComponent(),this._getMessageHandler(),false,this.getView());if(r){if(!this._isFclEnabled()){l.setEditStateDirty()}}}catch(e){t.error("Failed to activate new row -",e)}};a._setEditMode=function t(e,n){this.getInternalEditFlow().setEditMode(e,n)};a._getCreationMode=function t(){return this.getInternalEditFlow().getCreationMode()};a._isDocumentModified=function t(){return this.getInternalEditFlow().isDocumentModified()};a._setDocumentModified=function t(e){this.getInternalEditFlow().setDocumentModified(e)};a._setDocumentModifiedOnCreate=function t(e){this.getInternalEditFlow().setDocumentModifiedOnCreate(e)};a._setDraftStatus=function t(e){this.getInternalEditFlow().setDraftStatus(e)};a._getRoutingListener=function t(){return this.getInternalEditFlow().getRoutingListener()};a._getGlobalUIModel=function t(){return this.getInternalEditFlow().getGlobalUIModel()};a._syncTask=function t(e){return this.getInternalEditFlow().syncTask(e)};a._getProgrammingModel=function t(e){return this.getInternalEditFlow().getProgrammingModel(e)};a._deleteDocumentTransaction=function t(e,n){return this.getInternalEditFlow().deleteDocumentTransaction(e,n)};a._handleCreateEvents=function t(e){this.getInternalEditFlow().handleCreateEvents(e)};a._getTransactionHelper=function t(){return this.getInternalEditFlow().getTransactionHelper()};a._getInternalModel=function t(){return this.getInternalEditFlow().getInternalModel()};a._getRootViewController=function t(){return this.getAppComponent().getRootViewController()};a._getResourceBundle=function t(){return this.getView().getController().oResourceBundle};a._getSemanticMapping=function t(){return this.getAppComponent().getRoutingService().getLastSemanticMapping()};a._createActionPromise=function t(e,n){return this.getInternalEditFlow().createActionPromise(e,n)};a._getCurrentActionPromise=function t(){return this.getInternalEditFlow().getCurrentActionPromise()};a._deleteCurrentActionPromise=function t(){return this.getInternalEditFlow().deleteCurrentActionPromise()};a._getMessageHandler=function t(){return this.getInternalEditFlow().getMessageHandler()};a._sendActivity=function t(e,n,i){const o=Array.isArray(n)?n.map(t=>t.getPath()):n===null||n===void 0?void 0:n.getPath();ut(this.getView(),e,o,i)};a._triggerConfiguredSurvey=function t(e,n){ct(this.getView(),e,n)};a._getActionResponseDataAndKeys=function t(e,n){return this.getInternalEditFlow().getActionResponseDataAndKeys(e,n)};a._submitOpenChanges=async function t(e){const i=e.getModel(),o=this._getGlobalUIModel();try{await i.submitBatch("$auto");await i.oRequestor.waitForRunningChangeRequests("$auto");if(i.hasPendingChanges("$auto")){throw new Error("submit of open changes failed")}}finally{if(n.isLocked(o)){n.unlock(o)}}};a._handleStickyOn=function t(e){return this.getInternalEditFlow().handleStickyOn(e)};a._handleStickyOff=function t(){return this.getInternalEditFlow().handleStickyOff()};a._onBackNavigationInSession=function t(){return this.getInternalEditFlow().onBackNavigationInSession()};a._setStickySessionInternalProperties=function t(e,n){if(e===vt.Sticky){const t=this._getInternalModel();t.setProperty("/sessionOn",true);t.setProperty("/stickySessionToken",n.getHttpHeaders(true)["SAP-ContextId"])}};a._removeStickySessionInternalProperties=function t(e){if(e===vt.Sticky){const t=this._getInternalModel();t.setProperty("/sessionOn",false);t.setProperty("/stickySessionToken",undefined);this._handleStickyOff()}};a._handleNewContext=async function t(e,n,i,o){let r=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;if(!this._isFclEnabled()){l.setEditStateDirty()}await this._getRoutingListener().navigateToContext(e,{checkNoHashChange:true,editable:n,bPersistOPScroll:true,bRecreateContext:i,bDraftNavigation:o,showPlaceholder:false,bForceFocus:r,keepCurrentLayout:true})};a._getBoundContext=function t(e,n){const i=e.getViewData().viewLevel;const o=i>1||i===1&&n.controlId;return!n.isNavigable||!!o};a._checkForValidationErrors=function t(){return this._syncTask().then(()=>{const t=this.base.getView().getId();const e=sap.ui.getCore().getMessageManager().getMessageModel().getData();let n;let i;if(!e.length){return Promise.resolve("No validation errors found")}for(let o=0;o<e.length;o++){i=e[o];if(i.validation){n=h.byId(i.getControlId());while(n){if(n.getId()===t){return Promise.reject("validation errors exist")}n=n.getParent()}}}})};a._refreshListIfRequired=function n(i,o){if(!o||!i||!i.oData){return Promise.resolve()}const r=o.getBinding();if(r&&r.isA("sap.ui.model.odata.v4.ODataListBinding")){const n=i.oData;const a=i.keys;const s=o.getObject();let c=true;if(Object.keys(n).length){c=a.every(function(t){return s[t]===n[t]});if(!c){return new Promise(n=>{if(r.isRoot()){r.attachEventOnce("dataReceived",function(){n()});r.refresh()}else{const i=e.getAppComponent(this.getView());i.getSideEffectsService().requestSideEffects([{$NavigationPropertyPath:r.getPath()}],r.getContext()).then(function(){n()},function(){t.error("Error while refreshing the table");n()}).catch(function(e){t.error("Error while refreshing the table",e)})}})}}}return Promise.resolve()};a._fetchSemanticKeyValues=function t(e){const n=e.getModel().getMetaModel(),i=n.getMetaContext(e.getPath()).getObject("@sapui.name"),o=d.getSemanticKeys(n,i);if(o&&o.length){const t=o.map(function(t){return e.requestObject(t.$PropertyPath)});return Promise.all(t)}else{return Promise.resolve()}};a._getActionOverloadContextFromMetadataPath=function t(e,n,i){const o=e.getModel();const r=o.getMetaModel();let a=n.getPath().split("/");let s=e;a.pop();if(a.length===0){a=[""]}if(a[0]!==""){a.unshift("")}const c=a.map(t=>{if(t!==""){s=o.bindContext(t,s).getBoundContext()}else{s=e}return s}).reverse();const l=c.find(t=>r.getMetaContext(t.getPath()).getObject("$Type")===i);return l||n.getHeaderContext()};a._createSiblingInfo=function t(e,n){return{targetContext:n,pathMapping:[{oldPath:e.getPath(),newPath:n.getPath()}]}};a._updatePathsInHistory=function t(e){const n=this.getAppComponent();n.getRouterProxy().setPathMapping(e);const i=this._getSemanticMapping();if(e.length&&(i===null||i===void 0?void 0:i.technicalPath)===e[e.length-1].oldPath){i.technicalPath=e[e.length-1].newPath}};a._getNavigationTargetForEdit=function t(e,n,i){let o;i=i??this._createSiblingInfo(e,n);this._updatePathsInHistory(i.pathMapping);if(i.targetContext.getPath()!=n.getPath()){o=i.targetContext}return o};a._computeSiblingInformation=async function e(n,i,o,a){i=i??n;if(!i.getPath().startsWith(n.getPath())){t.error("Cannot compute rightmost sibling context");throw new Error("Cannot compute rightmost sibling context")}if(a&&i.getPath()===n.getPath()){return Promise.resolve(undefined)}const s=n.getModel();if(o===vt.Draft){return r.computeSiblingInformation(n,i)}else{return{targetContext:s.bindContext(i.getPath()).getBoundContext(),pathMapping:[]}}};a._isFclEnabled=function t(){return e.getAppComponent(this.getView())._isFclEnabled()};return o}(y),yt(et.prototype,"editDocument",[_,b],Object.getOwnPropertyDescriptor(et.prototype,"editDocument"),et.prototype),yt(et.prototype,"deleteMultipleDocuments",[M,P],Object.getOwnPropertyDescriptor(et.prototype,"deleteMultipleDocuments"),et.prototype),yt(et.prototype,"updateDocument",[D,E],Object.getOwnPropertyDescriptor(et.prototype,"updateDocument"),et.prototype),yt(et.prototype,"createDocument",[x,S],Object.getOwnPropertyDescriptor(et.prototype,"createDocument"),et.prototype),yt(et.prototype,"onBeforeSave",[A,I],Object.getOwnPropertyDescriptor(et.prototype,"onBeforeSave"),et.prototype),yt(et.prototype,"onBeforeCreate",[F,k],Object.getOwnPropertyDescriptor(et.prototype,"onBeforeCreate"),et.prototype),yt(et.prototype,"onBeforeEdit",[O,B],Object.getOwnPropertyDescriptor(et.prototype,"onBeforeEdit"),et.prototype),yt(et.prototype,"onBeforeDiscard",[R,T],Object.getOwnPropertyDescriptor(et.prototype,"onBeforeDiscard"),et.prototype),yt(et.prototype,"onBeforeDelete",[V,j],Object.getOwnPropertyDescriptor(et.prototype,"onBeforeDelete"),et.prototype),yt(et.prototype,"saveDocument",[H,N],Object.getOwnPropertyDescriptor(et.prototype,"saveDocument"),et.prototype),yt(et.prototype,"toggleDraftActive",[L,$],Object.getOwnPropertyDescriptor(et.prototype,"toggleDraftActive"),et.prototype),yt(et.prototype,"cancelDocument",[q,K],Object.getOwnPropertyDescriptor(et.prototype,"cancelDocument"),et.prototype),yt(et.prototype,"deleteDocument",[U,G],Object.getOwnPropertyDescriptor(et.prototype,"deleteDocument"),et.prototype),yt(et.prototype,"applyDocument",[z,W],Object.getOwnPropertyDescriptor(et.prototype,"applyDocument"),et.prototype),yt(et.prototype,"invokeAction",[J,Q],Object.getOwnPropertyDescriptor(et.prototype,"invokeAction"),et.prototype),yt(et.prototype,"securedExecution",[X,Y],Object.getOwnPropertyDescriptor(et.prototype,"securedExecution"),et.prototype),yt(et.prototype,"handlePatchSent",[Z],Object.getOwnPropertyDescriptor(et.prototype,"handlePatchSent"),et.prototype),et))||tt);return Pt},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Feedback-dbg", ["sap/ui/core/Core"], function (Core) {
  "use strict";

  var _exports = {};
  let TriggerType;
  (function (TriggerType) {
    TriggerType["action"] = "actions";
    TriggerType["standardAction"] = "standardActions";
  })(TriggerType || (TriggerType = {}));
  _exports.TriggerType = TriggerType;
  let StandardActions;
  /**
   * Asking user for feedback
   *
   * @alias sap.fe.core.controllerextensions.Feedback
   * @private
   */
  (function (StandardActions) {
    StandardActions["save"] = "save";
  })(StandardActions || (StandardActions = {}));
  _exports.StandardActions = StandardActions;
  const channel = "sap.feedback";
  const feature = "inapp.feature";

  /**
   * Triggers a feedback survey.
   *
   * @memberof sap.fe.core.controllerextensions.Feedback
   * @param areaId The area id of the application.
   * @param triggerName The name of the trigger.
   * @param payload A flat list of key/values to be passed to the survey.
   * @alias sap.fe.core.controllerextensions.Feedback#triggerSurvey
   * @private
   */
  function triggerSurvey(areaId, triggerName, payload) {
    const parameters = {
      areaId: areaId,
      triggerName: triggerName,
      payload: payload
    };
    Core.getEventBus().publish(channel, feature, parameters);
  }

  /**
   * Triggers a feedback survey configured for a given action on the current page.
   *
   * @memberof sap.fe.core.controllerextensions.Feedback
   * @param view The view which is checked for a feedback configuration.
   * @param action The name of the action.
   * @param triggerType The trigger type of the action (actions|standardActions)
   * @alias sap.fe.core.controllerextensions.Feedback#triggerConfiguredSurvey
   * @private
   */
  _exports.triggerSurvey = triggerSurvey;
  function triggerConfiguredSurvey(view, action, triggerType) {
    var _view$getViewData, _view$getViewData$con, _feedbackConfig$trigg;
    const feedbackConfig = (_view$getViewData = view.getViewData()) === null || _view$getViewData === void 0 ? void 0 : (_view$getViewData$con = _view$getViewData.content) === null || _view$getViewData$con === void 0 ? void 0 : _view$getViewData$con.feedback;
    const surveyConfig = feedbackConfig === null || feedbackConfig === void 0 ? void 0 : (_feedbackConfig$trigg = feedbackConfig[triggerType]) === null || _feedbackConfig$trigg === void 0 ? void 0 : _feedbackConfig$trigg[action];
    if (surveyConfig) {
      triggerSurvey(surveyConfig.areaId, surveyConfig.triggerName, surveyConfig.payload);
    }
  }
  _exports.triggerConfiguredSurvey = triggerConfiguredSurvey;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Feedback", ["sap/ui/core/Core"],function(e){"use strict";var n={};let t;(function(e){e["action"]="actions";e["standardAction"]="standardActions"})(t||(t={}));n.TriggerType=t;let a;(function(e){e["save"]="save"})(a||(a={}));n.StandardActions=a;const i="sap.feedback";const o="inapp.feature";function r(n,t,a){const r={areaId:n,triggerName:t,payload:a};e.getEventBus().publish(i,o,r)}n.triggerSurvey=r;function d(e,n,t){var a,i,o;const d=(a=e.getViewData())===null||a===void 0?void 0:(i=a.content)===null||i===void 0?void 0:i.feedback;const c=d===null||d===void 0?void 0:(o=d[t])===null||o===void 0?void 0:o[n];if(c){r(c.areaId,c.triggerName,c.payload)}}n.triggerConfiguredSurvey=d;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/IntentBasedNavigation-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution"], function (ClassSupport, ControllerExtension, OverrideExecution) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _class, _class2;
  var _exports = {};
  var publicExtension = ClassSupport.publicExtension;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  let ContextStrategy;
  /**
   * Controller extension providing hooks for intent-based navigation
   *
   * @hideconstructor
   * @public
   * @since 1.86.0
   */
  (function (ContextStrategy) {
    ContextStrategy["Default"] = "default";
    ContextStrategy["Initiator"] = "initiator";
  })(ContextStrategy || (ContextStrategy = {}));
  _exports.ContextStrategy = ContextStrategy;
  let IntentBasedNavigation = (_dec = defineUI5Class("sap.fe.core.controllerextensions.IntentBasedNavigation"), _dec2 = publicExtension(), _dec3 = extensible(OverrideExecution.After), _dec4 = publicExtension(), _dec5 = extensible(OverrideExecution.After), _dec6 = finalExtension(), _dec7 = publicExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(IntentBasedNavigation, _ControllerExtension);
    function IntentBasedNavigation() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = IntentBasedNavigation.prototype;
    _proto.adaptContextPreparationStrategy = function adaptContextPreparationStrategy(_oNavigationInfo) {
      // to be overriden by the application
      return ContextStrategy.Default;
    }

    /**
     * Provides a hook to customize the {@link sap.fe.navigation.SelectionVariant} related to the intent-based navigation.
     *
     * @function
     * @param _oSelectionVariant SelectionVariant provided by SAP Fiori elements.
     * @param _oNavigationInfo Object containing intent-based navigation-related info
     * @param _oNavigationInfo.semanticObject Semantic object related to the intent
     * @param _oNavigationInfo.action Action related to the intent
     * @alias sap.fe.core.controllerextensions.IntentBasedNavigation#adaptNavigationContext
     * @public
     * @since 1.86.0
     */;
    _proto.adaptNavigationContext = function adaptNavigationContext(_oSelectionVariant, _oNavigationInfo) {
      // to be overriden by the application
    }

    /**
     * Navigates to an intent defined by an outbound definition in the manifest.
     *
     * @function
     * @param sOutbound Identifier to locate the outbound definition in the manifest.
     * This provides the semantic object and action for the intent-based navigation.
     * Additionally, the outbound definition can be used to provide parameters for intent-based navigation.
     * See {@link topic:be0cf40f61184b358b5faedaec98b2da Descriptor for Applications, Components, and Libraries} for more information.
     * @param mNavigationParameters Optional map containing key/value pairs to be passed to the intent.
     * If mNavigationParameters are provided, the parameters provided in the outbound definition of the manifest are ignored.
     * @alias sap.fe.core.controllerextensions.IntentBasedNavigation#navigateOutbound
     * @public
     * @since 1.86.0
     */;
    _proto.navigateOutbound = function navigateOutbound(sOutbound, mNavigationParameters) {
      var _this$base, _this$base2;
      const oInternalModelContext = (_this$base = this.base) === null || _this$base === void 0 ? void 0 : _this$base.getView().getBindingContext("internal");
      oInternalModelContext.setProperty("externalNavigationContext", {
        page: false
      });
      (_this$base2 = this.base) === null || _this$base2 === void 0 ? void 0 : _this$base2._intentBasedNavigation.navigateOutbound(sOutbound, mNavigationParameters);
    };
    return IntentBasedNavigation;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "adaptContextPreparationStrategy", [_dec2, _dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "adaptContextPreparationStrategy"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "adaptNavigationContext", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "adaptNavigationContext"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateOutbound", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateOutbound"), _class2.prototype)), _class2)) || _class);
  return IntentBasedNavigation;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/IntentBasedNavigation", ["sap/fe/core/helpers/ClassSupport","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution"],function(t,e,n){"use strict";var i,r,o,a,p,u,c,l,s;var f={};var v=t.publicExtension;var d=t.finalExtension;var y=t.extensible;var g=t.defineUI5Class;function b(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;O(t,e)}function O(t,e){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,n){e.__proto__=n;return e};return O(t,e)}function x(t,e,n,i,r){var o={};Object.keys(i).forEach(function(t){o[t]=i[t]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=n.slice().reverse().reduce(function(n,i){return i(t,e,n)||n},o);if(r&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(r):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(t,e,o);o=null}return o}let C;(function(t){t["Default"]="default";t["Initiator"]="initiator"})(C||(C={}));f.ContextStrategy=C;let P=(i=g("sap.fe.core.controllerextensions.IntentBasedNavigation"),r=v(),o=y(n.After),a=v(),p=y(n.After),u=d(),c=v(),i(l=(s=function(t){b(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;n.adaptContextPreparationStrategy=function t(e){return C.Default};n.adaptNavigationContext=function t(e,n){};n.navigateOutbound=function t(e,n){var i,r;const o=(i=this.base)===null||i===void 0?void 0:i.getView().getBindingContext("internal");o.setProperty("externalNavigationContext",{page:false});(r=this.base)===null||r===void 0?void 0:r._intentBasedNavigation.navigateOutbound(e,n)};return e}(e),x(s.prototype,"adaptContextPreparationStrategy",[r,o],Object.getOwnPropertyDescriptor(s.prototype,"adaptContextPreparationStrategy"),s.prototype),x(s.prototype,"adaptNavigationContext",[a,p],Object.getOwnPropertyDescriptor(s.prototype,"adaptNavigationContext"),s.prototype),x(s.prototype,"navigateOutbound",[u,c],Object.getOwnPropertyDescriptor(s.prototype,"navigateOutbound"),s.prototype),s))||l);return P},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/InternalEditFlow-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/controllerextensions/collaboration/ActivitySync", "sap/fe/core/controllerextensions/collaboration/CollaborationCommon", "sap/fe/core/controllerextensions/editFlow/sticky", "sap/fe/core/controllerextensions/editFlow/TransactionHelper", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/EditState", "sap/fe/core/library", "sap/m/Button", "sap/m/Dialog", "sap/m/Text", "sap/ui/core/mvc/ControllerExtension"], function (Log, CommonUtils, BusyLocker, ActivitySync, CollaborationCommon, sticky, TransactionHelper, ClassSupport, EditState, FELibrary, Button, Dialog, Text, ControllerExtension) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _dec22, _dec23, _dec24, _dec25, _dec26, _dec27, _dec28, _dec29, _dec30, _dec31, _dec32, _dec33, _dec34, _dec35, _dec36, _dec37, _dec38, _dec39, _dec40, _dec41, _dec42, _dec43, _dec44, _dec45, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var finalExtension = ClassSupport.finalExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var Activity = CollaborationCommon.Activity;
  var send = ActivitySync.send;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  const ProgrammingModel = FELibrary.ProgrammingModel,
    DraftStatus = FELibrary.DraftStatus,
    EditMode = FELibrary.EditMode,
    CreationMode = FELibrary.CreationMode;
  let InternalEditFlow = (_dec = defineUI5Class("sap.fe.core.controllerextensions.InternalEditFlow"), _dec2 = publicExtension(), _dec3 = finalExtension(), _dec4 = publicExtension(), _dec5 = finalExtension(), _dec6 = publicExtension(), _dec7 = finalExtension(), _dec8 = publicExtension(), _dec9 = finalExtension(), _dec10 = publicExtension(), _dec11 = finalExtension(), _dec12 = publicExtension(), _dec13 = finalExtension(), _dec14 = publicExtension(), _dec15 = finalExtension(), _dec16 = publicExtension(), _dec17 = finalExtension(), _dec18 = publicExtension(), _dec19 = finalExtension(), _dec20 = publicExtension(), _dec21 = finalExtension(), _dec22 = publicExtension(), _dec23 = finalExtension(), _dec24 = publicExtension(), _dec25 = finalExtension(), _dec26 = publicExtension(), _dec27 = finalExtension(), _dec28 = publicExtension(), _dec29 = finalExtension(), _dec30 = publicExtension(), _dec31 = finalExtension(), _dec32 = publicExtension(), _dec33 = finalExtension(), _dec34 = publicExtension(), _dec35 = finalExtension(), _dec36 = publicExtension(), _dec37 = finalExtension(), _dec38 = publicExtension(), _dec39 = finalExtension(), _dec40 = publicExtension(), _dec41 = finalExtension(), _dec42 = publicExtension(), _dec43 = finalExtension(), _dec44 = publicExtension(), _dec45 = finalExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(InternalEditFlow, _ControllerExtension);
    function InternalEditFlow() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = InternalEditFlow.prototype;
    _proto.getAppComponent = function getAppComponent() {
      return this.base.getAppComponent();
    }

    /**
     * Sets that the current page contains a newly created object.
     *
     * @param bCreationMode True if the object is new
     */;
    _proto.setCreationMode = function setCreationMode(bCreationMode) {
      const uiModelContext = this.base.getView().getBindingContext("ui");
      this.getGlobalUIModel().setProperty("createMode", bCreationMode, uiModelContext, true);
    }

    /**
     * Indicates whether the current page contains a newly created object or not.
     *
     * @returns True if the object is new
     */;
    _proto.getCreationMode = function getCreationMode() {
      const uiModelContext = this.base.getView().getBindingContext("ui");
      return !!this.getGlobalUIModel().getProperty("createMode", uiModelContext);
    }

    /**
     * Indicates whether the object being edited (or one of its sub-objects) has been modified or not.
     *
     * @returns True if the object has been modified
     */;
    _proto.isDocumentModified = function isDocumentModified() {
      return !!this.getGlobalUIModel().getProperty("/isDocumentModified");
    }

    /**
     * Sets that the object being edited (or one of its sub-objects) has been modified.
     *
     * @param modified True if the object has been modified
     */;
    _proto.setDocumentModified = function setDocumentModified(modified) {
      this.getGlobalUIModel().setProperty("/isDocumentModified", modified);
    }

    /**
     * Sets that the object being edited has been modified by creating a sub-object.
     *
     * @param listBinding The list binding on which the object has been created
     */;
    _proto.setDocumentModifiedOnCreate = function setDocumentModifiedOnCreate(listBinding) {
      // Set the modified flag only on relative listBindings, i.e. when creating a sub-object
      // If the listBinding is not relative, then it's a creation from the ListReport, and by default a newly created root object isn't considered as modified
      if (listBinding.isRelative()) {
        this.setDocumentModified(true);
      }
    };
    _proto.createMultipleDocuments = function createMultipleDocuments(oListBinding, aData, bCreateAtEnd, bFromCopyPaste, beforeCreateCallBack) {
      let bInactive = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;
      const transactionHelper = this.getTransactionHelper(),
        oLockObject = this.getGlobalUIModel();
      BusyLocker.lock(oLockObject);
      let aFinalContexts = [];
      return this.syncTask().then(() => {
        return beforeCreateCallBack ? beforeCreateCallBack({
          contextPath: oListBinding && oListBinding.getPath()
        }) : Promise.resolve();
      }).then(() => {
        const oModel = oListBinding.getModel(),
          oMetaModel = oModel.getMetaModel();
        let sMetaPath;
        if (oListBinding.getContext()) {
          sMetaPath = oMetaModel.getMetaPath(`${oListBinding.getContext().getPath()}/${oListBinding.getPath()}`);
        } else {
          sMetaPath = oMetaModel.getMetaPath(oListBinding.getPath());
        }
        this.handleCreateEvents(oListBinding);

        // Iterate on all items and store the corresponding creation promise
        const aCreationPromises = aData.map(mPropertyValues => {
          const mParameters = {
            data: {}
          };
          mParameters.keepTransientContextOnFailed = false; // currently not fully supported
          mParameters.busyMode = "None";
          mParameters.creationMode = CreationMode.CreationRow;
          mParameters.parentControl = this.getView();
          mParameters.createAtEnd = bCreateAtEnd;
          mParameters.inactive = bInactive;

          // Remove navigation properties as we don't support deep create
          for (const sPropertyPath in mPropertyValues) {
            const oProperty = oMetaModel.getObject(`${sMetaPath}/${sPropertyPath}`);
            if (oProperty && oProperty.$kind !== "NavigationProperty" && mPropertyValues[sPropertyPath]) {
              mParameters.data[sPropertyPath] = mPropertyValues[sPropertyPath];
            }
          }
          return transactionHelper.createDocument(oListBinding, mParameters, this.getAppComponent(), this.getMessageHandler(), bFromCopyPaste, this.getView());
        });
        return Promise.all(aCreationPromises);
      }).then(aContexts => {
        if (!bInactive) {
          this.setDocumentModifiedOnCreate(oListBinding);
        }
        // transient contexts are reliably removed once oNewContext.created() is resolved
        aFinalContexts = aContexts;
        return Promise.all(aContexts.map(function (oNewContext) {
          if (!oNewContext.bInactive) {
            return oNewContext.created();
          }
        }));
      }).then(() => {
        const oBindingContext = this.getView().getBindingContext();

        // if there are transient contexts, we must avoid requesting side effects
        // this is avoid a potential list refresh, there could be a side effect that refreshes the list binding
        // if list binding is refreshed, transient contexts might be lost
        if (!CommonUtils.hasTransientContext(oListBinding)) {
          this.getAppComponent().getSideEffectsService().requestSideEffectsForNavigationProperty(oListBinding.getPath(), oBindingContext);
        }
      }).catch(function (err) {
        Log.error("Error while creating multiple documents.");
        return Promise.reject(err);
      }).finally(function () {
        BusyLocker.unlock(oLockObject);
      }).then(() => {
        return aFinalContexts;
      });
    };
    _proto.deleteMultipleDocuments = function deleteMultipleDocuments(aContexts, mParameters) {
      const oLockObject = this.getGlobalUIModel();
      const oControl = this.getView().byId(mParameters.controlId);
      if (!oControl) {
        throw new Error("parameter controlId missing or incorrect");
      } else {
        mParameters.parentControl = oControl;
      }
      const oListBinding = oControl.getBinding("items") || oControl.getRowBinding();
      mParameters.bFindActiveContexts = true;
      BusyLocker.lock(oLockObject);
      return this.deleteDocumentTransaction(aContexts, mParameters).then(() => {
        let oResult;

        // Multiple object deletion is triggered from a list
        // First clear the selection in the table as it's not valid any more
        if (oControl.isA("sap.ui.mdc.Table")) {
          oControl.clearSelection();
        }

        // Then refresh the list-binding (LR), or require side-effects (OP)
        const oBindingContext = this.getView().getBindingContext();
        if (oListBinding.isRoot()) {
          // keep promise chain pending until refresh of listbinding is completed
          oResult = new Promise(resolve => {
            oListBinding.attachEventOnce("dataReceived", function () {
              resolve();
            });
          });
          oListBinding.refresh();
        } else if (oBindingContext) {
          // if there are transient contexts, we must avoid requesting side effects
          // this is avoid a potential list refresh, there could be a side effect that refreshes the list binding
          // if list binding is refreshed, transient contexts might be lost
          if (!CommonUtils.hasTransientContext(oListBinding)) {
            this.getAppComponent().getSideEffectsService().requestSideEffectsForNavigationProperty(oListBinding.getPath(), oBindingContext);
          }
        }

        // deleting at least one object should also set the UI to dirty
        if (!this.getAppComponent()._isFclEnabled()) {
          EditState.setEditStateDirty();
        }
        send(this.getView(), Activity.Delete, aContexts.map(context => context.getPath()));
        return oResult;
      }).catch(function (oError) {
        Log.error("Error while deleting the document(s)", oError);
      }).finally(function () {
        BusyLocker.unlock(oLockObject);
      });
    }

    /**
     * Decides if a document is to be shown in display or edit mode.
     *
     * @function
     * @name _computeEditMode
     * @memberof sap.fe.core.controllerextensions.InternalEditFlow
     * @param {sap.ui.model.odata.v4.Context} oContext The context to be displayed or edited
     * @returns {Promise} Promise resolves once the edit mode is computed
     */;
    _proto.computeEditMode = async function computeEditMode(oContext) {
      const sProgrammingModel = this.getProgrammingModel(oContext);
      if (sProgrammingModel === ProgrammingModel.Draft) {
        try {
          this.setDraftStatus(DraftStatus.Clear);
          this._setEditablePending(true);
          const bIsActiveEntity = await oContext.requestObject("IsActiveEntity");
          if (bIsActiveEntity === false) {
            // in case the document is draft set it in edit mode
            this.setEditMode(EditMode.Editable);
            const bHasActiveEntity = await oContext.requestObject("HasActiveEntity");
            this.setEditMode(undefined, !bHasActiveEntity);
          } else {
            // active document, stay on display mode
            this.setEditMode(EditMode.Display, false);
          }
          this._setEditablePending(false);
        } catch (oError) {
          Log.error("Error while determining the editMode for draft", oError);
          throw oError;
        }
      } else if (sProgrammingModel === ProgrammingModel.Sticky) {
        const lastInvokedActionName = this.getInternalModel().getProperty("/lastInvokedAction");
        if (lastInvokedActionName && this._hasNewActionForSticky(oContext, this.getView(), lastInvokedActionName)) {
          this.setEditMode(EditMode.Editable, true);
          if (!this.getAppComponent()._isFclEnabled()) {
            EditState.setEditStateDirty();
          }
          this.handleStickyOn(oContext);
          this.getInternalModel().setProperty("/lastInvokedAction", undefined);
        }
      }
    }

    /**
     * Sets the edit mode.
     *
     * @param sEditMode The edit mode
     * @param bCreationMode True if the object has been newly created
     */;
    _proto.setEditMode = function setEditMode(sEditMode, bCreationMode) {
      // at this point of time it's not meant to release the edit flow for freestyle usage therefore we can
      // rely on the global UI model to exist
      const oGlobalModel = this.getGlobalUIModel();
      if (sEditMode) {
        oGlobalModel.setProperty("/isEditable", sEditMode === "Editable", undefined, true);
      }
      if (bCreationMode !== undefined) {
        // Since setCreationMode is public in EditFlow and can be overriden, make sure to call it via the controller
        // to ensure any overrides are taken into account
        this.setCreationMode(bCreationMode);
      }
    };
    _proto._setEditablePending = function _setEditablePending(pending) {
      const globalModel = this.getGlobalUIModel();
      globalModel.setProperty("/isEditablePending", pending, undefined, true);
    };
    _proto.setDraftStatus = function setDraftStatus(sDraftState) {
      // at this point of time it's not meant to release the edit flow for freestyle usage therefore we can
      // rely on the global UI model to exist
      this.base.getView().getModel("ui").setProperty("/draftStatus", sDraftState, undefined, true);
    };
    _proto.getRoutingListener = function getRoutingListener() {
      // at this point of time it's not meant to release the edit flow for FPM custom pages and the routing
      // listener is not yet public therefore keep the logic here for now

      if (this.base._routing) {
        return this.base._routing;
      } else {
        throw new Error("Edit Flow works only with a given routing listener");
      }
    };
    _proto.getGlobalUIModel = function getGlobalUIModel() {
      // at this point of time it's not meant to release the edit flow for freestyle usage therefore we can
      // rely on the global UI model to exist
      return this.base.getView().getModel("ui");
    }

    /**
     * Performs a task in sync with other tasks created via this function.
     * Returns the promise chain of the task.
     *
     * @function
     * @name sap.fe.core.controllerextensions.EditFlow#syncTask
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @static
     * @param [vTask] Optional, a promise or function to be executed synchronously
     * @returns Promise resolves once the task is completed
     * @ui5-restricted
     * @final
     */;
    _proto.syncTask = function syncTask(vTask) {
      let fnNewTask;
      if (vTask instanceof Promise) {
        fnNewTask = function () {
          return vTask;
        };
      } else if (typeof vTask === "function") {
        fnNewTask = vTask;
      }
      this._pTasks = this._pTasks || Promise.resolve();
      if (fnNewTask) {
        this._pTasks = this._pTasks.then(fnNewTask).catch(function () {
          return Promise.resolve();
        });
      }
      return this._pTasks;
    };
    _proto.getProgrammingModel = function getProgrammingModel(oContext) {
      return this.getTransactionHelper().getProgrammingModel(oContext);
    };
    _proto.deleteDocumentTransaction = async function deleteDocumentTransaction(oContext, mParameters) {
      var _sap$ui$getCore$byId;
      const oResourceBundle = this.getView().getController().oResourceBundle,
        transactionHelper = this.getTransactionHelper();
      mParameters = mParameters || {};

      // TODO: this setting and removing of contexts shouldn't be in the transaction helper at all
      // for the time being I kept it and provide the internal model context to not break something
      mParameters.internalModelContext = mParameters.controlId ? (_sap$ui$getCore$byId = sap.ui.getCore().byId(mParameters.controlId)) === null || _sap$ui$getCore$byId === void 0 ? void 0 : _sap$ui$getCore$byId.getBindingContext("internal") : null;
      await this.syncTask();
      await transactionHelper.deleteDocument(oContext, mParameters, this.getAppComponent(), oResourceBundle, this.getMessageHandler());
      const internalModel = this.getInternalModel();
      internalModel.setProperty("/sessionOn", false);
      internalModel.setProperty("/stickySessionToken", undefined);
    }

    /**
     * Handles the create event: shows messages and in case of a draft, updates the draft indicator.
     *
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param oBinding OData list binding object
     */;
    _proto.handleCreateEvents = function handleCreateEvents(oBinding) {
      this.setDraftStatus(DraftStatus.Clear);
      oBinding = oBinding.getBinding && oBinding.getBinding() || oBinding;
      const sProgrammingModel = this.getProgrammingModel(oBinding);
      oBinding.attachEvent("createSent", () => {
        if (sProgrammingModel === ProgrammingModel.Draft) {
          this.setDraftStatus(DraftStatus.Saving);
        }
      });
      oBinding.attachEvent("createCompleted", oEvent => {
        const bSuccess = oEvent.getParameter("success");
        if (sProgrammingModel === ProgrammingModel.Draft) {
          this.setDraftStatus(bSuccess ? DraftStatus.Saved : DraftStatus.Clear);
        }
        this.getMessageHandler().showMessageDialog();
      });
    };
    _proto.getTransactionHelper = function getTransactionHelper() {
      return TransactionHelper;
    };
    _proto.getInternalModel = function getInternalModel() {
      return this.base.getView().getModel("internal");
    }

    /**
     * Creates a new promise to wait for an action to be executed
     *
     * @function
     * @name _createActionPromise
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @returns {Function} The resolver function which can be used to externally resolve the promise
     */;
    _proto.createActionPromise = function createActionPromise(sActionName, sControlId) {
      let fResolver, fRejector;
      this.oActionPromise = new Promise((resolve, reject) => {
        fResolver = resolve;
        fRejector = reject;
      }).then(oResponse => {
        return Object.assign({
          controlId: sControlId
        }, this.getActionResponseDataAndKeys(sActionName, oResponse));
      });
      return {
        fResolver: fResolver,
        fRejector: fRejector
      };
    }

    /**
     * Gets the getCurrentActionPromise object.
     *
     * @function
     * @name _getCurrentActionPromise
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @returns Returns the promise
     */;
    _proto.getCurrentActionPromise = function getCurrentActionPromise() {
      return this.oActionPromise;
    };
    _proto.deleteCurrentActionPromise = function deleteCurrentActionPromise() {
      this.oActionPromise = undefined;
    }

    /**
     * @function
     * @name getActionResponseDataAndKeys
     * @memberof sap.fe.core.controllerextensions.EditFlow
     * @param sActionName The name of the action that is executed
     * @param oResponse The bound action's response data or response context
     * @returns Object with data and names of the key fields of the response
     */;
    _proto.getActionResponseDataAndKeys = function getActionResponseDataAndKeys(sActionName, oResponse) {
      if (Array.isArray(oResponse)) {
        if (oResponse.length === 1) {
          oResponse = oResponse[0].value;
        } else {
          return null;
        }
      }
      if (!oResponse) {
        return null;
      }
      const oView = this.getView(),
        oMetaModel = oView.getModel().getMetaModel().getData(),
        sActionReturnType = oMetaModel && oMetaModel[sActionName] && oMetaModel[sActionName][0] && oMetaModel[sActionName][0].$ReturnType ? oMetaModel[sActionName][0].$ReturnType.$Type : null,
        aKey = sActionReturnType && oMetaModel[sActionReturnType] ? oMetaModel[sActionReturnType].$Key : null;
      return {
        oData: oResponse.getObject(),
        keys: aKey
      };
    };
    _proto.getMessageHandler = function getMessageHandler() {
      // at this point of time it's not meant to release the edit flow for FPM custom pages therefore keep
      // the logic here for now

      if (this.base.messageHandler) {
        return this.base.messageHandler;
      } else {
        throw new Error("Edit Flow works only with a given message handler");
      }
    };
    _proto.handleStickyOn = function handleStickyOn(oContext) {
      const oAppComponent = this.getAppComponent();
      try {
        if (oAppComponent === undefined || oContext === undefined) {
          throw new Error("undefined AppComponent or Context for function handleStickyOn");
        }
        if (!oAppComponent.getRouterProxy().hasNavigationGuard()) {
          const sHashTracker = oAppComponent.getRouterProxy().getHash(),
            oInternalModel = this.getInternalModel();

          // Set a guard in the RouterProxy
          // A timeout is necessary, as with deferred creation the hashChanger is not updated yet with
          // the new hash, and the guard cannot be found in the managed history of the router proxy
          setTimeout(function () {
            oAppComponent.getRouterProxy().setNavigationGuard(oContext.getPath().substring(1));
          }, 0);

          // Setting back navigation on shell service, to get the dicard message box in case of sticky
          oAppComponent.getShellServices().setBackNavigation(this.onBackNavigationInSession.bind(this));
          this.fnDirtyStateProvider = this._registerDirtyStateProvider(oAppComponent, oInternalModel, sHashTracker);
          oAppComponent.getShellServices().registerDirtyStateProvider(this.fnDirtyStateProvider);

          // handle session timeout
          const i18nModel = this.getView().getModel("sap.fe.i18n");
          this.fnHandleSessionTimeout = this._attachSessionTimeout(oContext, i18nModel);
          this.getView().getModel().attachSessionTimeout(this.fnHandleSessionTimeout);
          this.fnStickyDiscardAfterNavigation = this._attachRouteMatched(this, oContext, oAppComponent);
          oAppComponent.getRoutingService().attachRouteMatched(this.fnStickyDiscardAfterNavigation);
        }
      } catch (error) {
        Log.info(error);
        return undefined;
      }
      return true;
    };
    _proto.handleStickyOff = function handleStickyOff() {
      const oAppComponent = this.getAppComponent();
      try {
        if (oAppComponent === undefined) {
          throw new Error("undefined AppComponent for function handleStickyOff");
        }
        if (oAppComponent && oAppComponent.getRouterProxy) {
          // If we have exited from the app, CommonUtils.getAppComponent doesn't return a
          // sap.fe.core.AppComponent, hence the 'if' above
          oAppComponent.getRouterProxy().discardNavigationGuard();
        }
        if (this.fnDirtyStateProvider) {
          oAppComponent.getShellServices().deregisterDirtyStateProvider(this.fnDirtyStateProvider);
          this.fnDirtyStateProvider = undefined;
        }
        if (this.getView().getModel() && this.fnHandleSessionTimeout) {
          this.getView().getModel().detachSessionTimeout(this.fnHandleSessionTimeout);
        }
        oAppComponent.getRoutingService().detachRouteMatched(this.fnStickyDiscardAfterNavigation);
        this.fnStickyDiscardAfterNavigation = undefined;
        this.setEditMode(EditMode.Display, false);
        if (oAppComponent) {
          // If we have exited from the app, CommonUtils.getAppComponent doesn't return a
          // sap.fe.core.AppComponent, hence the 'if' above
          oAppComponent.getShellServices().setBackNavigation();
        }
      } catch (error) {
        Log.info(error);
        return undefined;
      }
      return true;
    }

    /**
     * @description Method to display a 'discard' popover when exiting a sticky session.
     * @function
     * @name onBackNavigationInSession
     * @memberof sap.fe.core.controllerextensions.InternalEditFlow
     */;
    _proto.onBackNavigationInSession = function onBackNavigationInSession() {
      const oView = this.getView(),
        oAppComponent = this.getAppComponent(),
        oRouterProxy = oAppComponent.getRouterProxy();
      if (oRouterProxy.checkIfBackIsOutOfGuard()) {
        const oBindingContext = oView && oView.getBindingContext();
        sticky.processDataLossConfirmation(async () => {
          await this.discardStickySession(oBindingContext);
          history.back();
        }, oView, this.getProgrammingModel(oBindingContext));
        return;
      }
      history.back();
    };
    _proto.discardStickySession = async function discardStickySession(oContext) {
      const discardedContext = await sticky.discardDocument(oContext);
      if (discardedContext !== null && discardedContext !== void 0 && discardedContext.hasPendingChanges()) {
        discardedContext.getBinding().resetChanges();
      }
      discardedContext === null || discardedContext === void 0 ? void 0 : discardedContext.refresh();
      this.handleStickyOff();
    };
    _proto._hasNewActionForSticky = function _hasNewActionForSticky(oContext, oView, sCustomAction) {
      try {
        if (oContext === undefined || oView === undefined) {
          throw new Error("Invalid input parameters for function _hasNewActionForSticky");
        }
        const oMetaModel = oView.getModel().getMetaModel(),
          sMetaPath = oContext.getPath().substring(0, oContext.getPath().indexOf("(")),
          oStickySession = oMetaModel.getObject(`${sMetaPath}@com.sap.vocabularies.Session.v1.StickySessionSupported`);
        if (oStickySession && oStickySession.NewAction && oStickySession.NewAction === sCustomAction) {
          return true;
        } else if (oStickySession && oStickySession.AdditionalNewActions) {
          return sCustomAction === oStickySession.AdditionalNewActions.find(function (sAdditionalAction) {
            return sAdditionalAction === sCustomAction;
          }) ? true : false;
        } else {
          return false;
        }
      } catch (error) {
        Log.info(error);
        return undefined;
      }
    };
    _proto._registerDirtyStateProvider = function _registerDirtyStateProvider(oAppComponent, oInternalModel, sHashTracker) {
      return function fnDirtyStateProvider(oNavigationContext) {
        try {
          if (oNavigationContext === undefined) {
            throw new Error("Invalid input parameters for function fnDirtyStateProvider");
          }
          const sTargetHash = oNavigationContext.innerAppRoute,
            oRouterProxy = oAppComponent.getRouterProxy();
          let sLclHashTracker = "";
          let bDirty;
          const bSessionON = oInternalModel.getProperty("/sessionOn");
          if (!bSessionON) {
            // If the sticky session was terminated before hand.
            // Eexample in case of navigating away from application using IBN.
            return undefined;
          }
          if (!oRouterProxy.isNavigationFinalized()) {
            // If navigation is currently happening in RouterProxy, it's a transient state
            // (not dirty)
            bDirty = false;
            sLclHashTracker = sTargetHash;
          } else if (sHashTracker === sTargetHash) {
            // the hash didn't change so either the user attempts to refresh or to leave the app
            bDirty = true;
          } else if (oRouterProxy.checkHashWithGuard(sTargetHash) || oRouterProxy.isGuardCrossAllowedByUser()) {
            // the user attempts to navigate within the root object
            // or crossing the guard has already been allowed by the RouterProxy
            sLclHashTracker = sTargetHash;
            bDirty = false;
          } else {
            // the user attempts to navigate within the app, for example back to the list report
            bDirty = true;
          }
          if (bDirty) {
            // the FLP doesn't call the dirty state provider anymore once it's dirty, as they can't
            // change this due to compatibility reasons we set it back to not-dirty
            setTimeout(function () {
              oAppComponent.getShellServices().setDirtyFlag(false);
            }, 0);
          } else {
            sHashTracker = sLclHashTracker;
          }
          return bDirty;
        } catch (error) {
          Log.info(error);
          return undefined;
        }
      };
    };
    _proto._attachSessionTimeout = function _attachSessionTimeout(oContext, i18nModel) {
      return () => {
        try {
          if (oContext === undefined) {
            throw new Error("Context missing for function fnHandleSessionTimeout");
          }
          // remove transient messages since we will showing our own message
          this.getMessageHandler().removeTransitionMessages();
          const oDialog = new Dialog({
            title: "{sap.fe.i18n>C_EDITFLOW_OBJECT_PAGE_SESSION_EXPIRED_DIALOG_TITLE}",
            state: "Warning",
            content: new Text({
              text: "{sap.fe.i18n>C_EDITFLOW_OBJECT_PAGE_SESSION_EXPIRED_DIALOG_MESSAGE}"
            }),
            beginButton: new Button({
              text: "{sap.fe.i18n>C_COMMON_DIALOG_OK}",
              type: "Emphasized",
              press: () => {
                // remove sticky handling after navigation since session has already been terminated
                this.handleStickyOff();
                this.getRoutingListener().navigateBackFromContext(oContext);
              }
            }),
            afterClose: function () {
              oDialog.destroy();
            }
          });
          oDialog.addStyleClass("sapUiContentPadding");
          oDialog.setModel(i18nModel, "sap.fe.i18n");
          this.getView().addDependent(oDialog);
          oDialog.open();
        } catch (error) {
          Log.info(error);
          return undefined;
        }
        return true;
      };
    };
    _proto._attachRouteMatched = function _attachRouteMatched(oFnContext, oContext, oAppComponent) {
      return function fnStickyDiscardAfterNavigation() {
        const sCurrentHash = oAppComponent.getRouterProxy().getHash();
        // either current hash is empty so the user left the app or he navigated away from the object
        if (!sCurrentHash || !oAppComponent.getRouterProxy().checkHashWithGuard(sCurrentHash)) {
          oFnContext.discardStickySession(oContext);
          setTimeout(() => {
            //clear the session context to ensure the LR refreshes the list without a session
            oContext.getModel().clearSessionContext();
          }, 0);
        }
      };
    };
    _proto._scrollAndFocusOnInactiveRow = function _scrollAndFocusOnInactiveRow(table) {
      const rowBinding = table.getRowBinding();
      const activeRowIndex = rowBinding.getCount() || 0;
      if (table.data("tableType") !== "ResponsiveTable") {
        if (activeRowIndex > 0) {
          table.scrollToIndex(activeRowIndex - 1);
        }
        table.focusRow(activeRowIndex, true);
      } else {
        /* In a responsive table, the empty rows appear at the beginning of the table. But when we create more, they appear below the new line.
         * So we check the first inactive row first, then we set the focus on it when we press the button.
         * This doesn't impact the GridTable because they appear at the end, and we already focus the before-the-last row (because 2 empty rows exist)
         */
        const allRowContexts = rowBinding.getContexts();
        if (!(allRowContexts !== null && allRowContexts !== void 0 && allRowContexts.length)) {
          table.focusRow(activeRowIndex, true);
          return;
        }
        let focusRow = activeRowIndex,
          index = 0;
        for (const singleContext of allRowContexts) {
          if (singleContext.isInactive() && index < focusRow) {
            focusRow = index;
          }
          index++;
        }
        if (focusRow > 0) {
          table.scrollToIndex(focusRow);
        }
        table.focusRow(focusRow, true);
      }
    };
    _proto.createEmptyRowsAndFocus = async function createEmptyRowsAndFocus(table) {
      var _tableAPI$tableDefini, _tableAPI$tableDefini2, _table$getBindingCont;
      const tableAPI = table.getParent();
      if (tableAPI !== null && tableAPI !== void 0 && (_tableAPI$tableDefini = tableAPI.tableDefinition) !== null && _tableAPI$tableDefini !== void 0 && (_tableAPI$tableDefini2 = _tableAPI$tableDefini.control) !== null && _tableAPI$tableDefini2 !== void 0 && _tableAPI$tableDefini2.inlineCreationRowsHiddenInEditMode && !((_table$getBindingCont = table.getBindingContext("ui")) !== null && _table$getBindingCont !== void 0 && _table$getBindingCont.getProperty("createMode"))) {
        // With the parameter, we don't have empty rows in Edit mode, so we need to create them before setting the focus on them
        await tableAPI.setUpEmptyRows(table, true);
      }
      this._scrollAndFocusOnInactiveRow(table);
    };
    return InternalEditFlow;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "createMultipleDocuments", [_dec2, _dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "createMultipleDocuments"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "deleteMultipleDocuments", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "deleteMultipleDocuments"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "computeEditMode", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "computeEditMode"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "setEditMode", [_dec8, _dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "setEditMode"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "setDraftStatus", [_dec10, _dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "setDraftStatus"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getRoutingListener", [_dec12, _dec13], Object.getOwnPropertyDescriptor(_class2.prototype, "getRoutingListener"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getGlobalUIModel", [_dec14, _dec15], Object.getOwnPropertyDescriptor(_class2.prototype, "getGlobalUIModel"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "syncTask", [_dec16, _dec17], Object.getOwnPropertyDescriptor(_class2.prototype, "syncTask"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getProgrammingModel", [_dec18, _dec19], Object.getOwnPropertyDescriptor(_class2.prototype, "getProgrammingModel"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "deleteDocumentTransaction", [_dec20, _dec21], Object.getOwnPropertyDescriptor(_class2.prototype, "deleteDocumentTransaction"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "handleCreateEvents", [_dec22, _dec23], Object.getOwnPropertyDescriptor(_class2.prototype, "handleCreateEvents"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getTransactionHelper", [_dec24, _dec25], Object.getOwnPropertyDescriptor(_class2.prototype, "getTransactionHelper"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getInternalModel", [_dec26, _dec27], Object.getOwnPropertyDescriptor(_class2.prototype, "getInternalModel"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "createActionPromise", [_dec28, _dec29], Object.getOwnPropertyDescriptor(_class2.prototype, "createActionPromise"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getCurrentActionPromise", [_dec30, _dec31], Object.getOwnPropertyDescriptor(_class2.prototype, "getCurrentActionPromise"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "deleteCurrentActionPromise", [_dec32, _dec33], Object.getOwnPropertyDescriptor(_class2.prototype, "deleteCurrentActionPromise"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getActionResponseDataAndKeys", [_dec34, _dec35], Object.getOwnPropertyDescriptor(_class2.prototype, "getActionResponseDataAndKeys"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getMessageHandler", [_dec36, _dec37], Object.getOwnPropertyDescriptor(_class2.prototype, "getMessageHandler"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "handleStickyOn", [_dec38, _dec39], Object.getOwnPropertyDescriptor(_class2.prototype, "handleStickyOn"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "handleStickyOff", [_dec40, _dec41], Object.getOwnPropertyDescriptor(_class2.prototype, "handleStickyOff"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBackNavigationInSession", [_dec42, _dec43], Object.getOwnPropertyDescriptor(_class2.prototype, "onBackNavigationInSession"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "discardStickySession", [_dec44, _dec45], Object.getOwnPropertyDescriptor(_class2.prototype, "discardStickySession"), _class2.prototype)), _class2)) || _class);
  return InternalEditFlow;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/InternalEditFlow", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/fe/core/controllerextensions/collaboration/CollaborationCommon","sap/fe/core/controllerextensions/editFlow/sticky","sap/fe/core/controllerextensions/editFlow/TransactionHelper","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/EditState","sap/fe/core/library","sap/m/Button","sap/m/Dialog","sap/m/Text","sap/ui/core/mvc/ControllerExtension"],function(t,e,o,n,i,r,s,a,c,l,d,p,u,g){"use strict";var f,h,y,m,P,w,S,v,M,b,D,O,C,E,A,k,I,T,R,x,_,j,B,N,H,G,F,V,U,L,$,z,K,W,q,J,X,Q,Y,Z,tt,et,ot,nt,it,rt,st;var at=a.publicExtension;var ct=a.finalExtension;var lt=a.defineUI5Class;var dt=i.Activity;var pt=n.send;function ut(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;gt(t,e)}function gt(t,e){gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,o){e.__proto__=o;return e};return gt(t,e)}function ft(t,e,o,n,i){var r={};Object.keys(n).forEach(function(t){r[t]=n[t]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(t,e,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(t,e,r);r=null}return r}const ht=l.ProgrammingModel,yt=l.DraftStatus,mt=l.EditMode,Pt=l.CreationMode;let wt=(f=lt("sap.fe.core.controllerextensions.InternalEditFlow"),h=at(),y=ct(),m=at(),P=ct(),w=at(),S=ct(),v=at(),M=ct(),b=at(),D=ct(),O=at(),C=ct(),E=at(),A=ct(),k=at(),I=ct(),T=at(),R=ct(),x=at(),_=ct(),j=at(),B=ct(),N=at(),H=ct(),G=at(),F=ct(),V=at(),U=ct(),L=at(),$=ct(),z=at(),K=ct(),W=at(),q=ct(),J=at(),X=ct(),Q=at(),Y=ct(),Z=at(),tt=ct(),et=at(),ot=ct(),nt=at(),it=ct(),f(rt=(st=function(n){ut(i,n);function i(){return n.apply(this,arguments)||this}var a=i.prototype;a.getAppComponent=function t(){return this.base.getAppComponent()};a.setCreationMode=function t(e){const o=this.base.getView().getBindingContext("ui");this.getGlobalUIModel().setProperty("createMode",e,o,true)};a.getCreationMode=function t(){const e=this.base.getView().getBindingContext("ui");return!!this.getGlobalUIModel().getProperty("createMode",e)};a.isDocumentModified=function t(){return!!this.getGlobalUIModel().getProperty("/isDocumentModified")};a.setDocumentModified=function t(e){this.getGlobalUIModel().setProperty("/isDocumentModified",e)};a.setDocumentModifiedOnCreate=function t(e){if(e.isRelative()){this.setDocumentModified(true)}};a.createMultipleDocuments=function n(i,r,s,a,c){let l=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;const d=this.getTransactionHelper(),p=this.getGlobalUIModel();o.lock(p);let u=[];return this.syncTask().then(()=>c?c({contextPath:i&&i.getPath()}):Promise.resolve()).then(()=>{const t=i.getModel(),e=t.getMetaModel();let o;if(i.getContext()){o=e.getMetaPath(`${i.getContext().getPath()}/${i.getPath()}`)}else{o=e.getMetaPath(i.getPath())}this.handleCreateEvents(i);const n=r.map(t=>{const n={data:{}};n.keepTransientContextOnFailed=false;n.busyMode="None";n.creationMode=Pt.CreationRow;n.parentControl=this.getView();n.createAtEnd=s;n.inactive=l;for(const i in t){const r=e.getObject(`${o}/${i}`);if(r&&r.$kind!=="NavigationProperty"&&t[i]){n.data[i]=t[i]}}return d.createDocument(i,n,this.getAppComponent(),this.getMessageHandler(),a,this.getView())});return Promise.all(n)}).then(t=>{if(!l){this.setDocumentModifiedOnCreate(i)}u=t;return Promise.all(t.map(function(t){if(!t.bInactive){return t.created()}}))}).then(()=>{const t=this.getView().getBindingContext();if(!e.hasTransientContext(i)){this.getAppComponent().getSideEffectsService().requestSideEffectsForNavigationProperty(i.getPath(),t)}}).catch(function(e){t.error("Error while creating multiple documents.");return Promise.reject(e)}).finally(function(){o.unlock(p)}).then(()=>u)};a.deleteMultipleDocuments=function n(i,r){const s=this.getGlobalUIModel();const a=this.getView().byId(r.controlId);if(!a){throw new Error("parameter controlId missing or incorrect")}else{r.parentControl=a}const l=a.getBinding("items")||a.getRowBinding();r.bFindActiveContexts=true;o.lock(s);return this.deleteDocumentTransaction(i,r).then(()=>{let t;if(a.isA("sap.ui.mdc.Table")){a.clearSelection()}const o=this.getView().getBindingContext();if(l.isRoot()){t=new Promise(t=>{l.attachEventOnce("dataReceived",function(){t()})});l.refresh()}else if(o){if(!e.hasTransientContext(l)){this.getAppComponent().getSideEffectsService().requestSideEffectsForNavigationProperty(l.getPath(),o)}}if(!this.getAppComponent()._isFclEnabled()){c.setEditStateDirty()}pt(this.getView(),dt.Delete,i.map(t=>t.getPath()));return t}).catch(function(e){t.error("Error while deleting the document(s)",e)}).finally(function(){o.unlock(s)})};a.computeEditMode=async function e(o){const n=this.getProgrammingModel(o);if(n===ht.Draft){try{this.setDraftStatus(yt.Clear);this._setEditablePending(true);const t=await o.requestObject("IsActiveEntity");if(t===false){this.setEditMode(mt.Editable);const t=await o.requestObject("HasActiveEntity");this.setEditMode(undefined,!t)}else{this.setEditMode(mt.Display,false)}this._setEditablePending(false)}catch(e){t.error("Error while determining the editMode for draft",e);throw e}}else if(n===ht.Sticky){const t=this.getInternalModel().getProperty("/lastInvokedAction");if(t&&this._hasNewActionForSticky(o,this.getView(),t)){this.setEditMode(mt.Editable,true);if(!this.getAppComponent()._isFclEnabled()){c.setEditStateDirty()}this.handleStickyOn(o);this.getInternalModel().setProperty("/lastInvokedAction",undefined)}}};a.setEditMode=function t(e,o){const n=this.getGlobalUIModel();if(e){n.setProperty("/isEditable",e==="Editable",undefined,true)}if(o!==undefined){this.setCreationMode(o)}};a._setEditablePending=function t(e){const o=this.getGlobalUIModel();o.setProperty("/isEditablePending",e,undefined,true)};a.setDraftStatus=function t(e){this.base.getView().getModel("ui").setProperty("/draftStatus",e,undefined,true)};a.getRoutingListener=function t(){if(this.base._routing){return this.base._routing}else{throw new Error("Edit Flow works only with a given routing listener")}};a.getGlobalUIModel=function t(){return this.base.getView().getModel("ui")};a.syncTask=function t(e){let o;if(e instanceof Promise){o=function(){return e}}else if(typeof e==="function"){o=e}this._pTasks=this._pTasks||Promise.resolve();if(o){this._pTasks=this._pTasks.then(o).catch(function(){return Promise.resolve()})}return this._pTasks};a.getProgrammingModel=function t(e){return this.getTransactionHelper().getProgrammingModel(e)};a.deleteDocumentTransaction=async function t(e,o){var n;const i=this.getView().getController().oResourceBundle,r=this.getTransactionHelper();o=o||{};o.internalModelContext=o.controlId?(n=sap.ui.getCore().byId(o.controlId))===null||n===void 0?void 0:n.getBindingContext("internal"):null;await this.syncTask();await r.deleteDocument(e,o,this.getAppComponent(),i,this.getMessageHandler());const s=this.getInternalModel();s.setProperty("/sessionOn",false);s.setProperty("/stickySessionToken",undefined)};a.handleCreateEvents=function t(e){this.setDraftStatus(yt.Clear);e=e.getBinding&&e.getBinding()||e;const o=this.getProgrammingModel(e);e.attachEvent("createSent",()=>{if(o===ht.Draft){this.setDraftStatus(yt.Saving)}});e.attachEvent("createCompleted",t=>{const e=t.getParameter("success");if(o===ht.Draft){this.setDraftStatus(e?yt.Saved:yt.Clear)}this.getMessageHandler().showMessageDialog()})};a.getTransactionHelper=function t(){return s};a.getInternalModel=function t(){return this.base.getView().getModel("internal")};a.createActionPromise=function t(e,o){let n,i;this.oActionPromise=new Promise((t,e)=>{n=t;i=e}).then(t=>Object.assign({controlId:o},this.getActionResponseDataAndKeys(e,t)));return{fResolver:n,fRejector:i}};a.getCurrentActionPromise=function t(){return this.oActionPromise};a.deleteCurrentActionPromise=function t(){this.oActionPromise=undefined};a.getActionResponseDataAndKeys=function t(e,o){if(Array.isArray(o)){if(o.length===1){o=o[0].value}else{return null}}if(!o){return null}const n=this.getView(),i=n.getModel().getMetaModel().getData(),r=i&&i[e]&&i[e][0]&&i[e][0].$ReturnType?i[e][0].$ReturnType.$Type:null,s=r&&i[r]?i[r].$Key:null;return{oData:o.getObject(),keys:s}};a.getMessageHandler=function t(){if(this.base.messageHandler){return this.base.messageHandler}else{throw new Error("Edit Flow works only with a given message handler")}};a.handleStickyOn=function e(o){const n=this.getAppComponent();try{if(n===undefined||o===undefined){throw new Error("undefined AppComponent or Context for function handleStickyOn")}if(!n.getRouterProxy().hasNavigationGuard()){const t=n.getRouterProxy().getHash(),e=this.getInternalModel();setTimeout(function(){n.getRouterProxy().setNavigationGuard(o.getPath().substring(1))},0);n.getShellServices().setBackNavigation(this.onBackNavigationInSession.bind(this));this.fnDirtyStateProvider=this._registerDirtyStateProvider(n,e,t);n.getShellServices().registerDirtyStateProvider(this.fnDirtyStateProvider);const i=this.getView().getModel("sap.fe.i18n");this.fnHandleSessionTimeout=this._attachSessionTimeout(o,i);this.getView().getModel().attachSessionTimeout(this.fnHandleSessionTimeout);this.fnStickyDiscardAfterNavigation=this._attachRouteMatched(this,o,n);n.getRoutingService().attachRouteMatched(this.fnStickyDiscardAfterNavigation)}}catch(e){t.info(e);return undefined}return true};a.handleStickyOff=function e(){const o=this.getAppComponent();try{if(o===undefined){throw new Error("undefined AppComponent for function handleStickyOff")}if(o&&o.getRouterProxy){o.getRouterProxy().discardNavigationGuard()}if(this.fnDirtyStateProvider){o.getShellServices().deregisterDirtyStateProvider(this.fnDirtyStateProvider);this.fnDirtyStateProvider=undefined}if(this.getView().getModel()&&this.fnHandleSessionTimeout){this.getView().getModel().detachSessionTimeout(this.fnHandleSessionTimeout)}o.getRoutingService().detachRouteMatched(this.fnStickyDiscardAfterNavigation);this.fnStickyDiscardAfterNavigation=undefined;this.setEditMode(mt.Display,false);if(o){o.getShellServices().setBackNavigation()}}catch(e){t.info(e);return undefined}return true};a.onBackNavigationInSession=function t(){const e=this.getView(),o=this.getAppComponent(),n=o.getRouterProxy();if(n.checkIfBackIsOutOfGuard()){const t=e&&e.getBindingContext();r.processDataLossConfirmation(async()=>{await this.discardStickySession(t);history.back()},e,this.getProgrammingModel(t));return}history.back()};a.discardStickySession=async function t(e){const o=await r.discardDocument(e);if(o!==null&&o!==void 0&&o.hasPendingChanges()){o.getBinding().resetChanges()}o===null||o===void 0?void 0:o.refresh();this.handleStickyOff()};a._hasNewActionForSticky=function e(o,n,i){try{if(o===undefined||n===undefined){throw new Error("Invalid input parameters for function _hasNewActionForSticky")}const t=n.getModel().getMetaModel(),e=o.getPath().substring(0,o.getPath().indexOf("(")),r=t.getObject(`${e}@com.sap.vocabularies.Session.v1.StickySessionSupported`);if(r&&r.NewAction&&r.NewAction===i){return true}else if(r&&r.AdditionalNewActions){return i===r.AdditionalNewActions.find(function(t){return t===i})?true:false}else{return false}}catch(e){t.info(e);return undefined}};a._registerDirtyStateProvider=function e(o,n,i){return function e(r){try{if(r===undefined){throw new Error("Invalid input parameters for function fnDirtyStateProvider")}const t=r.innerAppRoute,e=o.getRouterProxy();let s="";let a;const c=n.getProperty("/sessionOn");if(!c){return undefined}if(!e.isNavigationFinalized()){a=false;s=t}else if(i===t){a=true}else if(e.checkHashWithGuard(t)||e.isGuardCrossAllowedByUser()){s=t;a=false}else{a=true}if(a){setTimeout(function(){o.getShellServices().setDirtyFlag(false)},0)}else{i=s}return a}catch(e){t.info(e);return undefined}}};a._attachSessionTimeout=function e(o,n){return()=>{try{if(o===undefined){throw new Error("Context missing for function fnHandleSessionTimeout")}this.getMessageHandler().removeTransitionMessages();const t=new p({title:"{sap.fe.i18n>C_EDITFLOW_OBJECT_PAGE_SESSION_EXPIRED_DIALOG_TITLE}",state:"Warning",content:new u({text:"{sap.fe.i18n>C_EDITFLOW_OBJECT_PAGE_SESSION_EXPIRED_DIALOG_MESSAGE}"}),beginButton:new d({text:"{sap.fe.i18n>C_COMMON_DIALOG_OK}",type:"Emphasized",press:()=>{this.handleStickyOff();this.getRoutingListener().navigateBackFromContext(o)}}),afterClose:function(){t.destroy()}});t.addStyleClass("sapUiContentPadding");t.setModel(n,"sap.fe.i18n");this.getView().addDependent(t);t.open()}catch(e){t.info(e);return undefined}return true}};a._attachRouteMatched=function t(e,o,n){return function t(){const i=n.getRouterProxy().getHash();if(!i||!n.getRouterProxy().checkHashWithGuard(i)){e.discardStickySession(o);setTimeout(()=>{o.getModel().clearSessionContext()},0)}}};a._scrollAndFocusOnInactiveRow=function t(e){const o=e.getRowBinding();const n=o.getCount()||0;if(e.data("tableType")!=="ResponsiveTable"){if(n>0){e.scrollToIndex(n-1)}e.focusRow(n,true)}else{const t=o.getContexts();if(!(t!==null&&t!==void 0&&t.length)){e.focusRow(n,true);return}let i=n,r=0;for(const e of t){if(e.isInactive()&&r<i){i=r}r++}if(i>0){e.scrollToIndex(i)}e.focusRow(i,true)}};a.createEmptyRowsAndFocus=async function t(e){var o,n,i;const r=e.getParent();if(r!==null&&r!==void 0&&(o=r.tableDefinition)!==null&&o!==void 0&&(n=o.control)!==null&&n!==void 0&&n.inlineCreationRowsHiddenInEditMode&&!((i=e.getBindingContext("ui"))!==null&&i!==void 0&&i.getProperty("createMode"))){await r.setUpEmptyRows(e,true)}this._scrollAndFocusOnInactiveRow(e)};return i}(g),ft(st.prototype,"createMultipleDocuments",[h,y],Object.getOwnPropertyDescriptor(st.prototype,"createMultipleDocuments"),st.prototype),ft(st.prototype,"deleteMultipleDocuments",[m,P],Object.getOwnPropertyDescriptor(st.prototype,"deleteMultipleDocuments"),st.prototype),ft(st.prototype,"computeEditMode",[w,S],Object.getOwnPropertyDescriptor(st.prototype,"computeEditMode"),st.prototype),ft(st.prototype,"setEditMode",[v,M],Object.getOwnPropertyDescriptor(st.prototype,"setEditMode"),st.prototype),ft(st.prototype,"setDraftStatus",[b,D],Object.getOwnPropertyDescriptor(st.prototype,"setDraftStatus"),st.prototype),ft(st.prototype,"getRoutingListener",[O,C],Object.getOwnPropertyDescriptor(st.prototype,"getRoutingListener"),st.prototype),ft(st.prototype,"getGlobalUIModel",[E,A],Object.getOwnPropertyDescriptor(st.prototype,"getGlobalUIModel"),st.prototype),ft(st.prototype,"syncTask",[k,I],Object.getOwnPropertyDescriptor(st.prototype,"syncTask"),st.prototype),ft(st.prototype,"getProgrammingModel",[T,R],Object.getOwnPropertyDescriptor(st.prototype,"getProgrammingModel"),st.prototype),ft(st.prototype,"deleteDocumentTransaction",[x,_],Object.getOwnPropertyDescriptor(st.prototype,"deleteDocumentTransaction"),st.prototype),ft(st.prototype,"handleCreateEvents",[j,B],Object.getOwnPropertyDescriptor(st.prototype,"handleCreateEvents"),st.prototype),ft(st.prototype,"getTransactionHelper",[N,H],Object.getOwnPropertyDescriptor(st.prototype,"getTransactionHelper"),st.prototype),ft(st.prototype,"getInternalModel",[G,F],Object.getOwnPropertyDescriptor(st.prototype,"getInternalModel"),st.prototype),ft(st.prototype,"createActionPromise",[V,U],Object.getOwnPropertyDescriptor(st.prototype,"createActionPromise"),st.prototype),ft(st.prototype,"getCurrentActionPromise",[L,$],Object.getOwnPropertyDescriptor(st.prototype,"getCurrentActionPromise"),st.prototype),ft(st.prototype,"deleteCurrentActionPromise",[z,K],Object.getOwnPropertyDescriptor(st.prototype,"deleteCurrentActionPromise"),st.prototype),ft(st.prototype,"getActionResponseDataAndKeys",[W,q],Object.getOwnPropertyDescriptor(st.prototype,"getActionResponseDataAndKeys"),st.prototype),ft(st.prototype,"getMessageHandler",[J,X],Object.getOwnPropertyDescriptor(st.prototype,"getMessageHandler"),st.prototype),ft(st.prototype,"handleStickyOn",[Q,Y],Object.getOwnPropertyDescriptor(st.prototype,"handleStickyOn"),st.prototype),ft(st.prototype,"handleStickyOff",[Z,tt],Object.getOwnPropertyDescriptor(st.prototype,"handleStickyOff"),st.prototype),ft(st.prototype,"onBackNavigationInSession",[et,ot],Object.getOwnPropertyDescriptor(st.prototype,"onBackNavigationInSession"),st.prototype),ft(st.prototype,"discardStickySession",[nt,it],Object.getOwnPropertyDescriptor(st.prototype,"discardStickySession"),st.prototype),st))||rt);return wt},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/InternalIntentBasedNavigation-dbg", ["sap/base/Log", "sap/base/util/merge", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/editFlow/draft", "sap/fe/core/converters/MetaModelConverter", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/KeepAliveHelper", "sap/fe/core/helpers/ModelHelper", "sap/fe/navigation/SelectionVariant", "sap/ui/core/Core", "sap/ui/core/Fragment", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "sap/ui/core/util/XMLPreprocessor", "sap/ui/core/XMLTemplateProcessor", "sap/ui/model/json/JSONModel", "../converters/helpers/Aggregation"], function (Log, mergeObjects, CommonUtils, draft, MetaModelConverter, ClassSupport, KeepAliveHelper, ModelHelper, SelectionVariant, Core, Fragment, ControllerExtension, OverrideExecution, XMLPreprocessor, XMLTemplateProcessor, JSONModel, Aggregation) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _class, _class2;
  var AggregationHelper = Aggregation.AggregationHelper;
  var publicExtension = ClassSupport.publicExtension;
  var privateExtension = ClassSupport.privateExtension;
  var methodOverride = ClassSupport.methodOverride;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * {@link sap.ui.core.mvc.ControllerExtension Controller extension}
   *
   * @namespace
   * @alias sap.fe.core.controllerextensions.InternalInternalBasedNavigation
   * @private
   * @since 1.84.0
   */
  let InternalIntentBasedNavigation = (_dec = defineUI5Class("sap.fe.core.controllerextensions.InternalInternalBasedNavigation"), _dec2 = methodOverride(), _dec3 = publicExtension(), _dec4 = finalExtension(), _dec5 = publicExtension(), _dec6 = finalExtension(), _dec7 = publicExtension(), _dec8 = finalExtension(), _dec9 = publicExtension(), _dec10 = extensible(OverrideExecution.Instead), _dec11 = publicExtension(), _dec12 = finalExtension(), _dec13 = privateExtension(), _dec14 = publicExtension(), _dec15 = finalExtension(), _dec16 = publicExtension(), _dec17 = finalExtension(), _dec18 = publicExtension(), _dec19 = finalExtension(), _dec20 = publicExtension(), _dec21 = finalExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(InternalIntentBasedNavigation, _ControllerExtension);
    function InternalIntentBasedNavigation() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = InternalIntentBasedNavigation.prototype;
    _proto.onInit = function onInit() {
      this._oAppComponent = this.base.getAppComponent();
      this._oMetaModel = this._oAppComponent.getModel().getMetaModel();
      this._oNavigationService = this._oAppComponent.getNavigationService();
      this._oView = this.base.getView();
    }

    /**
     * Enables intent-based navigation (SemanticObject-Action) with the provided context.
     * If semantic object mapping is provided, this is also applied to the selection variant after the adaptation by a consumer.
     * This takes care of removing any technical parameters and determines if an explace or inplace navigation should take place.
     *
     * @param sSemanticObject Semantic object for the target app
     * @param sAction  Action for the target app
     * @param [mNavigationParameters] Optional parameters to be passed to the external navigation
     * @param [mNavigationParameters.navigationContexts] Uses one of the following to be passed to the intent:
     *    a single instance of {@link sap.ui.model.odata.v4.Context}
     *    multiple instances of {@link sap.ui.model.odata.v4.Context}
     *    an object or an array of objects
     *		  If an array of objects is passed, the context is used to determine the metaPath and to remove any sensitive data
     *		  If an array of objects is passed, the following format ix expected:
     *		  {
     *			data: {
     *	 			ProductID: 7634,
     *				Name: "Laptop"
     *			 },
     *			 metaPath: "/SalesOrderManage"
     *        }
     * @param [mNavigationParameters.semanticObjectMapping] String representation of the SemanticObjectMapping or SemanticObjectMapping that applies to this navigation
     * @param [mNavigationParameters.defaultRefreshStrategy] Default refresh strategy to be used in case no refresh strategy is specified for the intent in the view.
     * @param [mNavigationParameters.refreshStrategies]
     * @param [mNavigationParameters.additionalNavigationParameters] Additional navigation parameters configured in the crossAppNavigation outbound parameters.
     */;
    _proto.navigate = function navigate(sSemanticObject, sAction, mNavigationParameters) {
      const _doNavigate = oContext => {
        const vNavigationContexts = mNavigationParameters && mNavigationParameters.navigationContexts,
          aNavigationContexts = vNavigationContexts && !Array.isArray(vNavigationContexts) ? [vNavigationContexts] : vNavigationContexts,
          vSemanticObjectMapping = mNavigationParameters && mNavigationParameters.semanticObjectMapping,
          vOutboundParams = mNavigationParameters && mNavigationParameters.additionalNavigationParameters,
          oTargetInfo = {
            semanticObject: sSemanticObject,
            action: sAction
          },
          oView = this.base.getView(),
          oController = oView.getController();
        if (oContext) {
          this._oView.setBindingContext(oContext);
        }
        if (sSemanticObject && sAction) {
          let aSemanticAttributes = [],
            oSelectionVariant = new SelectionVariant();
          // 1. get SemanticAttributes for navigation
          if (aNavigationContexts && aNavigationContexts.length) {
            aNavigationContexts.forEach(oNavigationContext => {
              // 1.1.a if navigation context is instance of sap.ui.mode.odata.v4.Context
              // else check if navigation context is of type object
              if (oNavigationContext.isA && oNavigationContext.isA("sap.ui.model.odata.v4.Context")) {
                // 1.1.b remove sensitive data
                let oSemanticAttributes = oNavigationContext.getObject();
                const sMetaPath = this._oMetaModel.getMetaPath(oNavigationContext.getPath());
                // TODO: also remove sensitive data from  navigation properties
                oSemanticAttributes = this.removeSensitiveData(oSemanticAttributes, sMetaPath);
                const oNavContext = this.prepareContextForExternalNavigation(oSemanticAttributes, oNavigationContext);
                oTargetInfo["propertiesWithoutConflict"] = oNavContext.propertiesWithoutConflict;
                aSemanticAttributes.push(oNavContext.semanticAttributes);
              } else if (!(oNavigationContext && Array.isArray(oNavigationContext.data)) && typeof oNavigationContext === "object") {
                // 1.1.b remove sensitive data from object
                aSemanticAttributes.push(this.removeSensitiveData(oNavigationContext.data, oNavigationContext.metaPath));
              } else if (oNavigationContext && Array.isArray(oNavigationContext.data)) {
                // oNavigationContext.data can be array already ex : [{Customer: "10001"}, {Customer: "10091"}]
                // hence assigning it to the aSemanticAttributes
                aSemanticAttributes = this.removeSensitiveData(oNavigationContext.data, oNavigationContext.metaPath);
              }
            });
          }
          // 2.1 Merge base selection variant and sanitized semantic attributes into one SelectionVariant
          if (aSemanticAttributes && aSemanticAttributes.length) {
            oSelectionVariant = this._oNavigationService.mixAttributesAndSelectionVariant(aSemanticAttributes, oSelectionVariant.toJSONString());
          }

          // 3. Add filterContextUrl to SV so the NavigationHandler can remove any sensitive data based on view entitySet
          const oModel = this._oView.getModel(),
            sEntitySet = this.getEntitySet(),
            sContextUrl = sEntitySet ? this._oNavigationService.constructContextUrl(sEntitySet, oModel) : undefined;
          if (sContextUrl) {
            oSelectionVariant.setFilterContextUrl(sContextUrl);
          }

          // Apply Outbound Parameters to the SV
          if (vOutboundParams) {
            this._applyOutboundParams(oSelectionVariant, vOutboundParams);
          }

          // 4. give an opportunity for the application to influence the SelectionVariant
          oController.intentBasedNavigation.adaptNavigationContext(oSelectionVariant, oTargetInfo);

          // 5. Apply semantic object mappings to the SV
          if (vSemanticObjectMapping) {
            this._applySemanticObjectMappings(oSelectionVariant, vSemanticObjectMapping);
          }

          // 6. remove technical parameters from Selection Variant
          this._removeTechnicalParameters(oSelectionVariant);

          // 7. check if programming model is sticky and page is editable
          const sNavMode = oController._intentBasedNavigation.getNavigationMode();

          // 8. Updating refresh strategy in internal model
          const mRefreshStrategies = mNavigationParameters && mNavigationParameters.refreshStrategies || {},
            oInternalModel = oView.getModel("internal");
          if (oInternalModel) {
            if ((oView && oView.getViewData()).refreshStrategyOnAppRestore) {
              const mViewRefreshStrategies = oView.getViewData().refreshStrategyOnAppRestore || {};
              mergeObjects(mRefreshStrategies, mViewRefreshStrategies);
            }
            const mRefreshStrategy = KeepAliveHelper.getRefreshStrategyForIntent(mRefreshStrategies, sSemanticObject, sAction);
            if (mRefreshStrategy) {
              oInternalModel.setProperty("/refreshStrategyOnAppRestore", mRefreshStrategy);
            }
          }

          // 9. Navigate via NavigationHandler
          const onError = function () {
            sap.ui.require(["sap/m/MessageBox"], function (MessageBox) {
              const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
              MessageBox.error(oResourceBundle.getText("C_COMMON_HELPER_NAVIGATION_ERROR_MESSAGE"), {
                title: oResourceBundle.getText("C_COMMON_SAPFE_ERROR")
              });
            });
          };
          this._oNavigationService.navigate(sSemanticObject, sAction, oSelectionVariant.toJSONString(), undefined, onError, undefined, sNavMode);
        } else {
          throw new Error("Semantic Object/action is not provided");
        }
      };
      const oBindingContext = this.base.getView().getBindingContext();
      const oMetaModel = oBindingContext && oBindingContext.getModel().getMetaModel();
      if (this.getView().getViewData().converterType === "ObjectPage" && oMetaModel && !ModelHelper.isStickySessionSupported(oMetaModel)) {
        draft.processDataLossOrDraftDiscardConfirmation(_doNavigate.bind(this), Function.prototype, this.base.getView().getBindingContext(), this.base.getView().getController(), true, draft.NavigationType.ForwardNavigation);
      } else {
        _doNavigate();
      }
    }

    /**
     * Prepare attributes to be passed to external navigation.
     *
     * @param oSemanticAttributes Context data after removing all sensitive information.
     * @param oContext Actual context from which the semanticAttributes were derived.
     * @returns Object of prepared attributes for external navigation and no conflict properties.
     */;
    _proto.prepareContextForExternalNavigation = function prepareContextForExternalNavigation(oSemanticAttributes, oContext) {
      // 1. Find all distinct keys in the object SemanticAttributes
      // Store meta path for each occurence of the key
      const oDistinctKeys = {},
        sContextPath = oContext.getPath(),
        oMetaModel = oContext.getModel().getMetaModel(),
        sMetaPath = oMetaModel.getMetaPath(sContextPath),
        aMetaPathParts = sMetaPath.split("/").filter(Boolean);
      function _findDistinctKeysInObject(LookUpObject, sLookUpObjectMetaPath) {
        for (const sKey in LookUpObject) {
          // null case??
          if (LookUpObject[sKey] === null || typeof LookUpObject[sKey] !== "object") {
            if (!oDistinctKeys[sKey]) {
              // if key is found for the first time then create array
              oDistinctKeys[sKey] = [];
            }
            // push path to array
            oDistinctKeys[sKey].push(sLookUpObjectMetaPath);
          } else {
            // if a nested object is found
            const oNewLookUpObject = LookUpObject[sKey];
            _findDistinctKeysInObject(oNewLookUpObject, `${sLookUpObjectMetaPath}/${sKey}`);
          }
        }
      }
      _findDistinctKeysInObject(oSemanticAttributes, sMetaPath);

      // 2. Determine distinct key value and add conflicted paths to semantic attributes
      const sMainEntitySetName = aMetaPathParts[0],
        sMainEntityTypeName = oMetaModel.getObject(`/${sMainEntitySetName}/@sapui.name`),
        oPropertiesWithoutConflict = {};
      let sMainEntityValuePath, sCurrentValuePath, sLastValuePath;
      for (const sDistinctKey in oDistinctKeys) {
        const aConflictingPaths = oDistinctKeys[sDistinctKey];
        let sWinnerValuePath;
        // Find winner value for each distinct key in case of conflict by the following rule:

        // -> A. if any meta path for a distinct key is the same as main entity take that as the value
        // -> B. if A is not met keep the value from the current context (sMetaPath === path of distince key)
        // -> C. if A, B or C are not met take the last path for value
        if (aConflictingPaths.length > 1) {
          // conflict
          for (let i = 0; i <= aConflictingPaths.length - 1; i++) {
            const sPath = aConflictingPaths[i];
            let sPathInContext = sPath.replace(sPath === sMetaPath ? sMetaPath : `${sMetaPath}/`, "");
            sPathInContext = (sPathInContext === "" ? sPathInContext : `${sPathInContext}/`) + sDistinctKey;
            const sEntityTypeName = oMetaModel.getObject(`${sPath}/@sapui.name`);
            // rule A

            // rule A
            if (sEntityTypeName === sMainEntityTypeName) {
              sMainEntityValuePath = sPathInContext;
            }

            // rule B
            if (sPath === sMetaPath) {
              sCurrentValuePath = sPathInContext;
            }

            // rule C
            sLastValuePath = sPathInContext;

            // add conflicted path to semantic attributes
            // check if the current path points to main entity and prefix attribute names accordingly
            oSemanticAttributes[`${sMetaPath}/${sPathInContext}`.split("/").filter(function (sValue) {
              return sValue != "";
            }).join(".")] = oContext.getProperty(sPathInContext);
          }
          // A || B || C
          sWinnerValuePath = sMainEntityValuePath || sCurrentValuePath || sLastValuePath;
          oSemanticAttributes[sDistinctKey] = oContext.getProperty(sWinnerValuePath);
          sMainEntityValuePath = undefined;
          sCurrentValuePath = undefined;
          sLastValuePath = undefined;
        } else {
          // no conflict, add distinct key without adding paths
          const sPath = aConflictingPaths[0]; // because there is only one and hence no conflict
          let sPathInContext = sPath.replace(sPath === sMetaPath ? sMetaPath : `${sMetaPath}/`, "");
          sPathInContext = (sPathInContext === "" ? sPathInContext : `${sPathInContext}/`) + sDistinctKey;
          oSemanticAttributes[sDistinctKey] = oContext.getProperty(sPathInContext);
          oPropertiesWithoutConflict[sDistinctKey] = `${sMetaPath}/${sPathInContext}`.split("/").filter(function (sValue) {
            return sValue != "";
          }).join(".");
        }
      }
      // 3. Remove all Navigation properties
      for (const sProperty in oSemanticAttributes) {
        if (oSemanticAttributes[sProperty] !== null && typeof oSemanticAttributes[sProperty] === "object") {
          delete oSemanticAttributes[sProperty];
        }
      }
      return {
        semanticAttributes: oSemanticAttributes,
        propertiesWithoutConflict: oPropertiesWithoutConflict
      };
    }
    /**
     * Prepare filter conditions to be passed to external navigation.
     *
     * @param oFilterBarConditions Filter conditions.
     * @param sRootPath Root path of the application.
     * @param aParameters Names of parameters to be considered.
     * @returns Object of prepared filter conditions for external navigation and no conflict filters.
     */;
    _proto.prepareFiltersForExternalNavigation = function prepareFiltersForExternalNavigation(oFilterBarConditions, sRootPath, aParameters) {
      let sPath;
      const oDistinctKeys = {};
      const oFilterConditionsWithoutConflict = {};
      let sMainEntityValuePath, sCurrentValuePath, sFullContextPath, sWinnerValuePath, sPathInContext;
      function _findDistinctKeysInObject(LookUpObject) {
        let sLookUpObjectMetaPath;
        for (let sKey in LookUpObject) {
          if (LookUpObject[sKey]) {
            if (sKey.includes("/")) {
              sLookUpObjectMetaPath = sKey; // "/SalesOrdermanage/_Item/Material"
              const aPathParts = sKey.split("/");
              sKey = aPathParts[aPathParts.length - 1];
            } else {
              sLookUpObjectMetaPath = sRootPath;
            }
            if (!oDistinctKeys[sKey]) {
              // if key is found for the first time then create array
              oDistinctKeys[sKey] = [];
            }

            // push path to array
            oDistinctKeys[sKey].push(sLookUpObjectMetaPath);
          }
        }
      }
      _findDistinctKeysInObject(oFilterBarConditions);
      for (const sDistinctKey in oDistinctKeys) {
        const aConflictingPaths = oDistinctKeys[sDistinctKey];
        if (aConflictingPaths.length > 1) {
          // conflict
          for (let i = 0; i <= aConflictingPaths.length - 1; i++) {
            sPath = aConflictingPaths[i];
            if (sPath === sRootPath) {
              sFullContextPath = `${sRootPath}/${sDistinctKey}`;
              sPathInContext = sDistinctKey;
              sMainEntityValuePath = sDistinctKey;
              if (aParameters && aParameters.includes(sDistinctKey)) {
                oFilterBarConditions[`$Parameter.${sDistinctKey}`] = oFilterBarConditions[sDistinctKey];
              }
            } else {
              sPathInContext = sPath;
              sFullContextPath = `${sRootPath}/${sPath}`.replaceAll(/\*/g, "");
              sCurrentValuePath = sPath;
            }
            oFilterBarConditions[sFullContextPath.split("/").filter(function (sValue) {
              return sValue != "";
            }).join(".")] = oFilterBarConditions[sPathInContext];
            delete oFilterBarConditions[sPath];
          }
          sWinnerValuePath = sMainEntityValuePath || sCurrentValuePath;
          oFilterBarConditions[sDistinctKey] = oFilterBarConditions[sWinnerValuePath];
        } else {
          // no conflict, add distinct key without adding paths
          sPath = aConflictingPaths[0];
          sFullContextPath = sPath === sRootPath ? `${sRootPath}/${sDistinctKey}` : `${sRootPath}/${sPath}`.replaceAll("*", "");
          oFilterConditionsWithoutConflict[sDistinctKey] = sFullContextPath.split("/").filter(function (sValue) {
            return sValue != "";
          }).join(".");
          if (aParameters && aParameters.includes(sDistinctKey)) {
            oFilterBarConditions[`$Parameter.${sDistinctKey}`] = oFilterBarConditions[sDistinctKey];
          }
        }
      }
      return {
        filterConditions: oFilterBarConditions,
        filterConditionsWithoutConflict: oFilterConditionsWithoutConflict
      };
    }

    /**
     * Get Navigation mode.
     *
     * @returns The navigation mode
     */;
    _proto.getNavigationMode = function getNavigationMode() {
      return undefined;
    }
    /**
     * Allows for navigation to a given intent (SemanticObject-Action) with the provided context, using a dialog that shows the contexts which cannot be passed
     * If semantic object mapping is provided, this setting is also applied to the selection variant after adaptation by a consumer.
     * This setting also removes any technical parameters and determines if an inplace or explace navigation should take place.
     *
     * @param sSemanticObject Semantic object for the target app
     * @param sAction  Action for the target app
     * @param [mNavigationParameters] Optional parameters to be passed to the external navigation
     * @param [mNavigationParameters.label]
     * @param [mNavigationParameters.navigationContexts] Single instance or multiple instances of {@link sap.ui.model.odata.v4.Context}, or alternatively an object or array of objects, to be passed to the intent.
     * @param [mNavigationParameters.applicableContexts] Single instance or multiple instances of {@link sap.ui.model.odata.v4.Context}, or alternatively an object or array of objects, to be passed to the intent and for which the IBN button is enabled
     * @param [mNavigationParameters.notApplicableContexts] Single instance or multiple instances of {@link sap.ui.model.odata.v4.Context}, or alternatively an object or array of objects, which cannot be passed to the intent.
     *		  if an array of contexts is passed the context is used to determine the meta path and accordingly remove the sensitive data
     *		  If an array of objects is passed, the following format is expected:
     *		  {
     *			data: {
     *	 			ProductID: 7634,
     *				Name: "Laptop"
     *			 },
     *			 metaPath: "/SalesOrderManage"
     *        }
     *		The metaPath is used to remove any sensitive data.
     * @param [mNavigationParameters.semanticObjectMapping] String representation of SemanticObjectMapping or SemanticObjectMapping that applies to this navigation
     */;
    _proto.navigateWithConfirmationDialog = function navigateWithConfirmationDialog(sSemanticObject, sAction, mNavigationParameters) {
      var _mNavigationParameter;
      if (mNavigationParameters !== null && mNavigationParameters !== void 0 && mNavigationParameters.notApplicableContexts && ((_mNavigationParameter = mNavigationParameters.notApplicableContexts) === null || _mNavigationParameter === void 0 ? void 0 : _mNavigationParameter.length) >= 1) {
        let oApplicableContextDialog;
        const oController = {
          onClose: function () {
            // User cancels action
            oApplicableContextDialog.close();
          },
          onContinue: () => {
            // Users continues the action with the bound contexts
            mNavigationParameters.navigationContexts = mNavigationParameters.applicableContexts;
            oApplicableContextDialog.close();
            this.navigate(sSemanticObject, sAction, mNavigationParameters);
          }
        };
        const fnOpenAndFillDialog = function () {
          let oDialogContent;
          const nNotApplicable = mNavigationParameters.notApplicableContexts.length,
            aNotApplicableItems = [];
          for (let i = 0; i < mNavigationParameters.notApplicableContexts.length; i++) {
            oDialogContent = mNavigationParameters.notApplicableContexts[i].getObject();
            aNotApplicableItems.push(oDialogContent);
          }
          const oNotApplicableItemsModel = new JSONModel(aNotApplicableItems);
          const oTotals = new JSONModel({
            total: nNotApplicable,
            label: mNavigationParameters.label
          });
          oApplicableContextDialog.setModel(oNotApplicableItemsModel, "notApplicable");
          oApplicableContextDialog.setModel(oTotals, "totals");
          oApplicableContextDialog.open();
        };
        // Show the contexts that are not applicable and will not therefore be processed
        const sFragmentName = "sap.fe.core.controls.ActionPartial";
        const oDialogFragment = XMLTemplateProcessor.loadTemplate(sFragmentName, "fragment");
        const oModel = this._oView.getModel();
        const oMetaModel = oModel.getMetaModel();
        const sCanonicalPath = mNavigationParameters.notApplicableContexts[0].getCanonicalPath();
        const sEntitySet = `${sCanonicalPath.substr(0, sCanonicalPath.indexOf("("))}/`;
        Promise.resolve(XMLPreprocessor.process(oDialogFragment, {
          name: sFragmentName
        }, {
          bindingContexts: {
            entityType: oMetaModel.createBindingContext(sEntitySet)
          },
          models: {
            entityType: oMetaModel,
            metaModel: oMetaModel
          }
        })).then(function (oFragment) {
          return Fragment.load({
            definition: oFragment,
            controller: oController
          });
        }).then(oPopover => {
          oApplicableContextDialog = oPopover;
          this.getView().addDependent(oPopover);
          fnOpenAndFillDialog();
        }).catch(function () {
          Log.error("Error");
        });
      } else {
        this.navigate(sSemanticObject, sAction, mNavigationParameters);
      }
    };
    _proto._removeTechnicalParameters = function _removeTechnicalParameters(oSelectionVariant) {
      oSelectionVariant.removeSelectOption("@odata.context");
      oSelectionVariant.removeSelectOption("@odata.metadataEtag");
      oSelectionVariant.removeSelectOption("SAP__Messages");
    }
    /**
     * Get targeted Entity set.
     *
     * @returns Entity set name
     */;
    _proto.getEntitySet = function getEntitySet() {
      return this._oView.getViewData().entitySet;
    }
    /**
     * Removes sensitive data from the semantic attribute with respect to the entitySet.
     *
     * @param oAttributes Context data
     * @param sMetaPath Meta path to reach the entitySet in the MetaModel
     * @returns Array of semantic Attributes
     * @private
     */
    // TO-DO add unit tests for this function in the controller extension qunit.
    ;
    _proto.removeSensitiveData = function removeSensitiveData(oAttributes, sMetaPath) {
      if (oAttributes) {
        const {
          transAggregations,
          customAggregates
        } = this._getAggregates(sMetaPath, this.base.getView(), this.base.getAppComponent().getDiagnostics());
        const aProperties = Object.keys(oAttributes);
        if (aProperties.length) {
          delete oAttributes["@odata.context"];
          delete oAttributes["@odata.metadataEtag"];
          delete oAttributes["SAP__Messages"];
          for (let j = 0; j < aProperties.length; j++) {
            if (oAttributes[aProperties[j]] && typeof oAttributes[aProperties[j]] === "object") {
              this.removeSensitiveData(oAttributes[aProperties[j]], `${sMetaPath}/${aProperties[j]}`);
            }
            const sProp = aProperties[j];
            if (sProp.indexOf("@odata.type") > -1) {
              delete oAttributes[aProperties[j]];
              continue;
            }
            this._deleteAggregates([...transAggregations, ...customAggregates], aProperties[j], oAttributes);
            const aPropertyAnnotations = this._getPropertyAnnotations(sProp, sMetaPath, oAttributes, this._oMetaModel);
            if (aPropertyAnnotations) {
              if (aPropertyAnnotations["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"] || aPropertyAnnotations["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"] || aPropertyAnnotations["com.sap.vocabularies.Analytics.v1.Measure"]) {
                delete oAttributes[sProp];
              } else if (aPropertyAnnotations["com.sap.vocabularies.Common.v1.FieldControl"]) {
                const oFieldControl = aPropertyAnnotations["com.sap.vocabularies.Common.v1.FieldControl"];
                if (oFieldControl["$EnumMember"] && oFieldControl["$EnumMember"].split("/")[1] === "Inapplicable") {
                  delete oAttributes[sProp];
                } else if (oFieldControl["$Path"] && this._isFieldControlPathInapplicable(oFieldControl["$Path"], oAttributes)) {
                  delete oAttributes[sProp];
                }
              }
            }
          }
        }
      }
      return oAttributes;
    }

    /**
     * Remove the attribute from navigation data if it is a measure.
     *
     * @param aggregates Array of Aggregates
     * @param sProp Attribute name
     * @param oAttributes SemanticAttributes
     */;
    _proto._deleteAggregates = function _deleteAggregates(aggregates, sProp, oAttributes) {
      if (aggregates && aggregates.indexOf(sProp) > -1) {
        delete oAttributes[sProp];
      }
    }

    /**
     * Returns the property annotations.
     *
     * @param sProp
     * @param sMetaPath
     * @param oAttributes
     * @param oMetaModel
     * @returns - The property annotations
     */;
    _proto._getPropertyAnnotations = function _getPropertyAnnotations(sProp, sMetaPath, oAttributes, oMetaModel) {
      if (oAttributes[sProp] && sMetaPath && !sMetaPath.includes("undefined")) {
        var _oFullContext$targetO, _oFullContext$targetO2;
        const oContext = oMetaModel.createBindingContext(`${sMetaPath}/${sProp}`);
        const oFullContext = MetaModelConverter.getInvolvedDataModelObjects(oContext);
        return oFullContext === null || oFullContext === void 0 ? void 0 : (_oFullContext$targetO = oFullContext.targetObject) === null || _oFullContext$targetO === void 0 ? void 0 : (_oFullContext$targetO2 = _oFullContext$targetO.annotations) === null || _oFullContext$targetO2 === void 0 ? void 0 : _oFullContext$targetO2._annotations;
      }
      return null;
    }

    /**
     * Returns the aggregates part of the EntitySet or EntityType.
     *
     * @param sMetaPath
     * @param oView
     * @param oDiagnostics
     * @returns - The aggregates
     */;
    _proto._getAggregates = function _getAggregates(sMetaPath, oView, oDiagnostics) {
      const converterContext = this._getConverterContext(sMetaPath, oView, oDiagnostics);
      const aggregationHelper = new AggregationHelper(converterContext.getEntityType(), converterContext);
      const isAnalyticsSupported = aggregationHelper.isAnalyticsSupported();
      let transAggregations = [],
        customAggregates = [];
      if (isAnalyticsSupported) {
        transAggregations = aggregationHelper.getTransAggregations();
        if (transAggregations.length) {
          transAggregations = transAggregations.map(transAgg => {
            return transAgg.Name || transAgg.Value;
          });
        }
        customAggregates = aggregationHelper.getCustomAggregateDefinitions();
        if (customAggregates.length) {
          customAggregates = customAggregates.map(customAggregate => {
            return customAggregate.qualifier;
          });
        }
      }
      return {
        transAggregations,
        customAggregates
      };
    }

    /**
     * Returns converterContext.
     *
     * @param sMetaPath
     * @param oView
     * @param oDiagnostics
     * @returns - ConverterContext
     */;
    _proto._getConverterContext = function _getConverterContext(sMetaPath, oView, oDiagnostics) {
      const oViewData = oView.getViewData();
      let sEntitySet = oViewData.entitySet;
      const sContextPath = oViewData.contextPath;
      if (sContextPath && (!sEntitySet || sEntitySet.includes("/"))) {
        sEntitySet = oViewData === null || oViewData === void 0 ? void 0 : oViewData.fullContextPath.split("/")[1];
      }
      return CommonUtils.getConverterContextForPath(sMetaPath, oView.getModel().getMetaModel(), sEntitySet, oDiagnostics);
    }

    /**
     * Check if path-based FieldControl evaluates to inapplicable.
     *
     * @param sFieldControlPath Field control path
     * @param oAttribute SemanticAttributes
     * @returns `true` if inapplicable
     */;
    _proto._isFieldControlPathInapplicable = function _isFieldControlPathInapplicable(sFieldControlPath, oAttribute) {
      let bInapplicable = false;
      const aParts = sFieldControlPath.split("/");
      // sensitive data is removed only if the path has already been resolved.
      if (aParts.length > 1) {
        bInapplicable = oAttribute[aParts[0]] && oAttribute[aParts[0]].hasOwnProperty(aParts[1]) && oAttribute[aParts[0]][aParts[1]] === 0;
      } else {
        bInapplicable = oAttribute[sFieldControlPath] === 0;
      }
      return bInapplicable;
    }
    /**
     * Method to replace Local Properties with Semantic Object mappings.
     *
     * @param oSelectionVariant SelectionVariant consisting of filterbar, Table and Page Context
     * @param vMappings A string representation of semantic object mapping
     * @returns - Modified SelectionVariant with LocalProperty replaced with SemanticObjectProperties.
     */;
    _proto._applySemanticObjectMappings = function _applySemanticObjectMappings(oSelectionVariant, vMappings) {
      const oMappings = typeof vMappings === "string" ? JSON.parse(vMappings) : vMappings;
      for (let i = 0; i < oMappings.length; i++) {
        const sLocalProperty = oMappings[i]["LocalProperty"] && oMappings[i]["LocalProperty"]["$PropertyPath"] || oMappings[i]["@com.sap.vocabularies.Common.v1.LocalProperty"] && oMappings[i]["@com.sap.vocabularies.Common.v1.LocalProperty"]["$Path"];
        const sSemanticObjectProperty = oMappings[i]["SemanticObjectProperty"] || oMappings[i]["@com.sap.vocabularies.Common.v1.SemanticObjectProperty"];
        const oSelectOption = oSelectionVariant.getSelectOption(sLocalProperty);
        if (oSelectOption) {
          //Create a new SelectOption with sSemanticObjectProperty as the property Name and remove the older one
          oSelectionVariant.removeSelectOption(sLocalProperty);
          oSelectionVariant.massAddSelectOption(sSemanticObjectProperty, oSelectOption);
        }
      }
      return oSelectionVariant;
    }
    /**
     * Navigates to an Outbound provided in the manifest.
     *
     * @function
     * @param sOutbound Identifier to location the outbound in the manifest
     * @param mNavigationParameters Optional map containing key/value pairs to be passed to the intent
     * @alias sap.fe.core.controllerextensions.IntentBasedNavigation#navigateOutbound
     * @since 1.86.0
     */;
    _proto.navigateOutbound = function navigateOutbound(sOutbound, mNavigationParameters) {
      var _oManifestEntry$cross, _oManifestEntry$cross2;
      let aNavParams;
      const oManifestEntry = this.base.getAppComponent().getManifestEntry("sap.app"),
        oOutbound = (_oManifestEntry$cross = oManifestEntry.crossNavigation) === null || _oManifestEntry$cross === void 0 ? void 0 : (_oManifestEntry$cross2 = _oManifestEntry$cross.outbounds) === null || _oManifestEntry$cross2 === void 0 ? void 0 : _oManifestEntry$cross2[sOutbound];
      if (!oOutbound) {
        Log.error("Outbound is not defined in manifest!!");
        return;
      }
      const sSemanticObject = oOutbound.semanticObject,
        sAction = oOutbound.action,
        outboundParams = oOutbound.parameters && this.getOutboundParams(oOutbound.parameters);
      if (mNavigationParameters) {
        aNavParams = [];
        Object.keys(mNavigationParameters).forEach(function (key) {
          let oParams;
          if (Array.isArray(mNavigationParameters[key])) {
            const aValues = mNavigationParameters[key];
            for (let i = 0; i < aValues.length; i++) {
              var _aNavParams;
              oParams = {};
              oParams[key] = aValues[i];
              (_aNavParams = aNavParams) === null || _aNavParams === void 0 ? void 0 : _aNavParams.push(oParams);
            }
          } else {
            var _aNavParams2;
            oParams = {};
            oParams[key] = mNavigationParameters[key];
            (_aNavParams2 = aNavParams) === null || _aNavParams2 === void 0 ? void 0 : _aNavParams2.push(oParams);
          }
        });
      }
      if (aNavParams || outboundParams) {
        mNavigationParameters = {
          navigationContexts: {
            data: aNavParams || outboundParams
          }
        };
      }
      this.base._intentBasedNavigation.navigate(sSemanticObject, sAction, mNavigationParameters);
    }

    /**
     * Method to apply outbound parameters defined in the manifest.
     *
     * @param oSelectionVariant SelectionVariant consisting of a filter bar, a table, and a page context
     * @param vOutboundParams Outbound Properties defined in the manifest
     * @returns - The modified SelectionVariant with outbound parameters.
     */;
    _proto._applyOutboundParams = function _applyOutboundParams(oSelectionVariant, vOutboundParams) {
      const aParameters = Object.keys(vOutboundParams);
      const aSelectProperties = oSelectionVariant.getSelectOptionsPropertyNames();
      aParameters.forEach(function (key) {
        if (!aSelectProperties.includes(key)) {
          oSelectionVariant.addSelectOption(key, "I", "EQ", vOutboundParams[key]);
        }
      });
      return oSelectionVariant;
    }
    /**
     * Method to get the outbound parameters defined in the manifest.
     *
     * @function
     * @param oOutboundParams Parameters defined in the outbounds. Only "plain" is supported
     * @returns Parameters with the key-Value pair
     */;
    _proto.getOutboundParams = function getOutboundParams(oOutboundParams) {
      const oParamsMapping = {};
      if (oOutboundParams) {
        const aParameters = Object.keys(oOutboundParams) || [];
        if (aParameters.length > 0) {
          aParameters.forEach(function (key) {
            const oMapping = oOutboundParams[key];
            if (oMapping.value && oMapping.value.value && oMapping.value.format === "plain") {
              if (!oParamsMapping[key]) {
                oParamsMapping[key] = oMapping.value.value;
              }
            }
          });
        }
      }
      return oParamsMapping;
    }

    /**
     * Triggers an outbound navigation when a user chooses the chevron.
     *
     * @param {object} oController
     * @param {string} sOutboundTarget Name of the outbound target (needs to be defined in the manifest)
     * @param {sap.ui.model.odata.v4.Context} oContext The context that contains the data for the target app
     * @param {string} sCreatePath Create path when the chevron is created.
     * @returns {Promise} Promise which is resolved once the navigation is triggered
     */;
    _proto.onChevronPressNavigateOutBound = function onChevronPressNavigateOutBound(oController, sOutboundTarget, oContext, sCreatePath) {
      const oOutbounds = oController.getAppComponent().getRoutingService().getOutbounds();
      const oDisplayOutbound = oOutbounds[sOutboundTarget];
      let additionalNavigationParameters;
      if (oDisplayOutbound && oDisplayOutbound.semanticObject && oDisplayOutbound.action) {
        const oRefreshStrategies = {
          intents: {}
        };
        const oDefaultRefreshStrategy = {};
        let sMetaPath;
        if (oContext) {
          if (oContext.isA && oContext.isA("sap.ui.model.odata.v4.Context")) {
            sMetaPath = ModelHelper.getMetaPathForContext(oContext);
            oContext = [oContext];
          } else {
            sMetaPath = ModelHelper.getMetaPathForContext(oContext[0]);
          }
          oDefaultRefreshStrategy[sMetaPath] = "self";
          oRefreshStrategies["_feDefault"] = oDefaultRefreshStrategy;
        }
        if (sCreatePath) {
          const sKey = `${oDisplayOutbound.semanticObject}-${oDisplayOutbound.action}`;
          oRefreshStrategies.intents[sKey] = {};
          oRefreshStrategies.intents[sKey][sCreatePath] = "self";
        }
        if (oDisplayOutbound && oDisplayOutbound.parameters) {
          const oParams = oDisplayOutbound.parameters && this.getOutboundParams(oDisplayOutbound.parameters);
          if (Object.keys(oParams).length > 0) {
            additionalNavigationParameters = oParams;
          }
        }
        oController._intentBasedNavigation.navigate(oDisplayOutbound.semanticObject, oDisplayOutbound.action, {
          navigationContexts: oContext,
          refreshStrategies: oRefreshStrategies,
          additionalNavigationParameters: additionalNavigationParameters
        });

        //TODO: check why returning a promise is required
        return Promise.resolve();
      } else {
        throw new Error(`outbound target ${sOutboundTarget} not found in cross navigation definition of manifest`);
      }
    };
    return InternalIntentBasedNavigation;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigate", [_dec3, _dec4], Object.getOwnPropertyDescriptor(_class2.prototype, "navigate"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "prepareContextForExternalNavigation", [_dec5, _dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "prepareContextForExternalNavigation"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "prepareFiltersForExternalNavigation", [_dec7, _dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "prepareFiltersForExternalNavigation"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getNavigationMode", [_dec9, _dec10], Object.getOwnPropertyDescriptor(_class2.prototype, "getNavigationMode"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateWithConfirmationDialog", [_dec11, _dec12], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateWithConfirmationDialog"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getEntitySet", [_dec13], Object.getOwnPropertyDescriptor(_class2.prototype, "getEntitySet"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "removeSensitiveData", [_dec14, _dec15], Object.getOwnPropertyDescriptor(_class2.prototype, "removeSensitiveData"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateOutbound", [_dec16, _dec17], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateOutbound"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getOutboundParams", [_dec18, _dec19], Object.getOwnPropertyDescriptor(_class2.prototype, "getOutboundParams"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onChevronPressNavigateOutBound", [_dec20, _dec21], Object.getOwnPropertyDescriptor(_class2.prototype, "onChevronPressNavigateOutBound"), _class2.prototype)), _class2)) || _class);
  return InternalIntentBasedNavigation;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/InternalIntentBasedNavigation", ["sap/base/Log","sap/base/util/merge","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/editFlow/draft","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/KeepAliveHelper","sap/fe/core/helpers/ModelHelper","sap/fe/navigation/SelectionVariant","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/model/json/JSONModel","../converters/helpers/Aggregation"],function(t,e,o,n,i,r,a,s,l,c,p,g,u,f,d,v,h){"use strict";var m,y,b,O,C,P,A,x,S,M,_,j,w,N,E,$,D,F,V,I,B,R,T;var L=h.AggregationHelper;var k=r.publicExtension;var W=r.privateExtension;var z=r.methodOverride;var U=r.finalExtension;var H=r.extensible;var J=r.defineUI5Class;function q(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;G(t,e)}function G(t,e){G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,o){e.__proto__=o;return e};return G(t,e)}function X(t,e,o,n,i){var r={};Object.keys(n).forEach(function(t){r[t]=n[t]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(t,e,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(t,e,r);r=null}return r}let K=(m=J("sap.fe.core.controllerextensions.InternalInternalBasedNavigation"),y=z(),b=k(),O=U(),C=k(),P=U(),A=k(),x=U(),S=k(),M=H(u.Instead),_=k(),j=U(),w=W(),N=k(),E=U(),$=k(),D=U(),F=k(),V=U(),I=k(),B=U(),m(R=(T=function(r){q(g,r);function g(){return r.apply(this,arguments)||this}var u=g.prototype;u.onInit=function t(){this._oAppComponent=this.base.getAppComponent();this._oMetaModel=this._oAppComponent.getModel().getMetaModel();this._oNavigationService=this._oAppComponent.getNavigationService();this._oView=this.base.getView()};u.navigate=function t(o,i,r){const p=t=>{const n=r&&r.navigationContexts,s=n&&!Array.isArray(n)?[n]:n,p=r&&r.semanticObjectMapping,g=r&&r.additionalNavigationParameters,u={semanticObject:o,action:i},f=this.base.getView(),d=f.getController();if(t){this._oView.setBindingContext(t)}if(o&&i){let t=[],n=new l;if(s&&s.length){s.forEach(e=>{if(e.isA&&e.isA("sap.ui.model.odata.v4.Context")){let o=e.getObject();const n=this._oMetaModel.getMetaPath(e.getPath());o=this.removeSensitiveData(o,n);const i=this.prepareContextForExternalNavigation(o,e);u["propertiesWithoutConflict"]=i.propertiesWithoutConflict;t.push(i.semanticAttributes)}else if(!(e&&Array.isArray(e.data))&&typeof e==="object"){t.push(this.removeSensitiveData(e.data,e.metaPath))}else if(e&&Array.isArray(e.data)){t=this.removeSensitiveData(e.data,e.metaPath)}})}if(t&&t.length){n=this._oNavigationService.mixAttributesAndSelectionVariant(t,n.toJSONString())}const v=this._oView.getModel(),h=this.getEntitySet(),m=h?this._oNavigationService.constructContextUrl(h,v):undefined;if(m){n.setFilterContextUrl(m)}if(g){this._applyOutboundParams(n,g)}d.intentBasedNavigation.adaptNavigationContext(n,u);if(p){this._applySemanticObjectMappings(n,p)}this._removeTechnicalParameters(n);const y=d._intentBasedNavigation.getNavigationMode();const b=r&&r.refreshStrategies||{},O=f.getModel("internal");if(O){if((f&&f.getViewData()).refreshStrategyOnAppRestore){const t=f.getViewData().refreshStrategyOnAppRestore||{};e(b,t)}const t=a.getRefreshStrategyForIntent(b,o,i);if(t){O.setProperty("/refreshStrategyOnAppRestore",t)}}const C=function(){sap.ui.require(["sap/m/MessageBox"],function(t){const e=c.getLibraryResourceBundle("sap.fe.core");t.error(e.getText("C_COMMON_HELPER_NAVIGATION_ERROR_MESSAGE"),{title:e.getText("C_COMMON_SAPFE_ERROR")})})};this._oNavigationService.navigate(o,i,n.toJSONString(),undefined,C,undefined,y)}else{throw new Error("Semantic Object/action is not provided")}};const g=this.base.getView().getBindingContext();const u=g&&g.getModel().getMetaModel();if(this.getView().getViewData().converterType==="ObjectPage"&&u&&!s.isStickySessionSupported(u)){n.processDataLossOrDraftDiscardConfirmation(p.bind(this),Function.prototype,this.base.getView().getBindingContext(),this.base.getView().getController(),true,n.NavigationType.ForwardNavigation)}else{p()}};u.prepareContextForExternalNavigation=function t(e,o){const n={},i=o.getPath(),r=o.getModel().getMetaModel(),a=r.getMetaPath(i),s=a.split("/").filter(Boolean);function l(t,e){for(const o in t){if(t[o]===null||typeof t[o]!=="object"){if(!n[o]){n[o]=[]}n[o].push(e)}else{const n=t[o];l(n,`${e}/${o}`)}}}l(e,a);const c=s[0],p=r.getObject(`/${c}/@sapui.name`),g={};let u,f,d;for(const t in n){const i=n[t];let s;if(i.length>1){for(let n=0;n<=i.length-1;n++){const s=i[n];let l=s.replace(s===a?a:`${a}/`,"");l=(l===""?l:`${l}/`)+t;const c=r.getObject(`${s}/@sapui.name`);if(c===p){u=l}if(s===a){f=l}d=l;e[`${a}/${l}`.split("/").filter(function(t){return t!=""}).join(".")]=o.getProperty(l)}s=u||f||d;e[t]=o.getProperty(s);u=undefined;f=undefined;d=undefined}else{const n=i[0];let r=n.replace(n===a?a:`${a}/`,"");r=(r===""?r:`${r}/`)+t;e[t]=o.getProperty(r);g[t]=`${a}/${r}`.split("/").filter(function(t){return t!=""}).join(".")}}for(const t in e){if(e[t]!==null&&typeof e[t]==="object"){delete e[t]}}return{semanticAttributes:e,propertiesWithoutConflict:g}};u.prepareFiltersForExternalNavigation=function t(e,o,n){let i;const r={};const a={};let s,l,c,p,g;function u(t){let e;for(let n in t){if(t[n]){if(n.includes("/")){e=n;const t=n.split("/");n=t[t.length-1]}else{e=o}if(!r[n]){r[n]=[]}r[n].push(e)}}}u(e);for(const t in r){const u=r[t];if(u.length>1){for(let r=0;r<=u.length-1;r++){i=u[r];if(i===o){c=`${o}/${t}`;g=t;s=t;if(n&&n.includes(t)){e[`$Parameter.${t}`]=e[t]}}else{g=i;c=`${o}/${i}`.replaceAll(/\*/g,"");l=i}e[c.split("/").filter(function(t){return t!=""}).join(".")]=e[g];delete e[i]}p=s||l;e[t]=e[p]}else{i=u[0];c=i===o?`${o}/${t}`:`${o}/${i}`.replaceAll("*","");a[t]=c.split("/").filter(function(t){return t!=""}).join(".");if(n&&n.includes(t)){e[`$Parameter.${t}`]=e[t]}}}return{filterConditions:e,filterConditionsWithoutConflict:a}};u.getNavigationMode=function t(){return undefined};u.navigateWithConfirmationDialog=function e(o,n,i){var r;if(i!==null&&i!==void 0&&i.notApplicableContexts&&((r=i.notApplicableContexts)===null||r===void 0?void 0:r.length)>=1){let e;const r={onClose:function(){e.close()},onContinue:()=>{i.navigationContexts=i.applicableContexts;e.close();this.navigate(o,n,i)}};const a=function(){let t;const o=i.notApplicableContexts.length,n=[];for(let e=0;e<i.notApplicableContexts.length;e++){t=i.notApplicableContexts[e].getObject();n.push(t)}const r=new v(n);const a=new v({total:o,label:i.label});e.setModel(r,"notApplicable");e.setModel(a,"totals");e.open()};const s="sap.fe.core.controls.ActionPartial";const l=d.loadTemplate(s,"fragment");const c=this._oView.getModel();const g=c.getMetaModel();const u=i.notApplicableContexts[0].getCanonicalPath();const h=`${u.substr(0,u.indexOf("("))}/`;Promise.resolve(f.process(l,{name:s},{bindingContexts:{entityType:g.createBindingContext(h)},models:{entityType:g,metaModel:g}})).then(function(t){return p.load({definition:t,controller:r})}).then(t=>{e=t;this.getView().addDependent(t);a()}).catch(function(){t.error("Error")})}else{this.navigate(o,n,i)}};u._removeTechnicalParameters=function t(e){e.removeSelectOption("@odata.context");e.removeSelectOption("@odata.metadataEtag");e.removeSelectOption("SAP__Messages")};u.getEntitySet=function t(){return this._oView.getViewData().entitySet};u.removeSensitiveData=function t(e,o){if(e){const{transAggregations:t,customAggregates:n}=this._getAggregates(o,this.base.getView(),this.base.getAppComponent().getDiagnostics());const i=Object.keys(e);if(i.length){delete e["@odata.context"];delete e["@odata.metadataEtag"];delete e["SAP__Messages"];for(let r=0;r<i.length;r++){if(e[i[r]]&&typeof e[i[r]]==="object"){this.removeSensitiveData(e[i[r]],`${o}/${i[r]}`)}const a=i[r];if(a.indexOf("@odata.type")>-1){delete e[i[r]];continue}this._deleteAggregates([...t,...n],i[r],e);const s=this._getPropertyAnnotations(a,o,e,this._oMetaModel);if(s){if(s["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]||s["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]||s["com.sap.vocabularies.Analytics.v1.Measure"]){delete e[a]}else if(s["com.sap.vocabularies.Common.v1.FieldControl"]){const t=s["com.sap.vocabularies.Common.v1.FieldControl"];if(t["$EnumMember"]&&t["$EnumMember"].split("/")[1]==="Inapplicable"){delete e[a]}else if(t["$Path"]&&this._isFieldControlPathInapplicable(t["$Path"],e)){delete e[a]}}}}}}return e};u._deleteAggregates=function t(e,o,n){if(e&&e.indexOf(o)>-1){delete n[o]}};u._getPropertyAnnotations=function t(e,o,n,r){if(n[e]&&o&&!o.includes("undefined")){var a,s;const t=r.createBindingContext(`${o}/${e}`);const n=i.getInvolvedDataModelObjects(t);return n===null||n===void 0?void 0:(a=n.targetObject)===null||a===void 0?void 0:(s=a.annotations)===null||s===void 0?void 0:s._annotations}return null};u._getAggregates=function t(e,o,n){const i=this._getConverterContext(e,o,n);const r=new L(i.getEntityType(),i);const a=r.isAnalyticsSupported();let s=[],l=[];if(a){s=r.getTransAggregations();if(s.length){s=s.map(t=>t.Name||t.Value)}l=r.getCustomAggregateDefinitions();if(l.length){l=l.map(t=>t.qualifier)}}return{transAggregations:s,customAggregates:l}};u._getConverterContext=function t(e,n,i){const r=n.getViewData();let a=r.entitySet;const s=r.contextPath;if(s&&(!a||a.includes("/"))){a=r===null||r===void 0?void 0:r.fullContextPath.split("/")[1]}return o.getConverterContextForPath(e,n.getModel().getMetaModel(),a,i)};u._isFieldControlPathInapplicable=function t(e,o){let n=false;const i=e.split("/");if(i.length>1){n=o[i[0]]&&o[i[0]].hasOwnProperty(i[1])&&o[i[0]][i[1]]===0}else{n=o[e]===0}return n};u._applySemanticObjectMappings=function t(e,o){const n=typeof o==="string"?JSON.parse(o):o;for(let t=0;t<n.length;t++){const o=n[t]["LocalProperty"]&&n[t]["LocalProperty"]["$PropertyPath"]||n[t]["@com.sap.vocabularies.Common.v1.LocalProperty"]&&n[t]["@com.sap.vocabularies.Common.v1.LocalProperty"]["$Path"];const i=n[t]["SemanticObjectProperty"]||n[t]["@com.sap.vocabularies.Common.v1.SemanticObjectProperty"];const r=e.getSelectOption(o);if(r){e.removeSelectOption(o);e.massAddSelectOption(i,r)}}return e};u.navigateOutbound=function e(o,n){var i,r;let a;const s=this.base.getAppComponent().getManifestEntry("sap.app"),l=(i=s.crossNavigation)===null||i===void 0?void 0:(r=i.outbounds)===null||r===void 0?void 0:r[o];if(!l){t.error("Outbound is not defined in manifest!!");return}const c=l.semanticObject,p=l.action,g=l.parameters&&this.getOutboundParams(l.parameters);if(n){a=[];Object.keys(n).forEach(function(t){let e;if(Array.isArray(n[t])){const i=n[t];for(let n=0;n<i.length;n++){var o;e={};e[t]=i[n];(o=a)===null||o===void 0?void 0:o.push(e)}}else{var i;e={};e[t]=n[t];(i=a)===null||i===void 0?void 0:i.push(e)}})}if(a||g){n={navigationContexts:{data:a||g}}}this.base._intentBasedNavigation.navigate(c,p,n)};u._applyOutboundParams=function t(e,o){const n=Object.keys(o);const i=e.getSelectOptionsPropertyNames();n.forEach(function(t){if(!i.includes(t)){e.addSelectOption(t,"I","EQ",o[t])}});return e};u.getOutboundParams=function t(e){const o={};if(e){const t=Object.keys(e)||[];if(t.length>0){t.forEach(function(t){const n=e[t];if(n.value&&n.value.value&&n.value.format==="plain"){if(!o[t]){o[t]=n.value.value}}})}}return o};u.onChevronPressNavigateOutBound=function t(e,o,n,i){const r=e.getAppComponent().getRoutingService().getOutbounds();const a=r[o];let l;if(a&&a.semanticObject&&a.action){const t={intents:{}};const o={};let r;if(n){if(n.isA&&n.isA("sap.ui.model.odata.v4.Context")){r=s.getMetaPathForContext(n);n=[n]}else{r=s.getMetaPathForContext(n[0])}o[r]="self";t["_feDefault"]=o}if(i){const e=`${a.semanticObject}-${a.action}`;t.intents[e]={};t.intents[e][i]="self"}if(a&&a.parameters){const t=a.parameters&&this.getOutboundParams(a.parameters);if(Object.keys(t).length>0){l=t}}e._intentBasedNavigation.navigate(a.semanticObject,a.action,{navigationContexts:n,refreshStrategies:t,additionalNavigationParameters:l});return Promise.resolve()}else{throw new Error(`outbound target ${o} not found in cross navigation definition of manifest`)}};return g}(g),X(T.prototype,"onInit",[y],Object.getOwnPropertyDescriptor(T.prototype,"onInit"),T.prototype),X(T.prototype,"navigate",[b,O],Object.getOwnPropertyDescriptor(T.prototype,"navigate"),T.prototype),X(T.prototype,"prepareContextForExternalNavigation",[C,P],Object.getOwnPropertyDescriptor(T.prototype,"prepareContextForExternalNavigation"),T.prototype),X(T.prototype,"prepareFiltersForExternalNavigation",[A,x],Object.getOwnPropertyDescriptor(T.prototype,"prepareFiltersForExternalNavigation"),T.prototype),X(T.prototype,"getNavigationMode",[S,M],Object.getOwnPropertyDescriptor(T.prototype,"getNavigationMode"),T.prototype),X(T.prototype,"navigateWithConfirmationDialog",[_,j],Object.getOwnPropertyDescriptor(T.prototype,"navigateWithConfirmationDialog"),T.prototype),X(T.prototype,"getEntitySet",[w],Object.getOwnPropertyDescriptor(T.prototype,"getEntitySet"),T.prototype),X(T.prototype,"removeSensitiveData",[N,E],Object.getOwnPropertyDescriptor(T.prototype,"removeSensitiveData"),T.prototype),X(T.prototype,"navigateOutbound",[$,D],Object.getOwnPropertyDescriptor(T.prototype,"navigateOutbound"),T.prototype),X(T.prototype,"getOutboundParams",[F,V],Object.getOwnPropertyDescriptor(T.prototype,"getOutboundParams"),T.prototype),X(T.prototype,"onChevronPressNavigateOutBound",[I,B],Object.getOwnPropertyDescriptor(T.prototype,"onChevronPressNavigateOutBound"),T.prototype),T))||R);return K},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/InternalRouting-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/controllerextensions/collaboration/ActivitySync", "sap/fe/core/controllerextensions/editFlow/draft", "sap/fe/core/controllerextensions/routing/NavigationReason", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/EditState", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/helpers/SemanticKeyHelper", "sap/ui/core/Component", "sap/ui/core/Core", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "sap/ui/model/Filter", "sap/ui/model/FilterOperator"], function (Log, CommonUtils, BusyLocker, ActivitySync, draft, NavigationReason, ClassSupport, EditState, ModelHelper, SemanticKeyHelper, Component, Core, ControllerExtension, OverrideExecution, Filter, FilterOperator) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _dec22, _dec23, _dec24, _dec25, _dec26, _dec27, _dec28, _dec29, _dec30, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var methodOverride = ClassSupport.methodOverride;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var isConnected = ActivitySync.isConnected;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * {@link sap.ui.core.mvc.ControllerExtension Controller extension}
   *
   * @namespace
   * @alias sap.fe.core.controllerextensions.InternalRouting
   * @private
   * @since 1.74.0
   */
  let InternalRouting = (_dec = defineUI5Class("sap.fe.core.controllerextensions.InternalRouting"), _dec2 = methodOverride(), _dec3 = methodOverride(), _dec4 = publicExtension(), _dec5 = extensible(OverrideExecution.After), _dec6 = publicExtension(), _dec7 = extensible(OverrideExecution.After), _dec8 = publicExtension(), _dec9 = extensible(OverrideExecution.After), _dec10 = publicExtension(), _dec11 = extensible(OverrideExecution.After), _dec12 = publicExtension(), _dec13 = publicExtension(), _dec14 = publicExtension(), _dec15 = finalExtension(), _dec16 = publicExtension(), _dec17 = finalExtension(), _dec18 = publicExtension(), _dec19 = finalExtension(), _dec20 = publicExtension(), _dec21 = finalExtension(), _dec22 = publicExtension(), _dec23 = finalExtension(), _dec24 = publicExtension(), _dec25 = finalExtension(), _dec26 = publicExtension(), _dec27 = publicExtension(), _dec28 = finalExtension(), _dec29 = publicExtension(), _dec30 = extensible(OverrideExecution.Before), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(InternalRouting, _ControllerExtension);
    function InternalRouting() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = InternalRouting.prototype;
    _proto.onExit = function onExit() {
      if (this._oRoutingService) {
        this._oRoutingService.detachRouteMatched(this._fnRouteMatchedBound);
      }
    };
    _proto.onInit = function onInit() {
      this._oView = this.base.getView();
      this._oAppComponent = CommonUtils.getAppComponent(this._oView);
      this._oPageComponent = Component.getOwnerComponentFor(this._oView);
      this._oRouter = this._oAppComponent.getRouter();
      this._oRouterProxy = this._oAppComponent.getRouterProxy();
      if (!this._oAppComponent || !this._oPageComponent) {
        throw new Error("Failed to initialize controler extension 'sap.fe.core.controllerextesions.InternalRouting");
      }

      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      if (this._oAppComponent === this._oPageComponent) {
        // The view isn't hosted in a dedicated UIComponent, but directly in the app
        // --> just keep the view
        this._oPageComponent = null;
      }
      this._oAppComponent.getService("routingService").then(oRoutingService => {
        this._oRoutingService = oRoutingService;
        this._fnRouteMatchedBound = this._onRouteMatched.bind(this);
        this._oRoutingService.attachRouteMatched(this._fnRouteMatchedBound);
        this._oTargetInformation = oRoutingService.getTargetInformationFor(this._oPageComponent || this._oView);
      }).catch(function () {
        throw new Error("This controller extension cannot work without a 'routingService' on the main AppComponent");
      });
    }

    /**
     * Triggered every time this controller is a navigation target.
     */;
    _proto.onRouteMatched = function onRouteMatched() {
      /**/
    };
    _proto.onRouteMatchedFinished = function onRouteMatchedFinished() {
      /**/
    };
    _proto.onBeforeBinding = function onBeforeBinding(oBindingContext, mParameters) {
      const oRouting = this.base.getView().getController().routing;
      if (oRouting && oRouting.onBeforeBinding) {
        oRouting.onBeforeBinding(oBindingContext, mParameters);
      }
    };
    _proto.onAfterBinding = function onAfterBinding(oBindingContext, mParameters) {
      this._oAppComponent.getRootViewController().onContextBoundToView(oBindingContext);
      const oRouting = this.base.getView().getController().routing;
      if (oRouting && oRouting.onAfterBinding) {
        oRouting.onAfterBinding(oBindingContext, mParameters);
      }
    }

    ///////////////////////////////////////////////////////////
    // Methods triggering a navigation after a user action
    // (e.g. click on a table row, button, etc...)
    ///////////////////////////////////////////////////////////

    /**
     * Navigates to the specified navigation target.
     *
     * @param oContext Context instance
     * @param sNavigationTargetName Name of the navigation target
     * @param bPreserveHistory True to force the new URL to be added at the end of the browser history (no replace)
     * @ui5-restricted
     */;
    _proto.navigateToTarget = function navigateToTarget(oContext, sNavigationTargetName, bPreserveHistory) {
      const oNavigationConfiguration = this._oPageComponent && this._oPageComponent.getNavigationConfiguration && this._oPageComponent.getNavigationConfiguration(sNavigationTargetName);
      if (oNavigationConfiguration) {
        const oDetailRoute = oNavigationConfiguration.detail;
        const sRouteName = oDetailRoute.route;
        const mParameterMapping = oDetailRoute.parameters;
        this._oRoutingService.navigateTo(oContext, sRouteName, mParameterMapping, bPreserveHistory);
      } else {
        this._oRoutingService.navigateTo(oContext, null, null, bPreserveHistory);
      }
      this._oView.getViewData();
    }

    /**
     * Navigates to the specified navigation target route.
     *
     * @param sTargetRouteName Name of the target route
     * @param [oParameters] Parameters to be used with route to create the target hash
     * @returns Promise that is resolved when the navigation is finalized
     * @ui5-restricted
     */;
    _proto.navigateToRoute = function navigateToRoute(sTargetRouteName, oParameters) {
      return this._oRoutingService.navigateToRoute(sTargetRouteName, oParameters);
    }

    /**
     * Navigates to a specific context.
     *
     * @param oContext The context to be navigated to
     * @param [mParameters] Optional navigation parameters
     * @returns Promise resolved when the navigation has been triggered
     * @ui5-restricted
     */;
    _proto.navigateToContext = function navigateToContext(oContext, mParameters) {
      const oContextInfo = {};
      mParameters = mParameters || {};
      if (oContext.isA("sap.ui.model.odata.v4.ODataListBinding")) {
        if (mParameters.asyncContext) {
          // the context is either created async (Promise)
          // We need to activate the routeMatchSynchro on the RouterProxy to avoid that
          // the subsequent call to navigateToContext conflicts with the current one
          this._oRouterProxy.activateRouteMatchSynchronization();
          mParameters.asyncContext.then(asyncContext => {
            // once the context is returned we navigate into it
            this.navigateToContext(asyncContext, {
              checkNoHashChange: mParameters.checkNoHashChange,
              editable: mParameters.editable,
              bPersistOPScroll: mParameters.bPersistOPScroll,
              updateFCLLevel: mParameters.updateFCLLevel,
              bForceFocus: mParameters.bForceFocus
            });
          }).catch(function (oError) {
            Log.error("Error with the async context", oError);
          });
        } else if (!mParameters.bDeferredContext) {
          // Navigate to a list binding not yet supported
          throw "navigation to a list binding is not yet supported";
        }
      }
      if (mParameters.callExtension) {
        const oInternalModel = this._oView.getModel("internal");
        oInternalModel.setProperty("/paginatorCurrentContext", null);
        oContextInfo.sourceBindingContext = oContext.getObject();
        oContextInfo.bindingContext = oContext;
        if (mParameters.oEvent) {
          oContextInfo.oEvent = mParameters.oEvent;
        }
        // Storing the selected context to use it in internal route navigation if neccessary.
        const bOverrideNav = this.base.getView().getController().routing.onBeforeNavigation(oContextInfo);
        if (bOverrideNav) {
          oInternalModel.setProperty("/paginatorCurrentContext", oContext);
          return Promise.resolve(true);
        }
      }
      mParameters.FCLLevel = this._getFCLLevel();
      return this._oRoutingService.navigateToContext(oContext, mParameters, this._oView.getViewData(), this._oTargetInformation);
    }

    /**
     * Navigates backwards from a context.
     *
     * @param oContext Context to be navigated from
     * @param [mParameters] Optional navigation parameters
     * @returns Promise resolved when the navigation has been triggered
     * @ui5-restricted
     */;
    _proto.navigateBackFromContext = function navigateBackFromContext(oContext, mParameters) {
      mParameters = mParameters || {};
      mParameters.updateFCLLevel = -1;
      return this.navigateToContext(oContext, mParameters);
    }

    /**
     * Navigates forwards to a context.
     *
     * @param oContext Context to be navigated to
     * @param mParameters Optional navigation parameters
     * @returns Promise resolved when the navigation has been triggered
     * @ui5-restricted
     */;
    _proto.navigateForwardToContext = function navigateForwardToContext(oContext, mParameters) {
      var _this$_oView$getBindi;
      if (((_this$_oView$getBindi = this._oView.getBindingContext("internal")) === null || _this$_oView$getBindi === void 0 ? void 0 : _this$_oView$getBindi.getProperty("messageFooterContainsErrors")) === true) {
        return Promise.resolve(true);
      }
      mParameters = mParameters || {};
      mParameters.updateFCLLevel = 1;
      return this.navigateToContext(oContext, mParameters);
    }

    /**
     * Navigates back in history if the current hash corresponds to a transient state.
     */;
    _proto.navigateBackFromTransientState = function navigateBackFromTransientState() {
      const sHash = this._oRouterProxy.getHash();

      // if triggered while navigating to (...), we need to navigate back
      if (sHash.indexOf("(...)") !== -1) {
        this._oRouterProxy.navBack();
      }
    };
    _proto.navigateToMessagePage = function navigateToMessagePage(sErrorMessage, mParameters) {
      mParameters = mParameters || {};
      if (this._oRouterProxy.getHash().indexOf("i-action=create") > -1 || this._oRouterProxy.getHash().indexOf("i-action=autoCreate") > -1) {
        return this._oRouterProxy.navToHash(this._oRoutingService.getDefaultCreateHash());
      } else {
        mParameters.FCLLevel = this._getFCLLevel();
        return this._oAppComponent.getRootViewController().displayErrorPage(sErrorMessage, mParameters);
      }
    }

    /**
     * Checks if one of the current views on the screen is bound to a given context.
     *
     * @param oContext
     * @returns `true` if the state is impacted by the context
     * @ui5-restricted
     */;
    _proto.isCurrentStateImpactedBy = function isCurrentStateImpactedBy(oContext) {
      return this._oRoutingService.isCurrentStateImpactedBy(oContext);
    };
    _proto._isViewPartOfRoute = function _isViewPartOfRoute(routeInformation) {
      const aTargets = routeInformation === null || routeInformation === void 0 ? void 0 : routeInformation.targets;
      if (!aTargets || aTargets.indexOf(this._oTargetInformation.targetName) === -1) {
        // If the target for this view has a view level greater than the route level, it means this view comes "after" the route
        // in terms of navigation.
        // In such case, we remove its binding context, to avoid this view to have data if we navigate to it later on
        if ((this._oTargetInformation.viewLevel ?? 0) >= ((routeInformation === null || routeInformation === void 0 ? void 0 : routeInformation.routeLevel) ?? 0)) {
          this._setBindingContext(null); // This also call setKeepAlive(false) on the current context
        }

        return false;
      }
      return true;
    };
    _proto._buildBindingPath = function _buildBindingPath(routeArguments, bindingPattern, navigationParameters) {
      let path = bindingPattern.replace(":?query:", "");
      let deferred = false;
      for (const sKey in routeArguments) {
        const sValue = routeArguments[sKey];
        if (sValue === "..." && bindingPattern.indexOf(`{${sKey}}`) >= 0) {
          deferred = true;
          // Sometimes in preferredMode = create, the edit button is shown in background when the
          // action parameter dialog shows up, setting bTargetEditable passes editable as true
          // to onBeforeBinding in _bindTargetPage function
          navigationParameters.bTargetEditable = true;
        }
        path = path.replace(`{${sKey}}`, sValue);
      }
      if (routeArguments["?query"] && routeArguments["?query"].hasOwnProperty("i-action")) {
        navigationParameters.bActionCreate = true;
      }

      // the binding path is always absolute
      if (path && path[0] !== "/") {
        path = `/${path}`;
      }
      return {
        path,
        deferred
      };
    }

    ///////////////////////////////////////////////////////////
    // Methods to bind the page when a route is matched
    ///////////////////////////////////////////////////////////

    /**
     * Called when a route is matched.
     * Builds the binding context from the navigation parameters, and bind the page accordingly.
     *
     * @param oEvent
     * @ui5-restricted
     */;
    _proto._onRouteMatched = function _onRouteMatched(oEvent) {
      // Check if the target for this view is part of the event targets (i.e. is a target for the current route).
      // If not, we don't need to bind it --> return
      if (!this._isViewPartOfRoute(oEvent.getParameter("routeInformation"))) {
        return;
      }

      // Retrieve the binding context pattern
      let bindingPattern;
      if (this._oPageComponent && this._oPageComponent.getBindingContextPattern) {
        bindingPattern = this._oPageComponent.getBindingContextPattern();
      }
      bindingPattern = bindingPattern || this._oTargetInformation.contextPattern;
      if (bindingPattern === null || bindingPattern === undefined) {
        // Don't do this if we already got sTarget == '', which is a valid target pattern
        bindingPattern = oEvent.getParameter("routePattern");
      }

      // Replace the parameters by their values in the binding context pattern
      const mArguments = oEvent.getParameters().arguments;
      const oNavigationParameters = oEvent.getParameter("navigationInfo");
      const {
        path,
        deferred
      } = this._buildBindingPath(mArguments, bindingPattern, oNavigationParameters);
      this.onRouteMatched();
      const oModel = this._oView.getModel();
      let oOut;
      if (deferred) {
        oOut = this._bindDeferred(path, oNavigationParameters);
      } else {
        oOut = this._bindPage(path, oModel, oNavigationParameters);
      }
      // eslint-disable-next-line promise/catch-or-return
      oOut.finally(() => {
        this.onRouteMatchedFinished();
      });
      this._oAppComponent.getRootViewController().updateUIStateForView(this._oView, this._getFCLLevel());
    }

    /**
     * Deferred binding (during object creation).
     *
     * @param sTargetPath The path to the deffered context
     * @param oNavigationParameters Navigation parameters
     * @returns A Promise
     * @ui5-restricted
     */;
    _proto._bindDeferred = function _bindDeferred(sTargetPath, oNavigationParameters) {
      this.onBeforeBinding(null, {
        editable: oNavigationParameters.bTargetEditable
      });
      if (oNavigationParameters.bDeferredContext || !oNavigationParameters.oAsyncContext) {
        // either the context shall be created in the target page (deferred Context) or it shall
        // be created async but the user refreshed the page / bookmarked this URL
        // TODO: currently the target component creates this document but we shall move this to
        // a central place
        if (this._oPageComponent && this._oPageComponent.createDeferredContext) {
          this._oPageComponent.createDeferredContext(sTargetPath, oNavigationParameters.useContext, oNavigationParameters.bActionCreate);
        }
      }
      const currentBindingContext = this._getBindingContext();
      if (currentBindingContext !== null && currentBindingContext !== void 0 && currentBindingContext.hasPendingChanges()) {
        // For now remove the pending changes to avoid the model raises errors and the object page is at least bound
        // Ideally the user should be asked for
        currentBindingContext.getBinding().resetChanges();
      }

      // remove the context to avoid showing old data
      this._setBindingContext(null);
      this.onAfterBinding(null);
      return Promise.resolve();
    }

    /**
     * Sets the binding context of the page from a path.
     *
     * @param sTargetPath The path to the context
     * @param oModel The OData model
     * @param oNavigationParameters Navigation parameters
     * @returns A Promise resolved once the binding has been set on the page
     * @ui5-restricted
     */;
    _proto._bindPage = function _bindPage(sTargetPath, oModel, oNavigationParameters) {
      if (sTargetPath === "") {
        return Promise.resolve(this._bindPageToContext(null, oModel, oNavigationParameters));
      } else {
        return this._resolveSemanticPath(sTargetPath, oModel).then(sTechnicalPath => {
          this._bindPageToPath(sTechnicalPath, oModel, oNavigationParameters);
        }).catch(oError => {
          // Error handling for erroneous metadata request
          const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
          this.navigateToMessagePage(oResourceBundle.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR"), {
            title: oResourceBundle.getText("C_COMMON_SAPFE_ERROR"),
            description: oError.message
          });
        });
      }
    }

    /**
     * Creates the filter to retrieve a context corresponding to a semantic path.
     *
     * @param sSemanticPath The semantic path
     * @param aSemanticKeys The semantic keys for the path
     * @param oMetaModel The instance of the meta model
     * @returns The filter
     * @ui5-restricted
     */;
    _proto._createFilterFromSemanticPath = function _createFilterFromSemanticPath(sSemanticPath, aSemanticKeys, oMetaModel) {
      const fnUnquoteAndDecode = function (sValue) {
        if (sValue.indexOf("'") === 0 && sValue.lastIndexOf("'") === sValue.length - 1) {
          // Remove the quotes from the value and decode special chars
          sValue = decodeURIComponent(sValue.substring(1, sValue.length - 1));
        }
        return sValue;
      };
      const aKeyValues = sSemanticPath.substring(sSemanticPath.indexOf("(") + 1, sSemanticPath.length - 1).split(",");
      let aFilters;
      if (aSemanticKeys.length != aKeyValues.length) {
        return null;
      }
      const bFilteringCaseSensitive = ModelHelper.isFilteringCaseSensitive(oMetaModel);
      if (aSemanticKeys.length === 1) {
        // Take the first key value
        const sKeyValue = fnUnquoteAndDecode(aKeyValues[0]);
        aFilters = [new Filter({
          path: aSemanticKeys[0].$PropertyPath,
          operator: FilterOperator.EQ,
          value1: sKeyValue,
          caseSensitive: bFilteringCaseSensitive
        })];
      } else {
        const mKeyValues = {};
        // Create a map of all key values
        aKeyValues.forEach(function (sKeyAssignment) {
          const aParts = sKeyAssignment.split("="),
            sKeyValue = fnUnquoteAndDecode(aParts[1]);
          mKeyValues[aParts[0]] = sKeyValue;
        });
        let bFailed = false;
        aFilters = aSemanticKeys.map(function (oSemanticKey) {
          const sKey = oSemanticKey.$PropertyPath,
            sValue = mKeyValues[sKey];
          if (sValue !== undefined) {
            return new Filter({
              path: sKey,
              operator: FilterOperator.EQ,
              value1: sValue,
              caseSensitive: bFilteringCaseSensitive
            });
          } else {
            bFailed = true;
            return new Filter({
              path: "XX"
            }); // will be ignore anyway since we return after
          }
        });

        if (bFailed) {
          return null;
        }
      }

      // Add a draft filter to make sure we take the draft entity if there is one
      // Or the active entity otherwise
      const oDraftFilter = new Filter({
        filters: [new Filter("IsActiveEntity", "EQ", false), new Filter("SiblingEntity/IsActiveEntity", "EQ", null)],
        and: false
      });
      aFilters.push(oDraftFilter);
      return new Filter(aFilters, true);
    }

    /**
     * Converts a path with semantic keys to a path with technical keys.
     *
     * @param sSemanticPath The path with semantic keys
     * @param oModel The model for the path
     * @param aSemanticKeys The semantic keys for the path
     * @returns A Promise containing the path with technical keys if sSemanticPath could be interpreted as a semantic path, null otherwise
     * @ui5-restricted
     */;
    _proto._getTechnicalPathFromSemanticPath = function _getTechnicalPathFromSemanticPath(sSemanticPath, oModel, aSemanticKeys) {
      var _sEntitySetPath;
      const oMetaModel = oModel.getMetaModel();
      let sEntitySetPath = oMetaModel.getMetaContext(sSemanticPath).getPath();
      if (!aSemanticKeys || aSemanticKeys.length === 0) {
        // No semantic keys
        return Promise.resolve(null);
      }

      // Create a set of filters corresponding to all keys
      const oFilter = this._createFilterFromSemanticPath(sSemanticPath, aSemanticKeys, oMetaModel);
      if (oFilter === null) {
        // Couldn't interpret the path as a semantic one
        return Promise.resolve(null);
      }

      // Load the corresponding object
      if (!((_sEntitySetPath = sEntitySetPath) !== null && _sEntitySetPath !== void 0 && _sEntitySetPath.startsWith("/"))) {
        sEntitySetPath = `/${sEntitySetPath}`;
      }
      const oListBinding = oModel.bindList(sEntitySetPath, undefined, undefined, oFilter, {
        $$groupId: "$auto.Heroes"
      });
      return oListBinding.requestContexts(0, 2).then(function (oContexts) {
        if (oContexts && oContexts.length) {
          return oContexts[0].getPath();
        } else {
          // No data could be loaded
          return null;
        }
      });
    }

    /**
     * Checks if a path is eligible for semantic bookmarking.
     *
     * @param sPath The path to test
     * @param oMetaModel The associated metadata model
     * @returns `true` if the path is eligible
     * @ui5-restricted
     */;
    _proto._checkPathForSemanticBookmarking = function _checkPathForSemanticBookmarking(sPath, oMetaModel) {
      // Only path on root objects allow semantic bookmarking, i.e. sPath = xxx(yyy)
      const aMatches = /^[\/]?(\w+)\([^\/]+\)$/.exec(sPath);
      if (!aMatches) {
        return false;
      }
      // Get the entitySet name
      const sEntitySetPath = `/${aMatches[1]}`;
      // Check the entity set supports draft (otherwise we don't support semantic bookmarking)
      const oDraftRoot = oMetaModel.getObject(`${sEntitySetPath}@com.sap.vocabularies.Common.v1.DraftRoot`);
      const oDraftNode = oMetaModel.getObject(`${sEntitySetPath}@com.sap.vocabularies.Common.v1.DraftNode`);
      return oDraftRoot || oDraftNode ? true : false;
    }

    /**
     * Builds a path with semantic keys from a path with technical keys.
     *
     * @param sPathToResolve The path to be transformed
     * @param oModel The OData model
     * @returns String promise for the new path. If sPathToResolved couldn't be interpreted as a semantic path, it is returned as is.
     * @ui5-restricted
     */;
    _proto._resolveSemanticPath = function _resolveSemanticPath(sPathToResolve, oModel) {
      const oMetaModel = oModel.getMetaModel();
      const oLastSemanticMapping = this._oRoutingService.getLastSemanticMapping();
      let sCurrentHashNoParams = this._oRouter.getHashChanger().getHash().split("?")[0];
      if (sCurrentHashNoParams && sCurrentHashNoParams.lastIndexOf("/") === sCurrentHashNoParams.length - 1) {
        // Remove trailing '/'
        sCurrentHashNoParams = sCurrentHashNoParams.substring(0, sCurrentHashNoParams.length - 1);
      }
      let sRootEntityName = sCurrentHashNoParams && sCurrentHashNoParams.substr(0, sCurrentHashNoParams.indexOf("("));
      if (sRootEntityName.indexOf("/") === 0) {
        sRootEntityName = sRootEntityName.substring(1);
      }
      const bAllowSemanticBookmark = this._checkPathForSemanticBookmarking(sCurrentHashNoParams, oMetaModel),
        aSemanticKeys = bAllowSemanticBookmark && SemanticKeyHelper.getSemanticKeys(oMetaModel, sRootEntityName);
      if (!aSemanticKeys) {
        // No semantic keys available --> use the path as is
        return Promise.resolve(sPathToResolve);
      } else if (oLastSemanticMapping && oLastSemanticMapping.semanticPath === sPathToResolve) {
        // This semantic path has been resolved previously
        return Promise.resolve(oLastSemanticMapping.technicalPath);
      } else {
        // We need resolve the semantic path to get the technical keys
        return this._getTechnicalPathFromSemanticPath(sCurrentHashNoParams, oModel, aSemanticKeys).then(sTechnicalPath => {
          if (sTechnicalPath && sTechnicalPath !== sPathToResolve) {
            // The semantic path was resolved (otherwise keep the original value for target)
            this._oRoutingService.setLastSemanticMapping({
              technicalPath: sTechnicalPath,
              semanticPath: sPathToResolve
            });
            return sTechnicalPath;
          } else {
            return sPathToResolve;
          }
        });
      }
    }

    /**
     * Sets the binding context of the page from a path.
     *
     * @param sTargetPath The path to build the context. Needs to contain technical keys only.
     * @param oModel The OData model
     * @param oNavigationParameters Navigation parameters
     * @ui5-restricted
     */;
    _proto._bindPageToPath = function _bindPageToPath(sTargetPath, oModel, oNavigationParameters) {
      const oCurrentContext = this._getBindingContext(),
        sCurrentPath = oCurrentContext && oCurrentContext.getPath(),
        oUseContext = oNavigationParameters.useContext;

      // We set the binding context only if it's different from the current one
      // or if we have a context already selected
      if (oUseContext && oUseContext.getPath() === sTargetPath) {
        if (oUseContext !== oCurrentContext) {
          // We already have the context to be used, and it's not the current one
          const oRootViewController = this._oAppComponent.getRootViewController();

          // In case of FCL, if we're reusing a context from a table (through navigation), we refresh it to avoid outdated data
          // We don't wait for the refresh to be completed (requestRefresh), so that the corresponding query goes into the same
          // batch as the ones from controls in the page.
          if (oRootViewController.isFclEnabled() && oNavigationParameters.reason === NavigationReason.RowPress) {
            const metaModel = oUseContext.getModel().getMetaModel();
            if (!oUseContext.getBinding().hasPendingChanges()) {
              oUseContext.refresh();
            } else if (isConnected(this.getView()) || ModelHelper.isDraftSupported(metaModel, oUseContext.getPath()) && ModelHelper.isCollaborationDraftSupported(metaModel)) {
              // If there are pending changes but we're in collaboration draft, we force the refresh (discarding pending changes) as we need to have the latest version.
              // When navigating from LR to OP, the view is not connected yet --> check if we're in draft with collaboration from the metamodel
              oUseContext.getBinding().resetChanges();
              oUseContext.refresh();
            }
          }
          this._bindPageToContext(oUseContext, oModel, oNavigationParameters);
        }
      } else if (sCurrentPath !== sTargetPath) {
        // We need to create a new context for its path
        this._bindPageToContext(this._createContext(sTargetPath, oModel), oModel, oNavigationParameters);
      } else if (oNavigationParameters.reason !== NavigationReason.AppStateChanged && EditState.isEditStateDirty()) {
        this._refreshBindingContext(oCurrentContext);
      }
    }

    /**
     * Binds the page to a context.
     *
     * @param oContext Context to be bound
     * @param oModel The OData model
     * @param oNavigationParameters Navigation parameters
     * @ui5-restricted
     */;
    _proto._bindPageToContext = function _bindPageToContext(oContext, oModel, oNavigationParameters) {
      if (!oContext) {
        this.onBeforeBinding(null);
        this.onAfterBinding(null);
        return;
      }
      const oParentListBinding = oContext.getBinding();
      const oRootViewController = this._oAppComponent.getRootViewController();
      if (oRootViewController.isFclEnabled()) {
        if (!oParentListBinding || !oParentListBinding.isA("sap.ui.model.odata.v4.ODataListBinding")) {
          // if the parentBinding is not a listBinding, we create a new context
          oContext = this._createContext(oContext.getPath(), oModel);
        }
        try {
          this._setKeepAlive(oContext, true, () => {
            if (oRootViewController.isContextUsedInPages(oContext)) {
              this.navigateBackFromContext(oContext);
            }
          }, true // Load messages, otherwise they don't get refreshed later, e.g. for side effects
          );
        } catch (oError) {
          // setKeepAlive throws an exception if the parent listbinding doesn't have $$ownRequest=true
          // This case for custom fragments is supported, but an error is logged to make the lack of synchronization apparent
          Log.error(`View for ${oContext.getPath()} won't be synchronized. Parent listBinding must have binding parameter $$ownRequest=true`);
        }
      } else if (!oParentListBinding || oParentListBinding.isA("sap.ui.model.odata.v4.ODataListBinding")) {
        // We need to recreate the context otherwise we get errors
        oContext = this._createContext(oContext.getPath(), oModel);
      }

      // Set the binding context with the proper before/after callbacks
      this.onBeforeBinding(oContext, {
        editable: oNavigationParameters.bTargetEditable,
        listBinding: oParentListBinding,
        bPersistOPScroll: oNavigationParameters.bPersistOPScroll,
        bDraftNavigation: oNavigationParameters.bDraftNavigation,
        showPlaceholder: oNavigationParameters.bShowPlaceholder
      });
      this._setBindingContext(oContext);
      this.onAfterBinding(oContext);
    }

    /**
     * Creates a context from a path.
     *
     * @param sPath The path
     * @param oModel The OData model
     * @returns The created context
     * @ui5-restricted
     */;
    _proto._createContext = function _createContext(sPath, oModel) {
      const oPageComponent = this._oPageComponent,
        sEntitySet = oPageComponent && oPageComponent.getEntitySet && oPageComponent.getEntitySet(),
        sContextPath = oPageComponent && oPageComponent.getContextPath && oPageComponent.getContextPath() || sEntitySet && `/${sEntitySet}`,
        oMetaModel = oModel.getMetaModel(),
        mParameters = {
          $$groupId: "$auto.Heroes",
          $$updateGroupId: "$auto",
          $$patchWithoutSideEffects: true
        };
      // In case of draft: $select the state flags (HasActiveEntity, HasDraftEntity, and IsActiveEntity)
      const oDraftRoot = oMetaModel.getObject(`${sContextPath}@com.sap.vocabularies.Common.v1.DraftRoot`);
      const oDraftNode = oMetaModel.getObject(`${sContextPath}@com.sap.vocabularies.Common.v1.DraftNode`);
      const oRootViewController = this._oAppComponent.getRootViewController();
      if (oRootViewController.isFclEnabled()) {
        const oContext = this._getKeepAliveContext(oModel, sPath, false, mParameters);
        if (!oContext) {
          throw new Error(`Cannot create keepAlive context ${sPath}`);
        } else if (oDraftRoot || oDraftNode) {
          if (oContext.getProperty("IsActiveEntity") === undefined) {
            oContext.requestProperty(["HasActiveEntity", "HasDraftEntity", "IsActiveEntity"]);
            if (oDraftRoot) {
              oContext.requestObject("DraftAdministrativeData");
            }
          } else {
            // when switching between draft and edit we need to ensure those properties are requested again even if they are in the binding's cache
            // otherwise when you edit and go to the saved version you have no way of switching back to the edit version
            oContext.requestSideEffects(oDraftRoot ? ["HasActiveEntity", "HasDraftEntity", "IsActiveEntity", "DraftAdministrativeData"] : ["HasActiveEntity", "HasDraftEntity", "IsActiveEntity"]);
          }
        }
        return oContext;
      } else {
        if (sEntitySet) {
          const sMessagesPath = oMetaModel.getObject(`${sContextPath}/@com.sap.vocabularies.Common.v1.Messages/$Path`);
          if (sMessagesPath) {
            mParameters.$select = sMessagesPath;
          }
        }

        // In case of draft: $select the state flags (HasActiveEntity, HasDraftEntity, and IsActiveEntity)
        if (oDraftRoot || oDraftNode) {
          if (mParameters.$select === undefined) {
            mParameters.$select = "HasActiveEntity,HasDraftEntity,IsActiveEntity";
          } else {
            mParameters.$select += ",HasActiveEntity,HasDraftEntity,IsActiveEntity";
          }
        }
        if (this._oView.getBindingContext()) {
          var _this$_oView$getBindi2;
          const oPreviousBinding = (_this$_oView$getBindi2 = this._oView.getBindingContext()) === null || _this$_oView$getBindi2 === void 0 ? void 0 : _this$_oView$getBindi2.getBinding();
          oPreviousBinding === null || oPreviousBinding === void 0 ? void 0 : oPreviousBinding.resetChanges().then(() => {
            oPreviousBinding.destroy();
          }).catch(oError => {
            Log.error("Error while reseting the changes to the binding", oError);
          });
        }
        const oHiddenBinding = oModel.bindContext(sPath, undefined, mParameters);
        oHiddenBinding.attachEventOnce("dataRequested", () => {
          BusyLocker.lock(this._oView);
        });
        oHiddenBinding.attachEventOnce("dataReceived", this.onDataReceived.bind(this));
        return oHiddenBinding.getBoundContext();
      }
    };
    _proto.onDataReceived = async function onDataReceived(oEvent) {
      const sErrorDescription = oEvent && oEvent.getParameter("error");
      if (BusyLocker.isLocked(this._oView)) {
        BusyLocker.unlock(this._oView);
      }
      if (sErrorDescription) {
        // TODO: in case of 404 the text shall be different
        try {
          const oResourceBundle = await Core.getLibraryResourceBundle("sap.fe.core", true);
          const messageHandler = this.base.messageHandler;
          let mParams = {};
          if (sErrorDescription.status === 503) {
            mParams = {
              isInitialLoad503Error: true,
              shellBack: true
            };
          } else if (sErrorDescription.status === 400) {
            mParams = {
              title: oResourceBundle.getText("C_COMMON_SAPFE_ERROR"),
              description: oResourceBundle.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR_DESCRIPTION"),
              isDataReceivedError: true,
              shellBack: true
            };
          } else {
            mParams = {
              title: oResourceBundle.getText("C_COMMON_SAPFE_ERROR"),
              description: sErrorDescription,
              isDataReceivedError: true,
              shellBack: true
            };
          }
          await messageHandler.showMessages(mParams);
        } catch (oError) {
          Log.error("Error while getting the core resource bundle", oError);
        }
      }
    }

    /**
     * Requests side effects on a binding context to "refresh" it.
     * TODO: get rid of this once provided by the model
     * a refresh on the binding context does not work in case a creation row with a transient context is
     * used. also a requestSideEffects with an empty path would fail due to the transient context
     * therefore we get all dependent bindings (via private model method) to determine all paths and then
     * request them.
     *
     * @param oBindingContext Context to be refreshed
     * @ui5-restricted
     */;
    _proto._refreshBindingContext = function _refreshBindingContext(oBindingContext) {
      const oPageComponent = this._oPageComponent;
      const oSideEffectsService = this._oAppComponent.getSideEffectsService();
      const sRootContextPath = oBindingContext.getPath();
      const sEntitySet = oPageComponent && oPageComponent.getEntitySet && oPageComponent.getEntitySet();
      const sContextPath = oPageComponent && oPageComponent.getContextPath && oPageComponent.getContextPath() || sEntitySet && `/${sEntitySet}`;
      const oMetaModel = this._oView.getModel().getMetaModel();
      let sMessagesPath;
      const aNavigationPropertyPaths = [];
      const aPropertyPaths = [];
      const oSideEffects = {
        TargetProperties: [],
        TargetEntities: []
      };
      function getBindingPaths(oBinding) {
        let aDependentBindings;
        const sRelativePath = (oBinding.getContext() && oBinding.getContext().getPath() || "").replace(sRootContextPath, ""); // If no context, this is an absolute binding so no relative path
        const sPath = (sRelativePath ? `${sRelativePath.slice(1)}/` : sRelativePath) + oBinding.getPath();
        if (oBinding.isA("sap.ui.model.odata.v4.ODataContextBinding")) {
          // if (sPath === "") {
          // now get the dependent bindings
          aDependentBindings = oBinding.getDependentBindings();
          if (aDependentBindings) {
            // ask the dependent bindings (and only those with the specified groupId
            //if (aDependentBindings.length > 0) {
            for (let i = 0; i < aDependentBindings.length; i++) {
              getBindingPaths(aDependentBindings[i]);
            }
          } else if (aNavigationPropertyPaths.indexOf(sPath) === -1) {
            aNavigationPropertyPaths.push(sPath);
          }
        } else if (oBinding.isA("sap.ui.model.odata.v4.ODataListBinding")) {
          if (aNavigationPropertyPaths.indexOf(sPath) === -1) {
            aNavigationPropertyPaths.push(sPath);
          }
        } else if (oBinding.isA("sap.ui.model.odata.v4.ODataPropertyBinding")) {
          if (aPropertyPaths.indexOf(sPath) === -1) {
            aPropertyPaths.push(sPath);
          }
        }
      }
      if (sContextPath) {
        sMessagesPath = oMetaModel.getObject(`${sContextPath}/@com.sap.vocabularies.Common.v1.Messages/$Path`);
      }

      // binding of the context must have $$PatchWithoutSideEffects true, this bound context may be needed to be fetched from the dependent binding
      getBindingPaths(oBindingContext.getBinding());
      let i;
      for (i = 0; i < aNavigationPropertyPaths.length; i++) {
        oSideEffects.TargetEntities.push({
          $NavigationPropertyPath: aNavigationPropertyPaths[i]
        });
      }
      oSideEffects.TargetProperties = aPropertyPaths;
      if (sMessagesPath) {
        oSideEffects.TargetProperties.push(sMessagesPath);
      }
      //all this logic to be replaced with a SideEffects request for an empty path (refresh everything), after testing transient contexts
      oSideEffects.TargetProperties = oSideEffects.TargetProperties.map(sTargetProperty => {
        if (sTargetProperty) {
          const index = sTargetProperty.indexOf("/");
          if (index > 0) {
            // only request the navigation path and not the property paths further
            return sTargetProperty.slice(0, index);
          }
          return sTargetProperty;
        }
      });
      // OData model will take care of duplicates
      oSideEffectsService.requestSideEffects(oSideEffects.TargetEntities.concat(oSideEffects.TargetProperties), oBindingContext);
    }

    /**
     * Gets the binding context of the page or the component.
     *
     * @returns The binding context
     * @ui5-restricted
     */;
    _proto._getBindingContext = function _getBindingContext() {
      if (this._oPageComponent) {
        return this._oPageComponent.getBindingContext();
      } else {
        return this._oView.getBindingContext();
      }
    }

    /**
     * Sets the binding context of the page or the component.
     *
     * @param oContext The binding context
     * @ui5-restricted
     */;
    _proto._setBindingContext = function _setBindingContext(oContext) {
      var _oPreviousContext;
      let oPreviousContext, oTargetControl;
      if (this._oPageComponent) {
        oPreviousContext = this._oPageComponent.getBindingContext();
        oTargetControl = this._oPageComponent;
      } else {
        oPreviousContext = this._oView.getBindingContext();
        oTargetControl = this._oView;
      }
      oTargetControl.setBindingContext(oContext);
      if ((_oPreviousContext = oPreviousContext) !== null && _oPreviousContext !== void 0 && _oPreviousContext.isKeepAlive() && oPreviousContext !== oContext) {
        this._setKeepAlive(oPreviousContext, false);
      }
    }

    /**
     * Gets the flexible column layout (FCL) level corresponding to the view (-1 if the app is not FCL).
     *
     * @returns The level
     * @ui5-restricted
     */;
    _proto._getFCLLevel = function _getFCLLevel() {
      return this._oTargetInformation.FCLLevel;
    };
    _proto._setKeepAlive = function _setKeepAlive(oContext, bKeepAlive, fnBeforeDestroy, bRequestMessages) {
      if (oContext.getPath().endsWith(")")) {
        // We keep the context alive only if they're part of a collection, i.e. if the path ends with a ')'
        const oMetaModel = oContext.getModel().getMetaModel();
        const sMetaPath = oMetaModel.getMetaPath(oContext.getPath());
        const sMessagesPath = oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.Common.v1.Messages/$Path`);
        oContext.setKeepAlive(bKeepAlive, fnBeforeDestroy, !!sMessagesPath && bRequestMessages);
      }
    };
    _proto._getKeepAliveContext = function _getKeepAliveContext(oModel, path, bRequestMessages, parameters) {
      // Get the path for the context that is really kept alive (part of a collection)
      // i.e. remove all segments not ending with a ')'
      const keptAliveSegments = path.split("/");
      const additionnalSegments = [];
      while (keptAliveSegments.length && !keptAliveSegments[keptAliveSegments.length - 1].endsWith(")")) {
        additionnalSegments.push(keptAliveSegments.pop());
      }
      if (keptAliveSegments.length === 0) {
        return undefined;
      }
      const keptAlivePath = keptAliveSegments.join("/");
      const oKeepAliveContext = oModel.getKeepAliveContext(keptAlivePath, bRequestMessages, parameters);
      if (additionnalSegments.length === 0) {
        return oKeepAliveContext;
      } else {
        additionnalSegments.reverse();
        const additionnalPath = additionnalSegments.join("/");
        return oModel.bindContext(additionnalPath, oKeepAliveContext).getBoundContext();
      }
    }

    /**
     * Switches between column and full-screen mode when FCL is used.
     *
     * @ui5-restricted
     */;
    _proto.switchFullScreen = function switchFullScreen() {
      const oSource = this.base.getView();
      const oFCLHelperModel = oSource.getModel("fclhelper"),
        bIsFullScreen = oFCLHelperModel.getProperty("/actionButtonsInfo/isFullScreen"),
        sNextLayout = oFCLHelperModel.getProperty(bIsFullScreen ? "/actionButtonsInfo/exitFullScreen" : "/actionButtonsInfo/fullScreen"),
        oRootViewController = this._oAppComponent.getRootViewController();
      const oContext = oRootViewController.getRightmostContext ? oRootViewController.getRightmostContext() : oSource.getBindingContext();
      this.base._routing.navigateToContext(oContext, {
        sLayout: sNextLayout
      }).catch(function () {
        Log.warning("cannot switch between column and fullscreen");
      });
    }

    /**
     * Closes the column for the current view in a FCL.
     *
     * @ui5-restricted
     */;
    _proto.closeColumn = function closeColumn() {
      const oViewData = this._oView.getViewData();
      const oContext = this._oView.getBindingContext();
      const oMetaModel = oContext.getModel().getMetaModel();
      const navigationParameters = {
        noPreservationCache: true,
        sLayout: this._oView.getModel("fclhelper").getProperty("/actionButtonsInfo/closeColumn")
      };
      if ((oViewData === null || oViewData === void 0 ? void 0 : oViewData.viewLevel) === 1 && ModelHelper.isDraftSupported(oMetaModel, oContext.getPath())) {
        draft.processDataLossOrDraftDiscardConfirmation(() => {
          this.navigateBackFromContext(oContext, navigationParameters);
        }, Function.prototype, oContext, this._oView.getController(), false, draft.NavigationType.BackNavigation);
      } else {
        this.navigateBackFromContext(oContext, navigationParameters);
      }
    };
    return InternalRouting;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onExit", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "onExit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onRouteMatched", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "onRouteMatched"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onRouteMatchedFinished", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "onRouteMatchedFinished"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeBinding", [_dec8, _dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeBinding"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onAfterBinding", [_dec10, _dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "onAfterBinding"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateToTarget", [_dec12], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateToTarget"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateToRoute", [_dec13], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateToRoute"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateToContext", [_dec14, _dec15], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateToContext"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateBackFromContext", [_dec16, _dec17], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateBackFromContext"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateForwardToContext", [_dec18, _dec19], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateForwardToContext"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateBackFromTransientState", [_dec20, _dec21], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateBackFromTransientState"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateToMessagePage", [_dec22, _dec23], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateToMessagePage"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "isCurrentStateImpactedBy", [_dec24, _dec25], Object.getOwnPropertyDescriptor(_class2.prototype, "isCurrentStateImpactedBy"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onDataReceived", [_dec26], Object.getOwnPropertyDescriptor(_class2.prototype, "onDataReceived"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "switchFullScreen", [_dec27, _dec28], Object.getOwnPropertyDescriptor(_class2.prototype, "switchFullScreen"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "closeColumn", [_dec29, _dec30], Object.getOwnPropertyDescriptor(_class2.prototype, "closeColumn"), _class2.prototype)), _class2)) || _class);
  return InternalRouting;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/InternalRouting", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/fe/core/controllerextensions/editFlow/draft","sap/fe/core/controllerextensions/routing/NavigationReason","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/EditState","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SemanticKeyHelper","sap/ui/core/Component","sap/ui/core/Core","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(t,e,o,n,i,r,a,s,c,g,l,p,u,h,f,d){"use strict";var C,v,P,_,y,m,x,b,w,O,B,R,E,S,A,T,D,F,M,V,I,L,$,j,k,H,N,q,K,z,U,Q;var W=a.publicExtension;var X=a.methodOverride;var G=a.finalExtension;var J=a.extensible;var Y=a.defineUI5Class;var Z=n.isConnected;function tt(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;et(t,e)}function et(t,e){et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,o){e.__proto__=o;return e};return et(t,e)}function ot(t,e,o,n,i){var r={};Object.keys(n).forEach(function(t){r[t]=n[t]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(t,e,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(t,e,r);r=null}return r}let nt=(C=Y("sap.fe.core.controllerextensions.InternalRouting"),v=X(),P=X(),_=W(),y=J(h.After),m=W(),x=J(h.After),b=W(),w=J(h.After),O=W(),B=J(h.After),R=W(),E=W(),S=W(),A=G(),T=W(),D=G(),F=W(),M=G(),V=W(),I=G(),L=W(),$=G(),j=W(),k=G(),H=W(),N=W(),q=G(),K=W(),z=J(h.Before),C(U=(Q=function(n){tt(a,n);function a(){return n.apply(this,arguments)||this}var u=a.prototype;u.onExit=function t(){if(this._oRoutingService){this._oRoutingService.detachRouteMatched(this._fnRouteMatchedBound)}};u.onInit=function t(){this._oView=this.base.getView();this._oAppComponent=e.getAppComponent(this._oView);this._oPageComponent=l.getOwnerComponentFor(this._oView);this._oRouter=this._oAppComponent.getRouter();this._oRouterProxy=this._oAppComponent.getRouterProxy();if(!this._oAppComponent||!this._oPageComponent){throw new Error("Failed to initialize controler extension 'sap.fe.core.controllerextesions.InternalRouting")}if(this._oAppComponent===this._oPageComponent){this._oPageComponent=null}this._oAppComponent.getService("routingService").then(t=>{this._oRoutingService=t;this._fnRouteMatchedBound=this._onRouteMatched.bind(this);this._oRoutingService.attachRouteMatched(this._fnRouteMatchedBound);this._oTargetInformation=t.getTargetInformationFor(this._oPageComponent||this._oView)}).catch(function(){throw new Error("This controller extension cannot work without a 'routingService' on the main AppComponent")})};u.onRouteMatched=function t(){};u.onRouteMatchedFinished=function t(){};u.onBeforeBinding=function t(e,o){const n=this.base.getView().getController().routing;if(n&&n.onBeforeBinding){n.onBeforeBinding(e,o)}};u.onAfterBinding=function t(e,o){this._oAppComponent.getRootViewController().onContextBoundToView(e);const n=this.base.getView().getController().routing;if(n&&n.onAfterBinding){n.onAfterBinding(e,o)}};u.navigateToTarget=function t(e,o,n){const i=this._oPageComponent&&this._oPageComponent.getNavigationConfiguration&&this._oPageComponent.getNavigationConfiguration(o);if(i){const t=i.detail;const o=t.route;const r=t.parameters;this._oRoutingService.navigateTo(e,o,r,n)}else{this._oRoutingService.navigateTo(e,null,null,n)}this._oView.getViewData()};u.navigateToRoute=function t(e,o){return this._oRoutingService.navigateToRoute(e,o)};u.navigateToContext=function e(o,n){const i={};n=n||{};if(o.isA("sap.ui.model.odata.v4.ODataListBinding")){if(n.asyncContext){this._oRouterProxy.activateRouteMatchSynchronization();n.asyncContext.then(t=>{this.navigateToContext(t,{checkNoHashChange:n.checkNoHashChange,editable:n.editable,bPersistOPScroll:n.bPersistOPScroll,updateFCLLevel:n.updateFCLLevel,bForceFocus:n.bForceFocus})}).catch(function(e){t.error("Error with the async context",e)})}else if(!n.bDeferredContext){throw"navigation to a list binding is not yet supported"}}if(n.callExtension){const t=this._oView.getModel("internal");t.setProperty("/paginatorCurrentContext",null);i.sourceBindingContext=o.getObject();i.bindingContext=o;if(n.oEvent){i.oEvent=n.oEvent}const e=this.base.getView().getController().routing.onBeforeNavigation(i);if(e){t.setProperty("/paginatorCurrentContext",o);return Promise.resolve(true)}}n.FCLLevel=this._getFCLLevel();return this._oRoutingService.navigateToContext(o,n,this._oView.getViewData(),this._oTargetInformation)};u.navigateBackFromContext=function t(e,o){o=o||{};o.updateFCLLevel=-1;return this.navigateToContext(e,o)};u.navigateForwardToContext=function t(e,o){var n;if(((n=this._oView.getBindingContext("internal"))===null||n===void 0?void 0:n.getProperty("messageFooterContainsErrors"))===true){return Promise.resolve(true)}o=o||{};o.updateFCLLevel=1;return this.navigateToContext(e,o)};u.navigateBackFromTransientState=function t(){const e=this._oRouterProxy.getHash();if(e.indexOf("(...)")!==-1){this._oRouterProxy.navBack()}};u.navigateToMessagePage=function t(e,o){o=o||{};if(this._oRouterProxy.getHash().indexOf("i-action=create")>-1||this._oRouterProxy.getHash().indexOf("i-action=autoCreate")>-1){return this._oRouterProxy.navToHash(this._oRoutingService.getDefaultCreateHash())}else{o.FCLLevel=this._getFCLLevel();return this._oAppComponent.getRootViewController().displayErrorPage(e,o)}};u.isCurrentStateImpactedBy=function t(e){return this._oRoutingService.isCurrentStateImpactedBy(e)};u._isViewPartOfRoute=function t(e){const o=e===null||e===void 0?void 0:e.targets;if(!o||o.indexOf(this._oTargetInformation.targetName)===-1){if((this._oTargetInformation.viewLevel??0)>=((e===null||e===void 0?void 0:e.routeLevel)??0)){this._setBindingContext(null)}return false}return true};u._buildBindingPath=function t(e,o,n){let i=o.replace(":?query:","");let r=false;for(const t in e){const a=e[t];if(a==="..."&&o.indexOf(`{${t}}`)>=0){r=true;n.bTargetEditable=true}i=i.replace(`{${t}}`,a)}if(e["?query"]&&e["?query"].hasOwnProperty("i-action")){n.bActionCreate=true}if(i&&i[0]!=="/"){i=`/${i}`}return{path:i,deferred:r}};u._onRouteMatched=function t(e){if(!this._isViewPartOfRoute(e.getParameter("routeInformation"))){return}let o;if(this._oPageComponent&&this._oPageComponent.getBindingContextPattern){o=this._oPageComponent.getBindingContextPattern()}o=o||this._oTargetInformation.contextPattern;if(o===null||o===undefined){o=e.getParameter("routePattern")}const n=e.getParameters().arguments;const i=e.getParameter("navigationInfo");const{path:r,deferred:a}=this._buildBindingPath(n,o,i);this.onRouteMatched();const s=this._oView.getModel();let c;if(a){c=this._bindDeferred(r,i)}else{c=this._bindPage(r,s,i)}c.finally(()=>{this.onRouteMatchedFinished()});this._oAppComponent.getRootViewController().updateUIStateForView(this._oView,this._getFCLLevel())};u._bindDeferred=function t(e,o){this.onBeforeBinding(null,{editable:o.bTargetEditable});if(o.bDeferredContext||!o.oAsyncContext){if(this._oPageComponent&&this._oPageComponent.createDeferredContext){this._oPageComponent.createDeferredContext(e,o.useContext,o.bActionCreate)}}const n=this._getBindingContext();if(n!==null&&n!==void 0&&n.hasPendingChanges()){n.getBinding().resetChanges()}this._setBindingContext(null);this.onAfterBinding(null);return Promise.resolve()};u._bindPage=function t(e,o,n){if(e===""){return Promise.resolve(this._bindPageToContext(null,o,n))}else{return this._resolveSemanticPath(e,o).then(t=>{this._bindPageToPath(t,o,n)}).catch(t=>{const e=p.getLibraryResourceBundle("sap.fe.core");this.navigateToMessagePage(e.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR"),{title:e.getText("C_COMMON_SAPFE_ERROR"),description:t.message})})}};u._createFilterFromSemanticPath=function t(e,o,n){const i=function(t){if(t.indexOf("'")===0&&t.lastIndexOf("'")===t.length-1){t=decodeURIComponent(t.substring(1,t.length-1))}return t};const r=e.substring(e.indexOf("(")+1,e.length-1).split(",");let a;if(o.length!=r.length){return null}const s=c.isFilteringCaseSensitive(n);if(o.length===1){const t=i(r[0]);a=[new f({path:o[0].$PropertyPath,operator:d.EQ,value1:t,caseSensitive:s})]}else{const t={};r.forEach(function(e){const o=e.split("="),n=i(o[1]);t[o[0]]=n});let e=false;a=o.map(function(o){const n=o.$PropertyPath,i=t[n];if(i!==undefined){return new f({path:n,operator:d.EQ,value1:i,caseSensitive:s})}else{e=true;return new f({path:"XX"})}});if(e){return null}}const g=new f({filters:[new f("IsActiveEntity","EQ",false),new f("SiblingEntity/IsActiveEntity","EQ",null)],and:false});a.push(g);return new f(a,true)};u._getTechnicalPathFromSemanticPath=function t(e,o,n){var i;const r=o.getMetaModel();let a=r.getMetaContext(e).getPath();if(!n||n.length===0){return Promise.resolve(null)}const s=this._createFilterFromSemanticPath(e,n,r);if(s===null){return Promise.resolve(null)}if(!((i=a)!==null&&i!==void 0&&i.startsWith("/"))){a=`/${a}`}const c=o.bindList(a,undefined,undefined,s,{$$groupId:"$auto.Heroes"});return c.requestContexts(0,2).then(function(t){if(t&&t.length){return t[0].getPath()}else{return null}})};u._checkPathForSemanticBookmarking=function t(e,o){const n=/^[\/]?(\w+)\([^\/]+\)$/.exec(e);if(!n){return false}const i=`/${n[1]}`;const r=o.getObject(`${i}@com.sap.vocabularies.Common.v1.DraftRoot`);const a=o.getObject(`${i}@com.sap.vocabularies.Common.v1.DraftNode`);return r||a?true:false};u._resolveSemanticPath=function t(e,o){const n=o.getMetaModel();const i=this._oRoutingService.getLastSemanticMapping();let r=this._oRouter.getHashChanger().getHash().split("?")[0];if(r&&r.lastIndexOf("/")===r.length-1){r=r.substring(0,r.length-1)}let a=r&&r.substr(0,r.indexOf("("));if(a.indexOf("/")===0){a=a.substring(1)}const s=this._checkPathForSemanticBookmarking(r,n),c=s&&g.getSemanticKeys(n,a);if(!c){return Promise.resolve(e)}else if(i&&i.semanticPath===e){return Promise.resolve(i.technicalPath)}else{return this._getTechnicalPathFromSemanticPath(r,o,c).then(t=>{if(t&&t!==e){this._oRoutingService.setLastSemanticMapping({technicalPath:t,semanticPath:e});return t}else{return e}})}};u._bindPageToPath=function t(e,o,n){const i=this._getBindingContext(),a=i&&i.getPath(),g=n.useContext;if(g&&g.getPath()===e){if(g!==i){const t=this._oAppComponent.getRootViewController();if(t.isFclEnabled()&&n.reason===r.RowPress){const t=g.getModel().getMetaModel();if(!g.getBinding().hasPendingChanges()){g.refresh()}else if(Z(this.getView())||c.isDraftSupported(t,g.getPath())&&c.isCollaborationDraftSupported(t)){g.getBinding().resetChanges();g.refresh()}}this._bindPageToContext(g,o,n)}}else if(a!==e){this._bindPageToContext(this._createContext(e,o),o,n)}else if(n.reason!==r.AppStateChanged&&s.isEditStateDirty()){this._refreshBindingContext(i)}};u._bindPageToContext=function e(o,n,i){if(!o){this.onBeforeBinding(null);this.onAfterBinding(null);return}const r=o.getBinding();const a=this._oAppComponent.getRootViewController();if(a.isFclEnabled()){if(!r||!r.isA("sap.ui.model.odata.v4.ODataListBinding")){o=this._createContext(o.getPath(),n)}try{this._setKeepAlive(o,true,()=>{if(a.isContextUsedInPages(o)){this.navigateBackFromContext(o)}},true)}catch(e){t.error(`View for ${o.getPath()} won't be synchronized. Parent listBinding must have binding parameter $$ownRequest=true`)}}else if(!r||r.isA("sap.ui.model.odata.v4.ODataListBinding")){o=this._createContext(o.getPath(),n)}this.onBeforeBinding(o,{editable:i.bTargetEditable,listBinding:r,bPersistOPScroll:i.bPersistOPScroll,bDraftNavigation:i.bDraftNavigation,showPlaceholder:i.bShowPlaceholder});this._setBindingContext(o);this.onAfterBinding(o)};u._createContext=function e(n,i){const r=this._oPageComponent,a=r&&r.getEntitySet&&r.getEntitySet(),s=r&&r.getContextPath&&r.getContextPath()||a&&`/${a}`,c=i.getMetaModel(),g={$$groupId:"$auto.Heroes",$$updateGroupId:"$auto",$$patchWithoutSideEffects:true};const l=c.getObject(`${s}@com.sap.vocabularies.Common.v1.DraftRoot`);const p=c.getObject(`${s}@com.sap.vocabularies.Common.v1.DraftNode`);const u=this._oAppComponent.getRootViewController();if(u.isFclEnabled()){const t=this._getKeepAliveContext(i,n,false,g);if(!t){throw new Error(`Cannot create keepAlive context ${n}`)}else if(l||p){if(t.getProperty("IsActiveEntity")===undefined){t.requestProperty(["HasActiveEntity","HasDraftEntity","IsActiveEntity"]);if(l){t.requestObject("DraftAdministrativeData")}}else{t.requestSideEffects(l?["HasActiveEntity","HasDraftEntity","IsActiveEntity","DraftAdministrativeData"]:["HasActiveEntity","HasDraftEntity","IsActiveEntity"])}}return t}else{if(a){const t=c.getObject(`${s}/@com.sap.vocabularies.Common.v1.Messages/$Path`);if(t){g.$select=t}}if(l||p){if(g.$select===undefined){g.$select="HasActiveEntity,HasDraftEntity,IsActiveEntity"}else{g.$select+=",HasActiveEntity,HasDraftEntity,IsActiveEntity"}}if(this._oView.getBindingContext()){var h;const e=(h=this._oView.getBindingContext())===null||h===void 0?void 0:h.getBinding();e===null||e===void 0?void 0:e.resetChanges().then(()=>{e.destroy()}).catch(e=>{t.error("Error while reseting the changes to the binding",e)})}const e=i.bindContext(n,undefined,g);e.attachEventOnce("dataRequested",()=>{o.lock(this._oView)});e.attachEventOnce("dataReceived",this.onDataReceived.bind(this));return e.getBoundContext()}};u.onDataReceived=async function e(n){const i=n&&n.getParameter("error");if(o.isLocked(this._oView)){o.unlock(this._oView)}if(i){try{const t=await p.getLibraryResourceBundle("sap.fe.core",true);const e=this.base.messageHandler;let o={};if(i.status===503){o={isInitialLoad503Error:true,shellBack:true}}else if(i.status===400){o={title:t.getText("C_COMMON_SAPFE_ERROR"),description:t.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR_DESCRIPTION"),isDataReceivedError:true,shellBack:true}}else{o={title:t.getText("C_COMMON_SAPFE_ERROR"),description:i,isDataReceivedError:true,shellBack:true}}await e.showMessages(o)}catch(e){t.error("Error while getting the core resource bundle",e)}}};u._refreshBindingContext=function t(e){const o=this._oPageComponent;const n=this._oAppComponent.getSideEffectsService();const i=e.getPath();const r=o&&o.getEntitySet&&o.getEntitySet();const a=o&&o.getContextPath&&o.getContextPath()||r&&`/${r}`;const s=this._oView.getModel().getMetaModel();let c;const g=[];const l=[];const p={TargetProperties:[],TargetEntities:[]};function u(t){let e;const o=(t.getContext()&&t.getContext().getPath()||"").replace(i,"");const n=(o?`${o.slice(1)}/`:o)+t.getPath();if(t.isA("sap.ui.model.odata.v4.ODataContextBinding")){e=t.getDependentBindings();if(e){for(let t=0;t<e.length;t++){u(e[t])}}else if(g.indexOf(n)===-1){g.push(n)}}else if(t.isA("sap.ui.model.odata.v4.ODataListBinding")){if(g.indexOf(n)===-1){g.push(n)}}else if(t.isA("sap.ui.model.odata.v4.ODataPropertyBinding")){if(l.indexOf(n)===-1){l.push(n)}}}if(a){c=s.getObject(`${a}/@com.sap.vocabularies.Common.v1.Messages/$Path`)}u(e.getBinding());let h;for(h=0;h<g.length;h++){p.TargetEntities.push({$NavigationPropertyPath:g[h]})}p.TargetProperties=l;if(c){p.TargetProperties.push(c)}p.TargetProperties=p.TargetProperties.map(t=>{if(t){const e=t.indexOf("/");if(e>0){return t.slice(0,e)}return t}});n.requestSideEffects(p.TargetEntities.concat(p.TargetProperties),e)};u._getBindingContext=function t(){if(this._oPageComponent){return this._oPageComponent.getBindingContext()}else{return this._oView.getBindingContext()}};u._setBindingContext=function t(e){var o;let n,i;if(this._oPageComponent){n=this._oPageComponent.getBindingContext();i=this._oPageComponent}else{n=this._oView.getBindingContext();i=this._oView}i.setBindingContext(e);if((o=n)!==null&&o!==void 0&&o.isKeepAlive()&&n!==e){this._setKeepAlive(n,false)}};u._getFCLLevel=function t(){return this._oTargetInformation.FCLLevel};u._setKeepAlive=function t(e,o,n,i){if(e.getPath().endsWith(")")){const t=e.getModel().getMetaModel();const r=t.getMetaPath(e.getPath());const a=t.getObject(`${r}/@com.sap.vocabularies.Common.v1.Messages/$Path`);e.setKeepAlive(o,n,!!a&&i)}};u._getKeepAliveContext=function t(e,o,n,i){const r=o.split("/");const a=[];while(r.length&&!r[r.length-1].endsWith(")")){a.push(r.pop())}if(r.length===0){return undefined}const s=r.join("/");const c=e.getKeepAliveContext(s,n,i);if(a.length===0){return c}else{a.reverse();const t=a.join("/");return e.bindContext(t,c).getBoundContext()}};u.switchFullScreen=function e(){const o=this.base.getView();const n=o.getModel("fclhelper"),i=n.getProperty("/actionButtonsInfo/isFullScreen"),r=n.getProperty(i?"/actionButtonsInfo/exitFullScreen":"/actionButtonsInfo/fullScreen"),a=this._oAppComponent.getRootViewController();const s=a.getRightmostContext?a.getRightmostContext():o.getBindingContext();this.base._routing.navigateToContext(s,{sLayout:r}).catch(function(){t.warning("cannot switch between column and fullscreen")})};u.closeColumn=function t(){const e=this._oView.getViewData();const o=this._oView.getBindingContext();const n=o.getModel().getMetaModel();const r={noPreservationCache:true,sLayout:this._oView.getModel("fclhelper").getProperty("/actionButtonsInfo/closeColumn")};if((e===null||e===void 0?void 0:e.viewLevel)===1&&c.isDraftSupported(n,o.getPath())){i.processDataLossOrDraftDiscardConfirmation(()=>{this.navigateBackFromContext(o,r)},Function.prototype,o,this._oView.getController(),false,i.NavigationType.BackNavigation)}else{this.navigateBackFromContext(o,r)}};return a}(u),ot(Q.prototype,"onExit",[v],Object.getOwnPropertyDescriptor(Q.prototype,"onExit"),Q.prototype),ot(Q.prototype,"onInit",[P],Object.getOwnPropertyDescriptor(Q.prototype,"onInit"),Q.prototype),ot(Q.prototype,"onRouteMatched",[_,y],Object.getOwnPropertyDescriptor(Q.prototype,"onRouteMatched"),Q.prototype),ot(Q.prototype,"onRouteMatchedFinished",[m,x],Object.getOwnPropertyDescriptor(Q.prototype,"onRouteMatchedFinished"),Q.prototype),ot(Q.prototype,"onBeforeBinding",[b,w],Object.getOwnPropertyDescriptor(Q.prototype,"onBeforeBinding"),Q.prototype),ot(Q.prototype,"onAfterBinding",[O,B],Object.getOwnPropertyDescriptor(Q.prototype,"onAfterBinding"),Q.prototype),ot(Q.prototype,"navigateToTarget",[R],Object.getOwnPropertyDescriptor(Q.prototype,"navigateToTarget"),Q.prototype),ot(Q.prototype,"navigateToRoute",[E],Object.getOwnPropertyDescriptor(Q.prototype,"navigateToRoute"),Q.prototype),ot(Q.prototype,"navigateToContext",[S,A],Object.getOwnPropertyDescriptor(Q.prototype,"navigateToContext"),Q.prototype),ot(Q.prototype,"navigateBackFromContext",[T,D],Object.getOwnPropertyDescriptor(Q.prototype,"navigateBackFromContext"),Q.prototype),ot(Q.prototype,"navigateForwardToContext",[F,M],Object.getOwnPropertyDescriptor(Q.prototype,"navigateForwardToContext"),Q.prototype),ot(Q.prototype,"navigateBackFromTransientState",[V,I],Object.getOwnPropertyDescriptor(Q.prototype,"navigateBackFromTransientState"),Q.prototype),ot(Q.prototype,"navigateToMessagePage",[L,$],Object.getOwnPropertyDescriptor(Q.prototype,"navigateToMessagePage"),Q.prototype),ot(Q.prototype,"isCurrentStateImpactedBy",[j,k],Object.getOwnPropertyDescriptor(Q.prototype,"isCurrentStateImpactedBy"),Q.prototype),ot(Q.prototype,"onDataReceived",[H],Object.getOwnPropertyDescriptor(Q.prototype,"onDataReceived"),Q.prototype),ot(Q.prototype,"switchFullScreen",[N,q],Object.getOwnPropertyDescriptor(Q.prototype,"switchFullScreen"),Q.prototype),ot(Q.prototype,"closeColumn",[K,z],Object.getOwnPropertyDescriptor(Q.prototype,"closeColumn"),Q.prototype),Q))||U);return nt},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/KPIManagement-dbg", ["sap/base/Log", "sap/fe/core/formatters/TableFormatterTypes", "sap/m/Popover", "sap/ui/core/Core", "sap/ui/core/format/DateFormat", "sap/ui/core/format/NumberFormat", "sap/ui/core/Locale", "sap/ui/core/mvc/ControllerExtension", "sap/ui/model/Filter", "sap/ui/model/json/JSONModel", "sap/ui/model/Sorter", "../helpers/ClassSupport"], function (Log, TableFormatterTypes, Popover, Core, DateFormat, NumberFormat, Locale, ControllerExtension, Filter, JSONModel, Sorter, ClassSupport) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var methodOverride = ClassSupport.methodOverride;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var MessageType = TableFormatterTypes.MessageType;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  const MessageTypeFromCriticality = {
    "1": MessageType.Error,
    "2": MessageType.Warning,
    "3": MessageType.Success,
    "5": MessageType.Information
  };
  const ValueColorFromMessageType = {
    Error: "Error",
    Warning: "Critical",
    Success: "Good",
    Information: "None",
    None: "None"
  };

  /**
   * Function to get a message state from a calculated criticality of type 'Target'.
   *
   * @param kpiValue The value of the KPI to be tested against.
   * @param aThresholds Thresholds to be used [DeviationRangeLowValue,ToleranceRangeLowValue,AcceptanceRangeLowValue,AcceptanceRangeHighValue,ToleranceRangeHighValue,DeviationRangeHighValue].
   * @returns The corresponding MessageType
   */
  function messageTypeFromTargetCalculation(kpiValue, aThresholds) {
    let criticalityProperty;
    if (aThresholds[0] !== undefined && aThresholds[0] !== null && kpiValue < aThresholds[0]) {
      criticalityProperty = MessageType.Error;
    } else if (aThresholds[1] !== undefined && aThresholds[1] !== null && kpiValue < aThresholds[1]) {
      criticalityProperty = MessageType.Warning;
    } else if (aThresholds[2] !== undefined && aThresholds[2] !== null && kpiValue < aThresholds[2]) {
      criticalityProperty = MessageType.None;
    } else if (aThresholds[5] !== undefined && aThresholds[5] !== null && kpiValue > aThresholds[5]) {
      criticalityProperty = MessageType.Error;
    } else if (aThresholds[4] !== undefined && aThresholds[4] !== null && kpiValue > aThresholds[4]) {
      criticalityProperty = MessageType.Warning;
    } else if (aThresholds[3] !== undefined && aThresholds[3] !== null && kpiValue > aThresholds[3]) {
      criticalityProperty = MessageType.None;
    } else {
      criticalityProperty = MessageType.Success;
    }
    return criticalityProperty;
  }

  /**
   * Function to get a message state from a calculated criticality of type 'Minimize'.
   *
   * @param kpiValue The value of the KPI to be tested against.
   * @param aThresholds Thresholds to be used [AcceptanceRangeHighValue,ToleranceRangeHighValue,DeviationRangeHighValue].
   * @returns The corresponding MessageType
   */
  function messageTypeFromMinimizeCalculation(kpiValue, aThresholds) {
    let criticalityProperty;
    if (aThresholds[2] !== undefined && aThresholds[2] !== null && kpiValue > aThresholds[2]) {
      criticalityProperty = MessageType.Error;
    } else if (aThresholds[1] !== undefined && aThresholds[1] !== null && kpiValue > aThresholds[1]) {
      criticalityProperty = MessageType.Warning;
    } else if (aThresholds[0] !== undefined && aThresholds[0] !== null && kpiValue > aThresholds[0]) {
      criticalityProperty = MessageType.None;
    } else {
      criticalityProperty = MessageType.Success;
    }
    return criticalityProperty;
  }

  /**
   * Function to get a message state from a calculated criticality of type 'Maximize'.
   *
   * @param kpiValue The value of the KPI to be tested against.
   * @param aThresholds Thresholds to be used [DeviationRangeLowValue,ToleranceRangeLowValue,AcceptanceRangeLowValue].
   * @returns The corresponding MessageType
   */
  function messageTypeFromMaximizeCalculation(kpiValue, aThresholds) {
    let criticalityProperty;
    if (aThresholds[0] !== undefined && aThresholds[0] !== null && kpiValue < aThresholds[0]) {
      criticalityProperty = MessageType.Error;
    } else if (aThresholds[1] !== undefined && aThresholds[1] !== null && kpiValue < aThresholds[1]) {
      criticalityProperty = MessageType.Warning;
    } else if (aThresholds[2] !== undefined && aThresholds[2] !== null && kpiValue < aThresholds[2]) {
      criticalityProperty = MessageType.None;
    } else {
      criticalityProperty = MessageType.Success;
    }
    return criticalityProperty;
  }

  /**
   * Function to calculate a DeviationIndicator value from a trend value.
   *
   * @param trendValue The criticality values.
   * @returns The corresponding DeviationIndicator value
   */
  function deviationIndicatorFromTrendType(trendValue) {
    let deviationIndicator;
    switch (trendValue) {
      case 1: // StrongUp
      case "1":
      case 2: // Up
      case "2":
        deviationIndicator = "Up";
        break;
      case 4: // Down
      case "4":
      case 5: // StrongDown
      case "5":
        deviationIndicator = "Down";
        break;
      default:
        deviationIndicator = "None";
    }
    return deviationIndicator;
  }

  /**
   * Function to calculate a DeviationIndicator from a TrendCalculation.
   *
   * @param kpiValue The value of the KPI
   * @param referenceValue The reference value to compare with
   * @param isRelative True is the comparison is relative
   * @param aThresholds Array of thresholds [StrongDownDifference, DownDifference, UpDifference, StrongUpDifference]
   * @returns The corresponding DeviationIndicator value
   */
  function deviationIndicatorFromCalculation(kpiValue, referenceValue, isRelative, aThresholds) {
    let deviationIndicator;
    if (!aThresholds || isRelative && !referenceValue) {
      return "None";
    }
    const compValue = isRelative ? (kpiValue - referenceValue) / referenceValue : kpiValue - referenceValue;
    if (aThresholds[0] !== undefined && aThresholds[0] !== null && compValue <= aThresholds[0]) {
      // StrongDown --> Down
      deviationIndicator = "Down";
    } else if (aThresholds[1] !== undefined && aThresholds[1] !== null && compValue <= aThresholds[1]) {
      // Down --> Down
      deviationIndicator = "Down";
    } else if (aThresholds[3] !== undefined && aThresholds[3] !== null && compValue >= aThresholds[3]) {
      // StrongUp --> Up
      deviationIndicator = "Up";
    } else if (aThresholds[2] !== undefined && aThresholds[2] !== null && compValue >= aThresholds[2]) {
      // Up --> Up
      deviationIndicator = "Up";
    } else {
      // Sideways --> None
      deviationIndicator = "None";
    }
    return deviationIndicator;
  }

  /**
   * Creates a sap.ui.model.Filter from a filter definition.
   *
   * @param filterDefinition The filter definition
   * @returns Returns a sap.ui.model.Filter from the definition, or undefined if the definition is empty (no ranges)
   */
  function createFilterFromDefinition(filterDefinition) {
    if (filterDefinition.ranges.length === 0) {
      return undefined;
    } else if (filterDefinition.ranges.length === 1) {
      return new Filter(filterDefinition.propertyPath, filterDefinition.ranges[0].operator, filterDefinition.ranges[0].rangeLow, filterDefinition.ranges[0].rangeHigh);
    } else {
      const aRangeFilters = filterDefinition.ranges.map(range => {
        return new Filter(filterDefinition.propertyPath, range.operator, range.rangeLow, range.rangeHigh);
      });
      return new Filter({
        filters: aRangeFilters,
        and: false
      });
    }
  }
  function getFilterStringFromDefinition(filterDefinition) {
    const currentLocale = new Locale(sap.ui.getCore().getConfiguration().getLanguage());
    const resBundle = Core.getLibraryResourceBundle("sap.fe.core");
    const dateFormat = DateFormat.getDateInstance({
      style: "medium"
    }, currentLocale);
    function formatRange(range) {
      const valueLow = filterDefinition.propertyType.indexOf("Edm.Date") === 0 ? dateFormat.format(new Date(range.rangeLow)) : range.rangeLow;
      const valueHigh = filterDefinition.propertyType.indexOf("Edm.Date") === 0 ? dateFormat.format(new Date(range.rangeHigh)) : range.rangeHigh;
      switch (range.operator) {
        case "BT":
          return `[${valueLow} - ${valueHigh}]`;
        case "Contains":
          return `*${valueLow}*`;
        case "GE":
          return `\u2265${valueLow}`;
        case "GT":
          return `>${valueLow}`;
        case "LE":
          return `\u2264${valueLow}`;
        case "LT":
          return `<${valueLow}`;
        case "NB":
          return resBundle.getText("C_KPICARD_FILTERSTRING_NOT", [`[${valueLow} - ${valueHigh}]`]);
        case "NE":
          return `\u2260${valueLow}`;
        case "NotContains":
          return resBundle.getText("C_KPICARD_FILTERSTRING_NOT", [`*${valueLow}*`]);
        case "EQ":
        default:
          return valueLow;
      }
    }
    if (filterDefinition.ranges.length === 0) {
      return "";
    } else if (filterDefinition.ranges.length === 1) {
      return formatRange(filterDefinition.ranges[0]);
    } else {
      return `(${filterDefinition.ranges.map(formatRange).join(",")})`;
    }
  }
  function formatChartTitle(kpiDef) {
    const resBundle = Core.getLibraryResourceBundle("sap.fe.core");
    function formatList(items) {
      if (items.length === 0) {
        return "";
      } else if (items.length === 1) {
        return items[0].label;
      } else {
        let res = items[0].label;
        for (let I = 1; I < items.length - 1; I++) {
          res += `, ${items[I].label}`;
        }
        return resBundle.getText("C_KPICARD_ITEMSLIST", [res, items[items.length - 1].label]);
      }
    }
    return resBundle.getText("C_KPICARD_CHARTTITLE", [formatList(kpiDef.chart.measures), formatList(kpiDef.chart.dimensions)]);
  }
  function updateChartLabelSettings(chartDefinition, oChartProperties) {
    switch (chartDefinition.chartType) {
      case "Donut":
        // Show data labels, do not show axis titles
        oChartProperties.categoryAxis = {
          title: {
            visible: false
          }
        };
        oChartProperties.valueAxis = {
          title: {
            visible: false
          },
          label: {
            formatString: "ShortFloat"
          }
        };
        oChartProperties.plotArea.dataLabel = {
          visible: true,
          type: "value",
          formatString: "ShortFloat_MFD2"
        };
        break;
      case "bubble":
        // Show axis title, bubble size legend, do not show data labels
        oChartProperties.valueAxis = {
          title: {
            visible: true
          },
          label: {
            formatString: "ShortFloat"
          }
        };
        oChartProperties.valueAxis2 = {
          title: {
            visible: true
          },
          label: {
            formatString: "ShortFloat"
          }
        };
        oChartProperties.legendGroup = {
          layout: {
            position: "bottom",
            alignment: "topLeft"
          }
        };
        oChartProperties.sizeLegend = {
          visible: true
        };
        oChartProperties.plotArea.dataLabel = {
          visible: false
        };
        break;
      case "scatter":
        // Do not show data labels and axis titles
        oChartProperties.valueAxis = {
          title: {
            visible: false
          },
          label: {
            formatString: "ShortFloat"
          }
        };
        oChartProperties.valueAxis2 = {
          title: {
            visible: false
          },
          label: {
            formatString: "ShortFloat"
          }
        };
        oChartProperties.plotArea.dataLabel = {
          visible: false
        };
        break;
      default:
        // Do not show data labels and axis titles
        oChartProperties.categoryAxis = {
          title: {
            visible: false
          }
        };
        oChartProperties.valueAxis = {
          title: {
            visible: false
          },
          label: {
            formatString: "ShortFloat"
          }
        };
        oChartProperties.plotArea.dataLabel = {
          visible: false
        };
    }
  }
  function filterMap(aObjects, aRoles) {
    if (aRoles && aRoles.length) {
      return aObjects.filter(dimension => {
        return aRoles.indexOf(dimension.role) >= 0;
      }).map(dimension => {
        return dimension.label;
      });
    } else {
      return aObjects.map(dimension => {
        return dimension.label;
      });
    }
  }
  function getScatterBubbleChartFeeds(chartDefinition) {
    const axis1Measures = filterMap(chartDefinition.measures, ["Axis1"]);
    const axis2Measures = filterMap(chartDefinition.measures, ["Axis2"]);
    const axis3Measures = filterMap(chartDefinition.measures, ["Axis3"]);
    const otherMeasures = filterMap(chartDefinition.measures, [undefined]);
    const seriesDimensions = filterMap(chartDefinition.dimensions, ["Series"]);

    // Get the first dimension with role "Category" for the shape
    const shapeDimension = chartDefinition.dimensions.find(dimension => {
      return dimension.role === "Category";
    });

    // Measure for the x-Axis : first measure for Axis1, or for Axis2 if not found, or for Axis3 if not found
    const xMeasure = axis1Measures.shift() || axis2Measures.shift() || axis3Measures.shift() || otherMeasures.shift() || "";
    // Measure for the y-Axis : first measure for Axis2, or second measure for Axis1 if not found, or first measure for Axis3 if not found
    const yMeasure = axis2Measures.shift() || axis1Measures.shift() || axis3Measures.shift() || otherMeasures.shift() || "";
    const res = [{
      uid: "valueAxis",
      type: "Measure",
      values: [xMeasure]
    }, {
      uid: "valueAxis2",
      type: "Measure",
      values: [yMeasure]
    }];
    if (chartDefinition.chartType === "bubble") {
      // Measure for the size of the bubble: first measure for Axis3, or remaining measure for Axis1/Axis2 if not found
      const sizeMeasure = axis3Measures.shift() || axis1Measures.shift() || axis2Measures.shift() || otherMeasures.shift() || "";
      res.push({
        uid: "bubbleWidth",
        type: "Measure",
        values: [sizeMeasure]
      });
    }

    // Color (optional)
    if (seriesDimensions.length) {
      res.push({
        uid: "color",
        type: "Dimension",
        values: seriesDimensions
      });
    }
    // Shape (optional)
    if (shapeDimension) {
      res.push({
        uid: "shape",
        type: "Dimension",
        values: [shapeDimension.label]
      });
    }
    return res;
  }
  function getChartFeeds(chartDefinition) {
    let res;
    switch (chartDefinition.chartType) {
      case "Donut":
        res = [{
          uid: "size",
          type: "Measure",
          values: filterMap(chartDefinition.measures)
        }, {
          uid: "color",
          type: "Dimension",
          values: filterMap(chartDefinition.dimensions)
        }];
        break;
      case "bubble":
      case "scatter":
        res = getScatterBubbleChartFeeds(chartDefinition);
        break;
      case "vertical_bullet":
        res = [{
          uid: "actualValues",
          type: "Measure",
          values: filterMap(chartDefinition.measures, [undefined, "Axis1"])
        }, {
          uid: "targetValues",
          type: "Measure",
          values: filterMap(chartDefinition.measures, ["Axis2"])
        }, {
          uid: "categoryAxis",
          type: "Dimension",
          values: filterMap(chartDefinition.dimensions, [undefined, "Category"])
        }, {
          uid: "color",
          type: "Dimension",
          values: filterMap(chartDefinition.dimensions, ["Series"])
        }];
        break;
      default:
        res = [{
          uid: "valueAxis",
          type: "Measure",
          values: filterMap(chartDefinition.measures)
        }, {
          uid: "categoryAxis",
          type: "Dimension",
          values: filterMap(chartDefinition.dimensions, [undefined, "Category"])
        }, {
          uid: "color",
          type: "Dimension",
          values: filterMap(chartDefinition.dimensions, ["Series"])
        }];
    }
    return res;
  }
  function getNavigationParameters(navInfo, oShellService) {
    if (navInfo.semanticObject) {
      if (navInfo.action) {
        // Action is already specified: check if it's available in the shell
        return oShellService.getLinks({
          semanticObject: navInfo.semanticObject,
          action: navInfo.action
        }).then(aLinks => {
          return aLinks.length ? {
            semanticObject: navInfo.semanticObject,
            action: navInfo.action
          } : undefined;
        });
      } else {
        // We get the primary intent from the shell
        return oShellService.getPrimaryIntent(navInfo.semanticObject).then(oLink => {
          if (!oLink) {
            // No primary intent...
            return undefined;
          }

          // Check that the primary intent is not part of the unavailable actions
          const oInfo = oShellService.parseShellHash(oLink.intent);
          return navInfo.unavailableActions && navInfo.unavailableActions.indexOf(oInfo.action) >= 0 ? undefined : {
            semanticObject: oInfo.semanticObject,
            action: oInfo.action
          };
        });
      }
    } else {
      // Outbound navigation specified in the manifest
      return navInfo.outboundNavigation ? Promise.resolve({
        outbound: navInfo.outboundNavigation
      }) : Promise.resolve(undefined);
    }
  }

  /**
   * @class A controller extension for managing the KPIs in an analytical list page
   * @name sap.fe.core.controllerextensions.KPIManagement
   * @hideconstructor
   * @private
   * @since 1.93.0
   */
  let KPIManagementControllerExtension = (_dec = defineUI5Class("sap.fe.core.controllerextensions.KPIManagement"), _dec2 = methodOverride(), _dec3 = methodOverride(), _dec4 = publicExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(KPIManagementControllerExtension, _ControllerExtension);
    function KPIManagementControllerExtension() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = KPIManagementControllerExtension.prototype;
    /**
     * Creates the card manifest for a KPI definition and stores it in a JSON model.
     *
     * @param kpiDefinition The KPI definition
     * @param oKPIModel The JSON model in which the manifest will be stored
     */
    _proto.initCardManifest = function initCardManifest(kpiDefinition, oKPIModel) {
      var _kpiDefinition$select;
      const oCardManifest = {
        "sap.app": {
          id: "sap.fe",
          type: "card"
        },
        "sap.ui": {
          technology: "UI5"
        },
        "sap.card": {
          type: "Analytical",
          data: {
            json: {}
          },
          header: {
            type: "Numeric",
            title: kpiDefinition.datapoint.title,
            subTitle: kpiDefinition.datapoint.description,
            unitOfMeasurement: "{mainUnit}",
            mainIndicator: {
              number: "{mainValueNoScale}",
              unit: "{mainValueScale}",
              state: "{mainState}",
              trend: "{trend}"
            }
          },
          content: {
            minHeight: "25rem",
            chartProperties: {
              plotArea: {},
              title: {
                visible: true,
                alignment: "left"
              }
            },
            data: {
              path: "/chartData"
            }
          }
        }
      };

      // Add side indicators in the card header if a target is defined for the KPI
      if (kpiDefinition.datapoint.targetPath || kpiDefinition.datapoint.targetValue !== undefined) {
        const resBundle = Core.getLibraryResourceBundle("sap.fe.core");
        oCardManifest["sap.card"].header.sideIndicators = [{
          title: resBundle.getText("C_KPICARD_INDICATOR_TARGET"),
          number: "{targetNumber}",
          unit: "{targetUnit}"
        }, {
          title: resBundle.getText("C_KPICARD_INDICATOR_DEVIATION"),
          number: "{deviationNumber}",
          unit: "%"
        }];
      }

      // Details of the card: filter descriptions
      if ((_kpiDefinition$select = kpiDefinition.selectionVariantFilterDefinitions) !== null && _kpiDefinition$select !== void 0 && _kpiDefinition$select.length) {
        const aDescriptions = [];
        kpiDefinition.selectionVariantFilterDefinitions.forEach(filterDefinition => {
          const desc = getFilterStringFromDefinition(filterDefinition);
          if (desc) {
            aDescriptions.push(desc);
          }
        });
        if (aDescriptions.length) {
          oCardManifest["sap.card"].header.details = aDescriptions.join(", ");
        }
      }

      // Chart settings: type, title, dimensions and measures in the manifest
      oCardManifest["sap.card"].content.chartType = kpiDefinition.chart.chartType;
      updateChartLabelSettings(kpiDefinition.chart, oCardManifest["sap.card"].content.chartProperties);
      oCardManifest["sap.card"].content.chartProperties.title.text = formatChartTitle(kpiDefinition);
      oCardManifest["sap.card"].content.dimensions = kpiDefinition.chart.dimensions.map(dimension => {
        return {
          label: dimension.label,
          value: `{${dimension.name}}`
        };
      });
      oCardManifest["sap.card"].content.measures = kpiDefinition.chart.measures.map(measure => {
        return {
          label: measure.label,
          value: `{${measure.name}}`
        };
      });
      oCardManifest["sap.card"].content.feeds = getChartFeeds(kpiDefinition.chart);
      oKPIModel.setProperty(`/${kpiDefinition.id}`, {
        manifest: oCardManifest
      });
    };
    _proto.initNavigationInfo = function initNavigationInfo(kpiDefinition, oKPIModel, oShellService) {
      // Add navigation
      if (kpiDefinition.navigation) {
        return getNavigationParameters(kpiDefinition.navigation, oShellService).then(oNavInfo => {
          if (oNavInfo) {
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/header/actions`, [{
              type: "Navigation",
              parameters: oNavInfo
            }]);
          }
        });
      } else {
        return Promise.resolve();
      }
    };
    _proto.onInit = function onInit() {
      var _getPageModel;
      this.aKPIDefinitions = (_getPageModel = this.getView().getController()._getPageModel()) === null || _getPageModel === void 0 ? void 0 : _getPageModel.getProperty("/kpiDefinitions");
      if (this.aKPIDefinitions && this.aKPIDefinitions.length) {
        const oView = this.getView();
        const oAppComponent = oView.getController().getAppComponent();

        // Create a JSON model to store KPI data
        const oKPIModel = new JSONModel();
        oView.setModel(oKPIModel, "kpiModel");
        this.aKPIDefinitions.forEach(kpiDefinition => {
          // Create the manifest for the KPI card and store it in the KPI model
          this.initCardManifest(kpiDefinition, oKPIModel);

          // Set the navigation information in the manifest
          this.initNavigationInfo(kpiDefinition, oKPIModel, oAppComponent.getShellServices()).catch(function (err) {
            Log.error(err);
          });

          // Load tag data for the KPI
          this.loadKPITagData(kpiDefinition, oAppComponent.getModel(), oKPIModel).catch(function (err) {
            Log.error(err);
          });
        });
      }
    };
    _proto.onExit = function onExit() {
      const oKPIModel = this.getView().getModel("kpiModel");
      if (oKPIModel) {
        oKPIModel.destroy();
      }
    };
    _proto.updateDatapointValueAndCurrency = function updateDatapointValueAndCurrency(kpiDefinition, kpiContext, oKPIModel) {
      var _kpiDefinition$datapo, _kpiDefinition$datapo2, _kpiDefinition$datapo3;
      const currentLocale = new Locale(sap.ui.getCore().getConfiguration().getLanguage());
      const rawUnit = (_kpiDefinition$datapo = kpiDefinition.datapoint.unit) !== null && _kpiDefinition$datapo !== void 0 && _kpiDefinition$datapo.isPath ? kpiContext.getProperty(kpiDefinition.datapoint.unit.value) : (_kpiDefinition$datapo2 = kpiDefinition.datapoint.unit) === null || _kpiDefinition$datapo2 === void 0 ? void 0 : _kpiDefinition$datapo2.value;
      const isPercentage = ((_kpiDefinition$datapo3 = kpiDefinition.datapoint.unit) === null || _kpiDefinition$datapo3 === void 0 ? void 0 : _kpiDefinition$datapo3.isCurrency) === false && rawUnit === "%";

      // /////////////////////
      // Main KPI value
      const rawValue = Number.parseFloat(kpiContext.getProperty(kpiDefinition.datapoint.propertyPath));

      // Value formatted with a scale
      const kpiValue = NumberFormat.getFloatInstance({
        style: isPercentage ? undefined : "short",
        minFractionDigits: 0,
        maxFractionDigits: 1,
        showScale: !isPercentage
      }, currentLocale).format(rawValue);
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValue`, kpiValue);

      // Value without a scale
      const kpiValueUnscaled = NumberFormat.getFloatInstance({
        maxFractionDigits: 2,
        showScale: false,
        groupingEnabled: true
      }, currentLocale).format(rawValue);
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValueUnscaled`, kpiValueUnscaled);

      // Value formatted with the scale omitted
      const kpiValueNoScale = NumberFormat.getFloatInstance({
        style: isPercentage ? undefined : "short",
        minFractionDigits: 0,
        maxFractionDigits: 1,
        showScale: false
      }, currentLocale).format(rawValue);
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValueNoScale`, kpiValueNoScale);

      // Scale of the value
      const kpiValueScale = NumberFormat.getFloatInstance({
        style: isPercentage ? undefined : "short",
        decimals: 0,
        maxIntegerDigits: 0,
        showScale: true
      }, currentLocale).format(rawValue);
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValueScale`, kpiValueScale);

      // /////////////////////
      // Unit or currency
      if (kpiDefinition.datapoint.unit && rawUnit) {
        if (kpiDefinition.datapoint.unit.isCurrency) {
          oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainUnit`, rawUnit);
        } else {
          // In case of unit of measure, we have to format it properly
          const kpiUnit = NumberFormat.getUnitInstance({
            showNumber: false
          }, currentLocale).format(rawValue, rawUnit);
          oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainUnit`, kpiUnit);
        }
      }
    };
    _proto.updateDatapointCriticality = function updateDatapointCriticality(kpiDefinition, kpiContext, oKPIModel) {
      const rawValue = Number.parseFloat(kpiContext.getProperty(kpiDefinition.datapoint.propertyPath));
      let criticalityValue = MessageType.None;
      if (kpiDefinition.datapoint.criticalityValue) {
        // Criticality is a fixed value
        criticalityValue = kpiDefinition.datapoint.criticalityValue;
      } else if (kpiDefinition.datapoint.criticalityPath) {
        // Criticality comes from another property (via a path)
        criticalityValue = MessageTypeFromCriticality[kpiContext.getProperty(kpiDefinition.datapoint.criticalityPath)] || MessageType.None;
      } else if (kpiDefinition.datapoint.criticalityCalculationThresholds && kpiDefinition.datapoint.criticalityCalculationMode) {
        // Criticality calculation
        switch (kpiDefinition.datapoint.criticalityCalculationMode) {
          case "UI.ImprovementDirectionType/Target":
            criticalityValue = messageTypeFromTargetCalculation(rawValue, kpiDefinition.datapoint.criticalityCalculationThresholds);
            break;
          case "UI.ImprovementDirectionType/Minimize":
            criticalityValue = messageTypeFromMinimizeCalculation(rawValue, kpiDefinition.datapoint.criticalityCalculationThresholds);
            break;
          case "UI.ImprovementDirectionType/Maximize":
          default:
            criticalityValue = messageTypeFromMaximizeCalculation(rawValue, kpiDefinition.datapoint.criticalityCalculationThresholds);
            break;
        }
      }
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainCriticality`, criticalityValue);
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainState`, ValueColorFromMessageType[criticalityValue] || "None");
    };
    _proto.updateDatapointTrend = function updateDatapointTrend(kpiDefinition, kpiContext, oKPIModel) {
      const rawValue = Number.parseFloat(kpiContext.getProperty(kpiDefinition.datapoint.propertyPath));
      let trendValue = "None";
      if (kpiDefinition.datapoint.trendValue) {
        // Trend is a fixed value
        trendValue = kpiDefinition.datapoint.trendValue;
      } else if (kpiDefinition.datapoint.trendPath) {
        // Trend comes from another property via a path
        trendValue = deviationIndicatorFromTrendType(kpiContext.getProperty(kpiDefinition.datapoint.trendPath));
      } else if (kpiDefinition.datapoint.trendCalculationReferenceValue !== undefined || kpiDefinition.datapoint.trendCalculationReferencePath) {
        // Calculated trend
        let trendReferenceValue;
        if (kpiDefinition.datapoint.trendCalculationReferenceValue !== undefined) {
          trendReferenceValue = kpiDefinition.datapoint.trendCalculationReferenceValue;
        } else {
          trendReferenceValue = Number.parseFloat(kpiContext.getProperty(kpiDefinition.datapoint.trendCalculationReferencePath || ""));
        }
        trendValue = deviationIndicatorFromCalculation(rawValue, trendReferenceValue, !!kpiDefinition.datapoint.trendCalculationIsRelative, kpiDefinition.datapoint.trendCalculationTresholds);
      }
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/trend`, trendValue);
    };
    _proto.updateTargetValue = function updateTargetValue(kpiDefinition, kpiContext, oKPIModel) {
      if (kpiDefinition.datapoint.targetValue === undefined && kpiDefinition.datapoint.targetPath === undefined) {
        return; // No target set for the KPI
      }

      const rawValue = Number.parseFloat(kpiContext.getProperty(kpiDefinition.datapoint.propertyPath));
      const currentLocale = new Locale(sap.ui.getCore().getConfiguration().getLanguage());
      let targetRawValue;
      if (kpiDefinition.datapoint.targetValue !== undefined) {
        targetRawValue = kpiDefinition.datapoint.targetValue;
      } else {
        targetRawValue = Number.parseFloat(kpiContext.getProperty(kpiDefinition.datapoint.targetPath || ""));
      }
      const deviationRawValue = targetRawValue !== 0 ? (rawValue - targetRawValue) / targetRawValue * 100 : undefined;

      // Formatting
      const targetValue = NumberFormat.getFloatInstance({
        style: "short",
        minFractionDigits: 0,
        maxFractionDigits: 1,
        showScale: false
      }, currentLocale).format(targetRawValue);
      const targetScale = NumberFormat.getFloatInstance({
        style: "short",
        decimals: 0,
        maxIntegerDigits: 0,
        showScale: true
      }, currentLocale).format(targetRawValue);
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/targetNumber`, targetValue);
      oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/targetUnit`, targetScale);
      if (deviationRawValue !== undefined) {
        const deviationValue = NumberFormat.getFloatInstance({
          minFractionDigits: 0,
          maxFractionDigits: 1,
          showScale: false
        }, currentLocale).format(deviationRawValue);
        oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/deviationNumber`, deviationValue);
      } else {
        oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/deviationNumber`, "N/A");
      }
    }

    /**
     * Loads tag data for a KPI, and stores it in the JSON KPI model.
     *
     * @param kpiDefinition The definition of the KPI.
     * @param oMainModel The model used to load the data.
     * @param oKPIModel The JSON model where the data will be stored
     * @param loadFull If not true, loads only data for the KPI tag
     * @returns The promise that is resolved when data is loaded.
     */;
    _proto.loadKPITagData = function loadKPITagData(kpiDefinition, oMainModel, oKPIModel, loadFull) {
      var _kpiDefinition$datapo4, _kpiDefinition$select2;
      // If loadFull=false, then we're just loading data for the tag and we use the "$auto.LongRunners" groupID
      // If loadFull=true, we're loading data for the whole KPI (tag + card) and we use the "$auto.Workers" groupID
      const oListBinding = loadFull ? oMainModel.bindList(`/${kpiDefinition.entitySet}`, undefined, undefined, undefined, {
        $$groupId: "$auto.Workers"
      }) : oMainModel.bindList(`/${kpiDefinition.entitySet}`, undefined, undefined, undefined, {
        $$groupId: "$auto.LongRunners"
      });
      const oAggregate = {};

      // Main value + currency/unit
      if ((_kpiDefinition$datapo4 = kpiDefinition.datapoint.unit) !== null && _kpiDefinition$datapo4 !== void 0 && _kpiDefinition$datapo4.isPath) {
        oAggregate[kpiDefinition.datapoint.propertyPath] = {
          unit: kpiDefinition.datapoint.unit.value
        };
      } else {
        oAggregate[kpiDefinition.datapoint.propertyPath] = {};
      }

      // Property for criticality
      if (kpiDefinition.datapoint.criticalityPath) {
        oAggregate[kpiDefinition.datapoint.criticalityPath] = {};
      }

      // Properties for trend and trend calculation
      if (loadFull) {
        if (kpiDefinition.datapoint.trendPath) {
          oAggregate[kpiDefinition.datapoint.trendPath] = {};
        }
        if (kpiDefinition.datapoint.trendCalculationReferencePath) {
          oAggregate[kpiDefinition.datapoint.trendCalculationReferencePath] = {};
        }
        if (kpiDefinition.datapoint.targetPath) {
          oAggregate[kpiDefinition.datapoint.targetPath] = {};
        }
      }
      oListBinding.setAggregation({
        aggregate: oAggregate
      });

      // Manage SelectionVariant filters
      if ((_kpiDefinition$select2 = kpiDefinition.selectionVariantFilterDefinitions) !== null && _kpiDefinition$select2 !== void 0 && _kpiDefinition$select2.length) {
        const aFilters = kpiDefinition.selectionVariantFilterDefinitions.map(createFilterFromDefinition).filter(filter => {
          return filter !== undefined;
        });
        oListBinding.filter(aFilters);
      }
      return oListBinding.requestContexts(0, 1).then(aContexts => {
        if (aContexts.length) {
          var _kpiDefinition$datapo5, _kpiDefinition$datapo6;
          const rawUnit = (_kpiDefinition$datapo5 = kpiDefinition.datapoint.unit) !== null && _kpiDefinition$datapo5 !== void 0 && _kpiDefinition$datapo5.isPath ? aContexts[0].getProperty(kpiDefinition.datapoint.unit.value) : (_kpiDefinition$datapo6 = kpiDefinition.datapoint.unit) === null || _kpiDefinition$datapo6 === void 0 ? void 0 : _kpiDefinition$datapo6.value;
          if (kpiDefinition.datapoint.unit && !rawUnit) {
            // A unit/currency is defined, but its value is undefined --> multi-unit situation
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValue`, "*");
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValueUnscaled`, "*");
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValueNoScale`, "*");
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainValueScale`, "");
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainUnit`, undefined);
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainCriticality`, MessageType.None);
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/mainState`, "None");
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/trend`, "None");
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/targetNumber`, undefined);
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/targetUnit`, undefined);
            oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/deviationNumber`, undefined);
          } else {
            this.updateDatapointValueAndCurrency(kpiDefinition, aContexts[0], oKPIModel);
            this.updateDatapointCriticality(kpiDefinition, aContexts[0], oKPIModel);
            if (loadFull) {
              this.updateDatapointTrend(kpiDefinition, aContexts[0], oKPIModel);
              this.updateTargetValue(kpiDefinition, aContexts[0], oKPIModel);
            }
          }
        }
      });
    }

    /**
     * Loads card data for a KPI, and stores it in the JSON KPI model.
     *
     * @param kpiDefinition The definition of the KPI.
     * @param oMainModel The model used to load the data.
     * @param oKPIModel The JSON model where the data will be stored
     * @returns The promise that is resolved when data is loaded.
     */;
    _proto.loadKPICardData = function loadKPICardData(kpiDefinition, oMainModel, oKPIModel) {
      var _kpiDefinition$select3;
      const oListBinding = oMainModel.bindList(`/${kpiDefinition.entitySet}`, undefined, undefined, undefined, {
        $$groupId: "$auto.Workers"
      });
      const oGroup = {};
      const oAggregate = {};
      kpiDefinition.chart.dimensions.forEach(dimension => {
        oGroup[dimension.name] = {};
      });
      kpiDefinition.chart.measures.forEach(measure => {
        oAggregate[measure.name] = {};
      });
      oListBinding.setAggregation({
        group: oGroup,
        aggregate: oAggregate
      });

      // Manage SelectionVariant filters
      if ((_kpiDefinition$select3 = kpiDefinition.selectionVariantFilterDefinitions) !== null && _kpiDefinition$select3 !== void 0 && _kpiDefinition$select3.length) {
        const aFilters = kpiDefinition.selectionVariantFilterDefinitions.map(createFilterFromDefinition).filter(filter => {
          return filter !== undefined;
        });
        oListBinding.filter(aFilters);
      }

      // Sorting
      if (kpiDefinition.chart.sortOrder) {
        oListBinding.sort(kpiDefinition.chart.sortOrder.map(sortInfo => {
          return new Sorter(sortInfo.name, sortInfo.descending);
        }));
      }
      return oListBinding.requestContexts(0, kpiDefinition.chart.maxItems).then(aContexts => {
        const chartData = aContexts.map(function (oContext) {
          const oData = {};
          kpiDefinition.chart.dimensions.forEach(dimension => {
            oData[dimension.name] = oContext.getProperty(dimension.name);
          });
          kpiDefinition.chart.measures.forEach(measure => {
            oData[measure.name] = oContext.getProperty(measure.name);
          });
          return oData;
        });
        oKPIModel.setProperty(`/${kpiDefinition.id}/manifest/sap.card/data/json/chartData`, chartData);
      });
    }

    /**
     * Gets the popover to display the KPI card
     * The popover and the contained card for the KPIs are created if necessary.
     * The popover is shared between all KPIs, so it's created only once.
     *
     * @param oKPITag The tag that triggered the popover opening.
     * @returns The shared popover as a promise.
     */;
    _proto.getPopover = function getPopover(oKPITag) {
      if (!this.oPopover) {
        return new Promise((resolve, reject) => {
          Core.loadLibrary("sap/ui/integration", {
            async: true
          }).then(() => {
            sap.ui.require(["sap/ui/integration/widgets/Card", "sap/ui/integration/Host"], (Card, Host) => {
              const oHost = new Host();
              oHost.attachAction(oEvent => {
                const sType = oEvent.getParameter("type");
                const oParams = oEvent.getParameter("parameters");
                if (sType === "Navigation") {
                  if (oParams.semanticObject) {
                    this.getView().getController()._intentBasedNavigation.navigate(oParams.semanticObject, oParams.action);
                  } else {
                    this.getView().getController()._intentBasedNavigation.navigateOutbound(oParams.outbound);
                  }
                }
              });
              this.oCard = new Card({
                width: "25rem",
                height: "auto"
              });
              this.oCard.setHost(oHost);
              this.oPopover = new Popover("kpi-Popover", {
                showHeader: false,
                placement: "Auto",
                content: [this.oCard]
              });
              oKPITag.addDependent(this.oPopover); // The first clicked tag gets the popover as dependent

              resolve(this.oPopover);
            });
          }).catch(function () {
            reject();
          });
        });
      } else {
        return Promise.resolve(this.oPopover);
      }
    };
    _proto.onKPIPressed = function onKPIPressed(oKPITag, kpiID) {
      const oKPIModel = oKPITag.getModel("kpiModel");
      if (this.aKPIDefinitions && this.aKPIDefinitions.length) {
        const kpiDefinition = this.aKPIDefinitions.find(function (oDef) {
          return oDef.id === kpiID;
        });
        if (kpiDefinition) {
          const oModel = oKPITag.getModel();
          const aPromises = [this.loadKPITagData(kpiDefinition, oModel, oKPIModel, true), this.loadKPICardData(kpiDefinition, oModel, oKPIModel), this.getPopover(oKPITag)];
          Promise.all(aPromises).then(aResults => {
            this.oCard.setManifest(oKPIModel.getProperty(`/${kpiID}/manifest`));
            this.oCard.refresh();
            const oPopover = aResults[2];
            oPopover.openBy(oKPITag, false);
          }).catch(err => {
            Log.error(err);
          });
        }
      }
    };
    return KPIManagementControllerExtension;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onExit", [_dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "onExit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onKPIPressed", [_dec4], Object.getOwnPropertyDescriptor(_class2.prototype, "onKPIPressed"), _class2.prototype)), _class2)) || _class);
  return KPIManagementControllerExtension;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/KPIManagement", ["sap/base/Log","sap/fe/core/formatters/TableFormatterTypes","sap/m/Popover","sap/ui/core/Core","sap/ui/core/format/DateFormat","sap/ui/core/format/NumberFormat","sap/ui/core/Locale","sap/ui/core/mvc/ControllerExtension","sap/ui/model/Filter","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","../helpers/ClassSupport"],function(e,t,a,n,i,r,o,s,l,d,u,c){"use strict";var p,f,g,m,h,y;var P=c.publicExtension;var b=c.methodOverride;var v=c.defineUI5Class;var D=t.MessageType;function C(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;I(e,t)}function I(e,t){I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,a){t.__proto__=a;return t};return I(e,t)}function N(e,t,a,n,i){var r={};Object.keys(n).forEach(function(e){r[e]=n[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=a.slice().reverse().reduce(function(a,n){return n(e,t,a)||a},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}const $={1:D.Error,2:D.Warning,3:D.Success,5:D.Information};const T={Error:"Error",Warning:"Critical",Success:"Good",Information:"None",None:"None"};function S(e,t){let a;if(t[0]!==undefined&&t[0]!==null&&e<t[0]){a=D.Error}else if(t[1]!==undefined&&t[1]!==null&&e<t[1]){a=D.Warning}else if(t[2]!==undefined&&t[2]!==null&&e<t[2]){a=D.None}else if(t[5]!==undefined&&t[5]!==null&&e>t[5]){a=D.Error}else if(t[4]!==undefined&&t[4]!==null&&e>t[4]){a=D.Warning}else if(t[3]!==undefined&&t[3]!==null&&e>t[3]){a=D.None}else{a=D.Success}return a}function j(e,t){let a;if(t[2]!==undefined&&t[2]!==null&&e>t[2]){a=D.Error}else if(t[1]!==undefined&&t[1]!==null&&e>t[1]){a=D.Warning}else if(t[0]!==undefined&&t[0]!==null&&e>t[0]){a=D.None}else{a=D.Success}return a}function w(e,t){let a;if(t[0]!==undefined&&t[0]!==null&&e<t[0]){a=D.Error}else if(t[1]!==undefined&&t[1]!==null&&e<t[1]){a=D.Warning}else if(t[2]!==undefined&&t[2]!==null&&e<t[2]){a=D.None}else{a=D.Success}return a}function x(e){let t;switch(e){case 1:case"1":case 2:case"2":t="Up";break;case 4:case"4":case 5:case"5":t="Down";break;default:t="None"}return t}function A(e,t,a,n){let i;if(!n||a&&!t){return"None"}const r=a?(e-t)/t:e-t;if(n[0]!==undefined&&n[0]!==null&&r<=n[0]){i="Down"}else if(n[1]!==undefined&&n[1]!==null&&r<=n[1]){i="Down"}else if(n[3]!==undefined&&n[3]!==null&&r>=n[3]){i="Up"}else if(n[2]!==undefined&&n[2]!==null&&r>=n[2]){i="Up"}else{i="None"}return i}function F(e){if(e.ranges.length===0){return undefined}else if(e.ranges.length===1){return new l(e.propertyPath,e.ranges[0].operator,e.ranges[0].rangeLow,e.ranges[0].rangeHigh)}else{const t=e.ranges.map(t=>new l(e.propertyPath,t.operator,t.rangeLow,t.rangeHigh));return new l({filters:t,and:false})}}function V(e){const t=new o(sap.ui.getCore().getConfiguration().getLanguage());const a=n.getLibraryResourceBundle("sap.fe.core");const r=i.getDateInstance({style:"medium"},t);function s(t){const n=e.propertyType.indexOf("Edm.Date")===0?r.format(new Date(t.rangeLow)):t.rangeLow;const i=e.propertyType.indexOf("Edm.Date")===0?r.format(new Date(t.rangeHigh)):t.rangeHigh;switch(t.operator){case"BT":return`[${n} - ${i}]`;case"Contains":return`*${n}*`;case"GE":return`${n}`;case"GT":return`>${n}`;case"LE":return`${n}`;case"LT":return`<${n}`;case"NB":return a.getText("C_KPICARD_FILTERSTRING_NOT",[`[${n} - ${i}]`]);case"NE":return`${n}`;case"NotContains":return a.getText("C_KPICARD_FILTERSTRING_NOT",[`*${n}*`]);case"EQ":default:return n}}if(e.ranges.length===0){return""}else if(e.ranges.length===1){return s(e.ranges[0])}else{return`(${e.ranges.map(s).join(",")})`}}function O(e){const t=n.getLibraryResourceBundle("sap.fe.core");function a(e){if(e.length===0){return""}else if(e.length===1){return e[0].label}else{let a=e[0].label;for(let t=1;t<e.length-1;t++){a+=`, ${e[t].label}`}return t.getText("C_KPICARD_ITEMSLIST",[a,e[e.length-1].label])}}return t.getText("C_KPICARD_CHARTTITLE",[a(e.chart.measures),a(e.chart.dimensions)])}function E(e,t){switch(e.chartType){case"Donut":t.categoryAxis={title:{visible:false}};t.valueAxis={title:{visible:false},label:{formatString:"ShortFloat"}};t.plotArea.dataLabel={visible:true,type:"value",formatString:"ShortFloat_MFD2"};break;case"bubble":t.valueAxis={title:{visible:true},label:{formatString:"ShortFloat"}};t.valueAxis2={title:{visible:true},label:{formatString:"ShortFloat"}};t.legendGroup={layout:{position:"bottom",alignment:"topLeft"}};t.sizeLegend={visible:true};t.plotArea.dataLabel={visible:false};break;case"scatter":t.valueAxis={title:{visible:false},label:{formatString:"ShortFloat"}};t.valueAxis2={title:{visible:false},label:{formatString:"ShortFloat"}};t.plotArea.dataLabel={visible:false};break;default:t.categoryAxis={title:{visible:false}};t.valueAxis={title:{visible:false},label:{formatString:"ShortFloat"}};t.plotArea.dataLabel={visible:false}}}function L(e,t){if(t&&t.length){return e.filter(e=>t.indexOf(e.role)>=0).map(e=>e.label)}else{return e.map(e=>e.label)}}function M(e){const t=L(e.measures,["Axis1"]);const a=L(e.measures,["Axis2"]);const n=L(e.measures,["Axis3"]);const i=L(e.measures,[undefined]);const r=L(e.dimensions,["Series"]);const o=e.dimensions.find(e=>e.role==="Category");const s=t.shift()||a.shift()||n.shift()||i.shift()||"";const l=a.shift()||t.shift()||n.shift()||i.shift()||"";const d=[{uid:"valueAxis",type:"Measure",values:[s]},{uid:"valueAxis2",type:"Measure",values:[l]}];if(e.chartType==="bubble"){const e=n.shift()||t.shift()||a.shift()||i.shift()||"";d.push({uid:"bubbleWidth",type:"Measure",values:[e]})}if(r.length){d.push({uid:"color",type:"Dimension",values:r})}if(o){d.push({uid:"shape",type:"Dimension",values:[o.label]})}return d}function R(e){let t;switch(e.chartType){case"Donut":t=[{uid:"size",type:"Measure",values:L(e.measures)},{uid:"color",type:"Dimension",values:L(e.dimensions)}];break;case"bubble":case"scatter":t=M(e);break;case"vertical_bullet":t=[{uid:"actualValues",type:"Measure",values:L(e.measures,[undefined,"Axis1"])},{uid:"targetValues",type:"Measure",values:L(e.measures,["Axis2"])},{uid:"categoryAxis",type:"Dimension",values:L(e.dimensions,[undefined,"Category"])},{uid:"color",type:"Dimension",values:L(e.dimensions,["Series"])}];break;default:t=[{uid:"valueAxis",type:"Measure",values:L(e.measures)},{uid:"categoryAxis",type:"Dimension",values:L(e.dimensions,[undefined,"Category"])},{uid:"color",type:"Dimension",values:L(e.dimensions,["Series"])}]}return t}function _(e,t){if(e.semanticObject){if(e.action){return t.getLinks({semanticObject:e.semanticObject,action:e.action}).then(t=>t.length?{semanticObject:e.semanticObject,action:e.action}:undefined)}else{return t.getPrimaryIntent(e.semanticObject).then(a=>{if(!a){return undefined}const n=t.parseShellHash(a.intent);return e.unavailableActions&&e.unavailableActions.indexOf(n.action)>=0?undefined:{semanticObject:n.semanticObject,action:n.action}})}}else{return e.outboundNavigation?Promise.resolve({outbound:e.outboundNavigation}):Promise.resolve(undefined)}}let K=(p=v("sap.fe.core.controllerextensions.KPIManagement"),f=b(),g=b(),m=P(),p(h=(y=function(t){C(i,t);function i(){return t.apply(this,arguments)||this}var s=i.prototype;s.initCardManifest=function e(t,a){var i;const r={"sap.app":{id:"sap.fe",type:"card"},"sap.ui":{technology:"UI5"},"sap.card":{type:"Analytical",data:{json:{}},header:{type:"Numeric",title:t.datapoint.title,subTitle:t.datapoint.description,unitOfMeasurement:"{mainUnit}",mainIndicator:{number:"{mainValueNoScale}",unit:"{mainValueScale}",state:"{mainState}",trend:"{trend}"}},content:{minHeight:"25rem",chartProperties:{plotArea:{},title:{visible:true,alignment:"left"}},data:{path:"/chartData"}}}};if(t.datapoint.targetPath||t.datapoint.targetValue!==undefined){const e=n.getLibraryResourceBundle("sap.fe.core");r["sap.card"].header.sideIndicators=[{title:e.getText("C_KPICARD_INDICATOR_TARGET"),number:"{targetNumber}",unit:"{targetUnit}"},{title:e.getText("C_KPICARD_INDICATOR_DEVIATION"),number:"{deviationNumber}",unit:"%"}]}if((i=t.selectionVariantFilterDefinitions)!==null&&i!==void 0&&i.length){const e=[];t.selectionVariantFilterDefinitions.forEach(t=>{const a=V(t);if(a){e.push(a)}});if(e.length){r["sap.card"].header.details=e.join(", ")}}r["sap.card"].content.chartType=t.chart.chartType;E(t.chart,r["sap.card"].content.chartProperties);r["sap.card"].content.chartProperties.title.text=O(t);r["sap.card"].content.dimensions=t.chart.dimensions.map(e=>({label:e.label,value:`{${e.name}}`}));r["sap.card"].content.measures=t.chart.measures.map(e=>({label:e.label,value:`{${e.name}}`}));r["sap.card"].content.feeds=R(t.chart);a.setProperty(`/${t.id}`,{manifest:r})};s.initNavigationInfo=function e(t,a,n){if(t.navigation){return _(t.navigation,n).then(e=>{if(e){a.setProperty(`/${t.id}/manifest/sap.card/header/actions`,[{type:"Navigation",parameters:e}])}})}else{return Promise.resolve()}};s.onInit=function t(){var a;this.aKPIDefinitions=(a=this.getView().getController()._getPageModel())===null||a===void 0?void 0:a.getProperty("/kpiDefinitions");if(this.aKPIDefinitions&&this.aKPIDefinitions.length){const t=this.getView();const a=t.getController().getAppComponent();const n=new d;t.setModel(n,"kpiModel");this.aKPIDefinitions.forEach(t=>{this.initCardManifest(t,n);this.initNavigationInfo(t,n,a.getShellServices()).catch(function(t){e.error(t)});this.loadKPITagData(t,a.getModel(),n).catch(function(t){e.error(t)})})}};s.onExit=function e(){const t=this.getView().getModel("kpiModel");if(t){t.destroy()}};s.updateDatapointValueAndCurrency=function e(t,a,n){var i,s,l;const d=new o(sap.ui.getCore().getConfiguration().getLanguage());const u=(i=t.datapoint.unit)!==null&&i!==void 0&&i.isPath?a.getProperty(t.datapoint.unit.value):(s=t.datapoint.unit)===null||s===void 0?void 0:s.value;const c=((l=t.datapoint.unit)===null||l===void 0?void 0:l.isCurrency)===false&&u==="%";const p=Number.parseFloat(a.getProperty(t.datapoint.propertyPath));const f=r.getFloatInstance({style:c?undefined:"short",minFractionDigits:0,maxFractionDigits:1,showScale:!c},d).format(p);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValue`,f);const g=r.getFloatInstance({maxFractionDigits:2,showScale:false,groupingEnabled:true},d).format(p);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValueUnscaled`,g);const m=r.getFloatInstance({style:c?undefined:"short",minFractionDigits:0,maxFractionDigits:1,showScale:false},d).format(p);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValueNoScale`,m);const h=r.getFloatInstance({style:c?undefined:"short",decimals:0,maxIntegerDigits:0,showScale:true},d).format(p);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValueScale`,h);if(t.datapoint.unit&&u){if(t.datapoint.unit.isCurrency){n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainUnit`,u)}else{const e=r.getUnitInstance({showNumber:false},d).format(p,u);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainUnit`,e)}}};s.updateDatapointCriticality=function e(t,a,n){const i=Number.parseFloat(a.getProperty(t.datapoint.propertyPath));let r=D.None;if(t.datapoint.criticalityValue){r=t.datapoint.criticalityValue}else if(t.datapoint.criticalityPath){r=$[a.getProperty(t.datapoint.criticalityPath)]||D.None}else if(t.datapoint.criticalityCalculationThresholds&&t.datapoint.criticalityCalculationMode){switch(t.datapoint.criticalityCalculationMode){case"UI.ImprovementDirectionType/Target":r=S(i,t.datapoint.criticalityCalculationThresholds);break;case"UI.ImprovementDirectionType/Minimize":r=j(i,t.datapoint.criticalityCalculationThresholds);break;case"UI.ImprovementDirectionType/Maximize":default:r=w(i,t.datapoint.criticalityCalculationThresholds);break}}n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainCriticality`,r);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainState`,T[r]||"None")};s.updateDatapointTrend=function e(t,a,n){const i=Number.parseFloat(a.getProperty(t.datapoint.propertyPath));let r="None";if(t.datapoint.trendValue){r=t.datapoint.trendValue}else if(t.datapoint.trendPath){r=x(a.getProperty(t.datapoint.trendPath))}else if(t.datapoint.trendCalculationReferenceValue!==undefined||t.datapoint.trendCalculationReferencePath){let e;if(t.datapoint.trendCalculationReferenceValue!==undefined){e=t.datapoint.trendCalculationReferenceValue}else{e=Number.parseFloat(a.getProperty(t.datapoint.trendCalculationReferencePath||""))}r=A(i,e,!!t.datapoint.trendCalculationIsRelative,t.datapoint.trendCalculationTresholds)}n.setProperty(`/${t.id}/manifest/sap.card/data/json/trend`,r)};s.updateTargetValue=function e(t,a,n){if(t.datapoint.targetValue===undefined&&t.datapoint.targetPath===undefined){return}const i=Number.parseFloat(a.getProperty(t.datapoint.propertyPath));const s=new o(sap.ui.getCore().getConfiguration().getLanguage());let l;if(t.datapoint.targetValue!==undefined){l=t.datapoint.targetValue}else{l=Number.parseFloat(a.getProperty(t.datapoint.targetPath||""))}const d=l!==0?(i-l)/l*100:undefined;const u=r.getFloatInstance({style:"short",minFractionDigits:0,maxFractionDigits:1,showScale:false},s).format(l);const c=r.getFloatInstance({style:"short",decimals:0,maxIntegerDigits:0,showScale:true},s).format(l);n.setProperty(`/${t.id}/manifest/sap.card/data/json/targetNumber`,u);n.setProperty(`/${t.id}/manifest/sap.card/data/json/targetUnit`,c);if(d!==undefined){const e=r.getFloatInstance({minFractionDigits:0,maxFractionDigits:1,showScale:false},s).format(d);n.setProperty(`/${t.id}/manifest/sap.card/data/json/deviationNumber`,e)}else{n.setProperty(`/${t.id}/manifest/sap.card/data/json/deviationNumber`,"N/A")}};s.loadKPITagData=function e(t,a,n,i){var r,o;const s=i?a.bindList(`/${t.entitySet}`,undefined,undefined,undefined,{$$groupId:"$auto.Workers"}):a.bindList(`/${t.entitySet}`,undefined,undefined,undefined,{$$groupId:"$auto.LongRunners"});const l={};if((r=t.datapoint.unit)!==null&&r!==void 0&&r.isPath){l[t.datapoint.propertyPath]={unit:t.datapoint.unit.value}}else{l[t.datapoint.propertyPath]={}}if(t.datapoint.criticalityPath){l[t.datapoint.criticalityPath]={}}if(i){if(t.datapoint.trendPath){l[t.datapoint.trendPath]={}}if(t.datapoint.trendCalculationReferencePath){l[t.datapoint.trendCalculationReferencePath]={}}if(t.datapoint.targetPath){l[t.datapoint.targetPath]={}}}s.setAggregation({aggregate:l});if((o=t.selectionVariantFilterDefinitions)!==null&&o!==void 0&&o.length){const e=t.selectionVariantFilterDefinitions.map(F).filter(e=>e!==undefined);s.filter(e)}return s.requestContexts(0,1).then(e=>{if(e.length){var a,r;const o=(a=t.datapoint.unit)!==null&&a!==void 0&&a.isPath?e[0].getProperty(t.datapoint.unit.value):(r=t.datapoint.unit)===null||r===void 0?void 0:r.value;if(t.datapoint.unit&&!o){n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValue`,"*");n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValueUnscaled`,"*");n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValueNoScale`,"*");n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainValueScale`,"");n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainUnit`,undefined);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainCriticality`,D.None);n.setProperty(`/${t.id}/manifest/sap.card/data/json/mainState`,"None");n.setProperty(`/${t.id}/manifest/sap.card/data/json/trend`,"None");n.setProperty(`/${t.id}/manifest/sap.card/data/json/targetNumber`,undefined);n.setProperty(`/${t.id}/manifest/sap.card/data/json/targetUnit`,undefined);n.setProperty(`/${t.id}/manifest/sap.card/data/json/deviationNumber`,undefined)}else{this.updateDatapointValueAndCurrency(t,e[0],n);this.updateDatapointCriticality(t,e[0],n);if(i){this.updateDatapointTrend(t,e[0],n);this.updateTargetValue(t,e[0],n)}}}})};s.loadKPICardData=function e(t,a,n){var i;const r=a.bindList(`/${t.entitySet}`,undefined,undefined,undefined,{$$groupId:"$auto.Workers"});const o={};const s={};t.chart.dimensions.forEach(e=>{o[e.name]={}});t.chart.measures.forEach(e=>{s[e.name]={}});r.setAggregation({group:o,aggregate:s});if((i=t.selectionVariantFilterDefinitions)!==null&&i!==void 0&&i.length){const e=t.selectionVariantFilterDefinitions.map(F).filter(e=>e!==undefined);r.filter(e)}if(t.chart.sortOrder){r.sort(t.chart.sortOrder.map(e=>new u(e.name,e.descending)))}return r.requestContexts(0,t.chart.maxItems).then(e=>{const a=e.map(function(e){const a={};t.chart.dimensions.forEach(t=>{a[t.name]=e.getProperty(t.name)});t.chart.measures.forEach(t=>{a[t.name]=e.getProperty(t.name)});return a});n.setProperty(`/${t.id}/manifest/sap.card/data/json/chartData`,a)})};s.getPopover=function e(t){if(!this.oPopover){return new Promise((e,i)=>{n.loadLibrary("sap/ui/integration",{async:true}).then(()=>{sap.ui.require(["sap/ui/integration/widgets/Card","sap/ui/integration/Host"],(n,i)=>{const r=new i;r.attachAction(e=>{const t=e.getParameter("type");const a=e.getParameter("parameters");if(t==="Navigation"){if(a.semanticObject){this.getView().getController()._intentBasedNavigation.navigate(a.semanticObject,a.action)}else{this.getView().getController()._intentBasedNavigation.navigateOutbound(a.outbound)}}});this.oCard=new n({width:"25rem",height:"auto"});this.oCard.setHost(r);this.oPopover=new a("kpi-Popover",{showHeader:false,placement:"Auto",content:[this.oCard]});t.addDependent(this.oPopover);e(this.oPopover)})}).catch(function(){i()})})}else{return Promise.resolve(this.oPopover)}};s.onKPIPressed=function t(a,n){const i=a.getModel("kpiModel");if(this.aKPIDefinitions&&this.aKPIDefinitions.length){const t=this.aKPIDefinitions.find(function(e){return e.id===n});if(t){const r=a.getModel();const o=[this.loadKPITagData(t,r,i,true),this.loadKPICardData(t,r,i),this.getPopover(a)];Promise.all(o).then(e=>{this.oCard.setManifest(i.getProperty(`/${n}/manifest`));this.oCard.refresh();const t=e[2];t.openBy(a,false)}).catch(t=>{e.error(t)})}}};return i}(s),N(y.prototype,"onInit",[f],Object.getOwnPropertyDescriptor(y.prototype,"onInit"),y.prototype),N(y.prototype,"onExit",[g],Object.getOwnPropertyDescriptor(y.prototype,"onExit"),y.prototype),N(y.prototype,"onKPIPressed",[m],Object.getOwnPropertyDescriptor(y.prototype,"onKPIPressed"),y.prototype),y))||h);return K},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/MassEdit-dbg", ["sap/base/Log", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/MassEditHelper", "sap/fe/core/helpers/ModelHelper", "sap/m/MessageBox", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "../CommonUtils"], function (Log, ClassSupport, MassEditHelper, ModelHelper, MessageBox, ControllerExtension, OverrideExecution, CommonUtils) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var privateExtension = ClassSupport.privateExtension;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * @class Controller extension providing hooks for the mass edit in a table
   * @name sap.fe.core.controllerextensions.MassEdit
   * @hideconstructor
   * @private
   */
  let MassEdit = (_dec = defineUI5Class("sap.fe.core.controllerextensions.MassEdit"), _dec2 = publicExtension(), _dec3 = finalExtension(), _dec4 = publicExtension(), _dec5 = finalExtension(), _dec6 = privateExtension(), _dec7 = extensible(OverrideExecution.After), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(MassEdit, _ControllerExtension);
    function MassEdit() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = MassEdit.prototype;
    _proto.getMessageDetailForNonEditable = function getMessageDetailForNonEditable(oResourceBundle, typeName, typeNamePlural) {
      const sHeader = oResourceBundle.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_HEADER"),
        sReasonGroup = oResourceBundle.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON", [typeNamePlural]),
        sReasonDraft = oResourceBundle.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_DRAFT", [typeName]),
        sReasonNonEditable = oResourceBundle.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_NON_EDITABLE", [typeName]);
      return `<p><strong>${sHeader}</strong></p>\n` + (!!sReasonGroup && `<p>${sReasonGroup}</p>\n` + `<ul>` + (!!sReasonDraft && `<li>${sReasonDraft}</li>`) + (!!sReasonNonEditable && `<li>${sReasonNonEditable}</li>`) + `</ul>`);
    };
    _proto.getResourceText = function getResourceText(exp, control) {
      const resolvedText = exp && CommonUtils.getTranslatedTextFromExpBindingString(exp, control);
      return resolvedText && resolvedText.toLocaleLowerCase();
    };
    _proto._openConfirmDialog = function _openConfirmDialog(oTable, aContexts, iSelectedContexts) {
      const iUpdatableContexts = (aContexts || []).length;
      const view = this.getView();
      return new Promise(resolve => {
        view.getModel("sap.fe.i18n").getResourceBundle().then(oResourceBundle => {
          const sEditButton = oResourceBundle.getText("C_MASS_EDIT_CONFIRM_BUTTON_TEXT"),
            sCancelButton = oResourceBundle.getText("C_COMMON_OBJECT_PAGE_CANCEL"),
            iNonEditable = iSelectedContexts - iUpdatableContexts,
            entityTypePath = oTable.data("entityType"),
            metaModel = oTable.getModel().getMetaModel(),
            headerInfoAnno = metaModel.getObject(`${entityTypePath}@com.sap.vocabularies.UI.v1.HeaderInfo`),
            typeName = this.getResourceText(headerInfoAnno.TypeName, view) || oResourceBundle.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME"),
            typeNamePlural = this.getResourceText(headerInfoAnno.TypeNamePlural, view) || oResourceBundle.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME_PLURAL"),
            sMessage = oResourceBundle.getText("C_MASS_EDIT_CONFIRM_MESSAGE", [iNonEditable, iSelectedContexts, iUpdatableContexts, typeNamePlural]),
            sPath = oTable.data("targetCollectionPath"),
            oMetaModel = oTable.getModel().getMetaModel(),
            bIsDraft = ModelHelper.isDraftSupported(oMetaModel, sPath),
            bDisplayMode = oTable.data("displayModePropertyBinding") === "true",
            sMessageDetail = bIsDraft && bDisplayMode && this.getMessageDetailForNonEditable(oResourceBundle, typeName, typeNamePlural);
          MessageBox.warning(sMessage, {
            details: sMessageDetail,
            actions: [sEditButton, sCancelButton],
            emphasizedAction: sEditButton,
            contentWidth: "100px",
            onClose: function (sSelection) {
              let aContextsForEdit = [];
              if (sSelection === sEditButton) {
                Log.info("Mass Edit: Confirmed to edit ", iUpdatableContexts.toString(), " selections.");
                aContextsForEdit = aContexts;
              } else if (sSelection === sCancelButton) {
                Log.info("Mass Edit: Cancelled.");
              }
              resolve(aContextsForEdit);
            }
          });
        }).catch(function (error) {
          Log.error(error);
        });
      });
    };
    _proto._confirmContexts = function _confirmContexts(oTable, aContexts) {
      const oInternalModelContext = oTable.getBindingContext("internal"),
        iSelectedContexts = +oInternalModelContext.getProperty("numberOfSelectedContexts") || 0;
      aContexts = aContexts || [];
      if (aContexts.length && aContexts.length !== iSelectedContexts) {
        return this._openConfirmDialog(oTable, aContexts, iSelectedContexts);
      }
      return Promise.resolve(aContexts);
    }

    /**
     * The following operations are performed by method openMassEditDialog:
     * => Opens the mass edit dialog.
     * => Implements the save and cancel functionality.
     * => Sets the runtime model to the dialog.
     * => Sets the static model's context to the dialog.
     *
     * @param oTable Instance of the table
     * @returns A promise that resolves on open of the mass edit dialog.
     * @private
     */;
    _proto.openMassEditDialog = function openMassEditDialog(oTable) {
      const oController = this.getView().getController(),
        pContextsForEdit = this.fetchContextsForEdit(oTable);
      return pContextsForEdit.then(this._confirmContexts.bind(this, oTable)).then(function (aContexts) {
        return aContexts && aContexts.length > 0 ? MassEditHelper.createDialog(oTable, aContexts, oController) : Promise.resolve();
      }).then(function (oDialog) {
        if (oDialog) {
          oTable.addDependent(oDialog);
          oDialog.open();
        }
      }).catch(function (oError) {
        Log.error("Mass Edit: Something went wrong in mass edit dialog creation.", oError);
      });
    }

    /**
     * Returns a promise that resolves to the contexts for mass edit.
     *
     * @function
     * @param oTable Table for mass edit.
     * @alias sap.fe.core.contrllerextensions.MassEdit#fetchContextsForEdit
     * @returns A promise to be resolved with an array of context(s) which should be considered for mass edit.
     * @private
     */;
    _proto.fetchContextsForEdit = function fetchContextsForEdit(oTable) {
      //To be overridden by the application
      const oInternalModelContext = oTable.getBindingContext("internal"),
        aSelectedContexts = oInternalModelContext.getProperty("updatableContexts") || [];
      return Promise.resolve(aSelectedContexts);
    };
    return MassEdit;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "getMessageDetailForNonEditable", [_dec2, _dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "getMessageDetailForNonEditable"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "openMassEditDialog", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "openMassEditDialog"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "fetchContextsForEdit", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "fetchContextsForEdit"), _class2.prototype)), _class2)) || _class);
  return MassEdit;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/MassEdit", ["sap/base/Log","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/MassEditHelper","sap/fe/core/helpers/ModelHelper","sap/m/MessageBox","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","../CommonUtils"],function(e,t,o,n,i,r,s,a){"use strict";var l,c,p,u,g,E,d,_,f;var M=t.publicExtension;var C=t.privateExtension;var T=t.finalExtension;var S=t.extensible;var A=t.defineUI5Class;function D(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;h(e,t)}function h(e,t){h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return h(e,t)}function x(e,t,o,n,i){var r={};Object.keys(n).forEach(function(e){r[e]=n[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}let O=(l=A("sap.fe.core.controllerextensions.MassEdit"),c=M(),p=T(),u=M(),g=T(),E=C(),d=S(s.After),l(_=(f=function(t){D(r,t);function r(){return t.apply(this,arguments)||this}var s=r.prototype;s.getMessageDetailForNonEditable=function e(t,o,n){const i=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_HEADER"),r=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON",[n]),s=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_DRAFT",[o]),a=t.getText("C_MASS_EDIT_CONFIRM_MESSAGE_DETAIL_REASON_NON_EDITABLE",[o]);return`<p><strong>${i}</strong></p>\n`+(!!r&&`<p>${r}</p>\n`+`<ul>`+(!!s&&`<li>${s}</li>`)+(!!a&&`<li>${a}</li>`)+`</ul>`)};s.getResourceText=function e(t,o){const n=t&&a.getTranslatedTextFromExpBindingString(t,o);return n&&n.toLocaleLowerCase()};s._openConfirmDialog=function t(o,r,s){const a=(r||[]).length;const l=this.getView();return new Promise(t=>{l.getModel("sap.fe.i18n").getResourceBundle().then(c=>{const p=c.getText("C_MASS_EDIT_CONFIRM_BUTTON_TEXT"),u=c.getText("C_COMMON_OBJECT_PAGE_CANCEL"),g=s-a,E=o.data("entityType"),d=o.getModel().getMetaModel(),_=d.getObject(`${E}@com.sap.vocabularies.UI.v1.HeaderInfo`),f=this.getResourceText(_.TypeName,l)||c.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME"),M=this.getResourceText(_.TypeNamePlural,l)||c.getText("C_MASS_EDIT_DIALOG_DEFAULT_TYPENAME_PLURAL"),C=c.getText("C_MASS_EDIT_CONFIRM_MESSAGE",[g,s,a,M]),T=o.data("targetCollectionPath"),S=o.getModel().getMetaModel(),A=n.isDraftSupported(S,T),D=o.data("displayModePropertyBinding")==="true",h=A&&D&&this.getMessageDetailForNonEditable(c,f,M);i.warning(C,{details:h,actions:[p,u],emphasizedAction:p,contentWidth:"100px",onClose:function(o){let n=[];if(o===p){e.info("Mass Edit: Confirmed to edit ",a.toString()," selections.");n=r}else if(o===u){e.info("Mass Edit: Cancelled.")}t(n)}})}).catch(function(t){e.error(t)})})};s._confirmContexts=function e(t,o){const n=t.getBindingContext("internal"),i=+n.getProperty("numberOfSelectedContexts")||0;o=o||[];if(o.length&&o.length!==i){return this._openConfirmDialog(t,o,i)}return Promise.resolve(o)};s.openMassEditDialog=function t(n){const i=this.getView().getController(),r=this.fetchContextsForEdit(n);return r.then(this._confirmContexts.bind(this,n)).then(function(e){return e&&e.length>0?o.createDialog(n,e,i):Promise.resolve()}).then(function(e){if(e){n.addDependent(e);e.open()}}).catch(function(t){e.error("Mass Edit: Something went wrong in mass edit dialog creation.",t)})};s.fetchContextsForEdit=function e(t){const o=t.getBindingContext("internal"),n=o.getProperty("updatableContexts")||[];return Promise.resolve(n)};return r}(r),x(f.prototype,"getMessageDetailForNonEditable",[c,p],Object.getOwnPropertyDescriptor(f.prototype,"getMessageDetailForNonEditable"),f.prototype),x(f.prototype,"openMassEditDialog",[u,g],Object.getOwnPropertyDescriptor(f.prototype,"openMassEditDialog"),f.prototype),x(f.prototype,"fetchContextsForEdit",[E,d],Object.getOwnPropertyDescriptor(f.prototype,"fetchContextsForEdit"),f.prototype),f))||_);return O},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/MessageHandler-dbg", ["sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/messageHandler/messageHandling", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/Core", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution"], function (CommonUtils, messageHandling, ClassSupport, Core, ControllerExtension, OverrideExecution) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var privateExtension = ClassSupport.privateExtension;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * A controller extension offering message handling.
   *
   * @hideconstructor
   * @public
   * @experimental As of version 1.90.0
   * @since 1.90.0
   */
  let MessageHandler = (_dec = defineUI5Class("sap.fe.core.controllerextensions.MessageHandler"), _dec2 = privateExtension(), _dec3 = extensible(OverrideExecution.Instead), _dec4 = publicExtension(), _dec5 = finalExtension(), _dec6 = publicExtension(), _dec7 = publicExtension(), _dec8 = finalExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(MessageHandler, _ControllerExtension);
    function MessageHandler() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = MessageHandler.prototype;
    /**
     * Determines whether or not bound messages are shown in the message dialog.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.Instead}.
     *
     * If the bound messages are shown to the user with a different control like the (TODO:Link) MessageButton
     * this method has to be overridden.
     *
     * @returns Determines whether or not bound messages are shown in the message dialog.
     * @private
     */
    _proto.getShowBoundMessagesInMessageDialog = function getShowBoundMessagesInMessageDialog() {
      return true;
    }

    /**
     * Shows a message dialog with transition messages if there are any.
     * The message dialog is shown as a modal dialog. Once the user confirms the dialog, all transition messages
     * are removed from the message model. If there is more than one message, a list of messages is shown. The user
     * can filter on message types and can display details as well as the long text. If there is one message,
     * the dialog immediately shows the details of the message. If there is just one success message, a message
     * toast is shown instead.
     *
     * @param mParameters PRIVATE
     * @returns A promise that is resolved once the user closes the dialog. If there are no messages
     * to be shown, the promise is resolved immediately
     * @alias sap.fe.core.controllerextensions.MessageHandler#showMessageDialog
     * @public
     * @experimental As of version 1.90.0
     * @since 1.90.0
     */;
    _proto.showMessageDialog = function showMessageDialog(mParameters) {
      const customMessages = mParameters && mParameters.customMessages ? mParameters.customMessages : undefined,
        oOPInternalBindingContext = this.base.getView().getBindingContext("internal");
      const viewType = this.base.getView().getViewData().converterType;
      // set isActionParameterDialog open so that it can be used in the controller extension to decide whether message dialog should open or not
      if (mParameters && mParameters.isActionParameterDialogOpen && oOPInternalBindingContext) {
        oOPInternalBindingContext.setProperty("isActionParameterDialogOpen", true);
      }
      const bShowBoundMessages = this.getShowBoundMessagesInMessageDialog();
      const oBindingContext = mParameters && mParameters.context ? mParameters.context : this.getView().getBindingContext();
      //const bEtagMessage = mParameters && mParameters.bHasEtagMessage;
      // reset  isActionParameterDialogOpen
      // cannot do this operations.js since it is not aware of the view
      if (oOPInternalBindingContext) {
        oOPInternalBindingContext.setProperty("isActionParameterDialogOpen", false);
      }
      return new Promise(function (resolve, reject) {
        // we have to set a timeout to be able to access the most recent messages
        setTimeout(function () {
          // TODO: great API - will be changed later
          messageHandling.showUnboundMessages(customMessages, oBindingContext, bShowBoundMessages, mParameters === null || mParameters === void 0 ? void 0 : mParameters.concurrentEditFlag, mParameters === null || mParameters === void 0 ? void 0 : mParameters.control, mParameters === null || mParameters === void 0 ? void 0 : mParameters.sActionName, undefined, mParameters === null || mParameters === void 0 ? void 0 : mParameters.onBeforeShowMessage, viewType).then(resolve).catch(reject);
        }, 0);
      });
    }

    /**
     * You can remove the existing transition message from the message model with this method.
     * With every user interaction that causes server communication (like clicking on an action, changing data),
     * this method removes the existing transition messages from the message model.
     *
     * @param [keepBoundMessage] Checks if the bound transition messages are not to be removed
     * @param keepUnboundMessage
     * @param sPathToBeRemoved
     * @alias sap.fe.core.controllerextensions.MessageHandler#removesTransitionMessages
     * @private
     */;
    _proto.removeTransitionMessages = function removeTransitionMessages(keepBoundMessage, keepUnboundMessage, sPathToBeRemoved) {
      if (!keepBoundMessage) {
        messageHandling.removeBoundTransitionMessages(sPathToBeRemoved);
      }
      if (!keepUnboundMessage) {
        messageHandling.removeUnboundTransitionMessages();
      }
    }

    /**
     * Method that returns all the parameters needed to handle the navigation to the error page.
     *
     * @param mParameters
     * @returns The parameters necessary for the navigation to the error page
     * @alias sap.fe.core.controllerextensions.MessageHandler#_checkNavigationToErrorPage
     * @private
     */;
    _proto._checkNavigationToErrorPage = function _checkNavigationToErrorPage(mParameters) {
      const aUnboundMessages = messageHandling.getMessages();
      const bShowBoundTransitionMessages = this.getShowBoundMessagesInMessageDialog();
      const aBoundTransitionMessages = bShowBoundTransitionMessages ? messageHandling.getMessages(true, true) : [];
      const aCustomMessages = mParameters && mParameters.customMessages ? mParameters.customMessages : [];
      const bIsStickyEditMode = CommonUtils.isStickyEditMode(this.base.getView());
      let mMessagePageParameters;

      // TODO: Stick mode check is okay as long as the controller extension is used with sap.fe.core and sap.fe.core.AppComponent.
      // It might be better to provide an extension to the consumer of the controller extension to provide this value.

      // The message page can only show 1 message today, so we navigate to it when :
      // 1. There are no bound transition messages to show,
      // 2. There are no custom messages to show, &
      // 3. There is exactly 1 unbound message in the message model with statusCode=503 and retry-After available
      // 4. retryAfter is greater than 120 seconds
      //
      // In Addition, navigating away from a sticky session will destroy the session so we do not navigate to message page for now.
      // TODO: check if navigation should be done in sticky edit mode.
      if (mParameters && mParameters.isDataReceivedError) {
        mMessagePageParameters = {
          title: mParameters.title,
          description: mParameters.description,
          navigateBackToOrigin: true,
          errorType: "PageNotFound"
        };
      } else if (!bIsStickyEditMode && !aBoundTransitionMessages.length && !aCustomMessages.length && (aUnboundMessages.length === 1 || mParameters && mParameters.isInitialLoad503Error)) {
        const oMessage = aUnboundMessages[0],
          oTechnicalDetails = oMessage.getTechnicalDetails();
        let sRetryAfterMessage;
        if (oTechnicalDetails && oTechnicalDetails.httpStatus === 503) {
          if (oTechnicalDetails.retryAfter) {
            const iSecondsBeforeRetry = this._getSecondsBeforeRetryAfter(oTechnicalDetails.retryAfter);
            if (iSecondsBeforeRetry > 120) {
              // TODO: For now let's keep getRetryAfterMessage in messageHandling because it is needed also by the dialog.
              // We can plan to move this and the dialog logic both to messageHandler controller extension if required.
              sRetryAfterMessage = messageHandling.getRetryAfterMessage(oMessage);
              mMessagePageParameters = {
                description: sRetryAfterMessage ? `${sRetryAfterMessage} ${oMessage.getMessage()}` : oMessage.getMessage(),
                navigateBackToOrigin: true,
                errorType: "UnableToLoad"
              };
            }
          } else {
            sRetryAfterMessage = messageHandling.getRetryAfterMessage(oMessage);
            mMessagePageParameters = {
              description: sRetryAfterMessage ? `${sRetryAfterMessage} ${oMessage.getMessage()}` : oMessage.getMessage(),
              navigateBackToOrigin: true,
              errorType: "UnableToLoad"
            };
          }
        }
      }
      return mMessagePageParameters;
    };
    _proto._getSecondsBeforeRetryAfter = function _getSecondsBeforeRetryAfter(dRetryAfter) {
      const dCurrentDateTime = new Date(),
        iCurrentDateTimeInMilliSeconds = dCurrentDateTime.getTime(),
        iRetryAfterDateTimeInMilliSeconds = dRetryAfter.getTime(),
        iSecondsBeforeRetry = (iRetryAfterDateTimeInMilliSeconds - iCurrentDateTimeInMilliSeconds) / 1000;
      return iSecondsBeforeRetry;
    }
    /**
     * Shows a message page or a message dialog based on the messages in the message dialog.
     *
     * @param [mParameters]
     * @returns A promise that is resolved once the user closes the message dialog or when navigation to the message page is complete. If there are no messages
     * to be shown, the promise is resolved immediately
     * @private
     */;
    _proto.showMessages = async function showMessages(mParameters) {
      const oAppComponent = CommonUtils.getAppComponent(this.getView());
      let mMessagePageParameters;
      if (!oAppComponent._isFclEnabled()) {
        mMessagePageParameters = this._checkNavigationToErrorPage(mParameters);
      }
      if (mMessagePageParameters) {
        // navigate to message page.
        // handler before page navigation is triggered, for example to close the action parameter dialog
        if (mParameters && mParameters.messagePageNavigationCallback) {
          mParameters.messagePageNavigationCallback();
        }
        mMessagePageParameters.handleShellBack = !(mParameters && mParameters.shellBack);
        // TODO: Use Illustrated message instead of normal message page
        // TODO: Return value needs to provided but since this function is private for now hence we can skip this.
        this.removeTransitionMessages();
        const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
        if (this.base._routing) {
          return new Promise((resolve, reject) => {
            // we have to set a timeout to be able to access the most recent messages
            setTimeout(() => {
              // TODO: great API - will be changed later
              this.base._routing.navigateToMessagePage(mParameters && mParameters.isDataReceivedError ? oResourceBundle.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR") : oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_TITLE"), mMessagePageParameters).then(resolve).catch(reject);
            }, 0);
          });
        }
      } else {
        // navigate to message dialog
        return this.showMessageDialog(mParameters);
      }
    };
    return MessageHandler;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "getShowBoundMessagesInMessageDialog", [_dec2, _dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "getShowBoundMessagesInMessageDialog"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "showMessageDialog", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "showMessageDialog"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "removeTransitionMessages", [_dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "removeTransitionMessages"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "showMessages", [_dec7, _dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "showMessages"), _class2.prototype)), _class2)) || _class);
  return MessageHandler;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/MessageHandler", ["sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/messageHandler/messageHandling","sap/fe/core/helpers/ClassSupport","sap/ui/core/Core","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution"],function(e,t,o,s,i,n){"use strict";var r,a,g,c,l,u,p,f,d,h;var v=o.publicExtension;var M=o.privateExtension;var y=o.finalExtension;var m=o.extensible;var b=o.defineUI5Class;function w(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;T(e,t)}function T(e,t){T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return T(e,t)}function O(e,t,o,s,i){var n={};Object.keys(s).forEach(function(e){n[e]=s[e]});n.enumerable=!!n.enumerable;n.configurable=!!n.configurable;if("value"in n||n.initializer){n.writable=true}n=o.slice().reverse().reduce(function(o,s){return s(e,t,o)||o},n);if(i&&n.initializer!==void 0){n.value=n.initializer?n.initializer.call(i):void 0;n.initializer=undefined}if(n.initializer===void 0){Object.defineProperty(e,t,n);n=null}return n}let D=(r=b("sap.fe.core.controllerextensions.MessageHandler"),a=M(),g=m(n.Instead),c=v(),l=y(),u=v(),p=v(),f=y(),r(d=(h=function(o){w(i,o);function i(){return o.apply(this,arguments)||this}var n=i.prototype;n.getShowBoundMessagesInMessageDialog=function e(){return true};n.showMessageDialog=function e(o){const s=o&&o.customMessages?o.customMessages:undefined,i=this.base.getView().getBindingContext("internal");const n=this.base.getView().getViewData().converterType;if(o&&o.isActionParameterDialogOpen&&i){i.setProperty("isActionParameterDialogOpen",true)}const r=this.getShowBoundMessagesInMessageDialog();const a=o&&o.context?o.context:this.getView().getBindingContext();if(i){i.setProperty("isActionParameterDialogOpen",false)}return new Promise(function(e,i){setTimeout(function(){t.showUnboundMessages(s,a,r,o===null||o===void 0?void 0:o.concurrentEditFlag,o===null||o===void 0?void 0:o.control,o===null||o===void 0?void 0:o.sActionName,undefined,o===null||o===void 0?void 0:o.onBeforeShowMessage,n).then(e).catch(i)},0)})};n.removeTransitionMessages=function e(o,s,i){if(!o){t.removeBoundTransitionMessages(i)}if(!s){t.removeUnboundTransitionMessages()}};n._checkNavigationToErrorPage=function o(s){const i=t.getMessages();const n=this.getShowBoundMessagesInMessageDialog();const r=n?t.getMessages(true,true):[];const a=s&&s.customMessages?s.customMessages:[];const g=e.isStickyEditMode(this.base.getView());let c;if(s&&s.isDataReceivedError){c={title:s.title,description:s.description,navigateBackToOrigin:true,errorType:"PageNotFound"}}else if(!g&&!r.length&&!a.length&&(i.length===1||s&&s.isInitialLoad503Error)){const e=i[0],o=e.getTechnicalDetails();let s;if(o&&o.httpStatus===503){if(o.retryAfter){const i=this._getSecondsBeforeRetryAfter(o.retryAfter);if(i>120){s=t.getRetryAfterMessage(e);c={description:s?`${s} ${e.getMessage()}`:e.getMessage(),navigateBackToOrigin:true,errorType:"UnableToLoad"}}}else{s=t.getRetryAfterMessage(e);c={description:s?`${s} ${e.getMessage()}`:e.getMessage(),navigateBackToOrigin:true,errorType:"UnableToLoad"}}}}return c};n._getSecondsBeforeRetryAfter=function e(t){const o=new Date,s=o.getTime(),i=t.getTime(),n=(i-s)/1e3;return n};n.showMessages=async function t(o){const i=e.getAppComponent(this.getView());let n;if(!i._isFclEnabled()){n=this._checkNavigationToErrorPage(o)}if(n){if(o&&o.messagePageNavigationCallback){o.messagePageNavigationCallback()}n.handleShellBack=!(o&&o.shellBack);this.removeTransitionMessages();const e=s.getLibraryResourceBundle("sap.fe.core");if(this.base._routing){return new Promise((t,s)=>{setTimeout(()=>{this.base._routing.navigateToMessagePage(o&&o.isDataReceivedError?e.getText("C_COMMON_SAPFE_DATA_RECEIVED_ERROR"):e.getText("C_MESSAGE_HANDLING_SAPFE_503_TITLE"),n).then(t).catch(s)},0)})}}else{return this.showMessageDialog(o)}};return i}(i),O(h.prototype,"getShowBoundMessagesInMessageDialog",[a,g],Object.getOwnPropertyDescriptor(h.prototype,"getShowBoundMessagesInMessageDialog"),h.prototype),O(h.prototype,"showMessageDialog",[c,l],Object.getOwnPropertyDescriptor(h.prototype,"showMessageDialog"),h.prototype),O(h.prototype,"removeTransitionMessages",[u],Object.getOwnPropertyDescriptor(h.prototype,"removeTransitionMessages"),h.prototype),O(h.prototype,"showMessages",[p,f],Object.getOwnPropertyDescriptor(h.prototype,"showMessages"),h.prototype),h))||d);return D},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/PageReady-dbg", ["sap/base/Log", "sap/fe/core/controllerextensions/pageReady/DataQueryWatcher", "sap/fe/core/services/TemplatedViewServiceFactory", "sap/ui/base/EventProvider", "sap/ui/core/Component", "sap/ui/core/Core", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "../CommonUtils", "../helpers/ClassSupport"], function (Log, DataQueryWatcher, TemplatedViewServiceFactory, EventProvider, Component, Core, ControllerExtension, OverrideExecution, CommonUtils, ClassSupport) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var privateExtension = ClassSupport.privateExtension;
  var methodOverride = ClassSupport.methodOverride;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  let PageReadyControllerExtension = (_dec = defineUI5Class("sap.fe.core.controllerextensions.PageReady"), _dec2 = methodOverride(), _dec3 = methodOverride(), _dec4 = publicExtension(), _dec5 = finalExtension(), _dec6 = methodOverride("_routing"), _dec7 = methodOverride("_routing"), _dec8 = methodOverride("_routing"), _dec9 = publicExtension(), _dec10 = finalExtension(), _dec11 = publicExtension(), _dec12 = finalExtension(), _dec13 = publicExtension(), _dec14 = finalExtension(), _dec15 = publicExtension(), _dec16 = finalExtension(), _dec17 = publicExtension(), _dec18 = finalExtension(), _dec19 = privateExtension(), _dec20 = extensible(OverrideExecution.Instead), _dec21 = publicExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(PageReadyControllerExtension, _ControllerExtension);
    function PageReadyControllerExtension() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _ControllerExtension.call(this, ...args) || this;
      _this.pageReadyTimeoutDefault = 7000;
      return _this;
    }
    var _proto = PageReadyControllerExtension.prototype;
    _proto.onInit = function onInit() {
      var _manifestContent$sap, _this$pageComponent, _rootControlControlle;
      this._nbWaits = 0;
      this._oEventProvider = this._oEventProvider ? this._oEventProvider : new EventProvider();
      this.view = this.getView();
      this.appComponent = CommonUtils.getAppComponent(this.view);
      this.pageComponent = Component.getOwnerComponentFor(this.view);
      const manifestContent = this.appComponent.getManifest();
      this.pageReadyTimeout = ((_manifestContent$sap = manifestContent["sap.ui5"]) === null || _manifestContent$sap === void 0 ? void 0 : _manifestContent$sap.pageReadyTimeout) ?? this.pageReadyTimeoutDefault;
      if ((_this$pageComponent = this.pageComponent) !== null && _this$pageComponent !== void 0 && _this$pageComponent.attachContainerDefined) {
        this.pageComponent.attachContainerDefined(oEvent => this.registerContainer(oEvent.getParameter("container")));
      } else {
        this.registerContainer(this.view);
      }
      const rootControlController = this.appComponent.getRootControl().getController();
      const placeholder = rootControlController === null || rootControlController === void 0 ? void 0 : (_rootControlControlle = rootControlController.getPlaceholder) === null || _rootControlControlle === void 0 ? void 0 : _rootControlControlle.call(rootControlController);
      if (placeholder !== null && placeholder !== void 0 && placeholder.isPlaceholderDebugEnabled()) {
        this.attachEvent("pageReady", null, () => {
          placeholder.getPlaceholderDebugStats().iPageReadyEventTimestamp = Date.now();
        }, this);
        this.attachEvent("heroesBatchReceived", null, () => {
          placeholder.getPlaceholderDebugStats().iHeroesBatchReceivedEventTimestamp = Date.now();
        }, this);
      }
      this.queryWatcher = new DataQueryWatcher(this._oEventProvider, this.checkPageReadyDebounced.bind(this));
    };
    _proto.onExit = function onExit() {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      delete this._oAppComponent;
      if (this._oContainer) {
        this._oContainer.removeEventDelegate(this._fnContainerDelegate);
      }
    };
    _proto.waitFor = function waitFor(oPromise) {
      this._nbWaits++;
      oPromise.finally(() => {
        setTimeout(() => {
          this._nbWaits--;
        }, 0);
      }).catch(null);
    };
    _proto.onRouteMatched = function onRouteMatched() {
      this._bIsPageReady = false;
    };
    _proto.onRouteMatchedFinished = async function onRouteMatchedFinished() {
      await this.onAfterBindingPromise;
      this.checkPageReadyDebounced();
    };
    _proto.registerAggregatedControls = function registerAggregatedControls(mainBindingContext) {
      if (mainBindingContext) {
        const mainObjectBinding = mainBindingContext.getBinding();
        this.queryWatcher.registerBinding(mainObjectBinding);
      }
      const aPromises = [];
      const aControls = this.getView().findAggregatedObjects(true);
      aControls.forEach(oElement => {
        const oObjectBinding = oElement.getObjectBinding();
        if (oObjectBinding) {
          // Register on all object binding (mostly used on object pages)
          this.queryWatcher.registerBinding(oObjectBinding);
        } else {
          const aBindingKeys = Object.keys(oElement.mBindingInfos);
          aBindingKeys.forEach(sPropertyName => {
            const oListBinding = oElement.mBindingInfos[sPropertyName].binding;
            if (oListBinding && oListBinding.isA("sap.ui.model.odata.v4.ODataListBinding")) {
              this.queryWatcher.registerBinding(oListBinding);
            }
          });
        }
        // This is dirty but MDCTables and MDCCharts have a weird loading lifecycle
        if (oElement.isA("sap.ui.mdc.Table") || oElement.isA("sap.ui.mdc.Chart")) {
          this.bTablesChartsLoaded = false;
          aPromises.push(this.queryWatcher.registerTableOrChart(oElement));
        } else if (oElement.isA("sap.fe.core.controls.FilterBar")) {
          this.queryWatcher.registerFilterBar(oElement);
        }
      });
      return aPromises;
    };
    _proto.onAfterBinding = function onAfterBinding(oBindingContext) {
      // In case the page is rebind we need to clear the timer (eg: in FCL, the user can select 2 items successively in the list report)
      if (this.pageReadyTimeoutTimer) {
        clearTimeout(this.pageReadyTimeoutTimer);
      }
      this.pageReadyTimeoutTimer = setTimeout(() => {
        Log.error(`The PageReady Event was not fired within the ${this.pageReadyTimeout} ms timeout . It has been forced. Please contact your application developer for further analysis`);
        this._oEventProvider.fireEvent("pageReady");
      }, this.pageReadyTimeout);
      if (this._bAfterBindingAlreadyApplied) {
        return;
      }
      this._bAfterBindingAlreadyApplied = true;
      if (this.isContextExpected() && oBindingContext === undefined) {
        // Force to mention we are expecting data
        this.bHasContext = false;
        return;
      } else {
        this.bHasContext = true;
      }
      this.attachEventOnce("pageReady", null, () => {
        clearTimeout(this.pageReadyTimeoutTimer);
        this.pageReadyTimeoutTimer = undefined;
        this._bAfterBindingAlreadyApplied = false;
        this.queryWatcher.reset();
      }, null);
      this.onAfterBindingPromise = new Promise(async resolve => {
        const aTableChartInitializedPromises = this.registerAggregatedControls(oBindingContext);
        if (aTableChartInitializedPromises.length > 0) {
          await Promise.all(aTableChartInitializedPromises);
          this.bTablesChartsLoaded = true;
          this.checkPageReadyDebounced();
          resolve();
        } else {
          this.checkPageReadyDebounced();
          resolve();
        }
      });
    };
    _proto.isPageReady = function isPageReady() {
      return this._bIsPageReady;
    };
    _proto.waitPageReady = function waitPageReady() {
      return new Promise(resolve => {
        if (this.isPageReady()) {
          resolve();
        } else {
          this.attachEventOnce("pageReady", null, () => {
            resolve();
          }, this);
        }
      });
    };
    _proto.attachEventOnce = function attachEventOnce(sEventId, oData, fnFunction, oListener) {
      // eslint-disable-next-line prefer-rest-params
      return this._oEventProvider.attachEventOnce(sEventId, oData, fnFunction, oListener);
    };
    _proto.attachEvent = function attachEvent(sEventId, oData, fnFunction, oListener) {
      // eslint-disable-next-line prefer-rest-params
      return this._oEventProvider.attachEvent(sEventId, oData, fnFunction, oListener);
    };
    _proto.detachEvent = function detachEvent(sEventId, fnFunction) {
      // eslint-disable-next-line prefer-rest-params
      return this._oEventProvider.detachEvent(sEventId, fnFunction);
    };
    _proto.registerContainer = function registerContainer(oContainer) {
      this._oContainer = oContainer;
      this._fnContainerDelegate = {
        onBeforeShow: () => {
          this.bShown = false;
          this._bIsPageReady = false;
        },
        onBeforeHide: () => {
          this.bShown = false;
          this._bIsPageReady = false;
        },
        onAfterShow: () => {
          var _this$onAfterBindingP;
          this.bShown = true;
          (_this$onAfterBindingP = this.onAfterBindingPromise) === null || _this$onAfterBindingP === void 0 ? void 0 : _this$onAfterBindingP.then(() => {
            this._checkPageReady(true);
          });
        }
      };
      this._oContainer.addEventDelegate(this._fnContainerDelegate, this);
    };
    _proto.isContextExpected = function isContextExpected() {
      return false;
    };
    _proto.checkPageReadyDebounced = function checkPageReadyDebounced() {
      if (this.pageReadyTimer) {
        clearTimeout(this.pageReadyTimer);
      }
      this.pageReadyTimer = setTimeout(() => {
        this._checkPageReady();
      }, 200);
    };
    _proto._checkPageReady = function _checkPageReady() {
      let bFromNav = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      const fnUIUpdated = () => {
        // Wait until the UI is no longer dirty
        if (!Core.getUIDirty()) {
          Core.detachEvent("UIUpdated", fnUIUpdated);
          this._bWaitingForRefresh = false;
          setTimeout(() => {
            this._checkPageReady();
          }, 20);
        }
      };

      // In case UIUpdate does not get called, check if UI is not dirty and then call _checkPageReady
      const checkUIUpdated = () => {
        if (Core.getUIDirty()) {
          setTimeout(checkUIUpdated, 500);
        } else if (this._bWaitingForRefresh) {
          this._bWaitingForRefresh = false;
          Core.detachEvent("UIUpdated", fnUIUpdated);
          this._checkPageReady();
        }
      };
      if (this.bShown && this.queryWatcher.isDataReceived() !== false && this.bTablesChartsLoaded !== false && (!this.isContextExpected() || this.bHasContext) // Either no context is expected or there is one
      ) {
        if (this.queryWatcher.isDataReceived() === true && !bFromNav && !this._bWaitingForRefresh && Core.getUIDirty()) {
          // If we requested data we get notified as soon as the data arrived, so before the next rendering tick
          this.queryWatcher.resetDataReceived();
          this._bWaitingForRefresh = true;
          Core.attachEvent("UIUpdated", fnUIUpdated);
          setTimeout(checkUIUpdated, 500);
        } else if (!this._bWaitingForRefresh && Core.getUIDirty() || this._nbWaits !== 0 || TemplatedViewServiceFactory.getNumberOfViewsInCreationState() > 0 || this.queryWatcher.isSearchPending()) {
          this._bWaitingForRefresh = true;
          Core.attachEvent("UIUpdated", fnUIUpdated);
          setTimeout(checkUIUpdated, 500);
        } else if (!this._bWaitingForRefresh) {
          // In the case we're not waiting for any data (navigating back to a page we already have loaded)
          // just wait for a frame to fire the event.
          this._bIsPageReady = true;
          this._oEventProvider.fireEvent("pageReady");
        }
      }
    };
    return PageReadyControllerExtension;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onExit", [_dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "onExit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "waitFor", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "waitFor"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onRouteMatched", [_dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "onRouteMatched"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onRouteMatchedFinished", [_dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "onRouteMatchedFinished"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onAfterBinding", [_dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "onAfterBinding"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "isPageReady", [_dec9, _dec10], Object.getOwnPropertyDescriptor(_class2.prototype, "isPageReady"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "waitPageReady", [_dec11, _dec12], Object.getOwnPropertyDescriptor(_class2.prototype, "waitPageReady"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "attachEventOnce", [_dec13, _dec14], Object.getOwnPropertyDescriptor(_class2.prototype, "attachEventOnce"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "attachEvent", [_dec15, _dec16], Object.getOwnPropertyDescriptor(_class2.prototype, "attachEvent"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "detachEvent", [_dec17, _dec18], Object.getOwnPropertyDescriptor(_class2.prototype, "detachEvent"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "isContextExpected", [_dec19, _dec20], Object.getOwnPropertyDescriptor(_class2.prototype, "isContextExpected"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "checkPageReadyDebounced", [_dec21], Object.getOwnPropertyDescriptor(_class2.prototype, "checkPageReadyDebounced"), _class2.prototype)), _class2)) || _class);
  return PageReadyControllerExtension;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/PageReady", ["sap/base/Log","sap/fe/core/controllerextensions/pageReady/DataQueryWatcher","sap/fe/core/services/TemplatedViewServiceFactory","sap/ui/base/EventProvider","sap/ui/core/Component","sap/ui/core/Core","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","../CommonUtils","../helpers/ClassSupport"],function(e,t,i,o,r,n,a,s,c,h){"use strict";var p,d,u,g,l,y,f,v,b,m,R,P,E,_,O,w,C,D,T,A,x,W,B;var I=h.publicExtension;var j=h.privateExtension;var F=h.methodOverride;var k=h.finalExtension;var U=h.extensible;var S=h.defineUI5Class;function q(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;M(e,t)}function M(e,t){M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return M(e,t)}function z(e,t,i,o,r){var n={};Object.keys(o).forEach(function(e){n[e]=o[e]});n.enumerable=!!n.enumerable;n.configurable=!!n.configurable;if("value"in n||n.initializer){n.writable=true}n=i.slice().reverse().reduce(function(i,o){return o(e,t,i)||i},n);if(r&&n.initializer!==void 0){n.value=n.initializer?n.initializer.call(r):void 0;n.initializer=undefined}if(n.initializer===void 0){Object.defineProperty(e,t,n);n=null}return n}let H=(p=S("sap.fe.core.controllerextensions.PageReady"),d=F(),u=F(),g=I(),l=k(),y=F("_routing"),f=F("_routing"),v=F("_routing"),b=I(),m=k(),R=I(),P=k(),E=I(),_=k(),O=I(),w=k(),C=I(),D=k(),T=j(),A=U(s.Instead),x=I(),p(W=(B=function(a){q(s,a);function s(){var e;for(var t=arguments.length,i=new Array(t),o=0;o<t;o++){i[o]=arguments[o]}e=a.call(this,...i)||this;e.pageReadyTimeoutDefault=7e3;return e}var h=s.prototype;h.onInit=function e(){var i,n,a;this._nbWaits=0;this._oEventProvider=this._oEventProvider?this._oEventProvider:new o;this.view=this.getView();this.appComponent=c.getAppComponent(this.view);this.pageComponent=r.getOwnerComponentFor(this.view);const s=this.appComponent.getManifest();this.pageReadyTimeout=((i=s["sap.ui5"])===null||i===void 0?void 0:i.pageReadyTimeout)??this.pageReadyTimeoutDefault;if((n=this.pageComponent)!==null&&n!==void 0&&n.attachContainerDefined){this.pageComponent.attachContainerDefined(e=>this.registerContainer(e.getParameter("container")))}else{this.registerContainer(this.view)}const h=this.appComponent.getRootControl().getController();const p=h===null||h===void 0?void 0:(a=h.getPlaceholder)===null||a===void 0?void 0:a.call(h);if(p!==null&&p!==void 0&&p.isPlaceholderDebugEnabled()){this.attachEvent("pageReady",null,()=>{p.getPlaceholderDebugStats().iPageReadyEventTimestamp=Date.now()},this);this.attachEvent("heroesBatchReceived",null,()=>{p.getPlaceholderDebugStats().iHeroesBatchReceivedEventTimestamp=Date.now()},this)}this.queryWatcher=new t(this._oEventProvider,this.checkPageReadyDebounced.bind(this))};h.onExit=function e(){delete this._oAppComponent;if(this._oContainer){this._oContainer.removeEventDelegate(this._fnContainerDelegate)}};h.waitFor=function e(t){this._nbWaits++;t.finally(()=>{setTimeout(()=>{this._nbWaits--},0)}).catch(null)};h.onRouteMatched=function e(){this._bIsPageReady=false};h.onRouteMatchedFinished=async function e(){await this.onAfterBindingPromise;this.checkPageReadyDebounced()};h.registerAggregatedControls=function e(t){if(t){const e=t.getBinding();this.queryWatcher.registerBinding(e)}const i=[];const o=this.getView().findAggregatedObjects(true);o.forEach(e=>{const t=e.getObjectBinding();if(t){this.queryWatcher.registerBinding(t)}else{const t=Object.keys(e.mBindingInfos);t.forEach(t=>{const i=e.mBindingInfos[t].binding;if(i&&i.isA("sap.ui.model.odata.v4.ODataListBinding")){this.queryWatcher.registerBinding(i)}})}if(e.isA("sap.ui.mdc.Table")||e.isA("sap.ui.mdc.Chart")){this.bTablesChartsLoaded=false;i.push(this.queryWatcher.registerTableOrChart(e))}else if(e.isA("sap.fe.core.controls.FilterBar")){this.queryWatcher.registerFilterBar(e)}});return i};h.onAfterBinding=function t(i){if(this.pageReadyTimeoutTimer){clearTimeout(this.pageReadyTimeoutTimer)}this.pageReadyTimeoutTimer=setTimeout(()=>{e.error(`The PageReady Event was not fired within the ${this.pageReadyTimeout} ms timeout . It has been forced. Please contact your application developer for further analysis`);this._oEventProvider.fireEvent("pageReady")},this.pageReadyTimeout);if(this._bAfterBindingAlreadyApplied){return}this._bAfterBindingAlreadyApplied=true;if(this.isContextExpected()&&i===undefined){this.bHasContext=false;return}else{this.bHasContext=true}this.attachEventOnce("pageReady",null,()=>{clearTimeout(this.pageReadyTimeoutTimer);this.pageReadyTimeoutTimer=undefined;this._bAfterBindingAlreadyApplied=false;this.queryWatcher.reset()},null);this.onAfterBindingPromise=new Promise(async e=>{const t=this.registerAggregatedControls(i);if(t.length>0){await Promise.all(t);this.bTablesChartsLoaded=true;this.checkPageReadyDebounced();e()}else{this.checkPageReadyDebounced();e()}})};h.isPageReady=function e(){return this._bIsPageReady};h.waitPageReady=function e(){return new Promise(e=>{if(this.isPageReady()){e()}else{this.attachEventOnce("pageReady",null,()=>{e()},this)}})};h.attachEventOnce=function e(t,i,o,r){return this._oEventProvider.attachEventOnce(t,i,o,r)};h.attachEvent=function e(t,i,o,r){return this._oEventProvider.attachEvent(t,i,o,r)};h.detachEvent=function e(t,i){return this._oEventProvider.detachEvent(t,i)};h.registerContainer=function e(t){this._oContainer=t;this._fnContainerDelegate={onBeforeShow:()=>{this.bShown=false;this._bIsPageReady=false},onBeforeHide:()=>{this.bShown=false;this._bIsPageReady=false},onAfterShow:()=>{var e;this.bShown=true;(e=this.onAfterBindingPromise)===null||e===void 0?void 0:e.then(()=>{this._checkPageReady(true)})}};this._oContainer.addEventDelegate(this._fnContainerDelegate,this)};h.isContextExpected=function e(){return false};h.checkPageReadyDebounced=function e(){if(this.pageReadyTimer){clearTimeout(this.pageReadyTimer)}this.pageReadyTimer=setTimeout(()=>{this._checkPageReady()},200)};h._checkPageReady=function e(){let t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;const o=()=>{if(!n.getUIDirty()){n.detachEvent("UIUpdated",o);this._bWaitingForRefresh=false;setTimeout(()=>{this._checkPageReady()},20)}};const r=()=>{if(n.getUIDirty()){setTimeout(r,500)}else if(this._bWaitingForRefresh){this._bWaitingForRefresh=false;n.detachEvent("UIUpdated",o);this._checkPageReady()}};if(this.bShown&&this.queryWatcher.isDataReceived()!==false&&this.bTablesChartsLoaded!==false&&(!this.isContextExpected()||this.bHasContext)){if(this.queryWatcher.isDataReceived()===true&&!t&&!this._bWaitingForRefresh&&n.getUIDirty()){this.queryWatcher.resetDataReceived();this._bWaitingForRefresh=true;n.attachEvent("UIUpdated",o);setTimeout(r,500)}else if(!this._bWaitingForRefresh&&n.getUIDirty()||this._nbWaits!==0||i.getNumberOfViewsInCreationState()>0||this.queryWatcher.isSearchPending()){this._bWaitingForRefresh=true;n.attachEvent("UIUpdated",o);setTimeout(r,500)}else if(!this._bWaitingForRefresh){this._bIsPageReady=true;this._oEventProvider.fireEvent("pageReady")}}};return s}(a),z(B.prototype,"onInit",[d],Object.getOwnPropertyDescriptor(B.prototype,"onInit"),B.prototype),z(B.prototype,"onExit",[u],Object.getOwnPropertyDescriptor(B.prototype,"onExit"),B.prototype),z(B.prototype,"waitFor",[g,l],Object.getOwnPropertyDescriptor(B.prototype,"waitFor"),B.prototype),z(B.prototype,"onRouteMatched",[y],Object.getOwnPropertyDescriptor(B.prototype,"onRouteMatched"),B.prototype),z(B.prototype,"onRouteMatchedFinished",[f],Object.getOwnPropertyDescriptor(B.prototype,"onRouteMatchedFinished"),B.prototype),z(B.prototype,"onAfterBinding",[v],Object.getOwnPropertyDescriptor(B.prototype,"onAfterBinding"),B.prototype),z(B.prototype,"isPageReady",[b,m],Object.getOwnPropertyDescriptor(B.prototype,"isPageReady"),B.prototype),z(B.prototype,"waitPageReady",[R,P],Object.getOwnPropertyDescriptor(B.prototype,"waitPageReady"),B.prototype),z(B.prototype,"attachEventOnce",[E,_],Object.getOwnPropertyDescriptor(B.prototype,"attachEventOnce"),B.prototype),z(B.prototype,"attachEvent",[O,w],Object.getOwnPropertyDescriptor(B.prototype,"attachEvent"),B.prototype),z(B.prototype,"detachEvent",[C,D],Object.getOwnPropertyDescriptor(B.prototype,"detachEvent"),B.prototype),z(B.prototype,"isContextExpected",[T,A],Object.getOwnPropertyDescriptor(B.prototype,"isContextExpected"),B.prototype),z(B.prototype,"checkPageReadyDebounced",[x],Object.getOwnPropertyDescriptor(B.prototype,"checkPageReadyDebounced"),B.prototype),B))||W);return H},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Paginator-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "sap/ui/model/json/JSONModel"], function (ClassSupport, ControllerExtension, OverrideExecution, JSONModel) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var privateExtension = ClassSupport.privateExtension;
  var methodOverride = ClassSupport.methodOverride;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * Controller extension providing hooks for the navigation using paginators
   *
   * @hideconstructor
   * @public
   * @since 1.94.0
   */
  let Paginator = (_dec = defineUI5Class("sap.fe.core.controllerextensions.Paginator"), _dec2 = methodOverride(), _dec3 = publicExtension(), _dec4 = finalExtension(), _dec5 = publicExtension(), _dec6 = finalExtension(), _dec7 = privateExtension(), _dec8 = extensible(OverrideExecution.After), _dec9 = privateExtension(), _dec10 = extensible(OverrideExecution.After), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(Paginator, _ControllerExtension);
    function Paginator() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _ControllerExtension.call(this, ...args) || this;
      _this._iCurrentIndex = -1;
      return _this;
    }
    var _proto = Paginator.prototype;
    _proto.onInit = function onInit() {
      this._oView = this.base.getView();
      this._oView.setModel(new JSONModel({
        navUpEnabled: false,
        navDownEnabled: false
      }), "paginator");
    }
    /**
     * Initiates the paginator control.
     *
     * @function
     * @param oBinding ODataListBinding object
     * @param oContext Current context where the navigation is initiated
     * @alias sap.fe.core.controllerextensions.Paginator#initialize
     * @public
     * @since 1.94.0
     */;
    _proto.initialize = function initialize(oBinding, oContext) {
      if (oBinding && oBinding.getAllCurrentContexts) {
        this._oListBinding = oBinding;
      }
      if (oContext) {
        this._oCurrentContext = oContext;
      }
      this._updateCurrentIndexAndButtonEnablement();
    };
    _proto._updateCurrentIndexAndButtonEnablement = function _updateCurrentIndexAndButtonEnablement() {
      if (this._oCurrentContext && this._oListBinding) {
        const sPath = this._oCurrentContext.getPath();
        // Storing the currentIndex in global variable
        this._iCurrentIndex = this._oListBinding.getAllCurrentContexts().findIndex(function (oContext) {
          return oContext && oContext.getPath() === sPath;
        });
        const oCurrentIndexContext = this._oListBinding.getAllCurrentContexts()[this._iCurrentIndex];
        if (!this._iCurrentIndex && this._iCurrentIndex !== 0 || !oCurrentIndexContext || this._oCurrentContext.getPath() !== oCurrentIndexContext.getPath()) {
          this._updateCurrentIndex();
        }
      }
      this._handleButtonEnablement();
    };
    _proto._handleButtonEnablement = function _handleButtonEnablement() {
      //Enabling and Disabling the Buttons on change of the control context
      const mButtonEnablementModel = this.base.getView().getModel("paginator");
      if (this._oListBinding && this._oListBinding.getAllCurrentContexts().length > 1 && this._iCurrentIndex > -1) {
        if (this._iCurrentIndex === this._oListBinding.getAllCurrentContexts().length - 1) {
          mButtonEnablementModel.setProperty("/navDownEnabled", false);
        } else if (this._oListBinding.getAllCurrentContexts()[this._iCurrentIndex + 1].isInactive()) {
          //check the next context is not an inactive context
          mButtonEnablementModel.setProperty("/navDownEnabled", false);
        } else {
          mButtonEnablementModel.setProperty("/navDownEnabled", true);
        }
        if (this._iCurrentIndex === 0) {
          mButtonEnablementModel.setProperty("/navUpEnabled", false);
        } else if (this._oListBinding.getAllCurrentContexts()[this._iCurrentIndex - 1].isInactive()) {
          mButtonEnablementModel.setProperty("/navUpEnabled", false);
        } else {
          mButtonEnablementModel.setProperty("/navUpEnabled", true);
        }
      } else {
        // Don't show the paginator buttons
        // 1. When no listbinding is available
        // 2. Only '1' or '0' context exists in the listBinding
        // 3. The current index is -ve, i.e the currentIndex is invalid.
        mButtonEnablementModel.setProperty("/navUpEnabled", false);
        mButtonEnablementModel.setProperty("/navDownEnabled", false);
      }
    };
    _proto._updateCurrentIndex = function _updateCurrentIndex() {
      if (this._oCurrentContext && this._oListBinding) {
        const sPath = this._oCurrentContext.getPath();
        // Storing the currentIndex in global variable
        this._iCurrentIndex = this._oListBinding.getAllCurrentContexts().findIndex(function (oContext) {
          return oContext && oContext.getPath() === sPath;
        });
      }
    };
    _proto.updateCurrentContext = async function updateCurrentContext(iDeltaIndex) {
      var _this$_oCurrentContex, _this$_oCurrentContex2;
      if (!this._oListBinding) {
        return;
      }
      const oModel = (_this$_oCurrentContex = this._oCurrentContext) !== null && _this$_oCurrentContex !== void 0 && _this$_oCurrentContex.getModel ? (_this$_oCurrentContex2 = this._oCurrentContext) === null || _this$_oCurrentContex2 === void 0 ? void 0 : _this$_oCurrentContex2.getModel() : undefined;
      //Submitting any pending changes that might be there before navigating to next context.
      await (oModel === null || oModel === void 0 ? void 0 : oModel.submitBatch("$auto"));
      const aCurrentContexts = this._oListBinding.getAllCurrentContexts();
      const iNewIndex = this._iCurrentIndex + iDeltaIndex;
      const oNewContext = aCurrentContexts[iNewIndex];
      if (oNewContext) {
        const bPreventIdxUpdate = this.onBeforeContextUpdate(this._oListBinding, this._iCurrentIndex, iDeltaIndex);
        if (!bPreventIdxUpdate) {
          this._iCurrentIndex = iNewIndex;
          this._oCurrentContext = oNewContext;
        }
        this.onContextUpdate(oNewContext);
      }
      this._handleButtonEnablement();
    }

    /**
     * Called before context update.
     *
     * @function
     * @param _oListBinding ODataListBinding object
     * @param _iCurrentIndex Current index of context in listBinding from where the navigation is initiated
     * @param _iIndexUpdate The delta index for update
     * @returns `true` to prevent the update of current context.
     * @alias sap.fe.core.controllerextensions.Paginator#onBeforeContextUpdate
     * @private
     */;
    _proto.onBeforeContextUpdate = function onBeforeContextUpdate(_oListBinding, _iCurrentIndex, _iIndexUpdate) {
      return false;
    }

    /**
     * Returns the updated context after the paginator operation.
     *
     * @function
     * @param oContext Final context returned after the paginator action
     * @alias sap.fe.core.controllerextensions.Paginator#onContextUpdate
     * @public
     * @since 1.94.0
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onContextUpdate = function onContextUpdate(oContext) {
      //To be overridden by the application
    };
    return Paginator;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "initialize", [_dec3, _dec4], Object.getOwnPropertyDescriptor(_class2.prototype, "initialize"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "updateCurrentContext", [_dec5, _dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "updateCurrentContext"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeContextUpdate", [_dec7, _dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeContextUpdate"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onContextUpdate", [_dec9, _dec10], Object.getOwnPropertyDescriptor(_class2.prototype, "onContextUpdate"), _class2.prototype)), _class2)) || _class);
  return Paginator;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Paginator", ["sap/fe/core/helpers/ClassSupport","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","sap/ui/model/json/JSONModel"],function(t,e,n,i){"use strict";var r,o,s,a,u,l,p,d,C,c,f,h;var x=t.publicExtension;var _=t.privateExtension;var g=t.methodOverride;var v=t.finalExtension;var y=t.extensible;var b=t.defineUI5Class;function I(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;B(t,e)}function B(t,e){B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,n){e.__proto__=n;return e};return B(t,e)}function P(t,e,n,i,r){var o={};Object.keys(i).forEach(function(t){o[t]=i[t]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=n.slice().reverse().reduce(function(n,i){return i(t,e,n)||n},o);if(r&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(r):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(t,e,o);o=null}return o}let E=(r=b("sap.fe.core.controllerextensions.Paginator"),o=g(),s=x(),a=v(),u=x(),l=v(),p=_(),d=y(n.After),C=_(),c=y(n.After),r(f=(h=function(t){I(e,t);function e(){var e;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++){i[r]=arguments[r]}e=t.call(this,...i)||this;e._iCurrentIndex=-1;return e}var n=e.prototype;n.onInit=function t(){this._oView=this.base.getView();this._oView.setModel(new i({navUpEnabled:false,navDownEnabled:false}),"paginator")};n.initialize=function t(e,n){if(e&&e.getAllCurrentContexts){this._oListBinding=e}if(n){this._oCurrentContext=n}this._updateCurrentIndexAndButtonEnablement()};n._updateCurrentIndexAndButtonEnablement=function t(){if(this._oCurrentContext&&this._oListBinding){const t=this._oCurrentContext.getPath();this._iCurrentIndex=this._oListBinding.getAllCurrentContexts().findIndex(function(e){return e&&e.getPath()===t});const e=this._oListBinding.getAllCurrentContexts()[this._iCurrentIndex];if(!this._iCurrentIndex&&this._iCurrentIndex!==0||!e||this._oCurrentContext.getPath()!==e.getPath()){this._updateCurrentIndex()}}this._handleButtonEnablement()};n._handleButtonEnablement=function t(){const e=this.base.getView().getModel("paginator");if(this._oListBinding&&this._oListBinding.getAllCurrentContexts().length>1&&this._iCurrentIndex>-1){if(this._iCurrentIndex===this._oListBinding.getAllCurrentContexts().length-1){e.setProperty("/navDownEnabled",false)}else if(this._oListBinding.getAllCurrentContexts()[this._iCurrentIndex+1].isInactive()){e.setProperty("/navDownEnabled",false)}else{e.setProperty("/navDownEnabled",true)}if(this._iCurrentIndex===0){e.setProperty("/navUpEnabled",false)}else if(this._oListBinding.getAllCurrentContexts()[this._iCurrentIndex-1].isInactive()){e.setProperty("/navUpEnabled",false)}else{e.setProperty("/navUpEnabled",true)}}else{e.setProperty("/navUpEnabled",false);e.setProperty("/navDownEnabled",false)}};n._updateCurrentIndex=function t(){if(this._oCurrentContext&&this._oListBinding){const t=this._oCurrentContext.getPath();this._iCurrentIndex=this._oListBinding.getAllCurrentContexts().findIndex(function(e){return e&&e.getPath()===t})}};n.updateCurrentContext=async function t(e){var n,i;if(!this._oListBinding){return}const r=(n=this._oCurrentContext)!==null&&n!==void 0&&n.getModel?(i=this._oCurrentContext)===null||i===void 0?void 0:i.getModel():undefined;await(r===null||r===void 0?void 0:r.submitBatch("$auto"));const o=this._oListBinding.getAllCurrentContexts();const s=this._iCurrentIndex+e;const a=o[s];if(a){const t=this.onBeforeContextUpdate(this._oListBinding,this._iCurrentIndex,e);if(!t){this._iCurrentIndex=s;this._oCurrentContext=a}this.onContextUpdate(a)}this._handleButtonEnablement()};n.onBeforeContextUpdate=function t(e,n,i){return false};n.onContextUpdate=function t(e){};return e}(e),P(h.prototype,"onInit",[o],Object.getOwnPropertyDescriptor(h.prototype,"onInit"),h.prototype),P(h.prototype,"initialize",[s,a],Object.getOwnPropertyDescriptor(h.prototype,"initialize"),h.prototype),P(h.prototype,"updateCurrentContext",[u,l],Object.getOwnPropertyDescriptor(h.prototype,"updateCurrentContext"),h.prototype),P(h.prototype,"onBeforeContextUpdate",[p,d],Object.getOwnPropertyDescriptor(h.prototype,"onBeforeContextUpdate"),h.prototype),P(h.prototype,"onContextUpdate",[C,c],Object.getOwnPropertyDescriptor(h.prototype,"onContextUpdate"),h.prototype),h))||f);return E},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Placeholder-dbg", ["sap/base/util/ObjectPath", "sap/base/util/UriParameters", "sap/fe/core/helpers/ClassSupport", "sap/fe/placeholder/library", "sap/ui/core/Core", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/Placeholder"], function (ObjectPath, UriParameters, ClassSupport, _library, Core, ControllerExtension, Placeholder) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * {@link sap.ui.core.mvc.ControllerExtension Controller extension} for Placeholder
   *
   * @namespace
   * @alias sap.fe.core.controllerextensions.Placeholder
   */
  let PlaceholderControllerExtension = (_dec = defineUI5Class("sap.fe.core.controllerextensions.Placeholder"), _dec2 = publicExtension(), _dec3 = publicExtension(), _dec4 = publicExtension(), _dec5 = publicExtension(), _dec6 = publicExtension(), _dec7 = publicExtension(), _dec8 = publicExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(PlaceholderControllerExtension, _ControllerExtension);
    function PlaceholderControllerExtension() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = PlaceholderControllerExtension.prototype;
    _proto.attachHideCallback = function attachHideCallback() {
      if (this.isPlaceholderEnabled()) {
        const oView = this.base.getView();
        const oPage = oView.getParent() && oView.getParent().oContainer;
        const oNavContainer = oPage && oPage.getParent();
        if (!oNavContainer) {
          return;
        }
        const _fnContainerDelegate = {
          onAfterShow: function (oEvent) {
            if (oEvent.isBackToPage) {
              oNavContainer.hidePlaceholder();
            } else if (UriParameters.fromQuery(window.location.hash.replace(/#.*\?/, "")).get("restoreHistory") === "true") {
              // in case we navigate to the listreport using the shell
              oNavContainer.hidePlaceholder();
            }
          }
        };
        oPage.addEventDelegate(_fnContainerDelegate);
        const oPageReady = oView.getController().pageReady;
        //In case of objectPage, the placeholder should be hidden when heroes requests are received
        // But for some scenario like "Create item", heroes requests are not sent .
        // The pageReady event is then used as fallback

        const aAttachEvents = ["pageReady"];
        if (oView.getControllerName() === "sap.fe.templates.ObjectPage.ObjectPageController") {
          aAttachEvents.push("heroesBatchReceived");
        }
        aAttachEvents.forEach(function (sEvent) {
          oPageReady.attachEvent(sEvent, null, function () {
            oNavContainer.hidePlaceholder();
          }, null);
        });
      }
    };
    _proto.attachRouteMatchers = function attachRouteMatchers() {
      this._init();
    };
    _proto._init = function _init() {
      this.oAppComponent = this.base.getAppComponent();
      this.oRootContainer = this.oAppComponent.getRootContainer();
      this.oPlaceholders = {};

      // eslint-disable-next-line no-constant-condition
      if (this.isPlaceholderEnabled()) {
        Placeholder.registerProvider(function (oConfig) {
          switch (oConfig.name) {
            case "sap.fe.templates.ListReport":
              return {
                html: "sap/fe/placeholder/view/PlaceholderLR.fragment.html",
                autoClose: false
              };
            case "sap.fe.templates.ObjectPage":
              return {
                html: "sap/fe/placeholder/view/PlaceholderOP.fragment.html",
                autoClose: false
              };
            default:
          }
        });
      }
      if (this.isPlaceholderDebugEnabled()) {
        this.initPlaceholderDebug();
      }
    };
    _proto.initPlaceholderDebug = function initPlaceholderDebug() {
      this.resetPlaceholderDebugStats();
      const handler = {
        apply: target => {
          if (this.oRootContainer._placeholder && this.oRootContainer._placeholder.placeholder) {
            this.debugStats.iHidePlaceholderTimestamp = Date.now();
          }
          return target.bind(this.oRootContainer)();
        }
      };
      // eslint-disable-next-line no-undef
      const proxy1 = new Proxy(this.oRootContainer.hidePlaceholder, handler);
      this.oRootContainer.hidePlaceholder = proxy1;
    };
    _proto.isPlaceholderDebugEnabled = function isPlaceholderDebugEnabled() {
      if (UriParameters.fromQuery(window.location.search).get("sap-ui-xx-placeholder-debug") === "true") {
        return true;
      }
      return false;
    };
    _proto.resetPlaceholderDebugStats = function resetPlaceholderDebugStats() {
      this.debugStats = {
        iHidePlaceholderTimestamp: 0,
        iPageReadyEventTimestamp: 0,
        iHeroesBatchReceivedEventTimestamp: 0
      };
    };
    _proto.getPlaceholderDebugStats = function getPlaceholderDebugStats() {
      return this.debugStats;
    };
    _proto.isPlaceholderEnabled = function isPlaceholderEnabled() {
      const bPlaceholderEnabledInFLP = ObjectPath.get("sap-ushell-config.apps.placeholder.enabled");
      if (bPlaceholderEnabledInFLP === false) {
        return false;
      }
      return Core.getConfiguration().getPlaceholder();
    };
    return PlaceholderControllerExtension;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "attachHideCallback", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "attachHideCallback"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "attachRouteMatchers", [_dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "attachRouteMatchers"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "initPlaceholderDebug", [_dec4], Object.getOwnPropertyDescriptor(_class2.prototype, "initPlaceholderDebug"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "isPlaceholderDebugEnabled", [_dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "isPlaceholderDebugEnabled"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "resetPlaceholderDebugStats", [_dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "resetPlaceholderDebugStats"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getPlaceholderDebugStats", [_dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "getPlaceholderDebugStats"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "isPlaceholderEnabled", [_dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "isPlaceholderEnabled"), _class2.prototype)), _class2)) || _class);
  return PlaceholderControllerExtension;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Placeholder", ["sap/base/util/ObjectPath","sap/base/util/UriParameters","sap/fe/core/helpers/ClassSupport","sap/fe/placeholder/library","sap/ui/core/Core","sap/ui/core/mvc/ControllerExtension","sap/ui/core/Placeholder"],function(e,t,o,r,a,i,n){"use strict";var l,c,s,p,h,u,d,f,b,g;var P=o.publicExtension;var y=o.defineUI5Class;function m(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;O(e,t)}function O(e,t){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return O(e,t)}function C(e,t,o,r,a){var i={};Object.keys(r).forEach(function(e){i[e]=r[e]});i.enumerable=!!i.enumerable;i.configurable=!!i.configurable;if("value"in i||i.initializer){i.writable=true}i=o.slice().reverse().reduce(function(o,r){return r(e,t,o)||o},i);if(a&&i.initializer!==void 0){i.value=i.initializer?i.initializer.call(a):void 0;i.initializer=undefined}if(i.initializer===void 0){Object.defineProperty(e,t,i);i=null}return i}let D=(l=y("sap.fe.core.controllerextensions.Placeholder"),c=P(),s=P(),p=P(),h=P(),u=P(),d=P(),f=P(),l(b=(g=function(o){m(r,o);function r(){return o.apply(this,arguments)||this}var i=r.prototype;i.attachHideCallback=function e(){if(this.isPlaceholderEnabled()){const e=this.base.getView();const o=e.getParent()&&e.getParent().oContainer;const r=o&&o.getParent();if(!r){return}const a={onAfterShow:function(e){if(e.isBackToPage){r.hidePlaceholder()}else if(t.fromQuery(window.location.hash.replace(/#.*\?/,"")).get("restoreHistory")==="true"){r.hidePlaceholder()}}};o.addEventDelegate(a);const i=e.getController().pageReady;const n=["pageReady"];if(e.getControllerName()==="sap.fe.templates.ObjectPage.ObjectPageController"){n.push("heroesBatchReceived")}n.forEach(function(e){i.attachEvent(e,null,function(){r.hidePlaceholder()},null)})}};i.attachRouteMatchers=function e(){this._init()};i._init=function e(){this.oAppComponent=this.base.getAppComponent();this.oRootContainer=this.oAppComponent.getRootContainer();this.oPlaceholders={};if(this.isPlaceholderEnabled()){n.registerProvider(function(e){switch(e.name){case"sap.fe.templates.ListReport":return{html:"sap/fe/placeholder/view/PlaceholderLR.fragment.html",autoClose:false};case"sap.fe.templates.ObjectPage":return{html:"sap/fe/placeholder/view/PlaceholderOP.fragment.html",autoClose:false};default:}})}if(this.isPlaceholderDebugEnabled()){this.initPlaceholderDebug()}};i.initPlaceholderDebug=function e(){this.resetPlaceholderDebugStats();const t={apply:e=>{if(this.oRootContainer._placeholder&&this.oRootContainer._placeholder.placeholder){this.debugStats.iHidePlaceholderTimestamp=Date.now()}return e.bind(this.oRootContainer)()}};const o=new Proxy(this.oRootContainer.hidePlaceholder,t);this.oRootContainer.hidePlaceholder=o};i.isPlaceholderDebugEnabled=function e(){if(t.fromQuery(window.location.search).get("sap-ui-xx-placeholder-debug")==="true"){return true}return false};i.resetPlaceholderDebugStats=function e(){this.debugStats={iHidePlaceholderTimestamp:0,iPageReadyEventTimestamp:0,iHeroesBatchReceivedEventTimestamp:0}};i.getPlaceholderDebugStats=function e(){return this.debugStats};i.isPlaceholderEnabled=function t(){const o=e.get("sap-ushell-config.apps.placeholder.enabled");if(o===false){return false}return a.getConfiguration().getPlaceholder()};return r}(i),C(g.prototype,"attachHideCallback",[c],Object.getOwnPropertyDescriptor(g.prototype,"attachHideCallback"),g.prototype),C(g.prototype,"attachRouteMatchers",[s],Object.getOwnPropertyDescriptor(g.prototype,"attachRouteMatchers"),g.prototype),C(g.prototype,"initPlaceholderDebug",[p],Object.getOwnPropertyDescriptor(g.prototype,"initPlaceholderDebug"),g.prototype),C(g.prototype,"isPlaceholderDebugEnabled",[h],Object.getOwnPropertyDescriptor(g.prototype,"isPlaceholderDebugEnabled"),g.prototype),C(g.prototype,"resetPlaceholderDebugStats",[u],Object.getOwnPropertyDescriptor(g.prototype,"resetPlaceholderDebugStats"),g.prototype),C(g.prototype,"getPlaceholderDebugStats",[d],Object.getOwnPropertyDescriptor(g.prototype,"getPlaceholderDebugStats"),g.prototype),C(g.prototype,"isPlaceholderEnabled",[f],Object.getOwnPropertyDescriptor(g.prototype,"isPlaceholderEnabled"),g.prototype),g))||b);return D},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Routing-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/ModelHelper", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution"], function (ClassSupport, ModelHelper, ControllerExtension, OverrideExecution) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  /**
   * A controller extension offering hooks into the routing flow of the application
   *
   * @hideconstructor
   * @public
   * @since 1.86.0
   */
  let Routing = (_dec = defineUI5Class("sap.fe.core.controllerextensions.Routing"), _dec2 = publicExtension(), _dec3 = extensible(OverrideExecution.After), _dec4 = publicExtension(), _dec5 = finalExtension(), _dec6 = publicExtension(), _dec7 = extensible(OverrideExecution.After), _dec8 = publicExtension(), _dec9 = extensible(OverrideExecution.After), _dec10 = publicExtension(), _dec11 = finalExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(Routing, _ControllerExtension);
    function Routing() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = Routing.prototype;
    /**
     * @private
     * @name sap.fe.core.controllerextensions.Routing.getMetadata
     * @function
     */
    /**
     * @private
     * @name sap.fe.core.controllerextensions.Routing.extend
     * @function
     */
    /**
     * This function can be used to intercept the routing event happening during the normal process of navigating from one page to another.
     *
     * If declared as an extension, it allows you to intercept and change the normal navigation flow.
     * If you decide to do your own navigation processing, you can return `true` to prevent the default routing behavior.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param mNavigationParameters Object containing row context and page context
     * @param mNavigationParameters.bindingContext The currently selected context
     * @returns `true` to prevent the default execution, false to keep the standard behavior
     * @alias sap.fe.core.controllerextensions.Routing#onBeforeNavigation
     * @public
     * @since 1.86.0
     */
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onBeforeNavigation = function onBeforeNavigation(mNavigationParameters) {
      // to be overriden by the application
      return false;
    }

    /**
     * Allows navigation to a specific context.
     *
     * @param oContext Object containing the context to be navigated to
     * @alias sap.fe.core.controllerextensions.Routing#navigate
     * @public
     * @since 1.90.0
     */;
    _proto.navigate = function navigate(oContext) {
      const internalModel = this.base.getModel("internal");
      // We have to delete the internal model value for "paginatorCurrentContext" to ensure it is re-evaluated by the navigateToContext function
      // BCP: 2270123820
      internalModel.setProperty("/paginatorCurrentContext", null);
      this.base._routing.navigateToContext(oContext);
    }

    /**
     * This function is used to intercept the routing event before binding a page.
     *
     * If it is declared as an extension, it allows you to intercept and change the normal flow of binding.
     *
     * This function is not called directly, but overridden separately by consuming controllers.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param oContext Object containing the context for the navigation
     * @alias sap.fe.core.controllerextensions.Routing#onBeforeBinding
     * @public
     * @since 1.90.0
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onBeforeBinding = function onBeforeBinding(oContext) {
      // to be overriden by the application
    }

    /**
     * This function is used to intercept the routing event after binding a page.
     *
     * If it is declared as an extension, it allows you to intercept and change the normal flow of binding.
     *
     * This function is not called directly, but overridden separately by consuming controllers.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param oContext Object containing the context to be navigated
     * @alias sap.fe.core.controllerextensions.Routing#onAfterBinding
     * @public
     * @since 1.90.0
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onAfterBinding = function onAfterBinding(oContext) {
      // to be overriden by the application
    }

    /**
     * Navigate to another target.
     *
     * @alias sap.fe.core.controllerextensions.Routing#navigateToRoute
     * @param sTargetRouteName Name of the target route
     * @param oParameters Parameters to be used with route to create the target hash
     * @returns Promise that is resolved when the navigation is finalized
     * @public
     */;
    _proto.navigateToRoute = function navigateToRoute(sTargetRouteName, oParameters) {
      const oMetaModel = this.base.getModel().getMetaModel();
      const bIsStickyMode = ModelHelper.isStickySessionSupported(oMetaModel);
      if (!oParameters) {
        oParameters = {};
      }
      oParameters.bIsStickyMode = bIsStickyMode;
      return this.base._routing.navigateToRoute(sTargetRouteName, oParameters);
    };
    return Routing;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onBeforeNavigation", [_dec2, _dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeNavigation"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigate", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "navigate"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeBinding", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeBinding"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onAfterBinding", [_dec8, _dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "onAfterBinding"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "navigateToRoute", [_dec10, _dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "navigateToRoute"), _class2.prototype)), _class2)) || _class);
  return Routing;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Routing", ["sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/ModelHelper","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution"],function(e,t,o,r){"use strict";var n,i,p,a,c,s,u,f,l,y,g,v,b;var d=e.publicExtension;var O=e.finalExtension;var B=e.extensible;var j=e.defineUI5Class;function h(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;P(e,t)}function P(e,t){P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return P(e,t)}function x(e,t,o,r,n){var i={};Object.keys(r).forEach(function(e){i[e]=r[e]});i.enumerable=!!i.enumerable;i.configurable=!!i.configurable;if("value"in i||i.initializer){i.writable=true}i=o.slice().reverse().reduce(function(o,r){return r(e,t,o)||o},i);if(n&&i.initializer!==void 0){i.value=i.initializer?i.initializer.call(n):void 0;i.initializer=undefined}if(i.initializer===void 0){Object.defineProperty(e,t,i);i=null}return i}let w=(n=j("sap.fe.core.controllerextensions.Routing"),i=d(),p=B(r.After),a=d(),c=O(),s=d(),u=B(r.After),f=d(),l=B(r.After),y=d(),g=O(),n(v=(b=function(e){h(o,e);function o(){return e.apply(this,arguments)||this}var r=o.prototype;r.onBeforeNavigation=function e(t){return false};r.navigate=function e(t){const o=this.base.getModel("internal");o.setProperty("/paginatorCurrentContext",null);this.base._routing.navigateToContext(t)};r.onBeforeBinding=function e(t){};r.onAfterBinding=function e(t){};r.navigateToRoute=function e(o,r){const n=this.base.getModel().getMetaModel();const i=t.isStickySessionSupported(n);if(!r){r={}}r.bIsStickyMode=i;return this.base._routing.navigateToRoute(o,r)};return o}(o),x(b.prototype,"onBeforeNavigation",[i,p],Object.getOwnPropertyDescriptor(b.prototype,"onBeforeNavigation"),b.prototype),x(b.prototype,"navigate",[a,c],Object.getOwnPropertyDescriptor(b.prototype,"navigate"),b.prototype),x(b.prototype,"onBeforeBinding",[s,u],Object.getOwnPropertyDescriptor(b.prototype,"onBeforeBinding"),b.prototype),x(b.prototype,"onAfterBinding",[f,l],Object.getOwnPropertyDescriptor(b.prototype,"onAfterBinding"),b.prototype),x(b.prototype,"navigateToRoute",[y,g],Object.getOwnPropertyDescriptor(b.prototype,"navigateToRoute"),b.prototype),b))||v);return w},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/RoutingListener-dbg", ["sap/fe/core/controllerextensions/InternalRouting"], function (InternalRouting) {
  "use strict";

  return InternalRouting;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/RoutingListener", ["sap/fe/core/controllerextensions/InternalRouting"],function(e){"use strict";return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Share-dbg", ["sap/base/Log", "sap/base/util/extend", "sap/base/util/ObjectPath", "sap/fe/core/helpers/ClassSupport", "sap/m/library", "sap/ui/core/Core", "sap/ui/core/Fragment", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "sap/ui/core/routing/HashChanger", "sap/ui/core/util/XMLPreprocessor", "sap/ui/core/XMLTemplateProcessor", "sap/ui/model/json/JSONModel"], function (Log, extend, ObjectPath, ClassSupport, library, Core, Fragment, ControllerExtension, OverrideExecution, HashChanger, XMLPreprocessor, XMLTemplateProcessor, JSONModel) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var methodOverride = ClassSupport.methodOverride;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  let oLastFocusedControl;

  /**
   * A controller extension offering hooks into the routing flow of the application
   *
   * @hideconstructor
   * @public
   * @since 1.86.0
   */
  let ShareUtils = (_dec = defineUI5Class("sap.fe.core.controllerextensions.Share"), _dec2 = methodOverride(), _dec3 = methodOverride(), _dec4 = publicExtension(), _dec5 = finalExtension(), _dec6 = publicExtension(), _dec7 = extensible(OverrideExecution.After), _dec8 = publicExtension(), _dec9 = finalExtension(), _dec10 = publicExtension(), _dec11 = finalExtension(), _dec12 = publicExtension(), _dec13 = finalExtension(), _dec14 = publicExtension(), _dec15 = finalExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(ShareUtils, _ControllerExtension);
    function ShareUtils() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = ShareUtils.prototype;
    _proto.onInit = function onInit() {
      const collaborationInfoModel = new JSONModel({
        url: "",
        appTitle: "",
        subTitle: "",
        minifyUrlForChat: true
      });
      this.base.getView().setModel(collaborationInfoModel, "collaborationInfo");
    };
    _proto.onExit = function onExit() {
      var _this$base, _this$base$getView;
      const collaborationInfoModel = (_this$base = this.base) === null || _this$base === void 0 ? void 0 : (_this$base$getView = _this$base.getView()) === null || _this$base$getView === void 0 ? void 0 : _this$base$getView.getModel("collaborationInfo");
      if (collaborationInfoModel) {
        collaborationInfoModel.destroy();
      }
    }
    /**
     * Opens the share sheet.
     *
     * @function
     * @param oControl The control to which the ActionSheet is opened.
     * @alias sap.fe.core.controllerextensions.Share#openShareSheet
     * @public
     * @since 1.93.0
     */;
    _proto.openShareSheet = function openShareSheet(oControl) {
      this._openShareSheetImpl(oControl);
    }
    /**
     * Adapts the metadata used while sharing the page URL via 'Send Email', 'Share in SAP Jam', and 'Save as Tile'.
     *
     * @function
     * @param oShareMetadata Object containing the share metadata.
     * @param oShareMetadata.url Default URL that will be used via 'Send Email', 'Share in SAP Jam', and 'Save as Tile'
     * @param oShareMetadata.title Default title that will be used as 'email subject' in 'Send Email', 'share text' in 'Share in SAP Jam' and 'title' in 'Save as Tile'
     * @param oShareMetadata.email Email-specific metadata.
     * @param oShareMetadata.email.url URL that will be used specifically for 'Send Email'. This takes precedence over oShareMetadata.url.
     * @param oShareMetadata.email.title Title that will be used as "email subject" in 'Send Email'. This takes precedence over oShareMetadata.title.
     * @param oShareMetadata.jam SAP Jam-specific metadata.
     * @param oShareMetadata.jam.url URL that will be used specifically for 'Share in SAP Jam'. This takes precedence over oShareMetadata.url.
     * @param oShareMetadata.jam.title Title that will be used as 'share text' in 'Share in SAP Jam'. This takes precedence over oShareMetadata.title.
     * @param oShareMetadata.tile Save as Tile-specific metadata.
     * @param oShareMetadata.tile.url URL that will be used specifically for 'Save as Tile'. This takes precedence over oShareMetadata.url.
     * @param oShareMetadata.tile.title Title to be used for the tile. This takes precedence over oShareMetadata.title.
     * @param oShareMetadata.tile.subtitle Subtitle to be used for the tile.
     * @param oShareMetadata.tile.icon Icon to be used for the tile.
     * @param oShareMetadata.tile.queryUrl Query URL of an OData service from which data for a dynamic tile is read.
     * @returns Share Metadata or a Promise resolving the Share Metadata
     * @alias sap.fe.core.controllerextensions.Share#adaptShareMetadata
     * @public
     * @since 1.93.0
     */;
    _proto.adaptShareMetadata = function adaptShareMetadata(oShareMetadata) {
      return oShareMetadata;
    };
    _proto._openShareSheetImpl = async function _openShareSheetImpl(by) {
      let oShareActionSheet;
      const sHash = HashChanger.getInstance().getHash(),
        sBasePath = HashChanger.getInstance().hrefForAppSpecificHash ? HashChanger.getInstance().hrefForAppSpecificHash("") : "",
        oShareMetadata = {
          url: window.location.origin + window.location.pathname + window.location.search + (sHash ? sBasePath + sHash : window.location.hash),
          title: document.title,
          email: {
            url: "",
            title: ""
          },
          jam: {
            url: "",
            title: ""
          },
          tile: {
            url: "",
            title: "",
            subtitle: "",
            icon: "",
            queryUrl: ""
          }
        };
      oLastFocusedControl = by;
      const setShareEmailData = function (shareActionSheet, oModelData) {
        const oShareMailModel = shareActionSheet.getModel("shareData");
        const oNewMailData = extend(oShareMailModel.getData(), oModelData);
        oShareMailModel.setData(oNewMailData);
      };
      try {
        const oModelData = await Promise.resolve(this.adaptShareMetadata(oShareMetadata));
        const fragmentController = {
          shareEmailPressed: function () {
            const oMailModel = oShareActionSheet.getModel("shareData");
            const oMailData = oMailModel.getData();
            const oResource = Core.getLibraryResourceBundle("sap.fe.core");
            const sEmailSubject = oMailData.email.title ? oMailData.email.title : oResource.getText("T_SHARE_UTIL_HELPER_SAPFE_EMAIL_SUBJECT", [oMailData.title]);
            library.URLHelper.triggerEmail(undefined, sEmailSubject, oMailData.email.url ? oMailData.email.url : oMailData.url);
          },
          shareMSTeamsPressed: function () {
            const msTeamsModel = oShareActionSheet.getModel("shareData");
            const msTeamsData = msTeamsModel.getData();
            const message = msTeamsData.email.title ? msTeamsData.email.title : msTeamsData.title;
            const url = msTeamsData.email.url ? msTeamsData.email.url : msTeamsData.url;
            const newWindowOpen = window.open("", "ms-teams-share-popup", "width=700,height=600");
            newWindowOpen.opener = null;
            newWindowOpen.location = `https://teams.microsoft.com/share?msgText=${encodeURIComponent(message)}&href=${encodeURIComponent(url)}`;
          },
          onSaveTilePress: function () {
            // TODO it seems that the press event is executed before the dialog is available - adding a timeout is a cheap workaround
            setTimeout(function () {
              var _Core$byId;
              (_Core$byId = Core.byId("bookmarkDialog")) === null || _Core$byId === void 0 ? void 0 : _Core$byId.attachAfterClose(function () {
                oLastFocusedControl.focus();
              });
            }, 0);
          },
          shareJamPressed: () => {
            this._doOpenJamShareDialog(oModelData.jam.title ? oModelData.jam.title : oModelData.title, oModelData.jam.url ? oModelData.jam.url : oModelData.url);
          }
        };
        fragmentController.onCancelPressed = function () {
          oShareActionSheet.close();
        };
        fragmentController.setShareSheet = function (oShareSheet) {
          by.shareSheet = oShareSheet;
        };
        const oThis = new JSONModel({});
        const oPreprocessorSettings = {
          bindingContexts: {
            this: oThis.createBindingContext("/")
          },
          models: {
            this: oThis
          }
        };
        const oTileData = {
          title: oModelData.tile.title ? oModelData.tile.title : oModelData.title,
          subtitle: oModelData.tile.subtitle,
          icon: oModelData.tile.icon,
          url: oModelData.tile.url ? oModelData.tile.url : oModelData.url.substring(oModelData.url.indexOf("#")),
          queryUrl: oModelData.tile.queryUrl
        };
        if (by.shareSheet) {
          oShareActionSheet = by.shareSheet;
          const oShareModel = oShareActionSheet.getModel("share");
          this._setStaticShareData(oShareModel);
          const oNewData = extend(oShareModel.getData(), oTileData);
          oShareModel.setData(oNewData);
          setShareEmailData(oShareActionSheet, oModelData);
          oShareActionSheet.openBy(by);
        } else {
          const sFragmentName = "sap.fe.macros.share.ShareSheet";
          const oPopoverFragment = XMLTemplateProcessor.loadTemplate(sFragmentName, "fragment");
          try {
            const oFragment = await Promise.resolve(XMLPreprocessor.process(oPopoverFragment, {
              name: sFragmentName
            }, oPreprocessorSettings));
            oShareActionSheet = await Fragment.load({
              definition: oFragment,
              controller: fragmentController
            });
            oShareActionSheet.setModel(new JSONModel(oTileData || {}), "share");
            const oShareModel = oShareActionSheet.getModel("share");
            this._setStaticShareData(oShareModel);
            const oNewData = extend(oShareModel.getData(), oTileData);
            oShareModel.setData(oNewData);
            oShareActionSheet.setModel(new JSONModel(oModelData || {}), "shareData");
            setShareEmailData(oShareActionSheet, oModelData);
            by.addDependent(oShareActionSheet);
            oShareActionSheet.openBy(by);
            fragmentController.setShareSheet(oShareActionSheet);
          } catch (oError) {
            Log.error("Error while opening the share fragment", oError);
          }
        }
      } catch (oError) {
        Log.error("Error while fetching the share model data", oError);
      }
    };
    _proto._setStaticShareData = function _setStaticShareData(shareModel) {
      const oResource = Core.getLibraryResourceBundle("sap.fe.core");
      shareModel.setProperty("/jamButtonText", oResource.getText("T_COMMON_SAPFE_SHARE_JAM"));
      shareModel.setProperty("/emailButtonText", oResource.getText("T_SEMANTIC_CONTROL_SEND_EMAIL"));
      shareModel.setProperty("/msTeamsShareButtonText", oResource.getText("T_COMMON_SAPFE_SHARE_MSTEAMS"));
      // Share to Microsoft Teams is feature which for now only gets enabled for selected customers.
      // The switch "sapHorizonEnabled" and check for it was aligned with the Fiori launchpad team.
      if (ObjectPath.get("sap-ushell-config.renderers.fiori2.componentData.config.sapHorizonEnabled") === true) {
        shareModel.setProperty("/msTeamsVisible", true);
      } else {
        shareModel.setProperty("/msTeamsVisible", false);
      }
      const fnGetUser = ObjectPath.get("sap.ushell.Container.getUser");
      shareModel.setProperty("/jamVisible", !!fnGetUser && fnGetUser().isJamActive());
      shareModel.setProperty("/saveAsTileVisible", !!(sap && sap.ushell && sap.ushell.Container));
    }
    //the actual opening of the JAM share dialog
    ;
    _proto._doOpenJamShareDialog = function _doOpenJamShareDialog(text, sUrl) {
      const oShareDialog = Core.createComponent({
        name: "sap.collaboration.components.fiori.sharing.dialog",
        settings: {
          object: {
            id: sUrl,
            share: text
          }
        }
      });
      oShareDialog.open();
    }
    /**
     * Triggers the email flow.
     *
     * @returns {void}
     * @private
     */;
    _proto._triggerEmail = async function _triggerEmail() {
      const shareMetadata = await this._adaptShareMetadata();
      const oResource = Core.getLibraryResourceBundle("sap.fe.core");
      const sEmailSubject = shareMetadata.email.title ? shareMetadata.email.title : oResource.getText("T_SHARE_UTIL_HELPER_SAPFE_EMAIL_SUBJECT", [shareMetadata.title]);
      library.URLHelper.triggerEmail(undefined, sEmailSubject, shareMetadata.email.url ? shareMetadata.email.url : shareMetadata.url);
    }
    /**
     * Triggers the share to jam flow.
     *
     * @returns {void}
     * @private
     */;
    _proto._triggerShareToJam = async function _triggerShareToJam() {
      const shareMetadata = await this._adaptShareMetadata();
      this._doOpenJamShareDialog(shareMetadata.jam.title ? shareMetadata.jam.title : shareMetadata.title, shareMetadata.jam.url ? shareMetadata.jam.url : window.location.origin + window.location.pathname + shareMetadata.url);
    }
    /**
     * Triggers the save as tile flow.
     *
     * @param [source]
     * @returns {void}
     * @private
     */;
    _proto._saveAsTile = async function _saveAsTile(source) {
      const shareMetadata = await this._adaptShareMetadata(),
        internalAddBookmarkButton = source.getDependents()[0],
        sHash = HashChanger.getInstance().getHash(),
        sBasePath = HashChanger.getInstance().hrefForAppSpecificHash ? HashChanger.getInstance().hrefForAppSpecificHash("") : "";
      shareMetadata.url = sHash ? sBasePath + sHash : window.location.hash;

      // set AddBookmarkButton properties
      internalAddBookmarkButton.setTitle(shareMetadata.tile.title ? shareMetadata.tile.title : shareMetadata.title);
      internalAddBookmarkButton.setSubtitle(shareMetadata.tile.subtitle);
      internalAddBookmarkButton.setTileIcon(shareMetadata.tile.icon);
      internalAddBookmarkButton.setCustomUrl(shareMetadata.tile.url ? shareMetadata.tile.url : shareMetadata.url);
      internalAddBookmarkButton.setServiceUrl(shareMetadata.tile.queryUrl);

      // addBookmarkButton fire press
      internalAddBookmarkButton.firePress();
    }
    /**
     * Call the adaptShareMetadata extension.
     *
     * @returns {object} Share Metadata
     * @private
     */;
    _proto._adaptShareMetadata = function _adaptShareMetadata() {
      const sHash = HashChanger.getInstance().getHash(),
        sBasePath = HashChanger.getInstance().hrefForAppSpecificHash ? HashChanger.getInstance().hrefForAppSpecificHash("") : "",
        oShareMetadata = {
          url: window.location.origin + window.location.pathname + window.location.search + (sHash ? sBasePath + sHash : window.location.hash),
          title: document.title,
          email: {
            url: "",
            title: ""
          },
          jam: {
            url: "",
            title: ""
          },
          tile: {
            url: "",
            title: "",
            subtitle: "",
            icon: "",
            queryUrl: ""
          }
        };
      return this.adaptShareMetadata(oShareMetadata);
    };
    return ShareUtils;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onExit", [_dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "onExit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "openShareSheet", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "openShareSheet"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "adaptShareMetadata", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "adaptShareMetadata"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "_triggerEmail", [_dec8, _dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "_triggerEmail"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "_triggerShareToJam", [_dec10, _dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "_triggerShareToJam"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "_saveAsTile", [_dec12, _dec13], Object.getOwnPropertyDescriptor(_class2.prototype, "_saveAsTile"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "_adaptShareMetadata", [_dec14, _dec15], Object.getOwnPropertyDescriptor(_class2.prototype, "_adaptShareMetadata"), _class2.prototype)), _class2)) || _class);
  return ShareUtils;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/Share", ["sap/base/Log","sap/base/util/extend","sap/base/util/ObjectPath","sap/fe/core/helpers/ClassSupport","sap/m/library","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","sap/ui/core/routing/HashChanger","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/model/json/JSONModel"],function(e,t,o,r,a,i,n,s,l,c,p,u,h){"use strict";var d,m,g,f,S,y,b,_,w,T,E,O,v,M,P,D,j;var A=r.publicExtension;var I=r.methodOverride;var x=r.finalExtension;var C=r.extensible;var H=r.defineUI5Class;function U(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;L(e,t)}function L(e,t){L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return L(e,t)}function R(e,t,o,r,a){var i={};Object.keys(r).forEach(function(e){i[e]=r[e]});i.enumerable=!!i.enumerable;i.configurable=!!i.configurable;if("value"in i||i.initializer){i.writable=true}i=o.slice().reverse().reduce(function(o,r){return r(e,t,o)||o},i);if(a&&i.initializer!==void 0){i.value=i.initializer?i.initializer.call(a):void 0;i.initializer=undefined}if(i.initializer===void 0){Object.defineProperty(e,t,i);i=null}return i}let F;let J=(d=H("sap.fe.core.controllerextensions.Share"),m=I(),g=I(),f=A(),S=x(),y=A(),b=C(l.After),_=A(),w=x(),T=A(),E=x(),O=A(),v=x(),M=A(),P=x(),d(D=(j=function(r){U(s,r);function s(){return r.apply(this,arguments)||this}var l=s.prototype;l.onInit=function e(){const t=new h({url:"",appTitle:"",subTitle:"",minifyUrlForChat:true});this.base.getView().setModel(t,"collaborationInfo")};l.onExit=function e(){var t,o;const r=(t=this.base)===null||t===void 0?void 0:(o=t.getView())===null||o===void 0?void 0:o.getModel("collaborationInfo");if(r){r.destroy()}};l.openShareSheet=function e(t){this._openShareSheetImpl(t)};l.adaptShareMetadata=function e(t){return t};l._openShareSheetImpl=async function o(r){let s;const l=c.getInstance().getHash(),d=c.getInstance().hrefForAppSpecificHash?c.getInstance().hrefForAppSpecificHash(""):"",m={url:window.location.origin+window.location.pathname+window.location.search+(l?d+l:window.location.hash),title:document.title,email:{url:"",title:""},jam:{url:"",title:""},tile:{url:"",title:"",subtitle:"",icon:"",queryUrl:""}};F=r;const g=function(e,o){const r=e.getModel("shareData");const a=t(r.getData(),o);r.setData(a)};try{const o=await Promise.resolve(this.adaptShareMetadata(m));const l={shareEmailPressed:function(){const e=s.getModel("shareData");const t=e.getData();const o=i.getLibraryResourceBundle("sap.fe.core");const r=t.email.title?t.email.title:o.getText("T_SHARE_UTIL_HELPER_SAPFE_EMAIL_SUBJECT",[t.title]);a.URLHelper.triggerEmail(undefined,r,t.email.url?t.email.url:t.url)},shareMSTeamsPressed:function(){const e=s.getModel("shareData");const t=e.getData();const o=t.email.title?t.email.title:t.title;const r=t.email.url?t.email.url:t.url;const a=window.open("","ms-teams-share-popup","width=700,height=600");a.opener=null;a.location=`https://teams.microsoft.com/share?msgText=${encodeURIComponent(o)}&href=${encodeURIComponent(r)}`},onSaveTilePress:function(){setTimeout(function(){var e;(e=i.byId("bookmarkDialog"))===null||e===void 0?void 0:e.attachAfterClose(function(){F.focus()})},0)},shareJamPressed:()=>{this._doOpenJamShareDialog(o.jam.title?o.jam.title:o.title,o.jam.url?o.jam.url:o.url)}};l.onCancelPressed=function(){s.close()};l.setShareSheet=function(e){r.shareSheet=e};const c=new h({});const d={bindingContexts:{this:c.createBindingContext("/")},models:{this:c}};const f={title:o.tile.title?o.tile.title:o.title,subtitle:o.tile.subtitle,icon:o.tile.icon,url:o.tile.url?o.tile.url:o.url.substring(o.url.indexOf("#")),queryUrl:o.tile.queryUrl};if(r.shareSheet){s=r.shareSheet;const e=s.getModel("share");this._setStaticShareData(e);const a=t(e.getData(),f);e.setData(a);g(s,o);s.openBy(r)}else{const a="sap.fe.macros.share.ShareSheet";const i=u.loadTemplate(a,"fragment");try{const e=await Promise.resolve(p.process(i,{name:a},d));s=await n.load({definition:e,controller:l});s.setModel(new h(f||{}),"share");const c=s.getModel("share");this._setStaticShareData(c);const u=t(c.getData(),f);c.setData(u);s.setModel(new h(o||{}),"shareData");g(s,o);r.addDependent(s);s.openBy(r);l.setShareSheet(s)}catch(t){e.error("Error while opening the share fragment",t)}}}catch(t){e.error("Error while fetching the share model data",t)}};l._setStaticShareData=function e(t){const r=i.getLibraryResourceBundle("sap.fe.core");t.setProperty("/jamButtonText",r.getText("T_COMMON_SAPFE_SHARE_JAM"));t.setProperty("/emailButtonText",r.getText("T_SEMANTIC_CONTROL_SEND_EMAIL"));t.setProperty("/msTeamsShareButtonText",r.getText("T_COMMON_SAPFE_SHARE_MSTEAMS"));if(o.get("sap-ushell-config.renderers.fiori2.componentData.config.sapHorizonEnabled")===true){t.setProperty("/msTeamsVisible",true)}else{t.setProperty("/msTeamsVisible",false)}const a=o.get("sap.ushell.Container.getUser");t.setProperty("/jamVisible",!!a&&a().isJamActive());t.setProperty("/saveAsTileVisible",!!(sap&&sap.ushell&&sap.ushell.Container))};l._doOpenJamShareDialog=function e(t,o){const r=i.createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:o,share:t}}});r.open()};l._triggerEmail=async function e(){const t=await this._adaptShareMetadata();const o=i.getLibraryResourceBundle("sap.fe.core");const r=t.email.title?t.email.title:o.getText("T_SHARE_UTIL_HELPER_SAPFE_EMAIL_SUBJECT",[t.title]);a.URLHelper.triggerEmail(undefined,r,t.email.url?t.email.url:t.url)};l._triggerShareToJam=async function e(){const t=await this._adaptShareMetadata();this._doOpenJamShareDialog(t.jam.title?t.jam.title:t.title,t.jam.url?t.jam.url:window.location.origin+window.location.pathname+t.url)};l._saveAsTile=async function e(t){const o=await this._adaptShareMetadata(),r=t.getDependents()[0],a=c.getInstance().getHash(),i=c.getInstance().hrefForAppSpecificHash?c.getInstance().hrefForAppSpecificHash(""):"";o.url=a?i+a:window.location.hash;r.setTitle(o.tile.title?o.tile.title:o.title);r.setSubtitle(o.tile.subtitle);r.setTileIcon(o.tile.icon);r.setCustomUrl(o.tile.url?o.tile.url:o.url);r.setServiceUrl(o.tile.queryUrl);r.firePress()};l._adaptShareMetadata=function e(){const t=c.getInstance().getHash(),o=c.getInstance().hrefForAppSpecificHash?c.getInstance().hrefForAppSpecificHash(""):"",r={url:window.location.origin+window.location.pathname+window.location.search+(t?o+t:window.location.hash),title:document.title,email:{url:"",title:""},jam:{url:"",title:""},tile:{url:"",title:"",subtitle:"",icon:"",queryUrl:""}};return this.adaptShareMetadata(r)};return s}(s),R(j.prototype,"onInit",[m],Object.getOwnPropertyDescriptor(j.prototype,"onInit"),j.prototype),R(j.prototype,"onExit",[g],Object.getOwnPropertyDescriptor(j.prototype,"onExit"),j.prototype),R(j.prototype,"openShareSheet",[f,S],Object.getOwnPropertyDescriptor(j.prototype,"openShareSheet"),j.prototype),R(j.prototype,"adaptShareMetadata",[y,b],Object.getOwnPropertyDescriptor(j.prototype,"adaptShareMetadata"),j.prototype),R(j.prototype,"_triggerEmail",[_,w],Object.getOwnPropertyDescriptor(j.prototype,"_triggerEmail"),j.prototype),R(j.prototype,"_triggerShareToJam",[T,E],Object.getOwnPropertyDescriptor(j.prototype,"_triggerShareToJam"),j.prototype),R(j.prototype,"_saveAsTile",[O,v],Object.getOwnPropertyDescriptor(j.prototype,"_saveAsTile"),j.prototype),R(j.prototype,"_adaptShareMetadata",[M,P],Object.getOwnPropertyDescriptor(j.prototype,"_adaptShareMetadata"),j.prototype),j))||D);return J},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/SideEffects-dbg", ["sap/base/Log", "sap/fe/core/helpers/SideEffectsHelper", "sap/ui/core/mvc/ControllerExtension", "../CommonUtils", "../helpers/ClassSupport"], function (Log, SideEffectsHelper, ControllerExtension, CommonUtils, ClassSupport) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _dec22, _dec23, _dec24, _dec25, _dec26, _dec27, _dec28, _dec29, _dec30, _dec31, _dec32, _dec33, _dec34, _dec35, _dec36, _dec37, _dec38, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var privateExtension = ClassSupport.privateExtension;
  var methodOverride = ClassSupport.methodOverride;
  var finalExtension = ClassSupport.finalExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  let SideEffectsControllerExtension = (_dec = defineUI5Class("sap.fe.core.controllerextensions.SideEffects"), _dec2 = methodOverride(), _dec3 = publicExtension(), _dec4 = finalExtension(), _dec5 = publicExtension(), _dec6 = finalExtension(), _dec7 = publicExtension(), _dec8 = finalExtension(), _dec9 = publicExtension(), _dec10 = finalExtension(), _dec11 = publicExtension(), _dec12 = finalExtension(), _dec13 = publicExtension(), _dec14 = finalExtension(), _dec15 = publicExtension(), _dec16 = finalExtension(), _dec17 = publicExtension(), _dec18 = finalExtension(), _dec19 = publicExtension(), _dec20 = finalExtension(), _dec21 = publicExtension(), _dec22 = finalExtension(), _dec23 = publicExtension(), _dec24 = finalExtension(), _dec25 = publicExtension(), _dec26 = finalExtension(), _dec27 = privateExtension(), _dec28 = finalExtension(), _dec29 = publicExtension(), _dec30 = finalExtension(), _dec31 = privateExtension(), _dec32 = finalExtension(), _dec33 = privateExtension(), _dec34 = finalExtension(), _dec35 = privateExtension(), _dec36 = finalExtension(), _dec37 = publicExtension(), _dec38 = finalExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(SideEffectsControllerExtension, _ControllerExtension);
    function SideEffectsControllerExtension() {
      return _ControllerExtension.apply(this, arguments) || this;
    }
    var _proto = SideEffectsControllerExtension.prototype;
    _proto.onInit = function onInit() {
      this._view = this.base.getView();
      this._sideEffectsService = CommonUtils.getAppComponent(this._view).getSideEffectsService();
      this._registeredFieldGroupMap = {};
      this._fieldGroupInvalidity = {};
      this._registeredFailedSideEffects = {};
    }

    /**
     * Adds a SideEffects control.
     *
     * @function
     * @name addControlSideEffects
     * @param entityType Name of the entity where the SideEffects control will be registered
     * @param controlSideEffects SideEffects to register. Ensure the sourceControlId matches the associated SAPUI5 control ID.
     */;
    _proto.addControlSideEffects = function addControlSideEffects(entityType, controlSideEffects) {
      this._sideEffectsService.addControlSideEffects(entityType, controlSideEffects);
    }

    /**
     * Removes SideEffects created by a control.
     *
     * @function
     * @name removeControlSideEffects
     * @param control SAPUI5 Control
     */;
    _proto.removeControlSideEffects = function removeControlSideEffects(control) {
      var _control$isA;
      const controlId = ((_control$isA = control.isA) === null || _control$isA === void 0 ? void 0 : _control$isA.call(control, "sap.ui.base.ManagedObject")) && control.getId();
      if (controlId) {
        this._sideEffectsService.removeControlSideEffects(controlId);
      }
    }

    /**
     * Gets the appropriate context on which SideEffects can be requested.
     * The correct one must have the binding parameter $$patchWithoutSideEffects.
     *
     * @function
     * @name getContextForSideEffects
     * @param bindingContext Initial binding context
     * @param sideEffectEntityType EntityType of the sideEffects
     * @returns SAPUI5 Context or undefined
     */;
    _proto.getContextForSideEffects = function getContextForSideEffects(bindingContext, sideEffectEntityType) {
      let contextForSideEffects = bindingContext,
        entityType = this._sideEffectsService.getEntityTypeFromContext(bindingContext);
      if (sideEffectEntityType !== entityType) {
        contextForSideEffects = bindingContext.getBinding().getContext();
        if (contextForSideEffects) {
          entityType = this._sideEffectsService.getEntityTypeFromContext(contextForSideEffects);
          if (sideEffectEntityType !== entityType) {
            contextForSideEffects = contextForSideEffects.getBinding().getContext();
            if (contextForSideEffects) {
              entityType = this._sideEffectsService.getEntityTypeFromContext(contextForSideEffects);
              if (sideEffectEntityType !== entityType) {
                return undefined;
              }
            }
          }
        }
      }
      return contextForSideEffects || undefined;
    }

    /**
     * Gets the SideEffects map for a field
     * These SideEffects are
     * - listed into FieldGroupIds (coming from an OData Service)
     * - generated by a control or controls and that configure this field as SourceProperties.
     *
     * @function
     * @name getFieldSideEffectsMap
     * @param field Field control
     * @returns SideEffects map
     */;
    _proto.getFieldSideEffectsMap = function getFieldSideEffectsMap(field) {
      let sideEffectsMap = {};
      const fieldGroupIds = field.getFieldGroupIds(),
        viewEntitySetSetName = this._view.getViewData().entitySet,
        viewEntitySet = this._sideEffectsService.getConvertedMetaModel().entitySets.find(entitySet => {
          return entitySet.name === viewEntitySetSetName;
        });

      // SideEffects coming from an OData Service
      sideEffectsMap = this.getSideEffectsMapForFieldGroups(fieldGroupIds, field);

      // SideEffects coming from control(s)
      if (viewEntitySetSetName && viewEntitySet) {
        const viewEntityType = viewEntitySet.entityType.fullyQualifiedName,
          fieldPath = this.getTargetProperty(field),
          context = this.getContextForSideEffects(field.getBindingContext(), viewEntityType);
        if (fieldPath && context) {
          const controlSideEffectsEntityType = this._sideEffectsService.getControlEntitySideEffects(viewEntityType);
          Object.keys(controlSideEffectsEntityType).forEach(sideEffectsName => {
            const oControlSideEffects = controlSideEffectsEntityType[sideEffectsName];
            if (oControlSideEffects.SourceProperties.includes(fieldPath)) {
              const name = `${sideEffectsName}::${viewEntityType}`;
              sideEffectsMap[name] = {
                name: name,
                immediate: true,
                sideEffects: oControlSideEffects,
                context: context
              };
            }
          });
        }
      }
      return sideEffectsMap;
    }

    /**
     * Gets the sideEffects map for fieldGroups.
     *
     * @function
     * @name getSideEffectsMapForFieldGroups
     * @param fieldGroupIds Field group ids
     * @param field Field control
     * @returns SideEffects map
     */;
    _proto.getSideEffectsMapForFieldGroups = function getSideEffectsMapForFieldGroups(fieldGroupIds, field) {
      const mSideEffectsMap = {};
      fieldGroupIds.forEach(fieldGroupId => {
        const {
          name,
          immediate,
          sideEffects,
          sideEffectEntityType
        } = this._getSideEffectsPropertyForFieldGroup(fieldGroupId);
        const oContext = field ? this.getContextForSideEffects(field.getBindingContext(), sideEffectEntityType) : undefined;
        if (sideEffects && (!field || field && oContext)) {
          mSideEffectsMap[name] = {
            name,
            immediate,
            sideEffects
          };
          if (field) {
            mSideEffectsMap[name].context = oContext;
          }
        }
      });
      return mSideEffectsMap;
    }

    /**
     * Clear recorded validation status for all properties.
     *
     * @function
     * @name clearFieldGroupsValidity
     */;
    _proto.clearFieldGroupsValidity = function clearFieldGroupsValidity() {
      this._fieldGroupInvalidity = {};
    }

    /**
     * Clear recorded validation status for all properties.
     *
     * @function
     * @name isFieldGroupValid
     * @param fieldGroupId Field group id
     * @param context Context
     * @returns SAPUI5 Context or undefined
     */;
    _proto.isFieldGroupValid = function isFieldGroupValid(fieldGroupId, context) {
      const id = this._getFieldGroupIndex(fieldGroupId, context);
      return Object.keys(this._fieldGroupInvalidity[id] ?? {}).length === 0;
    }

    /**
     * Gets the relative target property related to the Field.
     *
     * @function
     * @name getTargetProperty
     * @param field Field control
     * @returns Relative target property
     */;
    _proto.getTargetProperty = function getTargetProperty(field) {
      var _this$_view$getBindin;
      const fieldPath = field.data("sourcePath");
      const metaModel = this._view.getModel().getMetaModel();
      const viewBindingPath = (_this$_view$getBindin = this._view.getBindingContext()) === null || _this$_view$getBindin === void 0 ? void 0 : _this$_view$getBindin.getPath();
      const viewMetaModelPath = viewBindingPath ? `${metaModel.getMetaPath(viewBindingPath)}/` : "";
      return fieldPath === null || fieldPath === void 0 ? void 0 : fieldPath.replace(viewMetaModelPath, "");
    }

    /**
     * Manages the workflow for SideEffects with related changes to a field
     * The following scenarios are managed:
     *  - Execute: triggers immediate SideEffects requests if the promise for the field event is fulfilled
     *  - Register: caches deferred SideEffects that will be executed when the FieldGroup is unfocused.
     *
     * @function
     * @name handleFieldChange
     * @param event SAPUI5 event that comes from a field change
     * @param fieldValidity
     * @param fieldGroupPreRequisite Promise to be fulfilled before executing deferred SideEffects
     * @returns  Promise on SideEffects request(s)
     */;
    _proto.handleFieldChange = async function handleFieldChange(event, fieldValidity, fieldGroupPreRequisite) {
      const field = event.getSource();
      this._saveFieldPropertiesStatus(field, fieldValidity);
      if (!fieldValidity) {
        return;
      }
      try {
        await (event.getParameter("promise") ?? Promise.resolve());
      } catch (e) {
        Log.debug("Prerequisites on Field for the SideEffects have been rejected", e);
        return;
      }
      return this._manageSideEffectsFromField(field, fieldGroupPreRequisite ?? Promise.resolve());
    }

    /**
     * Manages SideEffects with a related 'focus out' to a field group.
     *
     * @function
     * @name handleFieldGroupChange
     * @param event SAPUI5 Event
     * @returns Promise returning true if the SideEffects have been successfully executed
     */;
    _proto.handleFieldGroupChange = function handleFieldGroupChange(event) {
      const field = event.getSource(),
        fieldGroupIds = event.getParameter("fieldGroupIds"),
        fieldGroupsSideEffects = fieldGroupIds.reduce((results, fieldGroupId) => {
          return results.concat(this.getRegisteredSideEffectsForFieldGroup(fieldGroupId));
        }, []);
      return Promise.all(fieldGroupsSideEffects.map(fieldGroupSideEffects => {
        return this._requestFieldGroupSideEffects(fieldGroupSideEffects);
      })).catch(error => {
        var _field$getBindingCont;
        const contextPath = (_field$getBindingCont = field.getBindingContext()) === null || _field$getBindingCont === void 0 ? void 0 : _field$getBindingCont.getPath();
        Log.debug(`Error while processing FieldGroup SideEffects on context ${contextPath}`, error);
      });
    }

    /**
     * Request SideEffects on a specific context.
     *
     * @function
     * @name requestSideEffects
     * @param sideEffects SideEffects to be executed
     * @param context Context where SideEffects need to be executed
     * @param groupId
     * @param fnGetTargets The callback function which will give us the targets and actions if it was coming through some specific handling.
     * @returns SideEffects request on SAPUI5 context
     */;
    _proto.requestSideEffects = async function requestSideEffects(sideEffects, context, groupId, fnGetTargets) {
      let targets, triggerAction;
      if (fnGetTargets) {
        const targetsAndActionData = await fnGetTargets(sideEffects);
        targets = targetsAndActionData["aTargets"];
        triggerAction = targetsAndActionData["TriggerAction"];
      } else {
        targets = [...(sideEffects.TargetEntities ?? []), ...(sideEffects.TargetProperties ?? [])];
        triggerAction = sideEffects.TriggerAction;
      }
      if (triggerAction) {
        this._sideEffectsService.executeAction(triggerAction, context, groupId);
      }
      if (targets.length) {
        return this._sideEffectsService.requestSideEffects(targets, context, groupId).catch(error => {
          this.registerFailedSideEffects(sideEffects, context);
          throw error;
        });
      }
    }

    /**
     * Gets failed SideEffects.
     *
     * @function
     * @name getRegisteredFailedRequests
     * @returns Registered SideEffects requests that have failed
     */;
    _proto.getRegisteredFailedRequests = function getRegisteredFailedRequests() {
      return this._registeredFailedSideEffects;
    }

    /**
     * Adds SideEffects to the queue of the failed SideEffects
     * The SideEffects are retriggered on the next change on the same context.
     *
     * @function
     * @name registerFailedSideEffects
     * @param sideEffects SideEffects that need to be retriggered
     * @param context Context where SideEffects have failed
     */;
    _proto.registerFailedSideEffects = function registerFailedSideEffects(sideEffects, context) {
      const contextPath = context.getPath();
      this._registeredFailedSideEffects[contextPath] = this._registeredFailedSideEffects[contextPath] ?? [];
      const isNotAlreadyListed = this._registeredFailedSideEffects[contextPath].every(mFailedSideEffects => sideEffects.fullyQualifiedName !== mFailedSideEffects.fullyQualifiedName);
      if (isNotAlreadyListed) {
        this._registeredFailedSideEffects[contextPath].push(sideEffects);
      }
    }

    /**
     * Deletes SideEffects to the queue of the failed SideEffects for a context.
     *
     * @function
     * @name unregisterFailedSideEffectsForAContext
     * @param contextPath Context path where SideEffects have failed
     */;
    _proto.unregisterFailedSideEffectsForAContext = function unregisterFailedSideEffectsForAContext(contextPath) {
      delete this._registeredFailedSideEffects[contextPath];
    }

    /**
     * Deletes SideEffects to the queue of the failed SideEffects.
     *
     * @function
     * @name unregisterFailedSideEffects
     * @param sideEffectsFullyQualifiedName SideEffects that need to be retriggered
     * @param context Context where SideEffects have failed
     */;
    _proto.unregisterFailedSideEffects = function unregisterFailedSideEffects(sideEffectsFullyQualifiedName, context) {
      var _this$_registeredFail;
      const contextPath = context.getPath();
      if ((_this$_registeredFail = this._registeredFailedSideEffects[contextPath]) !== null && _this$_registeredFail !== void 0 && _this$_registeredFail.length) {
        this._registeredFailedSideEffects[contextPath] = this._registeredFailedSideEffects[contextPath].filter(sideEffects => sideEffects.fullyQualifiedName !== sideEffectsFullyQualifiedName);
      }
    }

    /**
     * Adds SideEffects to the queue of a FieldGroup
     * The SideEffects are triggered when event related to the field group change is fired.
     *
     * @function
     * @name registerFieldGroupSideEffects
     * @param sideEffectsProperties SideEffects properties
     * @param fieldGroupPreRequisite Promise to fullfil before executing the SideEffects
     */;
    _proto.registerFieldGroupSideEffects = function registerFieldGroupSideEffects(sideEffectsProperties, fieldGroupPreRequisite) {
      const id = this._getFieldGroupIndex(sideEffectsProperties.name, sideEffectsProperties.context);
      if (!this._registeredFieldGroupMap[id]) {
        this._registeredFieldGroupMap[id] = {
          promise: fieldGroupPreRequisite ?? Promise.resolve(),
          sideEffectProperty: sideEffectsProperties
        };
      }
    }

    /**
     * Deletes SideEffects to the queue of a FieldGroup.
     *
     * @function
     * @name unregisterFieldGroupSideEffects
     * @param sideEffectsProperties SideEffects properties
     */;
    _proto.unregisterFieldGroupSideEffects = function unregisterFieldGroupSideEffects(sideEffectsProperties) {
      const {
        context,
        name
      } = sideEffectsProperties;
      const id = this._getFieldGroupIndex(name, context);
      delete this._registeredFieldGroupMap[id];
    }

    /**
     * Gets the registered SideEffects into the queue for a field group id.
     *
     * @function
     * @name getRegisteredSideEffectsForFieldGroup
     * @param fieldGroupId Field group id
     * @returns Array of registered SideEffects and their promise
     */;
    _proto.getRegisteredSideEffectsForFieldGroup = function getRegisteredSideEffectsForFieldGroup(fieldGroupId) {
      const sideEffects = [];
      for (const registryIndex of Object.keys(this._registeredFieldGroupMap)) {
        if (registryIndex.startsWith(`${fieldGroupId}_`)) {
          sideEffects.push(this._registeredFieldGroupMap[registryIndex]);
        }
      }
      return sideEffects;
    }

    /**
     * Gets a status index.
     *
     * @function
     * @name _getFieldGroupIndex
     * @param fieldGroupId The field group id
     * @param context SAPUI5 Context
     * @returns Index
     */;
    _proto._getFieldGroupIndex = function _getFieldGroupIndex(fieldGroupId, context) {
      return `${fieldGroupId}_${context.getPath()}`;
    }

    /**
     * Gets sideEffects properties from a field group id
     * The properties are:
     *  - name
     *  - sideEffects definition
     *  - sideEffects entity type
     *  - immediate sideEffects.
     *
     * @function
     * @name _getSideEffectsPropertyForFieldGroup
     * @param fieldGroupId
     * @returns SideEffects properties
     */;
    _proto._getSideEffectsPropertyForFieldGroup = function _getSideEffectsPropertyForFieldGroup(fieldGroupId) {
      var _this$_sideEffectsSer;
      /**
       * string "$$ImmediateRequest" is added to the SideEffects name during templating to know
       * if this SideEffects must be immediately executed requested (on field change) or must
       * be deferred (on field group focus out)
       *
       */
      const immediate = fieldGroupId.indexOf(SideEffectsHelper.IMMEDIATE_REQUEST) !== -1,
        name = fieldGroupId.replace(SideEffectsHelper.IMMEDIATE_REQUEST, ""),
        sideEffectParts = name.split("#"),
        sideEffectEntityType = sideEffectParts[0],
        sideEffectPath = `${sideEffectEntityType}@com.sap.vocabularies.Common.v1.SideEffects${sideEffectParts.length === 2 ? `#${sideEffectParts[1]}` : ""}`,
        sideEffects = (_this$_sideEffectsSer = this._sideEffectsService.getODataEntitySideEffects(sideEffectEntityType)) === null || _this$_sideEffectsSer === void 0 ? void 0 : _this$_sideEffectsSer[sideEffectPath];
      return {
        name,
        immediate,
        sideEffects,
        sideEffectEntityType
      };
    }

    /**
     * Manages the SideEffects for a field.
     *
     * @function
     * @name _manageSideEffectsFromField
     * @param field Field control
     * @param fieldGroupPreRequisite Promise to fullfil before executing deferred SideEffects
     * @returns Promise related to the requested immediate sideEffects and registered deferred SideEffects
     */;
    _proto._manageSideEffectsFromField = async function _manageSideEffectsFromField(field, fieldGroupPreRequisite) {
      const sideEffectsMap = this.getFieldSideEffectsMap(field);
      try {
        const failedSideEffectsPromises = [];
        const sideEffectsPromises = Object.keys(sideEffectsMap).map(sideEffectsName => {
          const sideEffectsProperties = sideEffectsMap[sideEffectsName];
          if (sideEffectsProperties.immediate === true) {
            // if this SideEffects is recorded as failed SideEffects, need to remove it.
            this.unregisterFailedSideEffects(sideEffectsProperties.sideEffects.fullyQualifiedName, sideEffectsProperties.context);
            return this.requestSideEffects(sideEffectsProperties.sideEffects, sideEffectsProperties.context);
          }
          return this.registerFieldGroupSideEffects(sideEffectsProperties, fieldGroupPreRequisite);
        });

        //Replay failed SideEffects related to the view or Field
        for (const context of [field.getBindingContext(), this._view.getBindingContext()]) {
          if (context) {
            const contextPath = context.getPath();
            const failedSideEffects = this._registeredFailedSideEffects[contextPath] ?? [];
            this.unregisterFailedSideEffectsForAContext(contextPath);
            for (const failedSideEffect of failedSideEffects) {
              failedSideEffectsPromises.push(this.requestSideEffects(failedSideEffect, context));
            }
          }
        }
        await Promise.all(sideEffectsPromises.concat(failedSideEffectsPromises));
      } catch (e) {
        Log.debug(`Error while managing Field SideEffects`, e);
      }
    }

    /**
     * Requests the SideEffects for a fieldGroup.
     *
     * @function
     * @name _requestFieldGroupSideEffects
     * @param fieldGroupSideEffects Field group sideEffects with its promise
     * @returns Promise returning true if the SideEffects have been successfully executed
     */;
    _proto._requestFieldGroupSideEffects = async function _requestFieldGroupSideEffects(fieldGroupSideEffects) {
      this.unregisterFieldGroupSideEffects(fieldGroupSideEffects.sideEffectProperty);
      try {
        await fieldGroupSideEffects.promise;
      } catch (e) {
        Log.debug(`Error while processing FieldGroup SideEffects`, e);
        return;
      }
      try {
        const {
          sideEffects,
          context,
          name
        } = fieldGroupSideEffects.sideEffectProperty;
        if (this.isFieldGroupValid(name, context)) {
          await this.requestSideEffects(sideEffects, context);
        }
      } catch (e) {
        Log.debug(`Error while executing FieldGroup SideEffects`, e);
      }
    }

    /**
     * Saves the validation status of properties related to a field control.
     *
     * @param field The field control
     * @param success Status of the field validation
     */;
    _proto._saveFieldPropertiesStatus = function _saveFieldPropertiesStatus(field, success) {
      const sideEffectsMap = this.getFieldSideEffectsMap(field);
      Object.keys(sideEffectsMap).forEach(key => {
        const {
          name,
          immediate,
          context
        } = sideEffectsMap[key];
        if (!immediate) {
          const id = this._getFieldGroupIndex(name, context);
          if (success) {
            var _this$_fieldGroupInva;
            (_this$_fieldGroupInva = this._fieldGroupInvalidity[id]) === null || _this$_fieldGroupInva === void 0 ? true : delete _this$_fieldGroupInva[field.getId()];
          } else {
            this._fieldGroupInvalidity[id] = {
              ...this._fieldGroupInvalidity[id],
              ...{
                [field.getId()]: true
              }
            };
          }
        }
      });
    };
    return SideEffectsControllerExtension;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "onInit", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "onInit"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "addControlSideEffects", [_dec3, _dec4], Object.getOwnPropertyDescriptor(_class2.prototype, "addControlSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "removeControlSideEffects", [_dec5, _dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "removeControlSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getContextForSideEffects", [_dec7, _dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "getContextForSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getFieldSideEffectsMap", [_dec9, _dec10], Object.getOwnPropertyDescriptor(_class2.prototype, "getFieldSideEffectsMap"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getSideEffectsMapForFieldGroups", [_dec11, _dec12], Object.getOwnPropertyDescriptor(_class2.prototype, "getSideEffectsMapForFieldGroups"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "clearFieldGroupsValidity", [_dec13, _dec14], Object.getOwnPropertyDescriptor(_class2.prototype, "clearFieldGroupsValidity"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "isFieldGroupValid", [_dec15, _dec16], Object.getOwnPropertyDescriptor(_class2.prototype, "isFieldGroupValid"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getTargetProperty", [_dec17, _dec18], Object.getOwnPropertyDescriptor(_class2.prototype, "getTargetProperty"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "handleFieldChange", [_dec19, _dec20], Object.getOwnPropertyDescriptor(_class2.prototype, "handleFieldChange"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "handleFieldGroupChange", [_dec21, _dec22], Object.getOwnPropertyDescriptor(_class2.prototype, "handleFieldGroupChange"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "requestSideEffects", [_dec23, _dec24], Object.getOwnPropertyDescriptor(_class2.prototype, "requestSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getRegisteredFailedRequests", [_dec25, _dec26], Object.getOwnPropertyDescriptor(_class2.prototype, "getRegisteredFailedRequests"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "registerFailedSideEffects", [_dec27, _dec28], Object.getOwnPropertyDescriptor(_class2.prototype, "registerFailedSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "unregisterFailedSideEffectsForAContext", [_dec29, _dec30], Object.getOwnPropertyDescriptor(_class2.prototype, "unregisterFailedSideEffectsForAContext"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "unregisterFailedSideEffects", [_dec31, _dec32], Object.getOwnPropertyDescriptor(_class2.prototype, "unregisterFailedSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "registerFieldGroupSideEffects", [_dec33, _dec34], Object.getOwnPropertyDescriptor(_class2.prototype, "registerFieldGroupSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "unregisterFieldGroupSideEffects", [_dec35, _dec36], Object.getOwnPropertyDescriptor(_class2.prototype, "unregisterFieldGroupSideEffects"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getRegisteredSideEffectsForFieldGroup", [_dec37, _dec38], Object.getOwnPropertyDescriptor(_class2.prototype, "getRegisteredSideEffectsForFieldGroup"), _class2.prototype)), _class2)) || _class);
  return SideEffectsControllerExtension;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/SideEffects", ["sap/base/Log","sap/fe/core/helpers/SideEffectsHelper","sap/ui/core/mvc/ControllerExtension","../CommonUtils","../helpers/ClassSupport"],function(e,t,i,r,o){"use strict";var s,n,d,f,c,p,a,l,u,g,y,E,h,F,S,v,_,m,O,G,P,b,x,C,w,j,M,I,D,T,q,R,A,$,V,B,Q,k,z,N;var U=o.publicExtension;var H=o.privateExtension;var L=o.methodOverride;var W=o.finalExtension;var J=o.defineUI5Class;function K(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;X(e,t)}function X(e,t){X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return X(e,t)}function Y(e,t,i,r,o){var s={};Object.keys(r).forEach(function(e){s[e]=r[e]});s.enumerable=!!s.enumerable;s.configurable=!!s.configurable;if("value"in s||s.initializer){s.writable=true}s=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},s);if(o&&s.initializer!==void 0){s.value=s.initializer?s.initializer.call(o):void 0;s.initializer=undefined}if(s.initializer===void 0){Object.defineProperty(e,t,s);s=null}return s}let Z=(s=J("sap.fe.core.controllerextensions.SideEffects"),n=L(),d=U(),f=W(),c=U(),p=W(),a=U(),l=W(),u=U(),g=W(),y=U(),E=W(),h=U(),F=W(),S=U(),v=W(),_=U(),m=W(),O=U(),G=W(),P=U(),b=W(),x=U(),C=W(),w=U(),j=W(),M=H(),I=W(),D=U(),T=W(),q=H(),R=W(),A=H(),$=W(),V=H(),B=W(),Q=U(),k=W(),s(z=(N=function(i){K(o,i);function o(){return i.apply(this,arguments)||this}var s=o.prototype;s.onInit=function e(){this._view=this.base.getView();this._sideEffectsService=r.getAppComponent(this._view).getSideEffectsService();this._registeredFieldGroupMap={};this._fieldGroupInvalidity={};this._registeredFailedSideEffects={}};s.addControlSideEffects=function e(t,i){this._sideEffectsService.addControlSideEffects(t,i)};s.removeControlSideEffects=function e(t){var i;const r=((i=t.isA)===null||i===void 0?void 0:i.call(t,"sap.ui.base.ManagedObject"))&&t.getId();if(r){this._sideEffectsService.removeControlSideEffects(r)}};s.getContextForSideEffects=function e(t,i){let r=t,o=this._sideEffectsService.getEntityTypeFromContext(t);if(i!==o){r=t.getBinding().getContext();if(r){o=this._sideEffectsService.getEntityTypeFromContext(r);if(i!==o){r=r.getBinding().getContext();if(r){o=this._sideEffectsService.getEntityTypeFromContext(r);if(i!==o){return undefined}}}}}return r||undefined};s.getFieldSideEffectsMap=function e(t){let i={};const r=t.getFieldGroupIds(),o=this._view.getViewData().entitySet,s=this._sideEffectsService.getConvertedMetaModel().entitySets.find(e=>e.name===o);i=this.getSideEffectsMapForFieldGroups(r,t);if(o&&s){const e=s.entityType.fullyQualifiedName,r=this.getTargetProperty(t),o=this.getContextForSideEffects(t.getBindingContext(),e);if(r&&o){const t=this._sideEffectsService.getControlEntitySideEffects(e);Object.keys(t).forEach(s=>{const n=t[s];if(n.SourceProperties.includes(r)){const t=`${s}::${e}`;i[t]={name:t,immediate:true,sideEffects:n,context:o}}})}}return i};s.getSideEffectsMapForFieldGroups=function e(t,i){const r={};t.forEach(e=>{const{name:t,immediate:o,sideEffects:s,sideEffectEntityType:n}=this._getSideEffectsPropertyForFieldGroup(e);const d=i?this.getContextForSideEffects(i.getBindingContext(),n):undefined;if(s&&(!i||i&&d)){r[t]={name:t,immediate:o,sideEffects:s};if(i){r[t].context=d}}});return r};s.clearFieldGroupsValidity=function e(){this._fieldGroupInvalidity={}};s.isFieldGroupValid=function e(t,i){const r=this._getFieldGroupIndex(t,i);return Object.keys(this._fieldGroupInvalidity[r]??{}).length===0};s.getTargetProperty=function e(t){var i;const r=t.data("sourcePath");const o=this._view.getModel().getMetaModel();const s=(i=this._view.getBindingContext())===null||i===void 0?void 0:i.getPath();const n=s?`${o.getMetaPath(s)}/`:"";return r===null||r===void 0?void 0:r.replace(n,"")};s.handleFieldChange=async function t(i,r,o){const s=i.getSource();this._saveFieldPropertiesStatus(s,r);if(!r){return}try{await(i.getParameter("promise")??Promise.resolve())}catch(t){e.debug("Prerequisites on Field for the SideEffects have been rejected",t);return}return this._manageSideEffectsFromField(s,o??Promise.resolve())};s.handleFieldGroupChange=function t(i){const r=i.getSource(),o=i.getParameter("fieldGroupIds"),s=o.reduce((e,t)=>e.concat(this.getRegisteredSideEffectsForFieldGroup(t)),[]);return Promise.all(s.map(e=>this._requestFieldGroupSideEffects(e))).catch(t=>{var i;const o=(i=r.getBindingContext())===null||i===void 0?void 0:i.getPath();e.debug(`Error while processing FieldGroup SideEffects on context ${o}`,t)})};s.requestSideEffects=async function e(t,i,r,o){let s,n;if(o){const e=await o(t);s=e["aTargets"];n=e["TriggerAction"]}else{s=[...t.TargetEntities??[],...t.TargetProperties??[]];n=t.TriggerAction}if(n){this._sideEffectsService.executeAction(n,i,r)}if(s.length){return this._sideEffectsService.requestSideEffects(s,i,r).catch(e=>{this.registerFailedSideEffects(t,i);throw e})}};s.getRegisteredFailedRequests=function e(){return this._registeredFailedSideEffects};s.registerFailedSideEffects=function e(t,i){const r=i.getPath();this._registeredFailedSideEffects[r]=this._registeredFailedSideEffects[r]??[];const o=this._registeredFailedSideEffects[r].every(e=>t.fullyQualifiedName!==e.fullyQualifiedName);if(o){this._registeredFailedSideEffects[r].push(t)}};s.unregisterFailedSideEffectsForAContext=function e(t){delete this._registeredFailedSideEffects[t]};s.unregisterFailedSideEffects=function e(t,i){var r;const o=i.getPath();if((r=this._registeredFailedSideEffects[o])!==null&&r!==void 0&&r.length){this._registeredFailedSideEffects[o]=this._registeredFailedSideEffects[o].filter(e=>e.fullyQualifiedName!==t)}};s.registerFieldGroupSideEffects=function e(t,i){const r=this._getFieldGroupIndex(t.name,t.context);if(!this._registeredFieldGroupMap[r]){this._registeredFieldGroupMap[r]={promise:i??Promise.resolve(),sideEffectProperty:t}}};s.unregisterFieldGroupSideEffects=function e(t){const{context:i,name:r}=t;const o=this._getFieldGroupIndex(r,i);delete this._registeredFieldGroupMap[o]};s.getRegisteredSideEffectsForFieldGroup=function e(t){const i=[];for(const e of Object.keys(this._registeredFieldGroupMap)){if(e.startsWith(`${t}_`)){i.push(this._registeredFieldGroupMap[e])}}return i};s._getFieldGroupIndex=function e(t,i){return`${t}_${i.getPath()}`};s._getSideEffectsPropertyForFieldGroup=function e(i){var r;const o=i.indexOf(t.IMMEDIATE_REQUEST)!==-1,s=i.replace(t.IMMEDIATE_REQUEST,""),n=s.split("#"),d=n[0],f=`${d}@com.sap.vocabularies.Common.v1.SideEffects${n.length===2?`#${n[1]}`:""}`,c=(r=this._sideEffectsService.getODataEntitySideEffects(d))===null||r===void 0?void 0:r[f];return{name:s,immediate:o,sideEffects:c,sideEffectEntityType:d}};s._manageSideEffectsFromField=async function t(i,r){const o=this.getFieldSideEffectsMap(i);try{const e=[];const t=Object.keys(o).map(e=>{const t=o[e];if(t.immediate===true){this.unregisterFailedSideEffects(t.sideEffects.fullyQualifiedName,t.context);return this.requestSideEffects(t.sideEffects,t.context)}return this.registerFieldGroupSideEffects(t,r)});for(const t of[i.getBindingContext(),this._view.getBindingContext()]){if(t){const i=t.getPath();const r=this._registeredFailedSideEffects[i]??[];this.unregisterFailedSideEffectsForAContext(i);for(const i of r){e.push(this.requestSideEffects(i,t))}}}await Promise.all(t.concat(e))}catch(t){e.debug(`Error while managing Field SideEffects`,t)}};s._requestFieldGroupSideEffects=async function t(i){this.unregisterFieldGroupSideEffects(i.sideEffectProperty);try{await i.promise}catch(t){e.debug(`Error while processing FieldGroup SideEffects`,t);return}try{const{sideEffects:e,context:t,name:r}=i.sideEffectProperty;if(this.isFieldGroupValid(r,t)){await this.requestSideEffects(e,t)}}catch(t){e.debug(`Error while executing FieldGroup SideEffects`,t)}};s._saveFieldPropertiesStatus=function e(t,i){const r=this.getFieldSideEffectsMap(t);Object.keys(r).forEach(e=>{const{name:o,immediate:s,context:n}=r[e];if(!s){const e=this._getFieldGroupIndex(o,n);if(i){var d;(d=this._fieldGroupInvalidity[e])===null||d===void 0?true:delete d[t.getId()]}else{this._fieldGroupInvalidity[e]={...this._fieldGroupInvalidity[e],...{[t.getId()]:true}}}}})};return o}(i),Y(N.prototype,"onInit",[n],Object.getOwnPropertyDescriptor(N.prototype,"onInit"),N.prototype),Y(N.prototype,"addControlSideEffects",[d,f],Object.getOwnPropertyDescriptor(N.prototype,"addControlSideEffects"),N.prototype),Y(N.prototype,"removeControlSideEffects",[c,p],Object.getOwnPropertyDescriptor(N.prototype,"removeControlSideEffects"),N.prototype),Y(N.prototype,"getContextForSideEffects",[a,l],Object.getOwnPropertyDescriptor(N.prototype,"getContextForSideEffects"),N.prototype),Y(N.prototype,"getFieldSideEffectsMap",[u,g],Object.getOwnPropertyDescriptor(N.prototype,"getFieldSideEffectsMap"),N.prototype),Y(N.prototype,"getSideEffectsMapForFieldGroups",[y,E],Object.getOwnPropertyDescriptor(N.prototype,"getSideEffectsMapForFieldGroups"),N.prototype),Y(N.prototype,"clearFieldGroupsValidity",[h,F],Object.getOwnPropertyDescriptor(N.prototype,"clearFieldGroupsValidity"),N.prototype),Y(N.prototype,"isFieldGroupValid",[S,v],Object.getOwnPropertyDescriptor(N.prototype,"isFieldGroupValid"),N.prototype),Y(N.prototype,"getTargetProperty",[_,m],Object.getOwnPropertyDescriptor(N.prototype,"getTargetProperty"),N.prototype),Y(N.prototype,"handleFieldChange",[O,G],Object.getOwnPropertyDescriptor(N.prototype,"handleFieldChange"),N.prototype),Y(N.prototype,"handleFieldGroupChange",[P,b],Object.getOwnPropertyDescriptor(N.prototype,"handleFieldGroupChange"),N.prototype),Y(N.prototype,"requestSideEffects",[x,C],Object.getOwnPropertyDescriptor(N.prototype,"requestSideEffects"),N.prototype),Y(N.prototype,"getRegisteredFailedRequests",[w,j],Object.getOwnPropertyDescriptor(N.prototype,"getRegisteredFailedRequests"),N.prototype),Y(N.prototype,"registerFailedSideEffects",[M,I],Object.getOwnPropertyDescriptor(N.prototype,"registerFailedSideEffects"),N.prototype),Y(N.prototype,"unregisterFailedSideEffectsForAContext",[D,T],Object.getOwnPropertyDescriptor(N.prototype,"unregisterFailedSideEffectsForAContext"),N.prototype),Y(N.prototype,"unregisterFailedSideEffects",[q,R],Object.getOwnPropertyDescriptor(N.prototype,"unregisterFailedSideEffects"),N.prototype),Y(N.prototype,"registerFieldGroupSideEffects",[A,$],Object.getOwnPropertyDescriptor(N.prototype,"registerFieldGroupSideEffects"),N.prototype),Y(N.prototype,"unregisterFieldGroupSideEffects",[V,B],Object.getOwnPropertyDescriptor(N.prototype,"unregisterFieldGroupSideEffects"),N.prototype),Y(N.prototype,"getRegisteredSideEffectsForFieldGroup",[Q,k],Object.getOwnPropertyDescriptor(N.prototype,"getRegisteredSideEffectsForFieldGroup"),N.prototype),N))||z);return Z},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/ViewState-dbg", ["sap/base/Log", "sap/base/util/merge", "sap/fe/core/CommonUtils", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/KeepAliveHelper", "sap/fe/core/helpers/ModelHelper", "sap/fe/navigation/library", "sap/ui/core/mvc/ControllerExtension", "sap/ui/core/mvc/OverrideExecution", "sap/ui/fl/apply/api/ControlVariantApplyAPI", "sap/ui/mdc/p13n/StateUtil"], function (Log, mergeObjects, CommonUtils, ClassSupport, KeepAliveHelper, ModelHelper, NavLibrary, ControllerExtension, OverrideExecution, ControlVariantApplyAPI, StateUtil) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _dec22, _dec23, _dec24, _dec25, _dec26, _dec27, _dec28, _dec29, _dec30, _dec31, _dec32, _dec33, _dec34, _dec35, _dec36, _dec37, _dec38, _dec39, _dec40, _dec41, _dec42, _dec43, _dec44, _dec45, _dec46, _dec47, _class, _class2;
  var publicExtension = ClassSupport.publicExtension;
  var privateExtension = ClassSupport.privateExtension;
  var finalExtension = ClassSupport.finalExtension;
  var extensible = ClassSupport.extensible;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  // additionalStates are stored next to control IDs, so name clash avoidance needed. Fortunately IDs have restrictions:
  // "Allowed is a sequence of characters (capital/lowercase), digits, underscores, dashes, points and/or colons."
  // Therefore adding a symbol like # or @
  const ADDITIONAL_STATES_KEY = "#additionalStates",
    NavType = NavLibrary.NavType;

  /**
   * Definition of a custom action to be used inside the table toolbar
   *
   * @alias sap.fe.core.controllerextensions.NavigationParameter
   * @public
   */

  ///////////////////////////////////////////////////////////////////
  // methods to retrieve & apply states for the different controls //
  ///////////////////////////////////////////////////////////////////

  const _mControlStateHandlerMap = {
    "sap.ui.fl.variants.VariantManagement": {
      retrieve: function (oVM) {
        return {
          variantId: oVM.getCurrentVariantKey()
        };
      },
      apply: async function (oVM, controlState) {
        try {
          if (controlState && controlState.variantId !== undefined && controlState.variantId !== oVM.getCurrentVariantKey()) {
            const isVariantIdAvailable = this._checkIfVariantIdIsAvailable(oVM, controlState.variantId);
            let sVariantReference;
            if (isVariantIdAvailable) {
              sVariantReference = controlState.variantId;
            } else {
              sVariantReference = oVM.getStandardVariantKey();
              this.controlsVariantIdUnavailable.push(...oVM.getFor());
            }
            try {
              await ControlVariantApplyAPI.activateVariant({
                element: oVM,
                variantReference: sVariantReference
              });
              await this._setInitialStatesForDeltaCompute(oVM);
            } catch (error) {
              Log.error(error);
            }
          } else {
            this._setInitialStatesForDeltaCompute(oVM);
          }
        } catch (error) {
          Log.error(error);
        }
      }
    },
    "sap.m.IconTabBar": {
      retrieve: function (oTabBar) {
        return {
          selectedKey: oTabBar.getSelectedKey()
        };
      },
      apply: function (oTabBar, oControlState) {
        if (oControlState && oControlState.selectedKey) {
          const oSelectedItem = oTabBar.getItems().find(function (oItem) {
            return oItem.getKey() === oControlState.selectedKey;
          });
          if (oSelectedItem) {
            oTabBar.setSelectedItem(oSelectedItem);
          }
        }
      }
    },
    "sap.ui.mdc.FilterBar": {
      retrieve: async function (filterBar) {
        const controlStateKey = this.getStateKey(filterBar);
        const filterBarState = await StateUtil.retrieveExternalState(filterBar);
        // remove sensitive or view state irrelevant fields
        const propertiesInfo = filterBar.getPropertyInfoSet();
        const filter = filterBarState.filter || {};
        propertiesInfo.filter(function (PropertyInfo) {
          return Object.keys(filter).length > 0 && PropertyInfo.path && filter[PropertyInfo.path] && (PropertyInfo.removeFromAppState || filter[PropertyInfo.path].length === 0);
        }).forEach(function (PropertyInfo) {
          if (PropertyInfo.path) {
            delete filter[PropertyInfo.path];
          }
        });
        return this._getControlState(controlStateKey, filterBarState);
      },
      apply: async function (filterBar, controlState) {
        try {
          if (controlState) {
            if (controlState !== null && controlState !== void 0 && controlState.initialState && this.controlsVariantIdUnavailable.indexOf(filterBar.getId()) === -1) {
              const diffState = await StateUtil.diffState(filterBar, controlState.initialState, controlState.fullState);
              return StateUtil.applyExternalState(filterBar, diffState);
            } else {
              return StateUtil.applyExternalState(filterBar, (controlState === null || controlState === void 0 ? void 0 : controlState.fullState) ?? controlState);
            }
          }
        } catch (error) {
          Log.error(error);
        }
      }
    },
    "sap.ui.mdc.Table": {
      retrieve: async function (table) {
        const controlStateKey = this.getStateKey(table);
        const tableState = await StateUtil.retrieveExternalState(table);
        return this._getControlState(controlStateKey, tableState);
      },
      apply: async function (table, controlState) {
        try {
          if (controlState) {
            // Extra condition added to apply the diff state logic for mdc control
            if (controlState !== null && controlState !== void 0 && controlState.initialState && this.controlsVariantIdUnavailable.indexOf(table.getId()) === -1) {
              var _controlState$initial;
              if (!((_controlState$initial = controlState.initialState) !== null && _controlState$initial !== void 0 && _controlState$initial.supplementaryConfig)) {
                controlState.initialState.supplementaryConfig = {};
              }
              const oDiffState = await StateUtil.diffState(table, controlState.initialState, controlState.fullState);
              return StateUtil.applyExternalState(table, oDiffState);
            } else {
              if (!controlState.supplementaryConfig) {
                controlState.supplementaryConfig = {};
              }
              return StateUtil.applyExternalState(table, (controlState === null || controlState === void 0 ? void 0 : controlState.fullState) ?? controlState);
            }
          }
        } catch (error) {
          Log.error(error);
        }
      },
      refreshBinding: function (oTable) {
        const oTableBinding = oTable.getRowBinding();
        if (oTableBinding) {
          const oRootBinding = oTableBinding.getRootBinding();
          if (oRootBinding === oTableBinding) {
            // absolute binding
            oTableBinding.refresh();
          } else {
            // relative binding
            const oHeaderContext = oTableBinding.getHeaderContext();
            const sGroupId = oTableBinding.getGroupId();
            if (oHeaderContext) {
              oHeaderContext.requestSideEffects([{
                $NavigationPropertyPath: ""
              }], sGroupId);
            }
          }
        } else {
          Log.info(`Table: ${oTable.getId()} was not refreshed. No binding found!`);
        }
      }
    },
    "sap.ui.mdc.Chart": {
      retrieve: function (oChart) {
        return StateUtil.retrieveExternalState(oChart);
      },
      apply: function (oChart, oControlState) {
        if (oControlState) {
          return StateUtil.applyExternalState(oChart, oControlState);
        }
      }
      // TODO: uncomment after mdc fix is merged
      /* retrieve: async function (chart: Chart) {
      	const controlStateKey = this.getStateKey(chart);
      	const chartState = await StateUtil.retrieveExternalState(chart);
      		return this._getControlState(controlStateKey, chartState);
      },
      apply: async function (chart: Chart, controlState: ControlState) {
      	try {
      		if (controlState) {
      			// Extra condition added to apply the diff state logic for mdc control
      			if (controlState?.initialState && this.controlsVariantIdUnavailable.indexOf(chart.getId()) === -1) {
      				const diffState = await StateUtil.diffState(
      					chart,
      					controlState.initialState as object,
      					controlState.fullState as object
      				);
      				return await StateUtil.applyExternalState(chart, diffState);
      			} else {
      				return await StateUtil.applyExternalState(chart, controlState?.fullState ?? controlState);
      			}
      		}
      	} catch (error) {
      		Log.error(error as string);
      	}
      } */
    },

    "sap.uxap.ObjectPageLayout": {
      retrieve: function (oOPLayout) {
        return {
          selectedSection: oOPLayout.getSelectedSection()
        };
      },
      apply: function (oOPLayout, oControlState) {
        if (oControlState) {
          oOPLayout.setSelectedSection(oControlState.selectedSection);
        }
      },
      refreshBinding: function (oOPLayout) {
        const oBindingContext = oOPLayout.getBindingContext();
        const oBinding = oBindingContext && oBindingContext.getBinding();
        if (oBinding) {
          const sMetaPath = ModelHelper.getMetaPathForContext(oBindingContext);
          const sStrategy = KeepAliveHelper.getControlRefreshStrategyForContextPath(oOPLayout, sMetaPath);
          if (sStrategy === "self") {
            // Refresh main context and 1-1 navigation properties or OP
            const oModel = oBindingContext.getModel(),
              oMetaModel = oModel.getMetaModel(),
              oNavigationProperties = CommonUtils.getContextPathProperties(oMetaModel, sMetaPath, {
                $kind: "NavigationProperty"
              }) || {},
              aNavPropertiesToRequest = Object.keys(oNavigationProperties).reduce(function (aPrev, sNavProp) {
                if (oNavigationProperties[sNavProp].$isCollection !== true) {
                  aPrev.push({
                    $NavigationPropertyPath: sNavProp
                  });
                }
                return aPrev;
              }, []),
              aProperties = [{
                $PropertyPath: "*"
              }],
              sGroupId = oBinding.getGroupId();
            oBindingContext.requestSideEffects(aProperties.concat(aNavPropertiesToRequest), sGroupId);
          } else if (sStrategy === "includingDependents") {
            // Complete refresh
            oBinding.refresh();
          }
        } else {
          Log.info(`ObjectPage: ${oOPLayout.getId()} was not refreshed. No binding found!`);
        }
      }
    },
    "sap.fe.macros.table.QuickFilterContainer": {
      retrieve: function (oQuickFilter) {
        return {
          selectedKey: oQuickFilter.getSelectorKey()
        };
      },
      apply: function (oQuickFilter, oControlState) {
        if (oControlState) {
          oQuickFilter.setSelectorKey(oControlState.selectedKey);
        }
      }
    },
    "sap.m.SegmentedButton": {
      retrieve: function (oSegmentedButton) {
        return {
          selectedKey: oSegmentedButton.getSelectedKey()
        };
      },
      apply: function (oSegmentedButton, oControlState) {
        if (oControlState) {
          oSegmentedButton.setSelectedKey(oControlState.selectedKey);
        }
      }
    },
    "sap.m.Select": {
      retrieve: function (oSelect) {
        return {
          selectedKey: oSelect.getSelectedKey()
        };
      },
      apply: function (oSelect, oControlState) {
        if (oControlState) {
          oSelect.setSelectedKey(oControlState.selectedKey);
        }
      }
    },
    "sap.f.DynamicPage": {
      retrieve: function (oDynamicPage) {
        return {
          headerExpanded: oDynamicPage.getHeaderExpanded()
        };
      },
      apply: function (oDynamicPage, oControlState) {
        if (oControlState) {
          oDynamicPage.setHeaderExpanded(oControlState.headerExpanded);
        }
      }
    },
    "sap.ui.core.mvc.View": {
      retrieve: function (oView) {
        const oController = oView.getController();
        if (oController && oController.viewState) {
          return oController.viewState.retrieveViewState(oController.viewState);
        }
        return {};
      },
      apply: function (oView, oControlState, oNavParameters) {
        const oController = oView.getController();
        if (oController && oController.viewState) {
          return oController.viewState.applyViewState(oControlState, oNavParameters);
        }
      },
      refreshBinding: function (oView) {
        const oController = oView.getController();
        if (oController && oController.viewState) {
          return oController.viewState.refreshViewBindings();
        }
      }
    },
    "sap.ui.core.ComponentContainer": {
      retrieve: function (oComponentContainer) {
        const oComponent = oComponentContainer.getComponentInstance();
        if (oComponent) {
          return this.retrieveControlState(oComponent.getRootControl());
        }
        return {};
      },
      apply: function (oComponentContainer, oControlState, oNavParameters) {
        const oComponent = oComponentContainer.getComponentInstance();
        if (oComponent) {
          return this.applyControlState(oComponent.getRootControl(), oControlState, oNavParameters);
        }
      }
    }
  };
  /**
   * A controller extension offering hooks for state handling
   *
   * If you need to maintain a specific state for your application, you can use the controller extension.
   *
   * @hideconstructor
   * @public
   * @since 1.85.0
   */
  let ViewState = (_dec = defineUI5Class("sap.fe.core.controllerextensions.ViewState"), _dec2 = publicExtension(), _dec3 = finalExtension(), _dec4 = publicExtension(), _dec5 = extensible(OverrideExecution.After), _dec6 = privateExtension(), _dec7 = finalExtension(), _dec8 = privateExtension(), _dec9 = finalExtension(), _dec10 = publicExtension(), _dec11 = extensible(OverrideExecution.After), _dec12 = publicExtension(), _dec13 = extensible(OverrideExecution.After), _dec14 = publicExtension(), _dec15 = extensible(OverrideExecution.After), _dec16 = privateExtension(), _dec17 = finalExtension(), _dec18 = publicExtension(), _dec19 = extensible(OverrideExecution.After), _dec20 = privateExtension(), _dec21 = finalExtension(), _dec22 = publicExtension(), _dec23 = extensible(OverrideExecution.After), _dec24 = publicExtension(), _dec25 = finalExtension(), _dec26 = publicExtension(), _dec27 = finalExtension(), _dec28 = publicExtension(), _dec29 = extensible(OverrideExecution.After), _dec30 = privateExtension(), _dec31 = finalExtension(), _dec32 = publicExtension(), _dec33 = extensible(OverrideExecution.Instead), _dec34 = publicExtension(), _dec35 = finalExtension(), _dec36 = privateExtension(), _dec37 = publicExtension(), _dec38 = extensible(OverrideExecution.After), _dec39 = publicExtension(), _dec40 = extensible(OverrideExecution.After), _dec41 = publicExtension(), _dec42 = extensible(OverrideExecution.After), _dec43 = privateExtension(), _dec44 = publicExtension(), _dec45 = extensible(OverrideExecution.After), _dec46 = privateExtension(), _dec47 = finalExtension(), _dec(_class = (_class2 = /*#__PURE__*/function (_ControllerExtension) {
    _inheritsLoose(ViewState, _ControllerExtension);
    /**
     * Constructor.
     */
    function ViewState() {
      var _this;
      _this = _ControllerExtension.call(this) || this;
      _this.initialControlStatesMapper = {};
      _this.controlsVariantIdUnavailable = [];
      _this.viewStateControls = [];
      _this._setInitialStatesForDeltaCompute = async variantManagement => {
        try {
          const adaptControls = _this.viewStateControls;
          const externalStatePromises = [];
          const controlStateKey = [];
          let initialControlStates = [];
          const variantControls = (variantManagement === null || variantManagement === void 0 ? void 0 : variantManagement.getFor()) ?? [];
          adaptControls.filter(function (control) {
            return control && (!variantManagement || variantControls.indexOf(control.getId()) > -1) && (control.isA("sap.ui.mdc.Table") || control.isA("sap.ui.mdc.FilterBar") || control.isA("sap.ui.mdc.Chart"));
          }).forEach(control => {
            if (variantManagement) {
              _this._addEventListenersToVariantManagement(variantManagement, variantControls);
            }
            const externalStatePromise = StateUtil.retrieveExternalState(control);
            externalStatePromises.push(externalStatePromise);
            controlStateKey.push(_this.getStateKey(control));
          });
          initialControlStates = await Promise.all(externalStatePromises);
          initialControlStates.forEach((initialControlState, i) => {
            _this.initialControlStatesMapper[controlStateKey[i]] = initialControlState;
          });
        } catch (e) {
          Log.error(e);
        }
      };
      _this._iRetrievingStateCounter = 0;
      _this._pInitialStateApplied = new Promise(resolve => {
        _this._pInitialStateAppliedResolve = resolve;
      });
      return _this;
    }
    var _proto = ViewState.prototype;
    _proto.refreshViewBindings = async function refreshViewBindings() {
      const aControls = await this.collectResults(this.base.viewState.adaptBindingRefreshControls);
      let oPromiseChain = Promise.resolve();
      aControls.filter(oControl => {
        return oControl && oControl.isA && oControl.isA("sap.ui.base.ManagedObject");
      }).forEach(oControl => {
        oPromiseChain = oPromiseChain.then(this.refreshControlBinding.bind(this, oControl));
      });
      return oPromiseChain;
    }
    /**
     * This function should add all controls relevant for refreshing to the provided control array.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param aCollectedControls The collected controls
     * @alias sap.fe.core.controllerextensions.ViewState#adaptBindingRefreshControls
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    adaptBindingRefreshControls = function adaptBindingRefreshControls(aCollectedControls) {
      // to be overriden
    };
    _proto.refreshControlBinding = function refreshControlBinding(oControl) {
      const oControlRefreshBindingHandler = this.getControlRefreshBindingHandler(oControl);
      let oPromiseChain = Promise.resolve();
      if (typeof oControlRefreshBindingHandler.refreshBinding !== "function") {
        Log.info(`refreshBinding handler for control: ${oControl.getMetadata().getName()} is not provided`);
      } else {
        oPromiseChain = oPromiseChain.then(oControlRefreshBindingHandler.refreshBinding.bind(this, oControl));
      }
      return oPromiseChain;
    }

    /**
     * Returns a map of <code>refreshBinding</code> function for a certain control.
     *
     * @param {sap.ui.base.ManagedObject} oControl The control to get state handler for
     * @returns {object} A plain object with one function: <code>refreshBinding</code>
     */;
    _proto.getControlRefreshBindingHandler = function getControlRefreshBindingHandler(oControl) {
      const oRefreshBindingHandler = {};
      if (oControl) {
        for (const sType in _mControlStateHandlerMap) {
          if (oControl.isA(sType)) {
            // pass only the refreshBinding handler in an object so that :
            // 1. Application has access only to refreshBinding and not apply and reterive at this stage
            // 2. Application modifications to the object will be reflected here (as we pass by reference)
            oRefreshBindingHandler["refreshBinding"] = _mControlStateHandlerMap[sType].refreshBinding || {};
            break;
          }
        }
      }
      this.base.viewState.adaptBindingRefreshHandler(oControl, oRefreshBindingHandler);
      return oRefreshBindingHandler;
    }
    /**
     * Customize the <code>refreshBinding</code> function for a certain control.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param oControl The control for which the refresh handler is adapted.
     * @param oControlHandler A plain object which can have one function: <code>refreshBinding</code>
     * @alias sap.fe.core.controllerextensions.ViewState#adaptBindingRefreshHandler
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    adaptBindingRefreshHandler = function adaptBindingRefreshHandler(oControl, oControlHandler) {
      // to be overriden
    }

    /**
     * Called when the application is suspended due to keep-alive mode.
     *
     * @alias sap.fe.core.controllerextensions.ViewState#onSuspend
     * @public
     */;
    _proto.onSuspend = function onSuspend() {
      // to be overriden
    }

    /**
     * Called when the application is restored due to keep-alive mode.
     *
     * @alias sap.fe.core.controllerextensions.ViewState#onRestore
     * @public
     */;
    _proto.onRestore = function onRestore() {
      // to be overriden
    }

    /**
     * Destructor method for objects.
     */;
    _proto.destroy = function destroy() {
      delete this._pInitialStateAppliedResolve;
      _ControllerExtension.prototype.destroy.call(this);
    }

    /**
     * Helper function to enable multi override. It is adding an additional parameter (array) to the provided
     * function (and its parameters), that will be evaluated via <code>Promise.all</code>.
     *
     * @param fnCall The function to be called
     * @param args
     * @returns A promise to be resolved with the result of all overrides
     */;
    _proto.collectResults = function collectResults(fnCall) {
      const aResults = [];
      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }
      args.push(aResults);
      fnCall.apply(this, args);
      return Promise.all(aResults);
    }

    /**
     * Customize the <code>retrieve</code> and <code>apply</code> functions for a certain control.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param oControl The control to get state handler for
     * @param aControlHandler A list of plain objects with two functions: <code>retrieve</code> and <code>apply</code>
     * @alias sap.fe.core.controllerextensions.ViewState#adaptControlStateHandler
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    adaptControlStateHandler = function adaptControlStateHandler(oControl, aControlHandler) {
      // to be overridden if needed
    }

    /**
     * Returns a map of <code>retrieve</code> and <code>apply</code> functions for a certain control.
     *
     * @param oControl The control to get state handler for
     * @returns A plain object with two functions: <code>retrieve</code> and <code>apply</code>
     */;
    _proto.getControlStateHandler = function getControlStateHandler(oControl) {
      const aInternalControlStateHandler = [],
        aCustomControlStateHandler = [];
      if (oControl) {
        for (const sType in _mControlStateHandlerMap) {
          if (oControl.isA(sType)) {
            // avoid direct manipulation of internal _mControlStateHandlerMap
            aInternalControlStateHandler.push(Object.assign({}, _mControlStateHandlerMap[sType]));
            break;
          }
        }
      }
      this.base.viewState.adaptControlStateHandler(oControl, aCustomControlStateHandler);
      return aInternalControlStateHandler.concat(aCustomControlStateHandler);
    }

    /**
     * This function should add all controls for given view that should be considered for the state handling to the provided control array.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param aCollectedControls The collected controls
     * @alias sap.fe.core.controllerextensions.ViewState#adaptStateControls
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    adaptStateControls = function adaptStateControls(aCollectedControls) {
      // to be overridden if needed
    }

    /**
     * Returns the key to be used for given control.
     *
     * @param oControl The control to get state key for
     * @returns The key to be used for storing the controls state
     */;
    _proto.getStateKey = function getStateKey(oControl) {
      return this.getView().getLocalId(oControl.getId()) || oControl.getId();
    }

    /**
     * Retrieve the view state of this extensions view.
     * When this function is called more than once before finishing, all but the final response will resolve to <code>undefined</code>.
     *
     * @returns A promise resolving the view state
     * @alias sap.fe.core.controllerextensions.ViewState#retrieveViewState
     * @public
     */;
    _proto.retrieveViewState = async function retrieveViewState() {
      ++this._iRetrievingStateCounter;
      let oViewState;
      try {
        await this._pInitialStateApplied;
        const aControls = await this.collectResults(this.base.viewState.adaptStateControls);
        const aResolvedStates = await Promise.all(aControls.filter(function (oControl) {
          return oControl && oControl.isA && oControl.isA("sap.ui.base.ManagedObject");
        }).map(oControl => {
          return this.retrieveControlState(oControl).then(vResult => {
            return {
              key: this.getStateKey(oControl),
              value: vResult
            };
          });
        }));
        oViewState = aResolvedStates.reduce(function (oStates, mState) {
          const oCurrentState = {};
          oCurrentState[mState.key] = mState.value;
          return mergeObjects(oStates, oCurrentState);
        }, {});
        const mAdditionalStates = await Promise.resolve(this._retrieveAdditionalStates());
        if (mAdditionalStates && Object.keys(mAdditionalStates).length) {
          oViewState[ADDITIONAL_STATES_KEY] = mAdditionalStates;
        }
      } finally {
        --this._iRetrievingStateCounter;
      }
      return this._iRetrievingStateCounter === 0 ? oViewState : undefined;
    }

    /**
     * Extend the map of additional states (not control bound) to be added to the current view state of the given view.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param mAdditionalStates The additional state
     * @alias sap.fe.core.controllerextensions.ViewState#retrieveAdditionalStates
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    retrieveAdditionalStates = function retrieveAdditionalStates(mAdditionalStates) {
      // to be overridden if needed
    }

    /**
     * Returns a map of additional states (not control bound) to be added to the current view state of the given view.
     *
     * @returns Additional view states
     */;
    _proto._retrieveAdditionalStates = function _retrieveAdditionalStates() {
      const mAdditionalStates = {};
      this.base.viewState.retrieveAdditionalStates(mAdditionalStates);
      return mAdditionalStates;
    }

    /**
     * Returns the current state for the given control.
     *
     * @param oControl The object to get the state for
     * @returns The state for the given control
     */;
    _proto.retrieveControlState = function retrieveControlState(oControl) {
      const aControlStateHandlers = this.getControlStateHandler(oControl);
      return Promise.all(aControlStateHandlers.map(mControlStateHandler => {
        if (typeof mControlStateHandler.retrieve !== "function") {
          throw new Error(`controlStateHandler.retrieve is not a function for control: ${oControl.getMetadata().getName()}`);
        }
        return mControlStateHandler.retrieve.call(this, oControl);
      })).then(aStates => {
        return aStates.reduce(function (oFinalState, oCurrentState) {
          return mergeObjects(oFinalState, oCurrentState);
        }, {});
      });
    }

    /**
     * Defines whether the view state should only be applied once initially.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.Instead}.
     *
     * Important:
     * You should only override this method for custom pages and not for the standard ListReportPage and ObjectPage!
     *
     * @returns If <code>true</code>, only the initial view state is applied once,
     * else any new view state is also applied on follow-up calls (default)
     * @alias sap.fe.core.controllerextensions.ViewState#applyInitialStateOnly
     * @protected
     */;
    _proto.applyInitialStateOnly = function applyInitialStateOnly() {
      return true;
    }

    /**
     * Applies the given view state to this extensions view.
     *
     * @param oViewState The view state to apply (can be undefined)
     * @param oNavParameter The current navigation parameter
     * @param oNavParameter.navigationType The actual navigation type
     * @param oNavParameter.selectionVariant The selectionVariant from the navigation
     * @param oNavParameter.selectionVariantDefaults The selectionVariant defaults from the navigation
     * @param oNavParameter.requiresStandardVariant Defines whether the standard variant must be used in variant management
     * @returns Promise for async state handling
     * @alias sap.fe.core.controllerextensions.ViewState#applyViewState
     * @public
     */;
    _proto.applyViewState = async function applyViewState(oViewState, oNavParameter) {
      if (this.base.viewState.applyInitialStateOnly() && this._getInitialStateApplied()) {
        return;
      }
      try {
        await this.collectResults(this.base.viewState.onBeforeStateApplied);
        const aControls = await this.collectResults(this.base.viewState.adaptStateControls);
        this.viewStateControls = aControls;
        let oPromiseChain = Promise.resolve();
        let hasVariantManagement = false;
        /**
         * this ensures that variantManagement control is applied first to calculate initial state for delta logic
         */
        const sortedAdaptStateControls = aControls.reduce((modifiedControls, control) => {
          if (!control) {
            return modifiedControls;
          }
          const isVariantManagementControl = control.isA("sap.ui.fl.variants.VariantManagement");
          if (!hasVariantManagement) {
            hasVariantManagement = isVariantManagementControl;
          }
          modifiedControls = isVariantManagementControl ? [control, ...modifiedControls] : [...modifiedControls, control];
          return modifiedControls;
        }, []);

        // In case of no Variant Management, this ensures that initial states is set
        if (!hasVariantManagement) {
          this._setInitialStatesForDeltaCompute();
        }
        sortedAdaptStateControls.filter(function (oControl) {
          return oControl.isA("sap.ui.base.ManagedObject");
        }).forEach(oControl => {
          const sKey = this.getStateKey(oControl);
          oPromiseChain = oPromiseChain.then(this.applyControlState.bind(this, oControl, oViewState ? oViewState[sKey] : undefined, oNavParameter));
        });
        await oPromiseChain;
        if (oNavParameter.navigationType === NavType.iAppState) {
          await this.collectResults(this.base.viewState.applyAdditionalStates, oViewState ? oViewState[ADDITIONAL_STATES_KEY] : undefined);
        } else {
          await this.collectResults(this.base.viewState.applyNavigationParameters, oNavParameter);
          await this.collectResults(this.base.viewState._applyNavigationParametersToFilterbar, oNavParameter);
        }
      } finally {
        try {
          await this.collectResults(this.base.viewState.onAfterStateApplied);
          this._setInitialStateApplied();
        } catch (e) {
          Log.error(e);
        }
      }
    };
    _proto._checkIfVariantIdIsAvailable = function _checkIfVariantIdIsAvailable(oVM, sVariantId) {
      const aVariants = oVM.getVariants();
      let bIsControlStateVariantAvailable = false;
      aVariants.forEach(function (oVariant) {
        if (oVariant.key === sVariantId) {
          bIsControlStateVariantAvailable = true;
        }
      });
      return bIsControlStateVariantAvailable;
    };
    _proto._setInitialStateApplied = function _setInitialStateApplied() {
      if (this._pInitialStateAppliedResolve) {
        const pInitialStateAppliedResolve = this._pInitialStateAppliedResolve;
        delete this._pInitialStateAppliedResolve;
        pInitialStateAppliedResolve();
      }
    };
    _proto._getInitialStateApplied = function _getInitialStateApplied() {
      return !this._pInitialStateAppliedResolve;
    }

    /**
     * Hook to react before a state for given view is applied.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param aPromises Extensible array of promises to be resolved before continuing
     * @alias sap.fe.core.controllerextensions.ViewState#onBeforeStateApplied
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onBeforeStateApplied = function onBeforeStateApplied(aPromises) {
      // to be overriden
    }

    /**
     * Hook to react when state for given view was applied.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param aPromises Extensible array of promises to be resolved before continuing
     * @alias sap.fe.core.controllerextensions.ViewState#onAfterStateApplied
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onAfterStateApplied = function onAfterStateApplied(aPromises) {
      // to be overriden
    }

    /**
     * Applying additional, not control related, states - is called only if navigation type is iAppState.
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param oViewState The current view state
     * @param aPromises Extensible array of promises to be resolved before continuing
     * @alias sap.fe.core.controllerextensions.ViewState#applyAdditionalStates
     * @protected
     */;
    _proto.
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    applyAdditionalStates = function applyAdditionalStates(oViewState, aPromises) {
      // to be overridden if needed
    };
    _proto._applyNavigationParametersToFilterbar = function _applyNavigationParametersToFilterbar(_oNavParameter, _aPromises) {
      // to be overridden if needed
    }

    /**
     * Apply navigation parameters is not called if the navigation type is iAppState
     *
     * This function is meant to be individually overridden by consuming controllers, but not to be called directly.
     * The override execution is: {@link sap.ui.core.mvc.OverrideExecution.After}.
     *
     * @param oNavParameter The current navigation parameter
     * @param oNavParameter.navigationType The actual navigation type
     * @param [oNavParameter.selectionVariant] The selectionVariant from the navigation
     * @param [oNavParameter.selectionVariantDefaults] The selectionVariant defaults from the navigation
     * @param [oNavParameter.requiresStandardVariant] Defines whether the standard variant must be used in variant management
     * @param aPromises Extensible array of promises to be resolved before continuing
     * @alias sap.fe.core.controllerextensions.ViewState#applyNavigationParameters
     * @protected
     */;
    _proto.applyNavigationParameters = function applyNavigationParameters(
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    oNavParameter,
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    aPromises) {
      // to be overridden if needed
    }

    /**
     * Applying the given state to the given control.
     *
     * @param oControl The object to apply the given state
     * @param oControlState The state for the given control
     * @param [oNavParameters] The current navigation parameters
     * @returns Return a promise for async state handling
     */;
    _proto.applyControlState = function applyControlState(oControl, oControlState, oNavParameters) {
      const aControlStateHandlers = this.getControlStateHandler(oControl);
      let oPromiseChain = Promise.resolve();
      aControlStateHandlers.forEach(mControlStateHandler => {
        if (typeof mControlStateHandler.apply !== "function") {
          throw new Error(`controlStateHandler.apply is not a function for control: ${oControl.getMetadata().getName()}`);
        }
        oPromiseChain = oPromiseChain.then(mControlStateHandler.apply.bind(this, oControl, oControlState, oNavParameters));
      });
      return oPromiseChain;
    };
    _proto.getInterface = function getInterface() {
      return this;
    }
    // method to get the control state for mdc controls applying the delta logic
    ;
    _proto._getControlState = function _getControlState(controlStateKey, controlState) {
      const initialControlStatesMapper = this.initialControlStatesMapper;
      if (Object.keys(initialControlStatesMapper).length > 0 && initialControlStatesMapper[controlStateKey]) {
        if (Object.keys(initialControlStatesMapper[controlStateKey]).length === 0) {
          initialControlStatesMapper[controlStateKey] = {
            ...controlState
          };
        }
        return {
          fullState: controlState,
          initialState: initialControlStatesMapper[controlStateKey]
        };
      }
      return controlState;
    }

    //method to store the initial states for delta computation of mdc controls
    ;
    // Attach event to save and select of Variant Management to update the initial Control States on variant change
    _proto._addEventListenersToVariantManagement = function _addEventListenersToVariantManagement(variantManagement, variantControls) {
      const oPayload = {
        variantManagedControls: variantControls
      };
      const fnEvent = () => {
        this._updateInitialStatesOnVariantChange(variantControls);
      };
      variantManagement.attachSave(oPayload, fnEvent, {});
      variantManagement.attachSelect(oPayload, fnEvent, {});
    };
    _proto._updateInitialStatesOnVariantChange = function _updateInitialStatesOnVariantChange(vmAssociatedControlsToReset) {
      const initialControlStatesMapper = this.initialControlStatesMapper;
      Object.keys(initialControlStatesMapper).forEach(controlKey => {
        for (const vmAssociatedcontrolKey of vmAssociatedControlsToReset) {
          if (vmAssociatedcontrolKey.indexOf(controlKey) > -1) {
            initialControlStatesMapper[controlKey] = {};
          }
        }
      });
    };
    return ViewState;
  }(ControllerExtension), (_applyDecoratedDescriptor(_class2.prototype, "refreshViewBindings", [_dec2, _dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "refreshViewBindings"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "adaptBindingRefreshControls", [_dec4, _dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "adaptBindingRefreshControls"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "refreshControlBinding", [_dec6, _dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "refreshControlBinding"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getControlRefreshBindingHandler", [_dec8, _dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "getControlRefreshBindingHandler"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "adaptBindingRefreshHandler", [_dec10, _dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "adaptBindingRefreshHandler"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onSuspend", [_dec12, _dec13], Object.getOwnPropertyDescriptor(_class2.prototype, "onSuspend"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onRestore", [_dec14, _dec15], Object.getOwnPropertyDescriptor(_class2.prototype, "onRestore"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "collectResults", [_dec16, _dec17], Object.getOwnPropertyDescriptor(_class2.prototype, "collectResults"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "adaptControlStateHandler", [_dec18, _dec19], Object.getOwnPropertyDescriptor(_class2.prototype, "adaptControlStateHandler"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getControlStateHandler", [_dec20, _dec21], Object.getOwnPropertyDescriptor(_class2.prototype, "getControlStateHandler"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "adaptStateControls", [_dec22, _dec23], Object.getOwnPropertyDescriptor(_class2.prototype, "adaptStateControls"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "getStateKey", [_dec24, _dec25], Object.getOwnPropertyDescriptor(_class2.prototype, "getStateKey"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "retrieveViewState", [_dec26, _dec27], Object.getOwnPropertyDescriptor(_class2.prototype, "retrieveViewState"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "retrieveAdditionalStates", [_dec28, _dec29], Object.getOwnPropertyDescriptor(_class2.prototype, "retrieveAdditionalStates"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "retrieveControlState", [_dec30, _dec31], Object.getOwnPropertyDescriptor(_class2.prototype, "retrieveControlState"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "applyInitialStateOnly", [_dec32, _dec33], Object.getOwnPropertyDescriptor(_class2.prototype, "applyInitialStateOnly"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "applyViewState", [_dec34, _dec35], Object.getOwnPropertyDescriptor(_class2.prototype, "applyViewState"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "_checkIfVariantIdIsAvailable", [_dec36], Object.getOwnPropertyDescriptor(_class2.prototype, "_checkIfVariantIdIsAvailable"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onBeforeStateApplied", [_dec37, _dec38], Object.getOwnPropertyDescriptor(_class2.prototype, "onBeforeStateApplied"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "onAfterStateApplied", [_dec39, _dec40], Object.getOwnPropertyDescriptor(_class2.prototype, "onAfterStateApplied"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "applyAdditionalStates", [_dec41, _dec42], Object.getOwnPropertyDescriptor(_class2.prototype, "applyAdditionalStates"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "_applyNavigationParametersToFilterbar", [_dec43], Object.getOwnPropertyDescriptor(_class2.prototype, "_applyNavigationParametersToFilterbar"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "applyNavigationParameters", [_dec44, _dec45], Object.getOwnPropertyDescriptor(_class2.prototype, "applyNavigationParameters"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "applyControlState", [_dec46, _dec47], Object.getOwnPropertyDescriptor(_class2.prototype, "applyControlState"), _class2.prototype)), _class2)) || _class);
  return ViewState;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/ViewState", ["sap/base/Log","sap/base/util/merge","sap/fe/core/CommonUtils","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/KeepAliveHelper","sap/fe/core/helpers/ModelHelper","sap/fe/navigation/library","sap/ui/core/mvc/ControllerExtension","sap/ui/core/mvc/OverrideExecution","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/mdc/p13n/StateUtil"],function(t,e,r,n,i,o,a,p,s,l,c){"use strict";var f,d,u,y,g,S,h,v,b,w,C,O,A,m,I,P,R,j,_,B,V,E,x,D,K,H,M,k,N,F,T,$,U,z,L,q,G,Q,J,W,X,Y,Z,tt,et,rt,nt,it,ot;var at=n.publicExtension;var pt=n.privateExtension;var st=n.finalExtension;var lt=n.extensible;var ct=n.defineUI5Class;function ft(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;dt(t,e)}function dt(t,e){dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,r){e.__proto__=r;return e};return dt(t,e)}function ut(t,e,r,n,i){var o={};Object.keys(n).forEach(function(t){o[t]=n[t]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=r.slice().reverse().reduce(function(r,n){return n(t,e,r)||r},o);if(i&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(i):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(t,e,o);o=null}return o}const yt="#additionalStates",gt=a.NavType;const St={"sap.ui.fl.variants.VariantManagement":{retrieve:function(t){return{variantId:t.getCurrentVariantKey()}},apply:async function(e,r){try{if(r&&r.variantId!==undefined&&r.variantId!==e.getCurrentVariantKey()){const n=this._checkIfVariantIdIsAvailable(e,r.variantId);let i;if(n){i=r.variantId}else{i=e.getStandardVariantKey();this.controlsVariantIdUnavailable.push(...e.getFor())}try{await l.activateVariant({element:e,variantReference:i});await this._setInitialStatesForDeltaCompute(e)}catch(e){t.error(e)}}else{this._setInitialStatesForDeltaCompute(e)}}catch(e){t.error(e)}}},"sap.m.IconTabBar":{retrieve:function(t){return{selectedKey:t.getSelectedKey()}},apply:function(t,e){if(e&&e.selectedKey){const r=t.getItems().find(function(t){return t.getKey()===e.selectedKey});if(r){t.setSelectedItem(r)}}}},"sap.ui.mdc.FilterBar":{retrieve:async function(t){const e=this.getStateKey(t);const r=await c.retrieveExternalState(t);const n=t.getPropertyInfoSet();const i=r.filter||{};n.filter(function(t){return Object.keys(i).length>0&&t.path&&i[t.path]&&(t.removeFromAppState||i[t.path].length===0)}).forEach(function(t){if(t.path){delete i[t.path]}});return this._getControlState(e,r)},apply:async function(e,r){try{if(r){if(r!==null&&r!==void 0&&r.initialState&&this.controlsVariantIdUnavailable.indexOf(e.getId())===-1){const t=await c.diffState(e,r.initialState,r.fullState);return c.applyExternalState(e,t)}else{return c.applyExternalState(e,(r===null||r===void 0?void 0:r.fullState)??r)}}}catch(e){t.error(e)}}},"sap.ui.mdc.Table":{retrieve:async function(t){const e=this.getStateKey(t);const r=await c.retrieveExternalState(t);return this._getControlState(e,r)},apply:async function(e,r){try{if(r){if(r!==null&&r!==void 0&&r.initialState&&this.controlsVariantIdUnavailable.indexOf(e.getId())===-1){var n;if(!((n=r.initialState)!==null&&n!==void 0&&n.supplementaryConfig)){r.initialState.supplementaryConfig={}}const t=await c.diffState(e,r.initialState,r.fullState);return c.applyExternalState(e,t)}else{if(!r.supplementaryConfig){r.supplementaryConfig={}}return c.applyExternalState(e,(r===null||r===void 0?void 0:r.fullState)??r)}}}catch(e){t.error(e)}},refreshBinding:function(e){const r=e.getRowBinding();if(r){const t=r.getRootBinding();if(t===r){r.refresh()}else{const t=r.getHeaderContext();const e=r.getGroupId();if(t){t.requestSideEffects([{$NavigationPropertyPath:""}],e)}}}else{t.info(`Table: ${e.getId()} was not refreshed. No binding found!`)}}},"sap.ui.mdc.Chart":{retrieve:function(t){return c.retrieveExternalState(t)},apply:function(t,e){if(e){return c.applyExternalState(t,e)}}},"sap.uxap.ObjectPageLayout":{retrieve:function(t){return{selectedSection:t.getSelectedSection()}},apply:function(t,e){if(e){t.setSelectedSection(e.selectedSection)}},refreshBinding:function(e){const n=e.getBindingContext();const a=n&&n.getBinding();if(a){const t=o.getMetaPathForContext(n);const p=i.getControlRefreshStrategyForContextPath(e,t);if(p==="self"){const e=n.getModel(),i=e.getMetaModel(),o=r.getContextPathProperties(i,t,{$kind:"NavigationProperty"})||{},p=Object.keys(o).reduce(function(t,e){if(o[e].$isCollection!==true){t.push({$NavigationPropertyPath:e})}return t},[]),s=[{$PropertyPath:"*"}],l=a.getGroupId();n.requestSideEffects(s.concat(p),l)}else if(p==="includingDependents"){a.refresh()}}else{t.info(`ObjectPage: ${e.getId()} was not refreshed. No binding found!`)}}},"sap.fe.macros.table.QuickFilterContainer":{retrieve:function(t){return{selectedKey:t.getSelectorKey()}},apply:function(t,e){if(e){t.setSelectorKey(e.selectedKey)}}},"sap.m.SegmentedButton":{retrieve:function(t){return{selectedKey:t.getSelectedKey()}},apply:function(t,e){if(e){t.setSelectedKey(e.selectedKey)}}},"sap.m.Select":{retrieve:function(t){return{selectedKey:t.getSelectedKey()}},apply:function(t,e){if(e){t.setSelectedKey(e.selectedKey)}}},"sap.f.DynamicPage":{retrieve:function(t){return{headerExpanded:t.getHeaderExpanded()}},apply:function(t,e){if(e){t.setHeaderExpanded(e.headerExpanded)}}},"sap.ui.core.mvc.View":{retrieve:function(t){const e=t.getController();if(e&&e.viewState){return e.viewState.retrieveViewState(e.viewState)}return{}},apply:function(t,e,r){const n=t.getController();if(n&&n.viewState){return n.viewState.applyViewState(e,r)}},refreshBinding:function(t){const e=t.getController();if(e&&e.viewState){return e.viewState.refreshViewBindings()}}},"sap.ui.core.ComponentContainer":{retrieve:function(t){const e=t.getComponentInstance();if(e){return this.retrieveControlState(e.getRootControl())}return{}},apply:function(t,e,r){const n=t.getComponentInstance();if(n){return this.applyControlState(n.getRootControl(),e,r)}}}};let ht=(f=ct("sap.fe.core.controllerextensions.ViewState"),d=at(),u=st(),y=at(),g=lt(s.After),S=pt(),h=st(),v=pt(),b=st(),w=at(),C=lt(s.After),O=at(),A=lt(s.After),m=at(),I=lt(s.After),P=pt(),R=st(),j=at(),_=lt(s.After),B=pt(),V=st(),E=at(),x=lt(s.After),D=at(),K=st(),H=at(),M=st(),k=at(),N=lt(s.After),F=pt(),T=st(),$=at(),U=lt(s.Instead),z=at(),L=st(),q=pt(),G=at(),Q=lt(s.After),J=at(),W=lt(s.After),X=at(),Y=lt(s.After),Z=pt(),tt=at(),et=lt(s.After),rt=pt(),nt=st(),f(it=(ot=function(r){ft(n,r);function n(){var e;e=r.call(this)||this;e.initialControlStatesMapper={};e.controlsVariantIdUnavailable=[];e.viewStateControls=[];e._setInitialStatesForDeltaCompute=async r=>{try{const t=e.viewStateControls;const n=[];const i=[];let o=[];const a=(r===null||r===void 0?void 0:r.getFor())??[];t.filter(function(t){return t&&(!r||a.indexOf(t.getId())>-1)&&(t.isA("sap.ui.mdc.Table")||t.isA("sap.ui.mdc.FilterBar")||t.isA("sap.ui.mdc.Chart"))}).forEach(t=>{if(r){e._addEventListenersToVariantManagement(r,a)}const o=c.retrieveExternalState(t);n.push(o);i.push(e.getStateKey(t))});o=await Promise.all(n);o.forEach((t,r)=>{e.initialControlStatesMapper[i[r]]=t})}catch(e){t.error(e)}};e._iRetrievingStateCounter=0;e._pInitialStateApplied=new Promise(t=>{e._pInitialStateAppliedResolve=t});return e}var i=n.prototype;i.refreshViewBindings=async function t(){const e=await this.collectResults(this.base.viewState.adaptBindingRefreshControls);let r=Promise.resolve();e.filter(t=>t&&t.isA&&t.isA("sap.ui.base.ManagedObject")).forEach(t=>{r=r.then(this.refreshControlBinding.bind(this,t))});return r};i.adaptBindingRefreshControls=function t(e){};i.refreshControlBinding=function e(r){const n=this.getControlRefreshBindingHandler(r);let i=Promise.resolve();if(typeof n.refreshBinding!=="function"){t.info(`refreshBinding handler for control: ${r.getMetadata().getName()} is not provided`)}else{i=i.then(n.refreshBinding.bind(this,r))}return i};i.getControlRefreshBindingHandler=function t(e){const r={};if(e){for(const t in St){if(e.isA(t)){r["refreshBinding"]=St[t].refreshBinding||{};break}}}this.base.viewState.adaptBindingRefreshHandler(e,r);return r};i.adaptBindingRefreshHandler=function t(e,r){};i.onSuspend=function t(){};i.onRestore=function t(){};i.destroy=function t(){delete this._pInitialStateAppliedResolve;r.prototype.destroy.call(this)};i.collectResults=function t(e){const r=[];for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++){i[o-1]=arguments[o]}i.push(r);e.apply(this,i);return Promise.all(r)};i.adaptControlStateHandler=function t(e,r){};i.getControlStateHandler=function t(e){const r=[],n=[];if(e){for(const t in St){if(e.isA(t)){r.push(Object.assign({},St[t]));break}}}this.base.viewState.adaptControlStateHandler(e,n);return r.concat(n)};i.adaptStateControls=function t(e){};i.getStateKey=function t(e){return this.getView().getLocalId(e.getId())||e.getId()};i.retrieveViewState=async function t(){++this._iRetrievingStateCounter;let r;try{await this._pInitialStateApplied;const t=await this.collectResults(this.base.viewState.adaptStateControls);const n=await Promise.all(t.filter(function(t){return t&&t.isA&&t.isA("sap.ui.base.ManagedObject")}).map(t=>this.retrieveControlState(t).then(e=>({key:this.getStateKey(t),value:e}))));r=n.reduce(function(t,r){const n={};n[r.key]=r.value;return e(t,n)},{});const i=await Promise.resolve(this._retrieveAdditionalStates());if(i&&Object.keys(i).length){r[yt]=i}}finally{--this._iRetrievingStateCounter}return this._iRetrievingStateCounter===0?r:undefined};i.retrieveAdditionalStates=function t(e){};i._retrieveAdditionalStates=function t(){const e={};this.base.viewState.retrieveAdditionalStates(e);return e};i.retrieveControlState=function t(r){const n=this.getControlStateHandler(r);return Promise.all(n.map(t=>{if(typeof t.retrieve!=="function"){throw new Error(`controlStateHandler.retrieve is not a function for control: ${r.getMetadata().getName()}`)}return t.retrieve.call(this,r)})).then(t=>t.reduce(function(t,r){return e(t,r)},{}))};i.applyInitialStateOnly=function t(){return true};i.applyViewState=async function e(r,n){if(this.base.viewState.applyInitialStateOnly()&&this._getInitialStateApplied()){return}try{await this.collectResults(this.base.viewState.onBeforeStateApplied);const e=await this.collectResults(this.base.viewState.adaptStateControls);this.viewStateControls=e;let i=Promise.resolve();let o=false;const a=e.reduce((t,e)=>{if(!e){return t}const r=e.isA("sap.ui.fl.variants.VariantManagement");if(!o){o=r}t=r?[e,...t]:[...t,e];return t},[]);if(!o){this._setInitialStatesForDeltaCompute()}a.filter(function(t){return t.isA("sap.ui.base.ManagedObject")}).forEach(t=>{const e=this.getStateKey(t);i=i.then(this.applyControlState.bind(this,t,r?r[e]:undefined,n))});await i;if(n.navigationType===gt.iAppState){await this.collectResults(this.base.viewState.applyAdditionalStates,r?r[yt]:undefined)}else{await this.collectResults(this.base.viewState.applyNavigationParameters,n);await this.collectResults(this.base.viewState._applyNavigationParametersToFilterbar,n)}}finally{try{await this.collectResults(this.base.viewState.onAfterStateApplied);this._setInitialStateApplied()}catch(e){t.error(e)}}};i._checkIfVariantIdIsAvailable=function t(e,r){const n=e.getVariants();let i=false;n.forEach(function(t){if(t.key===r){i=true}});return i};i._setInitialStateApplied=function t(){if(this._pInitialStateAppliedResolve){const t=this._pInitialStateAppliedResolve;delete this._pInitialStateAppliedResolve;t()}};i._getInitialStateApplied=function t(){return!this._pInitialStateAppliedResolve};i.onBeforeStateApplied=function t(e){};i.onAfterStateApplied=function t(e){};i.applyAdditionalStates=function t(e,r){};i._applyNavigationParametersToFilterbar=function t(e,r){};i.applyNavigationParameters=function t(e,r){};i.applyControlState=function t(e,r,n){const i=this.getControlStateHandler(e);let o=Promise.resolve();i.forEach(t=>{if(typeof t.apply!=="function"){throw new Error(`controlStateHandler.apply is not a function for control: ${e.getMetadata().getName()}`)}o=o.then(t.apply.bind(this,e,r,n))});return o};i.getInterface=function t(){return this};i._getControlState=function t(e,r){const n=this.initialControlStatesMapper;if(Object.keys(n).length>0&&n[e]){if(Object.keys(n[e]).length===0){n[e]={...r}}return{fullState:r,initialState:n[e]}}return r};i._addEventListenersToVariantManagement=function t(e,r){const n={variantManagedControls:r};const i=()=>{this._updateInitialStatesOnVariantChange(r)};e.attachSave(n,i,{});e.attachSelect(n,i,{})};i._updateInitialStatesOnVariantChange=function t(e){const r=this.initialControlStatesMapper;Object.keys(r).forEach(t=>{for(const n of e){if(n.indexOf(t)>-1){r[t]={}}}})};return n}(p),ut(ot.prototype,"refreshViewBindings",[d,u],Object.getOwnPropertyDescriptor(ot.prototype,"refreshViewBindings"),ot.prototype),ut(ot.prototype,"adaptBindingRefreshControls",[y,g],Object.getOwnPropertyDescriptor(ot.prototype,"adaptBindingRefreshControls"),ot.prototype),ut(ot.prototype,"refreshControlBinding",[S,h],Object.getOwnPropertyDescriptor(ot.prototype,"refreshControlBinding"),ot.prototype),ut(ot.prototype,"getControlRefreshBindingHandler",[v,b],Object.getOwnPropertyDescriptor(ot.prototype,"getControlRefreshBindingHandler"),ot.prototype),ut(ot.prototype,"adaptBindingRefreshHandler",[w,C],Object.getOwnPropertyDescriptor(ot.prototype,"adaptBindingRefreshHandler"),ot.prototype),ut(ot.prototype,"onSuspend",[O,A],Object.getOwnPropertyDescriptor(ot.prototype,"onSuspend"),ot.prototype),ut(ot.prototype,"onRestore",[m,I],Object.getOwnPropertyDescriptor(ot.prototype,"onRestore"),ot.prototype),ut(ot.prototype,"collectResults",[P,R],Object.getOwnPropertyDescriptor(ot.prototype,"collectResults"),ot.prototype),ut(ot.prototype,"adaptControlStateHandler",[j,_],Object.getOwnPropertyDescriptor(ot.prototype,"adaptControlStateHandler"),ot.prototype),ut(ot.prototype,"getControlStateHandler",[B,V],Object.getOwnPropertyDescriptor(ot.prototype,"getControlStateHandler"),ot.prototype),ut(ot.prototype,"adaptStateControls",[E,x],Object.getOwnPropertyDescriptor(ot.prototype,"adaptStateControls"),ot.prototype),ut(ot.prototype,"getStateKey",[D,K],Object.getOwnPropertyDescriptor(ot.prototype,"getStateKey"),ot.prototype),ut(ot.prototype,"retrieveViewState",[H,M],Object.getOwnPropertyDescriptor(ot.prototype,"retrieveViewState"),ot.prototype),ut(ot.prototype,"retrieveAdditionalStates",[k,N],Object.getOwnPropertyDescriptor(ot.prototype,"retrieveAdditionalStates"),ot.prototype),ut(ot.prototype,"retrieveControlState",[F,T],Object.getOwnPropertyDescriptor(ot.prototype,"retrieveControlState"),ot.prototype),ut(ot.prototype,"applyInitialStateOnly",[$,U],Object.getOwnPropertyDescriptor(ot.prototype,"applyInitialStateOnly"),ot.prototype),ut(ot.prototype,"applyViewState",[z,L],Object.getOwnPropertyDescriptor(ot.prototype,"applyViewState"),ot.prototype),ut(ot.prototype,"_checkIfVariantIdIsAvailable",[q],Object.getOwnPropertyDescriptor(ot.prototype,"_checkIfVariantIdIsAvailable"),ot.prototype),ut(ot.prototype,"onBeforeStateApplied",[G,Q],Object.getOwnPropertyDescriptor(ot.prototype,"onBeforeStateApplied"),ot.prototype),ut(ot.prototype,"onAfterStateApplied",[J,W],Object.getOwnPropertyDescriptor(ot.prototype,"onAfterStateApplied"),ot.prototype),ut(ot.prototype,"applyAdditionalStates",[X,Y],Object.getOwnPropertyDescriptor(ot.prototype,"applyAdditionalStates"),ot.prototype),ut(ot.prototype,"_applyNavigationParametersToFilterbar",[Z],Object.getOwnPropertyDescriptor(ot.prototype,"_applyNavigationParametersToFilterbar"),ot.prototype),ut(ot.prototype,"applyNavigationParameters",[tt,et],Object.getOwnPropertyDescriptor(ot.prototype,"applyNavigationParameters"),ot.prototype),ut(ot.prototype,"applyControlState",[rt,nt],Object.getOwnPropertyDescriptor(ot.prototype,"applyControlState"),ot.prototype),ot))||it);return ht},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/ActivityBase-dbg", ["sap/base/Log", "sap/base/util/UriParameters", "sap/fe/core/controllerextensions/collaboration/CollaborationCommon", "sap/ui/core/ws/SapPcpWebSocket"], function (Log, UriParameters, CollaborationCommon, SapPcpWebSocket) {
  "use strict";

  var _exports = {};
  var SUPPORTED_PROTOCOLS = SapPcpWebSocket.SUPPORTED_PROTOCOLS;
  var Activity = CollaborationCommon.Activity;
  const COLLABORATION = "/collaboration";
  const CONNECTED = "/collaboration/connected";
  const CONNECTION = "/collaboration/connection";
  const CURRENTDRAFTID = "/collaboration/DraftID";
  function isCollaborationConnected(internalModel) {
    return !!internalModel.getProperty(CONNECTED);
  }
  _exports.isCollaborationConnected = isCollaborationConnected;
  function initializeCollaboration(user, webSocketBaseURL, draftUUID, serviceUrl, internalModel, receiveCallback) {
    let sendUserInfo = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : false;
    if (internalModel.getProperty(CONNECTION)) {
      // A connection is already established
      if (internalModel.getProperty(CURRENTDRAFTID) === draftUUID) {
        // Connection corresponds to the same draft -> nothing to do
        return;
      } else {
        // There was a connection to another draft -> we close it before creating a new one
        // This can happen e.g. when switching between items in FCL
        endCollaboration(internalModel);
      }
    }
    const activeUsers = [user];
    internalModel.setProperty(COLLABORATION, {
      activeUsers: activeUsers,
      activities: {}
    });
    sendUserInfo = sendUserInfo || UriParameters.fromQuery(window.location.search).get("useFLPUser") === "true";
    const webSocket = createWebSocket(user, webSocketBaseURL, draftUUID, serviceUrl, sendUserInfo);
    internalModel.setProperty(CONNECTION, webSocket);
    internalModel.setProperty(CURRENTDRAFTID, draftUUID);
    webSocket.attachMessage(function (event) {
      const message = event.getParameter("pcpFields");
      receiveCallback(message);
    });
    webSocket.attachOpen(function () {
      internalModel.setProperty(CONNECTED, true);
    });
    webSocket.attachError(function () {
      Log.error(`The connection to the websocket channel ${webSocketBaseURL} could not be established`);
      internalModel.setProperty(CONNECTED, false);
    });
    webSocket.attachClose(function () {
      internalModel.setProperty(CONNECTED, false);
    });
  }
  _exports.initializeCollaboration = initializeCollaboration;
  function broadcastCollaborationMessage(action, content, internalModel, triggeredActionName) {
    if (isCollaborationConnected(internalModel)) {
      const webSocket = internalModel.getProperty(CONNECTION);
      webSocket.send("", {
        clientAction: action,
        clientContent: content,
        clientTriggeredActionName: triggeredActionName
      });
      if (action === Activity.Activate || action === Activity.Discard) {
        endCollaboration(internalModel);
      }
    }
  }
  _exports.broadcastCollaborationMessage = broadcastCollaborationMessage;
  function endCollaboration(internalModel) {
    const webSocket = internalModel.getProperty(CONNECTION);
    webSocket === null || webSocket === void 0 ? void 0 : webSocket.close();
    internalModel.setProperty(CONNECTION, null);
    internalModel.setProperty(CURRENTDRAFTID, undefined);
  }
  _exports.endCollaboration = endCollaboration;
  function createWebSocket(user, socketBaseURL, draftUUID, serviceUrl) {
    let sendUserInfo = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
    const hostLocation = window.location;
    let socketURI;

    // Support useBackendUrl for local testing
    const useBackendUrl = UriParameters.fromQuery(window.location.search).get("useBackendUrl");
    if (useBackendUrl) {
      socketURI = useBackendUrl.replace("https", "wss");
    } else {
      socketURI = hostLocation.protocol === "https:" ? "wss:" : "ws:";
      socketURI += `//${hostLocation.host}`;
    }
    socketURI += `${(socketBaseURL.startsWith("/") ? "" : "/") + socketBaseURL}?draft=${draftUUID}&relatedService=${serviceUrl}`;
    if (sendUserInfo) {
      socketURI += `&userID=${encodeURI(user.id)}&userName=${encodeURI(user.initialName || "")}`;
    }
    return new SapPcpWebSocket(socketURI, [SUPPORTED_PROTOCOLS.v10]);
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/ActivityBase", ["sap/base/Log","sap/base/util/UriParameters","sap/fe/core/controllerextensions/collaboration/CollaborationCommon","sap/ui/core/ws/SapPcpWebSocket"],function(e,t,o,n){"use strict";var r={};var a=n.SUPPORTED_PROTOCOLS;var i=o.Activity;const s="/collaboration";const c="/collaboration/connected";const l="/collaboration/connection";const u="/collaboration/DraftID";function f(e){return!!e.getProperty(c)}r.isCollaborationConnected=f;function d(o,n,r,a,i,f){let d=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;if(i.getProperty(l)){if(i.getProperty(u)===r){return}else{P(i)}}const p=[o];i.setProperty(s,{activeUsers:p,activities:{}});d=d||t.fromQuery(window.location.search).get("useFLPUser")==="true";const h=b(o,n,r,a,d);i.setProperty(l,h);i.setProperty(u,r);h.attachMessage(function(e){const t=e.getParameter("pcpFields");f(t)});h.attachOpen(function(){i.setProperty(c,true)});h.attachError(function(){e.error(`The connection to the websocket channel ${n} could not be established`);i.setProperty(c,false)});h.attachClose(function(){i.setProperty(c,false)})}r.initializeCollaboration=d;function p(e,t,o,n){if(f(o)){const r=o.getProperty(l);r.send("",{clientAction:e,clientContent:t,clientTriggeredActionName:n});if(e===i.Activate||e===i.Discard){P(o)}}}r.broadcastCollaborationMessage=p;function P(e){const t=e.getProperty(l);t===null||t===void 0?void 0:t.close();e.setProperty(l,null);e.setProperty(u,undefined)}r.endCollaboration=P;function b(e,o,r,i){let s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;const c=window.location;let l;const u=t.fromQuery(window.location.search).get("useBackendUrl");if(u){l=u.replace("https","wss")}else{l=c.protocol==="https:"?"wss:":"ws:";l+=`//${c.host}`}l+=`${(o.startsWith("/")?"":"/")+o}?draft=${r}&relatedService=${i}`;if(s){l+=`&userID=${encodeURI(e.id)}&userName=${encodeURI(e.initialName||"")}`}return new n(l,[a.v10])}return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/ActivitySync-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/collaboration/ActivityBase", "sap/fe/core/controllerextensions/collaboration/CollaborationCommon", "sap/m/MessageBox"], function (Log, CommonUtils, ActivityBase, CollaborationCommon, MessageBox) {
  "use strict";

  var _exports = {};
  var CollaborationUtils = CollaborationCommon.CollaborationUtils;
  var Activity = CollaborationCommon.Activity;
  var isCollaborationConnected = ActivityBase.isCollaborationConnected;
  var initializeCollaboration = ActivityBase.initializeCollaboration;
  var endCollaboration = ActivityBase.endCollaboration;
  var broadcastCollaborationMessage = ActivityBase.broadcastCollaborationMessage;
  const MYACTIVITY = "/collaboration/myActivity";
  const ACTIVEUSERS = "/collaboration/activeUsers";
  const ACTIVITIES = "/collaboration/activities";
  const SYNCGROUPID = "$auto.sync";
  const isConnected = function (control) {
    const internalModel = control.getModel("internal");
    return isCollaborationConnected(internalModel);
  };
  _exports.isConnected = isConnected;
  const send = function (control, action, content, triggeredActionName) {
    if (isConnected(control)) {
      const internalModel = control.getModel("internal");
      const clientContent = Array.isArray(content) ? content.join("|") : content;
      const myActivity = internalModel.getProperty(MYACTIVITY);
      if (action === Activity.LiveChange) {
        // To avoid unnecessary traffic we keep track of live changes and send it only once

        if (myActivity === clientContent) {
          return;
        } else {
          internalModel.setProperty(MYACTIVITY, clientContent);
        }
      } else {
        // No need to send an Undo message if there's no current activity
        if (action === Activity.Undo && myActivity === null) {
          return;
        }

        // user finished the activity
        internalModel.setProperty(MYACTIVITY, null);
      }
      broadcastCollaborationMessage(action, clientContent, internalModel, triggeredActionName);
    }
  };
  _exports.send = send;
  const getWebSocketBaseURL = function (bindingContext) {
    return bindingContext.getModel().getMetaModel().getObject("/@com.sap.vocabularies.Common.v1.WebSocketBaseURL");
  };
  const isCollaborationEnabled = function (view) {
    const bindingContext = (view === null || view === void 0 ? void 0 : view.getBindingContext) && view.getBindingContext();
    return !!(bindingContext && getWebSocketBaseURL(bindingContext));
  };
  _exports.isCollaborationEnabled = isCollaborationEnabled;
  const connect = async function (view) {
    const internalModel = view.getModel("internal");
    const me = CollaborationUtils.getMe(view);

    // Retrieving ME from shell service
    if (!me) {
      // no me = no shell = not sure what to do
      return;
    }
    const bindingContext = view.getBindingContext();
    const webSocketBaseURL = getWebSocketBaseURL(bindingContext);
    const serviceUrl = bindingContext.getModel().getServiceUrl();
    if (!webSocketBaseURL) {
      return;
    }
    const sDraftUUID = await bindingContext.requestProperty("DraftAdministrativeData/DraftUUID");
    if (!sDraftUUID) {
      return;
    }
    initializeCollaboration(me, webSocketBaseURL, sDraftUUID, serviceUrl, internalModel, message => {
      messageReceive(message, view);
    });
  };
  _exports.connect = connect;
  const disconnect = function (control) {
    const internalModel = control.getModel("internal");
    endCollaboration(internalModel);
  };
  _exports.disconnect = disconnect;
  function messageReceive(message, view) {
    var _message$clientConten, _activities;
    const internalModel = view.getModel("internal");
    let activeUsers = internalModel.getProperty(ACTIVEUSERS);
    let activities;
    let activityKey;
    const metaPath = calculateMetaPath(view, message.clientContent);
    message.userAction = message.userAction || message.clientAction;
    const sender = {
      id: message.userID,
      name: message.userDescription,
      initials: CollaborationUtils.formatInitials(message.userDescription),
      color: CollaborationUtils.getUserColor(message.userID, activeUsers, [])
    };
    let mactivity = sender;

    // eslint-disable-next-line default-case
    switch (message.userAction) {
      case Activity.Join:
      case Activity.JoinEcho:
        if (activeUsers.findIndex(user => user.id === sender.id) === -1) {
          activeUsers.unshift(sender);
          internalModel.setProperty(ACTIVEUSERS, activeUsers);
        }
        if (message.userAction === Activity.Join) {
          // we echo our existence to the newly entered user and also send the current activity if there is any
          broadcastCollaborationMessage(Activity.JoinEcho, internalModel.getProperty(MYACTIVITY), internalModel);
        }
        if (message.userAction === Activity.JoinEcho) {
          if (message.clientContent) {
            // another user was already typing therefore I want to see his activity immediately. Calling me again as a live change
            message.userAction = Activity.LiveChange;
            messageReceive(message, view);
          }
        }
        break;
      case Activity.Leave:
        // Removing the active user. Not removing "me" if I had the screen open in another session
        activeUsers = activeUsers.filter(user => user.id !== sender.id || user.me);
        internalModel.setProperty(ACTIVEUSERS, activeUsers);
        const allActivities = internalModel.getProperty(ACTIVITIES) || {};
        const removeUserActivities = function (bag) {
          if (Array.isArray(bag)) {
            return bag.filter(activity => activity.id !== sender.id);
          } else {
            for (const p in bag) {
              bag[p] = removeUserActivities(bag[p]);
            }
            return bag;
          }
        };
        removeUserActivities(allActivities);
        internalModel.setProperty(ACTIVITIES, allActivities);
        break;
      case Activity.Change:
        const metaPaths = message === null || message === void 0 ? void 0 : (_message$clientConten = message.clientContent) === null || _message$clientConten === void 0 ? void 0 : _message$clientConten.split("|").map(path => {
          return view.getModel().getMetaModel().getMetaPath(path);
        });
        metaPaths.forEach((currentMetaPath, i) => {
          var _message$clientConten2, _currentActivities;
          const nesteedMessage = {
            ...message,
            clientContent: message === null || message === void 0 ? void 0 : (_message$clientConten2 = message.clientContent) === null || _message$clientConten2 === void 0 ? void 0 : _message$clientConten2.split("|")[i]
          };
          let currentActivities = internalModel.getProperty(ACTIVITIES + currentMetaPath) || [];
          activityKey = getActivityKey(nesteedMessage.clientContent);
          currentActivities = ((_currentActivities = currentActivities) === null || _currentActivities === void 0 ? void 0 : _currentActivities.filter) && currentActivities.filter(activity => activity.key !== activityKey);
          if (currentActivities) {
            internalModel.setProperty(ACTIVITIES + currentMetaPath, currentActivities);
            update(view, nesteedMessage, currentMetaPath, Activity.Change);
          }
        });
        break;
      case Activity.Create:
        // For create we actually just need to refresh the table
        update(view, message, metaPath, Activity.Create);
        break;
      case Activity.Delete:
        // For now also refresh the page but in case of deletion we need to inform the user
        update(view, message, metaPath, Activity.Delete);
        break;
      case Activity.Activate:
        draftClosedByOtherUser(view, message, CollaborationUtils.getText("C_COLLABORATIONDRAFT_ACTIVATE", sender.name));
        break;
      case Activity.Discard:
        draftClosedByOtherUser(view, message, CollaborationUtils.getText("C_COLLABORATIONDRAFT_DISCARD", sender.name));
        break;
      case Activity.Action:
        update(view, message, metaPath, Activity.Action);
        break;
      case Activity.LiveChange:
        mactivity = sender;
        mactivity.key = getActivityKey(message.clientContent);

        // stupid JSON model...
        let initJSONModel = "";
        const parts = metaPath.split("/");
        for (let i = 1; i < parts.length - 1; i++) {
          initJSONModel += `/${parts[i]}`;
          if (!internalModel.getProperty(ACTIVITIES + initJSONModel)) {
            internalModel.setProperty(ACTIVITIES + initJSONModel, {});
          }
        }
        activities = internalModel.getProperty(ACTIVITIES + metaPath);
        activities = (_activities = activities) !== null && _activities !== void 0 && _activities.slice ? activities.slice() : [];
        activities.push(mactivity);
        internalModel.setProperty(ACTIVITIES + metaPath, activities);
        break;
      case Activity.Undo:
        // The user did a change but reverted it, therefore unblock the control
        activities = internalModel.getProperty(ACTIVITIES + metaPath);
        activityKey = getActivityKey(message.clientContent);
        internalModel.setProperty(ACTIVITIES + metaPath, activities.filter(a => a.key !== activityKey));
        break;
    }
  }
  function draftClosedByOtherUser(view, message, text) {
    disconnect(view);
    MessageBox.information(text);
    view.getBindingContext().getBinding().resetChanges().then(function () {
      navigate(message.clientContent, view);
    }).catch(function () {
      Log.error("Pending Changes could not be reset - still navigating to active instance");
      navigate(message.clientContent, view);
    });
  }
  function update(view, message, metaPath, action) {
    const appComponent = CollaborationUtils.getAppComponent(view);
    const metaModel = view.getModel().getMetaModel();
    const currentPage = getCurrentPage(view);
    const sideEffectsService = appComponent.getSideEffectsService();
    const currentContext = currentPage.getBindingContext();
    const currentPath = currentContext.getPath();
    const currentMetaPath = metaModel.getMetaPath(currentPath);
    let changedDocument = message.clientContent;
    if (action === Activity.Delete) {
      // check if user currently displays one deleted object
      const deletedObjects = message.clientContent.split("|");
      const parentDeletedIndex = deletedObjects.findIndex(deletedObject => currentPath.startsWith(deletedObject));
      if (parentDeletedIndex > -1) {
        // any other user deleted the object I'm currently looking at. Inform the user we will navigate to root now
        MessageBox.information(CollaborationUtils.getText("C_COLLABORATIONDRAFT_DELETE", message.userDescription), {
          onClose: function () {
            const targetContext = view.getModel().bindContext(deletedObjects[parentDeletedIndex]).getBoundContext();
            currentPage.getController()._routing.navigateBackFromContext(targetContext);
          }
        });
      }
      // TODO: For now just take the first object to get the meta path and do a full refresh of the table
      changedDocument = deletedObjects[0];
    }
    if (action === Activity.Action) {
      const actionName = message.clientTriggeredActionName,
        bindingParameters = sideEffectsService.getODataActionSideEffects(actionName, currentContext),
        targetPaths = bindingParameters === null || bindingParameters === void 0 ? void 0 : bindingParameters.pathExpressions;
      if (targetPaths && targetPaths.length > 0) {
        sideEffectsService.requestSideEffects(targetPaths, currentContext, SYNCGROUPID);
      }
    }
    if (changedDocument.startsWith(currentPath)) {
      // Execute SideEffects (TODO for Meet there should be one central method)
      const activityPath = metaPath.replace(currentMetaPath, "").slice(1);
      if (activityPath) {
        // Request also the property itself
        const sideEffects = [{
          $PropertyPath: activityPath
        }];
        const entityType = sideEffectsService.getEntityTypeFromContext(currentContext);
        const entityTypeSideEffects = sideEffectsService.getODataEntitySideEffects(entityType);
        // Poor man solution without checking source targets, just for POC, this is throw-way coding only
        const object = Object; // just to overcome TS issues, will be anyway replaced
        const relevantSideEffects = object.fromEntries(object.entries(entityTypeSideEffects).filter(x => {
          var _x$1$SourceProperties;
          return ((_x$1$SourceProperties = x[1].SourceProperties) === null || _x$1$SourceProperties === void 0 ? void 0 : _x$1$SourceProperties.findIndex(source => source.value === activityPath)) > -1;
        }));
        for (const p in relevantSideEffects) {
          relevantSideEffects[p].TargetProperties.forEach(function (targetProperty) {
            sideEffects.push({
              $PropertyPath: targetProperty
            });
          });
        }
        sideEffectsService.requestSideEffects(sideEffects, currentContext, SYNCGROUPID);
      }
    }

    // Simulate any change so the edit flow shows the draft indicator and sets the page to dirty
    currentPage.getController().editFlow.updateDocument(currentContext, Promise.resolve());
  }
  function navigate(path, view) {
    // TODO: routing.navigate doesn't consider semantic bookmarking
    const currentPage = getCurrentPage(view);
    const targetContext = view.getModel().bindContext(path).getBoundContext();
    currentPage.getController().routing.navigate(targetContext);
  }
  function getCurrentPage(view) {
    const appComponent = CollaborationUtils.getAppComponent(view);
    return CommonUtils.getCurrentPageView(appComponent);
  }
  function getActivityKey(x) {
    return x.substring(x.lastIndexOf("(") + 1, x.lastIndexOf(")"));
  }

  /**
   * Calculates the metapath from one or more data path(s).
   *
   * @param view The current view
   * @param path One ore more data path(s), in case of multiple paths separated by '|'
   * @returns The calculated metaPath
   */
  function calculateMetaPath(view, path) {
    let metaPath = "";
    if (path) {
      // in case more than one path is sent all of them have to use the same metapath therefore we just consider the first one
      const dataPath = path.split("|")[0];
      metaPath = view.getModel().getMetaModel().getMetaPath(dataPath);
    }
    return metaPath;
  }
  return {
    connect: connect,
    disconnect: disconnect,
    isConnected: isConnected,
    isCollaborationEnabled: isCollaborationEnabled,
    send: send
  };
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/ActivitySync", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/collaboration/ActivityBase","sap/fe/core/controllerextensions/collaboration/CollaborationCommon","sap/m/MessageBox"],function(t,e,n,o,i){"use strict";var r={};var s=o.CollaborationUtils;var c=o.Activity;var a=n.isCollaborationConnected;var l=n.initializeCollaboration;var d=n.endCollaboration;var g=n.broadcastCollaborationMessage;const f="/collaboration/myActivity";const u="/collaboration/activeUsers";const C="/collaboration/activities";const p="$auto.sync";const v=function(t){const e=t.getModel("internal");return a(e)};r.isConnected=v;const y=function(t,e,n,o){if(v(t)){const i=t.getModel("internal");const r=Array.isArray(n)?n.join("|"):n;const s=i.getProperty(f);if(e===c.LiveChange){if(s===r){return}else{i.setProperty(f,r)}}else{if(e===c.Undo&&s===null){return}i.setProperty(f,null)}g(e,r,i,o)}};r.send=y;const b=function(t){return t.getModel().getMetaModel().getObject("/@com.sap.vocabularies.Common.v1.WebSocketBaseURL")};const A=function(t){const e=(t===null||t===void 0?void 0:t.getBindingContext)&&t.getBindingContext();return!!(e&&b(e))};r.isCollaborationEnabled=A;const P=async function(t){const e=t.getModel("internal");const n=s.getMe(t);if(!n){return}const o=t.getBindingContext();const i=b(o);const r=o.getModel().getServiceUrl();if(!i){return}const c=await o.requestProperty("DraftAdministrativeData/DraftUUID");if(!c){return}l(n,i,c,r,e,e=>{m(e,t)})};r.connect=P;const h=function(t){const e=t.getModel("internal");d(e)};r.disconnect=h;function m(t,e){var n,o;const i=e.getModel("internal");let r=i.getProperty(u);let a;let l;const d=B(e,t.clientContent);t.userAction=t.userAction||t.clientAction;const p={id:t.userID,name:t.userDescription,initials:s.formatInitials(t.userDescription),color:s.getUserColor(t.userID,r,[])};let v=p;switch(t.userAction){case c.Join:case c.JoinEcho:if(r.findIndex(t=>t.id===p.id)===-1){r.unshift(p);i.setProperty(u,r)}if(t.userAction===c.Join){g(c.JoinEcho,i.getProperty(f),i)}if(t.userAction===c.JoinEcho){if(t.clientContent){t.userAction=c.LiveChange;m(t,e)}}break;case c.Leave:r=r.filter(t=>t.id!==p.id||t.me);i.setProperty(u,r);const y=i.getProperty(C)||{};const b=function(t){if(Array.isArray(t)){return t.filter(t=>t.id!==p.id)}else{for(const e in t){t[e]=b(t[e])}return t}};b(y);i.setProperty(C,y);break;case c.Change:const A=t===null||t===void 0?void 0:(n=t.clientContent)===null||n===void 0?void 0:n.split("|").map(t=>e.getModel().getMetaModel().getMetaPath(t));A.forEach((n,o)=>{var r,s;const a={...t,clientContent:t===null||t===void 0?void 0:(r=t.clientContent)===null||r===void 0?void 0:r.split("|")[o]};let d=i.getProperty(C+n)||[];l=k(a.clientContent);d=((s=d)===null||s===void 0?void 0:s.filter)&&d.filter(t=>t.key!==l);if(d){i.setProperty(C+n,d);x(e,a,n,c.Change)}});break;case c.Create:x(e,t,d,c.Create);break;case c.Delete:x(e,t,d,c.Delete);break;case c.Activate:M(e,t,s.getText("C_COLLABORATIONDRAFT_ACTIVATE",p.name));break;case c.Discard:M(e,t,s.getText("C_COLLABORATIONDRAFT_DISCARD",p.name));break;case c.Action:x(e,t,d,c.Action);break;case c.LiveChange:v=p;v.key=k(t.clientContent);let P="";const h=d.split("/");for(let t=1;t<h.length-1;t++){P+=`/${h[t]}`;if(!i.getProperty(C+P)){i.setProperty(C+P,{})}}a=i.getProperty(C+d);a=(o=a)!==null&&o!==void 0&&o.slice?a.slice():[];a.push(v);i.setProperty(C+d,a);break;case c.Undo:a=i.getProperty(C+d);l=k(t.clientContent);i.setProperty(C+d,a.filter(t=>t.key!==l));break}}function M(e,n,o){h(e);i.information(o);e.getBindingContext().getBinding().resetChanges().then(function(){D(n.clientContent,e)}).catch(function(){t.error("Pending Changes could not be reset - still navigating to active instance");D(n.clientContent,e)})}function x(t,e,n,o){const r=s.getAppComponent(t);const a=t.getModel().getMetaModel();const l=E(t);const d=r.getSideEffectsService();const g=l.getBindingContext();const f=g.getPath();const u=a.getMetaPath(f);let C=e.clientContent;if(o===c.Delete){const n=e.clientContent.split("|");const o=n.findIndex(t=>f.startsWith(t));if(o>-1){i.information(s.getText("C_COLLABORATIONDRAFT_DELETE",e.userDescription),{onClose:function(){const e=t.getModel().bindContext(n[o]).getBoundContext();l.getController()._routing.navigateBackFromContext(e)}})}C=n[0]}if(o===c.Action){const t=e.clientTriggeredActionName,n=d.getODataActionSideEffects(t,g),o=n===null||n===void 0?void 0:n.pathExpressions;if(o&&o.length>0){d.requestSideEffects(o,g,p)}}if(C.startsWith(f)){const t=n.replace(u,"").slice(1);if(t){const e=[{$PropertyPath:t}];const n=d.getEntityTypeFromContext(g);const o=d.getODataEntitySideEffects(n);const i=Object;const r=i.fromEntries(i.entries(o).filter(e=>{var n;return((n=e[1].SourceProperties)===null||n===void 0?void 0:n.findIndex(e=>e.value===t))>-1}));for(const t in r){r[t].TargetProperties.forEach(function(t){e.push({$PropertyPath:t})})}d.requestSideEffects(e,g,p)}}l.getController().editFlow.updateDocument(g,Promise.resolve())}function D(t,e){const n=E(e);const o=e.getModel().bindContext(t).getBoundContext();n.getController().routing.navigate(o)}function E(t){const n=s.getAppComponent(t);return e.getCurrentPageView(n)}function k(t){return t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))}function B(t,e){let n="";if(e){const o=e.split("|")[0];n=t.getModel().getMetaModel().getMetaPath(o)}return n}return{connect:P,disconnect:h,isConnected:v,isCollaborationEnabled:A,send:y}},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/CollaborationCommon-dbg", ["sap/fe/core/helpers/BindingToolkit", "sap/ui/core/Component", "sap/ui/core/Core", "../../formatters/CollaborationFormatter"], function (BindingToolkit, Component, Core, collaborationFormatter) {
  "use strict";

  var _exports = {};
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var formatResult = BindingToolkit.formatResult;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  let UserStatus;
  (function (UserStatus) {
    UserStatus[UserStatus["NotYetInvited"] = 0] = "NotYetInvited";
    UserStatus[UserStatus["NoChangesMade"] = 1] = "NoChangesMade";
    UserStatus[UserStatus["ChangesMade"] = 2] = "ChangesMade";
    UserStatus[UserStatus["CurrentlyEditing"] = 3] = "CurrentlyEditing";
  })(UserStatus || (UserStatus = {}));
  _exports.UserStatus = UserStatus;
  let UserEditingState;
  (function (UserEditingState) {
    UserEditingState["NoChanges"] = "N";
    UserEditingState["InProgress"] = "P";
  })(UserEditingState || (UserEditingState = {}));
  _exports.UserEditingState = UserEditingState;
  let Activity;
  (function (Activity) {
    Activity["Join"] = "JOIN";
    Activity["JoinEcho"] = "JOINECHO";
    Activity["Leave"] = "LEAVE";
    Activity["Change"] = "CHANGE";
    Activity["Create"] = "CREATE";
    Activity["Delete"] = "DELETE";
    Activity["Action"] = "ACTION";
    Activity["LiveChange"] = "LIVECHANGE";
    Activity["Activate"] = "ACTIVATE";
    Activity["Discard"] = "DISCARD";
    Activity["Undo"] = "UNDO";
  })(Activity || (Activity = {}));
  _exports.Activity = Activity;
  function formatInitials(fullName) {
    // remove titles - those are the ones from S/4 to be checked if there are others
    const academicTitles = ["Dr.", "Prof.", "Prof. Dr.", "B.A.", "MBA", "Ph.D."];
    academicTitles.forEach(function (academicTitle) {
      fullName = fullName.replace(academicTitle, "");
    });
    let initials;
    const parts = fullName.trimStart().split(" ");
    if (parts.length > 1) {
      var _parts$shift, _parts$pop;
      initials = ((parts === null || parts === void 0 ? void 0 : (_parts$shift = parts.shift()) === null || _parts$shift === void 0 ? void 0 : _parts$shift.charAt(0)) || "") + ((_parts$pop = parts.pop()) === null || _parts$pop === void 0 ? void 0 : _parts$pop.charAt(0));
    } else {
      initials = fullName.substring(0, 2);
    }
    return initials.toUpperCase();
  }
  function getUserColor(UserID, activeUsers, invitedUsers) {
    // search if user is known
    const user = activeUsers.find(u => u.id === UserID);
    if (user) {
      return user.color;
    } else {
      // search for next free color
      for (let i = 1; i <= 10; i++) {
        if (activeUsers.findIndex(u => u.color === i) === -1 && invitedUsers.findIndex(u => u.color === i) === -1) {
          return i;
        }
      }
      // this seems to be a popular object :) for now just return 10 for all.
      // for invited we should start from 1 again so the colors are different
      return 10;
    }
  }

  // copied from CommonUtils. Due to a cycle dependency I can't use CommonUtils here.
  // That's to be fixed. the discard popover thingy shouldn't be in the common utils at all
  function getAppComponent(oControl) {
    if (oControl.isA("sap.fe.core.AppComponent")) {
      return oControl;
    }
    const oOwner = Component.getOwnerComponentFor(oControl);
    if (!oOwner) {
      return oControl;
    } else {
      return getAppComponent(oOwner);
    }
  }
  function getMe(view) {
    const shellServiceHelper = getAppComponent(view).getShellServices();
    if (!shellServiceHelper || !shellServiceHelper.hasUShell()) {
      throw "No Shell... No User";
    }
    return {
      initials: shellServiceHelper.getUser().getInitials(),
      id: shellServiceHelper.getUser().getId(),
      name: `${shellServiceHelper.getUser().getFullName()} (${getText("C_COLLABORATIONDRAFT_YOU")})`,
      initialName: shellServiceHelper.getUser().getFullName(),
      color: 6,
      //  same color as FLP...
      me: true,
      status: UserStatus.CurrentlyEditing
    };
  }
  function getText(textId) {
    const oResourceModel = Core.getLibraryResourceBundle("sap.fe.core");
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }
    return oResourceModel.getText(textId, args);
  }

  /**
   * Generate the expression binding of the Invitation dialog.
   *
   * @param dataModelPath The DataModelObjectPath
   * @returns The dialog title binding expression
   */
  _exports.getText = getText;
  function getInvitationDialogTitleExpBinding(dataModelPath) {
    var _headerInfo$Title;
    const headerInfo = dataModelPath.targetObject;
    const title = getExpressionFromAnnotation((_headerInfo$Title = headerInfo.Title) === null || _headerInfo$Title === void 0 ? void 0 : _headerInfo$Title.Value, [], "");
    const params = ["C_COLLABORATIONDRAFT_INVITATION_DIALOG", constant(headerInfo.TypeName), title];
    const titleExpression = formatResult(params, collaborationFormatter.getFormattedText);
    return compileExpression(titleExpression);
  }
  _exports.getInvitationDialogTitleExpBinding = getInvitationDialogTitleExpBinding;
  const CollaborationUtils = {
    formatInitials: formatInitials,
    getUserColor: getUserColor,
    getMe: getMe,
    getAppComponent: getAppComponent,
    getText: getText,
    getInvitationDialogTitleExpBinding: getInvitationDialogTitleExpBinding
  };
  _exports.CollaborationUtils = CollaborationUtils;
  function shareObject(bindingContext) {
    let users = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    const model = bindingContext.getModel();
    const metaModel = model.getMetaModel();
    const entitySet = metaModel.getMetaPath(bindingContext);
    const shareActionName = metaModel.getObject(`${entitySet}@com.sap.vocabularies.Common.v1.DraftRoot/ShareAction`);
    const shareAction = model.bindContext(`${shareActionName}(...)`, bindingContext);
    shareAction.setParameter("Users", users);
    shareAction.setParameter("ShareAll", true);
    return shareAction.execute();
  }
  _exports.shareObject = shareObject;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/CollaborationCommon", ["sap/fe/core/helpers/BindingToolkit","sap/ui/core/Component","sap/ui/core/Core","../../formatters/CollaborationFormatter"],function(e,t,n,o){"use strict";var r={};var i=e.getExpressionFromAnnotation;var a=e.formatResult;var s=e.constant;var l=e.compileExpression;let c;(function(e){e[e["NotYetInvited"]=0]="NotYetInvited";e[e["NoChangesMade"]=1]="NoChangesMade";e[e["ChangesMade"]=2]="ChangesMade";e[e["CurrentlyEditing"]=3]="CurrentlyEditing"})(c||(c={}));r.UserStatus=c;let u;(function(e){e["NoChanges"]="N";e["InProgress"]="P"})(u||(u={}));r.UserEditingState=u;let g;(function(e){e["Join"]="JOIN";e["JoinEcho"]="JOINECHO";e["Leave"]="LEAVE";e["Change"]="CHANGE";e["Create"]="CREATE";e["Delete"]="DELETE";e["Action"]="ACTION";e["LiveChange"]="LIVECHANGE";e["Activate"]="ACTIVATE";e["Discard"]="DISCARD";e["Undo"]="UNDO"})(g||(g={}));r.Activity=g;function d(e){const t=["Dr.","Prof.","Prof. Dr.","B.A.","MBA","Ph.D."];t.forEach(function(t){e=e.replace(t,"")});let n;const o=e.trimStart().split(" ");if(o.length>1){var r,i;n=((o===null||o===void 0?void 0:(r=o.shift())===null||r===void 0?void 0:r.charAt(0))||"")+((i=o.pop())===null||i===void 0?void 0:i.charAt(0))}else{n=e.substring(0,2)}return n.toUpperCase()}function f(e,t,n){const o=t.find(t=>t.id===e);if(o){return o.color}else{for(let e=1;e<=10;e++){if(t.findIndex(t=>t.color===e)===-1&&n.findIndex(t=>t.color===e)===-1){return e}}return 10}}function C(e){if(e.isA("sap.fe.core.AppComponent")){return e}const n=t.getOwnerComponentFor(e);if(!n){return e}else{return C(n)}}function A(e){const t=C(e).getShellServices();if(!t||!t.hasUShell()){throw"No Shell... No User"}return{initials:t.getUser().getInitials(),id:t.getUser().getId(),name:`${t.getUser().getFullName()} (${p("C_COLLABORATIONDRAFT_YOU")})`,initialName:t.getUser().getFullName(),color:6,me:true,status:c.CurrentlyEditing}}function p(e){const t=n.getLibraryResourceBundle("sap.fe.core");for(var o=arguments.length,r=new Array(o>1?o-1:0),i=1;i<o;i++){r[i-1]=arguments[i]}return t.getText(e,r)}r.getText=p;function v(e){var t;const n=e.targetObject;const r=i((t=n.Title)===null||t===void 0?void 0:t.Value,[],"");const c=["C_COLLABORATIONDRAFT_INVITATION_DIALOG",s(n.TypeName),r];const u=a(c,o.getFormattedText);return l(u)}r.getInvitationDialogTitleExpBinding=v;const h={formatInitials:d,getUserColor:f,getMe:A,getAppComponent:C,getText:p,getInvitationDialogTitleExpBinding:v};r.CollaborationUtils=h;function m(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];const n=e.getModel();const o=n.getMetaModel();const r=o.getMetaPath(e);const i=o.getObject(`${r}@com.sap.vocabularies.Common.v1.DraftRoot/ShareAction`);const a=n.bindContext(`${i}(...)`,e);a.setParameter("Users",t);a.setParameter("ShareAll",true);return a.execute()}r.shareObject=m;return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/Manage-dbg", ["sap/fe/core/controllerextensions/collaboration/CollaborationCommon", "sap/fe/core/converters/MetaModelConverter", "sap/m/MessageToast", "sap/ui/core/Core", "sap/ui/core/Fragment", "sap/ui/core/library", "../../templating/PropertyHelper"], function (CollaborationCommon, MetaModelConverter, MessageToast, Core, Fragment, coreLibrary, PropertyHelper) {
  "use strict";

  var _exports = {};
  var isPathExpression = PropertyHelper.isPathExpression;
  var UserStatus = CollaborationCommon.UserStatus;
  var UserEditingState = CollaborationCommon.UserEditingState;
  var shareObject = CollaborationCommon.shareObject;
  var getText = CollaborationCommon.getText;
  var CollaborationUtils = CollaborationCommon.CollaborationUtils;
  const ValueState = coreLibrary.ValueState;
  const openManageDialog = async function (view) {
    let dialog = byId("dialog");
    if (!dialog) {
      dialog = await createManageCollaborationDialog(view);
    }
    await readInvitedUsers(view);
    dialog.open();
  };
  _exports.openManageDialog = openManageDialog;
  async function createManageCollaborationDialog(view) {
    const pDialog = view.getController().getExtensionAPI().loadFragment({
      name: "sap.fe.core.controllerextensions.collaboration.ManageDialog",
      id: "manageCollaborationDraft",
      controller: {
        share: share,
        addUser: addUser,
        removeUser: removeUser,
        close: closeDialog,
        addUserChanged: addUserChanged,
        formatUserStatus: formatUserStatus,
        formatUserStatusColor: formatUserStatusColor
      }
    });
    return pDialog.then(function (dialog) {
      view.addDependent(dialog);
      return dialog;
    }).catch(function () {
      throw "not this time";
    });
  }
  async function readInvitedUsers(view) {
    const model = view.getModel();
    // TODO: inform model colleagues on missing TS definition
    const parameters = {
      $select: "UserID,UserDescription,UserEditingState"
    };
    const invitedUserList = model.bindList("DraftAdministrativeData/DraftAdministrativeUser", view.getBindingContext(), [], [], parameters);
    const internalModelContext = view.getBindingContext("internal");
    // TODO: limit?
    return invitedUserList.requestContexts(0, 100).then(function (aContexts) {
      const invitedUsers = [];
      const activeUsers = view.getModel("internal").getProperty("/collaboration/activeUsers") || [];
      const me = CollaborationUtils.getMe(view);
      let userStatus;
      if ((aContexts === null || aContexts === void 0 ? void 0 : aContexts.length) > 0) {
        aContexts.forEach(function (oContext) {
          const userData = oContext.getObject();
          const isMe = (me === null || me === void 0 ? void 0 : me.id) === userData.UserID;
          const isActive = activeUsers.find(u => u.id === userData.UserID);
          let userDescription = userData.UserDescription || userData.UserID;
          const initials = CollaborationUtils.formatInitials(userDescription);
          userDescription += isMe ? ` (${CollaborationUtils.getText("C_COLLABORATIONDRAFT_YOU")})` : "";
          switch (userData.UserEditingState) {
            case UserEditingState.NoChanges:
              userStatus = isActive ? UserStatus.CurrentlyEditing : UserStatus.NoChangesMade;
              break;
            case UserEditingState.InProgress:
              userStatus = isActive ? UserStatus.CurrentlyEditing : UserStatus.ChangesMade;
              break;
            default:
              userStatus = UserStatus.NotYetInvited;
          }
          const user = {
            id: userData.UserID,
            name: userDescription,
            status: userStatus,
            color: CollaborationUtils.getUserColor(userData.UserID, activeUsers, invitedUsers),
            initials: initials,
            me: isMe
          };
          invitedUsers.push(user);
        });
      } else {
        //not yet shared, just add me
        invitedUsers.push(me);
      }
      internalModelContext.setProperty("collaboration/UserID", "");
      internalModelContext.setProperty("collaboration/UserDescription", "");
      internalModelContext.setProperty("collaboration/invitedUsers", invitedUsers);
    }).catch(function () {
      // TODO: handle this case, close dialog?
    });
  }
  _exports.readInvitedUsers = readInvitedUsers;
  function addUser(event) {
    const addButton = event.getSource();
    const internalModelContext = addButton.getBindingContext("internal");
    const invitedUsers = internalModelContext.getProperty("invitedUsers") || [];
    const activeUsers = addButton.getModel("internal").getProperty("/collaboration/activeUsers");
    const newUser = {
      id: internalModelContext === null || internalModelContext === void 0 ? void 0 : internalModelContext.getProperty("UserID"),
      name: internalModelContext === null || internalModelContext === void 0 ? void 0 : internalModelContext.getProperty("UserDescription")
    };
    if (!(invitedUsers.findIndex(user => user.id === newUser.id) > -1 || newUser.id === newUser.name && newUser.id === "")) {
      newUser.name = newUser.name || newUser.id;
      newUser.initials = CollaborationUtils.formatInitials(newUser.name);
      newUser.color = CollaborationUtils.getUserColor(newUser.id, activeUsers, invitedUsers);
      newUser.transient = true;
      newUser.status = UserStatus.NotYetInvited;
      invitedUsers.unshift(newUser);
      internalModelContext.setProperty("invitedUsers", invitedUsers);
      internalModelContext.setProperty("UserID", "");
      internalModelContext.setProperty("UserDescription", "");
    }
  }
  function addUserChanged(event) {
    const userInput = event.getSource();
    event.getParameter("promise").then(function (newUserId) {
      const internalModelContext = userInput.getBindingContext("internal");
      const invitedUsers = internalModelContext.getProperty("invitedUsers") || [];
      if (invitedUsers.findIndex(user => user.id === newUserId) > -1) {
        userInput.setValueState("Error");
        userInput.setValueStateText(getText("C_COLLABORATIONDRAFT_INVITATION_USER_ERROR"));
      } else {
        userInput.setValueState("None");
        userInput.setValueStateText("");
      }
    }).catch(function () {
      throw "User couldn't be determined at all";
    });
  }
  function removeUser(event) {
    removeUserFromList(event.getSource());
  }
  function removeUserFromList(item) {
    const internalModelContext = item.getBindingContext("pageInternal");
    const deleteUserID = item.getBindingContext("internal").getProperty("id");
    let invitedUsers = internalModelContext.getProperty("collaboration/invitedUsers");
    invitedUsers = invitedUsers.filter(user => user.id !== deleteUserID);
    internalModelContext.setProperty("collaboration/invitedUsers", invitedUsers);
  }
  function byId(id) {
    return Core.byId(`manageCollaborationDraft--${id}`);
  }
  function closeDialog() {
    byId("dialog").close();
  }
  function getSharedItemName(bindingContext) {
    var _dataModel$targetObje, _dataModel$targetObje2;
    const model = bindingContext.getModel();
    const metaModel = model.getMetaModel();
    const entityPath = metaModel.getMetaPath(bindingContext.getPath());
    const dataModel = MetaModelConverter.getInvolvedDataModelObjects(metaModel.getContext(entityPath));
    const headerInfo = (_dataModel$targetObje = dataModel.targetObject.entityType.annotations) === null || _dataModel$targetObje === void 0 ? void 0 : (_dataModel$targetObje2 = _dataModel$targetObje.UI) === null || _dataModel$targetObje2 === void 0 ? void 0 : _dataModel$targetObje2.HeaderInfo;
    let sharedItemName = "";
    const title = headerInfo === null || headerInfo === void 0 ? void 0 : headerInfo.Title;
    if (title) {
      sharedItemName = isPathExpression(title.Value) ? bindingContext.getProperty(title.Value.path) : title.Value;
    }
    return sharedItemName || (headerInfo === null || headerInfo === void 0 ? void 0 : headerInfo.TypeName) || "";
  }
  _exports.getSharedItemName = getSharedItemName;
  async function share(event) {
    const users = [];
    const source = event.getSource();
    const bindingContext = source.getBindingContext();
    const contexts = byId("userList").getBinding("items").getContexts();
    let numberOfNewInvitedUsers = 0;
    contexts.forEach(function (context) {
      users.push({
        UserID: context.getProperty("id"),
        UserAccessRole: "O" // For now according to UX every user retrieves the owner role
      });

      if (context.getObject().status === 0) {
        numberOfNewInvitedUsers++;
      }
    });
    try {
      await shareObject(bindingContext, users);
      MessageToast.show(getText("C_COLLABORATIONDRAFT_INVITATION_SUCCESS_TOAST", numberOfNewInvitedUsers.toString(), getSharedItemName(bindingContext)));
    } catch {
      MessageToast.show(getText("C_COLLABORATIONDRAFT_INVITATION_FAILED_TOAST"));
    }
    closeDialog();
  }
  _exports.share = share;
  async function showUserDetails(event, view) {
    const source = event.getSource();
    let popover = byId("userDetails");
    if (!popover) {
      popover = await createUserDetailsPopover(view);
    }
    popover.setBindingContext(source.getBindingContext("internal"), "internal");
    popover.openBy(source, false);
  }
  _exports.showUserDetails = showUserDetails;
  async function createUserDetailsPopover(view) {
    const popoverPromise = Fragment.load({
      id: "manageCollaborationDraft",
      // todo should be view id
      name: "sap.fe.core.controllerextensions.collaboration.UserDetails"
    });
    return popoverPromise.then(function (popover) {
      view.addDependent(popover);
      return popover;
    }).catch(function () {
      throw "not this time";
    });
  }
  function formatUserStatus(userStatus) {
    switch (userStatus) {
      case UserStatus.CurrentlyEditing:
        return getText("C_COLLABORATIONDRAFT_USER_CURRENTLY_EDITING");
      case UserStatus.ChangesMade:
        return getText("C_COLLABORATIONDRAFT_USER_CHANGES_MADE");
      case UserStatus.NoChangesMade:
        return getText("C_COLLABORATIONDRAFT_USER_NO_CHANGES_MADE");
      case UserStatus.NotYetInvited:
      default:
        return getText("C_COLLABORATIONDRAFT_USER_NOT_YET_INVITED");
    }
  }
  function formatUserStatusColor(userStatus) {
    switch (userStatus) {
      case UserStatus.CurrentlyEditing:
        return ValueState.Success;
      case UserStatus.ChangesMade:
        return ValueState.Warning;
      case UserStatus.NoChangesMade:
      case UserStatus.NotYetInvited:
      default:
        return ValueState.Information;
    }
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/collaboration/Manage", ["sap/fe/core/controllerextensions/collaboration/CollaborationCommon","sap/fe/core/converters/MetaModelConverter","sap/m/MessageToast","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/library","../../templating/PropertyHelper"],function(t,e,n,o,r,i,a){"use strict";var s={};var c=a.isPathExpression;var l=t.UserStatus;var d=t.UserEditingState;var u=t.shareObject;var g=t.getText;var f=t.CollaborationUtils;const C=i.ValueState;const I=async function(t){let e=T("dialog");if(!e){e=await U(t)}await p(t);e.open()};s.openManageDialog=I;async function U(t){const e=t.getController().getExtensionAPI().loadFragment({name:"sap.fe.core.controllerextensions.collaboration.ManageDialog",id:"manageCollaborationDraft",controller:{share:y,addUser:v,removeUser:D,close:A,addUserChanged:h,formatUserStatus:S,formatUserStatusColor:E}});return e.then(function(e){t.addDependent(e);return e}).catch(function(){throw"not this time"})}async function p(t){const e=t.getModel();const n={$select:"UserID,UserDescription,UserEditingState"};const o=e.bindList("DraftAdministrativeData/DraftAdministrativeUser",t.getBindingContext(),[],[],n);const r=t.getBindingContext("internal");return o.requestContexts(0,100).then(function(e){const n=[];const o=t.getModel("internal").getProperty("/collaboration/activeUsers")||[];const i=f.getMe(t);let a;if((e===null||e===void 0?void 0:e.length)>0){e.forEach(function(t){const e=t.getObject();const r=(i===null||i===void 0?void 0:i.id)===e.UserID;const s=o.find(t=>t.id===e.UserID);let c=e.UserDescription||e.UserID;const u=f.formatInitials(c);c+=r?` (${f.getText("C_COLLABORATIONDRAFT_YOU")})`:"";switch(e.UserEditingState){case d.NoChanges:a=s?l.CurrentlyEditing:l.NoChangesMade;break;case d.InProgress:a=s?l.CurrentlyEditing:l.ChangesMade;break;default:a=l.NotYetInvited}const g={id:e.UserID,name:c,status:a,color:f.getUserColor(e.UserID,o,n),initials:u,me:r};n.push(g)})}else{n.push(i)}r.setProperty("collaboration/UserID","");r.setProperty("collaboration/UserDescription","");r.setProperty("collaboration/invitedUsers",n)}).catch(function(){})}s.readInvitedUsers=p;function v(t){const e=t.getSource();const n=e.getBindingContext("internal");const o=n.getProperty("invitedUsers")||[];const r=e.getModel("internal").getProperty("/collaboration/activeUsers");const i={id:n===null||n===void 0?void 0:n.getProperty("UserID"),name:n===null||n===void 0?void 0:n.getProperty("UserDescription")};if(!(o.findIndex(t=>t.id===i.id)>-1||i.id===i.name&&i.id==="")){i.name=i.name||i.id;i.initials=f.formatInitials(i.name);i.color=f.getUserColor(i.id,r,o);i.transient=true;i.status=l.NotYetInvited;o.unshift(i);n.setProperty("invitedUsers",o);n.setProperty("UserID","");n.setProperty("UserDescription","")}}function h(t){const e=t.getSource();t.getParameter("promise").then(function(t){const n=e.getBindingContext("internal");const o=n.getProperty("invitedUsers")||[];if(o.findIndex(e=>e.id===t)>-1){e.setValueState("Error");e.setValueStateText(g("C_COLLABORATIONDRAFT_INVITATION_USER_ERROR"))}else{e.setValueState("None");e.setValueStateText("")}}).catch(function(){throw"User couldn't be determined at all"})}function D(t){O(t.getSource())}function O(t){const e=t.getBindingContext("pageInternal");const n=t.getBindingContext("internal").getProperty("id");let o=e.getProperty("collaboration/invitedUsers");o=o.filter(t=>t.id!==n);e.setProperty("collaboration/invitedUsers",o)}function T(t){return o.byId(`manageCollaborationDraft--${t}`)}function A(){T("dialog").close()}function m(t){var n,o;const r=t.getModel();const i=r.getMetaModel();const a=i.getMetaPath(t.getPath());const s=e.getInvolvedDataModelObjects(i.getContext(a));const l=(n=s.targetObject.entityType.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:o.HeaderInfo;let d="";const u=l===null||l===void 0?void 0:l.Title;if(u){d=c(u.Value)?t.getProperty(u.Value.path):u.Value}return d||(l===null||l===void 0?void 0:l.TypeName)||""}s.getSharedItemName=m;async function y(t){const e=[];const o=t.getSource();const r=o.getBindingContext();const i=T("userList").getBinding("items").getContexts();let a=0;i.forEach(function(t){e.push({UserID:t.getProperty("id"),UserAccessRole:"O"});if(t.getObject().status===0){a++}});try{await u(r,e);n.show(g("C_COLLABORATIONDRAFT_INVITATION_SUCCESS_TOAST",a.toString(),m(r)))}catch{n.show(g("C_COLLABORATIONDRAFT_INVITATION_FAILED_TOAST"))}A()}s.share=y;async function N(t,e){const n=t.getSource();let o=T("userDetails");if(!o){o=await _(e)}o.setBindingContext(n.getBindingContext("internal"),"internal");o.openBy(n,false)}s.showUserDetails=N;async function _(t){const e=r.load({id:"manageCollaborationDraft",name:"sap.fe.core.controllerextensions.collaboration.UserDetails"});return e.then(function(e){t.addDependent(e);return e}).catch(function(){throw"not this time"})}function S(t){switch(t){case l.CurrentlyEditing:return g("C_COLLABORATIONDRAFT_USER_CURRENTLY_EDITING");case l.ChangesMade:return g("C_COLLABORATIONDRAFT_USER_CHANGES_MADE");case l.NoChangesMade:return g("C_COLLABORATIONDRAFT_USER_NO_CHANGES_MADE");case l.NotYetInvited:default:return g("C_COLLABORATIONDRAFT_USER_NOT_YET_INVITED")}}function E(t){switch(t){case l.CurrentlyEditing:return C.Success;case l.ChangesMade:return C.Warning;case l.NoChangesMade:case l.NotYetInvited:default:return C.Information}}return s},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/dialog/OperationsDialog.block-dbg", ["sap/fe/core/buildingBlocks/BuildingBlock", "sap/fe/core/helpers/ClassSupport", "sap/m/Bar", "sap/m/Button", "sap/m/Dialog", "sap/m/Title", "sap/fe/core/jsx-runtime/jsx"], function (BuildingBlock, ClassSupport, Bar, Button, Dialog, Title, _jsx) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _descriptor11, _descriptor12, _descriptor13, _descriptor14;
  var _exports = {};
  var defineReference = ClassSupport.defineReference;
  var defineBuildingBlock = BuildingBlock.defineBuildingBlock;
  var BuildingBlockBase = BuildingBlock.BuildingBlockBase;
  var blockAttribute = BuildingBlock.blockAttribute;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let OperationsDialog = (
  /**
   * Known limitations for the first tryout as mentioned in git 5806442
   *  - functional block dependency
   * 	- questionable parameters will be refactored
   */
  _dec = defineBuildingBlock({
    name: "OperationsDialog",
    namespace: "sap.fe.core.controllerextensions",
    isRuntime: true
  }), _dec2 = blockAttribute({
    type: "string",
    isPublic: true,
    required: true
  }), _dec3 = blockAttribute({
    type: "string",
    defaultValue: "Dialog Standard Title"
  }), _dec4 = blockAttribute({
    type: "object",
    defaultValue: ""
  }), _dec5 = defineReference(), _dec6 = blockAttribute({
    type: "boolean"
  }), _dec7 = blockAttribute({
    type: "function"
  }), _dec8 = blockAttribute({
    type: "object"
  }), _dec9 = blockAttribute({
    type: "string"
  }), _dec10 = blockAttribute({
    type: "string"
  }), _dec11 = blockAttribute({
    type: "string"
  }), _dec12 = blockAttribute({
    type: "object"
  }), _dec13 = blockAttribute({
    type: "object"
  }), _dec14 = blockAttribute({
    type: "object"
  }), _dec15 = blockAttribute({
    type: "object"
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_BuildingBlockBase) {
    _inheritsLoose(OperationsDialog, _BuildingBlockBase);
    function OperationsDialog(props) {
      var _this;
      _this = _BuildingBlockBase.call(this, props) || this;
      _initializerDefineProperty(_this, "id", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "title", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "messageObject", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "operationsDialog", _descriptor4, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "isMultiContext412", _descriptor5, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "resolve", _descriptor6, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "model", _descriptor7, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "groupId", _descriptor8, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "actionName", _descriptor9, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "cancelButtonTxt", _descriptor10, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "strictHandlingPromises", _descriptor11, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "strictHandlingUtilities", _descriptor12, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "messageHandler", _descriptor13, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "messageDialogModel", _descriptor14, _assertThisInitialized(_this));
      return _this;
    }

    /*
     * The 'id' property of the dialog
     */
    _exports = OperationsDialog;
    var _proto = OperationsDialog.prototype;
    _proto.open = function open() {
      var _this$operationsDialo;
      this.getContent();
      (_this$operationsDialo = this.operationsDialog.current) === null || _this$operationsDialo === void 0 ? void 0 : _this$operationsDialo.open();
    };
    _proto.getBeginButton = function getBeginButton() {
      return new Button({
        press: () => {
          if (!(this.isMultiContext412 ?? false)) {
            var _this$resolve;
            (_this$resolve = this.resolve) === null || _this$resolve === void 0 ? void 0 : _this$resolve.call(this, true);
            this.model.submitBatch(this.groupId);
          } else {
            var _this$strictHandlingU;
            this.strictHandlingPromises.forEach(strictHandlingPromise => {
              strictHandlingPromise.resolve(true);
              this.model.submitBatch(strictHandlingPromise.groupId);
              if (strictHandlingPromise.requestSideEffects) {
                strictHandlingPromise.requestSideEffects();
              }
            });
            const strictHandlingFails = (_this$strictHandlingU = this.strictHandlingUtilities) === null || _this$strictHandlingU === void 0 ? void 0 : _this$strictHandlingU.strictHandlingTransitionFails;
            if (strictHandlingFails && strictHandlingFails.length > 0) {
              var _this$messageHandler;
              (_this$messageHandler = this.messageHandler) === null || _this$messageHandler === void 0 ? void 0 : _this$messageHandler.removeTransitionMessages();
            }
            if (this.strictHandlingUtilities) {
              this.strictHandlingUtilities.strictHandlingWarningMessages = [];
            }
          }
          if (this.strictHandlingUtilities) {
            this.strictHandlingUtilities.is412Executed = true;
          }
          this.messageDialogModel.setData({});
          this.close();
        },
        type: "Emphasized",
        text: this.actionName
      });
    };
    _proto.close = function close() {
      var _this$operationsDialo2;
      (_this$operationsDialo2 = this.operationsDialog.current) === null || _this$operationsDialo2 === void 0 ? void 0 : _this$operationsDialo2.close();
    };
    _proto.getEndButton = function getEndButton() {
      return new Button({
        press: () => {
          if (this.strictHandlingUtilities) {
            this.strictHandlingUtilities.strictHandlingWarningMessages = [];
            this.strictHandlingUtilities.is412Executed = false;
          }
          if (!(this.isMultiContext412 ?? false)) {
            this.resolve(false);
          } else {
            this.strictHandlingPromises.forEach(function (strictHandlingPromise) {
              strictHandlingPromise.resolve(false);
            });
          }
          this.messageDialogModel.setData({});
          this.close();
        },
        text: this.cancelButtonTxt
      });
    }

    /**
     * The building block render function.
     *
     * @returns An XML-based string with the definition of the field control
     */;
    _proto.getContent = function getContent() {
      return _jsx(Dialog, {
        id: this.id,
        ref: this.operationsDialog,
        resizable: true,
        content: this.messageObject.oMessageView,
        state: "Warning",
        customHeader: new Bar({
          contentLeft: [this.messageObject.oBackButton],
          contentMiddle: [new Title({
            text: "Warning"
          })]
        }),
        contentHeight: "50%",
        contentWidth: "50%",
        verticalScrolling: false,
        beginButton: this.getBeginButton(),
        endButton: this.getEndButton()
      });
    };
    return OperationsDialog;
  }(BuildingBlockBase), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "id", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "title", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "messageObject", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "operationsDialog", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "isMultiContext412", [_dec6], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "resolve", [_dec7], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "model", [_dec8], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "groupId", [_dec9], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "actionName", [_dec10], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor10 = _applyDecoratedDescriptor(_class2.prototype, "cancelButtonTxt", [_dec11], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor11 = _applyDecoratedDescriptor(_class2.prototype, "strictHandlingPromises", [_dec12], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor12 = _applyDecoratedDescriptor(_class2.prototype, "strictHandlingUtilities", [_dec13], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor13 = _applyDecoratedDescriptor(_class2.prototype, "messageHandler", [_dec14], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor14 = _applyDecoratedDescriptor(_class2.prototype, "messageDialogModel", [_dec15], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  _exports = OperationsDialog;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/dialog/OperationsDialog.block", ["sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/helpers/ClassSupport","sap/m/Bar","sap/m/Button","sap/m/Dialog","sap/m/Title","sap/fe/core/jsx-runtime/jsx"],function(e,t,i,r,n,l,a){"use strict";var o,s,u,c,g,p,d,f,b,m,h,v,y,w,B,z,H,j,x,D,M,O,E,P,U,k,C,T,S,W,I;var _={};var q=t.defineReference;var N=e.defineBuildingBlock;var R=e.BuildingBlockBase;var V=e.blockAttribute;function A(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function F(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function L(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;G(e,t)}function G(e,t){G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return G(e,t)}function J(e,t,i,r,n){var l={};Object.keys(r).forEach(function(e){l[e]=r[e]});l.enumerable=!!l.enumerable;l.configurable=!!l.configurable;if("value"in l||l.initializer){l.writable=true}l=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},l);if(n&&l.initializer!==void 0){l.value=l.initializer?l.initializer.call(n):void 0;l.initializer=undefined}if(l.initializer===void 0){Object.defineProperty(e,t,l);l=null}return l}function K(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let Q=(o=N({name:"OperationsDialog",namespace:"sap.fe.core.controllerextensions",isRuntime:true}),s=V({type:"string",isPublic:true,required:true}),u=V({type:"string",defaultValue:"Dialog Standard Title"}),c=V({type:"object",defaultValue:""}),g=q(),p=V({type:"boolean"}),d=V({type:"function"}),f=V({type:"object"}),b=V({type:"string"}),m=V({type:"string"}),h=V({type:"string"}),v=V({type:"object"}),y=V({type:"object"}),w=V({type:"object"}),B=V({type:"object"}),o(z=(H=function(e){L(t,e);function t(t){var i;i=e.call(this,t)||this;A(i,"id",j,F(i));A(i,"title",x,F(i));A(i,"messageObject",D,F(i));A(i,"operationsDialog",M,F(i));A(i,"isMultiContext412",O,F(i));A(i,"resolve",E,F(i));A(i,"model",P,F(i));A(i,"groupId",U,F(i));A(i,"actionName",k,F(i));A(i,"cancelButtonTxt",C,F(i));A(i,"strictHandlingPromises",T,F(i));A(i,"strictHandlingUtilities",S,F(i));A(i,"messageHandler",W,F(i));A(i,"messageDialogModel",I,F(i));return i}_=t;var o=t.prototype;o.open=function e(){var t;this.getContent();(t=this.operationsDialog.current)===null||t===void 0?void 0:t.open()};o.getBeginButton=function e(){return new r({press:()=>{if(!(this.isMultiContext412??false)){var e;(e=this.resolve)===null||e===void 0?void 0:e.call(this,true);this.model.submitBatch(this.groupId)}else{var t;this.strictHandlingPromises.forEach(e=>{e.resolve(true);this.model.submitBatch(e.groupId);if(e.requestSideEffects){e.requestSideEffects()}});const e=(t=this.strictHandlingUtilities)===null||t===void 0?void 0:t.strictHandlingTransitionFails;if(e&&e.length>0){var i;(i=this.messageHandler)===null||i===void 0?void 0:i.removeTransitionMessages()}if(this.strictHandlingUtilities){this.strictHandlingUtilities.strictHandlingWarningMessages=[]}}if(this.strictHandlingUtilities){this.strictHandlingUtilities.is412Executed=true}this.messageDialogModel.setData({});this.close()},type:"Emphasized",text:this.actionName})};o.close=function e(){var t;(t=this.operationsDialog.current)===null||t===void 0?void 0:t.close()};o.getEndButton=function e(){return new r({press:()=>{if(this.strictHandlingUtilities){this.strictHandlingUtilities.strictHandlingWarningMessages=[];this.strictHandlingUtilities.is412Executed=false}if(!(this.isMultiContext412??false)){this.resolve(false)}else{this.strictHandlingPromises.forEach(function(e){e.resolve(false)})}this.messageDialogModel.setData({});this.close()},text:this.cancelButtonTxt})};o.getContent=function e(){return a(n,{id:this.id,ref:this.operationsDialog,resizable:true,content:this.messageObject.oMessageView,state:"Warning",customHeader:new i({contentLeft:[this.messageObject.oBackButton],contentMiddle:[new l({text:"Warning"})]}),contentHeight:"50%",contentWidth:"50%",verticalScrolling:false,beginButton:this.getBeginButton(),endButton:this.getEndButton()})};return t}(R),j=J(H.prototype,"id",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),x=J(H.prototype,"title",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),D=J(H.prototype,"messageObject",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),M=J(H.prototype,"operationsDialog",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),O=J(H.prototype,"isMultiContext412",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),E=J(H.prototype,"resolve",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),P=J(H.prototype,"model",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),U=J(H.prototype,"groupId",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),k=J(H.prototype,"actionName",[m],{configurable:true,enumerable:true,writable:true,initializer:null}),C=J(H.prototype,"cancelButtonTxt",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),T=J(H.prototype,"strictHandlingPromises",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),S=J(H.prototype,"strictHandlingUtilities",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),W=J(H.prototype,"messageHandler",[w],{configurable:true,enumerable:true,writable:true,initializer:null}),I=J(H.prototype,"messageDialogModel",[B],{configurable:true,enumerable:true,writable:true,initializer:null}),H))||z);_=Q;return _},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/TransactionHelper-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/controllerextensions/editFlow/draft", "sap/fe/core/controllerextensions/editFlow/operations", "sap/fe/core/controllerextensions/editFlow/sticky", "sap/fe/core/controllerextensions/messageHandler/messageHandling", "sap/fe/core/helpers/DeleteHelper", "sap/fe/core/helpers/FPMHelper", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/helpers/StableIdHelper", "sap/fe/core/library", "sap/m/Button", "sap/m/Dialog", "sap/m/MessageBox", "sap/m/MessageToast", "sap/m/Popover", "sap/m/Text", "sap/m/VBox", "sap/ui/core/Core", "sap/ui/core/Fragment", "sap/ui/core/library", "sap/ui/core/util/XMLPreprocessor", "sap/ui/core/XMLTemplateProcessor", "sap/ui/model/json/JSONModel", "../../helpers/ToES6Promise"], function (Log, CommonUtils, BusyLocker, draft, operations, sticky, messageHandling, deleteHelper, FPMHelper, ModelHelper, StableIdHelper, FELibrary, Button, Dialog, MessageBox, MessageToast, Popover, Text, VBox, Core, Fragment, coreLibrary, XMLPreprocessor, XMLTemplateProcessor, JSONModel, toES6Promise) {
  "use strict";

  var generate = StableIdHelper.generate;
  const CreationMode = FELibrary.CreationMode;
  const ProgrammingModel = FELibrary.ProgrammingModel;
  const ValueState = coreLibrary.ValueState;
  /* Make sure that the mParameters is not the oEvent */
  function getParameters(mParameters) {
    if (mParameters && mParameters.getMetadata && mParameters.getMetadata().getName() === "sap.ui.base.Event") {
      mParameters = {};
    }
    return mParameters || {};
  }
  let TransactionHelper = /*#__PURE__*/function () {
    function TransactionHelper() {}
    var _proto = TransactionHelper.prototype;
    _proto.busyLock = function busyLock(appComponent, busyPath) {
      BusyLocker.lock(appComponent.getModel("ui"), busyPath);
    };
    _proto.busyUnlock = function busyUnlock(appComponent, busyPath) {
      BusyLocker.unlock(appComponent.getModel("ui"), busyPath);
    };
    _proto.getProgrammingModel = function getProgrammingModel(source) {
      let path;
      if (source.isA("sap.ui.model.odata.v4.Context")) {
        path = source.getPath();
      } else {
        path = (source.isRelative() ? source.getResolvedPath() : source.getPath()) ?? "";
      }
      const metaModel = source.getModel().getMetaModel();
      if (ModelHelper.isDraftSupported(metaModel, path)) {
        return ProgrammingModel.Draft;
      } else if (ModelHelper.isStickySessionSupported(metaModel)) {
        return ProgrammingModel.Sticky;
      } else {
        return ProgrammingModel.NonDraft;
      }
    }

    /**
     * Validates a document.
     *
     * @memberof sap.fe.core.TransactionHelper
     * @static
     * @param oContext Context of the document to be validated
     * @param [mParameters] Can contain the following attributes:
     * @param [mParameters.data] A map of data that should be validated
     * @param [mParameters.customValidationFunction] A string representing the path to the validation function
     * @param oView Contains the object of the current view
     * @returns Promise resolves with result of the custom validation function
     * @ui5-restricted
     * @final
     */;
    _proto.validateDocument = function validateDocument(oContext, mParameters, oView) {
      const sCustomValidationFunction = mParameters && mParameters.customValidationFunction;
      if (sCustomValidationFunction) {
        const sModule = sCustomValidationFunction.substring(0, sCustomValidationFunction.lastIndexOf(".") || -1).replace(/\./gi, "/"),
          sFunctionName = sCustomValidationFunction.substring(sCustomValidationFunction.lastIndexOf(".") + 1, sCustomValidationFunction.length),
          mData = mParameters.data;
        delete mData["@$ui5.context.isTransient"];
        return FPMHelper.validationWrapper(sModule, sFunctionName, mData, oView, oContext);
      }
      return Promise.resolve([]);
    }

    /**
     * Creates a new document.
     *
     * @memberof sap.fe.core.TransactionHelper
     * @static
     * @param oMainListBinding OData V4 ListBinding object
     * @param [mInParameters] Optional, can contain the following attributes:
     * @param [mInParameters.data] A map of data that should be sent within the POST
     * @param [mInParameters.busyMode] Global (default), Local, None TODO: to be refactored
     * @param [mInParameters.busyId] ID of the local busy indicator
     * @param [mInParameters.keepTransientContextOnFailed] If set, the context stays in the list if the POST failed and POST will be repeated with the next change
     * @param [mInParameters.inactive] If set, the context is set as inactive for empty rows
     * @param [mInParameters.skipParameterDialog] Skips the action parameter dialog
     * @param appComponent The app component
     * @param messageHandler The message handler extension
     * @param fromCopyPaste True if the creation has been triggered by a paste action
     * @param currentView The current view
     * @returns Promise resolves with new binding context
     * @ui5-restricted
     * @final
     */;
    _proto.createDocument = async function createDocument(oMainListBinding, mInParameters, appComponent, messageHandler, fromCopyPaste, currentView) {
      // eslint-disable-next-line @typescript-eslint/no-this-alias
      const oModel = oMainListBinding.getModel(),
        oMetaModel = oModel.getMetaModel(),
        sMetaPath = oMetaModel.getMetaPath(oMainListBinding.getHeaderContext().getPath()),
        sCreateHash = appComponent.getRouterProxy().getHash(),
        oComponentData = appComponent.getComponentData(),
        oStartupParameters = oComponentData && oComponentData.startupParameters || {},
        sNewAction = !oMainListBinding.isRelative() ? this._getNewAction(oStartupParameters, sCreateHash, oMetaModel, sMetaPath) : undefined;
      const mBindingParameters = {
        $$patchWithoutSideEffects: true
      };
      const sMessagesPath = oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.Common.v1.Messages/$Path`);
      let sBusyPath = "/busy";
      let sFunctionName = oMetaModel.getObject(`${sMetaPath}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`) || oMetaModel.getObject(`${ModelHelper.getTargetEntitySet(oMetaModel.getContext(sMetaPath))}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`);
      let bFunctionOnNavProp;
      let oNewDocumentContext;
      if (sFunctionName) {
        if (oMetaModel.getObject(`${sMetaPath}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`) && ModelHelper.getTargetEntitySet(oMetaModel.getContext(sMetaPath)) !== sMetaPath) {
          bFunctionOnNavProp = true;
        } else {
          bFunctionOnNavProp = false;
        }
      }
      if (sMessagesPath) {
        mBindingParameters["$select"] = sMessagesPath;
      }
      const mParameters = getParameters(mInParameters);
      if (!oMainListBinding) {
        throw new Error("Binding required for new document creation");
      }
      const sProgrammingModel = this.getProgrammingModel(oMainListBinding);
      if (sProgrammingModel !== ProgrammingModel.Draft && sProgrammingModel !== ProgrammingModel.Sticky) {
        throw new Error("Create document only allowed for draft or sticky session supported services");
      }
      if (mParameters.busyMode === "Local") {
        sBusyPath = `/busyLocal/${mParameters.busyId}`;
      }
      mParameters.beforeCreateCallBack = fromCopyPaste ? null : mParameters.beforeCreateCallBack;
      this.busyLock(appComponent, sBusyPath);
      const oResourceBundleCore = Core.getLibraryResourceBundle("sap.fe.core");
      let oResult;
      try {
        if (sNewAction) {
          oResult = await this.callAction(sNewAction, {
            contexts: oMainListBinding.getHeaderContext(),
            showActionParameterDialog: true,
            label: this._getSpecificCreateActionDialogLabel(oMetaModel, sMetaPath, sNewAction, oResourceBundleCore),
            bindingParameters: mBindingParameters,
            parentControl: mParameters.parentControl,
            bIsCreateAction: true,
            skipParameterDialog: mParameters.skipParameterDialog
          }, null, appComponent, messageHandler);
        } else {
          const bIsNewPageCreation = mParameters.creationMode !== CreationMode.CreationRow && mParameters.creationMode !== CreationMode.Inline;
          const aNonComputedVisibleKeyFields = bIsNewPageCreation ? CommonUtils.getNonComputedVisibleFields(oMetaModel, sMetaPath, currentView) : [];
          sFunctionName = fromCopyPaste ? null : sFunctionName;
          let sFunctionPath, oFunctionContext;
          if (sFunctionName) {
            //bound to the source entity:
            if (bFunctionOnNavProp) {
              sFunctionPath = oMainListBinding.getContext() && `${oMetaModel.getMetaPath(oMainListBinding.getContext().getPath())}/${sFunctionName}`;
              oFunctionContext = oMainListBinding.getContext();
            } else {
              sFunctionPath = oMainListBinding.getHeaderContext() && `${oMetaModel.getMetaPath(oMainListBinding.getHeaderContext().getPath())}/${sFunctionName}`;
              oFunctionContext = oMainListBinding.getHeaderContext();
            }
          }
          const oFunction = sFunctionPath && oMetaModel.createBindingContext(sFunctionPath);
          try {
            let oData;
            try {
              const oContext = oFunction && oFunction.getObject() && oFunction.getObject()[0].$IsBound ? await operations.callBoundFunction(sFunctionName, oFunctionContext, oModel) : await operations.callFunctionImport(sFunctionName, oModel);
              if (oContext) {
                oData = oContext.getObject();
              }
            } catch (oError) {
              Log.error(`Error while executing the function ${sFunctionName}`, oError);
              throw oError;
            }
            mParameters.data = oData ? Object.assign({}, oData, mParameters.data) : mParameters.data;
            if (mParameters.data) {
              delete mParameters.data["@odata.context"];
            }
            if (aNonComputedVisibleKeyFields.length > 0) {
              oResult = await this._launchDialogWithKeyFields(oMainListBinding, aNonComputedVisibleKeyFields, oModel, mParameters, appComponent, messageHandler);
              oNewDocumentContext = oResult.newContext;
            } else {
              if (mParameters.beforeCreateCallBack) {
                await toES6Promise(mParameters.beforeCreateCallBack({
                  contextPath: oMainListBinding && oMainListBinding.getPath()
                }));
              }
              oNewDocumentContext = oMainListBinding.create(mParameters.data, true, mParameters.createAtEnd, mParameters.inactive);
              if (!mParameters.inactive) {
                oResult = await this.onAfterCreateCompletion(oMainListBinding, oNewDocumentContext, mParameters);
              }
            }
          } catch (oError) {
            Log.error("Error while creating the new document", oError);
            throw oError;
          }
        }
        oNewDocumentContext = oNewDocumentContext || oResult;
        await messageHandler.showMessageDialog({
          control: mParameters.parentControl
        });
        return oNewDocumentContext;
      } catch (error) {
        var _oNewDocumentContext;
        // TODO: currently, the only errors handled here are raised as string - should be changed to Error objects
        await messageHandler.showMessageDialog({
          control: mParameters.parentControl
        });
        if ((error === FELibrary.Constants.ActionExecutionFailed || error === FELibrary.Constants.CancelActionDialog) && (_oNewDocumentContext = oNewDocumentContext) !== null && _oNewDocumentContext !== void 0 && _oNewDocumentContext.isTransient()) {
          // This is a workaround suggested by model as Context.delete results in an error
          // TODO: remove the $direct once model resolves this issue
          // this line shows the expected console error Uncaught (in promise) Error: Request canceled: POST Travel; group: submitLater
          oNewDocumentContext.delete("$direct");
        }
        throw error;
      } finally {
        this.busyUnlock(appComponent, sBusyPath);
      }
    };
    _proto._isDraftEnabled = function _isDraftEnabled(vContexts) {
      const contextForDraftModel = vContexts[0];
      const sProgrammingModel = this.getProgrammingModel(contextForDraftModel);
      return sProgrammingModel === ProgrammingModel.Draft;
    }
    /**
     * Delete one or multiple document(s).
     *
     * @memberof sap.fe.core.TransactionHelper
     * @static
     * @param contexts Contexts Either one context or an array with contexts to be deleted
     * @param mParameters Optional, can contain the following attributes:
     * @param mParameters.title Title of the object to be deleted
     * @param mParameters.description Description of the object to be deleted
     * @param mParameters.numberOfSelectedContexts Number of objects selected
     * @param mParameters.noDialog To disable the confirmation dialog
     * @param appComponent The appComponent
     * @param resourceBundle The bundle to load text resources
     * @param messageHandler The message handler extension
     * @returns A Promise resolved once the document are deleted
     */;
    _proto.deleteDocument = function deleteDocument(contexts, mParameters, appComponent, resourceBundle, messageHandler) {
      const resourceBundleCore = Core.getLibraryResourceBundle("sap.fe.core");
      let aParams;
      this.busyLock(appComponent);
      const contextsToDelete = Array.isArray(contexts) ? [...contexts] : [contexts];
      return new Promise((resolve, reject) => {
        try {
          const draftEnabled = this._isDraftEnabled(mParameters.selectedContexts || contextsToDelete);
          const items = [];
          const options = [];
          if (mParameters) {
            if (!mParameters.numberOfSelectedContexts) {
              // non-Table
              if (draftEnabled) {
                // Check if 1 of the drafts is locked by another user
                const lockedContext = contextsToDelete.find(context => {
                  const contextData = context.getObject();
                  return contextData.IsActiveEntity === true && contextData.HasDraftEntity === true && contextData.DraftAdministrativeData && contextData.DraftAdministrativeData.InProcessByUser && !contextData.DraftAdministrativeData.DraftIsCreatedByMe;
                });
                if (lockedContext) {
                  // Show message box with the name of the locking user and return
                  const lockingUserName = lockedContext.getObject().DraftAdministrativeData.InProcessByUser;
                  MessageBox.show(CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_OBJECT_LOCKED", resourceBundle, [lockingUserName]), {
                    title: resourceBundleCore.getText("C_COMMON_DELETE"),
                    onClose: reject
                  });
                  return;
                }
              }
              mParameters = getParameters(mParameters);
              let nonTableTxt = "";
              if (mParameters.title) {
                if (mParameters.description) {
                  aParams = [mParameters.title + " ", mParameters.description];
                } else {
                  aParams = [mParameters.title, ""];
                }
                nonTableTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO", resourceBundle, aParams, mParameters.entitySetName);
              } else {
                nonTableTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR", resourceBundle, undefined, mParameters.entitySetName);
              }
              options.push({
                type: "deletableContexts",
                contexts: contextsToDelete,
                text: nonTableTxt,
                selected: true,
                control: "text"
              });
            } else {
              // Table
              let totalDeletable = contextsToDelete.length;
              if (draftEnabled) {
                totalDeletable += mParameters.draftsWithNonDeletableActive.length + mParameters.draftsWithDeletableActive.length + mParameters.unSavedContexts.length + mParameters.createModeContexts.length;
                deleteHelper.updateDraftOptionsForDeletableTexts(mParameters, contextsToDelete, totalDeletable, resourceBundle, items, options);
              }
              deleteHelper.updateOptionsForDeletableTexts(mParameters, contextsToDelete, resourceBundle, options);
            }
          }

          // Content of Delete Dialog
          deleteHelper.updateContentForDeleteDialog(options, items);
          const vBox = new VBox({
            items: items
          });
          const sTitle = resourceBundleCore.getText("C_COMMON_DELETE");
          const fnConfirm = async () => {
            this.busyLock(appComponent);
            try {
              await deleteHelper.deleteConfirmHandler(options, mParameters, messageHandler, resourceBundle, appComponent, draftEnabled);
              resolve();
            } catch (oError) {
              reject();
            } finally {
              this.busyUnlock(appComponent);
            }
          };
          let dialogConfirmed = false;
          const oDialog = new Dialog({
            title: sTitle,
            state: "Warning",
            content: [vBox],
            ariaLabelledBy: items,
            beginButton: new Button({
              text: resourceBundleCore.getText("C_COMMON_DELETE"),
              type: "Emphasized",
              press: function () {
                messageHandling.removeBoundTransitionMessages();
                dialogConfirmed = true;
                oDialog.close();
                fnConfirm();
              }
            }),
            endButton: new Button({
              text: CommonUtils.getTranslatedText("C_COMMON_DIALOG_CANCEL", resourceBundle),
              press: function () {
                oDialog.close();
              }
            }),
            afterClose: function () {
              oDialog.destroy();
              // if dialog is closed unconfirmed (e.g. via "Cancel" or Escape button), ensure to reject promise
              if (!dialogConfirmed) {
                reject();
              }
            }
          });
          if (mParameters.noDialog) {
            fnConfirm();
          } else {
            oDialog.addStyleClass("sapUiContentPadding");
            oDialog.open();
          }
        } finally {
          this.busyUnlock(appComponent);
        }
      });
    }
    /**
     * Edits a document.
     *
     * @memberof sap.fe.core.TransactionHelper
     * @static
     * @param oContext Context of the active document
     * @param oView Current view
     * @param appComponent The appComponent
     * @param messageHandler The message handler extension
     * @returns Promise resolves with the new draft context in case of draft programming model
     * @ui5-restricted
     * @final
     */;
    _proto.editDocument = async function editDocument(oContext, oView, appComponent, messageHandler) {
      const sProgrammingModel = this.getProgrammingModel(oContext);
      if (!oContext) {
        throw new Error("Binding context to active document is required");
      }
      if (sProgrammingModel !== ProgrammingModel.Draft && sProgrammingModel !== ProgrammingModel.Sticky) {
        throw new Error("Edit is only allowed for draft or sticky session supported services");
      }
      this.busyLock(appComponent);
      // before triggering the edit action we'll have to remove all bound transition messages
      messageHandler.removeTransitionMessages();
      try {
        const oNewContext = sProgrammingModel === ProgrammingModel.Draft ? await draft.createDraftFromActiveDocument(oContext, appComponent, {
          bPreserveChanges: true,
          oView: oView
        }) : await sticky.editDocumentInStickySession(oContext, appComponent);
        await messageHandler.showMessageDialog();
        return oNewContext;
      } catch (err) {
        await messageHandler.showMessages({
          concurrentEditFlag: true
        });
        throw err;
      } finally {
        this.busyUnlock(appComponent);
      }
    }
    /**
     * Cancel 'edit' mode of a document.
     *
     * @memberof sap.fe.core.TransactionHelper
     * @static
     * @param oContext Context of the document to be canceled or deleted
     * @param [mInParameters] Optional, can contain the following attributes:
     * @param mInParameters.cancelButton Cancel Button of the discard popover (mandatory for now)
     * @param mInParameters.skipDiscardPopover Optional, supresses the discard popover incase of draft applications while navigating out of OP
     * @param appComponent The appComponent
     * @param resourceBundle The bundle to load text resources
     * @param messageHandler The message handler extension
     * @param isNewObject True if we're trying to cancel a newly created object
     * @param isObjectModified True if the object has been modified by the user
     * @returns Promise resolves with ???
     * @ui5-restricted
     * @final
     */;
    _proto.cancelDocument = async function cancelDocument(oContext, mInParameters, appComponent, resourceBundle, messageHandler, isNewObject, isObjectModified) {
      //context must always be passed - mandatory parameter
      if (!oContext) {
        throw new Error("No context exists. Pass a meaningful context");
      }
      this.busyLock(appComponent);
      const mParameters = getParameters(mInParameters);
      const oModel = oContext.getModel();
      const sProgrammingModel = this.getProgrammingModel(oContext);
      if (sProgrammingModel !== ProgrammingModel.Draft && sProgrammingModel !== ProgrammingModel.Sticky) {
        throw new Error("Cancel document only allowed for draft or sticky session supported services");
      }
      try {
        let returnedValue = false;
        if (sProgrammingModel === ProgrammingModel.Draft && !isObjectModified) {
          const draftDataContext = oModel.bindContext(`${oContext.getPath()}/DraftAdministrativeData`).getBoundContext();
          const draftAdminData = await draftDataContext.requestObject();
          if (draftAdminData) {
            isObjectModified = draftAdminData.CreationDateTime !== draftAdminData.LastChangeDateTime;
          }
        }
        if (!mParameters.skipDiscardPopover) {
          await this._confirmDiscard(mParameters.cancelButton, isObjectModified, resourceBundle);
        }
        if (oContext.isKeepAlive()) {
          oContext.setKeepAlive(false);
        }
        if (mParameters.beforeCancelCallBack) {
          await mParameters.beforeCancelCallBack({
            context: oContext
          });
        }
        if (sProgrammingModel === ProgrammingModel.Draft) {
          if (isNewObject) {
            if (oContext.hasPendingChanges()) {
              oContext.getBinding().resetChanges();
            }
            returnedValue = await draft.deleteDraft(oContext, appComponent);
          } else {
            const oSiblingContext = oModel.bindContext(`${oContext.getPath()}/SiblingEntity`).getBoundContext();
            try {
              const sCanonicalPath = await oSiblingContext.requestCanonicalPath();
              if (oContext.hasPendingChanges()) {
                oContext.getBinding().resetChanges();
              }
              returnedValue = oModel.bindContext(sCanonicalPath).getBoundContext();
            } finally {
              await draft.deleteDraft(oContext, appComponent);
            }
          }
        } else {
          const discardedContext = await sticky.discardDocument(oContext);
          if (discardedContext) {
            if (discardedContext.hasPendingChanges()) {
              discardedContext.getBinding().resetChanges();
            }
            if (!isNewObject) {
              discardedContext.refresh();
              returnedValue = discardedContext;
            }
          }
        }

        // remove existing bound transition messages
        messageHandler.removeTransitionMessages();
        // show unbound messages
        await messageHandler.showMessages();
        return returnedValue;
      } catch (err) {
        await messageHandler.showMessages();
        throw err;
      } finally {
        this.busyUnlock(appComponent);
      }
    }

    /**
     * Saves the document.
     *
     * @memberof sap.fe.core.TransactionHelper
     * @static
     * @param context Context of the document to be saved
     * @param appComponent The appComponent
     * @param resourceBundle The bundle to load text resources
     * @param executeSideEffectsOnError True if we should execute side effects in case of an error
     * @param bindingsForSideEffects The listBindings to be used for executing side effects on error
     * @param messageHandler The message handler extension
     * @param isNewObject True if we're trying to cancel a newly created object
     * @returns Promise resolves with ???
     * @ui5-restricted
     * @final
     */;
    _proto.saveDocument = async function saveDocument(context, appComponent, resourceBundle, executeSideEffectsOnError, bindingsForSideEffects, messageHandler, isNewObject) {
      const sProgrammingModel = this.getProgrammingModel(context);
      if (sProgrammingModel !== ProgrammingModel.Sticky && sProgrammingModel !== ProgrammingModel.Draft) {
        throw new Error("Save is only allowed for draft or sticky session supported services");
      }
      // in case of saving / activating the bound transition messages shall be removed before the PATCH/POST
      // is sent to the backend
      messageHandler.removeTransitionMessages();
      try {
        this.busyLock(appComponent);
        const oActiveDocument = sProgrammingModel === ProgrammingModel.Draft ? await draft.activateDocument(context, appComponent, {}, messageHandler) : await sticky.activateDocument(context, appComponent);
        const messagesReceived = messageHandling.getMessages().concat(messageHandling.getMessages(true, true)); // get unbound and bound messages present in the model
        if (!(messagesReceived.length === 1 && messagesReceived[0].type === coreLibrary.MessageType.Success)) {
          // show our object creation toast only if it is not coming from backend
          MessageToast.show(isNewObject ? CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_OBJECT_CREATED", resourceBundle) : CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_OBJECT_SAVED", resourceBundle));
        }
        return oActiveDocument;
      } catch (err) {
        if (executeSideEffectsOnError && (bindingsForSideEffects === null || bindingsForSideEffects === void 0 ? void 0 : bindingsForSideEffects.length) > 0) {
          /* The sideEffects are executed only for table items in transient state */
          bindingsForSideEffects.forEach(listBinding => {
            if (!CommonUtils.hasTransientContext(listBinding)) {
              appComponent.getSideEffectsService().requestSideEffectsForNavigationProperty(listBinding.getPath(), context);
            }
          });
        }
        await messageHandler.showMessages();
        throw err;
      } finally {
        this.busyUnlock(appComponent);
      }
    }
    /**
     * Calls a bound or unbound action.
     *
     * @function
     * @static
     * @name sap.fe.core.TransactionHelper.callAction
     * @memberof sap.fe.core.TransactionHelper
     * @param sActionName The name of the action to be called
     * @param [mParameters] Contains the following attributes:
     * @param [mParameters.parameterValues] A map of action parameter names and provided values
     * @param [mParameters.skipParameterDialog] Skips the parameter dialog if values are provided for all of them
     * @param [mParameters.contexts] Mandatory for a bound action: Either one context or an array with contexts for which the action is to be called
     * @param [mParameters.model] Mandatory for an unbound action: An instance of an OData V4 model
     * @param [mParameters.invocationGrouping] Mode how actions are to be called: 'ChangeSet' to put all action calls into one changeset, 'Isolated' to put them into separate changesets
     * @param [mParameters.label] A human-readable label for the action
     * @param [mParameters.bGetBoundContext] If specified, the action promise returns the bound context
     * @param oView Contains the object of the current view
     * @param appComponent The appComponent
     * @param messageHandler The message handler extension
     * @returns Promise resolves with an array of response objects (TODO: to be changed)
     * @ui5-restricted
     * @final
     */;
    _proto.callAction = async function callAction(sActionName, mParameters, oView, appComponent, messageHandler) {
      mParameters = getParameters(mParameters);
      let oContext, oModel;
      const mBindingParameters = mParameters.bindingParameters;
      if (!sActionName) {
        throw new Error("Provide name of action to be executed");
      }
      // action imports are not directly obtained from the metaModel by it is present inside the entityContainer
      // and the acions it refers to present outside the entitycontainer, hence to obtain kind of the action
      // split() on its name was required
      const sName = sActionName.split("/")[1];
      sActionName = sName || sActionName;
      oContext = sName ? undefined : mParameters.contexts;
      //checking whether the context is an array with more than 0 length or not an array(create action)
      if (oContext && (Array.isArray(oContext) && oContext.length || !Array.isArray(oContext))) {
        oContext = Array.isArray(oContext) ? oContext[0] : oContext;
        oModel = oContext.getModel();
      }
      if (mParameters.model) {
        oModel = mParameters.model;
      }
      if (!oModel) {
        throw new Error("Pass a context for a bound action or pass the model for an unbound action");
      }
      // get the binding parameters $select and $expand for the side effect on this action
      // also gather additional property paths to be requested such as text associations
      const mSideEffectsParameters = appComponent.getSideEffectsService().getODataActionSideEffects(sActionName, oContext) || {};
      const displayUnapplicableContextsDialog = () => {
        if (!mParameters.notApplicableContext || mParameters.notApplicableContext.length === 0) {
          return Promise.resolve(mParameters.contexts);
        }
        return new Promise(async (resolve, reject) => {
          const fnOpenAndFillDialog = function (oDlg) {
            let oDialogContent;
            const nNotApplicable = mParameters.notApplicableContext.length,
              aNotApplicableItems = [];
            for (let i = 0; i < mParameters.notApplicableContext.length; i++) {
              oDialogContent = mParameters.notApplicableContext[i].getObject();
              aNotApplicableItems.push(oDialogContent);
            }
            const oNotApplicableItemsModel = new JSONModel(aNotApplicableItems);
            const oTotals = new JSONModel({
              total: nNotApplicable,
              label: mParameters.label
            });
            oDlg.setModel(oNotApplicableItemsModel, "notApplicable");
            oDlg.setModel(oTotals, "totals");
            oDlg.open();
          };
          // Show the contexts that are not applicable and will not therefore be processed
          const sFragmentName = "sap.fe.core.controls.ActionPartial";
          const oDialogFragment = XMLTemplateProcessor.loadTemplate(sFragmentName, "fragment");
          const oMetaModel = oModel.getMetaModel();
          const sCanonicalPath = mParameters.contexts[0].getCanonicalPath();
          const sEntitySet = `${sCanonicalPath.substr(0, sCanonicalPath.indexOf("("))}/`;
          const oDialogLabelModel = new JSONModel({
            title: mParameters.label
          });
          try {
            const oFragment = await XMLPreprocessor.process(oDialogFragment, {
              name: sFragmentName
            }, {
              bindingContexts: {
                entityType: oMetaModel.createBindingContext(sEntitySet),
                label: oDialogLabelModel.createBindingContext("/")
              },
              models: {
                entityType: oMetaModel,
                metaModel: oMetaModel,
                label: oDialogLabelModel
              }
            });
            // eslint-disable-next-line prefer-const
            let oDialog;
            const oController = {
              onClose: function () {
                // User cancels action
                oDialog.close();
                resolve();
              },
              onContinue: function () {
                // Users continues the action with the bound contexts
                oDialog.close();
                resolve(mParameters.applicableContext);
              }
            };
            oDialog = await Fragment.load({
              definition: oFragment,
              controller: oController
            });
            oController.onClose = function () {
              // User cancels action
              oDialog.close();
              resolve();
            };
            oController.onContinue = function () {
              // Users continues the action with the bound contexts
              oDialog.close();
              resolve(mParameters.applicableContext);
            };
            mParameters.parentControl.addDependent(oDialog);
            fnOpenAndFillDialog(oDialog);
          } catch (oError) {
            reject(oError);
          }
        });
      };
      try {
        let oResult;
        if (oContext && oModel) {
          const contextToProcess = await displayUnapplicableContextsDialog();
          if (contextToProcess) {
            oResult = await operations.callBoundAction(sActionName, contextToProcess, oModel, appComponent, {
              parameterValues: mParameters.parameterValues,
              invocationGrouping: mParameters.invocationGrouping,
              label: mParameters.label,
              skipParameterDialog: mParameters.skipParameterDialog,
              mBindingParameters: mBindingParameters,
              entitySetName: mParameters.entitySetName,
              additionalSideEffect: mSideEffectsParameters,
              onSubmitted: () => {
                messageHandler.removeTransitionMessages();
                this.busyLock(appComponent);
              },
              onResponse: () => {
                this.busyUnlock(appComponent);
              },
              parentControl: mParameters.parentControl,
              controlId: mParameters.controlId,
              internalModelContext: mParameters.internalModelContext,
              operationAvailableMap: mParameters.operationAvailableMap,
              bIsCreateAction: mParameters.bIsCreateAction,
              bGetBoundContext: mParameters.bGetBoundContext,
              bObjectPage: mParameters.bObjectPage,
              messageHandler: messageHandler,
              defaultValuesExtensionFunction: mParameters.defaultValuesExtensionFunction,
              selectedItems: mParameters.contexts
            });
          } else {
            oResult = null;
          }
        } else {
          oResult = await operations.callActionImport(sActionName, oModel, appComponent, {
            parameterValues: mParameters.parameterValues,
            label: mParameters.label,
            skipParameterDialog: mParameters.skipParameterDialog,
            bindingParameters: mBindingParameters,
            entitySetName: mParameters.entitySetName,
            onSubmitted: () => {
              this.busyLock(appComponent);
            },
            onResponse: () => {
              this.busyUnlock(appComponent);
            },
            parentControl: mParameters.parentControl,
            internalModelContext: mParameters.internalModelContext,
            operationAvailableMap: mParameters.operationAvailableMap,
            messageHandler: messageHandler,
            bObjectPage: mParameters.bObjectPage
          });
        }
        await this._handleActionResponse(messageHandler, mParameters, sActionName);
        return oResult;
      } catch (err) {
        await this._handleActionResponse(messageHandler, mParameters, sActionName);
        throw err;
      }
    }
    /**
     * Handles messages for action call.
     *
     * @function
     * @name sap.fe.core.TransactionHelper#_handleActionResponse
     * @memberof sap.fe.core.TransactionHelper
     * @param messageHandler The message handler extension
     * @param mParameters Parameters to be considered for the action.
     * @param sActionName The name of the action to be called
     * @returns Promise after message dialog is opened if required.
     * @ui5-restricted
     * @final
     */;
    _proto._handleActionResponse = function _handleActionResponse(messageHandler, mParameters, sActionName) {
      const aTransientMessages = messageHandling.getMessages(true, true);
      const actionName = mParameters.label ? mParameters.label : sActionName;
      if (aTransientMessages.length > 0 && mParameters && mParameters.internalModelContext) {
        mParameters.internalModelContext.setProperty("sActionName", mParameters.label ? mParameters.label : sActionName);
      }
      let control;
      if (mParameters.controlId) {
        control = mParameters.parentControl.byId(mParameters.controlId);
      } else {
        control = mParameters.parentControl;
      }
      return messageHandler.showMessages({
        sActionName: actionName,
        control: control
      });
    }

    /**
     * Handles validation errors for the 'Discard' action.
     *
     * @function
     * @name sap.fe.core.TransactionHelper#handleValidationError
     * @memberof sap.fe.core.TransactionHelper
     * @static
     * @ui5-restricted
     * @final
     */;
    _proto.handleValidationError = function handleValidationError() {
      const oMessageManager = Core.getMessageManager(),
        errorToRemove = oMessageManager.getMessageModel().getData().filter(function (error) {
          // only needs to handle validation messages, technical and persistent errors needs not to be checked here.
          if (error.validation) {
            return error;
          }
        });
      oMessageManager.removeMessages(errorToRemove);
    }

    /**
     * Creates a new Popover. Factory method to make unit tests easier.
     *
     * @param settings Initial parameters for the popover
     * @returns A new Popover
     */;
    _proto._createPopover = function _createPopover(settings) {
      return new Popover(settings);
    }

    /**
     * Shows a popover to confirm discard if needed.
     *
     * @static
     * @name sap.fe.core.TransactionHelper._showDiscardPopover
     * @memberof sap.fe.core.TransactionHelper
     * @param cancelButton The control which will open the popover
     * @param isModified True if the object has been modified and a confirmation popover must be shown
     * @param resourceBundle The bundle to load text resources
     * @returns Promise resolves if user confirms discard, rejects if otherwise, rejects if no control passed to open popover
     * @ui5-restricted
     * @final
     */;
    _proto._confirmDiscard = function _confirmDiscard(cancelButton, isModified, resourceBundle) {
      // If the data isn't modified, do not show any confirmation popover
      if (!isModified) {
        this.handleValidationError();
        return Promise.resolve();
      }
      cancelButton.setEnabled(false);
      return new Promise((resolve, reject) => {
        const confirmationPopover = this._createPopover({
          showHeader: false,
          placement: "Top"
        });
        confirmationPopover.addStyleClass("sapUiContentPadding");

        // Create the content of the popover
        const title = new Text({
          text: CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_DRAFT_DISCARD_MESSAGE", resourceBundle)
        });
        const confirmButton = new Button({
          text: CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_DRAFT_DISCARD_BUTTON", resourceBundle),
          width: "100%",
          press: () => {
            this.handleValidationError();
            confirmationPopover.data("continueDiscard", true);
            confirmationPopover.close();
          },
          ariaLabelledBy: [title]
        });
        confirmationPopover.addContent(new VBox({
          items: [title, confirmButton]
        }));

        // Attach handler
        confirmationPopover.attachBeforeOpen(() => {
          confirmationPopover.setInitialFocus(confirmButton);
        });
        confirmationPopover.attachAfterClose(() => {
          cancelButton.setEnabled(true);
          if (confirmationPopover.data("continueDiscard")) {
            resolve();
          } else {
            reject();
          }
        });
        confirmationPopover.openBy(cancelButton, false);
      });
    };
    _proto._onFieldChange = function _onFieldChange(oEvent, oCreateButton, messageHandler, fnValidateRequiredProperties) {
      messageHandler.removeTransitionMessages();
      const oField = oEvent.getSource();
      const oFieldPromise = oEvent.getParameter("promise");
      if (oFieldPromise) {
        return oFieldPromise.then(function (value) {
          // Setting value of field as '' in case of value help and validating other fields
          oField.setValue(value);
          fnValidateRequiredProperties();
          return oField.getValue();
        }).catch(function (value) {
          if (value !== "") {
            //disabling the continue button in case of invalid value in field
            oCreateButton.setEnabled(false);
          } else {
            // validating all the fields in case of empty value in field
            oField.setValue(value);
            fnValidateRequiredProperties();
          }
        });
      }
    };
    _proto._launchDialogWithKeyFields = function _launchDialogWithKeyFields(oListBinding, mFields, oModel, mParameters, appComponent, messageHandler) {
      let oDialog;
      const oParentControl = mParameters.parentControl;

      // Crate a fake (transient) listBinding and context, just for the binding context of the dialog
      const oTransientListBinding = oModel.bindList(oListBinding.getPath(), oListBinding.getContext(), [], [], {
        $$updateGroupId: "submitLater"
      });
      oTransientListBinding.refreshInternal = function () {
        /* */
      };
      const oTransientContext = oTransientListBinding.create(mParameters.data, true);
      return new Promise(async (resolve, reject) => {
        const sFragmentName = "sap/fe/core/controls/NonComputedVisibleKeyFieldsDialog";
        const oFragment = XMLTemplateProcessor.loadTemplate(sFragmentName, "fragment"),
          oResourceBundle = oParentControl.getController().oResourceBundle,
          oMetaModel = oModel.getMetaModel(),
          aImmutableFields = [],
          sPath = oListBinding.isRelative() ? oListBinding.getResolvedPath() : oListBinding.getPath(),
          oEntitySetContext = oMetaModel.createBindingContext(sPath),
          sMetaPath = oMetaModel.getMetaPath(sPath);
        for (const i in mFields) {
          aImmutableFields.push(oMetaModel.createBindingContext(`${sMetaPath}/${mFields[i]}`));
        }
        const oImmutableCtxModel = new JSONModel(aImmutableFields);
        const oImmutableCtx = oImmutableCtxModel.createBindingContext("/");
        const aRequiredProperties = CommonUtils.getRequiredPropertiesFromInsertRestrictions(sMetaPath, oMetaModel);
        const oRequiredPropertyPathsCtxModel = new JSONModel(aRequiredProperties);
        const oRequiredPropertyPathsCtx = oRequiredPropertyPathsCtxModel.createBindingContext("/");
        const oNewFragment = await XMLPreprocessor.process(oFragment, {
          name: sFragmentName
        }, {
          bindingContexts: {
            entitySet: oEntitySetContext,
            fields: oImmutableCtx,
            requiredProperties: oRequiredPropertyPathsCtx
          },
          models: {
            entitySet: oEntitySetContext.getModel(),
            fields: oImmutableCtx.getModel(),
            metaModel: oMetaModel,
            requiredProperties: oRequiredPropertyPathsCtxModel
          }
        });
        let aFormElements = [];
        const mFieldValueMap = {};
        // eslint-disable-next-line prefer-const
        let oCreateButton;
        const validateRequiredProperties = async function () {
          let bEnabled = false;
          try {
            const aResults = await Promise.all(aFormElements.map(function (oFormElement) {
              return oFormElement.getFields()[0];
            }).filter(function (oField) {
              // The continue button should remain disabled in case of empty required fields.
              return oField.getRequired() || oField.getValueState() === ValueState.Error;
            }).map(async function (oField) {
              const sFieldId = oField.getId();
              if (sFieldId in mFieldValueMap) {
                try {
                  const vValue = await mFieldValueMap[sFieldId];
                  return oField.getValue() === "" ? undefined : vValue;
                } catch (err) {
                  return undefined;
                }
              }
              return oField.getValue() === "" ? undefined : oField.getValue();
            }));
            bEnabled = aResults.every(function (vValue) {
              if (Array.isArray(vValue)) {
                vValue = vValue[0];
              }
              return vValue !== undefined && vValue !== null && vValue !== "";
            });
          } catch (err) {
            bEnabled = false;
          }
          oCreateButton.setEnabled(bEnabled);
        };
        const oController = {
          /*
          					fired on focus out from field or on selecting a value from the valuehelp.
          					the create button is enabled when a value is added.
          					liveChange is not fired when value is added from valuehelp.
          					value validation is not done for create button enablement.
          				*/
          handleChange: oEvent => {
            const sFieldId = oEvent.getParameter("id");
            mFieldValueMap[sFieldId] = this._onFieldChange(oEvent, oCreateButton, messageHandler, validateRequiredProperties);
          },
          /*
          					fired on key press. the create button is enabled when a value is added.
          					liveChange is not fired when value is added from valuehelp.
          					value validation is not done for create button enablement.
          				*/
          handleLiveChange: oEvent => {
            const sFieldId = oEvent.getParameter("id");
            const vValue = oEvent.getParameter("value");
            mFieldValueMap[sFieldId] = vValue;
            validateRequiredProperties();
          }
        };
        const oDialogContent = await Fragment.load({
          definition: oNewFragment,
          controller: oController
        });
        let oResult;
        const closeDialog = function () {
          //rejected/resolved the promis returned by _launchDialogWithKeyFields
          //as soon as the dialog is closed. Without waiting for the dialog's
          //animation to finish
          if (oResult.error) {
            reject(oResult.error);
          } else {
            resolve(oResult.response);
          }
          oDialog.close();
        };
        oDialog = new Dialog(generate(["CreateDialog", sMetaPath]), {
          title: CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE", oResourceBundle),
          content: [oDialogContent],
          beginButton: {
            text: CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE_BUTTON", oResourceBundle),
            type: "Emphasized",
            press: async oEvent => {
              const createButton = oEvent.getSource();
              createButton.setEnabled(false);
              BusyLocker.lock(oDialog);
              mParameters.bIsCreateDialog = true;
              try {
                const aValues = await Promise.all(Object.keys(mFieldValueMap).map(async function (sKey) {
                  const oValue = await mFieldValueMap[sKey];
                  const oDialogValue = {};
                  oDialogValue[sKey] = oValue;
                  return oDialogValue;
                }));
                if (mParameters.beforeCreateCallBack) {
                  await toES6Promise(mParameters.beforeCreateCallBack({
                    contextPath: oListBinding && oListBinding.getPath(),
                    createParameters: aValues
                  }));
                }
                const transientData = oTransientContext.getObject();
                const createData = {};
                Object.keys(transientData).forEach(function (sPropertyPath) {
                  const oProperty = oMetaModel.getObject(`${sMetaPath}/${sPropertyPath}`);
                  // ensure navigation properties are not part of the payload, deep create not supported
                  if (oProperty && oProperty.$kind === "NavigationProperty") {
                    return;
                  }
                  createData[sPropertyPath] = transientData[sPropertyPath];
                });
                const oNewDocumentContext = oListBinding.create(createData, true, mParameters.createAtEnd, mParameters.inactive);
                const oPromise = this.onAfterCreateCompletion(oListBinding, oNewDocumentContext, mParameters);
                let oResponse = await oPromise;
                if (!oResponse || oResponse && oResponse.bKeepDialogOpen !== true) {
                  oResponse = oResponse ?? {};
                  oDialog.setBindingContext(null);
                  oResponse.newContext = oNewDocumentContext;
                  oResult = {
                    response: oResponse
                  };
                  closeDialog();
                }
              } catch (oError) {
                // in case of creation failed, dialog should stay open - to achieve the same, nothing has to be done (like in case of success with bKeepDialogOpen)
                if (oError !== FELibrary.Constants.CreationFailed) {
                  // other errors are not expected
                  oResult = {
                    error: oError
                  };
                  closeDialog();
                } else {
                  createButton.setEnabled(true);
                }
              } finally {
                BusyLocker.unlock(oDialog);
                messageHandler.showMessages();
              }
            }
          },
          endButton: {
            text: CommonUtils.getTranslatedText("C_COMMON_ACTION_PARAMETER_DIALOG_CANCEL", oResourceBundle),
            press: function () {
              oResult = {
                error: FELibrary.Constants.CancelActionDialog
              };
              closeDialog();
            }
          },
          afterClose: function () {
            var _oDialog$getBindingCo;
            // show footer as per UX guidelines when dialog is not open
            (_oDialog$getBindingCo = oDialog.getBindingContext("internal")) === null || _oDialog$getBindingCo === void 0 ? void 0 : _oDialog$getBindingCo.setProperty("isCreateDialogOpen", false);
            oDialog.destroy();
            oTransientListBinding.destroy();
          }
        });
        aFormElements = oDialogContent === null || oDialogContent === void 0 ? void 0 : oDialogContent.getAggregation("form").getAggregation("formContainers")[0].getAggregation("formElements");
        if (oParentControl && oParentControl.addDependent) {
          // if there is a parent control specified add the dialog as dependent
          oParentControl.addDependent(oDialog);
        }
        oCreateButton = oDialog.getBeginButton();
        oDialog.setBindingContext(oTransientContext);
        try {
          await CommonUtils.setUserDefaults(appComponent, aImmutableFields, oTransientContext, false, mParameters.createAction, mParameters.data);
          validateRequiredProperties();
          // footer must not be visible when the dialog is open as per UX guidelines
          oDialog.getBindingContext("internal").setProperty("isCreateDialogOpen", true);
          oDialog.open();
        } catch (oError) {
          await messageHandler.showMessages();
          throw oError;
        }
      });
    };
    _proto.onAfterCreateCompletion = function onAfterCreateCompletion(oListBinding, oNewDocumentContext, mParameters) {
      let fnResolve;
      const oPromise = new Promise(resolve => {
        fnResolve = resolve;
      });
      const fnCreateCompleted = oEvent => {
        const oContext = oEvent.getParameter("context"),
          bSuccess = oEvent.getParameter("success");
        if (oContext === oNewDocumentContext) {
          oListBinding.detachCreateCompleted(fnCreateCompleted, this);
          fnResolve(bSuccess);
        }
      };
      const fnSafeContextCreated = () => {
        oNewDocumentContext.created().then(undefined, function () {
          Log.trace("transient creation context deleted");
        }).catch(function (contextError) {
          Log.trace("transient creation context deletion error", contextError);
        });
      };
      oListBinding.attachCreateCompleted(fnCreateCompleted, this);
      return oPromise.then(bSuccess => {
        if (!bSuccess) {
          if (!mParameters.keepTransientContextOnFailed) {
            // Cancel the pending POST and delete the context in the listBinding
            fnSafeContextCreated(); // To avoid a 'request cancelled' error in the console
            oListBinding.resetChanges();
            oListBinding.getModel().resetChanges(oListBinding.getUpdateGroupId());
            throw FELibrary.Constants.CreationFailed;
          }
          return {
            bKeepDialogOpen: true
          };
        } else {
          return oNewDocumentContext.created();
        }
      });
    }
    /**
     * Retrieves the name of the NewAction to be executed.
     *
     * @function
     * @static
     * @private
     * @name sap.fe.core.TransactionHelper._getNewAction
     * @memberof sap.fe.core.TransactionHelper
     * @param oStartupParameters Startup parameters of the application
     * @param sCreateHash Hash to be checked for action type
     * @param oMetaModel The MetaModel used to check for NewAction parameter
     * @param sMetaPath The MetaPath
     * @returns The name of the action
     * @ui5-restricted
     * @final
     */;
    _proto._getNewAction = function _getNewAction(oStartupParameters, sCreateHash, oMetaModel, sMetaPath) {
      let sNewAction;
      if (oStartupParameters && oStartupParameters.preferredMode && sCreateHash.toUpperCase().indexOf("I-ACTION=CREATEWITH") > -1) {
        const sPreferredMode = oStartupParameters.preferredMode[0];
        sNewAction = sPreferredMode.toUpperCase().indexOf("CREATEWITH:") > -1 ? sPreferredMode.substr(sPreferredMode.lastIndexOf(":") + 1) : undefined;
      } else if (oStartupParameters && oStartupParameters.preferredMode && sCreateHash.toUpperCase().indexOf("I-ACTION=AUTOCREATEWITH") > -1) {
        const sPreferredMode = oStartupParameters.preferredMode[0];
        sNewAction = sPreferredMode.toUpperCase().indexOf("AUTOCREATEWITH:") > -1 ? sPreferredMode.substr(sPreferredMode.lastIndexOf(":") + 1) : undefined;
      } else {
        sNewAction = oMetaModel && oMetaModel.getObject !== undefined ? oMetaModel.getObject(`${sMetaPath}@com.sap.vocabularies.Session.v1.StickySessionSupported/NewAction`) || oMetaModel.getObject(`${sMetaPath}@com.sap.vocabularies.Common.v1.DraftRoot/NewAction`) : undefined;
      }
      return sNewAction;
    }
    /**
     * Retrieves the label for the title of a specific create action dialog, e.g. Create Sales Order from Quotation.
     *
     * The following priority is applied:
     * 1. label of line-item annotation.
     * 2. label annotated in the action.
     * 3. "Create" as a constant from i18n.
     *
     * @function
     * @static
     * @private
     * @name sap.fe.core.TransactionHelper._getSpecificCreateActionDialogLabel
     * @memberof sap.fe.core.TransactionHelper
     * @param oMetaModel The MetaModel used to check for the NewAction parameter
     * @param sMetaPath The MetaPath
     * @param sNewAction Contains the name of the action to be executed
     * @param oResourceBundleCore ResourceBundle to access the default Create label
     * @returns The label for the Create Action Dialog
     * @ui5-restricted
     * @final
     */;
    _proto._getSpecificCreateActionDialogLabel = function _getSpecificCreateActionDialogLabel(oMetaModel, sMetaPath, sNewAction, oResourceBundleCore) {
      const fnGetLabelFromLineItemAnnotation = function () {
        if (oMetaModel && oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.UI.v1.LineItem`)) {
          const iLineItemIndex = oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.UI.v1.LineItem`).findIndex(function (oLineItem) {
            const aLineItemAction = oLineItem.Action ? oLineItem.Action.split("(") : undefined;
            return aLineItemAction ? aLineItemAction[0] === sNewAction : false;
          });
          return iLineItemIndex > -1 ? oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.UI.v1.LineItem`)[iLineItemIndex].Label : undefined;
        } else {
          return undefined;
        }
      };
      return fnGetLabelFromLineItemAnnotation() || oMetaModel && oMetaModel.getObject(`${sMetaPath}/${sNewAction}@com.sap.vocabularies.Common.v1.Label`) || oResourceBundleCore && oResourceBundleCore.getText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE");
    };
    return TransactionHelper;
  }();
  const singleton = new TransactionHelper();
  return singleton;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/TransactionHelper", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/controllerextensions/editFlow/draft","sap/fe/core/controllerextensions/editFlow/operations","sap/fe/core/controllerextensions/editFlow/sticky","sap/fe/core/controllerextensions/messageHandler/messageHandling","sap/fe/core/helpers/DeleteHelper","sap/fe/core/helpers/FPMHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/library","sap/m/Button","sap/m/Dialog","sap/m/MessageBox","sap/m/MessageToast","sap/m/Popover","sap/m/Text","sap/m/VBox","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/library","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/model/json/JSONModel","../../helpers/ToES6Promise"],function(e,t,n,o,a,s,r,i,l,c,d,u,g,f,p,C,h,m,b,y,w,x,A,E,T,D){"use strict";var P=d.generate;const M=u.CreationMode;const v=u.ProgrammingModel;const O=x.ValueState;function _(e){if(e&&e.getMetadata&&e.getMetadata().getName()==="sap.ui.base.Event"){e={}}return e||{}}let I=function(){function d(){}var I=d.prototype;I.busyLock=function e(t,o){n.lock(t.getModel("ui"),o)};I.busyUnlock=function e(t,o){n.unlock(t.getModel("ui"),o)};I.getProgrammingModel=function e(t){let n;if(t.isA("sap.ui.model.odata.v4.Context")){n=t.getPath()}else{n=(t.isRelative()?t.getResolvedPath():t.getPath())??""}const o=t.getModel().getMetaModel();if(c.isDraftSupported(o,n)){return v.Draft}else if(c.isStickySessionSupported(o)){return v.Sticky}else{return v.NonDraft}};I.validateDocument=function e(t,n,o){const a=n&&n.customValidationFunction;if(a){const e=a.substring(0,a.lastIndexOf(".")||-1).replace(/\./gi,"/"),s=a.substring(a.lastIndexOf(".")+1,a.length),r=n.data;delete r["@$ui5.context.isTransient"];return l.validationWrapper(e,s,r,o,t)}return Promise.resolve([])};I.createDocument=async function n(o,s,r,i,l,d){const g=o.getModel(),f=g.getMetaModel(),p=f.getMetaPath(o.getHeaderContext().getPath()),C=r.getRouterProxy().getHash(),h=r.getComponentData(),m=h&&h.startupParameters||{},b=!o.isRelative()?this._getNewAction(m,C,f,p):undefined;const w={$$patchWithoutSideEffects:true};const x=f.getObject(`${p}/@com.sap.vocabularies.Common.v1.Messages/$Path`);let A="/busy";let E=f.getObject(`${p}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`)||f.getObject(`${c.getTargetEntitySet(f.getContext(p))}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`);let T;let P;if(E){if(f.getObject(`${p}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`)&&c.getTargetEntitySet(f.getContext(p))!==p){T=true}else{T=false}}if(x){w["$select"]=x}const O=_(s);if(!o){throw new Error("Binding required for new document creation")}const I=this.getProgrammingModel(o);if(I!==v.Draft&&I!==v.Sticky){throw new Error("Create document only allowed for draft or sticky session supported services")}if(O.busyMode==="Local"){A=`/busyLocal/${O.busyId}`}O.beforeCreateCallBack=l?null:O.beforeCreateCallBack;this.busyLock(r,A);const S=y.getLibraryResourceBundle("sap.fe.core");let B;try{if(b){B=await this.callAction(b,{contexts:o.getHeaderContext(),showActionParameterDialog:true,label:this._getSpecificCreateActionDialogLabel(f,p,b,S),bindingParameters:w,parentControl:O.parentControl,bIsCreateAction:true,skipParameterDialog:O.skipParameterDialog},null,r,i)}else{const n=O.creationMode!==M.CreationRow&&O.creationMode!==M.Inline;const s=n?t.getNonComputedVisibleFields(f,p,d):[];E=l?null:E;let c,u;if(E){if(T){c=o.getContext()&&`${f.getMetaPath(o.getContext().getPath())}/${E}`;u=o.getContext()}else{c=o.getHeaderContext()&&`${f.getMetaPath(o.getHeaderContext().getPath())}/${E}`;u=o.getHeaderContext()}}const C=c&&f.createBindingContext(c);try{let t;try{const e=C&&C.getObject()&&C.getObject()[0].$IsBound?await a.callBoundFunction(E,u,g):await a.callFunctionImport(E,g);if(e){t=e.getObject()}}catch(t){e.error(`Error while executing the function ${E}`,t);throw t}O.data=t?Object.assign({},t,O.data):O.data;if(O.data){delete O.data["@odata.context"]}if(s.length>0){B=await this._launchDialogWithKeyFields(o,s,g,O,r,i);P=B.newContext}else{if(O.beforeCreateCallBack){await D(O.beforeCreateCallBack({contextPath:o&&o.getPath()}))}P=o.create(O.data,true,O.createAtEnd,O.inactive);if(!O.inactive){B=await this.onAfterCreateCompletion(o,P,O)}}}catch(t){e.error("Error while creating the new document",t);throw t}}P=P||B;await i.showMessageDialog({control:O.parentControl});return P}catch(e){var N;await i.showMessageDialog({control:O.parentControl});if((e===u.Constants.ActionExecutionFailed||e===u.Constants.CancelActionDialog)&&(N=P)!==null&&N!==void 0&&N.isTransient()){P.delete("$direct")}throw e}finally{this.busyUnlock(r,A)}};I._isDraftEnabled=function e(t){const n=t[0];const o=this.getProgrammingModel(n);return o===v.Draft};I.deleteDocument=function e(n,o,a,s,l){const c=y.getLibraryResourceBundle("sap.fe.core");let d;this.busyLock(a);const u=Array.isArray(n)?[...n]:[n];return new Promise((e,n)=>{try{const C=this._isDraftEnabled(o.selectedContexts||u);const h=[];const m=[];if(o){if(!o.numberOfSelectedContexts){if(C){const e=u.find(e=>{const t=e.getObject();return t.IsActiveEntity===true&&t.HasDraftEntity===true&&t.DraftAdministrativeData&&t.DraftAdministrativeData.InProcessByUser&&!t.DraftAdministrativeData.DraftIsCreatedByMe});if(e){const o=e.getObject().DraftAdministrativeData.InProcessByUser;p.show(t.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_OBJECT_LOCKED",s,[o]),{title:c.getText("C_COMMON_DELETE"),onClose:n});return}}o=_(o);let e="";if(o.title){if(o.description){d=[o.title+" ",o.description]}else{d=[o.title,""]}e=t.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO",s,d,o.entitySetName)}else{e=t.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR",s,undefined,o.entitySetName)}m.push({type:"deletableContexts",contexts:u,text:e,selected:true,control:"text"})}else{let e=u.length;if(C){e+=o.draftsWithNonDeletableActive.length+o.draftsWithDeletableActive.length+o.unSavedContexts.length+o.createModeContexts.length;i.updateDraftOptionsForDeletableTexts(o,u,e,s,h,m)}i.updateOptionsForDeletableTexts(o,u,s,m)}}i.updateContentForDeleteDialog(m,h);const y=new b({items:h});const w=c.getText("C_COMMON_DELETE");const x=async()=>{this.busyLock(a);try{await i.deleteConfirmHandler(m,o,l,s,a,C);e()}catch(e){n()}finally{this.busyUnlock(a)}};let A=false;const E=new f({title:w,state:"Warning",content:[y],ariaLabelledBy:h,beginButton:new g({text:c.getText("C_COMMON_DELETE"),type:"Emphasized",press:function(){r.removeBoundTransitionMessages();A=true;E.close();x()}}),endButton:new g({text:t.getTranslatedText("C_COMMON_DIALOG_CANCEL",s),press:function(){E.close()}}),afterClose:function(){E.destroy();if(!A){n()}}});if(o.noDialog){x()}else{E.addStyleClass("sapUiContentPadding");E.open()}}finally{this.busyUnlock(a)}})};I.editDocument=async function e(t,n,a,r){const i=this.getProgrammingModel(t);if(!t){throw new Error("Binding context to active document is required")}if(i!==v.Draft&&i!==v.Sticky){throw new Error("Edit is only allowed for draft or sticky session supported services")}this.busyLock(a);r.removeTransitionMessages();try{const e=i===v.Draft?await o.createDraftFromActiveDocument(t,a,{bPreserveChanges:true,oView:n}):await s.editDocumentInStickySession(t,a);await r.showMessageDialog();return e}catch(e){await r.showMessages({concurrentEditFlag:true});throw e}finally{this.busyUnlock(a)}};I.cancelDocument=async function e(t,n,a,r,i,l,c){if(!t){throw new Error("No context exists. Pass a meaningful context")}this.busyLock(a);const d=_(n);const u=t.getModel();const g=this.getProgrammingModel(t);if(g!==v.Draft&&g!==v.Sticky){throw new Error("Cancel document only allowed for draft or sticky session supported services")}try{let e=false;if(g===v.Draft&&!c){const e=u.bindContext(`${t.getPath()}/DraftAdministrativeData`).getBoundContext();const n=await e.requestObject();if(n){c=n.CreationDateTime!==n.LastChangeDateTime}}if(!d.skipDiscardPopover){await this._confirmDiscard(d.cancelButton,c,r)}if(t.isKeepAlive()){t.setKeepAlive(false)}if(d.beforeCancelCallBack){await d.beforeCancelCallBack({context:t})}if(g===v.Draft){if(l){if(t.hasPendingChanges()){t.getBinding().resetChanges()}e=await o.deleteDraft(t,a)}else{const n=u.bindContext(`${t.getPath()}/SiblingEntity`).getBoundContext();try{const s=await n.requestCanonicalPath();if(t.hasPendingChanges()){t.getBinding().resetChanges()}e=u.bindContext(s).getBoundContext()}finally{await o.deleteDraft(t,a)}}}else{const n=await s.discardDocument(t);if(n){if(n.hasPendingChanges()){n.getBinding().resetChanges()}if(!l){n.refresh();e=n}}}i.removeTransitionMessages();await i.showMessages();return e}catch(e){await i.showMessages();throw e}finally{this.busyUnlock(a)}};I.saveDocument=async function e(n,a,i,l,c,d,u){const g=this.getProgrammingModel(n);if(g!==v.Sticky&&g!==v.Draft){throw new Error("Save is only allowed for draft or sticky session supported services")}d.removeTransitionMessages();try{this.busyLock(a);const e=g===v.Draft?await o.activateDocument(n,a,{},d):await s.activateDocument(n,a);const l=r.getMessages().concat(r.getMessages(true,true));if(!(l.length===1&&l[0].type===x.MessageType.Success)){C.show(u?t.getTranslatedText("C_TRANSACTION_HELPER_OBJECT_CREATED",i):t.getTranslatedText("C_TRANSACTION_HELPER_OBJECT_SAVED",i))}return e}catch(e){if(l&&(c===null||c===void 0?void 0:c.length)>0){c.forEach(e=>{if(!t.hasTransientContext(e)){a.getSideEffectsService().requestSideEffectsForNavigationProperty(e.getPath(),n)}})}await d.showMessages();throw e}finally{this.busyUnlock(a)}};I.callAction=async function e(t,n,o,s,r){n=_(n);let i,l;const c=n.bindingParameters;if(!t){throw new Error("Provide name of action to be executed")}const d=t.split("/")[1];t=d||t;i=d?undefined:n.contexts;if(i&&(Array.isArray(i)&&i.length||!Array.isArray(i))){i=Array.isArray(i)?i[0]:i;l=i.getModel()}if(n.model){l=n.model}if(!l){throw new Error("Pass a context for a bound action or pass the model for an unbound action")}const u=s.getSideEffectsService().getODataActionSideEffects(t,i)||{};const g=()=>{if(!n.notApplicableContext||n.notApplicableContext.length===0){return Promise.resolve(n.contexts)}return new Promise(async(e,t)=>{const o=function(e){let t;const o=n.notApplicableContext.length,a=[];for(let e=0;e<n.notApplicableContext.length;e++){t=n.notApplicableContext[e].getObject();a.push(t)}const s=new T(a);const r=new T({total:o,label:n.label});e.setModel(s,"notApplicable");e.setModel(r,"totals");e.open()};const a="sap.fe.core.controls.ActionPartial";const s=E.loadTemplate(a,"fragment");const r=l.getMetaModel();const i=n.contexts[0].getCanonicalPath();const c=`${i.substr(0,i.indexOf("("))}/`;const d=new T({title:n.label});try{const t=await A.process(s,{name:a},{bindingContexts:{entityType:r.createBindingContext(c),label:d.createBindingContext("/")},models:{entityType:r,metaModel:r,label:d}});let i;const l={onClose:function(){i.close();e()},onContinue:function(){i.close();e(n.applicableContext)}};i=await w.load({definition:t,controller:l});l.onClose=function(){i.close();e()};l.onContinue=function(){i.close();e(n.applicableContext)};n.parentControl.addDependent(i);o(i)}catch(e){t(e)}})};try{let e;if(i&&l){const o=await g();if(o){e=await a.callBoundAction(t,o,l,s,{parameterValues:n.parameterValues,invocationGrouping:n.invocationGrouping,label:n.label,skipParameterDialog:n.skipParameterDialog,mBindingParameters:c,entitySetName:n.entitySetName,additionalSideEffect:u,onSubmitted:()=>{r.removeTransitionMessages();this.busyLock(s)},onResponse:()=>{this.busyUnlock(s)},parentControl:n.parentControl,controlId:n.controlId,internalModelContext:n.internalModelContext,operationAvailableMap:n.operationAvailableMap,bIsCreateAction:n.bIsCreateAction,bGetBoundContext:n.bGetBoundContext,bObjectPage:n.bObjectPage,messageHandler:r,defaultValuesExtensionFunction:n.defaultValuesExtensionFunction,selectedItems:n.contexts})}else{e=null}}else{e=await a.callActionImport(t,l,s,{parameterValues:n.parameterValues,label:n.label,skipParameterDialog:n.skipParameterDialog,bindingParameters:c,entitySetName:n.entitySetName,onSubmitted:()=>{this.busyLock(s)},onResponse:()=>{this.busyUnlock(s)},parentControl:n.parentControl,internalModelContext:n.internalModelContext,operationAvailableMap:n.operationAvailableMap,messageHandler:r,bObjectPage:n.bObjectPage})}await this._handleActionResponse(r,n,t);return e}catch(e){await this._handleActionResponse(r,n,t);throw e}};I._handleActionResponse=function e(t,n,o){const a=r.getMessages(true,true);const s=n.label?n.label:o;if(a.length>0&&n&&n.internalModelContext){n.internalModelContext.setProperty("sActionName",n.label?n.label:o)}let i;if(n.controlId){i=n.parentControl.byId(n.controlId)}else{i=n.parentControl}return t.showMessages({sActionName:s,control:i})};I.handleValidationError=function e(){const t=y.getMessageManager(),n=t.getMessageModel().getData().filter(function(e){if(e.validation){return e}});t.removeMessages(n)};I._createPopover=function e(t){return new h(t)};I._confirmDiscard=function e(n,o,a){if(!o){this.handleValidationError();return Promise.resolve()}n.setEnabled(false);return new Promise((e,o)=>{const s=this._createPopover({showHeader:false,placement:"Top"});s.addStyleClass("sapUiContentPadding");const r=new m({text:t.getTranslatedText("C_TRANSACTION_HELPER_DRAFT_DISCARD_MESSAGE",a)});const i=new g({text:t.getTranslatedText("C_TRANSACTION_HELPER_DRAFT_DISCARD_BUTTON",a),width:"100%",press:()=>{this.handleValidationError();s.data("continueDiscard",true);s.close()},ariaLabelledBy:[r]});s.addContent(new b({items:[r,i]}));s.attachBeforeOpen(()=>{s.setInitialFocus(i)});s.attachAfterClose(()=>{n.setEnabled(true);if(s.data("continueDiscard")){e()}else{o()}});s.openBy(n,false)})};I._onFieldChange=function e(t,n,o,a){o.removeTransitionMessages();const s=t.getSource();const r=t.getParameter("promise");if(r){return r.then(function(e){s.setValue(e);a();return s.getValue()}).catch(function(e){if(e!==""){n.setEnabled(false)}else{s.setValue(e);a()}})}};I._launchDialogWithKeyFields=function e(o,a,s,r,i,l){let c;const d=r.parentControl;const g=s.bindList(o.getPath(),o.getContext(),[],[],{$$updateGroupId:"submitLater"});g.refreshInternal=function(){};const p=g.create(r.data,true);return new Promise(async(e,C)=>{const h="sap/fe/core/controls/NonComputedVisibleKeyFieldsDialog";const m=E.loadTemplate(h,"fragment"),b=d.getController().oResourceBundle,y=s.getMetaModel(),x=[],M=o.isRelative()?o.getResolvedPath():o.getPath(),v=y.createBindingContext(M),_=y.getMetaPath(M);for(const e in a){x.push(y.createBindingContext(`${_}/${a[e]}`))}const I=new T(x);const S=I.createBindingContext("/");const B=t.getRequiredPropertiesFromInsertRestrictions(_,y);const N=new T(B);const R=N.createBindingContext("/");const k=await A.process(m,{name:h},{bindingContexts:{entitySet:v,fields:S,requiredProperties:R},models:{entitySet:v.getModel(),fields:S.getModel(),metaModel:y,requiredProperties:N}});let L=[];const F={};let H;const $=async function(){let e=false;try{const t=await Promise.all(L.map(function(e){return e.getFields()[0]}).filter(function(e){return e.getRequired()||e.getValueState()===O.Error}).map(async function(e){const t=e.getId();if(t in F){try{const n=await F[t];return e.getValue()===""?undefined:n}catch(e){return undefined}}return e.getValue()===""?undefined:e.getValue()}));e=t.every(function(e){if(Array.isArray(e)){e=e[0]}return e!==undefined&&e!==null&&e!==""})}catch(t){e=false}H.setEnabled(e)};const j={handleChange:e=>{const t=e.getParameter("id");F[t]=this._onFieldChange(e,H,l,$)},handleLiveChange:e=>{const t=e.getParameter("id");const n=e.getParameter("value");F[t]=n;$()}};const U=await w.load({definition:k,controller:j});let V;const W=function(){if(V.error){C(V.error)}else{e(V.response)}c.close()};c=new f(P(["CreateDialog",_]),{title:t.getTranslatedText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE",b),content:[U],beginButton:{text:t.getTranslatedText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE_BUTTON",b),type:"Emphasized",press:async e=>{const t=e.getSource();t.setEnabled(false);n.lock(c);r.bIsCreateDialog=true;try{const e=await Promise.all(Object.keys(F).map(async function(e){const t=await F[e];const n={};n[e]=t;return n}));if(r.beforeCreateCallBack){await D(r.beforeCreateCallBack({contextPath:o&&o.getPath(),createParameters:e}))}const t=p.getObject();const a={};Object.keys(t).forEach(function(e){const n=y.getObject(`${_}/${e}`);if(n&&n.$kind==="NavigationProperty"){return}a[e]=t[e]});const s=o.create(a,true,r.createAtEnd,r.inactive);const i=this.onAfterCreateCompletion(o,s,r);let d=await i;if(!d||d&&d.bKeepDialogOpen!==true){d=d??{};c.setBindingContext(null);d.newContext=s;V={response:d};W()}}catch(e){if(e!==u.Constants.CreationFailed){V={error:e};W()}else{t.setEnabled(true)}}finally{n.unlock(c);l.showMessages()}}},endButton:{text:t.getTranslatedText("C_COMMON_ACTION_PARAMETER_DIALOG_CANCEL",b),press:function(){V={error:u.Constants.CancelActionDialog};W()}},afterClose:function(){var e;(e=c.getBindingContext("internal"))===null||e===void 0?void 0:e.setProperty("isCreateDialogOpen",false);c.destroy();g.destroy()}});L=U===null||U===void 0?void 0:U.getAggregation("form").getAggregation("formContainers")[0].getAggregation("formElements");if(d&&d.addDependent){d.addDependent(c)}H=c.getBeginButton();c.setBindingContext(p);try{await t.setUserDefaults(i,x,p,false,r.createAction,r.data);$();c.getBindingContext("internal").setProperty("isCreateDialogOpen",true);c.open()}catch(e){await l.showMessages();throw e}})};I.onAfterCreateCompletion=function t(n,o,a){let s;const r=new Promise(e=>{s=e});const i=e=>{const t=e.getParameter("context"),a=e.getParameter("success");if(t===o){n.detachCreateCompleted(i,this);s(a)}};const l=()=>{o.created().then(undefined,function(){e.trace("transient creation context deleted")}).catch(function(t){e.trace("transient creation context deletion error",t)})};n.attachCreateCompleted(i,this);return r.then(e=>{if(!e){if(!a.keepTransientContextOnFailed){l();n.resetChanges();n.getModel().resetChanges(n.getUpdateGroupId());throw u.Constants.CreationFailed}return{bKeepDialogOpen:true}}else{return o.created()}})};I._getNewAction=function e(t,n,o,a){let s;if(t&&t.preferredMode&&n.toUpperCase().indexOf("I-ACTION=CREATEWITH")>-1){const e=t.preferredMode[0];s=e.toUpperCase().indexOf("CREATEWITH:")>-1?e.substr(e.lastIndexOf(":")+1):undefined}else if(t&&t.preferredMode&&n.toUpperCase().indexOf("I-ACTION=AUTOCREATEWITH")>-1){const e=t.preferredMode[0];s=e.toUpperCase().indexOf("AUTOCREATEWITH:")>-1?e.substr(e.lastIndexOf(":")+1):undefined}else{s=o&&o.getObject!==undefined?o.getObject(`${a}@com.sap.vocabularies.Session.v1.StickySessionSupported/NewAction`)||o.getObject(`${a}@com.sap.vocabularies.Common.v1.DraftRoot/NewAction`):undefined}return s};I._getSpecificCreateActionDialogLabel=function e(t,n,o,a){const s=function(){if(t&&t.getObject(`${n}/@com.sap.vocabularies.UI.v1.LineItem`)){const e=t.getObject(`${n}/@com.sap.vocabularies.UI.v1.LineItem`).findIndex(function(e){const t=e.Action?e.Action.split("("):undefined;return t?t[0]===o:false});return e>-1?t.getObject(`${n}/@com.sap.vocabularies.UI.v1.LineItem`)[e].Label:undefined}else{return undefined}};return s()||t&&t.getObject(`${n}/${o}@com.sap.vocabularies.Common.v1.Label`)||a&&a.getText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE")};return d}();const S=new I;return S},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/draft-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/messageHandler/messageHandling", "sap/m/Button", "sap/m/Dialog", "sap/m/MessageBox", "sap/m/Text", "sap/ui/core/Core", "../../operationsHelper", "./draftDataLossPopup"], function (Log, CommonUtils, messageHandling, Button, Dialog, MessageBox, Text, Core, operationsHelper, draftDataLossPopup) {
  "use strict";

  /**
   * Interface for callbacks used in the functions
   *
   *
   * @author SAP SE
   * @since 1.54.0
   * @interface
   * @name sap.fe.core.actions.draft.ICallback
   * @private
   */

  /**
   * Callback to approve or reject the creation of a draft
   *
   * @name sap.fe.core.actions.draft.ICallback.beforeCreateDraftFromActiveDocument
   * @function
   * @static
   * @abstract
   * @param {sap.ui.model.odata.v4.Context} oContext Context of the active document for the new draft
   * @returns {(boolean|Promise)} Approval of draft creation [true|false] or Promise that resolves with the boolean value
   * @private
   */

  /**
   * Callback after a draft was successully created
   *
   * @name sap.fe.core.actions.draft.ICallback.afterCreateDraftFromActiveDocument
   * @function
   * @static
   * @abstract
   * @param {sap.ui.model.odata.v4.Context} oContext Context of the new draft
   * @param {sap.ui.model.odata.v4.Context} oActiveDocumentContext Context of the active document for the new draft
   * @returns {sap.ui.model.odata.v4.Context} oActiveDocumentContext
   * @private
   */

  /**
   * Callback to approve or reject overwriting an unsaved draft of another user
   *
   * @name sap.fe.core.actions.draft.ICallback.whenDecisionToOverwriteDocumentIsRequired
   * @function
   * @public
   * @static
   * @abstract
   * @param {sap.ui.model.odata.v4.Context} oContext Context of the active document for the new draft
   * @returns {(boolean|Promise)} Approval to overwrite unsaved draft [true|false] or Promise that resolves with the boolean value
   * @ui5-restricted
   */
  /* Constants for draft operations */
  const draftOperations = {
    EDIT: "EditAction",
    ACTIVATION: "ActivationAction",
    DISCARD: "DiscardAction",
    PREPARE: "PreparationAction"
  };

  /**
   * Static functions for the draft programming model
   *
   * @namespace
   * @alias sap.fe.core.actions.draft
   * @private
   * @experimental This module is only for experimental use! <br/><b>This is only a POC and maybe deleted</b>
   * @since 1.54.0
   */

  /**
   * Determines the action name for a draft operation.
   *
   * @param oContext The context that should be bound to the operation
   * @param sOperation The operation name
   * @returns The name of the draft operation
   */
  function getActionName(oContext, sOperation) {
    const oModel = oContext.getModel(),
      oMetaModel = oModel.getMetaModel(),
      sEntitySetPath = oMetaModel.getMetaPath(oContext.getPath());
    return oMetaModel.getObject(`${sEntitySetPath}@com.sap.vocabularies.Common.v1.DraftRoot/${sOperation}`);
  }
  /**
   * Creates an operation context binding for the given context and operation.
   *
   * @param oContext The context that should be bound to the operation
   * @param sOperation The operation (action or function import)
   * @param oOptions Options to create the operation context
   * @returns The context binding of the bound operation
   */
  function createOperation(oContext, sOperation, oOptions) {
    const sOperationName = getActionName(oContext, sOperation);
    return oContext.getModel().bindContext(`${sOperationName}(...)`, oContext, oOptions);
  }
  /**
   * Determines the return type for a draft operation.
   *
   * @param oContext The context that should be bound to the operation
   * @param sOperation The operation name
   * @returns The return type of the draft operation
   */
  function getReturnType(oContext, sOperation) {
    const oModel = oContext.getModel(),
      oMetaModel = oModel.getMetaModel(),
      sEntitySetPath = oMetaModel.getMetaPath(oContext.getPath());
    return oMetaModel.getObject(`${sEntitySetPath}@com.sap.vocabularies.Common.v1.DraftRoot/${sOperation}/$ReturnType`);
  }
  /**
   * Check if optional draft prepare action exists.
   *
   * @param oContext The context that should be bound to the operation
   * @returns True if a a prepare action exists
   */
  function hasPrepareAction(oContext) {
    return !!getActionName(oContext, draftOperations.PREPARE);
  }
  /**
   * Creates a new draft from an active document.
   *
   * @function
   * @param oContext Context for which the action should be performed
   * @param bPreserveChanges If true - existing changes from another user that are not locked are preserved and an error is sent from the backend, otherwise false - existing changes from another user that are not locked are overwritten</li>
   * @param oView If true - existing changes from another
   * @returns Resolve function returns the context of the operation
   * @private
   * @ui5-restricted
   */
  async function executeDraftEditAction(oContext, bPreserveChanges, oView) {
    if (oContext.getProperty("IsActiveEntity")) {
      const oOptions = {
        $$inheritExpandSelect: true
      };
      const oOperation = createOperation(oContext, draftOperations.EDIT, oOptions);
      oOperation.setParameter("PreserveChanges", bPreserveChanges);
      const sGroupId = "direct";
      const oResourceBundle = await oView.getModel("sap.fe.i18n").getResourceBundle();
      const sActionName = CommonUtils.getTranslatedText("C_COMMON_OBJECT_PAGE_EDIT", oResourceBundle);
      //If the context is coming from a list binding we pass the flag true to replace the context by the active one
      const oEditPromise = oOperation.execute(sGroupId, undefined, operationsHelper.fnOnStrictHandlingFailed.bind(draft, sGroupId, {
        label: sActionName,
        model: oContext.getModel()
      }, oResourceBundle, null, null, null, undefined, undefined), oContext.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"));
      oOperation.getModel().submitBatch(sGroupId);
      return await oEditPromise;
    } else {
      throw new Error("You cannot edit this draft document");
    }
  }

  /**
   * Executes the validation of the draft. The PrepareAction is triggered if the messages are annotated and entitySet gets a PreparationAction annotated.
   * If the operation succeeds and operation doesn't get a return type (RAP system) the messages are requested.
   *
   * @function
   * @param context Context for which the PrepareAction should be performed
   * @param appComponent The AppComponent
   * @param ignoreETag If set to true, ETags are ignored when executing the action
   * @returns Resolve function returns
   *  - the context of the operation if the action has been successfully executed
   *  - void if the action has failed
   *  - undefined if the action has not been triggered since the prerequisites are not met
   * @private
   * @ui5-restricted
   */
  async function executeDraftValidation(context, appComponent, ignoreETag) {
    if (draft.getMessagesPath(context) && draft.hasPrepareAction(context)) {
      try {
        const operation = await draft.executeDraftPreparationAction(context, context.getUpdateGroupId(), true, ignoreETag);
        // if there is no returned operation by executeDraftPreparationAction -> the action has failed
        if (operation && !getReturnType(context, draftOperations.PREPARE)) {
          requestMessages(context, appComponent.getSideEffectsService());
        }
        return operation;
      } catch (error) {
        Log.error("Error while requesting messages", error);
      }
    }
    return undefined;
  }

  /**
   * Activates a draft document. The draft will replace the sibling entity and will be deleted by the back end.
   *
   * @function
   * @param oContext Context for which the action should be performed
   * @param oAppComponent The AppComponent
   * @param [sGroupId] The optional batch group in which the operation is to be executed
   * @returns Resolve function returns the context of the operation
   * @private
   * @ui5-restricted
   */
  async function executeDraftActivationAction(oContext, oAppComponent, sGroupId) {
    const bHasPrepareAction = hasPrepareAction(oContext);

    // According to the draft spec if the service contains a prepare action and we trigger both prepare and
    // activate in one $batch the activate action is called with iF-Match=*
    const bIgnoreEtag = bHasPrepareAction;
    if (!oContext.getProperty("IsActiveEntity")) {
      const oOperation = createOperation(oContext, draftOperations.ACTIVATION, {
        $$inheritExpandSelect: true
      });
      const oResourceBundle = await oAppComponent.getModel("sap.fe.i18n").getResourceBundle();
      const sActionName = CommonUtils.getTranslatedText("C_OP_OBJECT_PAGE_SAVE", oResourceBundle);
      try {
        return await oOperation.execute(sGroupId, bIgnoreEtag, sGroupId ? operationsHelper.fnOnStrictHandlingFailed.bind(draft, sGroupId, {
          label: sActionName,
          model: oContext.getModel()
        }, oResourceBundle, null, null, null, undefined, undefined) : undefined, oContext.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"));
      } catch (e) {
        if (bHasPrepareAction) {
          const actionName = getActionName(oContext, draftOperations.PREPARE),
            oSideEffectsService = oAppComponent.getSideEffectsService(),
            oBindingParameters = oSideEffectsService.getODataActionSideEffects(actionName, oContext),
            aTargetPaths = oBindingParameters && oBindingParameters.pathExpressions;
          if (aTargetPaths && aTargetPaths.length > 0) {
            try {
              await oSideEffectsService.requestSideEffects(aTargetPaths, oContext);
            } catch (oError) {
              Log.error("Error while requesting side effects", oError);
            }
          } else {
            try {
              await requestMessages(oContext, oSideEffectsService);
            } catch (oError) {
              Log.error("Error while requesting messages", oError);
            }
          }
        }
        throw e;
      }
    } else {
      throw new Error("The activation action cannot be executed on an active document");
    }
  }

  /**
   * Gets the supported message property path on the PrepareAction for a context.
   *
   * @function
   * @param oContext Context to be checked
   * @returns Path to the message
   * @private
   * @ui5-restricted
   */
  function getMessagePathForPrepare(oContext) {
    const oMetaModel = oContext.getModel().getMetaModel();
    const sContextPath = oMetaModel.getMetaPath(oContext.getPath());
    const oReturnType = getReturnType(oContext, draftOperations.PREPARE);
    // If there is no return parameter, it is not possible to request Messages.
    // RAP draft prepare has no return parameter
    return !!oReturnType ? oMetaModel.getObject(`${sContextPath}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`) : null;
  }

  /**
   * Execute a preparation action.
   *
   * @function
   * @param oContext Context for which the action should be performed
   * @param groupId The optional batch group in which we want to execute the operation
   * @param bMessages If set to true, the PREPARE action retrieves SAP_Messages
   * @param ignoreETag If set to true, ETag information is ignored when the action is executed
   * @returns Resolve function returns the context of the operation
   * @private
   * @ui5-restricted
   */
  function executeDraftPreparationAction(oContext, groupId, bMessages, ignoreETag) {
    if (!oContext.getProperty("IsActiveEntity")) {
      const sMessagesPath = bMessages ? getMessagePathForPrepare(oContext) : null;
      const oOperation = createOperation(oContext, draftOperations.PREPARE, sMessagesPath ? {
        $select: sMessagesPath
      } : null);

      // TODO: side effects qualifier shall be even deprecated to be checked
      oOperation.setParameter("SideEffectsQualifier", "");
      const sGroupId = groupId || oOperation.getGroupId();
      return oOperation.execute(sGroupId, ignoreETag).then(function () {
        return oOperation;
      }).catch(function (oError) {
        Log.error("Error while executing the operation", oError);
      });
    } else {
      throw new Error("The preparation action cannot be executed on an active document");
    }
  }
  /**
   * Determines the message path for a context.
   *
   * @function
   * @param oContext Context for which the path shall be determined
   * @returns Message path, empty if not annotated
   * @private
   * @ui5-restricted
   */
  function getMessagesPath(oContext) {
    const oModel = oContext.getModel(),
      oMetaModel = oModel.getMetaModel(),
      sEntitySetPath = oMetaModel.getMetaPath(oContext.getPath());
    return oMetaModel.getObject(`${sEntitySetPath}/@com.sap.vocabularies.Common.v1.Messages/$Path`);
  }
  /**
   * Requests the messages if annotated for a given context.
   *
   * @function
   * @param oContext Context for which the messages shall be requested
   * @param oSideEffectsService Service for the SideEffects on SAP Fiori elements
   * @returns Promise which is resolved once messages were requested
   * @private
   * @ui5-restricted
   */
  function requestMessages(oContext, oSideEffectsService) {
    const sMessagesPath = draft.getMessagesPath(oContext);
    if (sMessagesPath) {
      return oSideEffectsService.requestSideEffects([{
        $PropertyPath: sMessagesPath
      }], oContext);
    }
    return Promise.resolve();
  }
  /**
   * Executes discard of a draft function using HTTP Post.
   *
   * @function
   * @param oContext Context for which the action should be performed
   * @param oAppComponent App Component
   * @param bEnableStrictHandling
   * @returns Resolve function returns the context of the operation
   * @private
   * @ui5-restricted
   */
  async function executeDraftDiscardAction(oContext, oAppComponent, bEnableStrictHandling) {
    if (!oContext.getProperty("IsActiveEntity")) {
      const oDiscardOperation = draft.createOperation(oContext, draftOperations.DISCARD);
      const oResourceBundle = oAppComponent && (await oAppComponent.getModel("sap.fe.i18n").getResourceBundle()) || null;
      const sGroupId = "direct";
      const sActionName = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_DRAFT_DISCARD_BUTTON", oResourceBundle);
      // as the discard action doesnt' send the active version in the response we do not use the replace in cache
      const oDiscardPromise = !bEnableStrictHandling ? oDiscardOperation.execute(sGroupId) : oDiscardOperation.execute(sGroupId, undefined, operationsHelper.fnOnStrictHandlingFailed.bind(draft, sGroupId, {
        label: sActionName,
        model: oContext.getModel()
      }, oResourceBundle, null, null, null, undefined, undefined), false);
      oContext.getModel().submitBatch(sGroupId);
      return oDiscardPromise;
    } else {
      throw new Error("The discard action cannot be executed on an active document");
    }
  }

  /**
   * This method creates a sibling context for a subobject page and calculates a sibling path for all intermediate paths
   * between the object page and the subobject page.
   *
   * @param rootCurrentContext The context for the root of the draft
   * @param rightmostCurrentContext The context of the subobject page
   * @returns The siblingInformation object
   */
  async function computeSiblingInformation(rootCurrentContext, rightmostCurrentContext) {
    if (!rightmostCurrentContext.getPath().startsWith(rootCurrentContext.getPath())) {
      // Wrong usage !!
      Log.error("Cannot compute rightmost sibling context");
      throw new Error("Cannot compute rightmost sibling context");
    }
    const model = rootCurrentContext.getModel();
    try {
      // //////////////////////////////////////////////////////////////////
      // 1. Find all segments between the root object and the sub-object
      // Example: for root = /Param(aa)/Entity(bb) and rightMost = /Param(aa)/Entity(bb)/_Nav(cc)/_SubNav(dd)
      // ---> ["Param(aa)/Entity(bb)", "_Nav(cc)", "_SubNav(dd)"]

      // Find all segments in the rightmost path
      const additionalPath = rightmostCurrentContext.getPath().replace(rootCurrentContext.getPath(), "");
      const segments = additionalPath ? additionalPath.substring(1).split("/") : [];
      // First segment is always the full path of the root object, which can contain '/' in case of a parametrized entity
      segments.unshift(rootCurrentContext.getPath().substring(1));

      // //////////////////////////////////////////////////////////////////
      // 2. Request canonical paths of the sibling entity for each segment
      // Example: for ["Param(aa)/Entity(bb)", "_Nav(cc)", "_SubNav(dd)"]
      // --> request canonical paths for "Param(aa)/Entity(bb)/SiblingEntity", "Param(aa)/Entity(bb)/_Nav(cc)/SiblingEntity", "Param(aa)/Entity(bb)/_Nav(cc)/_SubNav(dd)/SiblingEntity"
      const oldPaths = [];
      const newPaths = [];
      let currentPath = "";
      const canonicalPathPromises = segments.map(segment => {
        currentPath += `/${segment}`;
        oldPaths.unshift(currentPath);
        if (currentPath.endsWith(")")) {
          const siblingContext = model.bindContext(`${currentPath}/SiblingEntity`).getBoundContext();
          return siblingContext.requestCanonicalPath();
        } else {
          return Promise.resolve(undefined); // 1-1 relation
        }
      });

      // //////////////////////////////////////////////////////////////////
      // 3. Reconstruct the full paths from canonical paths (for path mapping)
      // Example: for canonical paths "/Param(aa)/Entity(bb-sibling)", "/Entity2(cc-sibling)", "/Entity3(dd-sibling)"
      // --> ["Param(aa)/Entity(bb-sibling)", "Param(aa)/Entity(bb-sibling)/_Nav(cc-sibling)", "Param(aa)/Entity(bb-sibling)/_Nav(cc-sibling)/_SubNav(dd-sibling)"]
      const canonicalPaths = await Promise.all(canonicalPathPromises);
      let siblingPath = "";
      canonicalPaths.forEach((canonicalPath, index) => {
        if (index !== 0) {
          if (segments[index].endsWith(")")) {
            const navigation = segments[index].replace(/\(.*$/, ""); // Keep only navigation name from the segment, i.e. aaa(xxx) --> aaa
            const keys = canonicalPath.replace(/.*\(/, "("); // Keep only the keys from the canonical path, i.e. aaa(xxx) --> (xxx)
            siblingPath += `/${navigation}${keys}`;
          } else {
            siblingPath += `/${segments[index]}`; // 1-1 relation
          }
        } else {
          siblingPath = canonicalPath; // To manage parametrized entities
        }

        newPaths.unshift(siblingPath);
      });
      return {
        targetContext: model.bindContext(siblingPath).getBoundContext(),
        // Create the rightmost sibling context from its path
        pathMapping: oldPaths.map((oldPath, index) => {
          return {
            oldPath,
            newPath: newPaths[index]
          };
        })
      };
    } catch (error) {
      // A canonical path couldn't be resolved (because a sibling doesn't exist)
      return undefined;
    }
  }

  /**
   * Creates a draft document from an existing document.
   *
   * The function supports several hooks as there is a certain coreography defined.
   *
   * @function
   * @name sap.fe.core.actions.draft#createDraftFromActiveDocument
   * @memberof sap.fe.core.actions.draft
   * @static
   * @param oContext Context of the active document for the new draft
   * @param oAppComponent The AppComponent
   * @param mParameters The parameters
   * @param [mParameters.oView] The view
   * @param [mParameters.bPreserveChanges] Preserve changes of an existing draft of another user
   * @returns Promise resolves with the {@link sap.ui.model.odata.v4.Context context} of the new draft document
   * @private
   * @ui5-restricted
   */
  async function createDraftFromActiveDocument(oContext, oAppComponent, mParameters) {
    const mParam = mParameters || {},
      bRunPreserveChangesFlow = typeof mParam.bPreserveChanges === "undefined" || typeof mParam.bPreserveChanges === "boolean" && mParam.bPreserveChanges; //default true

    /**
     * Overwrite the existing change.
     *
     * @returns Resolves with result of {@link sap.fe.core.actions#executeDraftEditAction}
     */
    async function overwriteChange() {
      //Overwrite existing changes
      const oModel = oContext.getModel();
      const draftDataContext = oModel.bindContext(`${oContext.getPath()}/DraftAdministrativeData`).getBoundContext();
      const oResourceBundle = await mParameters.oView.getModel("sap.fe.i18n").getResourceBundle();
      const draftAdminData = await draftDataContext.requestObject();
      if (draftAdminData) {
        // remove all unbound transition messages as we show a special dialog
        messageHandling.removeUnboundTransitionMessages();
        let sInfo = draftAdminData.InProcessByUserDescription || draftAdminData.InProcessByUser;
        const sEntitySet = mParameters.oView.getViewData().entitySet;
        if (sInfo) {
          const sLockedByUserMsg = CommonUtils.getTranslatedText("C_DRAFT_OBJECT_PAGE_DRAFT_LOCKED_BY_USER", oResourceBundle, sInfo, sEntitySet);
          MessageBox.error(sLockedByUserMsg);
          throw new Error(sLockedByUserMsg);
        } else {
          sInfo = draftAdminData.CreatedByUserDescription || draftAdminData.CreatedByUser;
          const sUnsavedChangesMsg = CommonUtils.getTranslatedText("C_DRAFT_OBJECT_PAGE_DRAFT_UNSAVED_CHANGES", oResourceBundle, sInfo, sEntitySet);
          await draft.showEditConfirmationMessageBox(sUnsavedChangesMsg, oContext);
          return draft.executeDraftEditAction(oContext, false, mParameters.oView);
        }
      }
      throw new Error(`Draft creation aborted for document: ${oContext.getPath()}`);
    }
    if (!oContext) {
      throw new Error("Binding context to active document is required");
    }
    try {
      let oDraftContext;
      try {
        oDraftContext = await draft.executeDraftEditAction(oContext, bRunPreserveChangesFlow, mParameters.oView);
      } catch (oResponse) {
        if (oResponse.status === 409 || oResponse.status === 412 || oResponse.status === 423) {
          messageHandling.removeBoundTransitionMessages();
          messageHandling.removeUnboundTransitionMessages();
          const siblingInfo = await draft.computeSiblingInformation(oContext, oContext);
          if (siblingInfo !== null && siblingInfo !== void 0 && siblingInfo.targetContext) {
            //there is a context authorized to be edited by the current user
            await CommonUtils.waitForContextRequested(siblingInfo.targetContext);
            return siblingInfo.targetContext;
          } else {
            //there is no draft owned by the current user
            oDraftContext = await overwriteChange();
          }
        } else if (!(oResponse && oResponse.canceled)) {
          throw new Error(oResponse);
        }
      }
      if (oDraftContext) {
        var _oSideEffects$trigger;
        const sEditActionName = draft.getActionName(oDraftContext, draftOperations.EDIT);
        const oSideEffects = oAppComponent.getSideEffectsService().getODataActionSideEffects(sEditActionName, oDraftContext);
        if (oSideEffects !== null && oSideEffects !== void 0 && (_oSideEffects$trigger = oSideEffects.triggerActions) !== null && _oSideEffects$trigger !== void 0 && _oSideEffects$trigger.length) {
          await oAppComponent.getSideEffectsService().requestSideEffectsForODataAction(oSideEffects, oDraftContext);
          return oDraftContext;
        } else {
          return oDraftContext;
        }
      } else {
        return undefined;
      }
    } catch (exc) {
      throw exc;
    }
  }
  /**
   * Creates an active document from a draft document.
   *
   * The function supports several hooks as there is a certain choreography defined.
   *
   * @function
   * @name sap.fe.core.actions.draft#activateDocument
   * @memberof sap.fe.core.actions.draft
   * @static
   * @param oContext Context of the active document for the new draft
   * @param oAppComponent The AppComponent
   * @param mParameters The parameters
   * @param [mParameters.fnBeforeActivateDocument] Callback that allows a veto before the 'Create' request is executed
   * @param [mParameters.fnAfterActivateDocument] Callback for postprocessing after document was activated.
   * @param messageHandler The message handler
   * @returns Promise resolves with the {@link sap.ui.model.odata.v4.Context context} of the new draft document
   * @private
   * @ui5-restricted
   */
  async function activateDocument(oContext, oAppComponent, mParameters, messageHandler) {
    const mParam = mParameters || {};
    if (!oContext) {
      throw new Error("Binding context to draft document is required");
    }
    const bExecute = mParam.fnBeforeActivateDocument ? await mParam.fnBeforeActivateDocument(oContext) : true;
    if (!bExecute) {
      throw new Error(`Activation of the document was aborted by extension for document: ${oContext.getPath()}`);
    }
    let oActiveDocumentContext;
    if (!hasPrepareAction(oContext)) {
      oActiveDocumentContext = await executeDraftActivationAction(oContext, oAppComponent);
    } else {
      /* activation requires preparation */
      const sBatchGroup = "draft";
      // we use the same batchGroup to force prepare and activate in a same batch but with different changeset
      let oPreparePromise = draft.executeDraftPreparationAction(oContext, sBatchGroup, false);
      oContext.getModel().submitBatch(sBatchGroup);
      const oActivatePromise = draft.executeDraftActivationAction(oContext, oAppComponent, sBatchGroup);
      try {
        const values = await Promise.all([oPreparePromise, oActivatePromise]);
        oActiveDocumentContext = values[1];
      } catch (err) {
        // BCP 2270084075
        // if the Activation fails, then the messages are retrieved from PREPARATION action
        const sMessagesPath = getMessagePathForPrepare(oContext);
        if (sMessagesPath) {
          oPreparePromise = draft.executeDraftPreparationAction(oContext, sBatchGroup, true);
          oContext.getModel().submitBatch(sBatchGroup);
          await oPreparePromise;
          const data = await oContext.requestObject();
          if (data[sMessagesPath].length > 0) {
            //if messages are available from the PREPARATION action, then previous transition messages are removed
            messageHandler === null || messageHandler === void 0 ? void 0 : messageHandler.removeTransitionMessages(false, false, oContext.getPath());
          }
        }
        throw err;
      }
    }
    return mParam.fnAfterActivateDocument ? mParam.fnAfterActivateDocument(oContext, oActiveDocumentContext) : oActiveDocumentContext;
  }

  /**
   * Display the confirmation dialog box after pressing the edit button of an object page with unsaved changes.
   *
   *
   * @function
   * @name sap.fe.core.actions.draft#showEditConfirmationMessageBox
   * @memberof sap.fe.core.actions.draft
   * @static
   * @param sUnsavedChangesMsg Dialog box message informing the user that if he starts editing, the previous unsaved changes will be lost
   * @param oContext Context of the active document for the new draft
   * @returns Promise resolves
   * @private
   * @ui5-restricted
   */
  function showEditConfirmationMessageBox(sUnsavedChangesMsg, oContext) {
    const localI18nRef = Core.getLibraryResourceBundle("sap.fe.core");
    return new Promise(function (resolve, reject) {
      const oDialog = new Dialog({
        title: localI18nRef.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_WARNING"),
        state: "Warning",
        content: new Text({
          text: sUnsavedChangesMsg
        }),
        beginButton: new Button({
          text: localI18nRef.getText("C_COMMON_OBJECT_PAGE_EDIT"),
          type: "Emphasized",
          press: function () {
            oDialog.close();
            resolve(true);
          }
        }),
        endButton: new Button({
          text: localI18nRef.getText("C_COMMON_OBJECT_PAGE_CANCEL"),
          press: function () {
            oDialog.close();
            reject(`Draft creation aborted for document: ${oContext.getPath()}`);
          }
        }),
        afterClose: function () {
          oDialog.destroy();
        }
      });
      oDialog.addStyleClass("sapUiContentPadding");
      oDialog.open();
    });
  }

  /**
   * HTTP POST call when DraftAction is present for Draft Delete; HTTP DELETE call when there is no DraftAction
   * and Active Instance always uses DELETE.
   *
   * @function
   * @name sap.fe.core.actions.draft#deleteDraft
   * @memberof sap.fe.core.actions.draft
   * @static
   * @param oContext Context of the document to be discarded
   * @param oAppComponent Context of the document to be discarded
   * @param bEnableStrictHandling
   * @private
   * @returns A Promise resolved when the context is deleted
   * @ui5-restricted
   */
  function deleteDraft(oContext, oAppComponent, bEnableStrictHandling) {
    const sDiscardAction = getActionName(oContext, draftOperations.DISCARD),
      bIsActiveEntity = oContext.getObject().IsActiveEntity;
    if (bIsActiveEntity || !bIsActiveEntity && !sDiscardAction) {
      //Use Delete in case of active entity and no discard action available for draft
      if (oContext.hasPendingChanges()) {
        return oContext.getBinding().resetChanges().then(function () {
          return oContext.delete();
        }).catch(function (error) {
          return Promise.reject(error);
        });
      } else {
        return oContext.delete();
      }
    } else {
      //Use Discard Post Action if it is a draft entity and discard action exists
      return executeDraftDiscardAction(oContext, oAppComponent, bEnableStrictHandling);
    }
  }
  const draft = {
    createDraftFromActiveDocument: createDraftFromActiveDocument,
    activateDocument: activateDocument,
    deleteDraft: deleteDraft,
    executeDraftEditAction: executeDraftEditAction,
    executeDraftValidation: executeDraftValidation,
    executeDraftPreparationAction: executeDraftPreparationAction,
    executeDraftActivationAction: executeDraftActivationAction,
    hasPrepareAction: hasPrepareAction,
    getMessagesPath: getMessagesPath,
    computeSiblingInformation: computeSiblingInformation,
    processDataLossOrDraftDiscardConfirmation: draftDataLossPopup.processDataLossOrDraftDiscardConfirmation,
    silentlyKeepDraftOnForwardNavigation: draftDataLossPopup.silentlyKeepDraftOnForwardNavigation,
    createOperation: createOperation,
    executeDraftDiscardAction: executeDraftDiscardAction,
    NavigationType: draftDataLossPopup.NavigationType,
    getActionName: getActionName,
    showEditConfirmationMessageBox: showEditConfirmationMessageBox
  };
  return draft;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/draft", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/messageHandler/messageHandling","sap/m/Button","sap/m/Dialog","sap/m/MessageBox","sap/m/Text","sap/ui/core/Core","../../operationsHelper","./draftDataLossPopup"],function(e,t,n,o,r,a,i,s,c,u){"use strict";const d={EDIT:"EditAction",ACTIVATION:"ActivationAction",DISCARD:"DiscardAction",PREPARE:"PreparationAction"};function l(e,t){const n=e.getModel(),o=n.getMetaModel(),r=o.getMetaPath(e.getPath());return o.getObject(`${r}@com.sap.vocabularies.Common.v1.DraftRoot/${t}`)}function f(e,t,n){const o=l(e,t);return e.getModel().bindContext(`${o}(...)`,e,n)}function g(e,t){const n=e.getModel(),o=n.getMetaModel(),r=o.getMetaPath(e.getPath());return o.getObject(`${r}@com.sap.vocabularies.Common.v1.DraftRoot/${t}/$ReturnType`)}function h(e){return!!l(e,d.PREPARE)}async function E(e,n,o){if(e.getProperty("IsActiveEntity")){const r={$$inheritExpandSelect:true};const a=f(e,d.EDIT,r);a.setParameter("PreserveChanges",n);const i="direct";const s=await o.getModel("sap.fe.i18n").getResourceBundle();const u=t.getTranslatedText("C_COMMON_OBJECT_PAGE_EDIT",s);const l=a.execute(i,undefined,c.fnOnStrictHandlingFailed.bind(y,i,{label:u,model:e.getModel()},s,null,null,null,undefined,undefined),e.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"));a.getModel().submitBatch(i);return await l}else{throw new Error("You cannot edit this draft document")}}async function m(t,n,o){if(y.getMessagesPath(t)&&y.hasPrepareAction(t)){try{const e=await y.executeDraftPreparationAction(t,t.getUpdateGroupId(),true,o);if(e&&!g(t,d.PREPARE)){D(t,n.getSideEffectsService())}return e}catch(t){e.error("Error while requesting messages",t)}}return undefined}async function p(n,o,r){const a=h(n);const i=a;if(!n.getProperty("IsActiveEntity")){const s=f(n,d.ACTIVATION,{$$inheritExpandSelect:true});const u=await o.getModel("sap.fe.i18n").getResourceBundle();const g=t.getTranslatedText("C_OP_OBJECT_PAGE_SAVE",u);try{return await s.execute(r,i,r?c.fnOnStrictHandlingFailed.bind(y,r,{label:g,model:n.getModel()},u,null,null,null,undefined,undefined):undefined,n.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"))}catch(t){if(a){const t=l(n,d.PREPARE),r=o.getSideEffectsService(),a=r.getODataActionSideEffects(t,n),i=a&&a.pathExpressions;if(i&&i.length>0){try{await r.requestSideEffects(i,n)}catch(t){e.error("Error while requesting side effects",t)}}else{try{await D(n,r)}catch(t){e.error("Error while requesting messages",t)}}}throw t}}else{throw new Error("The activation action cannot be executed on an active document")}}function A(e){const t=e.getModel().getMetaModel();const n=t.getMetaPath(e.getPath());const o=g(e,d.PREPARE);return!!o?t.getObject(`${n}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`):null}function P(t,n,o,r){if(!t.getProperty("IsActiveEntity")){const a=o?A(t):null;const i=f(t,d.PREPARE,a?{$select:a}:null);i.setParameter("SideEffectsQualifier","");const s=n||i.getGroupId();return i.execute(s,r).then(function(){return i}).catch(function(t){e.error("Error while executing the operation",t)})}else{throw new Error("The preparation action cannot be executed on an active document")}}function w(e){const t=e.getModel(),n=t.getMetaModel(),o=n.getMetaPath(e.getPath());return n.getObject(`${o}/@com.sap.vocabularies.Common.v1.Messages/$Path`)}function D(e,t){const n=y.getMessagesPath(e);if(n){return t.requestSideEffects([{$PropertyPath:n}],e)}return Promise.resolve()}async function C(e,n,o){if(!e.getProperty("IsActiveEntity")){const r=y.createOperation(e,d.DISCARD);const a=n&&await n.getModel("sap.fe.i18n").getResourceBundle()||null;const i="direct";const s=t.getTranslatedText("C_TRANSACTION_HELPER_DRAFT_DISCARD_BUTTON",a);const u=!o?r.execute(i):r.execute(i,undefined,c.fnOnStrictHandlingFailed.bind(y,i,{label:s,model:e.getModel()},a,null,null,null,undefined,undefined),false);e.getModel().submitBatch(i);return u}else{throw new Error("The discard action cannot be executed on an active document")}}async function x(t,n){if(!n.getPath().startsWith(t.getPath())){e.error("Cannot compute rightmost sibling context");throw new Error("Cannot compute rightmost sibling context")}const o=t.getModel();try{const e=n.getPath().replace(t.getPath(),"");const r=e?e.substring(1).split("/"):[];r.unshift(t.getPath().substring(1));const a=[];const i=[];let s="";const c=r.map(e=>{s+=`/${e}`;a.unshift(s);if(s.endsWith(")")){const e=o.bindContext(`${s}/SiblingEntity`).getBoundContext();return e.requestCanonicalPath()}else{return Promise.resolve(undefined)}});const u=await Promise.all(c);let d="";u.forEach((e,t)=>{if(t!==0){if(r[t].endsWith(")")){const n=r[t].replace(/\(.*$/,"");const o=e.replace(/.*\(/,"(");d+=`/${n}${o}`}else{d+=`/${r[t]}`}}else{d=e}i.unshift(d)});return{targetContext:o.bindContext(d).getBoundContext(),pathMapping:a.map((e,t)=>({oldPath:e,newPath:i[t]}))}}catch(e){return undefined}}async function v(e,o,r){const i=r||{},s=typeof i.bPreserveChanges==="undefined"||typeof i.bPreserveChanges==="boolean"&&i.bPreserveChanges;async function c(){const o=e.getModel();const i=o.bindContext(`${e.getPath()}/DraftAdministrativeData`).getBoundContext();const s=await r.oView.getModel("sap.fe.i18n").getResourceBundle();const c=await i.requestObject();if(c){n.removeUnboundTransitionMessages();let o=c.InProcessByUserDescription||c.InProcessByUser;const i=r.oView.getViewData().entitySet;if(o){const e=t.getTranslatedText("C_DRAFT_OBJECT_PAGE_DRAFT_LOCKED_BY_USER",s,o,i);a.error(e);throw new Error(e)}else{o=c.CreatedByUserDescription||c.CreatedByUser;const n=t.getTranslatedText("C_DRAFT_OBJECT_PAGE_DRAFT_UNSAVED_CHANGES",s,o,i);await y.showEditConfirmationMessageBox(n,e);return y.executeDraftEditAction(e,false,r.oView)}}throw new Error(`Draft creation aborted for document: ${e.getPath()}`)}if(!e){throw new Error("Binding context to active document is required")}try{let a;try{a=await y.executeDraftEditAction(e,s,r.oView)}catch(o){if(o.status===409||o.status===412||o.status===423){n.removeBoundTransitionMessages();n.removeUnboundTransitionMessages();const o=await y.computeSiblingInformation(e,e);if(o!==null&&o!==void 0&&o.targetContext){await t.waitForContextRequested(o.targetContext);return o.targetContext}else{a=await c()}}else if(!(o&&o.canceled)){throw new Error(o)}}if(a){var u;const e=y.getActionName(a,d.EDIT);const t=o.getSideEffectsService().getODataActionSideEffects(e,a);if(t!==null&&t!==void 0&&(u=t.triggerActions)!==null&&u!==void 0&&u.length){await o.getSideEffectsService().requestSideEffectsForODataAction(t,a);return a}else{return a}}else{return undefined}}catch(e){throw e}}async function M(e,t,n,o){const r=n||{};if(!e){throw new Error("Binding context to draft document is required")}const a=r.fnBeforeActivateDocument?await r.fnBeforeActivateDocument(e):true;if(!a){throw new Error(`Activation of the document was aborted by extension for document: ${e.getPath()}`)}let i;if(!h(e)){i=await p(e,t)}else{const n="draft";let r=y.executeDraftPreparationAction(e,n,false);e.getModel().submitBatch(n);const a=y.executeDraftActivationAction(e,t,n);try{const e=await Promise.all([r,a]);i=e[1]}catch(t){const a=A(e);if(a){r=y.executeDraftPreparationAction(e,n,true);e.getModel().submitBatch(n);await r;const t=await e.requestObject();if(t[a].length>0){o===null||o===void 0?void 0:o.removeTransitionMessages(false,false,e.getPath())}}throw t}}return r.fnAfterActivateDocument?r.fnAfterActivateDocument(e,i):i}function T(e,t){const n=s.getLibraryResourceBundle("sap.fe.core");return new Promise(function(a,s){const c=new r({title:n.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_WARNING"),state:"Warning",content:new i({text:e}),beginButton:new o({text:n.getText("C_COMMON_OBJECT_PAGE_EDIT"),type:"Emphasized",press:function(){c.close();a(true)}}),endButton:new o({text:n.getText("C_COMMON_OBJECT_PAGE_CANCEL"),press:function(){c.close();s(`Draft creation aborted for document: ${t.getPath()}`)}}),afterClose:function(){c.destroy()}});c.addStyleClass("sapUiContentPadding");c.open()})}function b(e,t,n){const o=l(e,d.DISCARD),r=e.getObject().IsActiveEntity;if(r||!r&&!o){if(e.hasPendingChanges()){return e.getBinding().resetChanges().then(function(){return e.delete()}).catch(function(e){return Promise.reject(e)})}else{return e.delete()}}else{return C(e,t,n)}}const y={createDraftFromActiveDocument:v,activateDocument:M,deleteDraft:b,executeDraftEditAction:E,executeDraftValidation:m,executeDraftPreparationAction:P,executeDraftActivationAction:p,hasPrepareAction:h,getMessagesPath:w,computeSiblingInformation:x,processDataLossOrDraftDiscardConfirmation:u.processDataLossOrDraftDiscardConfirmation,silentlyKeepDraftOnForwardNavigation:u.silentlyKeepDraftOnForwardNavigation,createOperation:f,executeDraftDiscardAction:C,NavigationType:u.NavigationType,getActionName:l,showEditConfirmationMessageBox:T};return y},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/draftDataLossPopup-dbg", ["sap/base/Log", "sap/fe/core/controllerextensions/collaboration/ActivitySync", "sap/fe/core/controls/DataLossOrDraftDiscard/DataLossOrDraftDiscardHandler", "sap/fe/core/helpers/EditState"], function (Log, ActivitySync, DataLossOrDraftDiscardHandler, EditState) {
  "use strict";

  /* Enum for navigation types */
  var NavigationType;
  /**
   * The method checks whether an optional parameter in the manifest is set to silently keep the draft in case a forward navigation is triggered.
   *
   * @param pageController The reference to the current PageController instance
   * @returns Boolean value with true or false to silently keep the draft
   */
  (function (NavigationType) {
    NavigationType["BackNavigation"] = "BackNavigation";
    NavigationType["ForwardNavigation"] = "ForwardNavigation";
  })(NavigationType || (NavigationType = {}));
  function silentlyKeepDraftOnForwardNavigation(pageController) {
    var _oManifest$sapFe, _oManifest$sapFe$app;
    let rbSilentlyKeep = false;
    const oManifest = pageController.getAppComponent().getManifest();
    rbSilentlyKeep = (oManifest === null || oManifest === void 0 ? void 0 : (_oManifest$sapFe = oManifest["sap.fe"]) === null || _oManifest$sapFe === void 0 ? void 0 : (_oManifest$sapFe$app = _oManifest$sapFe.app) === null || _oManifest$sapFe$app === void 0 ? void 0 : _oManifest$sapFe$app.silentlyKeepDraftOnForwardNavigation) || false;
    return rbSilentlyKeep;
  }

  /**
   * Logic to process the fcl mode.
   *
   * @param draftAdminData Admin data
   * @param fnCancelFunction The cancel function
   * @param oController The current controller referenced
   * @param processFunctionForDrafts The functon to process the handler
   * @param bSkipBindingToView The optional parameter to skip the binding to the view
   */
  async function processFclMode(draftAdminData, fnCancelFunction, oController, processFunctionForDrafts, bSkipBindingToView) {
    // The application is running in FCL mode so in this case we fall back to
    // the old logic since the dirty state handling is not properly working
    // for FCL.
    if (draftAdminData.CreationDateTime !== draftAdminData.LastChangeDateTime) {
      DataLossOrDraftDiscardHandler.performAfterDiscardorKeepDraft(processFunctionForDrafts, fnCancelFunction, oController, bSkipBindingToView);
    } else {
      processFunctionForDrafts();
    }
  }

  /**
   * Logic to process the mode with no active entity.
   *
   * @param draftAdminData Admin data
   * @param fnCancelFunction The cancel function
   * @param oController The current controller referenced
   * @param processFunctionForDrafts The functon to process the handler
   * @param navigationType The navigation type for which the function should be called
   * @param bSilentlyKeepDraftOnForwardNavigation The parameter to determine whether to skip the popup appearance in forward case
   * @param bSkipBindingToView The optional parameter to skip the binding to the view
   */
  async function processNoActiveEntityMode(draftAdminData, fnCancelFunction, oController, processFunctionForDrafts, navigationType, bSilentlyKeepDraftOnForwardNavigation, bSkipBindingToView) {
    // There is no active entity so we are editing either newly created data or
    // a draft which has never been saved to active version
    // Since we want to react differently in the two situations, we have to check the
    // dirty state
    if (EditState.isEditStateDirty()) {
      if (draftAdminData.CreationDateTime === draftAdminData.LastChangeDateTime && navigationType === NavigationType.BackNavigation) {
        // in case we have untouched changes for the draft and a "back"
        // navigation we can silently discard the draft again
        // eslint-disable-next-line promise/no-nesting
        try {
          await DataLossOrDraftDiscardHandler.discardDraft(oController, bSkipBindingToView);
          processFunctionForDrafts();
        } catch (error) {
          Log.error("Error while canceling the document", error);
        }
      } else if (navigationType === NavigationType.ForwardNavigation && bSilentlyKeepDraftOnForwardNavigation) {
        // In case we have a "forward navigation" and an additional parameter set in the manifest
        // we "silently" keep the draft
        processFunctionForDrafts();
      } else {
        // In this case data is being changed or a forward navigation is triggered
        // and we always want to show the dataloss dialog on navigation
        DataLossOrDraftDiscardHandler.performAfterDiscardorKeepDraft(processFunctionForDrafts, fnCancelFunction, oController, bSkipBindingToView);
      }
    } else {
      // We are editing a draft which has been created earlier but never saved to active
      // version and since the edit state is not dirty, there have been no user changes
      // so in this case we want to silently navigate and do nothing
      processFunctionForDrafts();
    }
  }
  /**
   * Logic to process the draft editing for existing entity.
   *
   * @param oController The current controller referenced.
   * @param oContext The context of the current call
   * @param processFunctionForDrafts The functon to process the handler
   * @param navigationType The navigation type for which the function should be called
   */
  async function processEditingDraftForExistingEntity(oController, oContext, processFunctionForDrafts, navigationType) {
    // We are editing a draft for an existing active entity
    // The CreationDateTime and LastChangeDateTime are equal, so this draft was
    // never saved before, hence we're currently editing a newly created draft for
    // an existing active entity for the first time.
    // Also there have so far been no changes made to the draft and in this
    // case we want to silently navigate and delete the draftin case of a back
    // navigation but in case of a forward navigation we want to silently keep it!
    if (navigationType === NavigationType.BackNavigation) {
      const mParameters = {
        skipDiscardPopover: true
      };
      try {
        await oController.editFlow.cancelDocument(oContext, mParameters);
        processFunctionForDrafts();
      } catch (error) {
        Log.error("Error while canceling the document", error);
      }
    } else {
      // In case of a forward navigation we silently keep the draft and only
      // execute the followup function.
      processFunctionForDrafts();
    }
  }

  /**
   * Logic to process the edit state dirty.
   *
   * @param oController The current controller referenced.
   * @param fnCancelFunction The cancel function
   * @param processFunctionForDrafts The functon to process the handler
   * @param navigationType The navigation type for which the function should be called
   * @param bSilentlyKeepDraftOnForwardNavigation The parameter to determine whether to skip the popup appearance in forward case
   * @param bSkipBindingToView The optional parameter to skip the binding to the view.
   */
  async function processEditStateDirty(oController, fnCancelFunction, processFunctionForDrafts, navigationType, bSilentlyKeepDraftOnForwardNavigation, bSkipBindingToView) {
    if (navigationType === NavigationType.ForwardNavigation && bSilentlyKeepDraftOnForwardNavigation) {
      // In case we have a "forward navigation" and an additional parameter set in the manifest
      // we "silently" keep the draft
      processFunctionForDrafts();
    } else {
      // The CreationDateTime and LastChangeDateTime are NOT equal, so we are currently editing
      // an existing draft and need to distinguish depending on if any changes
      // have been made in the current editing session or not
      // Changes have been made in the current editing session so we want
      // to show the dataloss dialog and let the user decide
      DataLossOrDraftDiscardHandler.performAfterDiscardorKeepDraft(processFunctionForDrafts, fnCancelFunction, oController, bSkipBindingToView);
    }
  }

  /**
   * Logic to process the admin data.
   *
   * @param draftAdminData Admin data
   * @param fnProcessFunction The functon to process the handler
   * @param fnCancelFunction The cancel function
   * @param oContext The context of the current call
   * @param oController The current controller referenced
   * @param bSkipBindingToView The optional parameter to skip the binding to the view
   * @param navigationType The navigation type for which the function should be called
   */
  async function processDraftAdminData(draftAdminData, fnProcessFunction, fnCancelFunction, oContext, oController, bSkipBindingToView) {
    let navigationType = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : NavigationType.BackNavigation;
    const collaborationConnected = ActivitySync.isConnected(oController.getView());
    const processFunctionForDrafts = !collaborationConnected ? fnProcessFunction : function () {
      ActivitySync.disconnect(oController.getView());
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      fnProcessFunction.apply(null, ...args);
    };
    const bSilentlyKeepDraftOnForwardNavigation = silentlyKeepDraftOnForwardNavigation(oController);
    if (draftAdminData) {
      if (oController.getAppComponent().getRootViewController().isFclEnabled()) {
        await processFclMode(draftAdminData, fnCancelFunction, oController, processFunctionForDrafts, bSkipBindingToView);
      } else if (!oContext.getObject().HasActiveEntity) {
        processNoActiveEntityMode(draftAdminData, fnCancelFunction, oController, processFunctionForDrafts, navigationType, bSilentlyKeepDraftOnForwardNavigation, bSkipBindingToView);
      } else if (draftAdminData.CreationDateTime === draftAdminData.LastChangeDateTime) {
        processEditingDraftForExistingEntity(oController, oContext, processFunctionForDrafts, navigationType);
      } else if (EditState.isEditStateDirty()) {
        processEditStateDirty(oController, fnCancelFunction, processFunctionForDrafts, navigationType, bSilentlyKeepDraftOnForwardNavigation, bSkipBindingToView);
      } else {
        // The user started editing the existing draft but did not make any changes
        // in the current editing session, so in this case we do not want
        // to show the dataloss dialog but just keep the draft
        processFunctionForDrafts();
      }
    } else {
      fnProcessFunction();
    }
  }

  /**
   * The general handler in which the individual steps are called.
   *
   * @param fnProcessFunction
   * @param fnCancelFunction
   * @param oContext
   * @param oController
   * @param bSkipBindingToView
   * @param navigationType
   */
  async function processDataLossOrDraftDiscardConfirmation(fnProcessFunction, fnCancelFunction, oContext, oController, bSkipBindingToView) {
    let navigationType = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : NavigationType.BackNavigation;
    const oView = oController.getView();
    const oModel = oContext.getModel();
    const oMetaModel = oModel.getMetaModel();
    const sEntitySet = oView.getViewData().entitySet ?? "";
    const oDraftRoot = sEntitySet && oMetaModel.getObject("/" + sEntitySet + "@com.sap.vocabularies.Common.v1.DraftRoot");
    const oUIModel = oView.getModel("ui");
    const bIsEditable = oUIModel.getProperty("/isEditable");
    const draftDataContext = oModel.bindContext(`${oContext.getPath()}/DraftAdministrativeData`).getBoundContext();

    // Shouldn't display data loss popover on shell back navigation from sub-object pages
    // and when object page is in display mode
    if (oContext && oContext.getObject() && (!oDraftRoot && navigationType === NavigationType.BackNavigation || !bIsEditable)) {
      fnProcessFunction();
    } else {
      try {
        const draftAdminData = await draftDataContext.requestObject();
        await processDraftAdminData(draftAdminData, fnProcessFunction, fnCancelFunction, oContext, oController, bSkipBindingToView, navigationType);
      } catch (oError) {
        Log.error("Cannot retrieve draftDataContext information", oError);
      }
    }
  }
  const draftDataLossPopup = {
    processDataLossOrDraftDiscardConfirmation: processDataLossOrDraftDiscardConfirmation,
    silentlyKeepDraftOnForwardNavigation: silentlyKeepDraftOnForwardNavigation,
    NavigationType: NavigationType,
    processFclMode: processFclMode,
    processNoActiveEntityMode: processNoActiveEntityMode,
    processEditingDraftForExistingEntity: processEditingDraftForExistingEntity,
    processEditStateDirty: processEditStateDirty
  };
  return draftDataLossPopup;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/draftDataLossPopup", ["sap/base/Log","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/fe/core/controls/DataLossOrDraftDiscard/DataLossOrDraftDiscardHandler","sap/fe/core/helpers/EditState"],function(t,e,a,i){"use strict";var n;(function(t){t["BackNavigation"]="BackNavigation";t["ForwardNavigation"]="ForwardNavigation"})(n||(n={}));function o(t){var e,a;let i=false;const n=t.getAppComponent().getManifest();i=(n===null||n===void 0?void 0:(e=n["sap.fe"])===null||e===void 0?void 0:(a=e.app)===null||a===void 0?void 0:a.silentlyKeepDraftOnForwardNavigation)||false;return i}async function r(t,e,i,n,o){if(t.CreationDateTime!==t.LastChangeDateTime){a.performAfterDiscardorKeepDraft(n,e,i,o)}else{n()}}async function s(e,o,r,s,c,l,f){if(i.isEditStateDirty()){if(e.CreationDateTime===e.LastChangeDateTime&&c===n.BackNavigation){try{await a.discardDraft(r,f);s()}catch(e){t.error("Error while canceling the document",e)}}else if(c===n.ForwardNavigation&&l){s()}else{a.performAfterDiscardorKeepDraft(s,o,r,f)}}else{s()}}async function c(e,a,i,o){if(o===n.BackNavigation){const n={skipDiscardPopover:true};try{await e.editFlow.cancelDocument(a,n);i()}catch(e){t.error("Error while canceling the document",e)}}else{i()}}async function l(t,e,i,o,r,s){if(o===n.ForwardNavigation&&r){i()}else{a.performAfterDiscardorKeepDraft(i,e,t,s)}}async function f(t,a,f,d,g,p){let D=arguments.length>6&&arguments[6]!==undefined?arguments[6]:n.BackNavigation;const v=e.isConnected(g.getView());const u=!v?a:function(){e.disconnect(g.getView());for(var t=arguments.length,i=new Array(t),n=0;n<t;n++){i[n]=arguments[n]}a.apply(null,...i)};const y=o(g);if(t){if(g.getAppComponent().getRootViewController().isFclEnabled()){await r(t,f,g,u,p)}else if(!d.getObject().HasActiveEntity){s(t,f,g,u,D,y,p)}else if(t.CreationDateTime===t.LastChangeDateTime){c(g,d,u,D)}else if(i.isEditStateDirty()){l(g,f,u,D,y,p)}else{u()}}else{a()}}async function d(e,a,i,o,r){let s=arguments.length>5&&arguments[5]!==undefined?arguments[5]:n.BackNavigation;const c=o.getView();const l=i.getModel();const d=l.getMetaModel();const g=c.getViewData().entitySet??"";const p=g&&d.getObject("/"+g+"@com.sap.vocabularies.Common.v1.DraftRoot");const D=c.getModel("ui");const v=D.getProperty("/isEditable");const u=l.bindContext(`${i.getPath()}/DraftAdministrativeData`).getBoundContext();if(i&&i.getObject()&&(!p&&s===n.BackNavigation||!v)){e()}else{try{const t=await u.requestObject();await f(t,e,a,i,o,r,s)}catch(e){t.error("Cannot retrieve draftDataContext information",e)}}}const g={processDataLossOrDraftDiscardConfirmation:d,silentlyKeepDraftOnForwardNavigation:o,NavigationType:n,processFclMode:r,processNoActiveEntityMode:s,processEditingDraftForExistingEntity:c,processEditStateDirty:l};return g},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/operations-dbg", ["sap/base/Log", "sap/fe/core/ActionRuntime", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/controllerextensions/messageHandler/messageHandling", "sap/fe/core/helpers/FPMHelper", "sap/fe/core/helpers/StableIdHelper", "sap/fe/core/library", "sap/m/Button", "sap/m/Dialog", "sap/m/MessageBox", "sap/ui/core/Core", "sap/ui/core/Fragment", "sap/ui/core/library", "sap/ui/core/message/Message", "sap/ui/core/util/XMLPreprocessor", "sap/ui/core/XMLTemplateProcessor", "sap/ui/model/json/JSONModel", "../../operationsHelper"], function (Log, ActionRuntime, CommonUtils, BusyLocker, messageHandling, FPMHelper, StableIdHelper, FELibrary, Button, Dialog, MessageBox, Core, Fragment, library, Message, XMLPreprocessor, XMLTemplateProcessor, JSONModel, operationsHelper) {
  "use strict";

  var MessageType = library.MessageType;
  var generate = StableIdHelper.generate;
  const Constants = FELibrary.Constants,
    InvocationGrouping = FELibrary.InvocationGrouping;
  const Action = MessageBox.Action;

  /**
   * Calls a bound action for one or multiple contexts.
   *
   * @function
   * @static
   * @name sap.fe.core.actions.operations.callBoundAction
   * @memberof sap.fe.core.actions.operations
   * @param sActionName The name of the action to be called
   * @param contexts Either one context or an array with contexts for which the action is to be be called
   * @param oModel OData Model
   * @param oAppComponent The AppComponent
   * @param [mParameters] Optional, can contain the following attributes:
   * @param [mParameters.parameterValues] A map of action parameter names and provided values
   * @param [mParameters.mBindingParameters] A map of binding parameters that would be part of $select and $expand coming from side effects for bound actions
   * @param [mParameters.additionalSideEffect] Array of property paths to be requested in addition to actual target properties of the side effect
   * @param [mParameters.showActionParameterDialog] If set and if parameters exist the user retrieves a dialog to fill in parameters, if actionParameters are passed they are shown to the user
   * @param [mParameters.label] A human-readable label for the action
   * @param [mParameters.invocationGrouping] Mode how actions are to be called: Changeset to put all action calls into one changeset, Isolated to put them into separate changesets, defaults to Isolated
   * @param [mParameters.onSubmitted] Function which is called once the actions are submitted with an array of promises
   * @param [mParameters.defaultParameters] Can contain default parameters from FLP user defaults
   * @param [mParameters.parentControl] If specified, the dialogs are added as dependent of the parent control
   * @param [mParameters.bGetBoundContext] If specified, the action promise returns the bound context
   * @param [strictHandlingUtilities] Optional, utility flags and messages for strictHandling
   * @returns Promise resolves with an array of response objects (TODO: to be changed)
   * @private
   * @ui5-restricted
   */
  function callBoundAction(sActionName, contexts, oModel, oAppComponent, mParameters, strictHandlingUtilities) {
    if (!strictHandlingUtilities) {
      strictHandlingUtilities = {
        is412Executed: false,
        strictHandlingTransitionFails: [],
        strictHandlingPromises: [],
        strictHandlingWarningMessages: [],
        delaySuccessMessages: [],
        processedMessageIds: []
      };
    }
    if (!contexts || contexts.length === 0) {
      //In Freestyle apps bound actions can have no context
      return Promise.reject("Bound actions always requires at least one context");
    }
    // this method either accepts single context or an array of contexts
    // TODO: Refactor to an unambiguos API
    const isCalledWithArray = Array.isArray(contexts);

    // in case of single context wrap into an array for called methods (esp. callAction)
    mParameters.aContexts = isCalledWithArray ? contexts : [contexts];
    const oMetaModel = oModel.getMetaModel(),
      // Analyzing metaModelPath for action only from first context seems weird, but probably works in all existing szenarios - if several contexts are passed, they probably
      // belong to the same metamodelpath. TODO: Check, whether this can be improved / szenarios with different metaModelPaths might exist
      sActionPath = `${oMetaModel.getMetaPath(mParameters.aContexts[0].getPath())}/${sActionName}`,
      oBoundAction = oMetaModel.createBindingContext(`${sActionPath}/@$ui5.overload/0`);
    mParameters.isCriticalAction = getIsActionCritical(oMetaModel, sActionPath, mParameters.aContexts, oBoundAction);

    // Promise returned by callAction currently is rejected in case of execution for multiple contexts partly failing. This should be changed (some failing contexts do not mean
    // that function did not fulfill its task), but as this is a bigger refactoring, for the time being we need to deal with that at the calling place (i.e. here)
    // => provide the same handler (mapping back from array to single result/error if needed) for resolved/rejected case
    const extractSingleResult = function (result) {
      // single action could be resolved or rejected
      if (result[0].status === "fulfilled") {
        return result[0].value;
      } else {
        // In case of dialog cancellation, no array is returned => throw the result.
        // Ideally, differentiating should not be needed here => TODO: Find better solution when separating dialog handling (single object with single result) from backend
        // execution (potentially multiple objects)
        throw result[0].reason || result;
      }
    };
    return callAction(sActionName, oModel, oBoundAction, oAppComponent, mParameters, strictHandlingUtilities).then(result => {
      if (isCalledWithArray) {
        return result;
      } else {
        return extractSingleResult(result);
      }
    }, result => {
      if (isCalledWithArray) {
        throw result;
      } else {
        return extractSingleResult(result);
      }
    });
  }
  /**
   * Calls an action import.
   *
   * @function
   * @static
   * @name sap.fe.core.actions.operations.callActionImport
   * @memberof sap.fe.core.actions.operations
   * @param sActionName The name of the action import to be called
   * @param oModel An instance of an OData V4 model
   * @param oAppComponent The AppComponent
   * @param [mParameters] Optional, can contain the following attributes:
   * @param [mParameters.parameterValues] A map of action parameter names and provided values
   * @param [mParameters.label] A human-readable label for the action
   * @param [mParameters.showActionParameterDialog] If set and if parameters exist the user retrieves a dialog to fill in parameters, if actionParameters are passed they are shown to the user
   * @param [mParameters.onSubmitted] Function which is called once the actions are submitted with an array of promises
   * @param [mParameters.defaultParameters] Can contain default parameters from FLP user defaults
   * @param [strictHandlingUtilities] Optional, utility flags and messages for strictHandling
   * @returns Promise resolves with an array of response objects (TODO: to be changed)
   * @private
   * @ui5-restricted
   */
  function callActionImport(sActionName, oModel, oAppComponent, mParameters, strictHandlingUtilities) {
    if (!oModel) {
      return Promise.reject("Action expects a model/context for execution");
    }
    const oMetaModel = oModel.getMetaModel(),
      sActionPath = oModel.bindContext(`/${sActionName}`).getPath(),
      oActionImport = oMetaModel.createBindingContext(`/${oMetaModel.createBindingContext(sActionPath).getObject("$Action")}/0`);
    mParameters.isCriticalAction = getIsActionCritical(oMetaModel, `${sActionPath}/@$ui5.overload`);
    return callAction(sActionName, oModel, oActionImport, oAppComponent, mParameters, strictHandlingUtilities);
  }
  function callBoundFunction(sFunctionName, context, oModel) {
    if (!context) {
      return Promise.reject("Bound functions always requires a context");
    }
    const oMetaModel = oModel.getMetaModel(),
      sFunctionPath = `${oMetaModel.getMetaPath(context.getPath())}/${sFunctionName}`,
      oBoundFunction = oMetaModel.createBindingContext(sFunctionPath);
    return _executeFunction(sFunctionName, oModel, oBoundFunction, context);
  }
  /**
   * Calls a function import.
   *
   * @function
   * @static
   * @name sap.fe.core.actions.operations.callFunctionImport
   * @memberof sap.fe.core.actions.operations
   * @param sFunctionName The name of the function to be called
   * @param oModel An instance of an OData v4 model
   * @returns Promise resolves
   * @private
   */
  function callFunctionImport(sFunctionName, oModel) {
    if (!sFunctionName) {
      return Promise.resolve();
    }
    const oMetaModel = oModel.getMetaModel(),
      sFunctionPath = oModel.bindContext(`/${sFunctionName}`).getPath(),
      oFunctionImport = oMetaModel.createBindingContext(`/${oMetaModel.createBindingContext(sFunctionPath).getObject("$Function")}/0`);
    return _executeFunction(sFunctionName, oModel, oFunctionImport);
  }
  function _executeFunction(sFunctionName, oModel, oFunction, context) {
    let sGroupId;
    if (!oFunction || !oFunction.getObject()) {
      return Promise.reject(new Error(`Function ${sFunctionName} not found`));
    }
    if (context) {
      oFunction = oModel.bindContext(`${sFunctionName}(...)`, context);
      sGroupId = "functionGroup";
    } else {
      oFunction = oModel.bindContext(`/${sFunctionName}(...)`);
      sGroupId = "functionImport";
    }
    const oFunctionPromise = oFunction.execute(sGroupId);
    oModel.submitBatch(sGroupId);
    return oFunctionPromise.then(function () {
      return oFunction.getBoundContext();
    });
  }
  function callAction(sActionName, oModel, oAction, oAppComponent, mParameters, strictHandlingUtilities) {
    return new Promise(async function (resolve, reject) {
      let mActionExecutionParameters = {};
      let fnDialog;
      let oActionPromise;
      //let failedActionPromise: any;
      const sActionLabel = mParameters.label;
      const bSkipParameterDialog = mParameters.skipParameterDialog;
      const aContexts = mParameters.aContexts;
      const bIsCreateAction = mParameters.bIsCreateAction;
      const bIsCriticalAction = mParameters.isCriticalAction;
      let oMetaModel;
      let sMetaPath;
      let sMessagesPath;
      let iMessageSideEffect;
      let bIsSameEntity;
      let oReturnType;
      let bValuesProvidedForAllParameters;
      const actionDefinition = oAction.getObject();
      if (!oAction || !oAction.getObject()) {
        return reject(new Error(`Action ${sActionName} not found`));
      }

      // Get the parameters of the action
      const aActionParameters = getActionParameters(oAction);

      // Check if the action has parameters and would need a parameter dialog
      // The parameter ResultIsActiveEntity is always hidden in the dialog! Hence if
      // this is the only parameter, this is treated as no parameter here because the
      // dialog would be empty!
      // FIXME: Should only ignore this if this is a 'create' action, otherwise it is just some normal parameter that happens to have this name
      const bActionNeedsParameterDialog = aActionParameters.length > 0 && !(aActionParameters.length === 1 && aActionParameters[0].$Name === "ResultIsActiveEntity");

      // Provided values for the action parameters from invokeAction call
      const aParameterValues = mParameters.parameterValues;

      // Determine startup parameters if provided
      const oComponentData = oAppComponent.getComponentData();
      const oStartupParameters = oComponentData && oComponentData.startupParameters || {};

      // In case an action parameter is needed, and we shall skip the dialog, check if values are provided for all parameters
      if (bActionNeedsParameterDialog && bSkipParameterDialog) {
        bValuesProvidedForAllParameters = _valuesProvidedForAllParameters(bIsCreateAction, aActionParameters, aParameterValues, oStartupParameters);
      }

      // Depending on the previously determined data, either set a dialog or leave it empty which
      // will lead to direct execution of the action without a dialog
      fnDialog = null;
      if (bActionNeedsParameterDialog) {
        if (!(bSkipParameterDialog && bValuesProvidedForAllParameters)) {
          fnDialog = showActionParameterDialog;
        }
      } else if (bIsCriticalAction) {
        fnDialog = confirmCriticalAction;
      }
      mActionExecutionParameters = {
        fnOnSubmitted: mParameters.onSubmitted,
        fnOnResponse: mParameters.onResponse,
        actionName: sActionName,
        model: oModel,
        aActionParameters: aActionParameters,
        bGetBoundContext: mParameters.bGetBoundContext,
        defaultValuesExtensionFunction: mParameters.defaultValuesExtensionFunction,
        label: mParameters.label,
        selectedItems: mParameters.selectedItems
      };
      if (oAction.getObject("$IsBound")) {
        if (mParameters.additionalSideEffect && mParameters.additionalSideEffect.pathExpressions) {
          oMetaModel = oModel.getMetaModel();
          sMetaPath = oMetaModel.getMetaPath(aContexts[0].getPath());
          sMessagesPath = oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.Common.v1.Messages/$Path`);
          if (sMessagesPath) {
            iMessageSideEffect = mParameters.additionalSideEffect.pathExpressions.findIndex(function (exp) {
              return typeof exp === "string" && exp === sMessagesPath;
            });

            // Add SAP_Messages by default if not annotated by side effects, action does not return a collection and
            // the return type is the same as the bound type
            oReturnType = oAction.getObject("$ReturnType");
            bIsSameEntity = oReturnType && !oReturnType.$isCollection && oAction.getModel().getObject(sMetaPath).$Type === oReturnType.$Type;
            if (iMessageSideEffect > -1 || bIsSameEntity) {
              // the message path is annotated as side effect. As there's no binding for it and the model does currently not allow
              // to add it at a later point of time we have to take care it's part of the $select of the POST, therefore moving it.
              mParameters.mBindingParameters = mParameters.mBindingParameters || {};
              if (oAction.getObject(`$ReturnType/$Type/${sMessagesPath}`) && (!mParameters.mBindingParameters.$select || mParameters.mBindingParameters.$select.split(",").indexOf(sMessagesPath) === -1)) {
                mParameters.mBindingParameters.$select = mParameters.mBindingParameters.$select ? `${mParameters.mBindingParameters.$select},${sMessagesPath}` : sMessagesPath;
                // Add side effects at entity level because $select stops these being returned by the action
                // Only if no other side effects were added for Messages
                if (iMessageSideEffect === -1) {
                  mParameters.additionalSideEffect.pathExpressions.push("*");
                }
                if (mParameters.additionalSideEffect.triggerActions.length === 0 && iMessageSideEffect > -1) {
                  // no trigger action therefore no need to request messages again
                  mParameters.additionalSideEffect.pathExpressions.splice(iMessageSideEffect, 1);
                }
              }
            }
          }
        }
        mActionExecutionParameters.aContexts = aContexts;
        mActionExecutionParameters.mBindingParameters = mParameters.mBindingParameters;
        mActionExecutionParameters.additionalSideEffect = mParameters.additionalSideEffect;
        mActionExecutionParameters.bGrouped = mParameters.invocationGrouping === InvocationGrouping.ChangeSet;
        mActionExecutionParameters.internalModelContext = mParameters.internalModelContext;
        mActionExecutionParameters.operationAvailableMap = mParameters.operationAvailableMap;
        mActionExecutionParameters.isCreateAction = bIsCreateAction;
        mActionExecutionParameters.bObjectPage = mParameters.bObjectPage;
        if (mParameters.controlId) {
          mActionExecutionParameters.control = mParameters.parentControl.byId(mParameters.controlId);
        } else {
          mActionExecutionParameters.control = mParameters.parentControl;
        }
      }
      if (bIsCreateAction) {
        mActionExecutionParameters.bIsCreateAction = bIsCreateAction;
      }
      //check for skipping static actions
      const isStatic = (actionDefinition.$Parameter || []).some(aParameter => {
        return (actionDefinition.$EntitySetPath && actionDefinition.$EntitySetPath === aParameter.$Name || actionDefinition.$IsBound) && aParameter.$isCollection;
      });
      mActionExecutionParameters.isStatic = isStatic;
      if (fnDialog) {
        oActionPromise = fnDialog(sActionName, oAppComponent, sActionLabel, mActionExecutionParameters, aActionParameters, aParameterValues, oAction, mParameters.parentControl, mParameters.entitySetName, mParameters.messageHandler, strictHandlingUtilities);
        return oActionPromise.then(function (oOperationResult) {
          afterActionResolution(mParameters, mActionExecutionParameters, actionDefinition);
          resolve(oOperationResult);
        }).catch(function (oOperationResult) {
          reject(oOperationResult);
        });
      } else {
        // Take over all provided parameter values and call the action.
        // This shall only happen if values are provided for all the parameters, otherwise the parameter dialog shall be shown which is ensured earlier
        if (aParameterValues) {
          for (const i in mActionExecutionParameters.aActionParameters) {
            var _aParameterValues$fin;
            mActionExecutionParameters.aActionParameters[i].value = aParameterValues === null || aParameterValues === void 0 ? void 0 : (_aParameterValues$fin = aParameterValues.find(element => element.name === mActionExecutionParameters.aActionParameters[i].$Name)) === null || _aParameterValues$fin === void 0 ? void 0 : _aParameterValues$fin.value;
          }
        } else {
          for (const i in mActionExecutionParameters.aActionParameters) {
            var _oStartupParameters$m;
            mActionExecutionParameters.aActionParameters[i].value = (_oStartupParameters$m = oStartupParameters[mActionExecutionParameters.aActionParameters[i].$Name]) === null || _oStartupParameters$m === void 0 ? void 0 : _oStartupParameters$m[0];
          }
        }
        let oOperationResult;
        try {
          oOperationResult = await _executeAction(oAppComponent, mActionExecutionParameters, mParameters.parentControl, mParameters.messageHandler, strictHandlingUtilities);
          const messages = Core.getMessageManager().getMessageModel().getData();
          if (strictHandlingUtilities && strictHandlingUtilities.is412Executed && strictHandlingUtilities.strictHandlingTransitionFails.length) {
            strictHandlingUtilities.delaySuccessMessages = strictHandlingUtilities.delaySuccessMessages.concat(messages);
          }
          afterActionResolution(mParameters, mActionExecutionParameters, actionDefinition);
          resolve(oOperationResult);
        } catch {
          reject(oOperationResult);
        } finally {
          var _mParameters$messageH, _mActionExecutionPara;
          if (strictHandlingUtilities && strictHandlingUtilities.is412Executed && strictHandlingUtilities.strictHandlingTransitionFails.length) {
            try {
              const strictHandlingFails = strictHandlingUtilities.strictHandlingTransitionFails;
              const aFailedContexts = [];
              strictHandlingFails.forEach(function (fail) {
                aFailedContexts.push(fail.oAction.getContext());
              });
              mActionExecutionParameters.aContexts = aFailedContexts;
              const oFailedOperationResult = await _executeAction(oAppComponent, mActionExecutionParameters, mParameters.parentControl, mParameters.messageHandler, strictHandlingUtilities);
              strictHandlingUtilities.strictHandlingTransitionFails = [];
              Core.getMessageManager().addMessages(strictHandlingUtilities.delaySuccessMessages);
              afterActionResolution(mParameters, mActionExecutionParameters, actionDefinition);
              resolve(oFailedOperationResult);
            } catch (oFailedOperationResult) {
              reject(oFailedOperationResult);
            }
          }
          mParameters === null || mParameters === void 0 ? void 0 : (_mParameters$messageH = mParameters.messageHandler) === null || _mParameters$messageH === void 0 ? void 0 : _mParameters$messageH.showMessageDialog({
            control: (_mActionExecutionPara = mActionExecutionParameters) === null || _mActionExecutionPara === void 0 ? void 0 : _mActionExecutionPara.control
          });
          if (strictHandlingUtilities) {
            strictHandlingUtilities = {
              is412Executed: false,
              strictHandlingTransitionFails: [],
              strictHandlingPromises: [],
              strictHandlingWarningMessages: [],
              delaySuccessMessages: [],
              processedMessageIds: []
            };
          }
        }
      }
    });
  }
  function confirmCriticalAction(sActionName, oAppComponent, sActionLabel, mParameters, aActionParameters, aParameterValues, oActionContext, oParentControl, entitySetName, messageHandler) {
    return new Promise((resolve, reject) => {
      let boundActionName = sActionName ? sActionName : null;
      boundActionName = boundActionName.indexOf(".") >= 0 ? boundActionName.split(".")[boundActionName.split(".").length - 1] : boundActionName;
      const suffixResourceKey = boundActionName && entitySetName ? `${entitySetName}|${boundActionName}` : "";
      const oResourceBundle = oParentControl.getController().oResourceBundle;
      const sConfirmationText = CommonUtils.getTranslatedText("C_OPERATIONS_ACTION_CONFIRM_MESSAGE", oResourceBundle, undefined, suffixResourceKey);
      MessageBox.confirm(sConfirmationText, {
        onClose: async function (sAction) {
          if (sAction === Action.OK) {
            try {
              const oOperation = await _executeAction(oAppComponent, mParameters, oParentControl, messageHandler);
              resolve(oOperation);
            } catch (oError) {
              try {
                await messageHandler.showMessageDialog();
                reject(oError);
              } catch (e) {
                reject(oError);
              }
            }
          } else {
            resolve();
          }
        }
      });
    });
  }
  async function executeAPMAction(oAppComponent, mParameters, oParentControl, messageHandler, aContexts, oDialog, after412, strictHandlingUtilities) {
    var _mParameters$aContext;
    const aResult = await _executeAction(oAppComponent, mParameters, oParentControl, messageHandler, strictHandlingUtilities);
    // If some entries were successful, and others have failed, the overall process is still successful. However, this was treated as rejection
    // before, and this currently is still kept, as long as dialog handling is mixed with backend process handling.
    // TODO: Refactor to only reject in case of overall process error.
    // For the time being: map to old logic to reject if at least one entry has failed
    // This check is only done for bound actions => aContexts not empty
    if ((_mParameters$aContext = mParameters.aContexts) !== null && _mParameters$aContext !== void 0 && _mParameters$aContext.length) {
      if (aResult !== null && aResult !== void 0 && aResult.some(oSingleResult => oSingleResult.status === "rejected")) {
        throw aResult;
      }
    }
    const messages = Core.getMessageManager().getMessageModel().getData();
    if (strictHandlingUtilities && strictHandlingUtilities.is412Executed && strictHandlingUtilities.strictHandlingTransitionFails.length) {
      if (!after412) {
        strictHandlingUtilities.delaySuccessMessages = strictHandlingUtilities.delaySuccessMessages.concat(messages);
      } else {
        Core.getMessageManager().addMessages(strictHandlingUtilities.delaySuccessMessages);
        if (messages.length) {
          // BOUND TRANSITION AS PART OF SAP_MESSAGE
          messageHandler.showMessageDialog({
            onBeforeShowMessage: function (aMessages, showMessageParametersIn) {
              return actionParameterShowMessageCallback(mParameters, aContexts, oDialog, aMessages, showMessageParametersIn);
            },
            control: mParameters.control
          });
        }
      }
    } else if (messages.length) {
      // BOUND TRANSITION AS PART OF SAP_MESSAGE
      messageHandler.showMessageDialog({
        isActionParameterDialogOpen: mParameters === null || mParameters === void 0 ? void 0 : mParameters.oDialog.isOpen(),
        onBeforeShowMessage: function (aMessages, showMessageParametersIn) {
          return actionParameterShowMessageCallback(mParameters, aContexts, oDialog, aMessages, showMessageParametersIn);
        },
        control: mParameters.control
      });
    }
    return aResult;
  }
  function afterActionResolution(mParameters, mActionExecutionParameters, actionDefinition) {
    if (mActionExecutionParameters.internalModelContext && mActionExecutionParameters.operationAvailableMap && mActionExecutionParameters.aContexts && mActionExecutionParameters.aContexts.length && actionDefinition.$IsBound) {
      //check for skipping static actions
      const isStatic = mActionExecutionParameters.isStatic;
      if (!isStatic) {
        ActionRuntime.setActionEnablement(mActionExecutionParameters.internalModelContext, JSON.parse(mActionExecutionParameters.operationAvailableMap), mParameters.selectedItems, "table");
      } else if (mActionExecutionParameters.control) {
        const oControl = mActionExecutionParameters.control;
        if (oControl.isA("sap.ui.mdc.Table")) {
          const aSelectedContexts = oControl.getSelectedContexts();
          ActionRuntime.setActionEnablement(mActionExecutionParameters.internalModelContext, JSON.parse(mActionExecutionParameters.operationAvailableMap), aSelectedContexts, "table");
        }
      }
    }
  }
  function actionParameterShowMessageCallback(mParameters, aContexts, oDialog, messages, showMessageParametersIn) {
    let showMessageBox = showMessageParametersIn.showMessageBox,
      showMessageDialog = showMessageParametersIn.showMessageDialog;
    const oControl = mParameters.control;
    const unboundMessages = messages.filter(function (message) {
      return message.getTarget() === "";
    });
    const APDmessages = messages.filter(function (message) {
      return message.getTarget && message.getTarget().indexOf(mParameters.actionName) !== -1 && mParameters.aActionParameters.some(function (actionParam) {
        return message.getTarget().indexOf(actionParam.$Name) !== -1;
      });
    });
    APDmessages.forEach(function (APDMessage) {
      APDMessage.isAPDTarget = true;
    });
    const errorTargetsInAPD = APDmessages.length ? true : false;
    if (oDialog.isOpen() && aContexts.length !== 0 && !mParameters.isStatic) {
      if (!mParameters.bGrouped) {
        //isolated
        if (aContexts.length > 1 || !errorTargetsInAPD) {
          // does not matter if error is in APD or not, if there are multiple contexts selected or if the error is not the APD, we close it.
          // TODO: Dilaog handling should not be part of message handling. Refactor accordingly - dialog should not be needed inside this method - neither
          // to ask whether it's open, nor to close/destroy it!
          oDialog.close();
          oDialog.destroy();
        }
      } else if (!errorTargetsInAPD) {
        //changeset
        oDialog.close();
        oDialog.destroy();
      }
    }
    let filteredMessages = [];
    const bIsAPDOpen = oDialog.isOpen();
    if (messages.length === 1 && messages[0].getTarget && messages[0].getTarget() !== undefined && messages[0].getTarget() !== "") {
      if (oControl && oControl.getModel("ui").getProperty("/isEditable") === false || !oControl) {
        // OP edit or LR
        showMessageBox = !errorTargetsInAPD;
        showMessageDialog = false;
      } else if (oControl && oControl.getModel("ui").getProperty("/isEditable") === true) {
        showMessageBox = false;
        showMessageDialog = false;
      }
    } else if (oControl) {
      if (oControl.getModel("ui").getProperty("/isEditable") === false) {
        if (bIsAPDOpen && errorTargetsInAPD) {
          showMessageDialog = false;
        }
      } else if (oControl.getModel("ui").getProperty("/isEditable") === true) {
        if (!bIsAPDOpen && errorTargetsInAPD) {
          showMessageDialog = true;
          filteredMessages = unboundMessages.concat(APDmessages);
        } else if (!bIsAPDOpen && unboundMessages.length === 0) {
          // error targets in APD => there is atleast one bound message. If there are unbound messages, dialog must be shown.
          // for draft entity, we already closed the APD
          showMessageDialog = false;
        }
      }
    }
    return {
      showMessageBox: showMessageBox,
      showMessageDialog: showMessageDialog,
      filteredMessages: filteredMessages.length ? filteredMessages : messages,
      fnGetMessageSubtitle: oControl && oControl.isA("sap.ui.mdc.Table") && messageHandling.setMessageSubtitle.bind({}, oControl, aContexts)
    };
  }

  /*
   * Currently, this method is responsible for showing the dialog and executing the action. The promise returned is pending while waiting for user input, as well as while the
   * back-end request is running. The promise is rejected when the user cancels the dialog and also when the back-end request fails.
   * TODO: Refactoring: Separate dialog handling from backend processing. Dialog handling should return a Promise resolving to parameters to be provided to backend. If dialog is
   * cancelled, that promise can be rejected. Method responsible for backend processing need to deal with multiple contexts - i.e. it should either return an array of Promises or
   * a Promise resolving to an array. In the latter case, that Promise should be resolved also when some or even all contexts failed in backend - the overall process still was
   * successful.
   *
   */

  // this type is meant to describe the meta information for one ActionParameter (i.e. its object in metaModel)

  function showActionParameterDialog(sActionName, oAppComponent, sActionLabel, mParameters, aActionParameters, aParameterValues, oActionContext, oParentControl, entitySetName, messageHandler, strictHandlingUtilities) {
    const sPath = _getPath(oActionContext, sActionName),
      metaModel = oActionContext.getModel().oModel.getMetaModel(),
      entitySetContext = metaModel.createBindingContext(sPath),
      sActionNamePath = oActionContext.getObject("$IsBound") ? oActionContext.getPath().split("/@$ui5.overload/0")[0] : oActionContext.getPath().split("/0")[0],
      actionNameContext = metaModel.createBindingContext(sActionNamePath),
      bIsCreateAction = mParameters.isCreateAction,
      sFragmentName = "sap/fe/core/controls/ActionParameterDialog";
    return new Promise(async function (resolve, reject) {
      let actionParameterInfos; // to be filled after fragment (for action parameter dialog) is loaded. Actually only needed during dialog processing, i.e. could be moved into the controller and directly initialized there, but only after moving all handlers (esp. press handler for action button) to controller.

      const messageManager = Core.getMessageManager();

      // in case of missing mandaotory parameter, message currently differs per parameter, as it superfluously contains the label as parameter. Possiblky this could be removed in future, in that case, interface could be simplified to ActionParameterInfo[], string
      const _addMessageForActionParameter = messageParameters => {
        messageManager.addMessages(messageParameters.map(messageParameter => {
          const binding = messageParameter.actionParameterInfo.field.getBinding(messageParameter.actionParameterInfo.isMultiValue ? "items" : "value");
          return new Message({
            message: messageParameter.message,
            type: "Error",
            processor: binding === null || binding === void 0 ? void 0 : binding.getModel(),
            persistent: true,
            target: binding === null || binding === void 0 ? void 0 : binding.getResolvedPath()
          });
        }));
      };
      const _removeMessagesForActionParamter = parameter => {
        const allMessages = messageManager.getMessageModel().getData();
        const controlId = generate(["APD_", parameter.$Name]);
        // also remove messages assigned to inner controls, but avoid removing messages for different paramters (with name being substring of another parameter name)
        const relevantMessages = allMessages.filter(msg => msg.getControlIds().some(id => controlId.split("-").includes(id)));
        messageManager.removeMessages(relevantMessages);
      };
      const _validateProperties = async function (oResourceBundle) {
        const requiredParameterInfos = actionParameterInfos.filter(actionParameterInfo => actionParameterInfo.field.getRequired());
        await Promise.allSettled(requiredParameterInfos.map(actionParameterInfo => actionParameterInfo.validationPromise));
        /* Hint: The boolean false is a valid value */
        const emptyRequiredFields = requiredParameterInfos.filter(requiredParameterInfo => {
          if (requiredParameterInfo.isMultiValue) {
            return requiredParameterInfo.value === undefined || !requiredParameterInfo.value.length;
          } else {
            const fieldValue = requiredParameterInfo.field.getValue();
            return fieldValue === undefined || fieldValue === null || fieldValue === "";
          }
        });

        // message contains label per field for historical reason (originally, it was shown in additional popup, now it's directly added to the field)
        // if this was not the case (and hopefully, in future this might be subject to change), interface of _addMessageForActionParameter could be simplified to just pass emptyRequiredFields and a constant message here
        _addMessageForActionParameter(emptyRequiredFields.map(actionParameterInfo => {
          var _actionParameterInfo$;
          return {
            actionParameterInfo: actionParameterInfo,
            message: CommonUtils.getTranslatedText("C_OPERATIONS_ACTION_PARAMETER_DIALOG_MISSING_MANDATORY_MSG", oResourceBundle, [((_actionParameterInfo$ = actionParameterInfo.field.getParent()) === null || _actionParameterInfo$ === void 0 ? void 0 : _actionParameterInfo$.getAggregation("label")).getText()])
          };
        }));

        /* Check value state of all parameter */
        const firstInvalidActionParameter = actionParameterInfos.find(
        // unfortunately, _addMessageForActionParameter sets valueState only asynchroneously, thus checking emptyRequiredFields additionally
        actionParameterInfo => actionParameterInfo.field.getValueState() === "Error" || emptyRequiredFields.includes(actionParameterInfo));
        if (firstInvalidActionParameter) {
          firstInvalidActionParameter.field.focus();
          return false;
        } else {
          return true;
        }
      };
      const oController = {
        handleChange: async function (oEvent) {
          const field = oEvent.getSource();
          const actionParameterInfo = actionParameterInfos.find(actionParameterInfo => actionParameterInfo.field === field);
          // field value is being changed, thus existing messages related to that field are not valid anymore
          _removeMessagesForActionParamter(actionParameterInfo.parameter);
          // adapt info. Promise is resolved to value or rejected with exception containing message
          actionParameterInfo.validationPromise = oEvent.getParameter("promise");
          try {
            actionParameterInfo.value = await actionParameterInfo.validationPromise;
          } catch (error) {
            delete actionParameterInfo.value;
            _addMessageForActionParameter([{
              actionParameterInfo: actionParameterInfo,
              message: error.message
            }]);
          }
        }
      };
      const oFragment = XMLTemplateProcessor.loadTemplate(sFragmentName, "fragment");
      const oParameterModel = new JSONModel({
        $displayMode: {}
      });
      try {
        const createdFragment = await XMLPreprocessor.process(oFragment, {
          name: sFragmentName
        }, {
          bindingContexts: {
            action: oActionContext,
            actionName: actionNameContext,
            entitySet: entitySetContext
          },
          models: {
            action: oActionContext.getModel(),
            actionName: actionNameContext.getModel(),
            entitySet: entitySetContext.getModel(),
            metaModel: entitySetContext.getModel()
          }
        });
        // TODO: move the dialog into the fragment and move the handlers to the oController
        const aContexts = mParameters.aContexts || [];
        const aFunctionParams = [];
        // eslint-disable-next-line prefer-const
        let oOperationBinding;
        await CommonUtils.setUserDefaults(oAppComponent, aActionParameters, oParameterModel, true);
        const oDialogContent = await Fragment.load({
          definition: createdFragment,
          controller: oController
        });
        actionParameterInfos = aActionParameters.map(actionParameter => {
          const field = Core.byId(generate(["APD_", actionParameter.$Name]));
          const isMultiValue = field.isA("sap.ui.mdc.MultiValueField");
          return {
            parameter: actionParameter,
            field: field,
            isMultiValue: isMultiValue
          };
        });
        const oResourceBundle = oParentControl.getController().oResourceBundle;
        let actionResult = {
          dialogCancelled: true,
          // to be set to false in case of successful action exection
          result: undefined
        };
        const oDialog = new Dialog(generate(["fe", "APD_", sActionName]), {
          title: sActionLabel || CommonUtils.getTranslatedText("C_OPERATIONS_ACTION_PARAMETER_DIALOG_TITLE", oResourceBundle),
          content: [oDialogContent],
          escapeHandler: function () {
            // escape handler is meant to possibly suppress or postpone closing the dialog on escape (by calling "reject" on the provided object, or "resolve" only when
            // done with all tasks to happen before dialog can be closed). It's not intended to explicetly close the dialog here (that happens automatically when no
            // escapeHandler is provided or the resolve-callback is called) or for own wrap up tasks (like removing validition messages - this should happen in the
            // afterClose).
            // TODO: Move wrap up tasks to afterClose, and remove this method completely. Take care to also adapt end button press handler accordingly.
            // Currently only still needed to differentiate closing dialog after successful execution (uses resolve) from user cancellation (using reject)
            oDialog.close();
            //		reject(Constants.CancelActionDialog);
          },

          beginButton: new Button(generate(["fe", "APD_", sActionName, "Action", "Ok"]), {
            text: bIsCreateAction ? CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE_BUTTON", oResourceBundle) : _getActionParameterActionName(oResourceBundle, sActionLabel, sActionName, entitySetName),
            type: "Emphasized",
            press: async function () {
              try {
                if (!(await _validateProperties(oResourceBundle))) {
                  return;
                }
                BusyLocker.lock(oDialog);
                try {
                  // TODO: due to using the search and value helps on the action dialog transient messages could appear
                  // we need an UX design for those to show them to the user - for now remove them before continuing
                  messageHandler.removeTransitionMessages();
                  // move parameter values from Dialog (SimpleForm) to mParameters.actionParameters so that they are available in the operation bindings for all contexts
                  let vParameterValue;
                  const oParameterContext = oOperationBinding && oOperationBinding.getParameterContext();
                  for (const i in aActionParameters) {
                    if (aActionParameters[i].$isCollection) {
                      const aMVFContent = oDialog.getModel("mvfview").getProperty(`/${aActionParameters[i].$Name}`),
                        aKeyValues = [];
                      for (const j in aMVFContent) {
                        aKeyValues.push(aMVFContent[j].Key);
                      }
                      vParameterValue = aKeyValues;
                    } else {
                      vParameterValue = oParameterContext.getProperty(aActionParameters[i].$Name);
                    }
                    aActionParameters[i].value = vParameterValue; // writing the current value (ueser input!) into the metamodel => should be refactored to use ActionParameterInfos instead. Used in setActionParameterDefaultValue
                    vParameterValue = undefined;
                  }
                  mParameters.label = sActionLabel;
                  try {
                    const aResult = await executeAPMAction(oAppComponent, mParameters, oParentControl, messageHandler, aContexts, oDialog, false, strictHandlingUtilities);
                    actionResult = {
                      dialogCancelled: false,
                      result: aResult
                    };
                    oDialog.close();
                    // resolve(aResult);
                  } catch (oError) {
                    const messages = sap.ui.getCore().getMessageManager().getMessageModel().getData();
                    if (strictHandlingUtilities && strictHandlingUtilities.is412Executed && strictHandlingUtilities.strictHandlingTransitionFails.length) {
                      strictHandlingUtilities.delaySuccessMessages = strictHandlingUtilities.delaySuccessMessages.concat(messages);
                    }
                    throw oError;
                  } finally {
                    if (strictHandlingUtilities && strictHandlingUtilities.is412Executed && strictHandlingUtilities.strictHandlingTransitionFails.length) {
                      try {
                        const strictHandlingFails = strictHandlingUtilities.strictHandlingTransitionFails;
                        const aFailedContexts = [];
                        strictHandlingFails.forEach(function (fail) {
                          aFailedContexts.push(fail.oAction.getContext());
                        });
                        mParameters.aContexts = aFailedContexts;
                        const aResult = await executeAPMAction(oAppComponent, mParameters, oParentControl, messageHandler, aContexts, oDialog, true, strictHandlingUtilities);
                        strictHandlingUtilities.strictHandlingTransitionFails = [];
                        actionResult = {
                          dialogCancelled: false,
                          result: aResult
                        };
                        // resolve(aResult);
                      } catch {
                        if (strictHandlingUtilities && strictHandlingUtilities.is412Executed && strictHandlingUtilities.strictHandlingTransitionFails.length) {
                          Core.getMessageManager().addMessages(strictHandlingUtilities.delaySuccessMessages);
                        }
                        await messageHandler.showMessageDialog({
                          isActionParameterDialogOpen: oDialog.isOpen(),
                          onBeforeShowMessage: function (aMessages, showMessageParametersIn) {
                            return actionParameterShowMessageCallback(mParameters, aContexts, oDialog, aMessages, showMessageParametersIn);
                          }
                        });
                      }
                    }
                    if (BusyLocker.isLocked(oDialog)) {
                      BusyLocker.unlock(oDialog);
                    }
                  }
                } catch (oError) {
                  let showMessageDialog = true;
                  await messageHandler.showMessages({
                    context: mParameters.aContexts[0],
                    isActionParameterDialogOpen: oDialog.isOpen(),
                    messagePageNavigationCallback: function () {
                      oDialog.close();
                    },
                    onBeforeShowMessage: function (aMessages, showMessageParametersIn) {
                      // Why is this implemented as callback? Apparently, all needed information is available beforehand
                      // TODO: refactor accordingly
                      const showMessageParameters = actionParameterShowMessageCallback(mParameters, aContexts, oDialog, aMessages, showMessageParametersIn);
                      showMessageDialog = showMessageParameters.showMessageDialog;
                      return showMessageParameters;
                    },
                    aSelectedContexts: mParameters.aContexts,
                    sActionName: sActionLabel,
                    control: mParameters.control
                  });

                  // In case of backend validation error(s?), message shall not be shown in message dialog but next to the field on parameter dialog, which should
                  // stay open in this case => in this case, we must not resolve or reject the promise controlling the parameter dialog.
                  // In all other cases (e.g. other backend errors or user cancellation), the promise controlling the parameter dialog needs to be rejected to allow
                  // callers to react. (Example: If creation in backend after navigation to transient context fails, back navigation needs to be triggered)
                  // TODO: Refactor to separate dialog handling from backend request istead of taking decision based on message handling
                  if (showMessageDialog) {
                    if (oDialog.isOpen()) {
                      // do nothing, do not reject promise here
                      // We do not close the APM dialog if user enters a wrong value in of the fields that results in an error from the backend.
                      // The user can close the message dialog and the APM dialog would still be open on which he could enter a new value and trigger the action again.
                      // Earlier we were rejecting the promise on error here, and the call stack was destroyed as the promise was rejected and returned to EditFlow invoke action.
                      // But since the APM dialog was still open, a new promise was resolved in case the user retried the action and the object was created, but the navigation to object page was not taking place.
                    } else {
                      reject(oError);
                    }
                  }
                }
              } finally {
                if (strictHandlingUtilities) {
                  strictHandlingUtilities = {
                    is412Executed: false,
                    strictHandlingTransitionFails: [],
                    strictHandlingPromises: [],
                    strictHandlingWarningMessages: [],
                    delaySuccessMessages: [],
                    processedMessageIds: []
                  };
                }
                if (BusyLocker.isLocked(oDialog)) {
                  BusyLocker.unlock(oDialog);
                }
              }
            }
          }),
          endButton: new Button(generate(["fe", "APD_", sActionName, "Action", "Cancel"]), {
            text: CommonUtils.getTranslatedText("C_COMMON_ACTION_PARAMETER_DIALOG_CANCEL", oResourceBundle),
            press: function () {
              // TODO: cancel button should just close the dialog (similar to using escape). All wrap up tasks should be moved to afterClose.
              oDialog.close();
              // reject(Constants.CancelActionDialog);
            }
          }),

          // TODO: beforeOpen is just an event, i.e. not waiting for the Promise to be resolved. Check if tasks of this function need to be done before opening the dialog
          // - if yes, they need to be moved outside.
          // Assumption: Sometimes dialog can be seen without any fields for a short time - maybe this is caused by this asynchronity
          beforeOpen: async function (oEvent) {
            // clone event for actionWrapper as oEvent.oSource gets lost during processing of beforeOpen event handler
            const oCloneEvent = Object.assign({}, oEvent);
            messageHandler.removeTransitionMessages();
            const getDefaultValuesFunction = function () {
              const oMetaModel = oDialog.getModel().getMetaModel(),
                sActionPath = oActionContext.sPath && oActionContext.sPath.split("/@")[0],
                sDefaultValuesFunction = oMetaModel.getObject(`${sActionPath}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`);
              return sDefaultValuesFunction;
            };
            const fnSetDefaultsAndOpenDialog = async function (sBindingParameter) {
              const sBoundFunctionName = getDefaultValuesFunction();
              const prefillParameter = async function (sParamName, vParamDefaultValue) {
                // Case 1: There is a ParameterDefaultValue annotation
                if (vParamDefaultValue !== undefined) {
                  if (aContexts.length > 0 && vParamDefaultValue.$Path) {
                    try {
                      let vParamValue = await CommonUtils.requestSingletonProperty(vParamDefaultValue.$Path, oOperationBinding.getModel());
                      if (vParamValue === null) {
                        vParamValue = await oOperationBinding.getParameterContext().requestProperty(vParamDefaultValue.$Path);
                      }
                      if (aContexts.length > 1) {
                        // For multi select, need to loop over aContexts (as contexts cannot be retrieved via binding parameter of the operation binding)
                        let sPathForContext = vParamDefaultValue.$Path;
                        if (sPathForContext.indexOf(`${sBindingParameter}/`) === 0) {
                          sPathForContext = sPathForContext.replace(`${sBindingParameter}/`, "");
                        }
                        for (let i = 1; i < aContexts.length; i++) {
                          if (aContexts[i].getProperty(sPathForContext) !== vParamValue) {
                            // if the values from the contexts are not all the same, do not prefill
                            return {
                              paramName: sParamName,
                              value: undefined,
                              bNoPossibleValue: true
                            };
                          }
                        }
                      }
                      return {
                        paramName: sParamName,
                        value: vParamValue
                      };
                    } catch (oError) {
                      Log.error("Error while reading default action parameter", sParamName, mParameters.actionName);
                      return {
                        paramName: sParamName,
                        value: undefined,
                        bLatePropertyError: true
                      };
                    }
                  } else {
                    // Case 1.2: ParameterDefaultValue defines a fixed string value (i.e. vParamDefaultValue = 'someString')
                    return {
                      paramName: sParamName,
                      value: vParamDefaultValue
                    };
                  }
                } else if (oParameterModel && oParameterModel.oData[sParamName]) {
                  // Case 2: There is no ParameterDefaultValue annotation (=> look into the FLP User Defaults)

                  return {
                    paramName: sParamName,
                    value: oParameterModel.oData[sParamName]
                  };
                } else {
                  return {
                    paramName: sParamName,
                    value: undefined
                  };
                }
              };
              const getParameterDefaultValue = function (sParamName) {
                const oMetaModel = oDialog.getModel().getMetaModel(),
                  sActionParameterAnnotationPath = CommonUtils.getParameterPath(oActionContext.getPath(), sParamName) + "@",
                  oParameterAnnotations = oMetaModel.getObject(sActionParameterAnnotationPath),
                  oParameterDefaultValue = oParameterAnnotations && oParameterAnnotations["@com.sap.vocabularies.UI.v1.ParameterDefaultValue"]; // either { $Path: 'somePath' } or 'someString'
                return oParameterDefaultValue;
              };
              const aCurrentParamDefaultValue = [];
              let sParamName, vParameterDefaultValue;
              for (const i in aActionParameters) {
                sParamName = aActionParameters[i].$Name;
                vParameterDefaultValue = getParameterDefaultValue(sParamName);
                aCurrentParamDefaultValue.push(prefillParameter(sParamName, vParameterDefaultValue));
              }
              if (oActionContext.getObject("$IsBound") && aContexts.length > 0) {
                if (sBoundFunctionName && sBoundFunctionName.length > 0 && typeof sBoundFunctionName === "string") {
                  for (const i in aContexts) {
                    aFunctionParams.push(callBoundFunction(sBoundFunctionName, aContexts[i], mParameters.model));
                  }
                }
              }
              const aPrefillParamPromises = Promise.all(aCurrentParamDefaultValue);
              let aExecFunctionPromises = Promise.resolve([]);
              let oExecFunctionFromManifestPromise;
              if (aFunctionParams && aFunctionParams.length > 0) {
                aExecFunctionPromises = Promise.all(aFunctionParams);
              }
              if (mParameters.defaultValuesExtensionFunction) {
                const sModule = mParameters.defaultValuesExtensionFunction.substring(0, mParameters.defaultValuesExtensionFunction.lastIndexOf(".") || -1).replace(/\./gi, "/"),
                  sFunctionName = mParameters.defaultValuesExtensionFunction.substring(mParameters.defaultValuesExtensionFunction.lastIndexOf(".") + 1, mParameters.defaultValuesExtensionFunction.length);
                oExecFunctionFromManifestPromise = FPMHelper.actionWrapper(oCloneEvent, sModule, sFunctionName, {
                  contexts: aContexts
                });
              }
              try {
                const aPromises = await Promise.all([aPrefillParamPromises, aExecFunctionPromises, oExecFunctionFromManifestPromise]);
                const currentParamDefaultValue = aPromises[0];
                const functionParams = aPromises[1];
                const oFunctionParamsFromManifest = aPromises[2];
                let sDialogParamName;

                // Fill the dialog with the earlier determined parameter values from the different sources
                for (const i in aActionParameters) {
                  var _aParameterValues$fin2;
                  sDialogParamName = aActionParameters[i].$Name;
                  // Parameter values provided in the call of invokeAction overrule other sources
                  const vParameterProvidedValue = aParameterValues === null || aParameterValues === void 0 ? void 0 : (_aParameterValues$fin2 = aParameterValues.find(element => element.name === aActionParameters[i].$Name)) === null || _aParameterValues$fin2 === void 0 ? void 0 : _aParameterValues$fin2.value;
                  if (vParameterProvidedValue) {
                    oOperationBinding.setParameter(aActionParameters[i].$Name, vParameterProvidedValue);
                  } else if (oFunctionParamsFromManifest && oFunctionParamsFromManifest.hasOwnProperty(sDialogParamName)) {
                    oOperationBinding.setParameter(aActionParameters[i].$Name, oFunctionParamsFromManifest[sDialogParamName]);
                  } else if (currentParamDefaultValue[i] && currentParamDefaultValue[i].value !== undefined) {
                    oOperationBinding.setParameter(aActionParameters[i].$Name, currentParamDefaultValue[i].value);
                    // if the default value had not been previously determined due to different contexts, we do nothing else
                  } else if (sBoundFunctionName && !currentParamDefaultValue[i].bNoPossibleValue) {
                    if (aContexts.length > 1) {
                      // we check if the function retrieves the same param value for all the contexts:
                      let j = 0;
                      while (j < aContexts.length - 1) {
                        if (functionParams[j] && functionParams[j + 1] && functionParams[j].getObject(sDialogParamName) === functionParams[j + 1].getObject(sDialogParamName)) {
                          j++;
                        } else {
                          break;
                        }
                      }
                      //param values are all the same:
                      if (j === aContexts.length - 1) {
                        oOperationBinding.setParameter(aActionParameters[i].$Name, functionParams[j].getObject(sDialogParamName));
                      }
                    } else if (functionParams[0] && functionParams[0].getObject(sDialogParamName)) {
                      //Only one context, then the default param values are to be verified from the function:

                      oOperationBinding.setParameter(aActionParameters[i].$Name, functionParams[0].getObject(sDialogParamName));
                    }
                  }
                }
                const bErrorFound = currentParamDefaultValue.some(function (oValue) {
                  if (oValue.bLatePropertyError) {
                    return oValue.bLatePropertyError;
                  }
                });
                // If at least one Default Property is a Late Property and an eTag error was raised.
                if (bErrorFound) {
                  const sText = CommonUtils.getTranslatedText("C_APP_COMPONENT_SAPFE_ETAG_LATE_PROPERTY", oResourceBundle);
                  MessageBox.warning(sText, {
                    contentWidth: "25em"
                  });
                }
              } catch (oError) {
                Log.error("Error while retrieving the parameter", oError);
              }
            };
            const fnAsyncBeforeOpen = async function () {
              if (oActionContext.getObject("$IsBound") && aContexts.length > 0) {
                const aParameters = oActionContext.getObject("$Parameter");
                const sBindingParameter = aParameters[0] && aParameters[0].$Name;
                try {
                  const oContextObject = await aContexts[0].requestObject();
                  if (oContextObject) {
                    oOperationBinding.setParameter(sBindingParameter, oContextObject);
                  }
                  await fnSetDefaultsAndOpenDialog(sBindingParameter);
                } catch (oError) {
                  Log.error("Error while retrieving the parameter", oError);
                }
              } else {
                await fnSetDefaultsAndOpenDialog();
              }
            };
            await fnAsyncBeforeOpen();

            // adding defaulted values only here after they are not set to the fields
            for (const actionParameterInfo of actionParameterInfos) {
              const value = actionParameterInfo.isMultiValue ? actionParameterInfo.field.getItems() : actionParameterInfo.field.getValue();
              actionParameterInfo.value = value;
              actionParameterInfo.validationPromise = Promise.resolve(value);
            }
          },
          afterClose: function () {
            // when the dialog is cancelled, messages need to be removed in case the same action should be executed again
            aActionParameters.forEach(_removeMessagesForActionParamter);
            oDialog.destroy();
            if (actionResult.dialogCancelled) {
              reject(Constants.CancelActionDialog);
            } else {
              resolve(actionResult.result);
            }
          }
        });
        mParameters.oDialog = oDialog;
        oDialog.setModel(oActionContext.getModel().oModel);
        oDialog.setModel(oParameterModel, "paramsModel");
        oDialog.bindElement({
          path: "/",
          model: "paramsModel"
        });

        // empty model to add elements dynamically depending on number of MVF fields defined on the dialog
        const oMVFModel = new JSONModel({});
        oDialog.setModel(oMVFModel, "mvfview");

        /* Event needed for removing messages of valid changed field */
        for (const actionParameterInfo of actionParameterInfos) {
          if (actionParameterInfo.isMultiValue) {
            var _actionParameterInfo$2, _actionParameterInfo$3;
            actionParameterInfo === null || actionParameterInfo === void 0 ? void 0 : (_actionParameterInfo$2 = actionParameterInfo.field) === null || _actionParameterInfo$2 === void 0 ? void 0 : (_actionParameterInfo$3 = _actionParameterInfo$2.getBinding("items")) === null || _actionParameterInfo$3 === void 0 ? void 0 : _actionParameterInfo$3.attachChange(() => {
              _removeMessagesForActionParamter(actionParameterInfo.parameter);
            });
          } else {
            var _actionParameterInfo$4, _actionParameterInfo$5;
            actionParameterInfo === null || actionParameterInfo === void 0 ? void 0 : (_actionParameterInfo$4 = actionParameterInfo.field) === null || _actionParameterInfo$4 === void 0 ? void 0 : (_actionParameterInfo$5 = _actionParameterInfo$4.getBinding("value")) === null || _actionParameterInfo$5 === void 0 ? void 0 : _actionParameterInfo$5.attachChange(() => {
              _removeMessagesForActionParamter(actionParameterInfo.parameter);
            });
          }
        }
        let sActionPath = `${sActionName}(...)`;
        if (!aContexts.length) {
          sActionPath = `/${sActionPath}`;
        }
        oDialog.bindElement({
          path: sActionPath
        });
        if (oParentControl) {
          // if there is a parent control specified add the dialog as dependent
          oParentControl.addDependent(oDialog);
        }
        if (aContexts.length > 0) {
          oDialog.setBindingContext(aContexts[0]); // use context of first selected line item
        }

        oOperationBinding = oDialog.getObjectBinding();
        oDialog.open();
      } catch (oError) {
        reject(oError);
      }
    });
  }
  function getActionParameters(oAction) {
    const aParameters = oAction.getObject("$Parameter") || [];
    if (aParameters && aParameters.length) {
      if (oAction.getObject("$IsBound")) {
        //in case of bound actions, ignore the first parameter and consider the rest
        return aParameters.slice(1, aParameters.length) || [];
      }
    }
    return aParameters;
  }
  function getIsActionCritical(oMetaModel, sPath, contexts, oBoundAction) {
    const vActionCritical = oMetaModel.getObject(`${sPath}@com.sap.vocabularies.Common.v1.IsActionCritical`);
    let sCriticalPath = vActionCritical && vActionCritical.$Path;
    if (!sCriticalPath) {
      // the static value scenario for isActionCritical
      return !!vActionCritical;
    }
    const aBindingParams = oBoundAction && oBoundAction.getObject("$Parameter"),
      aPaths = sCriticalPath && sCriticalPath.split("/"),
      bCondition = aBindingParams && aBindingParams.length && typeof aBindingParams === "object" && sCriticalPath && contexts && contexts.length;
    if (bCondition) {
      //in case binding patameters are there in path need to remove eg: - _it/isVerified => need to remove _it and the path should be isVerified
      aBindingParams.filter(function (oParams) {
        const index = aPaths && aPaths.indexOf(oParams.$Name);
        if (index > -1) {
          aPaths.splice(index, 1);
        }
      });
      sCriticalPath = aPaths.join("/");
      return contexts[0].getObject(sCriticalPath);
    } else if (sCriticalPath) {
      //if scenario is path based return the path value
      return contexts[0].getObject(sCriticalPath);
    }
  }
  function _getActionParameterActionName(oResourceBundle, sActionLabel, sActionName, sEntitySetName) {
    let boundActionName = sActionName ? sActionName : null;
    const aActionName = boundActionName.split(".");
    boundActionName = boundActionName.indexOf(".") >= 0 ? aActionName[aActionName.length - 1] : boundActionName;
    const suffixResourceKey = boundActionName && sEntitySetName ? `${sEntitySetName}|${boundActionName}` : "";
    const sKey = "ACTION_PARAMETER_DIALOG_ACTION_NAME";
    const bResourceKeyExists = oResourceBundle && CommonUtils.checkIfResourceKeyExists(oResourceBundle.aCustomBundles, `${sKey}|${suffixResourceKey}`);
    if (sActionLabel) {
      if (bResourceKeyExists) {
        return CommonUtils.getTranslatedText(sKey, oResourceBundle, undefined, suffixResourceKey);
      } else if (oResourceBundle && CommonUtils.checkIfResourceKeyExists(oResourceBundle.aCustomBundles, `${sKey}|${sEntitySetName}`)) {
        return CommonUtils.getTranslatedText(sKey, oResourceBundle, undefined, `${sEntitySetName}`);
      } else if (oResourceBundle && CommonUtils.checkIfResourceKeyExists(oResourceBundle.aCustomBundles, `${sKey}`)) {
        return CommonUtils.getTranslatedText(sKey, oResourceBundle);
      } else {
        return sActionLabel;
      }
    } else {
      return CommonUtils.getTranslatedText("C_COMMON_DIALOG_OK", oResourceBundle);
    }
  }
  function handle412FailedTransitions(mParameters, oAction, sGroupId, current_context_index, iContextLength, messageHandler, oResourceBundle, strictHandlingUtilities) {
    let strictHandlingFails;
    const messages = sap.ui.getCore().getMessageManager().getMessageModel().getData();
    const transitionMessages = messages.filter(function (message) {
      const isDuplicate = strictHandlingUtilities.processedMessageIds.find(function (id) {
        return message.id === id;
      });
      if (!isDuplicate) {
        strictHandlingUtilities.processedMessageIds.push(message.id);
        if (message.type === MessageType.Success) {
          strictHandlingUtilities.delaySuccessMessages.push(message);
        }
      }
      return message.persistent === true && message.type !== MessageType.Success && !isDuplicate;
    });
    if (transitionMessages.length) {
      if (mParameters.internalModelContext) {
        strictHandlingFails = strictHandlingUtilities.strictHandlingTransitionFails;
        strictHandlingFails.push({
          oAction: oAction,
          groupId: sGroupId
        });
        strictHandlingUtilities.strictHandlingTransitionFails = strictHandlingFails;
      }
    }
    if (current_context_index === iContextLength && strictHandlingUtilities && strictHandlingUtilities.strictHandlingWarningMessages.length) {
      operationsHelper.renderMessageView(mParameters, oResourceBundle, messageHandler, strictHandlingUtilities.strictHandlingWarningMessages, strictHandlingUtilities, true);
    }
  }
  function executeDependingOnSelectedContexts(oAction, mParameters, bGetBoundContext, sGroupId, oResourceBundle, messageHandler, iContextLength, current_context_index, strictHandlingUtilities) {
    let oActionPromise,
      bEnableStrictHandling = true;
    if (bGetBoundContext) {
      var _oProperty$;
      const sPath = oAction.getBoundContext().getPath();
      const sMetaPath = oAction.getModel().getMetaModel().getMetaPath(sPath);
      const oProperty = oAction.getModel().getMetaModel().getObject(sMetaPath);
      if (oProperty && ((_oProperty$ = oProperty[0]) === null || _oProperty$ === void 0 ? void 0 : _oProperty$.$kind) !== "Action") {
        //do not enable the strict handling if its not an action
        bEnableStrictHandling = false;
      }
    }
    if (!bEnableStrictHandling) {
      oActionPromise = bGetBoundContext ? oAction.execute(sGroupId).then(function () {
        return oAction.getBoundContext();
      }) : oAction.execute(sGroupId);
    } else {
      oActionPromise = bGetBoundContext ? oAction.execute(sGroupId, undefined, operationsHelper.fnOnStrictHandlingFailed.bind(operations, sGroupId, mParameters, oResourceBundle, current_context_index, oAction.getContext(), iContextLength, messageHandler, strictHandlingUtilities)).then(function () {
        if (strictHandlingUtilities) {
          handle412FailedTransitions(mParameters, oAction, sGroupId, current_context_index, iContextLength, messageHandler, oResourceBundle, strictHandlingUtilities);
        }
        return Promise.resolve(oAction.getBoundContext());
      }).catch(function () {
        if (strictHandlingUtilities) {
          handle412FailedTransitions(mParameters, oAction, sGroupId, current_context_index, iContextLength, messageHandler, oResourceBundle, strictHandlingUtilities);
        }
        return Promise.reject();
      }) : oAction.execute(sGroupId, undefined, operationsHelper.fnOnStrictHandlingFailed.bind(operations, sGroupId, mParameters, oResourceBundle, current_context_index, oAction.getContext(), iContextLength, messageHandler, strictHandlingUtilities)).then(function (result) {
        if (strictHandlingUtilities) {
          handle412FailedTransitions(mParameters, oAction, sGroupId, current_context_index, iContextLength, messageHandler, oResourceBundle, strictHandlingUtilities);
        }
        return Promise.resolve(result);
      }).catch(function () {
        if (strictHandlingUtilities) {
          handle412FailedTransitions(mParameters, oAction, sGroupId, current_context_index, iContextLength, messageHandler, oResourceBundle, strictHandlingUtilities);
        }
        return Promise.reject();
      });
    }
    return oActionPromise.catch(() => {
      throw Constants.ActionExecutionFailed;
    });
  }
  function _executeAction(oAppComponent, mParameters, oParentControl, messageHandler, strictHandlingUtilities) {
    const aContexts = mParameters.aContexts || [];
    const oModel = mParameters.model;
    const aActionParameters = mParameters.aActionParameters || [];
    const sActionName = mParameters.actionName;
    const fnOnSubmitted = mParameters.fnOnSubmitted;
    const fnOnResponse = mParameters.fnOnResponse;
    const oResourceBundle = oParentControl && oParentControl.isA("sap.ui.core.mvc.View") && oParentControl.getController().oResourceBundle;
    let oAction;
    function setActionParameterDefaultValue() {
      if (aActionParameters && aActionParameters.length) {
        for (let j = 0; j < aActionParameters.length; j++) {
          if (!aActionParameters[j].value) {
            switch (aActionParameters[j].$Type) {
              case "Edm.String":
                aActionParameters[j].value = "";
                break;
              case "Edm.Boolean":
                aActionParameters[j].value = false;
                break;
              case "Edm.Byte":
              case "Edm.Int16":
              case "Edm.Int32":
              case "Edm.Int64":
                aActionParameters[j].value = 0;
                break;
              // tbc
              default:
                break;
            }
          }
          oAction.setParameter(aActionParameters[j].$Name, aActionParameters[j].value);
        }
      }
    }
    if (aContexts.length) {
      // TODO: refactor to direct use of Promise.allSettled
      return new Promise(function (resolve) {
        const mBindingParameters = mParameters.mBindingParameters;
        const bGrouped = mParameters.bGrouped;
        const bGetBoundContext = mParameters.bGetBoundContext;
        const aActionPromises = [];
        let oActionPromise;
        let i;
        let sGroupId;
        const fnExecuteAction = function (actionContext, current_context_index, oSideEffect, iContextLength) {
          setActionParameterDefaultValue();
          // For invocation grouping "isolated" need batch group per action call
          sGroupId = !bGrouped ? `$auto.${current_context_index}` : actionContext.getUpdateGroupId();
          mParameters.requestSideEffects = fnRequestSideEffects.bind(operations, oAppComponent, oSideEffect, mParameters);
          oActionPromise = executeDependingOnSelectedContexts(actionContext, mParameters, bGetBoundContext, sGroupId, oResourceBundle, messageHandler, iContextLength, current_context_index, strictHandlingUtilities);
          aActionPromises.push(oActionPromise);
          fnRequestSideEffects(oAppComponent, oSideEffect, mParameters, sGroupId);
        };
        const fnExecuteSingleAction = function (actionContext, current_context_index, oSideEffect, iContextLength) {
          const aLocalPromise = [];
          setActionParameterDefaultValue();
          // For invocation grouping "isolated" need batch group per action call
          sGroupId = `apiMode${current_context_index}`;
          mParameters.requestSideEffects = fnRequestSideEffects.bind(operations, oAppComponent, oSideEffect, mParameters, sGroupId, aLocalPromise);
          oActionPromise = executeDependingOnSelectedContexts(actionContext, mParameters, bGetBoundContext, sGroupId, oResourceBundle, messageHandler, iContextLength, current_context_index, strictHandlingUtilities);
          aActionPromises.push(oActionPromise);
          aLocalPromise.push(oActionPromise);
          fnRequestSideEffects(oAppComponent, oSideEffect, mParameters, sGroupId, aLocalPromise);
          oModel.submitBatch(sGroupId);
          return Promise.allSettled(aLocalPromise);
        };
        async function fnExecuteSequentially(contextsToExecute) {
          // One action and its side effects are completed before the next action is executed
          (fnOnSubmitted || function noop() {
            /**/
          })(aActionPromises);
          function processOneAction(context, actionIndex, iContextLength) {
            oAction = oModel.bindContext(`${sActionName}(...)`, context, mBindingParameters);
            return fnExecuteSingleAction(oAction, actionIndex, {
              context: context,
              pathExpressions: mParameters.additionalSideEffect && mParameters.additionalSideEffect.pathExpressions,
              triggerActions: mParameters.additionalSideEffect && mParameters.additionalSideEffect.triggerActions
            }, iContextLength);
          }

          // serialization: processOneAction to be called for each entry in contextsToExecute only after the promise returned from the one before has been resolved
          await contextsToExecute.reduce(async (promise, context, id) => {
            await promise;
            await processOneAction(context, id + 1, aContexts.length);
          }, Promise.resolve());
          fnHandleResults();
        }
        if (!bGrouped) {
          // For invocation grouping "isolated", ensure that each action and matching side effects
          // are processed before the next set is submitted. Workaround until JSON batch is available.
          // Allow also for List Report.
          fnExecuteSequentially(aContexts);
        } else {
          for (i = 0; i < aContexts.length; i++) {
            oAction = oModel.bindContext(`${sActionName}(...)`, aContexts[i], mBindingParameters);
            fnExecuteAction(oAction, aContexts.length <= 1 ? null : i, {
              context: aContexts[i],
              pathExpressions: mParameters.additionalSideEffect && mParameters.additionalSideEffect.pathExpressions,
              triggerActions: mParameters.additionalSideEffect && mParameters.additionalSideEffect.triggerActions
            }, aContexts.length);
          }
          (fnOnSubmitted || function noop() {
            /**/
          })(aActionPromises);
          fnHandleResults();
        }
        function fnHandleResults() {
          // Promise.allSettled will never be rejected. However, eslint requires either catch or return - thus we return the resulting Promise although no one will use it.
          return Promise.allSettled(aActionPromises).then(resolve);
        }
      }).finally(function () {
        (fnOnResponse || function noop() {
          /**/
        })();
      });
    } else {
      oAction = oModel.bindContext(`/${sActionName}(...)`);
      setActionParameterDefaultValue();
      const sGroupId = "actionImport";
      const oActionPromise = oAction.execute(sGroupId, undefined, operationsHelper.fnOnStrictHandlingFailed.bind(operations, sGroupId, {
        label: mParameters.label,
        model: oModel
      }, oResourceBundle, null, null, null, messageHandler, strictHandlingUtilities));
      oModel.submitBatch(sGroupId);
      // trigger onSubmitted "event"
      (fnOnSubmitted || function noop() {
        /**/
      })(oActionPromise);
      return oActionPromise.then(function (currentPromiseValue) {
        // Here we ensure that we return the response we got from an unbound action to the
        // caller BCP : 2270139279
        if (currentPromiseValue) {
          return currentPromiseValue;
        } else {
          var _oAction$getBoundCont, _oAction, _oAction$getBoundCont2;
          return (_oAction$getBoundCont = (_oAction = oAction).getBoundContext) === null || _oAction$getBoundCont === void 0 ? void 0 : (_oAction$getBoundCont2 = _oAction$getBoundCont.call(_oAction)) === null || _oAction$getBoundCont2 === void 0 ? void 0 : _oAction$getBoundCont2.getObject();
        }
      }).catch(function (oError) {
        Log.error("Error while executing action " + sActionName, oError);
        throw oError;
      }).finally(function () {
        (fnOnResponse || function noop() {
          /**/
        })();
      });
    }
  }
  function _getPath(oActionContext, sActionName) {
    let sPath = oActionContext.getPath();
    sPath = oActionContext.getObject("$IsBound") ? sPath.split("@$ui5.overload")[0] : sPath.split("/0")[0];
    return sPath.split(`/${sActionName}`)[0];
  }
  function _valuesProvidedForAllParameters(isCreateAction, actionParameters, parameterValues, startupParameters) {
    if (parameterValues) {
      // If showDialog is false but there are parameters from the invokeAction call, we need to check that values have been
      // provided for all of them
      for (const actionParameter of actionParameters) {
        if (actionParameter.$Name !== "ResultIsActiveEntity" && !(parameterValues !== null && parameterValues !== void 0 && parameterValues.find(element => element.name === actionParameter.$Name))) {
          // At least for one parameter no value has been provided, so we can't skip the dialog
          return false;
        }
      }
    } else if (isCreateAction && startupParameters) {
      // If parameters have been provided during application launch, we need to check if the set is complete
      // If not, the parameter dialog still needs to be shown.
      for (const actionParameter of actionParameters) {
        if (!startupParameters[actionParameter.$Name]) {
          // At least for one parameter no value has been provided, so we can't skip the dialog
          return false;
        }
      }
    }
    return true;
  }
  function fnRequestSideEffects(oAppComponent, oSideEffect, mParameters, sGroupId, aLocalPromise) {
    const oSideEffectsService = oAppComponent.getSideEffectsService();
    let oLocalPromise;
    // trigger actions from side effects
    if (oSideEffect && oSideEffect.triggerActions && oSideEffect.triggerActions.length) {
      oSideEffect.triggerActions.forEach(function (sTriggerAction) {
        if (sTriggerAction) {
          oLocalPromise = oSideEffectsService.executeAction(sTriggerAction, oSideEffect.context, sGroupId);
          if (aLocalPromise) {
            aLocalPromise.push(oLocalPromise);
          }
        }
      });
    }
    // request side effects for this action
    // as we move the messages request to POST $select we need to be prepared for an empty array
    if (oSideEffect && oSideEffect.pathExpressions && oSideEffect.pathExpressions.length > 0) {
      oLocalPromise = oSideEffectsService.requestSideEffects(oSideEffect.pathExpressions, oSideEffect.context, sGroupId);
      if (aLocalPromise) {
        aLocalPromise.push(oLocalPromise);
      }
      oLocalPromise.then(function () {
        if (mParameters.operationAvailableMap && mParameters.internalModelContext) {
          ActionRuntime.setActionEnablement(mParameters.internalModelContext, JSON.parse(mParameters.operationAvailableMap), mParameters.selectedItems, "table");
        }
      }).catch(function (oError) {
        Log.error("Error while requesting side effects", oError);
      });
    }
  }

  /**
   * Static functions to call OData actions (bound/import) and functions (bound/import)
   *
   * @namespace
   * @alias sap.fe.core.actions.operations
   * @private
   * @experimental This module is only for experimental use! <br/><b>This is only a POC and maybe deleted</b>
   * @since 1.56.0
   */
  const operations = {
    callBoundAction: callBoundAction,
    callActionImport: callActionImport,
    callBoundFunction: callBoundFunction,
    callFunctionImport: callFunctionImport,
    executeDependingOnSelectedContexts: executeDependingOnSelectedContexts,
    valuesProvidedForAllParameters: _valuesProvidedForAllParameters,
    getActionParameterActionName: _getActionParameterActionName,
    actionParameterShowMessageCallback: actionParameterShowMessageCallback,
    afterActionResolution: afterActionResolution
  };
  return operations;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/operations", ["sap/base/Log","sap/fe/core/ActionRuntime","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/controllerextensions/messageHandler/messageHandling","sap/fe/core/helpers/FPMHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/library","sap/m/Button","sap/m/Dialog","sap/m/MessageBox","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/library","sap/ui/core/message/Message","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/model/json/JSONModel","../../operationsHelper"],function(e,t,n,a,i,s,o,r,l,c,u,d,g,f,m,p,h,M,P){"use strict";var x=f.MessageType;var v=o.generate;const b=r.Constants,C=r.InvocationGrouping;const E=u.Action;function A(e,t,n,a,i,s){if(!s){s={is412Executed:false,strictHandlingTransitionFails:[],strictHandlingPromises:[],strictHandlingWarningMessages:[],delaySuccessMessages:[],processedMessageIds:[]}}if(!t||t.length===0){return Promise.reject("Bound actions always requires at least one context")}const o=Array.isArray(t);i.aContexts=o?t:[t];const r=n.getMetaModel(),l=`${r.getMetaPath(i.aContexts[0].getPath())}/${e}`,c=r.createBindingContext(`${l}/@$ui5.overload/0`);i.isCriticalAction=D(r,l,i.aContexts,c);const u=function(e){if(e[0].status==="fulfilled"){return e[0].value}else{throw e[0].reason||e}};return T(e,n,c,a,i,s).then(e=>{if(o){return e}else{return u(e)}},e=>{if(o){throw e}else{return u(e)}})}function $(e,t,n,a,i){if(!t){return Promise.reject("Action expects a model/context for execution")}const s=t.getMetaModel(),o=t.bindContext(`/${e}`).getPath(),r=s.createBindingContext(`/${s.createBindingContext(o).getObject("$Action")}/0`);a.isCriticalAction=D(s,`${o}/@$ui5.overload`);return T(e,t,r,n,a,i)}function O(e,t,n){if(!t){return Promise.reject("Bound functions always requires a context")}const a=n.getMetaModel(),i=`${a.getMetaPath(t.getPath())}/${e}`,s=a.createBindingContext(i);return S(e,n,s,t)}function y(e,t){if(!e){return Promise.resolve()}const n=t.getMetaModel(),a=t.bindContext(`/${e}`).getPath(),i=n.createBindingContext(`/${n.createBindingContext(a).getObject("$Function")}/0`);return S(e,t,i)}function S(e,t,n,a){let i;if(!n||!n.getObject()){return Promise.reject(new Error(`Function ${e} not found`))}if(a){n=t.bindContext(`${e}(...)`,a);i="functionGroup"}else{n=t.bindContext(`/${e}(...)`);i="functionImport"}const s=n.execute(i);t.submitBatch(i);return s.then(function(){return n.getBoundContext()})}function T(e,t,n,a,i,s){return new Promise(async function(o,r){let l={};let c;let u;const g=i.label;const f=i.skipParameterDialog;const m=i.aContexts;const p=i.bIsCreateAction;const h=i.isCriticalAction;let M;let P;let x;let v;let b;let E;let A;const $=n.getObject();if(!n||!n.getObject()){return r(new Error(`Action ${e} not found`))}const O=_(n);const y=O.length>0&&!(O.length===1&&O[0].$Name==="ResultIsActiveEntity");const S=i.parameterValues;const T=a.getComponentData();const I=T&&T.startupParameters||{};if(y&&f){A=k(p,O,S,I)}c=null;if(y){if(!(f&&A)){c=j}}else if(h){c=w}l={fnOnSubmitted:i.onSubmitted,fnOnResponse:i.onResponse,actionName:e,model:t,aActionParameters:O,bGetBoundContext:i.bGetBoundContext,defaultValuesExtensionFunction:i.defaultValuesExtensionFunction,label:i.label,selectedItems:i.selectedItems};if(n.getObject("$IsBound")){if(i.additionalSideEffect&&i.additionalSideEffect.pathExpressions){M=t.getMetaModel();P=M.getMetaPath(m[0].getPath());x=M.getObject(`${P}/@com.sap.vocabularies.Common.v1.Messages/$Path`);if(x){v=i.additionalSideEffect.pathExpressions.findIndex(function(e){return typeof e==="string"&&e===x});E=n.getObject("$ReturnType");b=E&&!E.$isCollection&&n.getModel().getObject(P).$Type===E.$Type;if(v>-1||b){i.mBindingParameters=i.mBindingParameters||{};if(n.getObject(`$ReturnType/$Type/${x}`)&&(!i.mBindingParameters.$select||i.mBindingParameters.$select.split(",").indexOf(x)===-1)){i.mBindingParameters.$select=i.mBindingParameters.$select?`${i.mBindingParameters.$select},${x}`:x;if(v===-1){i.additionalSideEffect.pathExpressions.push("*")}if(i.additionalSideEffect.triggerActions.length===0&&v>-1){i.additionalSideEffect.pathExpressions.splice(v,1)}}}}}l.aContexts=m;l.mBindingParameters=i.mBindingParameters;l.additionalSideEffect=i.additionalSideEffect;l.bGrouped=i.invocationGrouping===C.ChangeSet;l.internalModelContext=i.internalModelContext;l.operationAvailableMap=i.operationAvailableMap;l.isCreateAction=p;l.bObjectPage=i.bObjectPage;if(i.controlId){l.control=i.parentControl.byId(i.controlId)}else{l.control=i.parentControl}}if(p){l.bIsCreateAction=p}const B=($.$Parameter||[]).some(e=>($.$EntitySetPath&&$.$EntitySetPath===e.$Name||$.$IsBound)&&e.$isCollection);l.isStatic=B;if(c){u=c(e,a,g,l,O,S,n,i.parentControl,i.entitySetName,i.messageHandler,s);return u.then(function(e){N(i,l,$);o(e)}).catch(function(e){r(e)})}else{if(S){for(const e in l.aActionParameters){var D;l.aActionParameters[e].value=S===null||S===void 0?void 0:(D=S.find(t=>t.name===l.aActionParameters[e].$Name))===null||D===void 0?void 0:D.value}}else{for(const e in l.aActionParameters){var F;l.aActionParameters[e].value=(F=I[l.aActionParameters[e].$Name])===null||F===void 0?void 0:F[0]}}let e;try{e=await V(a,l,i.parentControl,i.messageHandler,s);const t=d.getMessageManager().getMessageModel().getData();if(s&&s.is412Executed&&s.strictHandlingTransitionFails.length){s.delaySuccessMessages=s.delaySuccessMessages.concat(t)}N(i,l,$);o(e)}catch{r(e)}finally{var H,R;if(s&&s.is412Executed&&s.strictHandlingTransitionFails.length){try{const e=s.strictHandlingTransitionFails;const t=[];e.forEach(function(e){t.push(e.oAction.getContext())});l.aContexts=t;const n=await V(a,l,i.parentControl,i.messageHandler,s);s.strictHandlingTransitionFails=[];d.getMessageManager().addMessages(s.delaySuccessMessages);N(i,l,$);o(n)}catch(e){r(e)}}i===null||i===void 0?void 0:(H=i.messageHandler)===null||H===void 0?void 0:H.showMessageDialog({control:(R=l)===null||R===void 0?void 0:R.control});if(s){s={is412Executed:false,strictHandlingTransitionFails:[],strictHandlingPromises:[],strictHandlingWarningMessages:[],delaySuccessMessages:[],processedMessageIds:[]}}}}})}function w(e,t,a,i,s,o,r,l,c,d){return new Promise((a,s)=>{let o=e?e:null;o=o.indexOf(".")>=0?o.split(".")[o.split(".").length-1]:o;const r=o&&c?`${c}|${o}`:"";const g=l.getController().oResourceBundle;const f=n.getTranslatedText("C_OPERATIONS_ACTION_CONFIRM_MESSAGE",g,undefined,r);u.confirm(f,{onClose:async function(e){if(e===E.OK){try{const e=await V(t,i,l,d);a(e)}catch(e){try{await d.showMessageDialog();s(e)}catch(t){s(e)}}}else{a()}}})})}async function I(e,t,n,a,i,s,o,r){var l;const c=await V(e,t,n,a,r);if((l=t.aContexts)!==null&&l!==void 0&&l.length){if(c!==null&&c!==void 0&&c.some(e=>e.status==="rejected")){throw c}}const u=d.getMessageManager().getMessageModel().getData();if(r&&r.is412Executed&&r.strictHandlingTransitionFails.length){if(!o){r.delaySuccessMessages=r.delaySuccessMessages.concat(u)}else{d.getMessageManager().addMessages(r.delaySuccessMessages);if(u.length){a.showMessageDialog({onBeforeShowMessage:function(e,n){return B(t,i,s,e,n)},control:t.control})}}}else if(u.length){a.showMessageDialog({isActionParameterDialogOpen:t===null||t===void 0?void 0:t.oDialog.isOpen(),onBeforeShowMessage:function(e,n){return B(t,i,s,e,n)},control:t.control})}return c}function N(e,n,a){if(n.internalModelContext&&n.operationAvailableMap&&n.aContexts&&n.aContexts.length&&a.$IsBound){const a=n.isStatic;if(!a){t.setActionEnablement(n.internalModelContext,JSON.parse(n.operationAvailableMap),e.selectedItems,"table")}else if(n.control){const e=n.control;if(e.isA("sap.ui.mdc.Table")){const a=e.getSelectedContexts();t.setActionEnablement(n.internalModelContext,JSON.parse(n.operationAvailableMap),a,"table")}}}}function B(e,t,n,a,s){let o=s.showMessageBox,r=s.showMessageDialog;const l=e.control;const c=a.filter(function(e){return e.getTarget()===""});const u=a.filter(function(t){return t.getTarget&&t.getTarget().indexOf(e.actionName)!==-1&&e.aActionParameters.some(function(e){return t.getTarget().indexOf(e.$Name)!==-1})});u.forEach(function(e){e.isAPDTarget=true});const d=u.length?true:false;if(n.isOpen()&&t.length!==0&&!e.isStatic){if(!e.bGrouped){if(t.length>1||!d){n.close();n.destroy()}}else if(!d){n.close();n.destroy()}}let g=[];const f=n.isOpen();if(a.length===1&&a[0].getTarget&&a[0].getTarget()!==undefined&&a[0].getTarget()!==""){if(l&&l.getModel("ui").getProperty("/isEditable")===false||!l){o=!d;r=false}else if(l&&l.getModel("ui").getProperty("/isEditable")===true){o=false;r=false}}else if(l){if(l.getModel("ui").getProperty("/isEditable")===false){if(f&&d){r=false}}else if(l.getModel("ui").getProperty("/isEditable")===true){if(!f&&d){r=true;g=c.concat(u)}else if(!f&&c.length===0){r=false}}}return{showMessageBox:o,showMessageDialog:r,filteredMessages:g.length?g:a,fnGetMessageSubtitle:l&&l.isA("sap.ui.mdc.Table")&&i.setMessageSubtitle.bind({},l,t)}}function j(t,i,o,r,f,P,x,C,E,A,$){const y=G(x,t),S=x.getModel().oModel.getMetaModel(),T=S.createBindingContext(y),w=x.getObject("$IsBound")?x.getPath().split("/@$ui5.overload/0")[0]:x.getPath().split("/0")[0],N=S.createBindingContext(w),j=r.isCreateAction,_="sap/fe/core/controls/ActionParameterDialog";return new Promise(async function(y,S){let w;const D=d.getMessageManager();const H=e=>{D.addMessages(e.map(e=>{const t=e.actionParameterInfo.field.getBinding(e.actionParameterInfo.isMultiValue?"items":"value");return new m({message:e.message,type:"Error",processor:t===null||t===void 0?void 0:t.getModel(),persistent:true,target:t===null||t===void 0?void 0:t.getResolvedPath()})}))};const R=e=>{const t=D.getMessageModel().getData();const n=v(["APD_",e.$Name]);const a=t.filter(e=>e.getControlIds().some(e=>n.split("-").includes(e)));D.removeMessages(a)};const V=async function(e){const t=w.filter(e=>e.field.getRequired());await Promise.allSettled(t.map(e=>e.validationPromise));const a=t.filter(e=>{if(e.isMultiValue){return e.value===undefined||!e.value.length}else{const t=e.field.getValue();return t===undefined||t===null||t===""}});H(a.map(t=>{var a;return{actionParameterInfo:t,message:n.getTranslatedText("C_OPERATIONS_ACTION_PARAMETER_DIALOG_MISSING_MANDATORY_MSG",e,[((a=t.field.getParent())===null||a===void 0?void 0:a.getAggregation("label")).getText()])}}));const i=w.find(e=>e.field.getValueState()==="Error"||a.includes(e));if(i){i.field.focus();return false}else{return true}};const G={handleChange:async function(e){const t=e.getSource();const n=w.find(e=>e.field===t);R(n.parameter);n.validationPromise=e.getParameter("promise");try{n.value=await n.validationPromise}catch(e){delete n.value;H([{actionParameterInfo:n,message:e.message}])}}};const k=h.loadTemplate(_,"fragment");const L=new M({$displayMode:{}});try{const m=await p.process(k,{name:_},{bindingContexts:{action:x,actionName:N,entitySet:T},models:{action:x.getModel(),actionName:N.getModel(),entitySet:T.getModel(),metaModel:T.getModel()}});const h=r.aContexts||[];const D=[];let H;await n.setUserDefaults(i,f,L,true);const J=await g.load({definition:m,controller:G});w=f.map(e=>{const t=d.byId(v(["APD_",e.$Name]));const n=t.isA("sap.ui.mdc.MultiValueField");return{parameter:e,field:t,isMultiValue:n}});const X=C.getController().oResourceBundle;let Y={dialogCancelled:true,result:undefined};const z=new c(v(["fe","APD_",t]),{title:o||n.getTranslatedText("C_OPERATIONS_ACTION_PARAMETER_DIALOG_TITLE",X),content:[J],escapeHandler:function(){z.close()},beginButton:new l(v(["fe","APD_",t,"Action","Ok"]),{text:j?n.getTranslatedText("C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE_BUTTON",X):F(X,o,t,E),type:"Emphasized",press:async function(){try{if(!await V(X)){return}a.lock(z);try{A.removeTransitionMessages();let e;const t=H&&H.getParameterContext();for(const n in f){if(f[n].$isCollection){const t=z.getModel("mvfview").getProperty(`/${f[n].$Name}`),a=[];for(const e in t){a.push(t[e].Key)}e=a}else{e=t.getProperty(f[n].$Name)}f[n].value=e;e=undefined}r.label=o;try{const e=await I(i,r,C,A,h,z,false,$);Y={dialogCancelled:false,result:e};z.close()}catch(e){const t=sap.ui.getCore().getMessageManager().getMessageModel().getData();if($&&$.is412Executed&&$.strictHandlingTransitionFails.length){$.delaySuccessMessages=$.delaySuccessMessages.concat(t)}throw e}finally{if($&&$.is412Executed&&$.strictHandlingTransitionFails.length){try{const e=$.strictHandlingTransitionFails;const t=[];e.forEach(function(e){t.push(e.oAction.getContext())});r.aContexts=t;const n=await I(i,r,C,A,h,z,true,$);$.strictHandlingTransitionFails=[];Y={dialogCancelled:false,result:n}}catch{if($&&$.is412Executed&&$.strictHandlingTransitionFails.length){d.getMessageManager().addMessages($.delaySuccessMessages)}await A.showMessageDialog({isActionParameterDialogOpen:z.isOpen(),onBeforeShowMessage:function(e,t){return B(r,h,z,e,t)}})}}if(a.isLocked(z)){a.unlock(z)}}}catch(e){let t=true;await A.showMessages({context:r.aContexts[0],isActionParameterDialogOpen:z.isOpen(),messagePageNavigationCallback:function(){z.close()},onBeforeShowMessage:function(e,n){const a=B(r,h,z,e,n);t=a.showMessageDialog;return a},aSelectedContexts:r.aContexts,sActionName:o,control:r.control});if(t){if(z.isOpen()){}else{S(e)}}}}finally{if($){$={is412Executed:false,strictHandlingTransitionFails:[],strictHandlingPromises:[],strictHandlingWarningMessages:[],delaySuccessMessages:[],processedMessageIds:[]}}if(a.isLocked(z)){a.unlock(z)}}}}),endButton:new l(v(["fe","APD_",t,"Action","Cancel"]),{text:n.getTranslatedText("C_COMMON_ACTION_PARAMETER_DIALOG_CANCEL",X),press:function(){z.close()}}),beforeOpen:async function(t){const a=Object.assign({},t);A.removeTransitionMessages();const i=function(){const e=z.getModel().getMetaModel(),t=x.sPath&&x.sPath.split("/@")[0],n=e.getObject(`${t}@com.sap.vocabularies.Common.v1.DefaultValuesFunction`);return n};const o=async function(t){const o=i();const l=async function(a,i){if(i!==undefined){if(h.length>0&&i.$Path){try{let e=await n.requestSingletonProperty(i.$Path,H.getModel());if(e===null){e=await H.getParameterContext().requestProperty(i.$Path)}if(h.length>1){let n=i.$Path;if(n.indexOf(`${t}/`)===0){n=n.replace(`${t}/`,"")}for(let t=1;t<h.length;t++){if(h[t].getProperty(n)!==e){return{paramName:a,value:undefined,bNoPossibleValue:true}}}}return{paramName:a,value:e}}catch(t){e.error("Error while reading default action parameter",a,r.actionName);return{paramName:a,value:undefined,bLatePropertyError:true}}}else{return{paramName:a,value:i}}}else if(L&&L.oData[a]){return{paramName:a,value:L.oData[a]}}else{return{paramName:a,value:undefined}}};const c=function(e){const t=z.getModel().getMetaModel(),a=n.getParameterPath(x.getPath(),e)+"@",i=t.getObject(a),s=i&&i["@com.sap.vocabularies.UI.v1.ParameterDefaultValue"];return s};const d=[];let g,m;for(const e in f){g=f[e].$Name;m=c(g);d.push(l(g,m))}if(x.getObject("$IsBound")&&h.length>0){if(o&&o.length>0&&typeof o==="string"){for(const e in h){D.push(O(o,h[e],r.model))}}}const p=Promise.all(d);let M=Promise.resolve([]);let v;if(D&&D.length>0){M=Promise.all(D)}if(r.defaultValuesExtensionFunction){const e=r.defaultValuesExtensionFunction.substring(0,r.defaultValuesExtensionFunction.lastIndexOf(".")||-1).replace(/\./gi,"/"),t=r.defaultValuesExtensionFunction.substring(r.defaultValuesExtensionFunction.lastIndexOf(".")+1,r.defaultValuesExtensionFunction.length);v=s.actionWrapper(a,e,t,{contexts:h})}try{const e=await Promise.all([p,M,v]);const t=e[0];const a=e[1];const i=e[2];let s;for(const e in f){var b;s=f[e].$Name;const n=P===null||P===void 0?void 0:(b=P.find(t=>t.name===f[e].$Name))===null||b===void 0?void 0:b.value;if(n){H.setParameter(f[e].$Name,n)}else if(i&&i.hasOwnProperty(s)){H.setParameter(f[e].$Name,i[s])}else if(t[e]&&t[e].value!==undefined){H.setParameter(f[e].$Name,t[e].value)}else if(o&&!t[e].bNoPossibleValue){if(h.length>1){let t=0;while(t<h.length-1){if(a[t]&&a[t+1]&&a[t].getObject(s)===a[t+1].getObject(s)){t++}else{break}}if(t===h.length-1){H.setParameter(f[e].$Name,a[t].getObject(s))}}else if(a[0]&&a[0].getObject(s)){H.setParameter(f[e].$Name,a[0].getObject(s))}}}const r=t.some(function(e){if(e.bLatePropertyError){return e.bLatePropertyError}});if(r){const e=n.getTranslatedText("C_APP_COMPONENT_SAPFE_ETAG_LATE_PROPERTY",X);u.warning(e,{contentWidth:"25em"})}}catch(t){e.error("Error while retrieving the parameter",t)}};const l=async function(){if(x.getObject("$IsBound")&&h.length>0){const t=x.getObject("$Parameter");const n=t[0]&&t[0].$Name;try{const e=await h[0].requestObject();if(e){H.setParameter(n,e)}await o(n)}catch(t){e.error("Error while retrieving the parameter",t)}}else{await o()}};await l();for(const e of w){const t=e.isMultiValue?e.field.getItems():e.field.getValue();e.value=t;e.validationPromise=Promise.resolve(t)}},afterClose:function(){f.forEach(R);z.destroy();if(Y.dialogCancelled){S(b.CancelActionDialog)}else{y(Y.result)}}});r.oDialog=z;z.setModel(x.getModel().oModel);z.setModel(L,"paramsModel");z.bindElement({path:"/",model:"paramsModel"});const Q=new M({});z.setModel(Q,"mvfview");for(const e of w){if(e.isMultiValue){var q,W;e===null||e===void 0?void 0:(q=e.field)===null||q===void 0?void 0:(W=q.getBinding("items"))===null||W===void 0?void 0:W.attachChange(()=>{R(e.parameter)})}else{var K,U;e===null||e===void 0?void 0:(K=e.field)===null||K===void 0?void 0:(U=K.getBinding("value"))===null||U===void 0?void 0:U.attachChange(()=>{R(e.parameter)})}}let Z=`${t}(...)`;if(!h.length){Z=`/${Z}`}z.bindElement({path:Z});if(C){C.addDependent(z)}if(h.length>0){z.setBindingContext(h[0])}H=z.getObjectBinding();z.open()}catch(e){S(e)}})}function _(e){const t=e.getObject("$Parameter")||[];if(t&&t.length){if(e.getObject("$IsBound")){return t.slice(1,t.length)||[]}}return t}function D(e,t,n,a){const i=e.getObject(`${t}@com.sap.vocabularies.Common.v1.IsActionCritical`);let s=i&&i.$Path;if(!s){return!!i}const o=a&&a.getObject("$Parameter"),r=s&&s.split("/"),l=o&&o.length&&typeof o==="object"&&s&&n&&n.length;if(l){o.filter(function(e){const t=r&&r.indexOf(e.$Name);if(t>-1){r.splice(t,1)}});s=r.join("/");return n[0].getObject(s)}else if(s){return n[0].getObject(s)}}function F(e,t,a,i){let s=a?a:null;const o=s.split(".");s=s.indexOf(".")>=0?o[o.length-1]:s;const r=s&&i?`${i}|${s}`:"";const l="ACTION_PARAMETER_DIALOG_ACTION_NAME";const c=e&&n.checkIfResourceKeyExists(e.aCustomBundles,`${l}|${r}`);if(t){if(c){return n.getTranslatedText(l,e,undefined,r)}else if(e&&n.checkIfResourceKeyExists(e.aCustomBundles,`${l}|${i}`)){return n.getTranslatedText(l,e,undefined,`${i}`)}else if(e&&n.checkIfResourceKeyExists(e.aCustomBundles,`${l}`)){return n.getTranslatedText(l,e)}else{return t}}else{return n.getTranslatedText("C_COMMON_DIALOG_OK",e)}}function H(e,t,n,a,i,s,o,r){let l;const c=sap.ui.getCore().getMessageManager().getMessageModel().getData();const u=c.filter(function(e){const t=r.processedMessageIds.find(function(t){return e.id===t});if(!t){r.processedMessageIds.push(e.id);if(e.type===x.Success){r.delaySuccessMessages.push(e)}}return e.persistent===true&&e.type!==x.Success&&!t});if(u.length){if(e.internalModelContext){l=r.strictHandlingTransitionFails;l.push({oAction:t,groupId:n});r.strictHandlingTransitionFails=l}}if(a===i&&r&&r.strictHandlingWarningMessages.length){P.renderMessageView(e,o,s,r.strictHandlingWarningMessages,r,true)}}function R(e,t,n,a,i,s,o,r,l){let c,u=true;if(n){var d;const t=e.getBoundContext().getPath();const n=e.getModel().getMetaModel().getMetaPath(t);const a=e.getModel().getMetaModel().getObject(n);if(a&&((d=a[0])===null||d===void 0?void 0:d.$kind)!=="Action"){u=false}}if(!u){c=n?e.execute(a).then(function(){return e.getBoundContext()}):e.execute(a)}else{c=n?e.execute(a,undefined,P.fnOnStrictHandlingFailed.bind(q,a,t,i,r,e.getContext(),o,s,l)).then(function(){if(l){H(t,e,a,r,o,s,i,l)}return Promise.resolve(e.getBoundContext())}).catch(function(){if(l){H(t,e,a,r,o,s,i,l)}return Promise.reject()}):e.execute(a,undefined,P.fnOnStrictHandlingFailed.bind(q,a,t,i,r,e.getContext(),o,s,l)).then(function(n){if(l){H(t,e,a,r,o,s,i,l)}return Promise.resolve(n)}).catch(function(){if(l){H(t,e,a,r,o,s,i,l)}return Promise.reject()})}return c.catch(()=>{throw b.ActionExecutionFailed})}function V(t,n,a,i,s){const o=n.aContexts||[];const r=n.model;const l=n.aActionParameters||[];const c=n.actionName;const u=n.fnOnSubmitted;const d=n.fnOnResponse;const g=a&&a.isA("sap.ui.core.mvc.View")&&a.getController().oResourceBundle;let f;function m(){if(l&&l.length){for(let e=0;e<l.length;e++){if(!l[e].value){switch(l[e].$Type){case"Edm.String":l[e].value="";break;case"Edm.Boolean":l[e].value=false;break;case"Edm.Byte":case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":l[e].value=0;break;default:break}}f.setParameter(l[e].$Name,l[e].value)}}}if(o.length){return new Promise(function(e){const a=n.mBindingParameters;const l=n.bGrouped;const d=n.bGetBoundContext;const p=[];let h;let M;let P;const x=function(e,a,o,r){m();P=!l?`$auto.${a}`:e.getUpdateGroupId();n.requestSideEffects=L.bind(q,t,o,n);h=R(e,n,d,P,g,i,r,a,s);p.push(h);L(t,o,n,P)};const v=function(e,a,o,l){const c=[];m();P=`apiMode${a}`;n.requestSideEffects=L.bind(q,t,o,n,P,c);h=R(e,n,d,P,g,i,l,a,s);p.push(h);c.push(h);L(t,o,n,P,c);r.submitBatch(P);return Promise.allSettled(c)};async function b(e){(u||function e(){})(p);function t(e,t,i){f=r.bindContext(`${c}(...)`,e,a);return v(f,t,{context:e,pathExpressions:n.additionalSideEffect&&n.additionalSideEffect.pathExpressions,triggerActions:n.additionalSideEffect&&n.additionalSideEffect.triggerActions},i)}await e.reduce(async(e,n,a)=>{await e;await t(n,a+1,o.length)},Promise.resolve());C()}if(!l){b(o)}else{for(M=0;M<o.length;M++){f=r.bindContext(`${c}(...)`,o[M],a);x(f,o.length<=1?null:M,{context:o[M],pathExpressions:n.additionalSideEffect&&n.additionalSideEffect.pathExpressions,triggerActions:n.additionalSideEffect&&n.additionalSideEffect.triggerActions},o.length)}(u||function e(){})(p);C()}function C(){return Promise.allSettled(p).then(e)}}).finally(function(){(d||function e(){})()})}else{f=r.bindContext(`/${c}(...)`);m();const t="actionImport";const a=f.execute(t,undefined,P.fnOnStrictHandlingFailed.bind(q,t,{label:n.label,model:r},g,null,null,null,i,s));r.submitBatch(t);(u||function e(){})(a);return a.then(function(e){if(e){return e}else{var t,n,a;return(t=(n=f).getBoundContext)===null||t===void 0?void 0:(a=t.call(n))===null||a===void 0?void 0:a.getObject()}}).catch(function(t){e.error("Error while executing action "+c,t);throw t}).finally(function(){(d||function e(){})()})}}function G(e,t){let n=e.getPath();n=e.getObject("$IsBound")?n.split("@$ui5.overload")[0]:n.split("/0")[0];return n.split(`/${t}`)[0]}function k(e,t,n,a){if(n){for(const e of t){if(e.$Name!=="ResultIsActiveEntity"&&!(n!==null&&n!==void 0&&n.find(t=>t.name===e.$Name))){return false}}}else if(e&&a){for(const e of t){if(!a[e.$Name]){return false}}}return true}function L(n,a,i,s,o){const r=n.getSideEffectsService();let l;if(a&&a.triggerActions&&a.triggerActions.length){a.triggerActions.forEach(function(e){if(e){l=r.executeAction(e,a.context,s);if(o){o.push(l)}}})}if(a&&a.pathExpressions&&a.pathExpressions.length>0){l=r.requestSideEffects(a.pathExpressions,a.context,s);if(o){o.push(l)}l.then(function(){if(i.operationAvailableMap&&i.internalModelContext){t.setActionEnablement(i.internalModelContext,JSON.parse(i.operationAvailableMap),i.selectedItems,"table")}}).catch(function(t){e.error("Error while requesting side effects",t)})}}const q={callBoundAction:A,callActionImport:$,callBoundFunction:O,callFunctionImport:y,executeDependingOnSelectedContexts:R,valuesProvidedForAllParameters:k,getActionParameterActionName:F,actionParameterShowMessageCallback:B,afterActionResolution:N};return q},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/sticky-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/library", "sap/m/MessageBox", "sap/ui/core/Core", "../../operationsHelper"], function (Log, CommonUtils, FELibrary, MessageBox, Core, operationsHelper) {
  "use strict";

  const ProgrammingModel = FELibrary.ProgrammingModel;
  /**
   * Opens a sticky session to edit a document.
   *
   * @function
   * @name sap.fe.core.actions.sticky#editDocumentInStickySession
   * @memberof sap.fe.core.actions.sticky
   * @static
   * @param context Context of the document to be edited
   * @param appComponent The AppComponent
   * @returns A Promise resolved when the sticky session is in edit mode
   * @private
   * @ui5-restricted
   */
  async function editDocumentInStickySession(context, appComponent) {
    const model = context.getModel(),
      metaModel = model.getMetaModel(),
      metaPath = metaModel.getMetaPath(context.getPath()),
      editActionAnnotation = metaModel.getObject(`${metaPath}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`);
    if (!editActionAnnotation) {
      throw new Error(`Edit Action for Sticky Session not found for ${metaPath}`);
    }
    const resourceBundle = await appComponent.getModel("sap.fe.i18n").getResourceBundle();
    const actionName = CommonUtils.getTranslatedText("C_COMMON_OBJECT_PAGE_EDIT", resourceBundle);
    const editAction = model.bindContext(`${editActionAnnotation}(...)`, context, {
      $$inheritExpandSelect: true
    });
    const groupId = "direct";
    const editPromise = editAction.execute(groupId, undefined, operationsHelper.fnOnStrictHandlingFailed.bind(sticky, groupId, {
      label: actionName,
      model
    }, resourceBundle, null, null, null, undefined, undefined));
    model.submitBatch(groupId);
    const newContext = await editPromise;
    const sideEffects = appComponent.getSideEffectsService().getODataActionSideEffects(editActionAnnotation, newContext);
    if (sideEffects !== null && sideEffects !== void 0 && sideEffects.triggerActions && sideEffects.triggerActions.length) {
      await appComponent.getSideEffectsService().requestSideEffectsForODataAction(sideEffects, newContext);
    }
    return newContext;
  }
  /**
   * Activates a document and closes the sticky session.
   *
   * @function
   * @name sap.fe.core.actions.sticky#activateDocument
   * @memberof sap.fe.core.actions.sticky
   * @static
   * @param context Context of the document to be activated
   * @param appComponent Context of the document to be activated
   * @returns A promise resolve when the sticky session is activated
   * @private
   * @ui5-restricted
   */
  async function activateDocument(context, appComponent) {
    const model = context.getModel(),
      metaModel = model.getMetaModel(),
      metaPath = metaModel.getMetaPath(context.getPath()),
      saveActionAnnotation = metaModel.getObject(`${metaPath}@com.sap.vocabularies.Session.v1.StickySessionSupported/SaveAction`);
    if (!saveActionAnnotation) {
      throw new Error(`Save Action for Sticky Session not found for ${metaPath}`);
    }
    const resourceBundle = await appComponent.getModel("sap.fe.i18n").getResourceBundle();
    const actionName = CommonUtils.getTranslatedText("C_OP_OBJECT_PAGE_SAVE", resourceBundle);
    const saveAction = model.bindContext(`${saveActionAnnotation}(...)`, context, {
      $$inheritExpandSelect: true
    });
    const groupId = "direct";
    const savePromise = saveAction.execute(groupId, undefined, operationsHelper.fnOnStrictHandlingFailed.bind(sticky, groupId, {
      label: actionName,
      model
    }, resourceBundle, null, null, null, undefined, undefined));
    model.submitBatch(groupId);
    try {
      return await savePromise;
    } catch (err) {
      const messagesPath = metaModel.getObject(`${metaPath}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`);
      if (messagesPath) {
        try {
          await appComponent.getSideEffectsService().requestSideEffects([{
            $PropertyPath: messagesPath
          }], context);
        } catch (error) {
          Log.error("Error while requesting side effects", error);
        }
      }
      throw err;
    }
  }
  /**
   * Discards a document and closes sticky session.
   *
   * @function
   * @name sap.fe.core.actions.sticky#discardDocument
   * @memberof sap.fe.core.actions.sticky
   * @static
   * @param context Context of the document to be discarded
   * @returns A promise resolved when the document is dicarded
   * @private
   * @ui5-restricted
   */
  function discardDocument(context) {
    const model = context.getModel(),
      metaModel = model.getMetaModel(),
      metaPath = metaModel.getMetaPath(context.getPath()),
      discardActionAnnotation = metaModel.getObject(`${metaPath}@com.sap.vocabularies.Session.v1.StickySessionSupported/DiscardAction`);
    if (!discardActionAnnotation) {
      throw new Error(`Discard Action for Sticky Session not found for ${metaPath}`);
    }
    const discardAction = model.bindContext(`/${discardActionAnnotation}(...)`);
    const discardPromise = discardAction.execute("direct").then(function () {
      return context;
    });
    model.submitBatch("direct");
    return discardPromise;
  }

  /**
   * Process the Data loss confirmation.
   *
   * @function
   * @name sap.fe.core.actions.sticky#discardDocument
   * @memberof sap.fe.core.actions.sticky
   * @static
   * @param fnProcess Function to execute after confirmation
   * @param view Current view
   * @param programmingModel Programming Model of the current page
   * @returns `void` i think
   * @private
   * @ui5-restricted
   */
  function processDataLossConfirmation(fnProcess, view, programmingModel) {
    const uiEditable = view.getModel("ui").getProperty("/isEditable"),
      resourceBundle = Core.getLibraryResourceBundle("sap.fe.templates"),
      warningMsg = resourceBundle && resourceBundle.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),
      confirmButtonTxt = resourceBundle && resourceBundle.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),
      cancelButtonTxt = resourceBundle && resourceBundle.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");
    if (programmingModel === ProgrammingModel.Sticky && uiEditable) {
      return MessageBox.warning(warningMsg, {
        actions: [confirmButtonTxt, cancelButtonTxt],
        emphasizedAction: confirmButtonTxt,
        onClose: function (actionText) {
          if (actionText === confirmButtonTxt) {
            const internalModel = view && view.getModel("internal");
            Log.info("Navigation confirmed.");
            if (internalModel) {
              internalModel.setProperty("/sessionOn", false);
              internalModel.setProperty("/stickySessionToken", undefined);
            } else {
              Log.warning("Local UIModel couldn't be found.");
            }
            fnProcess();
          } else {
            Log.info("Navigation rejected.");
          }
        }
      });
    }
    return fnProcess();
  }

  /**
   * Static functions for the sticky session programming model
   *
   * @namespace
   * @alias sap.fe.core.actions.sticky
   * @private
   * @experimental This module is only for experimental use! <br/><b>This is only a POC and maybe deleted</b>
   * @since 1.54.0
   */
  const sticky = {
    editDocumentInStickySession: editDocumentInStickySession,
    activateDocument: activateDocument,
    discardDocument: discardDocument,
    processDataLossConfirmation: processDataLossConfirmation
  };
  return sticky;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/editFlow/sticky", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/library","sap/m/MessageBox","sap/ui/core/Core","../../operationsHelper"],function(e,t,n,o,i,s){"use strict";const c=n.ProgrammingModel;async function r(e,n){const o=e.getModel(),i=o.getMetaModel(),c=i.getMetaPath(e.getPath()),r=i.getObject(`${c}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`);if(!r){throw new Error(`Edit Action for Sticky Session not found for ${c}`)}const a=await n.getModel("sap.fe.i18n").getResourceBundle();const d=t.getTranslatedText("C_COMMON_OBJECT_PAGE_EDIT",a);const u=o.bindContext(`${r}(...)`,e,{$$inheritExpandSelect:true});const f="direct";const g=u.execute(f,undefined,s.fnOnStrictHandlingFailed.bind(l,f,{label:d,model:o},a,null,null,null,undefined,undefined));o.submitBatch(f);const S=await g;const p=n.getSideEffectsService().getODataActionSideEffects(r,S);if(p!==null&&p!==void 0&&p.triggerActions&&p.triggerActions.length){await n.getSideEffectsService().requestSideEffectsForODataAction(p,S)}return S}async function a(n,o){const i=n.getModel(),c=i.getMetaModel(),r=c.getMetaPath(n.getPath()),a=c.getObject(`${r}@com.sap.vocabularies.Session.v1.StickySessionSupported/SaveAction`);if(!a){throw new Error(`Save Action for Sticky Session not found for ${r}`)}const d=await o.getModel("sap.fe.i18n").getResourceBundle();const u=t.getTranslatedText("C_OP_OBJECT_PAGE_SAVE",d);const f=i.bindContext(`${a}(...)`,n,{$$inheritExpandSelect:true});const g="direct";const S=f.execute(g,undefined,s.fnOnStrictHandlingFailed.bind(l,g,{label:u,model:i},d,null,null,null,undefined,undefined));i.submitBatch(g);try{return await S}catch(t){const i=c.getObject(`${r}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`);if(i){try{await o.getSideEffectsService().requestSideEffects([{$PropertyPath:i}],n)}catch(t){e.error("Error while requesting side effects",t)}}throw t}}function d(e){const t=e.getModel(),n=t.getMetaModel(),o=n.getMetaPath(e.getPath()),i=n.getObject(`${o}@com.sap.vocabularies.Session.v1.StickySessionSupported/DiscardAction`);if(!i){throw new Error(`Discard Action for Sticky Session not found for ${o}`)}const s=t.bindContext(`/${i}(...)`);const c=s.execute("direct").then(function(){return e});t.submitBatch("direct");return c}function u(t,n,s){const r=n.getModel("ui").getProperty("/isEditable"),a=i.getLibraryResourceBundle("sap.fe.templates"),d=a&&a.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),u=a&&a.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),l=a&&a.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");if(s===c.Sticky&&r){return o.warning(d,{actions:[u,l],emphasizedAction:u,onClose:function(o){if(o===u){const o=n&&n.getModel("internal");e.info("Navigation confirmed.");if(o){o.setProperty("/sessionOn",false);o.setProperty("/stickySessionToken",undefined)}else{e.warning("Local UIModel couldn't be found.")}t()}else{e.info("Navigation rejected.")}}})}return t()}const l={editDocumentInStickySession:r,activateDocument:a,discardDocument:d,processDataLossConfirmation:u};return l},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/messageHandler/messageHandling-dbg", ["sap/m/Bar", "sap/m/Button", "sap/m/Dialog", "sap/m/FormattedText", "sap/m/MessageBox", "sap/m/MessageItem", "sap/m/MessageToast", "sap/m/MessageView", "sap/m/Text", "sap/ui/core/Core", "sap/ui/core/format/DateFormat", "sap/ui/core/IconPool", "sap/ui/core/library", "sap/ui/core/message/Message", "sap/ui/model/Filter", "sap/ui/model/FilterOperator", "sap/ui/model/json/JSONModel", "sap/ui/model/Sorter", "../../CommonUtils"], function (Bar, Button, Dialog, FormattedText, MessageBox, MessageItem, MessageToast, MessageView, Text, Core, DateFormat, IconPool, CoreLib, Message, Filter, FilterOperator, JSONModel, Sorter, CommonUtils) {
  "use strict";

  const MessageType = CoreLib.MessageType;
  let aMessageList = [];
  let aMessageDataList = [];
  let aResolveFunctions = [];
  let oDialog;
  let oBackButton;
  let oMessageView;
  function fnFormatTechnicalDetails() {
    let sPreviousGroupName;

    // Insert technical detail if it exists
    function insertDetail(oProperty) {
      return oProperty.property ? "( ${" + oProperty.property + '} ? ("<p>' + oProperty.property.substr(Math.max(oProperty.property.lastIndexOf("/"), oProperty.property.lastIndexOf(".")) + 1) + ' : " + ' + "${" + oProperty.property + '} + "</p>") : "" )' : "";
    }
    // Insert groupname if it exists
    function insertGroupName(oProperty) {
      let sHTML = "";
      if (oProperty.groupName && oProperty.property && oProperty.groupName !== sPreviousGroupName) {
        sHTML += "( ${" + oProperty.property + '} ? "<br><h3>' + oProperty.groupName + '</h3>" : "" ) + ';
        sPreviousGroupName = oProperty.groupName;
      }
      return sHTML;
    }

    // List of technical details to be shown
    function getPaths() {
      const sTD = "technicalDetails"; // name of property in message model data for technical details
      return [{
        groupName: "",
        property: `${sTD}/status`
      }, {
        groupName: "",
        property: `${sTD}/statusText`
      }, {
        groupName: "Application",
        property: `${sTD}/error/@SAP__common.Application/ComponentId`
      }, {
        groupName: "Application",
        property: `${sTD}/error/@SAP__common.Application/ServiceId`
      }, {
        groupName: "Application",
        property: `${sTD}/error/@SAP__common.Application/ServiceRepository`
      }, {
        groupName: "Application",
        property: `${sTD}/error/@SAP__common.Application/ServiceVersion`
      }, {
        groupName: "ErrorResolution",
        property: `${sTD}/error/@SAP__common.ErrorResolution/Analysis`
      }, {
        groupName: "ErrorResolution",
        property: `${sTD}/error/@SAP__common.ErrorResolution/Note`
      }, {
        groupName: "ErrorResolution",
        property: `${sTD}/error/@SAP__common.ErrorResolution/DetailedNote`
      }, {
        groupName: "ErrorResolution",
        property: `${sTD}/error/@SAP__common.ExceptionCategory`
      }, {
        groupName: "ErrorResolution",
        property: `${sTD}/error/@SAP__common.TimeStamp`
      }, {
        groupName: "ErrorResolution",
        property: `${sTD}/error/@SAP__common.TransactionId`
      }, {
        groupName: "Messages",
        property: `${sTD}/error/code`
      }, {
        groupName: "Messages",
        property: `${sTD}/error/message`
      }];
    }
    let sHTML = "Object.keys(" + "${technicalDetails}" + ').length > 0 ? "<h2>Technical Details</h2>" : "" ';
    getPaths().forEach(function (oProperty) {
      sHTML = `${sHTML + insertGroupName(oProperty)}${insertDetail(oProperty)} + `;
    });
    return sHTML;
  }
  function fnFormatDescription() {
    return "(${" + 'description} ? ("<h2>Description</h2>" + ${' + 'description}) : "")';
  }
  /**
   * Calculates the highest priority message type(Error/Warning/Success/Information) from the available messages.
   *
   * @function
   * @name sap.fe.core.actions.messageHandling.fnGetHighestMessagePriority
   * @memberof sap.fe.core.actions.messageHandling
   * @param [aMessages] Messages list
   * @returns Highest priority message from the available messages
   * @private
   * @ui5-restricted
   */
  function fnGetHighestMessagePriority(aMessages) {
    let sMessagePriority = MessageType.None;
    const iLength = aMessages.length;
    const oMessageCount = {
      Error: 0,
      Warning: 0,
      Success: 0,
      Information: 0
    };
    for (let i = 0; i < iLength; i++) {
      ++oMessageCount[aMessages[i].getType()];
    }
    if (oMessageCount[MessageType.Error] > 0) {
      sMessagePriority = MessageType.Error;
    } else if (oMessageCount[MessageType.Warning] > 0) {
      sMessagePriority = MessageType.Warning;
    } else if (oMessageCount[MessageType.Success] > 0) {
      sMessagePriority = MessageType.Success;
    } else if (oMessageCount[MessageType.Information] > 0) {
      sMessagePriority = MessageType.Information;
    }
    return sMessagePriority;
  }
  // function which modify e-Tag messages only.
  // returns : true, if any e-Tag message is modified, otherwise false.
  function fnModifyETagMessagesOnly(oMessageManager, oResourceBundle, concurrentEditFlag) {
    const aMessages = oMessageManager.getMessageModel().getObject("/");
    let bMessagesModified = false;
    let sEtagMessage = "";
    aMessages.forEach(function (oMessage, i) {
      const oTechnicalDetails = oMessage.getTechnicalDetails && oMessage.getTechnicalDetails();
      if (oTechnicalDetails && oTechnicalDetails.httpStatus === 412) {
        if (oTechnicalDetails.isConcurrentModification && concurrentEditFlag) {
          sEtagMessage = sEtagMessage || oResourceBundle.getText("C_APP_COMPONENT_SAPFE_ETAG_TECHNICAL_ISSUES_CONCURRENT_MODIFICATION");
        } else {
          sEtagMessage = sEtagMessage || oResourceBundle.getText("C_APP_COMPONENT_SAPFE_ETAG_TECHNICAL_ISSUES");
        }
        oMessageManager.removeMessages(aMessages[i]);
        oMessage.setMessage(sEtagMessage);
        oMessage.target = "";
        oMessageManager.addMessages(oMessage);
        bMessagesModified = true;
      }
    });
    return bMessagesModified;
  }
  // Dialog close Handling
  function dialogCloseHandler() {
    oDialog.close();
    oBackButton.setVisible(false);
    aMessageList = [];
    const oMessageDialogModel = oMessageView.getModel();
    if (oMessageDialogModel) {
      oMessageDialogModel.setData({});
    }
    removeUnboundTransitionMessages();
  }
  function getRetryAfterMessage(oMessage, bMessageDialog) {
    const dNow = new Date();
    const oTechnicalDetails = oMessage.getTechnicalDetails();
    const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
    let sRetryAfterMessage;
    if (oTechnicalDetails && oTechnicalDetails.httpStatus === 503 && oTechnicalDetails.retryAfter) {
      const dRetryAfter = oTechnicalDetails.retryAfter;
      let oDateFormat;
      if (dNow.getFullYear() !== dRetryAfter.getFullYear()) {
        //different years
        oDateFormat = DateFormat.getDateTimeInstance({
          pattern: "MMMM dd, yyyy 'at' hh:mm a"
        });
        sRetryAfterMessage = oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR", [oDateFormat.format(dRetryAfter)]);
      } else if (dNow.getFullYear() == dRetryAfter.getFullYear()) {
        //same year
        if (bMessageDialog) {
          //less than 2 min
          sRetryAfterMessage = `${oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_TITLE")} ${oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_DESC")}`;
        } else if (dNow.getMonth() !== dRetryAfter.getMonth() || dNow.getDate() !== dRetryAfter.getDate()) {
          oDateFormat = DateFormat.getDateTimeInstance({
            pattern: "MMMM dd 'at' hh:mm a"
          }); //different months or different days of same month
          sRetryAfterMessage = oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR", [oDateFormat.format(dRetryAfter)]);
        } else {
          //same day
          oDateFormat = DateFormat.getDateTimeInstance({
            pattern: "hh:mm a"
          });
          sRetryAfterMessage = oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR_DAY", [oDateFormat.format(dRetryAfter)]);
        }
      }
    }
    if (oTechnicalDetails && oTechnicalDetails.httpStatus === 503 && !oTechnicalDetails.retryAfter) {
      sRetryAfterMessage = oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR_NO_RETRY_AFTER");
    }
    return sRetryAfterMessage;
  }
  function prepareMessageViewForDialog(oMessageDialogModel, bStrictHandlingFlow, multi412) {
    let oMessageTemplate;
    if (!bStrictHandlingFlow) {
      oMessageTemplate = new MessageItem(undefined, {
        counter: {
          path: "counter"
        },
        title: "{message}",
        subtitle: "{additionalText}",
        longtextUrl: "{descriptionUrl}",
        type: {
          path: "type"
        },
        groupName: "{headerName}",
        description: "{= ${" + "description} || ${technicalDetails} ? " + '"<html><body>" + ' + fnFormatDescription() + " + " + fnFormatTechnicalDetails() + '"</body></html>"' + ' : "" }',
        markupDescription: true
      });
    } else if (multi412) {
      oMessageTemplate = new MessageItem(undefined, {
        counter: {
          path: "counter"
        },
        title: "{message}",
        subtitle: "{additionalText}",
        longtextUrl: "{descriptionUrl}",
        type: {
          path: "type"
        },
        description: "{description}",
        markupDescription: true
      });
    } else {
      oMessageTemplate = new MessageItem({
        title: "{message}",
        type: {
          path: "type"
        },
        longtextUrl: "{descriptionUrl}"
      });
    }
    oMessageView = new MessageView({
      showDetailsPageHeader: false,
      itemSelect: function () {
        oBackButton.setVisible(true);
      },
      items: {
        path: "/",
        template: oMessageTemplate
      }
    });
    oMessageView.setGroupItems(true);
    oBackButton = oBackButton || new Button({
      icon: IconPool.getIconURI("nav-back"),
      visible: false,
      press: function () {
        oMessageView.navigateBack();
        this.setVisible(false);
      }
    });
    // Update proper ETag Mismatch error
    oMessageView.setModel(oMessageDialogModel);
    return {
      oMessageView,
      oBackButton
    };
  }
  function showUnboundMessages(aCustomMessages, oContext, bShowBoundTransition, concurrentEditFlag, control, sActionName, bOnlyForTest, onBeforeShowMessage, viewType) {
    let aTransitionMessages = this.getMessages();
    const oMessageManager = Core.getMessageManager();
    let sHighestPriority;
    let sHighestPriorityText;
    const aFilters = [new Filter({
      path: "persistent",
      operator: FilterOperator.NE,
      value1: false
    })];
    let showMessageDialog = false,
      showMessageBox = false;
    if (bShowBoundTransition) {
      aTransitionMessages = aTransitionMessages.concat(getMessages(true, true));
      // we only want to show bound transition messages not bound state messages hence add a filter for the same
      aFilters.push(new Filter({
        path: "persistent",
        operator: FilterOperator.EQ,
        value1: true
      }));
      const fnCheckControlIdInDialog = function (aControlIds) {
        let index = Infinity,
          oControl = Core.byId(aControlIds[0]);
        const errorFieldControl = Core.byId(aControlIds[0]);
        while (oControl) {
          const fieldRankinDialog = oControl instanceof Dialog ? errorFieldControl.getParent().findElements(true).indexOf(errorFieldControl) : Infinity;
          if (oControl instanceof Dialog) {
            if (index > fieldRankinDialog) {
              index = fieldRankinDialog;
              // Set the focus to the dialog's control
              errorFieldControl.focus();
            }
            // messages with target inside sap.m.Dialog should not bring up the message dialog
            return false;
          }
          oControl = oControl.getParent();
        }
        return true;
      };
      aFilters.push(new Filter({
        path: "controlIds",
        test: fnCheckControlIdInDialog,
        caseSensitive: true
      }));
    } else {
      // only unbound messages have to be shown so add filter accordingly
      aFilters.push(new Filter({
        path: "target",
        operator: FilterOperator.EQ,
        value1: ""
      }));
    }
    if (aCustomMessages && aCustomMessages.length) {
      aCustomMessages.forEach(function (oMessage) {
        const messageCode = oMessage.code ? oMessage.code : "";
        oMessageManager.addMessages(new Message({
          message: oMessage.text,
          type: oMessage.type,
          target: "",
          persistent: true,
          code: messageCode
        }));
        //The target and persistent properties of the message are hardcoded as "" and true because the function deals with only unbound messages.
      });
    }

    const oMessageDialogModel = oMessageView && oMessageView.getModel() || new JSONModel();
    const bHasEtagMessage = this.modifyETagMessagesOnly(oMessageManager, Core.getLibraryResourceBundle("sap.fe.core"), concurrentEditFlag);
    if (aTransitionMessages.length === 1 && aTransitionMessages[0].getCode() === "503") {
      showMessageBox = true;
    } else if (aTransitionMessages.length !== 0) {
      showMessageDialog = true;
    }
    let showMessageParameters;
    let aModelDataArray = [];
    if (showMessageDialog || !showMessageBox && !onBeforeShowMessage) {
      const oListBinding = oMessageManager.getMessageModel().bindList("/", undefined, undefined, aFilters),
        aCurrentContexts = oListBinding.getCurrentContexts();
      if (aCurrentContexts && aCurrentContexts.length > 0) {
        showMessageDialog = true;
        // Don't show dialog incase there are no errors to show

        // if false, show messages in dialog
        // As fitering has already happened here hence
        // using the message model again for the message dialog view and then filtering on that binding again is unnecessary.
        // So we create new json model to use for the message dialog view.
        const aMessages = [];
        aCurrentContexts.forEach(function (currentContext) {
          const oMessage = currentContext.getObject();
          aMessages.push(oMessage);
          aMessageDataList = aMessages;
        });
        let existingMessages = [];
        if (Array.isArray(oMessageDialogModel.getData())) {
          existingMessages = oMessageDialogModel.getData();
        }
        const oUniqueObj = {};
        aModelDataArray = aMessageDataList.concat(existingMessages).filter(function (obj) {
          // remove entries having duplicate message ids
          return !oUniqueObj[obj.id] && (oUniqueObj[obj.id] = true);
        });
        oMessageDialogModel.setData(aModelDataArray);
      }
    }
    if (onBeforeShowMessage) {
      showMessageParameters = {
        showMessageBox,
        showMessageDialog
      };
      showMessageParameters = onBeforeShowMessage(aTransitionMessages, showMessageParameters);
      showMessageBox = showMessageParameters.showMessageBox;
      showMessageDialog = showMessageParameters.showMessageDialog;
      if (showMessageDialog) {
        aModelDataArray = showMessageParameters.filteredMessages ? showMessageParameters.filteredMessages : aModelDataArray;
      }
    }
    if (aTransitionMessages.length === 0 && !aCustomMessages && !bHasEtagMessage) {
      // Don't show the popup if there are no transient messages
      return Promise.resolve(true);
    } else if (aTransitionMessages.length === 1 && aTransitionMessages[0].getType() === MessageType.Success && !aCustomMessages) {
      return new Promise(resolve => {
        MessageToast.show(aTransitionMessages[0].message);
        if (oMessageDialogModel) {
          oMessageDialogModel.setData({});
        }
        oMessageManager.removeMessages(aTransitionMessages);
        resolve();
      });
    } else if (showMessageDialog) {
      messageHandling.updateMessageObjectGroupName(aModelDataArray, control, sActionName, viewType);
      oMessageDialogModel.setData(aModelDataArray); // set the messages here so that if any of them are filtered for APD, they are filtered here as well.
      aResolveFunctions = aResolveFunctions || [];
      return new Promise(function (resolve, reject) {
        aResolveFunctions.push(resolve);
        Core.getLibraryResourceBundle("sap.fe.core", true).then(function (oResourceBundle) {
          const bStrictHandlingFlow = false;
          if (showMessageParameters && showMessageParameters.fnGetMessageSubtitle) {
            oMessageDialogModel.getData().forEach(function (oMessage) {
              showMessageParameters.fnGetMessageSubtitle(oMessage);
            });
          }
          const oMessageObject = prepareMessageViewForDialog(oMessageDialogModel, bStrictHandlingFlow);
          const oSorter = new Sorter("", undefined, undefined, (obj1, obj2) => {
            const rankA = getMessageRank(obj1);
            const rankB = getMessageRank(obj2);
            if (rankA < rankB) {
              return -1;
            }
            if (rankA > rankB) {
              return 1;
            }
            return 0;
          });
          oMessageObject.oMessageView.getBinding("items").sort(oSorter);
          oDialog = oDialog && oDialog.isOpen() ? oDialog : new Dialog({
            resizable: true,
            endButton: new Button({
              press: function () {
                dialogCloseHandler();
                // also remove bound transition messages if we were showing them
                oMessageManager.removeMessages(aModelDataArray);
              },
              text: oResourceBundle.getText("C_COMMON_SAPFE_CLOSE")
            }),
            customHeader: new Bar({
              contentMiddle: [new Text({
                text: oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE")
              })],
              contentLeft: [oBackButton]
            }),
            contentWidth: "37.5em",
            contentHeight: "21.5em",
            verticalScrolling: false,
            afterClose: function () {
              for (let i = 0; i < aResolveFunctions.length; i++) {
                aResolveFunctions[i].call();
              }
              aResolveFunctions = [];
            }
          });
          oDialog.removeAllContent();
          oDialog.addContent(oMessageObject.oMessageView);
          if (bHasEtagMessage) {
            sap.ui.require(["sap/m/ButtonType"], function (ButtonType) {
              oDialog.setBeginButton(new Button({
                press: function () {
                  dialogCloseHandler();
                  if (oContext.hasPendingChanges()) {
                    oContext.getBinding().resetChanges();
                  }
                  oContext.refresh();
                },
                text: oResourceBundle.getText("C_COMMON_SAPFE_REFRESH"),
                type: ButtonType.Emphasized
              }));
            });
          } else {
            oDialog.destroyBeginButton();
          }
          sHighestPriority = fnGetHighestMessagePriority(oMessageView.getItems());
          sHighestPriorityText = getTranslatedTextForMessageDialog(sHighestPriority);
          oDialog.setState(sHighestPriority);
          oDialog.getCustomHeader().getContentMiddle()[0].setText(sHighestPriorityText);
          oMessageView.navigateBack();
          oDialog.open();
          if (bOnlyForTest) {
            resolve(oDialog);
          }
        }).catch(reject);
      });
    } else if (showMessageBox) {
      return new Promise(function (resolve) {
        const oMessage = aTransitionMessages[0];
        if (oMessage.technicalDetails && aMessageList.indexOf(oMessage.technicalDetails.originalMessage.message) === -1) {
          aMessageList.push(oMessage.technicalDetails.originalMessage.message);
          let formattedTextString = "<html><body>";
          const retryAfterMessage = getRetryAfterMessage(oMessage, true);
          if (retryAfterMessage) {
            formattedTextString = `<h6>${retryAfterMessage}</h6><br>`;
          }
          if (showMessageParameters && showMessageParameters.fnGetMessageSubtitle) {
            showMessageParameters.fnGetMessageSubtitle(oMessage);
          }
          if (oMessage.getCode() !== "503" && oMessage.getAdditionalText() !== undefined) {
            formattedTextString = `${formattedTextString + oMessage.getAdditionalText()}: ${oMessage.getMessage()}</html></body>`;
          } else {
            formattedTextString = `${formattedTextString + oMessage.getMessage()}</html></body>`;
          }
          const formattedText = new FormattedText({
            htmlText: formattedTextString
          });
          MessageBox.error(formattedText, {
            onClose: function () {
              aMessageList = [];
              if (bShowBoundTransition) {
                removeBoundTransitionMessages();
              }
              removeUnboundTransitionMessages();
              resolve(true);
            }
          });
        }
      });
    } else {
      return Promise.resolve(true);
    }
  }

  /**
   * This function sets the group name for all messages in a dialog.
   *
   * @param aModelDataArray Messages array
   * @param control
   * @param sActionName
   * @param viewType
   */
  function updateMessageObjectGroupName(aModelDataArray, control, sActionName, viewType) {
    aModelDataArray.forEach(aModelData => {
      var _aModelData$target;
      aModelData["headerName"] = "";
      if (!((_aModelData$target = aModelData.target) !== null && _aModelData$target !== void 0 && _aModelData$target.length)) {
        // unbound transiiton messages
        aModelData["headerName"] = "General";
      } else if (aModelData.target.length) {
        // LR flow
        if (viewType === "ListReport") {
          messageHandling.setGroupNameLRTable(control, aModelData, sActionName);
        } else if (viewType === "ObjectPage") {
          // OP Display mode
          messageHandling.setGroupNameOPDisplayMode(aModelData, sActionName, control);
        } else {
          aModelData["headerName"] = messageHandling.getLastActionTextAndActionName(sActionName);
        }
      }
    });
  }

  /**
   * This function will set the group name of Message Object for LR table.
   *
   * @param oElem
   * @param aModelData
   * @param sActionName
   */
  function setGroupNameLRTable(oElem, aModelData, sActionName) {
    const oRowBinding = oElem && oElem.getRowBinding();
    if (oRowBinding) {
      var _aModelData$target2;
      const sElemeBindingPath = `${oElem.getRowBinding().getPath()}`;
      if (((_aModelData$target2 = aModelData.target) === null || _aModelData$target2 === void 0 ? void 0 : _aModelData$target2.indexOf(sElemeBindingPath)) === 0) {
        const allRowContexts = oElem.getRowBinding().getContexts();
        allRowContexts.forEach(rowContext => {
          var _aModelData$target3;
          if ((_aModelData$target3 = aModelData.target) !== null && _aModelData$target3 !== void 0 && _aModelData$target3.includes(rowContext.getPath())) {
            const contextPath = `${rowContext.getPath()}/`;
            const identifierColumn = oElem.getParent().getIdentifierColumn();
            const rowIdentifier = identifierColumn && rowContext.getObject()[identifierColumn];
            const columnPropertyName = messageHandling.getTableColProperty(oElem, aModelData, contextPath);
            const {
              sTableTargetColName
            } = messageHandling.getTableColInfo(oElem, columnPropertyName);

            // if target has some column name and column is visible in UI
            if (columnPropertyName && sTableTargetColName) {
              // header will be row Identifier, if found from above code otherwise it should be table name
              aModelData["headerName"] = rowIdentifier ? ` ${rowIdentifier}` : oElem.getHeader();
            } else {
              // if column data not found (may be the column is hidden), add grouping as Last Action
              aModelData["headerName"] = messageHandling.getLastActionTextAndActionName(sActionName);
            }
          }
        });
      }
    }
  }

  /**
   * This function will set the group name of Message Object in OP Display mode.
   *
   * @param aModelData Message Object
   * @param sActionName  Action name
   * @param control
   */
  function setGroupNameOPDisplayMode(aModelData, sActionName, control) {
    const oViewContext = control === null || control === void 0 ? void 0 : control.getBindingContext();
    const opLayout = (control === null || control === void 0 ? void 0 : control.getContent) && (control === null || control === void 0 ? void 0 : control.getContent()[0]);
    let bIsGeneralGroupName = true;
    if (opLayout) {
      messageHandling.getVisibleSectionsFromObjectPageLayout(opLayout).forEach(function (oSection) {
        const subSections = oSection.getSubSections();
        subSections.forEach(function (oSubSection) {
          oSubSection.findElements(true).forEach(function (oElem) {
            if (oElem.isA("sap.ui.mdc.Table")) {
              const oRowBinding = oElem.getRowBinding(),
                setSectionNameInGroup = true;
              let childTableElement;
              oElem.findElements(true).forEach(oElement => {
                if (oElement.isA("sap.m.Table") || oElement.isA("sap.ui.table.Table")) {
                  childTableElement = oElement;
                }
              });
              if (oRowBinding) {
                var _oElem$getRowBinding, _aModelData$target4;
                const sElemeBindingPath = `${oViewContext === null || oViewContext === void 0 ? void 0 : oViewContext.getPath()}/${(_oElem$getRowBinding = oElem.getRowBinding()) === null || _oElem$getRowBinding === void 0 ? void 0 : _oElem$getRowBinding.getPath()}`;
                if (((_aModelData$target4 = aModelData.target) === null || _aModelData$target4 === void 0 ? void 0 : _aModelData$target4.indexOf(sElemeBindingPath)) === 0) {
                  const obj = messageHandling.getTableColumnDataAndSetSubtile(aModelData, oElem, childTableElement, oRowBinding, sActionName, setSectionNameInGroup, fnCallbackSetGroupName);
                  const {
                    oTargetTableInfo
                  } = obj;
                  if (setSectionNameInGroup) {
                    const identifierColumn = oElem.getParent().getIdentifierColumn();
                    if (identifierColumn) {
                      const allRowContexts = oElem.getRowBinding().getContexts();
                      allRowContexts.forEach(rowContext => {
                        var _aModelData$target5;
                        if ((_aModelData$target5 = aModelData.target) !== null && _aModelData$target5 !== void 0 && _aModelData$target5.includes(rowContext.getPath())) {
                          const rowIdentifier = identifierColumn ? rowContext.getObject()[identifierColumn] : undefined;
                          aModelData["additionalText"] = `${rowIdentifier}, ${oTargetTableInfo.sTableTargetColName}`;
                        }
                      });
                    } else {
                      aModelData["additionalText"] = `${oTargetTableInfo.sTableTargetColName}`;
                    }
                    let headerName = oElem.getHeaderVisible() && oTargetTableInfo.tableHeader;
                    if (!headerName) {
                      headerName = oSubSection.getTitle();
                    } else {
                      const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
                      headerName = `${oResourceBundle.getText("T_MESSAGE_GROUP_TITLE_TABLE_DENOMINATOR")}: ${headerName}`;
                    }
                    aModelData["headerName"] = headerName;
                    bIsGeneralGroupName = false;
                  }
                }
              }
            }
          });
        });
      });
    }
    if (bIsGeneralGroupName) {
      var _aModelData$target6;
      const sElemeBindingPath = `${oViewContext === null || oViewContext === void 0 ? void 0 : oViewContext.getPath()}`;
      if (((_aModelData$target6 = aModelData.target) === null || _aModelData$target6 === void 0 ? void 0 : _aModelData$target6.indexOf(sElemeBindingPath)) === 0) {
        // check if OP context path is part of target, set Last Action as group name
        const headerName = messageHandling.getLastActionTextAndActionName(sActionName);
        aModelData["headerName"] = headerName;
      } else {
        aModelData["headerName"] = "General";
      }
    }
  }
  function getLastActionTextAndActionName(sActionName) {
    const sLastActionText = Core.getLibraryResourceBundle("sap.fe.core").getText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_LAST_ACTION");
    return sActionName ? `${sLastActionText}: ${sActionName}` : "";
  }

  /**
   * This function will give rank based on Message Group/Header name, which will be used for Sorting messages in Message dialog
   * Last Action should be shown at top, next Row Id and last General.
   *
   * @param obj
   * @returns Rank of message
   */
  function getMessageRank(obj) {
    var _obj$headerName, _obj$headerName2;
    if ((_obj$headerName = obj.headerName) !== null && _obj$headerName !== void 0 && _obj$headerName.toString().includes("Last Action")) {
      return 1;
    } else if ((_obj$headerName2 = obj.headerName) !== null && _obj$headerName2 !== void 0 && _obj$headerName2.toString().includes("General")) {
      return 3;
    } else {
      return 2;
    }
  }

  /**
   * This function will set the group name which can either General or Last Action.
   *
   * @param aMessage
   * @param sActionName
   * @param bIsGeneralGroupName
   */
  const fnCallbackSetGroupName = (aMessage, sActionName, bIsGeneralGroupName) => {
    if (bIsGeneralGroupName) {
      const sGeneralGroupText = Core.getLibraryResourceBundle("sap.fe.core").getText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_GENERAL");
      aMessage["headerName"] = sGeneralGroupText;
    } else {
      aMessage["headerName"] = messageHandling.getLastActionTextAndActionName(sActionName);
    }
  };

  /**
   * This function will get the table row/column info and set subtitle.
   *
   * @param aMessage
   * @param oTable
   * @param oElement
   * @param oRowBinding
   * @param sActionName
   * @param setSectionNameInGroup
   * @param fnSetGroupName
   * @returns Table info and Subtitle.
   */
  function getTableColumnDataAndSetSubtile(aMessage, oTable, oElement, oRowBinding, sActionName, setSectionNameInGroup, fnSetGroupName) {
    const oTargetTableInfo = messageHandling.getTableAndTargetInfo(oTable, aMessage, oElement, oRowBinding);
    const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
    oTargetTableInfo.tableHeader = oTable.getHeader();
    let sControlId, bIsCreationRow;
    if (!oTargetTableInfo.oTableRowContext) {
      sControlId = aMessage.getControlIds().find(function (sId) {
        return messageHandling.isControlInTable(oTable, sId);
      });
    }
    if (sControlId) {
      const oControl = Core.byId(sControlId);
      bIsCreationRow = messageHandling.isControlPartOfCreationRow(oControl);
    }
    if (!oTargetTableInfo.sTableTargetColName) {
      // if the column is not present on UI or the target does not have a table field in it, use Last Action for grouping
      if (aMessage.persistent && sActionName) {
        fnSetGroupName(aMessage, sActionName);
        setSectionNameInGroup = false;
      }
    }
    const subTitle = messageHandling.getMessageSubtitle(aMessage, oTargetTableInfo.oTableRowBindingContexts, oTargetTableInfo.oTableRowContext, oTargetTableInfo.sTableTargetColName, oResourceBundle, oTable, bIsCreationRow);
    return {
      oTargetTableInfo,
      subTitle
    };
  }

  /**
   * This function will create the subtitle based on Table Row/Column data.
   *
   * @param message
   * @param oTableRowBindingContexts
   * @param oTableRowContext
   * @param sTableTargetColName
   * @param oResourceBundle
   * @param oTable
   * @param bIsCreationRow
   * @param oTargetedControl
   * @returns Message subtitle.
   */
  function getMessageSubtitle(message, oTableRowBindingContexts, oTableRowContext, sTableTargetColName, oResourceBundle, oTable, bIsCreationRow, oTargetedControl) {
    let sMessageSubtitle;
    let sRowSubtitleValue;
    const sTableFirstColProperty = oTable.getParent().getIdentifierColumn();
    const oColFromTableSettings = messageHandling.fetchColumnInfo(message, oTable);
    if (bIsCreationRow) {
      sMessageSubtitle = CommonUtils.getTranslatedText("T_MESSAGE_ITEM_SUBTITLE", oResourceBundle, [oResourceBundle.getText("T_MESSAGE_ITEM_SUBTITLE_CREATION_ROW_INDICATOR"), sTableTargetColName ? sTableTargetColName : oColFromTableSettings.label]);
    } else {
      const oTableFirstColBindingContextTextAnnotation = messageHandling.getTableFirstColBindingContextForTextAnnotation(oTable, oTableRowContext, sTableFirstColProperty);
      const sTableFirstColTextAnnotationPath = oTableFirstColBindingContextTextAnnotation ? oTableFirstColBindingContextTextAnnotation.getObject("$Path") : undefined;
      const sTableFirstColTextArrangement = sTableFirstColTextAnnotationPath && oTableFirstColBindingContextTextAnnotation ? oTableFirstColBindingContextTextAnnotation.getObject("@com.sap.vocabularies.UI.v1.TextArrangement/$EnumMember") : undefined;
      if (oTableRowBindingContexts.length > 0) {
        // set Row subtitle text
        if (oTargetedControl) {
          // The UI error is on the first column, we then get the control input as the row indicator:
          sRowSubtitleValue = oTargetedControl.getValue();
        } else if (oTableRowContext && sTableFirstColProperty) {
          sRowSubtitleValue = messageHandling.getTableFirstColValue(sTableFirstColProperty, oTableRowContext, sTableFirstColTextAnnotationPath, sTableFirstColTextArrangement);
        } else {
          sRowSubtitleValue = undefined;
        }
        // set the message subtitle
        const oColumnInfo = messageHandling.determineColumnInfo(oColFromTableSettings, oResourceBundle);
        if (sRowSubtitleValue && sTableTargetColName) {
          sMessageSubtitle = CommonUtils.getTranslatedText("T_MESSAGE_ITEM_SUBTITLE", oResourceBundle, [sRowSubtitleValue, sTableTargetColName]);
        } else if (sRowSubtitleValue && oColumnInfo.sColumnIndicator === "Hidden") {
          sMessageSubtitle = `${oResourceBundle.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW")}: ${sRowSubtitleValue}, ${oColumnInfo.sColumnValue}`;
        } else if (sRowSubtitleValue && oColumnInfo.sColumnIndicator === "Unknown") {
          sMessageSubtitle = CommonUtils.getTranslatedText("T_MESSAGE_ITEM_SUBTITLE", oResourceBundle, [sRowSubtitleValue, oColumnInfo.sColumnValue]);
        } else if (sRowSubtitleValue && oColumnInfo.sColumnIndicator === "undefined") {
          sMessageSubtitle = `${oResourceBundle.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW")}: ${sRowSubtitleValue}`;
        } else if (!sRowSubtitleValue && sTableTargetColName) {
          sMessageSubtitle = oResourceBundle.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_COLUMN") + ": " + sTableTargetColName;
        } else if (!sRowSubtitleValue && oColumnInfo.sColumnIndicator === "Hidden") {
          sMessageSubtitle = oColumnInfo.sColumnValue;
        } else {
          sMessageSubtitle = null;
        }
      } else {
        sMessageSubtitle = null;
      }
    }
    return sMessageSubtitle;
  }

  /**
   * This function will get the first column for text Annotation, this is needed to set subtitle of Message.
   *
   * @param oTable
   * @param oTableRowContext
   * @param sTableFirstColProperty
   * @returns Binding context.
   */
  function getTableFirstColBindingContextForTextAnnotation(oTable, oTableRowContext, sTableFirstColProperty) {
    let oBindingContext;
    if (oTableRowContext && sTableFirstColProperty) {
      const oModel = oTable === null || oTable === void 0 ? void 0 : oTable.getModel();
      const oMetaModel = oModel === null || oModel === void 0 ? void 0 : oModel.getMetaModel();
      const sMetaPath = oMetaModel === null || oMetaModel === void 0 ? void 0 : oMetaModel.getMetaPath(oTableRowContext.getPath());
      if (oMetaModel !== null && oMetaModel !== void 0 && oMetaModel.getObject(`${sMetaPath}/${sTableFirstColProperty}@com.sap.vocabularies.Common.v1.Text/$Path`)) {
        oBindingContext = oMetaModel.createBindingContext(`${sMetaPath}/${sTableFirstColProperty}@com.sap.vocabularies.Common.v1.Text`);
      }
    }
    return oBindingContext;
  }

  /**
   * This function will get the value of first Column of Table, with its text Arrangement.
   *
   * @param sTableFirstColProperty
   * @param oTableRowContext
   * @param sTextAnnotationPath
   * @param sTextArrangement
   * @returns Column Value.
   */
  function getTableFirstColValue(sTableFirstColProperty, oTableRowContext, sTextAnnotationPath, sTextArrangement) {
    const sCodeValue = oTableRowContext.getValue(sTableFirstColProperty);
    let sTextValue;
    let sComputedValue = sCodeValue;
    if (sTextAnnotationPath) {
      if (sTableFirstColProperty.lastIndexOf("/") > 0) {
        // the target property is replaced with the text annotation path
        sTableFirstColProperty = sTableFirstColProperty.slice(0, sTableFirstColProperty.lastIndexOf("/") + 1);
        sTableFirstColProperty = sTableFirstColProperty.concat(sTextAnnotationPath);
      } else {
        sTableFirstColProperty = sTextAnnotationPath;
      }
      sTextValue = oTableRowContext.getValue(sTableFirstColProperty);
      if (sTextValue) {
        if (sTextArrangement) {
          const sEnumNumber = sTextArrangement.slice(sTextArrangement.indexOf("/") + 1);
          switch (sEnumNumber) {
            case "TextOnly":
              sComputedValue = sTextValue;
              break;
            case "TextFirst":
              sComputedValue = `${sTextValue} (${sCodeValue})`;
              break;
            case "TextLast":
              sComputedValue = `${sCodeValue} (${sTextValue})`;
              break;
            case "TextSeparate":
              sComputedValue = sCodeValue;
              break;
            default:
          }
        } else {
          sComputedValue = `${sTextValue} (${sCodeValue})`;
        }
      }
    }
    return sComputedValue;
  }

  /**
   * The method that is called to retrieve the column info from the associated message of the message popover.
   *
   * @private
   * @param oMessage Message object
   * @param oTable MdcTable
   * @returns Returns the column info.
   */
  function fetchColumnInfo(oMessage, oTable) {
    const sColNameFromMessageObj = oMessage === null || oMessage === void 0 ? void 0 : oMessage.getTargets()[0].split("/").pop();
    return oTable.getParent().getTableDefinition().columns.find(function (oColumn) {
      return oColumn.key.split("::").pop() === sColNameFromMessageObj;
    });
  }

  /**
   * This function get the Column data depending on its availability in Table, this is needed for setting subtitle of Message.
   *
   * @param oColFromTableSettings
   * @param oResourceBundle
   * @returns Column data.
   */
  function determineColumnInfo(oColFromTableSettings, oResourceBundle) {
    const oColumnInfo = {
      sColumnIndicator: String,
      sColumnValue: String
    };
    if (oColFromTableSettings) {
      // if column is neither in table definition nor personalization, show only row subtitle text
      if (oColFromTableSettings.availability === "Hidden") {
        oColumnInfo.sColumnValue = undefined;
        oColumnInfo.sColumnIndicator = "undefined";
      } else {
        //if column is in table personalization but not in table definition, show Column (Hidden) : <colName>
        oColumnInfo.sColumnValue = `${oResourceBundle.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_COLUMN")} (${oResourceBundle.getText("T_COLUMN_INDICATOR_IN_TABLE_DEFINITION")}): ${oColFromTableSettings.label}`;
        oColumnInfo.sColumnIndicator = "Hidden";
      }
    } else {
      oColumnInfo.sColumnValue = oResourceBundle.getText("T_MESSAGE_ITEM_SUBTITLE_INDICATOR_UNKNOWN");
      oColumnInfo.sColumnIndicator = "Unknown";
    }
    return oColumnInfo;
  }

  /**
   * This function check if a given control id is a part of Table.
   *
   * @param oTable
   * @param sControlId
   * @returns True if control is part of table.
   */
  function isControlInTable(oTable, sControlId) {
    const oControl = Core.byId(sControlId);
    if (oControl && !oControl.isA("sap.ui.table.Table") && !oControl.isA("sap.m.Table")) {
      return oTable.findElements(true, function (oElem) {
        return oElem.getId() === oControl;
      });
    }
    return false;
  }
  function isControlPartOfCreationRow(oControl) {
    let oParentControl = oControl === null || oControl === void 0 ? void 0 : oControl.getParent();
    while (oParentControl && !((_oParentControl = oParentControl) !== null && _oParentControl !== void 0 && _oParentControl.isA("sap.ui.table.Row")) && !((_oParentControl2 = oParentControl) !== null && _oParentControl2 !== void 0 && _oParentControl2.isA("sap.ui.table.CreationRow")) && !((_oParentControl3 = oParentControl) !== null && _oParentControl3 !== void 0 && _oParentControl3.isA("sap.m.ColumnListItem"))) {
      var _oParentControl, _oParentControl2, _oParentControl3;
      oParentControl = oParentControl.getParent();
    }
    return !!oParentControl && oParentControl.isA("sap.ui.table.CreationRow");
  }
  function getTranslatedTextForMessageDialog(sHighestPriority) {
    const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
    switch (sHighestPriority) {
      case "Error":
        return oResourceBundle.getText("C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR");
      case "Information":
        return oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_INFO");
      case "Success":
        return oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_SUCCESS");
      case "Warning":
        return oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_WARNING");
      default:
        return oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE");
    }
  }
  function removeUnboundTransitionMessages() {
    removeTransitionMessages(false);
  }
  function removeBoundTransitionMessages(sPathToBeRemoved) {
    removeTransitionMessages(true, sPathToBeRemoved);
  }
  function getMessagesFromMessageModel(oMessageModel, sPathToBeRemoved) {
    if (sPathToBeRemoved === undefined) {
      return oMessageModel.getObject("/");
    }
    const listBinding = oMessageModel.bindList("/");
    listBinding.filter(new Filter({
      path: "target",
      operator: FilterOperator.StartsWith,
      value1: sPathToBeRemoved
    }));
    return listBinding.getCurrentContexts().map(function (oContext) {
      return oContext.getObject();
    });
  }
  function getMessages() {
    let bBoundMessages = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    let bTransitionOnly = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let sPathToBeRemoved = arguments.length > 2 ? arguments[2] : undefined;
    let i;
    const oMessageManager = Core.getMessageManager(),
      oMessageModel = oMessageManager.getMessageModel(),
      oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core"),
      aTransitionMessages = [];
    let aMessages = [];
    if (bBoundMessages && bTransitionOnly && sPathToBeRemoved) {
      aMessages = getMessagesFromMessageModel(oMessageModel, sPathToBeRemoved);
    } else {
      aMessages = oMessageModel.getObject("/");
    }
    for (i = 0; i < aMessages.length; i++) {
      if ((!bTransitionOnly || aMessages[i].persistent) && (bBoundMessages && aMessages[i].target !== "" || !bBoundMessages && (!aMessages[i].target || aMessages[i].target === ""))) {
        aTransitionMessages.push(aMessages[i]);
      }
    }
    for (i = 0; i < aTransitionMessages.length; i++) {
      if (aTransitionMessages[i].code === "503" && aTransitionMessages[i].message !== "" && aTransitionMessages[i].message.indexOf(oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_BACKEND_PREFIX")) === -1) {
        aTransitionMessages[i].message = `\n${oResourceBundle.getText("C_MESSAGE_HANDLING_SAPFE_503_BACKEND_PREFIX")}${aTransitionMessages[i].message}`;
      }
    }
    //Filtering messages again here to avoid showing pure technical messages raised by the model
    const backendMessages = [];
    for (i = 0; i < aTransitionMessages.length; i++) {
      if (aTransitionMessages[i].technicalDetails && (aTransitionMessages[i].technicalDetails.originalMessage !== undefined && aTransitionMessages[i].technicalDetails.originalMessage !== null || aTransitionMessages[i].technicalDetails.httpStatus !== undefined && aTransitionMessages[i].technicalDetails.httpStatus !== null) || aTransitionMessages[i].code) {
        backendMessages.push(aTransitionMessages[i]);
      }
    }
    return backendMessages;
  }
  function removeTransitionMessages(bBoundMessages, sPathToBeRemoved) {
    const aMessagesToBeDeleted = getMessages(bBoundMessages, true, sPathToBeRemoved);
    if (aMessagesToBeDeleted.length > 0) {
      Core.getMessageManager().removeMessages(aMessagesToBeDeleted);
    }
  }
  //TODO: This must be moved out of message handling
  function setMessageSubtitle(oTable, aContexts, message) {
    const subtitleColumn = oTable.getParent().getIdentifierColumn();
    const errorContext = aContexts.find(function (oContext) {
      return message.getTargets()[0].indexOf(oContext.getPath()) !== -1;
    });
    message.additionalText = errorContext ? errorContext.getObject()[subtitleColumn] : undefined;
  }

  /**
   * The method retrieves the visible sections from an object page.
   *
   * @param oObjectPageLayout The objectPageLayout object for which we want to retrieve the visible sections.
   * @returns Array of visible sections.
   * @private
   */
  function getVisibleSectionsFromObjectPageLayout(oObjectPageLayout) {
    return oObjectPageLayout.getSections().filter(function (oSection) {
      return oSection.getVisible();
    });
  }

  /**
   * This function checks if control ids from message are a part of a given subsection.
   *
   * @param subSection
   * @param oMessageObject
   * @returns SubSection matching control ids.
   */
  function getControlFromMessageRelatingToSubSection(subSection, oMessageObject) {
    return subSection.findElements(true, oElem => {
      return fnFilterUponIds(oMessageObject.getControlIds(), oElem);
    }).sort(function (a, b) {
      // controls are sorted in order to have the table on top of the array
      // it will help to compute the subtitle of the message based on the type of related controls
      if (a.isA("sap.ui.mdc.Table") && !b.isA("sap.ui.mdc.Table")) {
        return -1;
      }
      return 1;
    });
  }
  function getTableColProperty(oTable, oMessageObject, oContextPath) {
    //this function escapes a string to use it as a regex
    const fnRegExpescape = function (s) {
      return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&");
    };
    // based on the target path of the message we retrieve the property name.
    // to achieve it we remove the bindingContext path and the row binding path from the target
    if (!oContextPath) {
      var _oTable$getBindingCon;
      oContextPath = new RegExp(`${fnRegExpescape(`${(_oTable$getBindingCon = oTable.getBindingContext()) === null || _oTable$getBindingCon === void 0 ? void 0 : _oTable$getBindingCon.getPath()}/${oTable.getRowBinding().getPath()}`)}\\(.*\\)/`);
    }
    return oMessageObject.getTargets()[0].replace(oContextPath, "");
  }

  /**
   * This function gives the column information if it matches with the property name from target of message.
   *
   * @param oTable
   * @param sTableTargetColProperty
   * @returns Column name and property.
   */
  function getTableColInfo(oTable, sTableTargetColProperty) {
    let sTableTargetColName;
    let oTableTargetCol = oTable.getColumns().find(function (column) {
      return column.getDataProperty() == sTableTargetColProperty;
    });
    if (!oTableTargetCol) {
      /* If the target column is not found, we check for a custom column */
      const oCustomColumn = oTable.getControlDelegate().getColumnsFor(oTable).find(function (oColumn) {
        if (!!oColumn.template && oColumn.propertyInfos) {
          return oColumn.propertyInfos[0] === sTableTargetColProperty || oColumn.propertyInfos[0].replace("Property::", "") === sTableTargetColProperty;
        } else {
          return false;
        }
      });
      if (oCustomColumn) {
        var _oTableTargetCol;
        oTableTargetCol = oCustomColumn;
        sTableTargetColProperty = (_oTableTargetCol = oTableTargetCol) === null || _oTableTargetCol === void 0 ? void 0 : _oTableTargetCol.name;
        sTableTargetColName = oTable.getColumns().find(function (oColumn) {
          return sTableTargetColProperty === oColumn.getDataProperty();
        }).getHeader();
      } else {
        /* If the target column is not found, we check for a field group */
        const aColumns = oTable.getControlDelegate().getColumnsFor(oTable);
        oTableTargetCol = aColumns.find(function (oColumn) {
          if (oColumn.key.indexOf("::FieldGroup::") !== -1) {
            var _oColumn$propertyInfo;
            return (_oColumn$propertyInfo = oColumn.propertyInfos) === null || _oColumn$propertyInfo === void 0 ? void 0 : _oColumn$propertyInfo.find(function () {
              return aColumns.find(function (tableColumn) {
                return tableColumn.relativePath === sTableTargetColProperty;
              });
            });
          }
        });
        /* check if the column with the field group is visible in the table: */
        let bIsTableTargetColVisible = false;
        if (oTableTargetCol && oTableTargetCol.label) {
          bIsTableTargetColVisible = oTable.getColumns().some(function (column) {
            return column.getHeader() === oTableTargetCol.label;
          });
        }
        sTableTargetColName = bIsTableTargetColVisible && oTableTargetCol.label;
        sTableTargetColProperty = bIsTableTargetColVisible && oTableTargetCol.key;
      }
    } else {
      sTableTargetColName = oTableTargetCol && oTableTargetCol.getHeader();
    }
    return {
      sTableTargetColName: sTableTargetColName,
      sTableTargetColProperty: sTableTargetColProperty
    };
  }

  /**
   * This function gives Table and column info if any of it matches the target from Message.
   *
   * @param oTable
   * @param oMessageObject
   * @param oElement
   * @param oRowBinding
   * @returns Table info matching the message target.
   */
  function getTableAndTargetInfo(oTable, oMessageObject, oElement, oRowBinding) {
    const oTargetTableInfo = {};
    oTargetTableInfo.sTableTargetColProperty = getTableColProperty(oTable, oMessageObject);
    const oTableColInfo = getTableColInfo(oTable, oTargetTableInfo.sTableTargetColProperty);
    oTargetTableInfo.oTableRowBindingContexts = oElement.isA("sap.ui.table.Table") ? oRowBinding.getContexts() : oRowBinding.getCurrentContexts();
    oTargetTableInfo.sTableTargetColName = oTableColInfo.sTableTargetColName;
    oTargetTableInfo.sTableTargetColProperty = oTableColInfo.sTableTargetColProperty;
    oTargetTableInfo.oTableRowContext = oTargetTableInfo.oTableRowBindingContexts.find(function (rowContext) {
      return rowContext && oMessageObject.getTargets()[0].indexOf(rowContext.getPath()) === 0;
    });
    return oTargetTableInfo;
  }

  /**
   *
   * @param aControlIds
   * @param oItem
   * @returns True if the item matches one of the controls
   */
  function fnFilterUponIds(aControlIds, oItem) {
    return aControlIds.some(function (sControlId) {
      if (sControlId === oItem.getId()) {
        return true;
      }
      return false;
    });
  }

  /**
   * This function gives the group name having section and subsection data.
   *
   * @param section
   * @param subSection
   * @param bMultipleSubSections
   * @param oTargetTableInfo
   * @param oResourceBundle
   * @returns Group name.
   */
  function createSectionGroupName(section, subSection, bMultipleSubSections, oTargetTableInfo, oResourceBundle) {
    return section.getTitle() + (subSection.getTitle() && bMultipleSubSections ? `, ${subSection.getTitle()}` : "") + (oTargetTableInfo ? `, ${oResourceBundle.getText("T_MESSAGE_GROUP_TITLE_TABLE_DENOMINATOR")}: ${oTargetTableInfo.tableHeader}` : "");
  }
  function bIsOrphanElement(oElement, aElements) {
    return !aElements.some(function (oElem) {
      let oParentElement = oElement.getParent();
      while (oParentElement && oParentElement !== oElem) {
        oParentElement = oParentElement.getParent();
      }
      return oParentElement ? true : false;
    });
  }

  /**
   * Static functions for Fiori Message Handling
   *
   * @namespace
   * @alias sap.fe.core.actions.messageHandling
   * @private
   * @experimental This module is only for experimental use! <br/><b>This is only a POC and maybe deleted</b>
   * @since 1.56.0
   */
  const messageHandling = {
    getMessages: getMessages,
    showUnboundMessages: showUnboundMessages,
    removeUnboundTransitionMessages: removeUnboundTransitionMessages,
    removeBoundTransitionMessages: removeBoundTransitionMessages,
    modifyETagMessagesOnly: fnModifyETagMessagesOnly,
    getRetryAfterMessage: getRetryAfterMessage,
    prepareMessageViewForDialog: prepareMessageViewForDialog,
    setMessageSubtitle: setMessageSubtitle,
    getVisibleSectionsFromObjectPageLayout: getVisibleSectionsFromObjectPageLayout,
    getControlFromMessageRelatingToSubSection: getControlFromMessageRelatingToSubSection,
    fnFilterUponIds: fnFilterUponIds,
    getTableAndTargetInfo: getTableAndTargetInfo,
    createSectionGroupName: createSectionGroupName,
    bIsOrphanElement: bIsOrphanElement,
    getLastActionTextAndActionName: getLastActionTextAndActionName,
    getTableColumnDataAndSetSubtile: getTableColumnDataAndSetSubtile,
    getTableColInfo: getTableColInfo,
    getTableColProperty: getTableColProperty,
    getMessageSubtitle: getMessageSubtitle,
    determineColumnInfo: determineColumnInfo,
    fetchColumnInfo: fetchColumnInfo,
    getTableFirstColBindingContextForTextAnnotation: getTableFirstColBindingContextForTextAnnotation,
    getMessageRank: getMessageRank,
    fnCallbackSetGroupName: fnCallbackSetGroupName,
    getTableFirstColValue: getTableFirstColValue,
    setGroupNameOPDisplayMode: setGroupNameOPDisplayMode,
    updateMessageObjectGroupName: updateMessageObjectGroupName,
    setGroupNameLRTable: setGroupNameLRTable,
    isControlInTable: isControlInTable,
    isControlPartOfCreationRow: isControlPartOfCreationRow
  };
  return messageHandling;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/messageHandler/messageHandling", ["sap/m/Bar","sap/m/Button","sap/m/Dialog","sap/m/FormattedText","sap/m/MessageBox","sap/m/MessageItem","sap/m/MessageToast","sap/m/MessageView","sap/m/Text","sap/ui/core/Core","sap/ui/core/format/DateFormat","sap/ui/core/IconPool","sap/ui/core/library","sap/ui/core/message/Message","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","../../CommonUtils"],function(e,t,n,o,r,a,i,s,l,u,g,c,f,d,p,T,m,E,_){"use strict";const S=f.MessageType;let A=[];let C=[];let h=[];let M;let b;let I;function N(){let e;function t(e){return e.property?"( ${"+e.property+'} ? ("<p>'+e.property.substr(Math.max(e.property.lastIndexOf("/"),e.property.lastIndexOf("."))+1)+' : " + '+"${"+e.property+'} + "</p>") : "" )':""}function n(t){let n="";if(t.groupName&&t.property&&t.groupName!==e){n+="( ${"+t.property+'} ? "<br><h3>'+t.groupName+'</h3>" : "" ) + ';e=t.groupName}return n}function o(){const e="technicalDetails";return[{groupName:"",property:`${e}/status`},{groupName:"",property:`${e}/statusText`},{groupName:"Application",property:`${e}/error/@SAP__common.Application/ComponentId`},{groupName:"Application",property:`${e}/error/@SAP__common.Application/ServiceId`},{groupName:"Application",property:`${e}/error/@SAP__common.Application/ServiceRepository`},{groupName:"Application",property:`${e}/error/@SAP__common.Application/ServiceVersion`},{groupName:"ErrorResolution",property:`${e}/error/@SAP__common.ErrorResolution/Analysis`},{groupName:"ErrorResolution",property:`${e}/error/@SAP__common.ErrorResolution/Note`},{groupName:"ErrorResolution",property:`${e}/error/@SAP__common.ErrorResolution/DetailedNote`},{groupName:"ErrorResolution",property:`${e}/error/@SAP__common.ExceptionCategory`},{groupName:"ErrorResolution",property:`${e}/error/@SAP__common.TimeStamp`},{groupName:"ErrorResolution",property:`${e}/error/@SAP__common.TransactionId`},{groupName:"Messages",property:`${e}/error/code`},{groupName:"Messages",property:`${e}/error/message`}]}let r="Object.keys("+"${technicalDetails}"+').length > 0 ? "<h2>Technical Details</h2>" : "" ';o().forEach(function(e){r=`${r+n(e)}${t(e)} + `});return r}function R(){return"(${"+'description} ? ("<h2>Description</h2>" + ${'+'description}) : "")'}function P(e){let t=S.None;const n=e.length;const o={Error:0,Warning:0,Success:0,Information:0};for(let t=0;t<n;t++){++o[e[t].getType()]}if(o[S.Error]>0){t=S.Error}else if(o[S.Warning]>0){t=S.Warning}else if(o[S.Success]>0){t=S.Success}else if(o[S.Information]>0){t=S.Information}return t}function x(e,t,n){const o=e.getMessageModel().getObject("/");let r=false;let a="";o.forEach(function(i,s){const l=i.getTechnicalDetails&&i.getTechnicalDetails();if(l&&l.httpStatus===412){if(l.isConcurrentModification&&n){a=a||t.getText("C_APP_COMPONENT_SAPFE_ETAG_TECHNICAL_ISSUES_CONCURRENT_MODIFICATION")}else{a=a||t.getText("C_APP_COMPONENT_SAPFE_ETAG_TECHNICAL_ISSUES")}e.removeMessages(o[s]);i.setMessage(a);i.target="";e.addMessages(i);r=true}});return r}function O(){M.close();b.setVisible(false);A=[];const e=I.getModel();if(e){e.setData({})}Q()}function y(e,t){const n=new Date;const o=e.getTechnicalDetails();const r=u.getLibraryResourceBundle("sap.fe.core");let a;if(o&&o.httpStatus===503&&o.retryAfter){const e=o.retryAfter;let i;if(n.getFullYear()!==e.getFullYear()){i=g.getDateTimeInstance({pattern:"MMMM dd, yyyy 'at' hh:mm a"});a=r.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR",[i.format(e)])}else if(n.getFullYear()==e.getFullYear()){if(t){a=`${r.getText("C_MESSAGE_HANDLING_SAPFE_503_TITLE")} ${r.getText("C_MESSAGE_HANDLING_SAPFE_503_DESC")}`}else if(n.getMonth()!==e.getMonth()||n.getDate()!==e.getDate()){i=g.getDateTimeInstance({pattern:"MMMM dd 'at' hh:mm a"});a=r.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR",[i.format(e)])}else{i=g.getDateTimeInstance({pattern:"hh:mm a"});a=r.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR_DAY",[i.format(e)])}}}if(o&&o.httpStatus===503&&!o.retryAfter){a=r.getText("C_MESSAGE_HANDLING_SAPFE_503_ERROR_NO_RETRY_AFTER")}return a}function v(e,n,o){let r;if(!n){r=new a(undefined,{counter:{path:"counter"},title:"{message}",subtitle:"{additionalText}",longtextUrl:"{descriptionUrl}",type:{path:"type"},groupName:"{headerName}",description:"{= ${"+"description} || ${technicalDetails} ? "+'"<html><body>" + '+R()+" + "+N()+'"</body></html>"'+' : "" }',markupDescription:true})}else if(o){r=new a(undefined,{counter:{path:"counter"},title:"{message}",subtitle:"{additionalText}",longtextUrl:"{descriptionUrl}",type:{path:"type"},description:"{description}",markupDescription:true})}else{r=new a({title:"{message}",type:{path:"type"},longtextUrl:"{descriptionUrl}"})}I=new s({showDetailsPageHeader:false,itemSelect:function(){b.setVisible(true)},items:{path:"/",template:r}});I.setGroupItems(true);b=b||new t({icon:c.getIconURI("nav-back"),visible:false,press:function(){I.navigateBack();this.setVisible(false)}});I.setModel(e);return{oMessageView:I,oBackButton:b}}function G(a,s,g,c,f,_,N,R,x){let G=this.getMessages();const D=u.getMessageManager();let $;let L;const w=[new p({path:"persistent",operator:T.NE,value1:false})];let F=false,U=false;if(g){G=G.concat(J(true,true));w.push(new p({path:"persistent",operator:T.EQ,value1:true}));const e=function(e){let t=Infinity,o=u.byId(e[0]);const r=u.byId(e[0]);while(o){const e=o instanceof n?r.getParent().findElements(true).indexOf(r):Infinity;if(o instanceof n){if(t>e){t=e;r.focus()}return false}o=o.getParent()}return true};w.push(new p({path:"controlIds",test:e,caseSensitive:true}))}else{w.push(new p({path:"target",operator:T.EQ,value1:""}))}if(a&&a.length){a.forEach(function(e){const t=e.code?e.code:"";D.addMessages(new d({message:e.text,type:e.type,target:"",persistent:true,code:t}))})}const H=I&&I.getModel()||new m;const V=this.modifyETagMessagesOnly(D,u.getLibraryResourceBundle("sap.fe.core"),c);if(G.length===1&&G[0].getCode()==="503"){U=true}else if(G.length!==0){F=true}let j;let k=[];if(F||!U&&!R){const e=D.getMessageModel().bindList("/",undefined,undefined,w),t=e.getCurrentContexts();if(t&&t.length>0){F=true;const e=[];t.forEach(function(t){const n=t.getObject();e.push(n);C=e});let n=[];if(Array.isArray(H.getData())){n=H.getData()}const o={};k=C.concat(n).filter(function(e){return!o[e.id]&&(o[e.id]=true)});H.setData(k)}}if(R){j={showMessageBox:U,showMessageDialog:F};j=R(G,j);U=j.showMessageBox;F=j.showMessageDialog;if(F){k=j.filteredMessages?j.filteredMessages:k}}if(G.length===0&&!a&&!V){return Promise.resolve(true)}else if(G.length===1&&G[0].getType()===S.Success&&!a){return new Promise(e=>{i.show(G[0].message);if(H){H.setData({})}D.removeMessages(G);e()})}else if(F){ue.updateMessageObjectGroupName(k,f,_,x);H.setData(k);h=h||[];return new Promise(function(o,r){h.push(o);u.getLibraryResourceBundle("sap.fe.core",true).then(function(r){const a=false;if(j&&j.fnGetMessageSubtitle){H.getData().forEach(function(e){j.fnGetMessageSubtitle(e)})}const i=v(H,a);const u=new E("",undefined,undefined,(e,t)=>{const n=B(e);const o=B(t);if(n<o){return-1}if(n>o){return 1}return 0});i.oMessageView.getBinding("items").sort(u);M=M&&M.isOpen()?M:new n({resizable:true,endButton:new t({press:function(){O();D.removeMessages(k)},text:r.getText("C_COMMON_SAPFE_CLOSE")}),customHeader:new e({contentMiddle:[new l({text:r.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE")})],contentLeft:[b]}),contentWidth:"37.5em",contentHeight:"21.5em",verticalScrolling:false,afterClose:function(){for(let e=0;e<h.length;e++){h[e].call()}h=[]}});M.removeAllContent();M.addContent(i.oMessageView);if(V){sap.ui.require(["sap/m/ButtonType"],function(e){M.setBeginButton(new t({press:function(){O();if(s.hasPendingChanges()){s.getBinding().resetChanges()}s.refresh()},text:r.getText("C_COMMON_SAPFE_REFRESH"),type:e.Emphasized}))})}else{M.destroyBeginButton()}$=P(I.getItems());L=z($);M.setState($);M.getCustomHeader().getContentMiddle()[0].setText(L);I.navigateBack();M.open();if(N){o(M)}}).catch(r)})}else if(U){return new Promise(function(e){const t=G[0];if(t.technicalDetails&&A.indexOf(t.technicalDetails.originalMessage.message)===-1){A.push(t.technicalDetails.originalMessage.message);let n="<html><body>";const a=y(t,true);if(a){n=`<h6>${a}</h6><br>`}if(j&&j.fnGetMessageSubtitle){j.fnGetMessageSubtitle(t)}if(t.getCode()!=="503"&&t.getAdditionalText()!==undefined){n=`${n+t.getAdditionalText()}: ${t.getMessage()}</html></body>`}else{n=`${n+t.getMessage()}</html></body>`}const i=new o({htmlText:n});r.error(i,{onClose:function(){A=[];if(g){X()}Q();e(true)}})}})}else{return Promise.resolve(true)}}function D(e,t,n,o){e.forEach(e=>{var r;e["headerName"]="";if(!((r=e.target)!==null&&r!==void 0&&r.length)){e["headerName"]="General"}else if(e.target.length){if(o==="ListReport"){ue.setGroupNameLRTable(t,e,n)}else if(o==="ObjectPage"){ue.setGroupNameOPDisplayMode(e,n,t)}else{e["headerName"]=ue.getLastActionTextAndActionName(n)}}})}function $(e,t,n){const o=e&&e.getRowBinding();if(o){var r;const o=`${e.getRowBinding().getPath()}`;if(((r=t.target)===null||r===void 0?void 0:r.indexOf(o))===0){const o=e.getRowBinding().getContexts();o.forEach(o=>{var r;if((r=t.target)!==null&&r!==void 0&&r.includes(o.getPath())){const r=`${o.getPath()}/`;const a=e.getParent().getIdentifierColumn();const i=a&&o.getObject()[a];const s=ue.getTableColProperty(e,t,r);const{sTableTargetColName:l}=ue.getTableColInfo(e,s);if(s&&l){t["headerName"]=i?` ${i}`:e.getHeader()}else{t["headerName"]=ue.getLastActionTextAndActionName(n)}}})}}}function L(e,t,n){const o=n===null||n===void 0?void 0:n.getBindingContext();const r=(n===null||n===void 0?void 0:n.getContent)&&(n===null||n===void 0?void 0:n.getContent()[0]);let a=true;if(r){ue.getVisibleSectionsFromObjectPageLayout(r).forEach(function(n){const r=n.getSubSections();r.forEach(function(n){n.findElements(true).forEach(function(r){if(r.isA("sap.ui.mdc.Table")){const l=r.getRowBinding(),g=true;let c;r.findElements(true).forEach(e=>{if(e.isA("sap.m.Table")||e.isA("sap.ui.table.Table")){c=e}});if(l){var i,s;const f=`${o===null||o===void 0?void 0:o.getPath()}/${(i=r.getRowBinding())===null||i===void 0?void 0:i.getPath()}`;if(((s=e.target)===null||s===void 0?void 0:s.indexOf(f))===0){const o=ue.getTableColumnDataAndSetSubtile(e,r,c,l,t,g,F);const{oTargetTableInfo:i}=o;if(g){const t=r.getParent().getIdentifierColumn();if(t){const n=r.getRowBinding().getContexts();n.forEach(n=>{var o;if((o=e.target)!==null&&o!==void 0&&o.includes(n.getPath())){const o=t?n.getObject()[t]:undefined;e["additionalText"]=`${o}, ${i.sTableTargetColName}`}})}else{e["additionalText"]=`${i.sTableTargetColName}`}let o=r.getHeaderVisible()&&i.tableHeader;if(!o){o=n.getTitle()}else{const e=u.getLibraryResourceBundle("sap.fe.core");o=`${e.getText("T_MESSAGE_GROUP_TITLE_TABLE_DENOMINATOR")}: ${o}`}e["headerName"]=o;a=false}}}}})})})}if(a){var i;const n=`${o===null||o===void 0?void 0:o.getPath()}`;if(((i=e.target)===null||i===void 0?void 0:i.indexOf(n))===0){const n=ue.getLastActionTextAndActionName(t);e["headerName"]=n}else{e["headerName"]="General"}}}function w(e){const t=u.getLibraryResourceBundle("sap.fe.core").getText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_LAST_ACTION");return e?`${t}: ${e}`:""}function B(e){var t,n;if((t=e.headerName)!==null&&t!==void 0&&t.toString().includes("Last Action")){return 1}else if((n=e.headerName)!==null&&n!==void 0&&n.toString().includes("General")){return 3}else{return 2}}const F=(e,t,n)=>{if(n){const t=u.getLibraryResourceBundle("sap.fe.core").getText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_GENERAL");e["headerName"]=t}else{e["headerName"]=ue.getLastActionTextAndActionName(t)}};function U(e,t,n,o,r,a,i){const s=ue.getTableAndTargetInfo(t,e,n,o);const l=u.getLibraryResourceBundle("sap.fe.core");s.tableHeader=t.getHeader();let g,c;if(!s.oTableRowContext){g=e.getControlIds().find(function(e){return ue.isControlInTable(t,e)})}if(g){const e=u.byId(g);c=ue.isControlPartOfCreationRow(e)}if(!s.sTableTargetColName){if(e.persistent&&r){i(e,r);a=false}}const f=ue.getMessageSubtitle(e,s.oTableRowBindingContexts,s.oTableRowContext,s.sTableTargetColName,l,t,c);return{oTargetTableInfo:s,subTitle:f}}function H(e,t,n,o,r,a,i,s){let l;let u;const g=a.getParent().getIdentifierColumn();const c=ue.fetchColumnInfo(e,a);if(i){l=_.getTranslatedText("T_MESSAGE_ITEM_SUBTITLE",r,[r.getText("T_MESSAGE_ITEM_SUBTITLE_CREATION_ROW_INDICATOR"),o?o:c.label])}else{const e=ue.getTableFirstColBindingContextForTextAnnotation(a,n,g);const i=e?e.getObject("$Path"):undefined;const f=i&&e?e.getObject("@com.sap.vocabularies.UI.v1.TextArrangement/$EnumMember"):undefined;if(t.length>0){if(s){u=s.getValue()}else if(n&&g){u=ue.getTableFirstColValue(g,n,i,f)}else{u=undefined}const e=ue.determineColumnInfo(c,r);if(u&&o){l=_.getTranslatedText("T_MESSAGE_ITEM_SUBTITLE",r,[u,o])}else if(u&&e.sColumnIndicator==="Hidden"){l=`${r.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW")}: ${u}, ${e.sColumnValue}`}else if(u&&e.sColumnIndicator==="Unknown"){l=_.getTranslatedText("T_MESSAGE_ITEM_SUBTITLE",r,[u,e.sColumnValue])}else if(u&&e.sColumnIndicator==="undefined"){l=`${r.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW")}: ${u}`}else if(!u&&o){l=r.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_COLUMN")+": "+o}else if(!u&&e.sColumnIndicator==="Hidden"){l=e.sColumnValue}else{l=null}}else{l=null}}return l}function V(e,t,n){let o;if(t&&n){const r=e===null||e===void 0?void 0:e.getModel();const a=r===null||r===void 0?void 0:r.getMetaModel();const i=a===null||a===void 0?void 0:a.getMetaPath(t.getPath());if(a!==null&&a!==void 0&&a.getObject(`${i}/${n}@com.sap.vocabularies.Common.v1.Text/$Path`)){o=a.createBindingContext(`${i}/${n}@com.sap.vocabularies.Common.v1.Text`)}}return o}function j(e,t,n,o){const r=t.getValue(e);let a;let i=r;if(n){if(e.lastIndexOf("/")>0){e=e.slice(0,e.lastIndexOf("/")+1);e=e.concat(n)}else{e=n}a=t.getValue(e);if(a){if(o){const e=o.slice(o.indexOf("/")+1);switch(e){case"TextOnly":i=a;break;case"TextFirst":i=`${a} (${r})`;break;case"TextLast":i=`${r} (${a})`;break;case"TextSeparate":i=r;break;default:}}else{i=`${a} (${r})`}}}return i}function k(e,t){const n=e===null||e===void 0?void 0:e.getTargets()[0].split("/").pop();return t.getParent().getTableDefinition().columns.find(function(e){return e.key.split("::").pop()===n})}function W(e,t){const n={sColumnIndicator:String,sColumnValue:String};if(e){if(e.availability==="Hidden"){n.sColumnValue=undefined;n.sColumnIndicator="undefined"}else{n.sColumnValue=`${t.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_COLUMN")} (${t.getText("T_COLUMN_INDICATOR_IN_TABLE_DEFINITION")}): ${e.label}`;n.sColumnIndicator="Hidden"}}else{n.sColumnValue=t.getText("T_MESSAGE_ITEM_SUBTITLE_INDICATOR_UNKNOWN");n.sColumnIndicator="Unknown"}return n}function Y(e,t){const n=u.byId(t);if(n&&!n.isA("sap.ui.table.Table")&&!n.isA("sap.m.Table")){return e.findElements(true,function(e){return e.getId()===n})}return false}function K(e){let t=e===null||e===void 0?void 0:e.getParent();while(t&&!((n=t)!==null&&n!==void 0&&n.isA("sap.ui.table.Row"))&&!((o=t)!==null&&o!==void 0&&o.isA("sap.ui.table.CreationRow"))&&!((r=t)!==null&&r!==void 0&&r.isA("sap.m.ColumnListItem"))){var n,o,r;t=t.getParent()}return!!t&&t.isA("sap.ui.table.CreationRow")}function z(e){const t=u.getLibraryResourceBundle("sap.fe.core");switch(e){case"Error":return t.getText("C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR");case"Information":return t.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_INFO");case"Success":return t.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_SUCCESS");case"Warning":return t.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_WARNING");default:return t.getText("C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE")}}function Q(){Z(false)}function X(e){Z(true,e)}function q(e,t){if(t===undefined){return e.getObject("/")}const n=e.bindList("/");n.filter(new p({path:"target",operator:T.StartsWith,value1:t}));return n.getCurrentContexts().map(function(e){return e.getObject()})}function J(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n=arguments.length>2?arguments[2]:undefined;let o;const r=u.getMessageManager(),a=r.getMessageModel(),i=u.getLibraryResourceBundle("sap.fe.core"),s=[];let l=[];if(e&&t&&n){l=q(a,n)}else{l=a.getObject("/")}for(o=0;o<l.length;o++){if((!t||l[o].persistent)&&(e&&l[o].target!==""||!e&&(!l[o].target||l[o].target===""))){s.push(l[o])}}for(o=0;o<s.length;o++){if(s[o].code==="503"&&s[o].message!==""&&s[o].message.indexOf(i.getText("C_MESSAGE_HANDLING_SAPFE_503_BACKEND_PREFIX"))===-1){s[o].message=`\n${i.getText("C_MESSAGE_HANDLING_SAPFE_503_BACKEND_PREFIX")}${s[o].message}`}}const g=[];for(o=0;o<s.length;o++){if(s[o].technicalDetails&&(s[o].technicalDetails.originalMessage!==undefined&&s[o].technicalDetails.originalMessage!==null||s[o].technicalDetails.httpStatus!==undefined&&s[o].technicalDetails.httpStatus!==null)||s[o].code){g.push(s[o])}}return g}function Z(e,t){const n=J(e,true,t);if(n.length>0){u.getMessageManager().removeMessages(n)}}function ee(e,t,n){const o=e.getParent().getIdentifierColumn();const r=t.find(function(e){return n.getTargets()[0].indexOf(e.getPath())!==-1});n.additionalText=r?r.getObject()[o]:undefined}function te(e){return e.getSections().filter(function(e){return e.getVisible()})}function ne(e,t){return e.findElements(true,e=>ie(t.getControlIds(),e)).sort(function(e,t){if(e.isA("sap.ui.mdc.Table")&&!t.isA("sap.ui.mdc.Table")){return-1}return 1})}function oe(e,t,n){const o=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};if(!n){var r;n=new RegExp(`${o(`${(r=e.getBindingContext())===null||r===void 0?void 0:r.getPath()}/${e.getRowBinding().getPath()}`)}\\(.*\\)/`)}return t.getTargets()[0].replace(n,"")}function re(e,t){let n;let o=e.getColumns().find(function(e){return e.getDataProperty()==t});if(!o){const a=e.getControlDelegate().getColumnsFor(e).find(function(e){if(!!e.template&&e.propertyInfos){return e.propertyInfos[0]===t||e.propertyInfos[0].replace("Property::","")===t}else{return false}});if(a){var r;o=a;t=(r=o)===null||r===void 0?void 0:r.name;n=e.getColumns().find(function(e){return t===e.getDataProperty()}).getHeader()}else{const r=e.getControlDelegate().getColumnsFor(e);o=r.find(function(e){if(e.key.indexOf("::FieldGroup::")!==-1){var n;return(n=e.propertyInfos)===null||n===void 0?void 0:n.find(function(){return r.find(function(e){return e.relativePath===t})})}});let a=false;if(o&&o.label){a=e.getColumns().some(function(e){return e.getHeader()===o.label})}n=a&&o.label;t=a&&o.key}}else{n=o&&o.getHeader()}return{sTableTargetColName:n,sTableTargetColProperty:t}}function ae(e,t,n,o){const r={};r.sTableTargetColProperty=oe(e,t);const a=re(e,r.sTableTargetColProperty);r.oTableRowBindingContexts=n.isA("sap.ui.table.Table")?o.getContexts():o.getCurrentContexts();r.sTableTargetColName=a.sTableTargetColName;r.sTableTargetColProperty=a.sTableTargetColProperty;r.oTableRowContext=r.oTableRowBindingContexts.find(function(e){return e&&t.getTargets()[0].indexOf(e.getPath())===0});return r}function ie(e,t){return e.some(function(e){if(e===t.getId()){return true}return false})}function se(e,t,n,o,r){return e.getTitle()+(t.getTitle()&&n?`, ${t.getTitle()}`:"")+(o?`, ${r.getText("T_MESSAGE_GROUP_TITLE_TABLE_DENOMINATOR")}: ${o.tableHeader}`:"")}function le(e,t){return!t.some(function(t){let n=e.getParent();while(n&&n!==t){n=n.getParent()}return n?true:false})}const ue={getMessages:J,showUnboundMessages:G,removeUnboundTransitionMessages:Q,removeBoundTransitionMessages:X,modifyETagMessagesOnly:x,getRetryAfterMessage:y,prepareMessageViewForDialog:v,setMessageSubtitle:ee,getVisibleSectionsFromObjectPageLayout:te,getControlFromMessageRelatingToSubSection:ne,fnFilterUponIds:ie,getTableAndTargetInfo:ae,createSectionGroupName:se,bIsOrphanElement:le,getLastActionTextAndActionName:w,getTableColumnDataAndSetSubtile:U,getTableColInfo:re,getTableColProperty:oe,getMessageSubtitle:H,determineColumnInfo:W,fetchColumnInfo:k,getTableFirstColBindingContextForTextAnnotation:V,getMessageRank:B,fnCallbackSetGroupName:F,getTableFirstColValue:j,setGroupNameOPDisplayMode:L,updateMessageObjectGroupName:D,setGroupNameLRTable:$,isControlInTable:Y,isControlPartOfCreationRow:K};return ue},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/pageReady/DataQueryWatcher-dbg", ["sap/base/Log", "sap/fe/macros/table/Utils"], function (Log, Utils) {
  "use strict";

  let DataQueryWatcher = /*#__PURE__*/function () {
    function DataQueryWatcher(_oEventProvider, _fnOnFinished) {
      this._aBindingRegistrations = [];
      this._aOtherEventSources = [];
      this._isSearchPending = false;
      this._aMDCTables = [];
      this._aMDCCharts = [];
      this._oEventProvider = _oEventProvider;
      this._fnOnFinished = _fnOnFinished;
    }
    // Accessors
    var _proto = DataQueryWatcher.prototype;
    _proto.isSearchPending = function isSearchPending() {
      return this._isSearchPending;
    };
    _proto.isDataReceived = function isDataReceived() {
      return this._isDataReceived;
    };
    _proto.resetDataReceived = function resetDataReceived() {
      this._isDataReceived = undefined;
    }
    /**
     * Reset the state: unsubscribe to all data events and remove all registered objects.
     */;
    _proto.reset = function reset() {
      // Remove all remaining callbacks
      this._aBindingRegistrations.forEach(reg => {
        reg.binding.detachEvent("dataRequested", this.onDataRequested, this);
        reg.binding.detachEvent("dataReceived", this.onDataReceived, this);
      });
      this._aOtherEventSources.forEach(oElement => {
        oElement.detachEvent("search", this.onSearch, this);
        oElement.detachEvent("bindingUpdated", this.register, this);
      });
      this._aBindingRegistrations = [];
      this._aOtherEventSources = [];
      this._aMDCTables = [];
      this._aMDCCharts = [];
      this._isSearchPending = false;
      this._isDataReceived = undefined;
    }
    // //////////////////////////////////////////////////
    // Callback when data is received on a binding.
    ;
    _proto.onDataReceived = function onDataReceived(oEvent, params) {
      // Look for the corresponding binding registration
      const binding = oEvent.getSource();
      const bindingRegistration = this._aBindingRegistrations.find(reg => {
        return reg.binding === binding;
      });
      if (!bindingRegistration) {
        Log.error("PageReady - data received on an unregistered binding");
        return;
      }
      switch (binding.getGroupId()) {
        case "$auto.Workers":
          this._oEventProvider.fireEvent("workersBatchReceived");
          break;
        case "$auto.Heroes":
          this._oEventProvider.fireEvent("heroesBatchReceived");
          break;
        default:
      }
      bindingRegistration.receivedCount++;
      if (bindingRegistration.receivedCount < bindingRegistration.requestedCount) {
        // There are other request pending --> resubscribe to wait until they return
        binding.attachEventOnce("dataReceived", {
          triggeredBySearch: params.triggeredBySearch
        }, this.onDataReceived, this);
        return;
      }
      // Check if at least one binding has requested data, and all bindings that have requested data have received it
      const bAllDone = this._aBindingRegistrations.some(reg => {
        return reg.requestedCount !== 0;
      }) && this._aBindingRegistrations.every(reg => {
        return reg.requestedCount === 0 || reg.receivedCount >= reg.requestedCount;
      });
      if (params.triggeredBySearch || bindingRegistration.receivedCount >= bindingRegistration.requestedCount) {
        this._isSearchPending = false;
      }
      if (bAllDone) {
        this._isDataReceived = true;
        this._fnOnFinished();
      }
    }
    // //////////////////////////////////////////////////
    // Callback when data is requested on a binding.
    ;
    _proto.onDataRequested = function onDataRequested(oEvent, params) {
      // Look for the corresponding binding registration
      const binding = oEvent.getSource();
      const bindingRegistration = this._aBindingRegistrations.find(reg => {
        return reg.binding === binding;
      });
      if (!bindingRegistration) {
        Log.error("PageReady - data requested on an unregistered binding");
        return;
      }
      bindingRegistration.requestedCount++;
      this._isDataReceived = false;
      if (bindingRegistration.requestedCount - bindingRegistration.receivedCount === 1) {
        // Listen to dataReceived only if there's no other request pending
        // Otherwise the 'dataReceived' handler would be called several times when the first query returns
        // and we wouldn't wait for all queries to be finished
        // (we will resubscribe to the dataReceived event in onDataReceived if necessary)
        binding.attachEventOnce("dataReceived", {
          triggeredBySearch: params.triggeredBySearch
        }, this.onDataReceived, this);
      }
    }
    // //////////////////////////////////////////////////
    // Callback when a search is triggered from a filterbar
    ;
    _proto.onSearch = function onSearch(oEvent) {
      const aMDCTableLinkedToFilterBar = this._aMDCTables.filter(oTable => {
        var _oTable$getParent;
        return oEvent.getSource().sId === oTable.getFilter() && oTable.getVisible() && !((_oTable$getParent = oTable.getParent()) !== null && _oTable$getParent !== void 0 && _oTable$getParent.getProperty("bindingSuspended"));
      });
      const aMDCChartsLinkedToFilterBar = this._aMDCCharts.filter(oChart => {
        return oEvent.getSource().sId === oChart.getFilter() && oChart.getVisible();
      });
      if (aMDCTableLinkedToFilterBar.length > 0 || aMDCChartsLinkedToFilterBar.length > 0) {
        this._isSearchPending = true;
      }
      aMDCTableLinkedToFilterBar.forEach(oTable => {
        this.registerTable(oTable, true);
      });
      aMDCChartsLinkedToFilterBar.forEach(async oChart => {
        try {
          if (oChart.innerChartBoundPromise) {
            await oChart.innerChartBoundPromise;
          }
          this.registerChart(oChart, true);
        } catch (oError) {
          Log.error("Cannot find a inner bound chart", oError);
        }
      });
    }
    // //////////////////////////////////////////////////
    // Register a binding (with an optional table/chart)
    // and attach callbacks on dateRequested/dataReceived events
    ;
    _proto.register = function register(_event, data) {
      var _data$table, _data$chart;
      const binding = data.binding || ((_data$table = data.table) === null || _data$table === void 0 ? void 0 : _data$table.getRowBinding()) || ((_data$chart = data.chart) === null || _data$chart === void 0 ? void 0 : _data$chart.getControlDelegate().getInnerChart(data.chart).getBinding("data"));
      const boundControl = data.table || data.chart;
      if (!binding) {
        return;
      }
      // Check if the binding is already registered
      let bindingRegistration = this._aBindingRegistrations.find(reg => {
        return reg.binding === binding;
      });
      if (bindingRegistration) {
        if (boundControl) {
          // The binding was already registerd without boundControl information --> update boundControl
          bindingRegistration.boundControl = boundControl;
        }
        // This binding has already requested data, but we're registering it again (on search) --> attach to dataRequested again
        if (bindingRegistration.requestedCount > 0) {
          binding.detachEvent("dataRequested", this.onDataRequested, this);
          binding.attachEventOnce("dataRequested", {
            triggeredBySearch: data.triggeredBySearch
          }, this.onDataRequested, this);
        }
        return;
      }
      if (boundControl) {
        // Check if there's a different binding registered for the bound control
        bindingRegistration = this._aBindingRegistrations.find(reg => {
          return reg.boundControl === boundControl;
        });
        if (bindingRegistration && bindingRegistration.binding !== binding) {
          // The control had a different binding. This can happen in case of MDC charts who recreated their binding after search
          // The previous binding is destroyed, we can replace it with the new and reset counters
          bindingRegistration.binding = binding;
          bindingRegistration.requestedCount = 0;
          bindingRegistration.receivedCount = 0;
        }
      }
      if (!bindingRegistration) {
        bindingRegistration = {
          binding: binding,
          boundControl: boundControl,
          requestedCount: 0,
          receivedCount: 0
        };
        this._aBindingRegistrations.push(bindingRegistration);
      }
      binding.detachEvent("dataRequested", this.onDataRequested, this);
      binding.attachEventOnce("dataRequested", {
        triggeredBySearch: data.triggeredBySearch
      }, this.onDataRequested, this);
    }
    /**
     * Registers a binding for watching its data events (dataRequested and dataReceived).
     *
     * @param binding The binding
     */;
    _proto.registerBinding = function registerBinding(binding) {
      this.register(null, {
        binding,
        triggeredBySearch: false
      });
    }
    /**
     * Registers an MDCTable for watching the data events on its row binding (dataRequested and dataReceived).
     *
     * @param table The table
     * @param triggeredBySearch True if this registration is triggered by a filterBar search
     */;
    _proto.registerTable = function registerTable(table) {
      let triggeredBySearch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      if (this._aMDCTables.indexOf(table) < 0) {
        this._aMDCTables.push(table);
      }
      const oRowBinding = table.getRowBinding();
      if (oRowBinding) {
        this.register(null, {
          table,
          triggeredBySearch
        });
      }
      if (this._aOtherEventSources.indexOf(table) === -1) {
        table.attachEvent("bindingUpdated", {
          table,
          triggeredBySearch
        }, this.register, this);
        this._aOtherEventSources.push(table);
      }
    }
    /**
     * Registers an MDCChart for watching the data events on its inner data binding (dataRequested and dataReceived).
     *
     * @param chart The chart
     * @param triggeredBySearch True if this registration is triggered by a filterBar search
     */;
    _proto.registerChart = function registerChart(chart) {
      let triggeredBySearch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      if (this._aMDCCharts.indexOf(chart) < 0) {
        this._aMDCCharts.push(chart);
      }
      const oInnerChart = chart.getControlDelegate().getInnerChart(chart);
      const binding = oInnerChart === null || oInnerChart === void 0 ? void 0 : oInnerChart.getBinding("data");
      if (binding) {
        this.register(null, {
          chart,
          triggeredBySearch
        });
      }
      if (this._aOtherEventSources.indexOf(chart) === -1) {
        chart.attachEvent("bindingUpdated", {
          chart,
          triggeredBySearch
        }, this.register, this);
        this._aOtherEventSources.push(chart);
      }
    }
    /**
     * Registers an MDCTable or MDCChart for watching the data events on its inner data binding (dataRequested and dataReceived).
     *
     * @param element  The table or chart
     */;
    _proto.registerTableOrChart = async function registerTableOrChart(element) {
      if (!element.isA("sap.ui.mdc.Table") && !element.isA("sap.ui.mdc.Chart")) {
        return;
      }
      try {
        await element.initialized(); // access binding only after table/chart is bound
        if (element.isA("sap.ui.mdc.Table")) {
          this.registerTable(element);
          //If the autoBindOnInit is enabled, the table will be rebound
          //Then we need to wait for this rebind to occur to ensure the pageReady will also wait for the data to be received
          if (element.getAutoBindOnInit() && element.getDomRef()) {
            await Utils.whenBound(element);
          }
        } else {
          this.registerChart(element);
        }
      } catch (oError) {
        Log.error("PageReady - Cannot register a table or a chart", oError);
      }
    }
    /**
     * Registers an MDCFilterBar for watching its search event.
     *
     * @param filterBar The filter bar
     */;
    _proto.registerFilterBar = function registerFilterBar(filterBar) {
      filterBar.attachEvent("search", this.onSearch, this);
      this._aOtherEventSources.push(filterBar);
    };
    return DataQueryWatcher;
  }();
  return DataQueryWatcher;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/pageReady/DataQueryWatcher", ["sap/base/Log","sap/fe/macros/table/Utils"],function(e,t){"use strict";let i=function(){function i(e,t){this._aBindingRegistrations=[];this._aOtherEventSources=[];this._isSearchPending=false;this._aMDCTables=[];this._aMDCCharts=[];this._oEventProvider=e;this._fnOnFinished=t}var n=i.prototype;n.isSearchPending=function e(){return this._isSearchPending};n.isDataReceived=function e(){return this._isDataReceived};n.resetDataReceived=function e(){this._isDataReceived=undefined};n.reset=function e(){this._aBindingRegistrations.forEach(e=>{e.binding.detachEvent("dataRequested",this.onDataRequested,this);e.binding.detachEvent("dataReceived",this.onDataReceived,this)});this._aOtherEventSources.forEach(e=>{e.detachEvent("search",this.onSearch,this);e.detachEvent("bindingUpdated",this.register,this)});this._aBindingRegistrations=[];this._aOtherEventSources=[];this._aMDCTables=[];this._aMDCCharts=[];this._isSearchPending=false;this._isDataReceived=undefined};n.onDataReceived=function t(i,n){const r=i.getSource();const a=this._aBindingRegistrations.find(e=>e.binding===r);if(!a){e.error("PageReady - data received on an unregistered binding");return}switch(r.getGroupId()){case"$auto.Workers":this._oEventProvider.fireEvent("workersBatchReceived");break;case"$auto.Heroes":this._oEventProvider.fireEvent("heroesBatchReceived");break;default:}a.receivedCount++;if(a.receivedCount<a.requestedCount){r.attachEventOnce("dataReceived",{triggeredBySearch:n.triggeredBySearch},this.onDataReceived,this);return}const s=this._aBindingRegistrations.some(e=>e.requestedCount!==0)&&this._aBindingRegistrations.every(e=>e.requestedCount===0||e.receivedCount>=e.requestedCount);if(n.triggeredBySearch||a.receivedCount>=a.requestedCount){this._isSearchPending=false}if(s){this._isDataReceived=true;this._fnOnFinished()}};n.onDataRequested=function t(i,n){const r=i.getSource();const a=this._aBindingRegistrations.find(e=>e.binding===r);if(!a){e.error("PageReady - data requested on an unregistered binding");return}a.requestedCount++;this._isDataReceived=false;if(a.requestedCount-a.receivedCount===1){r.attachEventOnce("dataReceived",{triggeredBySearch:n.triggeredBySearch},this.onDataReceived,this)}};n.onSearch=function t(i){const n=this._aMDCTables.filter(e=>{var t;return i.getSource().sId===e.getFilter()&&e.getVisible()&&!((t=e.getParent())!==null&&t!==void 0&&t.getProperty("bindingSuspended"))});const r=this._aMDCCharts.filter(e=>i.getSource().sId===e.getFilter()&&e.getVisible());if(n.length>0||r.length>0){this._isSearchPending=true}n.forEach(e=>{this.registerTable(e,true)});r.forEach(async t=>{try{if(t.innerChartBoundPromise){await t.innerChartBoundPromise}this.registerChart(t,true)}catch(t){e.error("Cannot find a inner bound chart",t)}})};n.register=function e(t,i){var n,r;const a=i.binding||((n=i.table)===null||n===void 0?void 0:n.getRowBinding())||((r=i.chart)===null||r===void 0?void 0:r.getControlDelegate().getInnerChart(i.chart).getBinding("data"));const s=i.table||i.chart;if(!a){return}let d=this._aBindingRegistrations.find(e=>e.binding===a);if(d){if(s){d.boundControl=s}if(d.requestedCount>0){a.detachEvent("dataRequested",this.onDataRequested,this);a.attachEventOnce("dataRequested",{triggeredBySearch:i.triggeredBySearch},this.onDataRequested,this)}return}if(s){d=this._aBindingRegistrations.find(e=>e.boundControl===s);if(d&&d.binding!==a){d.binding=a;d.requestedCount=0;d.receivedCount=0}}if(!d){d={binding:a,boundControl:s,requestedCount:0,receivedCount:0};this._aBindingRegistrations.push(d)}a.detachEvent("dataRequested",this.onDataRequested,this);a.attachEventOnce("dataRequested",{triggeredBySearch:i.triggeredBySearch},this.onDataRequested,this)};n.registerBinding=function e(t){this.register(null,{binding:t,triggeredBySearch:false})};n.registerTable=function e(t){let i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(this._aMDCTables.indexOf(t)<0){this._aMDCTables.push(t)}const n=t.getRowBinding();if(n){this.register(null,{table:t,triggeredBySearch:i})}if(this._aOtherEventSources.indexOf(t)===-1){t.attachEvent("bindingUpdated",{table:t,triggeredBySearch:i},this.register,this);this._aOtherEventSources.push(t)}};n.registerChart=function e(t){let i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(this._aMDCCharts.indexOf(t)<0){this._aMDCCharts.push(t)}const n=t.getControlDelegate().getInnerChart(t);const r=n===null||n===void 0?void 0:n.getBinding("data");if(r){this.register(null,{chart:t,triggeredBySearch:i})}if(this._aOtherEventSources.indexOf(t)===-1){t.attachEvent("bindingUpdated",{chart:t,triggeredBySearch:i},this.register,this);this._aOtherEventSources.push(t)}};n.registerTableOrChart=async function i(n){if(!n.isA("sap.ui.mdc.Table")&&!n.isA("sap.ui.mdc.Chart")){return}try{await n.initialized();if(n.isA("sap.ui.mdc.Table")){this.registerTable(n);if(n.getAutoBindOnInit()&&n.getDomRef()){await t.whenBound(n)}}else{this.registerChart(n)}}catch(t){e.error("PageReady - Cannot register a table or a chart",t)}};n.registerFilterBar=function e(t){t.attachEvent("search",this.onSearch,this);this._aOtherEventSources.push(t)};return i}();return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/routing/NavigationReason-dbg", [], function () {
  "use strict";

  var NavigationReason;
  (function (NavigationReason) {
    NavigationReason["RowPress"] = "RowPress";
    NavigationReason["AppStateChanged"] = "AppStateChanged";
  })(NavigationReason || (NavigationReason = {}));
  return NavigationReason;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/routing/NavigationReason", [],function(){"use strict";var e;(function(e){e["RowPress"]="RowPress";e["AppStateChanged"]="AppStateChanged"})(e||(e={}));return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/routing/RouterProxy-dbg", ["sap/base/Log", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/Synchronization", "sap/ui/base/Object", "sap/ui/core/Core", "sap/ui/thirdparty/URI"], function (Log, ClassSupport, Synchronization, BaseObject, Core, URI) {
  "use strict";

  var _dec, _class;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  const enumState = {
    EQUAL: 0,
    COMPATIBLE: 1,
    ANCESTOR: 2,
    DIFFERENT: 3
  };
  const enumURLParams = {
    LAYOUTPARAM: "layout",
    IAPPSTATEPARAM: "sap-iapp-state"
  };

  /**
   * Creates a HashGuard object.
   *
   * @param sGuardHash The hash used for the guard
   * @returns The created hash guard
   */
  function createGuardFromHash(sGuardHash) {
    return {
      _guardHash: sGuardHash.replace(/\?[^\?]*$/, ""),
      // Remove query part
      check: function (sHash) {
        return sHash.indexOf(this._guardHash) === 0;
      }
    };
  }
  /**
   * Returns the iAppState part from a hash (or null if not found).
   *
   * @param sHash The hash
   * @returns The iAppState part of the hash
   */
  function findAppStateInHash(sHash) {
    const aAppState = sHash.match(new RegExp(`\\?.*${enumURLParams.IAPPSTATEPARAM}=([^&]*)`));
    return aAppState && aAppState.length > 1 ? aAppState[1] : null;
  }
  /**
   * Returns a hash without its iAppState part.
   *
   * @param sHash The hash
   * @returns The hash without the iAppState
   */
  function removeAppStateInHash(sHash) {
    return sHash.replace(new RegExp(`[&?]*${enumURLParams.IAPPSTATEPARAM}=[^&]*`), "");
  }
  /**
   * Adds an iAppState inside a hash (or replaces an existing one).
   *
   * @param sHash The hash
   * @param sAppStateKey The iAppState to add
   * @returns The hash with the app state
   */
  function setAppStateInHash(sHash, sAppStateKey) {
    let sNewHash;
    if (sHash.indexOf(enumURLParams.IAPPSTATEPARAM) >= 0) {
      // If there's already an iAppState parameter in the hash, replace it
      sNewHash = sHash.replace(new RegExp(`${enumURLParams.IAPPSTATEPARAM}=[^&]*`), `${enumURLParams.IAPPSTATEPARAM}=${sAppStateKey}`);
    } else {
      // Add the iAppState parameter in the hash
      if (sHash.indexOf("?") < 0) {
        sNewHash = `${sHash}?`;
      } else {
        sNewHash = `${sHash}&`;
      }
      sNewHash += `${enumURLParams.IAPPSTATEPARAM}=${sAppStateKey}`;
    }
    return sNewHash;
  }
  let RouterProxy = (_dec = defineUI5Class("sap.fe.core.RouterProxy"), _dec(_class = /*#__PURE__*/function (_BaseObject) {
    _inheritsLoose(RouterProxy, _BaseObject);
    function RouterProxy() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _BaseObject.call(this, ...args) || this;
      _this.bIsRebuildHistoryRunning = false;
      _this.bIsComputingTitleHierachy = false;
      _this.bIsGuardCrossAllowed = false;
      _this.sIAppStateKey = null;
      _this._bActivateRouteMatchSynchro = false;
      _this._bApplyRestore = false;
      _this._bDelayedRebuild = false;
      _this._pathMappings = [];
      return _this;
    }
    var _proto = RouterProxy.prototype;
    _proto.init = function init(oAppComponent, isfclEnabled) {
      // Save the name of the app (including startup parameters) for rebuilding full hashes later
      oAppComponent.getService("shellServices").then(() => {
        this._oShellServices = oAppComponent.getShellServices();
        this.initRaw(oAppComponent.getRouter());
        // We want to wait until the initial routeMatched is done before doing any navigation
        this.waitForRouteMatchBeforeNavigation();

        // Set feLevel=0 for the first Application page in the history
        history.replaceState(Object.assign({
          feLevel: 0
        }, history.state), "", window.location);
        this.fclEnabled = isfclEnabled;
        this._fnBlockingNavFilter = this._blockingNavigationFilter.bind(this);
        this._oShellServices.registerNavigationFilter(this._fnBlockingNavFilter);
      }).catch(function (oError) {
        Log.error("Cannot retrieve the shell services", oError);
      });
      this._fnHashGuard = this.hashGuard.bind(this);
      window.addEventListener("popstate", this._fnHashGuard);
      this._bDisableOnHashChange = false;
      this._bIgnoreRestore = false;
      this._bForceFocus = true; // Trigger the focus mechanism for the first view displayed by the app
    };
    _proto.destroy = function destroy() {
      if (this._oShellServices) {
        this._oShellServices.unregisterNavigationFilter(this._fnBlockingNavFilter);
      }
      window.removeEventListener("popstate", this._fnHashGuard);
    }

    /**
     * Raw initialization (for unit tests).
     *
     * @param oRouter The router used by this proxy
     */;
    _proto.initRaw = function initRaw(oRouter) {
      this._oRouter = oRouter;
      this._oManagedHistory = [];
      this._oNavigationGuard = null;
      const sCurrentAppHash = this.getHash();
      this._oManagedHistory.push(this._extractStateFromHash(sCurrentAppHash));

      // Set the iAppState if the initial hash contains one
      this.sIAppStateKey = findAppStateInHash(sCurrentAppHash);
    };
    _proto.getHash = function getHash() {
      return this._oRouter.getHashChanger().getHash();
    };
    _proto.isFocusForced = function isFocusForced() {
      return this._bForceFocus;
    };
    _proto.setFocusForced = function setFocusForced(bForced) {
      this._bForceFocus = bForced;
    }

    /**
     * Resets the internal variable sIAppStateKey.
     *
     * @function
     * @name sap.fe.core.RouterProxy#removeIAppStateKey
     * @ui5-restricted
     */;
    _proto.removeIAppStateKey = function removeIAppStateKey() {
      this.sIAppStateKey = null;
    }

    /**
     * Navigates to a specific hash.
     *
     * @function
     * @name sap.fe.core.RouterProxy#navToHash
     * @memberof sap.fe.core.RouterProxy
     * @static
     * @param sHash Hash to be navigated to
     * @param bPreserveHistory If set to true, non-ancestor entries in history will be retained
     * @param bDisablePreservationCache If set to true, cache preservation mechanism is disabled for the current navigation
     * @param bForceFocus If set to true, the logic to set the focus once the navigation is finalized will be triggered (onPageReady)
     * @param bPreserveShellBackNavigationHandler If not set to false, the back navigation is set to undefined
     * @returns Promise (resolved when the navigation is finalized) that returns 'true' if a navigation took place, 'false' if the navigation didn't happen
     * @ui5-restricted
     */;
    _proto.navToHash = function navToHash(sHash, bPreserveHistory, bDisablePreservationCache, bForceFocus, bPreserveShellBackNavigationHandler) {
      if (bPreserveShellBackNavigationHandler !== false) {
        this._oShellServices.setBackNavigation();
      }
      if (this._oRouteMatchSynchronization) {
        return this._oRouteMatchSynchronization.waitFor().then(() => {
          this._oRouteMatchSynchronization = undefined;
          return this._internalNavToHash(sHash, bPreserveHistory, bDisablePreservationCache, bForceFocus);
        });
      } else {
        if (this._bActivateRouteMatchSynchro) {
          this.waitForRouteMatchBeforeNavigation();
        }
        return this._internalNavToHash(sHash, bPreserveHistory, bDisablePreservationCache, bForceFocus);
      }
    };
    _proto._internalNavToHash = function _internalNavToHash(sHash, bPreserveHistory, bDisablePreservationCache, bForceFocus) {
      // Add the app state in the hash if needed
      if (this.fclEnabled && this.sIAppStateKey && !findAppStateInHash(sHash)) {
        sHash = setAppStateInHash(sHash, this.sIAppStateKey);
      }
      if (!this.checkHashWithGuard(sHash)) {
        if (!this.oResourceBundle) {
          this.oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
        }

        // We have to use a confirm here for UI consistency reasons, as with some scenarios
        // in the EditFlow we rely on a UI5 mechanism that displays a confirm dialog.
        // eslint-disable-next-line no-alert
        if (!confirm(this.oResourceBundle.getText("C_ROUTER_PROXY_SAPFE_EXIT_NOTSAVED_MESSAGE"))) {
          // The user clicked on Cancel --> cancel navigation
          return Promise.resolve(false);
        }
        this.bIsGuardCrossAllowed = true;
      }

      // In case the navigation will cause a new view to be displayed, we force the focus
      // I.e. if the keys for the hash we're navigating to is a superset of the current hash keys.
      const oNewState = this._extractStateFromHash(sHash);
      if (!this._bForceFocus) {
        // If the focus was already forced, keep it
        const aCurrentHashKeys = this._extractEntitySetsFromHash(this.getHash());
        this._bForceFocus = bForceFocus || aCurrentHashKeys.length < oNewState.keys.length && aCurrentHashKeys.every(function (key, index) {
          return key === oNewState.keys[index];
        });
      }
      const oHistoryAction = this._pushNewState(oNewState, false, bPreserveHistory, bDisablePreservationCache);
      return this._rebuildBrowserHistory(oHistoryAction, false);
    }

    /**
     * Clears browser history if entries have been added without using the RouterProxy.
     * Updates the internal history accordingly.
     *
     * @returns Promise that is resolved once the history is rebuilt
     */;
    _proto.restoreHistory = function restoreHistory() {
      if (this._bApplyRestore) {
        this._bApplyRestore = false;
        let sTargetHash = this.getHash();
        sTargetHash = sTargetHash.replace(/(\?|&)restoreHistory=true/, "");
        const oNewState = this._extractStateFromHash(sTargetHash);
        const oHistoryAction = this._pushNewState(oNewState, true, false, true);
        return this._rebuildBrowserHistory(oHistoryAction, true);
      } else {
        return Promise.resolve();
      }
    }

    /**
     * Navigates back in the history.
     *
     * @returns Promise that is resolved when the navigation is finalized
     */;
    _proto.navBack = function navBack() {
      const sCurrentHash = this.getHash();
      let sPreviousHash;

      // Look for the current hash in the managed history
      for (let i = this._oManagedHistory.length - 1; i > 0; i--) {
        if (this._oManagedHistory[i].hash === sCurrentHash) {
          sPreviousHash = this._oManagedHistory[i - 1].hash;
          break;
        }
      }
      if (sPreviousHash) {
        return this.navToHash(sPreviousHash);
      } else {
        // We couldn't find a previous hash in history
        // This can happen when navigating from a transient hash in a create app, and
        // in that case history.back would go back to the FLP
        window.history.back();
        return Promise.resolve();
      }
    }

    /**
     * Navigates to a route with parameters.
     *
     * @param sRouteName The route name to be navigated to
     * @param oParameters Parameters for the navigation
     * @returns Promise that is resolved when the navigation is finalized
     * @ui5-restricted
     */;
    _proto.navTo = function navTo(sRouteName, oParameters) {
      const sHash = this._oRouter.getURL(sRouteName, oParameters);
      return this.navToHash(sHash, false, oParameters.noPreservationCache, false, !oParameters.bIsStickyMode);
    }

    /**
     * Exits the current app by navigating back
     * to the previous app (if any) or the FLP.
     *
     * @returns Promise that is resolved when we exit the app
     */;
    _proto.exitFromApp = function exitFromApp() {
      return this._oShellServices.backToPreviousApp();
    }

    /**
     * Checks whether a given hash can have an impact on the current state
     * i.e. if the hash is equal, compatible or an ancestor of the current state.
     *
     * @param sHash `true` if there is an impact
     * @returns If there is an impact
     */;
    _proto.isCurrentStateImpactedBy = function isCurrentStateImpactedBy(sHash) {
      if (sHash[0] === "/") {
        sHash = sHash.substring(1);
      }
      const oLocalGuard = createGuardFromHash(sHash);
      return oLocalGuard.check(this.getHash());
    }

    /**
     * Checks if a navigation is currently being processed.
     *
     * @returns `false` if a navigation has been triggered in the RouterProxy and is not yet finalized
     */;
    _proto.isNavigationFinalized = function isNavigationFinalized() {
      return !this.bIsRebuildHistoryRunning && !this._bDelayedRebuild;
    }

    /**
     * Sets the last state as a guard.
     * Each future navigation will be checked against this guard, and a confirmation dialog will
     * be displayed before the navigation crosses the guard (i.e. goes to an ancestor of the guard).
     *
     * @param sHash The hash for the guard
     */;
    _proto.setNavigationGuard = function setNavigationGuard(sHash) {
      this._oNavigationGuard = createGuardFromHash(sHash);
      this.bIsGuardCrossAllowed = false;
    }

    /**
     * Disables the navigation guard.
     */;
    _proto.discardNavigationGuard = function discardNavigationGuard() {
      this._oNavigationGuard = null;
    }

    /**
     * Checks for the availability of the navigation guard.
     *
     * @returns `true` if navigating guard is available
     */;
    _proto.hasNavigationGuard = function hasNavigationGuard() {
      return this._oNavigationGuard !== null;
    }

    /**
     * Tests a hash against the navigation guard.
     *
     * @param sHash The hash to be tested
     * @returns `true` if navigating to the hash doesn't cross the guard
     */;
    _proto.checkHashWithGuard = function checkHashWithGuard(sHash) {
      return this._oNavigationGuard === null || this._oNavigationGuard.check(sHash);
    }

    /**
     * Checks if the user allowed the navigation guard to be crossed.
     *
     * @returns `true` if crossing the guard has been allowed by the user
     */;
    _proto.isGuardCrossAllowedByUser = function isGuardCrossAllowedByUser() {
      return this.bIsGuardCrossAllowed;
    }

    /**
     * Activates the synchronization for routeMatchedEvent.
     * The next NavToHash call will create a Synchronization object that will be resolved
     * by the corresponding onRouteMatched event, preventing another NavToHash to happen in parallel.
     */;
    _proto.activateRouteMatchSynchronization = function activateRouteMatchSynchronization() {
      this._bActivateRouteMatchSynchro = true;
    }

    /**
     * Resolve the routeMatch synchronization object, unlocking potential pending NavToHash calls.
     */;
    _proto.resolveRouteMatch = function resolveRouteMatch() {
      if (this._oRouteMatchSynchronization) {
        this._oRouteMatchSynchronization.resolve();
      }
    }

    /**
     * Makes sure no navigation can happen before a routeMatch happened.
     */;
    _proto.waitForRouteMatchBeforeNavigation = function waitForRouteMatchBeforeNavigation() {
      this._oRouteMatchSynchronization = new Synchronization();
      this._bActivateRouteMatchSynchro = false;
    };
    _proto._extractEntitySetsFromHash = function _extractEntitySetsFromHash(sHash) {
      if (sHash === undefined) {
        sHash = "";
      }
      const sHashNoParams = sHash.split("?")[0]; // remove params
      const aTokens = sHashNoParams.split("/");
      const names = [];
      aTokens.forEach(sToken => {
        if (sToken.length) {
          names.push(sToken.split("(")[0]);
        }
      });
      return names;
    }

    /**
     * Builds a state from a hash.
     *
     * @param sHash The hash to be used as entry
     * @returns The state
     * @ui5-restricted
     */;
    _proto._extractStateFromHash = function _extractStateFromHash(sHash) {
      if (sHash === undefined) {
        sHash = "";
      }
      const oState = {
        keys: this._extractEntitySetsFromHash(sHash)
      };

      // Retrieve layout (if any)
      const aLayout = sHash.match(new RegExp(`\\?.*${enumURLParams.LAYOUTPARAM}=([^&]*)`));
      oState.sLayout = aLayout && aLayout.length > 1 ? aLayout[1] : null;
      if (oState.sLayout === "MidColumnFullScreen") {
        oState.screenMode = 1;
      } else if (oState.sLayout === "EndColumnFullScreen") {
        oState.screenMode = 2;
      } else {
        oState.screenMode = 0;
      }
      oState.hash = sHash;
      return oState;
    }

    /**
     * Adds a new state into the internal history structure.
     * Makes sure this new state is added after an ancestor.
     * Also sets the iAppState key in the whole history.
     *
     * @memberof sap.fe.core.RouterProxy
     * @param oNewState The new state to be added
     * @param bRebuildOnly `true` if we're rebuilding the history after a shell menu navigation
     * @param bPreserveHistory If set to true, non-ancestor entries in history will be retained
     * @param bDisableHistoryPreservation Disable the mechanism to retained marked entries in cache
     * @returns The new state
     * @ui5-restricted
     * @final
     */;
    _proto._pushNewState = function _pushNewState(oNewState, bRebuildOnly, bPreserveHistory, bDisableHistoryPreservation) {
      const sCurrentHash = this.getHash();
      let lastIndex = this._oManagedHistory.length - 1;
      let iPopCount = bRebuildOnly ? 1 : 0;

      // 1. Do some cleanup in the managed history : in case the user has navigated back in the browser history, we need to remove
      // the states ahead in history and make sure the top state corresponds to the current page
      // We don't do that when restoring the history, as the current state has been added on top of the browser history
      // and is not reflected in the managed history
      if (!bRebuildOnly) {
        while (lastIndex >= 0 && this._oManagedHistory[lastIndex].hash !== sCurrentHash) {
          this._oManagedHistory.pop();
          lastIndex--;
        }
        if (this._oManagedHistory.length === 0) {
          // We couldn't find the current location in the history. This can happen if a browser reload
          // happened, causing a reinitialization of the managed history.
          // In that case, we use the current location as the new starting point in the managed history
          this._oManagedHistory.push(this._extractStateFromHash(sCurrentHash));
          history.replaceState(Object.assign({
            feLevel: 0
          }, history.state), "");
        }
      }

      // 2. Mark the top state as preserved if required
      if (bPreserveHistory && !bDisableHistoryPreservation) {
        this._oManagedHistory[this._oManagedHistory.length - 1].preserved = true;
      }

      // 3. Then pop all states until we find an ancestor of the new state, or we find a state that need to be preserved
      let oLastRemovedItem;
      while (this._oManagedHistory.length > 0) {
        const oTopState = this._oManagedHistory[this._oManagedHistory.length - 1];
        if ((bDisableHistoryPreservation || !oTopState.preserved) && this._compareCacheStates(oTopState, oNewState) !== enumState.ANCESTOR) {
          // The top state is not an ancestor of oNewState and is not preserved --> we can pop it
          oLastRemovedItem = this._oManagedHistory.pop();
          iPopCount++;
        } else if (oTopState.preserved && removeAppStateInHash(oTopState.hash) === removeAppStateInHash(oNewState.hash)) {
          // We try to add a state that is already in cache (due to preserved flag) but with a different iapp-state
          // --> we should delete the previous entry (it will be later replaced by the new one) and stop popping
          oLastRemovedItem = this._oManagedHistory.pop();
          iPopCount++;
          oNewState.preserved = true;
          break;
        } else {
          break; // Ancestor or preserved state found --> we stop popping out states
        }
      }

      // 4. iAppState management
      this.sIAppStateKey = findAppStateInHash(oNewState.hash);
      if (!this.fclEnabled && oLastRemovedItem) {
        const sPreviousIAppStateKey = findAppStateInHash(oLastRemovedItem.hash);
        const oComparisonStateResult = this._compareCacheStates(oLastRemovedItem, oNewState);
        // if current state doesn't contain a i-appstate and this state should replace a state containing a iAppState
        // then the previous iAppState is preserved
        if (!this.sIAppStateKey && sPreviousIAppStateKey && (oComparisonStateResult === enumState.EQUAL || oComparisonStateResult === enumState.COMPATIBLE)) {
          oNewState.hash = setAppStateInHash(oNewState.hash, sPreviousIAppStateKey);
        }
      }

      // 5. Now we can push the state at the top of the internal history
      const bHasSameHash = oLastRemovedItem && oNewState.hash === oLastRemovedItem.hash;
      if (this._oManagedHistory.length === 0 || this._oManagedHistory[this._oManagedHistory.length - 1].hash !== oNewState.hash) {
        this._oManagedHistory.push(oNewState);
      }

      // 6. Determine which actions to do on the history
      if (iPopCount === 0) {
        // No state was popped --> append
        return {
          type: "append"
        };
      } else if (iPopCount === 1) {
        // Only 1 state was popped --> replace current hash unless hash is the same (then nothing to do)
        return bHasSameHash ? {
          type: "none"
        } : {
          type: "replace"
        };
      } else {
        // More than 1 state was popped --> go bakc in history and replace hash if necessary
        return bHasSameHash ? {
          type: "back",
          steps: iPopCount - 1
        } : {
          type: "back-replace",
          steps: iPopCount - 1
        };
      }
    };
    _proto._blockingNavigationFilter = function _blockingNavigationFilter() {
      return this._bDisableOnHashChange ? "Custom" : "Continue";
    }

    /**
     * Disable the routing by calling the router stop method.
     *
     * @function
     * @memberof sap.fe.core.RouterProxy
     * @ui5-restricted
     * @final
     */;
    _proto._disableEventOnHashChange = function _disableEventOnHashChange() {
      this._bDisableOnHashChange = true;
      this._oRouter.stop();
    }

    /**
     * Enable the routing by calling the router initialize method.
     *
     * @function
     * @name sap.fe.core.RouterProxy#_enableEventOnHashChange
     * @memberof sap.fe.core.RouterProxy
     * @param [bIgnoreCurrentHash] Ignore the last hash event triggered before the router has initialized
     * @ui5-restricted
     * @final
     */;
    _proto._enableEventOnHashChange = function _enableEventOnHashChange(bIgnoreCurrentHash) {
      this._bDisableOnHashChange = false;
      this._oRouter.initialize(bIgnoreCurrentHash);
    }

    /**
     * Synchronizes the browser history with the internal history of the routerProxy, and triggers a navigation if needed.
     *
     * @memberof sap.fe.core.RouterProxy
     * @param oHistoryAction Specifies the navigation action to be performed
     * @param bRebuildOnly `true` if internal history is currently being rebuilt
     * @returns Promise (resolved when the navigation is finalized) that returns 'true' if a navigation took place, 'false' if the navigation didn't happen
     * @ui5-restricted
     * @final
     */;
    _proto._rebuildBrowserHistory = function _rebuildBrowserHistory(oHistoryAction, bRebuildOnly) {
      // eslint-disable-next-line @typescript-eslint/no-this-alias
      const that = this;
      return new Promise(resolve => {
        this.bIsRebuildHistoryRunning = true;
        const oTargetState = this._oManagedHistory[this._oManagedHistory.length - 1],
          newLevel = this._oManagedHistory.length - 1;
        function replaceAsync() {
          if (!bRebuildOnly) {
            that._enableEventOnHashChange(true);
          }
          that._oRouter.getHashChanger().replaceHash(oTargetState.hash);
          history.replaceState(Object.assign({
            feLevel: newLevel
          }, history.state), "");
          if (bRebuildOnly) {
            setTimeout(function () {
              // Timeout to let 'hashchange' event be processed before by the HashChanger, so that
              // onRouteMatched notification isn't raised
              that._enableEventOnHashChange(true);
            }, 0);
          }
          that.bIsRebuildHistoryRunning = false;
          resolve(true); // a navigation occurred
        }

        // Async callbacks when navigating back, in order to let all notifications and events get processed
        function backReplaceAsync() {
          window.removeEventListener("popstate", backReplaceAsync);
          setTimeout(function () {
            // Timeout to let 'hashchange' event be processed before by the HashChanger
            replaceAsync();
          }, 0);
        }
        function backAsync() {
          window.removeEventListener("popstate", backAsync);
          that.bIsRebuildHistoryRunning = false;
          resolve(true); // a navigation occurred
        }

        that._bIgnoreRestore = true;
        switch (oHistoryAction.type) {
          case "replace":
            that._oRouter.getHashChanger().replaceHash(oTargetState.hash);
            history.replaceState(Object.assign({
              feLevel: newLevel
            }, history.state), "");
            that.bIsRebuildHistoryRunning = false;
            resolve(true); // a navigation occurred
            break;
          case "append":
            that._oRouter.getHashChanger().setHash(oTargetState.hash);
            history.replaceState(Object.assign({
              feLevel: newLevel
            }, history.state), "");
            that.bIsRebuildHistoryRunning = false;
            resolve(true); // a navigation occurred
            break;
          case "back":
            window.addEventListener("popstate", backAsync);
            history.go(-oHistoryAction.steps);
            break;
          case "back-replace":
            this._disableEventOnHashChange();
            window.addEventListener("popstate", backReplaceAsync);
            history.go(-oHistoryAction.steps);
            break;
          default:
            // No navigation
            this.bIsRebuildHistoryRunning = false;
            resolve(false);
          // no navigation --> resolve to false
        }
      });
    };
    _proto.getLastHistoryEntry = function getLastHistoryEntry() {
      return this._oManagedHistory[this._oManagedHistory.length - 1];
    };
    _proto.setPathMapping = function setPathMapping(mappings) {
      this._pathMappings = mappings.filter(mapping => {
        return mapping.oldPath !== mapping.newPath;
      });
    };
    _proto.hashGuard = function hashGuard() {
      let sHash = window.location.hash;
      if (sHash.indexOf("restoreHistory=true") !== -1) {
        this._bApplyRestore = true;
      } else if (!this.bIsRebuildHistoryRunning) {
        // Check if the hash needs to be changed (this happens in FCL when switching b/w edit and read-only with 3 columns open)
        const mapping = this._pathMappings.find(m => {
          return sHash.indexOf(m.oldPath) >= 0;
        });
        if (mapping) {
          // Replace the current hash
          sHash = sHash.replace(mapping.oldPath, mapping.newPath);
          history.replaceState(Object.assign({}, history.state), "", sHash);
        } else {
          const aHashSplit = sHash.split("&/");
          const sAppHash = aHashSplit[1] ? aHashSplit[1] : "";
          if (this.checkHashWithGuard(sAppHash)) {
            this._bDelayedRebuild = true;
            const oNewState = this._extractStateFromHash(sAppHash);
            this._pushNewState(oNewState, false, false, true);
            setTimeout(() => {
              this._bDelayedRebuild = false;
            }, 0);
          }
        }
      }
    }

    /**
     * Compares 2 states.
     *
     * @param {object} oState1
     * @param {object} oState2
     * @returns {number} The result of the comparison:
     *        - enumState.EQUAL if oState1 and oState2 are equal
     *        - enumState.COMPATIBLE if oState1 and oState2 are compatible
     *        - enumState.ANCESTOR if oState1 is an ancestor of oState2
     *        - enumState.DIFFERENT if the 2 states are different
     */;
    _proto._compareCacheStates = function _compareCacheStates(oState1, oState2) {
      // First compare object keys
      if (oState1.keys.length > oState2.keys.length) {
        return enumState.DIFFERENT;
      }
      let equal = true;
      let index;
      for (index = 0; equal && index < oState1.keys.length; index++) {
        if (oState1.keys[index] !== oState2.keys[index]) {
          equal = false;
        }
      }
      if (!equal) {
        // Some objects keys are different
        return enumState.DIFFERENT;
      }

      // All keys from oState1 are in oState2 --> check if ancestor
      if (oState1.keys.length < oState2.keys.length || oState1.screenMode < oState2.screenMode) {
        return enumState.ANCESTOR;
      }
      if (oState1.screenMode > oState2.screenMode) {
        return enumState.DIFFERENT; // Not sure this case can happen...
      }

      // At this stage, the 2 states have the same object keys (in the same order) and same screenmode
      // They can be either compatible or equal
      return oState1.sLayout === oState2.sLayout ? enumState.EQUAL : enumState.COMPATIBLE;
    }

    /**
     * Checks if back exits the present guard set.
     *
     * @param sPresentHash The current hash. Only used for unit tests.
     * @returns `true` if back exits there is a guard exit on back
     */;
    _proto.checkIfBackIsOutOfGuard = function checkIfBackIsOutOfGuard(sPresentHash) {
      let sPrevHash;
      let sCurrentHash;
      if (sPresentHash === undefined) {
        // We use window.location.hash instead of HashChanger.getInstance().getHash() because the latter
        // replaces characters in the URL (e.g. %24 replaced by $) and it causes issues when comparing
        // with the URLs in the managed history
        const oSplitHash = this._oShellServices.splitHash(window.location.hash);
        if (oSplitHash && oSplitHash.appSpecificRoute) {
          sCurrentHash = oSplitHash.appSpecificRoute;
          if (sCurrentHash.indexOf("&/") === 0) {
            sCurrentHash = sCurrentHash.substring(2);
          }
        } else {
          sCurrentHash = window.location.hash.substring(1); // To remove the '#'
          if (sCurrentHash[0] === "/") {
            sCurrentHash = sCurrentHash.substring(1);
          }
        }
      } else {
        sCurrentHash = sPresentHash;
      }
      sPresentHash = URI.decode(sCurrentHash);
      if (this._oNavigationGuard) {
        for (let i = this._oManagedHistory.length - 1; i > 0; i--) {
          if (this._oManagedHistory[i].hash === sPresentHash) {
            sPrevHash = this._oManagedHistory[i - 1].hash;
            break;
          }
        }
        return !sPrevHash || !this.checkHashWithGuard(sPrevHash);
      }
      return false;
    }

    /**
     * Checks if the last 2 entries in the history share the same context.
     *
     * @returns `true` if they share the same context.
     */;
    _proto.checkIfBackHasSameContext = function checkIfBackHasSameContext() {
      if (this._oManagedHistory.length < 2) {
        return false;
      }
      const oCurrentState = this._oManagedHistory[this._oManagedHistory.length - 1];
      const oPreviousState = this._oManagedHistory[this._oManagedHistory.length - 2];
      return oCurrentState.hash.split("?")[0] === oPreviousState.hash.split("?")[0];
    };
    return RouterProxy;
  }(BaseObject)) || _class);
  return RouterProxy;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controllerextensions/routing/RouterProxy", ["sap/base/Log","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/Synchronization","sap/ui/base/Object","sap/ui/core/Core","sap/ui/thirdparty/URI"],function(t,e,s,i,n,a){"use strict";var o,r;var h=e.defineUI5Class;function u(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;c(t,e)}function c(t,e){c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,s){e.__proto__=s;return e};return c(t,e)}const l={EQUAL:0,COMPATIBLE:1,ANCESTOR:2,DIFFERENT:3};const f={LAYOUTPARAM:"layout",IAPPSTATEPARAM:"sap-iapp-state"};function d(t){return{_guardHash:t.replace(/\?[^\?]*$/,""),check:function(t){return t.indexOf(this._guardHash)===0}}}function g(t){const e=t.match(new RegExp(`\\?.*${f.IAPPSTATEPARAM}=([^&]*)`));return e&&e.length>1?e[1]:null}function p(t){return t.replace(new RegExp(`[&?]*${f.IAPPSTATEPARAM}=[^&]*`),"")}function y(t,e){let s;if(t.indexOf(f.IAPPSTATEPARAM)>=0){s=t.replace(new RegExp(`${f.IAPPSTATEPARAM}=[^&]*`),`${f.IAPPSTATEPARAM}=${e}`)}else{if(t.indexOf("?")<0){s=`${t}?`}else{s=`${t}&`}s+=`${f.IAPPSTATEPARAM}=${e}`}return s}let _=(o=h("sap.fe.core.RouterProxy"),o(r=function(e){u(i,e);function i(){var t;for(var s=arguments.length,i=new Array(s),n=0;n<s;n++){i[n]=arguments[n]}t=e.call(this,...i)||this;t.bIsRebuildHistoryRunning=false;t.bIsComputingTitleHierachy=false;t.bIsGuardCrossAllowed=false;t.sIAppStateKey=null;t._bActivateRouteMatchSynchro=false;t._bApplyRestore=false;t._bDelayedRebuild=false;t._pathMappings=[];return t}var o=i.prototype;o.init=function e(s,i){s.getService("shellServices").then(()=>{this._oShellServices=s.getShellServices();this.initRaw(s.getRouter());this.waitForRouteMatchBeforeNavigation();history.replaceState(Object.assign({feLevel:0},history.state),"",window.location);this.fclEnabled=i;this._fnBlockingNavFilter=this._blockingNavigationFilter.bind(this);this._oShellServices.registerNavigationFilter(this._fnBlockingNavFilter)}).catch(function(e){t.error("Cannot retrieve the shell services",e)});this._fnHashGuard=this.hashGuard.bind(this);window.addEventListener("popstate",this._fnHashGuard);this._bDisableOnHashChange=false;this._bIgnoreRestore=false;this._bForceFocus=true};o.destroy=function t(){if(this._oShellServices){this._oShellServices.unregisterNavigationFilter(this._fnBlockingNavFilter)}window.removeEventListener("popstate",this._fnHashGuard)};o.initRaw=function t(e){this._oRouter=e;this._oManagedHistory=[];this._oNavigationGuard=null;const s=this.getHash();this._oManagedHistory.push(this._extractStateFromHash(s));this.sIAppStateKey=g(s)};o.getHash=function t(){return this._oRouter.getHashChanger().getHash()};o.isFocusForced=function t(){return this._bForceFocus};o.setFocusForced=function t(e){this._bForceFocus=e};o.removeIAppStateKey=function t(){this.sIAppStateKey=null};o.navToHash=function t(e,s,i,n,a){if(a!==false){this._oShellServices.setBackNavigation()}if(this._oRouteMatchSynchronization){return this._oRouteMatchSynchronization.waitFor().then(()=>{this._oRouteMatchSynchronization=undefined;return this._internalNavToHash(e,s,i,n)})}else{if(this._bActivateRouteMatchSynchro){this.waitForRouteMatchBeforeNavigation()}return this._internalNavToHash(e,s,i,n)}};o._internalNavToHash=function t(e,s,i,a){if(this.fclEnabled&&this.sIAppStateKey&&!g(e)){e=y(e,this.sIAppStateKey)}if(!this.checkHashWithGuard(e)){if(!this.oResourceBundle){this.oResourceBundle=n.getLibraryResourceBundle("sap.fe.core")}if(!confirm(this.oResourceBundle.getText("C_ROUTER_PROXY_SAPFE_EXIT_NOTSAVED_MESSAGE"))){return Promise.resolve(false)}this.bIsGuardCrossAllowed=true}const o=this._extractStateFromHash(e);if(!this._bForceFocus){const t=this._extractEntitySetsFromHash(this.getHash());this._bForceFocus=a||t.length<o.keys.length&&t.every(function(t,e){return t===o.keys[e]})}const r=this._pushNewState(o,false,s,i);return this._rebuildBrowserHistory(r,false)};o.restoreHistory=function t(){if(this._bApplyRestore){this._bApplyRestore=false;let t=this.getHash();t=t.replace(/(\?|&)restoreHistory=true/,"");const e=this._extractStateFromHash(t);const s=this._pushNewState(e,true,false,true);return this._rebuildBrowserHistory(s,true)}else{return Promise.resolve()}};o.navBack=function t(){const e=this.getHash();let s;for(let t=this._oManagedHistory.length-1;t>0;t--){if(this._oManagedHistory[t].hash===e){s=this._oManagedHistory[t-1].hash;break}}if(s){return this.navToHash(s)}else{window.history.back();return Promise.resolve()}};o.navTo=function t(e,s){const i=this._oRouter.getURL(e,s);return this.navToHash(i,false,s.noPreservationCache,false,!s.bIsStickyMode)};o.exitFromApp=function t(){return this._oShellServices.backToPreviousApp()};o.isCurrentStateImpactedBy=function t(e){if(e[0]==="/"){e=e.substring(1)}const s=d(e);return s.check(this.getHash())};o.isNavigationFinalized=function t(){return!this.bIsRebuildHistoryRunning&&!this._bDelayedRebuild};o.setNavigationGuard=function t(e){this._oNavigationGuard=d(e);this.bIsGuardCrossAllowed=false};o.discardNavigationGuard=function t(){this._oNavigationGuard=null};o.hasNavigationGuard=function t(){return this._oNavigationGuard!==null};o.checkHashWithGuard=function t(e){return this._oNavigationGuard===null||this._oNavigationGuard.check(e)};o.isGuardCrossAllowedByUser=function t(){return this.bIsGuardCrossAllowed};o.activateRouteMatchSynchronization=function t(){this._bActivateRouteMatchSynchro=true};o.resolveRouteMatch=function t(){if(this._oRouteMatchSynchronization){this._oRouteMatchSynchronization.resolve()}};o.waitForRouteMatchBeforeNavigation=function t(){this._oRouteMatchSynchronization=new s;this._bActivateRouteMatchSynchro=false};o._extractEntitySetsFromHash=function t(e){if(e===undefined){e=""}const s=e.split("?")[0];const i=s.split("/");const n=[];i.forEach(t=>{if(t.length){n.push(t.split("(")[0])}});return n};o._extractStateFromHash=function t(e){if(e===undefined){e=""}const s={keys:this._extractEntitySetsFromHash(e)};const i=e.match(new RegExp(`\\?.*${f.LAYOUTPARAM}=([^&]*)`));s.sLayout=i&&i.length>1?i[1]:null;if(s.sLayout==="MidColumnFullScreen"){s.screenMode=1}else if(s.sLayout==="EndColumnFullScreen"){s.screenMode=2}else{s.screenMode=0}s.hash=e;return s};o._pushNewState=function t(e,s,i,n){const a=this.getHash();let o=this._oManagedHistory.length-1;let r=s?1:0;if(!s){while(o>=0&&this._oManagedHistory[o].hash!==a){this._oManagedHistory.pop();o--}if(this._oManagedHistory.length===0){this._oManagedHistory.push(this._extractStateFromHash(a));history.replaceState(Object.assign({feLevel:0},history.state),"")}}if(i&&!n){this._oManagedHistory[this._oManagedHistory.length-1].preserved=true}let h;while(this._oManagedHistory.length>0){const t=this._oManagedHistory[this._oManagedHistory.length-1];if((n||!t.preserved)&&this._compareCacheStates(t,e)!==l.ANCESTOR){h=this._oManagedHistory.pop();r++}else if(t.preserved&&p(t.hash)===p(e.hash)){h=this._oManagedHistory.pop();r++;e.preserved=true;break}else{break}}this.sIAppStateKey=g(e.hash);if(!this.fclEnabled&&h){const t=g(h.hash);const s=this._compareCacheStates(h,e);if(!this.sIAppStateKey&&t&&(s===l.EQUAL||s===l.COMPATIBLE)){e.hash=y(e.hash,t)}}const u=h&&e.hash===h.hash;if(this._oManagedHistory.length===0||this._oManagedHistory[this._oManagedHistory.length-1].hash!==e.hash){this._oManagedHistory.push(e)}if(r===0){return{type:"append"}}else if(r===1){return u?{type:"none"}:{type:"replace"}}else{return u?{type:"back",steps:r-1}:{type:"back-replace",steps:r-1}}};o._blockingNavigationFilter=function t(){return this._bDisableOnHashChange?"Custom":"Continue"};o._disableEventOnHashChange=function t(){this._bDisableOnHashChange=true;this._oRouter.stop()};o._enableEventOnHashChange=function t(e){this._bDisableOnHashChange=false;this._oRouter.initialize(e)};o._rebuildBrowserHistory=function t(e,s){const i=this;return new Promise(t=>{this.bIsRebuildHistoryRunning=true;const n=this._oManagedHistory[this._oManagedHistory.length-1],a=this._oManagedHistory.length-1;function o(){if(!s){i._enableEventOnHashChange(true)}i._oRouter.getHashChanger().replaceHash(n.hash);history.replaceState(Object.assign({feLevel:a},history.state),"");if(s){setTimeout(function(){i._enableEventOnHashChange(true)},0)}i.bIsRebuildHistoryRunning=false;t(true)}function r(){window.removeEventListener("popstate",r);setTimeout(function(){o()},0)}function h(){window.removeEventListener("popstate",h);i.bIsRebuildHistoryRunning=false;t(true)}i._bIgnoreRestore=true;switch(e.type){case"replace":i._oRouter.getHashChanger().replaceHash(n.hash);history.replaceState(Object.assign({feLevel:a},history.state),"");i.bIsRebuildHistoryRunning=false;t(true);break;case"append":i._oRouter.getHashChanger().setHash(n.hash);history.replaceState(Object.assign({feLevel:a},history.state),"");i.bIsRebuildHistoryRunning=false;t(true);break;case"back":window.addEventListener("popstate",h);history.go(-e.steps);break;case"back-replace":this._disableEventOnHashChange();window.addEventListener("popstate",r);history.go(-e.steps);break;default:this.bIsRebuildHistoryRunning=false;t(false)}})};o.getLastHistoryEntry=function t(){return this._oManagedHistory[this._oManagedHistory.length-1]};o.setPathMapping=function t(e){this._pathMappings=e.filter(t=>t.oldPath!==t.newPath)};o.hashGuard=function t(){let e=window.location.hash;if(e.indexOf("restoreHistory=true")!==-1){this._bApplyRestore=true}else if(!this.bIsRebuildHistoryRunning){const t=this._pathMappings.find(t=>e.indexOf(t.oldPath)>=0);if(t){e=e.replace(t.oldPath,t.newPath);history.replaceState(Object.assign({},history.state),"",e)}else{const t=e.split("&/");const s=t[1]?t[1]:"";if(this.checkHashWithGuard(s)){this._bDelayedRebuild=true;const t=this._extractStateFromHash(s);this._pushNewState(t,false,false,true);setTimeout(()=>{this._bDelayedRebuild=false},0)}}}};o._compareCacheStates=function t(e,s){if(e.keys.length>s.keys.length){return l.DIFFERENT}let i=true;let n;for(n=0;i&&n<e.keys.length;n++){if(e.keys[n]!==s.keys[n]){i=false}}if(!i){return l.DIFFERENT}if(e.keys.length<s.keys.length||e.screenMode<s.screenMode){return l.ANCESTOR}if(e.screenMode>s.screenMode){return l.DIFFERENT}return e.sLayout===s.sLayout?l.EQUAL:l.COMPATIBLE};o.checkIfBackIsOutOfGuard=function t(e){let s;let i;if(e===undefined){const t=this._oShellServices.splitHash(window.location.hash);if(t&&t.appSpecificRoute){i=t.appSpecificRoute;if(i.indexOf("&/")===0){i=i.substring(2)}}else{i=window.location.hash.substring(1);if(i[0]==="/"){i=i.substring(1)}}}else{i=e}e=a.decode(i);if(this._oNavigationGuard){for(let t=this._oManagedHistory.length-1;t>0;t--){if(this._oManagedHistory[t].hash===e){s=this._oManagedHistory[t-1].hash;break}}return!s||!this.checkHashWithGuard(s)}return false};o.checkIfBackHasSameContext=function t(){if(this._oManagedHistory.length<2){return false}const e=this._oManagedHistory[this._oManagedHistory.length-1];const s=this._oManagedHistory[this._oManagedHistory.length-2];return e.hash.split("?")[0]===s.hash.split("?")[0]};return i}(i))||r);return _},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/Any-dbg", ["sap/ui/base/ManagedObject"], function (ManagedObject) {
  "use strict";

  /**
   * @class
   * A custom element to evaluate the value of Binding.
   * @name sap.fe.core.controls.Any
   * @hideconstructor
   */
  const Any = ManagedObject.extend("sap.fe.core.controls.Any", {
    metadata: {
      properties: {
        any: "any",
        anyText: "string"
      }
    },
    updateProperty: function (sName) {
      // Avoid Promise processing in ManagedObject and set Promise as value directly
      if (sName === "any") {
        this.setAny(this.getBindingInfo(sName).binding.getExternalValue());
      } else {
        this.setAnyText(this.getBindingInfo(sName).binding.getExternalValue());
      }
    }
  });
  return Any;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/Any", ["sap/ui/base/ManagedObject"],function(e){"use strict";const n=e.extend("sap.fe.core.controls.Any",{metadata:{properties:{any:"any",anyText:"string"}},updateProperty:function(e){if(e==="any"){this.setAny(this.getBindingInfo(e).binding.getExternalValue())}else{this.setAnyText(this.getBindingInfo(e).binding.getExternalValue())}}});return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/AnyElement-dbg", ["sap/ui/core/Element"], function (Element) {
  "use strict";

  /**
   * @class
   * A custom element to evaluate the value of Binding.
   * @name sap.fe.core.controls.AnyElement
   * @hideconstructor
   */
  const AnyElement = Element.extend("sap.fe.core.controls.AnyElement", {
    metadata: {
      properties: {
        anyText: "string"
      }
    },
    updateProperty: function (sName) {
      // Avoid Promise processing in Element and set Promise as value directly
      if (sName === "anyText") {
        this.setAnyText(this.getBindingInfo(sName).binding.getExternalValue());
      }
    }
  });
  return AnyElement;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/AnyElement", ["sap/ui/core/Element"],function(e){"use strict";const t=e.extend("sap.fe.core.controls.AnyElement",{metadata:{properties:{anyText:"string"}},updateProperty:function(e){if(e==="anyText"){this.setAnyText(this.getBindingInfo(e).binding.getExternalValue())}}});return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/CommandExecution-dbg", ["sap/base/Log", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/CommandExecution", "sap/ui/core/Component", "sap/ui/core/Element", "sap/ui/core/Shortcut"], function (Log, ClassSupport, CoreCommandExecution, Component, Element, Shortcut) {
  "use strict";

  var _dec, _class;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let CommandExecution = (_dec = defineUI5Class("sap.fe.core.controls.CommandExecution"), _dec(_class = /*#__PURE__*/function (_CoreCommandExecution) {
    _inheritsLoose(CommandExecution, _CoreCommandExecution);
    function CommandExecution(sId, mSettings) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      return _CoreCommandExecution.call(this, sId, mSettings) || this;
    }
    var _proto = CommandExecution.prototype;
    _proto.setParent = function setParent(oParent) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      _CoreCommandExecution.prototype.setParent.call(this, oParent);
      const aCommands = oParent.data("sap.ui.core.Shortcut");
      if (Array.isArray(aCommands) && aCommands.length > 0) {
        const oCommand = oParent.data("sap.ui.core.Shortcut")[aCommands.length - 1],
          oShortcut = oCommand.shortcutSpec;
        if (oShortcut) {
          // Check if single key shortcut
          for (const key in oShortcut) {
            if (oShortcut[key] && key !== "key") {
              return this;
            }
          }
        }
        return this;
      }
    };
    _proto.destroy = function destroy(bSuppressInvalidate) {
      const oParent = this.getParent();
      if (oParent) {
        const oCommand = this._getCommandInfo();
        if (oCommand) {
          Shortcut.unregister(this.getParent(), oCommand.shortcut);
        }
        this._cleanupContext(oParent);
      }
      Element.prototype.destroy.apply(this, [bSuppressInvalidate]);
    };
    _proto.setVisible = function setVisible(bValue) {
      let oCommand,
        oParentControl = this.getParent(),
        oComponent;
      while (!oComponent && oParentControl) {
        oComponent = Component.getOwnerComponentFor(oParentControl);
        oParentControl = oParentControl.getParent();
      }
      if (oComponent) {
        oCommand = oComponent.getCommand(this.getCommand());
        if (oCommand) {
          _CoreCommandExecution.prototype.setVisible.call(this, bValue);
        } else {
          Log.info("There is no shortcut definition registered in the manifest for the command : " + this.getCommand());
        }
      }
      return this;
    };
    return CommandExecution;
  }(CoreCommandExecution)) || _class);
  return CommandExecution;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/CommandExecution", ["sap/base/Log","sap/fe/core/helpers/ClassSupport","sap/ui/core/CommandExecution","sap/ui/core/Component","sap/ui/core/Element","sap/ui/core/Shortcut"],function(t,e,o,r,n,i){"use strict";var s,c;var a=e.defineUI5Class;function u(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;p(t,e)}function p(t,e){p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,o){e.__proto__=o;return e};return p(t,e)}let f=(s=a("sap.fe.core.controls.CommandExecution"),s(c=function(e){u(o,e);function o(t,o){return e.call(this,t,o)||this}var s=o.prototype;s.setParent=function t(o){e.prototype.setParent.call(this,o);const r=o.data("sap.ui.core.Shortcut");if(Array.isArray(r)&&r.length>0){const t=o.data("sap.ui.core.Shortcut")[r.length-1],e=t.shortcutSpec;if(e){for(const t in e){if(e[t]&&t!=="key"){return this}}}return this}};s.destroy=function t(e){const o=this.getParent();if(o){const t=this._getCommandInfo();if(t){i.unregister(this.getParent(),t.shortcut)}this._cleanupContext(o)}n.prototype.destroy.apply(this,[e])};s.setVisible=function o(n){let i,s=this.getParent(),c;while(!c&&s){c=r.getOwnerComponentFor(s);s=s.getParent()}if(c){i=c.getCommand(this.getCommand());if(i){e.prototype.setVisible.call(this,n)}else{t.info("There is no shortcut definition registered in the manifest for the command : "+this.getCommand())}}return this};return o}(o))||c);return f},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/ConditionalWrapper-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/core/Control"], function (ClassSupport, Control) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7;
  var property = ClassSupport.property;
  var implementInterface = ClassSupport.implementInterface;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var association = ClassSupport.association;
  var aggregation = ClassSupport.aggregation;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let ConditionalWrapper = (_dec = defineUI5Class("sap.fe.core.controls.ConditionalWrapper"), _dec2 = implementInterface("sap.ui.core.IFormContent"), _dec3 = property({
    type: "sap.ui.core.CSSSize",
    defaultValue: null
  }), _dec4 = property({
    type: "boolean",
    defaultValue: false
  }), _dec5 = property({
    type: "boolean",
    defaultValue: false
  }), _dec6 = association({
    type: "sap.ui.core.Control",
    multiple: true,
    singularName: "ariaLabelledBy"
  }), _dec7 = aggregation({
    type: "sap.ui.core.Control",
    multiple: false,
    isDefault: true
  }), _dec8 = aggregation({
    type: "sap.ui.core.Control",
    multiple: false
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_Control) {
    _inheritsLoose(ConditionalWrapper, _Control);
    function ConditionalWrapper() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _Control.call(this, ...args) || this;
      _initializerDefineProperty(_this, "__implements__sap_ui_core_IFormContent", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "width", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "formDoNotAdjustWidth", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "condition", _descriptor4, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "ariaLabelledBy", _descriptor5, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "contentTrue", _descriptor6, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "contentFalse", _descriptor7, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = ConditionalWrapper.prototype;
    _proto.enhanceAccessibilityState = function enhanceAccessibilityState(oElement, mAriaProps) {
      const oParent = this.getParent();
      if (oParent && oParent.enhanceAccessibilityState) {
        oParent.enhanceAccessibilityState(this, mAriaProps);
      }
      return mAriaProps;
    }
    /**
     * This function provides the current accessibility state of the control.
     *
     * @returns The accessibility info of the wrapped control
     */;
    _proto.getAccessibilityInfo = function getAccessibilityInfo() {
      var _content;
      let content;
      if (this.condition) {
        content = this.contentTrue;
      } else {
        content = this.contentFalse;
      }
      return (_content = content) !== null && _content !== void 0 && _content.getAccessibilityInfo ? content.getAccessibilityInfo() : {};
    };
    _proto._setAriaLabelledBy = function _setAriaLabelledBy(oContent) {
      if (oContent && oContent.addAriaLabelledBy) {
        const aAriaLabelledBy = this.ariaLabelledBy;
        for (let i = 0; i < aAriaLabelledBy.length; i++) {
          const sId = aAriaLabelledBy[i];
          const aAriaLabelledBys = oContent.getAriaLabelledBy() || [];
          if (aAriaLabelledBys.indexOf(sId) === -1) {
            oContent.addAriaLabelledBy(sId);
          }
        }
      }
    };
    _proto.onBeforeRendering = function onBeforeRendering() {
      // before calling the renderer of the ConditionalWrapper parent control may have set ariaLabelledBy
      // we ensure it is passed to its inner controls
      this._setAriaLabelledBy(this.contentTrue);
      this._setAriaLabelledBy(this.contentFalse);
    };
    ConditionalWrapper.render = function render(oRm, oControl) {
      oRm.openStart("div", oControl);
      oRm.style("width", oControl.width);
      oRm.style("display", "inline-block");
      oRm.openEnd();
      if (oControl.condition) {
        oRm.renderControl(oControl.contentTrue);
      } else {
        oRm.renderControl(oControl.contentFalse);
      }
      oRm.close("div"); // end of the complete Control
    };
    return ConditionalWrapper;
  }(Control), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "__implements__sap_ui_core_IFormContent", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return true;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "width", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "formDoNotAdjustWidth", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "condition", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "ariaLabelledBy", [_dec6], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "contentTrue", [_dec7], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "contentFalse", [_dec8], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return ConditionalWrapper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/ConditionalWrapper", ["sap/fe/core/helpers/ClassSupport","sap/ui/core/Control"],function(e,t){"use strict";var i,r,n,l,o,a,u,c,s,f,p,b,d,y,h,m,g;var v=e.property;var _=e.implementInterface;var w=e.defineUI5Class;var z=e.association;var A=e.aggregation;function C(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function B(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function L(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;O(e,t)}function O(e,t){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return O(e,t)}function j(e,t,i,r,n){var l={};Object.keys(r).forEach(function(e){l[e]=r[e]});l.enumerable=!!l.enumerable;l.configurable=!!l.configurable;if("value"in l||l.initializer){l.writable=true}l=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},l);if(n&&l.initializer!==void 0){l.value=l.initializer?l.initializer.call(n):void 0;l.initializer=undefined}if(l.initializer===void 0){Object.defineProperty(e,t,l);l=null}return l}function F(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let I=(i=w("sap.fe.core.controls.ConditionalWrapper"),r=_("sap.ui.core.IFormContent"),n=v({type:"sap.ui.core.CSSSize",defaultValue:null}),l=v({type:"boolean",defaultValue:false}),o=v({type:"boolean",defaultValue:false}),a=z({type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}),u=A({type:"sap.ui.core.Control",multiple:false,isDefault:true}),c=A({type:"sap.ui.core.Control",multiple:false}),i(s=(f=function(e){L(t,e);function t(){var t;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++){r[n]=arguments[n]}t=e.call(this,...r)||this;C(t,"__implements__sap_ui_core_IFormContent",p,B(t));C(t,"width",b,B(t));C(t,"formDoNotAdjustWidth",d,B(t));C(t,"condition",y,B(t));C(t,"ariaLabelledBy",h,B(t));C(t,"contentTrue",m,B(t));C(t,"contentFalse",g,B(t));return t}var i=t.prototype;i.enhanceAccessibilityState=function e(t,i){const r=this.getParent();if(r&&r.enhanceAccessibilityState){r.enhanceAccessibilityState(this,i)}return i};i.getAccessibilityInfo=function e(){var t;let i;if(this.condition){i=this.contentTrue}else{i=this.contentFalse}return(t=i)!==null&&t!==void 0&&t.getAccessibilityInfo?i.getAccessibilityInfo():{}};i._setAriaLabelledBy=function e(t){if(t&&t.addAriaLabelledBy){const e=this.ariaLabelledBy;for(let i=0;i<e.length;i++){const r=e[i];const n=t.getAriaLabelledBy()||[];if(n.indexOf(r)===-1){t.addAriaLabelledBy(r)}}}};i.onBeforeRendering=function e(){this._setAriaLabelledBy(this.contentTrue);this._setAriaLabelledBy(this.contentFalse)};t.render=function e(t,i){t.openStart("div",i);t.style("width",i.width);t.style("display","inline-block");t.openEnd();if(i.condition){t.renderControl(i.contentTrue)}else{t.renderControl(i.contentFalse)}t.close("div")};return t}(t),p=j(f.prototype,"__implements__sap_ui_core_IFormContent",[r],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),b=j(f.prototype,"width",[n],{configurable:true,enumerable:true,writable:true,initializer:null}),d=j(f.prototype,"formDoNotAdjustWidth",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),y=j(f.prototype,"condition",[o],{configurable:true,enumerable:true,writable:true,initializer:null}),h=j(f.prototype,"ariaLabelledBy",[a],{configurable:true,enumerable:true,writable:true,initializer:null}),m=j(f.prototype,"contentTrue",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),g=j(f.prototype,"contentFalse",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),f))||s);return I},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/CustomFilterFieldContentWrapper-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/SemanticDateOperators", "sap/ui/base/ManagedObjectObserver", "sap/ui/core/Control", "sap/ui/mdc/condition/Condition", "sap/ui/mdc/enum/ConditionValidated", "sap/ui/mdc/field/ConditionsType", "sap/ui/model/json/JSONModel"], function (ClassSupport, SemanticDateOperators, ManagedObjectObserver, Control, Condition, ConditionValidated, ConditionsType, JSONModel) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _class3;
  var _exports = {};
  var property = ClassSupport.property;
  var implementInterface = ClassSupport.implementInterface;
  var event = ClassSupport.event;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var aggregation = ClassSupport.aggregation;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let CustomFilterFieldContentWrapper = (
  /**
   * @class
   * Creates an <code>sap.fe.core.controls.CustomFilterFieldContentWrapper</code> object.
   * This is used in the {@link sap.ui.mdc.FilterField FilterField} as a filter content.
   * @extends sap.ui.core.Control
   * @private
   * @alias sap.fe.core.controls.CustomFilterFieldContentWrapper
   */
  _dec = defineUI5Class("sap.fe.core.controls.CustomFilterFieldContentWrapper"), _dec2 = implementInterface("sap.ui.core.IFormContent"), _dec3 = property({
    type: "sap.ui.core.CSSSize",
    defaultValue: null
  }), _dec4 = property({
    type: "boolean",
    defaultValue: false
  }), _dec5 = property({
    type: "object[]",
    defaultValue: []
  }), _dec6 = aggregation({
    type: "sap.ui.core.Control",
    multiple: false,
    isDefault: true
  }), _dec7 = event(), _dec(_class = (_class2 = (_class3 = /*#__PURE__*/function (_Control) {
    _inheritsLoose(CustomFilterFieldContentWrapper, _Control);
    function CustomFilterFieldContentWrapper() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _Control.call(this, ...args) || this;
      _initializerDefineProperty(_this, "__implements__sap_ui_core_IFormContent", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "width", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "formDoNotAdjustWidth", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "conditions", _descriptor4, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "content", _descriptor5, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "conditionsChange", _descriptor6, _assertThisInitialized(_this));
      return _this;
    }
    _exports = CustomFilterFieldContentWrapper;
    CustomFilterFieldContentWrapper.render = function render(renderManager, control) {
      renderManager.openStart("div", control);
      renderManager.style("min-height", "1rem");
      renderManager.style("width", control.width);
      renderManager.openEnd();
      renderManager.renderControl(control.getContent()); // render the child Control
      renderManager.close("div"); // end of the complete Control
    }

    /**
     * Maps an array of filter values to an array of conditions.
     *
     * @param filterValues Array of filter value bindings or a filter value string
     * @param [operator] The operator to be used (optional) - if not set, the default operator (EQ) will be used
     * @private
     * @returns Array of filter conditions
     */;
    CustomFilterFieldContentWrapper._filterValuesToConditions = function _filterValuesToConditions(filterValues, operator) {
      let formatOptions = {
          operators: []
        },
        conditions = [];
      if (operator) {
        formatOptions = {
          operators: [operator]
        };
      }
      if (filterValues === "") {
        filterValues = [];
      } else if (typeof filterValues === "object" && filterValues.hasOwnProperty("operator") && filterValues.hasOwnProperty("values")) {
        formatOptions = {
          operators: [filterValues.operator]
        };
        filterValues = filterValues.values;
      } else if (filterValues !== undefined && typeof filterValues !== "object" && typeof filterValues !== "string") {
        throw new Error(`FilterUtils.js#_filterValuesToConditions: Unexpected type of input parameter vValues: ${typeof filterValues}`);
      }
      const conditionsType = new ConditionsType(formatOptions);
      const conditionValues = Array.isArray(filterValues) ? filterValues : [filterValues];

      // Shortcut for operator without values and semantic date operations
      if (typeof operator === "string" && (conditionValues.length === 0 || SemanticDateOperators.getSemanticDateOperations().includes(operator))) {
        conditions = [Condition.createCondition(operator, conditionValues, null, null, ConditionValidated.NotValidated)];
      } else {
        conditions = conditionValues.map(conditionValue => {
          const stringValue = conditionValue === null || conditionValue === void 0 ? void 0 : conditionValue.toString(),
            parsedConditions = conditionsType.parseValue(stringValue, "any");
          return parsedConditions === null || parsedConditions === void 0 ? void 0 : parsedConditions[0];
        }).filter(conditionValue => conditionValue !== undefined);
      }
      return conditions;
    }

    /**
     * Maps an array of conditions to a comma separated list of filter values.
     *
     * @param conditions Array of filter conditions
     * @param formatOptions Format options that specifies a condition type
     * @private
     * @returns Concatenated string of filter values
     */;
    CustomFilterFieldContentWrapper._conditionsToFilterModelString = function _conditionsToFilterModelString(conditions, formatOptions) {
      const conditionsType = new ConditionsType(formatOptions);
      return conditions.map(condition => {
        return conditionsType.formatValue([condition], "any") || "";
      }).filter(stringValue => {
        return stringValue !== "";
      }).join(",");
    }

    /**
     * Listens to filter model changes and updates wrapper property "conditions".
     *
     * @param changeEvent Event triggered by a filter model change
     * @private
     */;
    var _proto = CustomFilterFieldContentWrapper.prototype;
    _proto._handleFilterModelChange = function _handleFilterModelChange(changeEvent) {
      var _this$getObjectBindin;
      const propertyPath = (_this$getObjectBindin = this.getObjectBinding("filterValues")) === null || _this$getObjectBindin === void 0 ? void 0 : _this$getObjectBindin.getPath(),
        values = changeEvent.getSource().getProperty(propertyPath);
      this.updateConditionsByFilterValues(values, "");
    }

    /**
     * Listens to "conditions" changes and updates the filter model.
     *
     * @param conditions Event triggered by a "conditions" change
     * @private
     */;
    _proto._handleConditionsChange = function _handleConditionsChange(conditions) {
      this.updateFilterModelByConditions(conditions);
    }

    /**
     * Initialize CustomFilterFieldContentWrapper control and register observer.
     */;
    _proto.init = function init() {
      _Control.prototype.init.call(this);
      this._conditionsObserver = new ManagedObjectObserver(this._observeChanges.bind(this));
      this._conditionsObserver.observe(this, {
        properties: ["conditions"]
      });
      this._filterModel = new JSONModel();
      this._filterModel.attachPropertyChange(this._handleFilterModelChange, this);
      this.setModel(this._filterModel, CustomFilterFieldContentWrapper.FILTER_MODEL_ALIAS);
    }

    /**
     * Overrides {@link sap.ui.core.Control#clone Control.clone} to clone additional
     * internal states.
     *
     * @param [sIdSuffix] A suffix to be appended to the cloned control id
     * @param [aLocalIds] An array of local IDs within the cloned hierarchy (internally used)
     * @returns Reference to the newly created clone
     * @protected
     */;
    _proto.clone = function clone(sIdSuffix, aLocalIds) {
      const clone = _Control.prototype.clone.call(this, sIdSuffix, aLocalIds);
      // During cloning, the old model will be copied and overwrites any new model (same alias) that
      // you introduce during init(); hence you need to overwrite it again by the new one that you've
      // created during init() (i.e. clone._filterModel); that standard behaviour of super.clone()
      // can't even be suppressed in an own constructor; for a detailed investigation of the cloning,
      // please overwrite the setModel() method and check the list of callers and steps induced by them.
      clone.setModel(clone._filterModel, CustomFilterFieldContentWrapper.FILTER_MODEL_ALIAS);
      return clone;
    }

    /**
     * Listens to property changes.
     *
     * @param changes Property changes
     * @private
     */;
    _proto._observeChanges = function _observeChanges(changes) {
      if (changes.name === "conditions") {
        this._handleConditionsChange(changes.current);
      }
    }

    /**
     * Gets the content of this wrapper control.
     *
     * @returns The wrapper content
     * @private
     */;
    _proto.getContent = function getContent() {
      return this.getAggregation("content");
    }

    /**
     * Gets the value for control property 'conditions'.
     *
     * @returns Array of filter conditions
     * @private
     */;
    _proto.getConditions = function getConditions() {
      return this.getProperty("conditions");
    }

    /**
     * Sets the value for control property 'conditions'.
     *
     * @param [conditions] Array of filter conditions
     * @returns Reference to this wrapper
     * @private
     */;
    _proto.setConditions = function setConditions(conditions) {
      this.setProperty("conditions", conditions || []);
      return this;
    }

    /**
     * Gets the filter model alias 'filterValues'.
     *
     * @returns The filter model
     * @private
     */;
    _proto.getFilterModelAlias = function getFilterModelAlias() {
      return CustomFilterFieldContentWrapper.FILTER_MODEL_ALIAS;
    }

    /**
     * Updates the property "conditions" with filter values
     * sent by ExtensionAPI#setFilterValues().
     *
     * @param values The filter values
     * @param [operator] The operator name
     * @private
     */;
    _proto.updateConditionsByFilterValues = function updateConditionsByFilterValues(values, operator) {
      const conditions = CustomFilterFieldContentWrapper._filterValuesToConditions(values, operator);
      this.setConditions(conditions);
    }

    /**
     * Updates filter model with conditions
     * sent by the {@link sap.ui.mdc.FilterField FilterField}.
     *
     * @param conditions Array of filter conditions
     * @private
     */;
    _proto.updateFilterModelByConditions = function updateFilterModelByConditions(conditions) {
      var _conditions$;
      const operator = ((_conditions$ = conditions[0]) === null || _conditions$ === void 0 ? void 0 : _conditions$.operator) || "";
      const formatOptions = operator !== "" ? {
        operators: [operator]
      } : {
        operators: []
      };
      if (this.getBindingContext(CustomFilterFieldContentWrapper.FILTER_MODEL_ALIAS)) {
        var _this$getBindingConte;
        const stringValue = CustomFilterFieldContentWrapper._conditionsToFilterModelString(conditions, formatOptions);
        this._filterModel.setProperty((_this$getBindingConte = this.getBindingContext(CustomFilterFieldContentWrapper.FILTER_MODEL_ALIAS)) === null || _this$getBindingConte === void 0 ? void 0 : _this$getBindingConte.getPath(), stringValue);
      }
    };
    _proto.getAccessibilityInfo = function getAccessibilityInfo() {
      var _content$getAccessibi;
      const content = this.getContent();
      return (content === null || content === void 0 ? void 0 : (_content$getAccessibi = content.getAccessibilityInfo) === null || _content$getAccessibi === void 0 ? void 0 : _content$getAccessibi.call(content)) || {};
    }

    /**
     * Returns the DOMNode ID to be used for the "labelFor" attribute.
     *
     * We forward the call of this method to the content control.
     *
     * @returns ID to be used for the <code>labelFor</code>
     */;
    _proto.getIdForLabel = function getIdForLabel() {
      const content = this.getContent();
      return content === null || content === void 0 ? void 0 : content.getIdForLabel();
    };
    return CustomFilterFieldContentWrapper;
  }(Control), _class3.FILTER_MODEL_ALIAS = "filterValues", _class3), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "__implements__sap_ui_core_IFormContent", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return true;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "width", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "formDoNotAdjustWidth", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "conditions", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "content", [_dec6], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "conditionsChange", [_dec7], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  _exports = CustomFilterFieldContentWrapper;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/CustomFilterFieldContentWrapper", ["sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/SemanticDateOperators","sap/ui/base/ManagedObjectObserver","sap/ui/core/Control","sap/ui/mdc/condition/Condition","sap/ui/mdc/enum/ConditionValidated","sap/ui/mdc/field/ConditionsType","sap/ui/model/json/JSONModel"],function(e,t,i,n,o,r,l,a){"use strict";var s,u,c,d,p,f,h,g,b,v,y,_,C,m,w,O;var F={};var M=e.property;var A=e.implementInterface;var I=e.event;var L=e.defineUI5Class;var S=e.aggregation;function E(e,t,i,n){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function z(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;V(e,t)}function V(e,t){V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return V(e,t)}function P(e,t,i,n,o){var r={};Object.keys(n).forEach(function(e){r[e]=n[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=i.slice().reverse().reduce(function(i,n){return n(e,t,i)||i},r);if(o&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(o):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}function D(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let T=(s=L("sap.fe.core.controls.CustomFilterFieldContentWrapper"),u=A("sap.ui.core.IFormContent"),c=M({type:"sap.ui.core.CSSSize",defaultValue:null}),d=M({type:"boolean",defaultValue:false}),p=M({type:"object[]",defaultValue:[]}),f=S({type:"sap.ui.core.Control",multiple:false,isDefault:true}),h=I(),s(g=(b=(O=function(e){z(n,e);function n(){var t;for(var i=arguments.length,n=new Array(i),o=0;o<i;o++){n[o]=arguments[o]}t=e.call(this,...n)||this;E(t,"__implements__sap_ui_core_IFormContent",v,j(t));E(t,"width",y,j(t));E(t,"formDoNotAdjustWidth",_,j(t));E(t,"conditions",C,j(t));E(t,"content",m,j(t));E(t,"conditionsChange",w,j(t));return t}F=n;n.render=function e(t,i){t.openStart("div",i);t.style("min-height","1rem");t.style("width",i.width);t.openEnd();t.renderControl(i.getContent());t.close("div")};n._filterValuesToConditions=function e(i,n){let a={operators:[]},s=[];if(n){a={operators:[n]}}if(i===""){i=[]}else if(typeof i==="object"&&i.hasOwnProperty("operator")&&i.hasOwnProperty("values")){a={operators:[i.operator]};i=i.values}else if(i!==undefined&&typeof i!=="object"&&typeof i!=="string"){throw new Error(`FilterUtils.js#_filterValuesToConditions: Unexpected type of input parameter vValues: ${typeof i}`)}const u=new l(a);const c=Array.isArray(i)?i:[i];if(typeof n==="string"&&(c.length===0||t.getSemanticDateOperations().includes(n))){s=[o.createCondition(n,c,null,null,r.NotValidated)]}else{s=c.map(e=>{const t=e===null||e===void 0?void 0:e.toString(),i=u.parseValue(t,"any");return i===null||i===void 0?void 0:i[0]}).filter(e=>e!==undefined)}return s};n._conditionsToFilterModelString=function e(t,i){const n=new l(i);return t.map(e=>n.formatValue([e],"any")||"").filter(e=>e!=="").join(",")};var s=n.prototype;s._handleFilterModelChange=function e(t){var i;const n=(i=this.getObjectBinding("filterValues"))===null||i===void 0?void 0:i.getPath(),o=t.getSource().getProperty(n);this.updateConditionsByFilterValues(o,"")};s._handleConditionsChange=function e(t){this.updateFilterModelByConditions(t)};s.init=function t(){e.prototype.init.call(this);this._conditionsObserver=new i(this._observeChanges.bind(this));this._conditionsObserver.observe(this,{properties:["conditions"]});this._filterModel=new a;this._filterModel.attachPropertyChange(this._handleFilterModelChange,this);this.setModel(this._filterModel,n.FILTER_MODEL_ALIAS)};s.clone=function t(i,o){const t=e.prototype.clone.call(this,i,o);t.setModel(t._filterModel,n.FILTER_MODEL_ALIAS);return t};s._observeChanges=function e(t){if(t.name==="conditions"){this._handleConditionsChange(t.current)}};s.getContent=function e(){return this.getAggregation("content")};s.getConditions=function e(){return this.getProperty("conditions")};s.setConditions=function e(t){this.setProperty("conditions",t||[]);return this};s.getFilterModelAlias=function e(){return n.FILTER_MODEL_ALIAS};s.updateConditionsByFilterValues=function e(t,i){const o=n._filterValuesToConditions(t,i);this.setConditions(o)};s.updateFilterModelByConditions=function e(t){var i;const o=((i=t[0])===null||i===void 0?void 0:i.operator)||"";const r=o!==""?{operators:[o]}:{operators:[]};if(this.getBindingContext(n.FILTER_MODEL_ALIAS)){var l;const e=n._conditionsToFilterModelString(t,r);this._filterModel.setProperty((l=this.getBindingContext(n.FILTER_MODEL_ALIAS))===null||l===void 0?void 0:l.getPath(),e)}};s.getAccessibilityInfo=function e(){var t;const i=this.getContent();return(i===null||i===void 0?void 0:(t=i.getAccessibilityInfo)===null||t===void 0?void 0:t.call(i))||{}};s.getIdForLabel=function e(){const t=this.getContent();return t===null||t===void 0?void 0:t.getIdForLabel()};return n}(n),O.FILTER_MODEL_ALIAS="filterValues",O),v=P(b.prototype,"__implements__sap_ui_core_IFormContent",[u],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),y=P(b.prototype,"width",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),_=P(b.prototype,"formDoNotAdjustWidth",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),C=P(b.prototype,"conditions",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),m=P(b.prototype,"content",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),w=P(b.prototype,"conditionsChange",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),b))||g);F=T;return F},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/CustomQuickViewPage-dbg", ["sap/fe/core/CommonUtils", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/KeepAliveHelper", "sap/fe/macros/DelegateUtil", "sap/m/QuickViewPage"], function (CommonUtils, ClassSupport, KeepAliveHelper, DelegateUtil, QuickViewPage) {
  "use strict";

  var _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var aggregation = ClassSupport.aggregation;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let CustomQuickViewPage = (_dec = defineUI5Class("sap.fe.core.controls.CustomQuickViewPage"), _dec2 = aggregation({
    type: "sap.ui.core.Control",
    multiple: true
  }), _dec3 = aggregation({
    type: "sap.m.QuickViewGroup",
    multiple: true,
    singularName: "group",
    isDefault: true
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_QuickViewPage) {
    _inheritsLoose(CustomQuickViewPage, _QuickViewPage);
    function CustomQuickViewPage() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _QuickViewPage.call(this, ...args) || this;
      _initializerDefineProperty(_this, "customContent", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "groups", _descriptor2, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = CustomQuickViewPage.prototype;
    _proto.onBeforeRendering = function onBeforeRendering(oEvent) {
      const parent = this.getParent();
      if (parent && parent.isA("sap.fe.core.controls.ConditionalWrapper") && parent.getProperty("condition") === true) {
        this.setCrossAppNavCallback(() => {
          const sQuickViewPageTitleLinkHref = DelegateUtil.getCustomData(this, "titleLink");
          const oView = CommonUtils.getTargetView(this);
          const oAppComponent = CommonUtils.getAppComponent(oView);
          const oShellServiceHelper = oAppComponent.getShellServices();
          let oShellHash = oShellServiceHelper.parseShellHash(sQuickViewPageTitleLinkHref);
          const oNavArgs = {
            target: {
              semanticObject: oShellHash.semanticObject,
              action: oShellHash.action
            },
            params: oShellHash.params
          };
          const sQuickViewPageTitleLinkIntent = `${oNavArgs.target.semanticObject}-${oNavArgs.target.action}`;
          if (sQuickViewPageTitleLinkIntent && this.oCrossAppNavigator && this.oCrossAppNavigator.isNavigationSupported([sQuickViewPageTitleLinkIntent])) {
            if (sQuickViewPageTitleLinkIntent && sQuickViewPageTitleLinkIntent !== "") {
              if (typeof sQuickViewPageTitleLinkIntent === "string" && sQuickViewPageTitleLinkIntent !== "") {
                var _oLinkControl;
                let oLinkControl = this.getParent();
                while (oLinkControl && !oLinkControl.isA("sap.ui.mdc.Link")) {
                  oLinkControl = oLinkControl.getParent();
                }
                const sTargetHref = (_oLinkControl = oLinkControl) === null || _oLinkControl === void 0 ? void 0 : _oLinkControl.getModel("$sapuimdcLink").getProperty("/titleLinkHref");
                if (sTargetHref) {
                  oShellHash = oShellServiceHelper.parseShellHash(sTargetHref);
                } else {
                  oShellHash = oShellServiceHelper.parseShellHash(sQuickViewPageTitleLinkIntent);
                  oShellHash.params = oNavArgs.params;
                }
                KeepAliveHelper.storeControlRefreshStrategyForHash(oView, oShellHash);
                return {
                  target: {
                    semanticObject: oShellHash.semanticObject,
                    action: oShellHash.action
                  },
                  params: oShellHash.params
                };
              }
            }
          } else {
            const oCurrentShellHash = oShellServiceHelper.parseShellHash(window.location.hash);
            KeepAliveHelper.storeControlRefreshStrategyForHash(oView, oCurrentShellHash);
            return {
              target: {
                semanticObject: oCurrentShellHash.semanticObject,
                action: oCurrentShellHash.action,
                appSpecificRoute: oCurrentShellHash.appSpecificRoute
              },
              params: oCurrentShellHash.params
            };
          }
        });
      }
      _QuickViewPage.prototype.onBeforeRendering.call(this, oEvent);
      const oPageContent = this.getPageContent();
      const oForm = oPageContent.form;
      if (oForm) {
        const _aContent = this.customContent;
        if (_aContent && _aContent.length > 0) {
          _aContent.forEach(_oContent => {
            const _oContentClone = _oContent.clone();
            _oContentClone.setModel(this.getModel());
            _oContentClone.setBindingContext(this.getBindingContext());
            oForm.addContent(_oContentClone);
          });
          setTimeout(function () {
            oForm.rerender();
          }, 0);
        }
      }
    };
    return CustomQuickViewPage;
  }(QuickViewPage), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "customContent", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "groups", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return CustomQuickViewPage;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/CustomQuickViewPage", ["sap/fe/core/CommonUtils","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/KeepAliveHelper","sap/fe/macros/DelegateUtil","sap/m/QuickViewPage"],function(e,t,r,i,n){"use strict";var o,a,s,l,c,u,p;var f=t.defineUI5Class;var g=t.aggregation;function h(e,t,r,i){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function m(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function d(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;b(e,t)}function b(e,t){b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return b(e,t)}function v(e,t,r,i,n){var o={};Object.keys(i).forEach(function(e){o[e]=i[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o);if(n&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(n):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function y(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let C=(o=f("sap.fe.core.controls.CustomQuickViewPage"),a=g({type:"sap.ui.core.Control",multiple:true}),s=g({type:"sap.m.QuickViewGroup",multiple:true,singularName:"group",isDefault:true}),o(l=(c=function(t){d(n,t);function n(){var e;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}e=t.call(this,...i)||this;h(e,"customContent",u,m(e));h(e,"groups",p,m(e));return e}var o=n.prototype;o.onBeforeRendering=function n(o){const a=this.getParent();if(a&&a.isA("sap.fe.core.controls.ConditionalWrapper")&&a.getProperty("condition")===true){this.setCrossAppNavCallback(()=>{const t=i.getCustomData(this,"titleLink");const n=e.getTargetView(this);const o=e.getAppComponent(n);const a=o.getShellServices();let s=a.parseShellHash(t);const l={target:{semanticObject:s.semanticObject,action:s.action},params:s.params};const c=`${l.target.semanticObject}-${l.target.action}`;if(c&&this.oCrossAppNavigator&&this.oCrossAppNavigator.isNavigationSupported([c])){if(c&&c!==""){if(typeof c==="string"&&c!==""){var u;let e=this.getParent();while(e&&!e.isA("sap.ui.mdc.Link")){e=e.getParent()}const t=(u=e)===null||u===void 0?void 0:u.getModel("$sapuimdcLink").getProperty("/titleLinkHref");if(t){s=a.parseShellHash(t)}else{s=a.parseShellHash(c);s.params=l.params}r.storeControlRefreshStrategyForHash(n,s);return{target:{semanticObject:s.semanticObject,action:s.action},params:s.params}}}}else{const e=a.parseShellHash(window.location.hash);r.storeControlRefreshStrategyForHash(n,e);return{target:{semanticObject:e.semanticObject,action:e.action,appSpecificRoute:e.appSpecificRoute},params:e.params}}})}t.prototype.onBeforeRendering.call(this,o);const s=this.getPageContent();const l=s.form;if(l){const e=this.customContent;if(e&&e.length>0){e.forEach(e=>{const t=e.clone();t.setModel(this.getModel());t.setBindingContext(this.getBindingContext());l.addContent(t)});setTimeout(function(){l.rerender()},0)}}};return n}(n),u=v(c.prototype,"customContent",[a],{configurable:true,enumerable:true,writable:true,initializer:null}),p=v(c.prototype,"groups",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),c))||l);return C},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/DataLossOrDraftDiscard/DataLossOrDraftDiscardHandler-dbg", ["sap/base/Log", "sap/ui/core/Fragment", "sap/ui/core/util/XMLPreprocessor", "sap/ui/core/XMLTemplateProcessor", "sap/ui/model/json/JSONModel"], function (Log, Fragment, XMLPreprocessor, XMLTemplateProcessor, JSONModel) {
  "use strict";

  var _exports = {};
  var DraftDataLossOptions;
  (function (DraftDataLossOptions) {
    DraftDataLossOptions["Save"] = "draftDataLossOptionSave";
    DraftDataLossOptions["Keep"] = "draftDataLossOptionKeep";
    DraftDataLossOptions["Discard"] = "draftDataLossOptionDiscard";
  })(DraftDataLossOptions || (DraftDataLossOptions = {}));
  let onDataLossConfirmedFollowUpFunction;
  let onDataLossCancelFollowUpFunction;
  function fnDataLossConfirmation(fnOnDataLossOk, fnOnDataLossCancel, controller, skipBindingToView) {
    // Open the data loss popup and after processing the selected function finally call
    // onDataLossConfirmed which resolves the promise and leads to processing of the originally
    // triggered action like e.g. a back navigation
    let dataLossPopup;
    onDataLossConfirmedFollowUpFunction = fnOnDataLossOk;
    onDataLossCancelFollowUpFunction = fnOnDataLossCancel;
    const fragmentName = "sap.fe.core.controls.DataLossOrDraftDiscard.DataLossDraft";
    const view = controller.getView();
    const fragmentController = {
      onDataLossOk: function () {
        handleDataLossOk(dataLossPopup, controller, onDataLossConfirmedFollowUpFunction, skipBindingToView);
      },
      onDataLossCancel: function () {
        onDataLossCancelFollowUpFunction();
        dataLossPopup.close();
      },
      setDataLossPopup: function (inDataLossPopup) {
        controller.dataLossPopup = inDataLossPopup;
      }
    };
    const localThisModel = new JSONModel({}),
      preprocessorSettings = {
        bindingContexts: {
          this: localThisModel.createBindingContext("/")
        },
        models: {
          this: localThisModel
        }
      };
    if (controller.dataLossPopup) {
      dataLossPopup = controller.dataLossPopup;
      dataLossPopup.open();
      selectAndFocusFirstEntry(dataLossPopup);
    } else {
      const dialogFragment = XMLTemplateProcessor.loadTemplate(fragmentName, "fragment");
      Promise.resolve(XMLPreprocessor.process(dialogFragment, {
        name: fragmentName
      }, preprocessorSettings)).then(fragment => {
        return Fragment.load({
          definition: fragment,
          controller: fragmentController
        });
      }).then(popup => {
        dataLossPopup = popup;
        selectAndFocusFirstEntry(dataLossPopup);
        popup.addEventDelegate({
          onsapenter: function () {
            handleDataLossOk(dataLossPopup, controller, onDataLossConfirmedFollowUpFunction, skipBindingToView);
          }
        });
        view.addDependent(dataLossPopup);
        dataLossPopup.open();
        fragmentController.setDataLossPopup(dataLossPopup);
      }).catch(function (error) {
        Log.error("Error while opening the Discard Dialog fragment", error);
      });
    }
  }
  function performAfterDiscardorKeepDraft(processFunctionOnDatalossOk, processFunctionOnDatalossCancel, controller, skipBindingToView) {
    // Depending on if the user closed the data loss popup with Ok or Cancel,
    // execute the provided follow-up function and resolve or reject the promise
    return new Promise(function (resolve, reject) {
      const dataLossPopupOk = function (context) {
        const returnValue = processFunctionOnDatalossOk(context);
        resolve(returnValue);
      };
      const dataLossPopupCancel = function () {
        processFunctionOnDatalossCancel();
        reject();
      };
      fnDataLossConfirmation(dataLossPopupOk, dataLossPopupCancel, controller, skipBindingToView);
    });
  }
  _exports.performAfterDiscardorKeepDraft = performAfterDiscardorKeepDraft;
  function discardDraft(controller, skipBindingToView) {
    const context = controller.getView().getBindingContext();
    const params = {
      skipBackNavigation: true,
      skipDiscardPopover: true,
      skipBindingToView: skipBindingToView !== undefined ? skipBindingToView : true
    };
    return controller.editFlow.cancelDocument(context, params);
  }
  _exports.discardDraft = discardDraft;
  function saveDocument(controller) {
    const context = controller.getView().getBindingContext();
    // We check if we are on the OP and then call the internal _saveDocument from the OP controller
    // since here some special handling is done for creationRow before editFlow.saveDocument is called.
    // In case of a custom controller we directly call saveDocument from the editFlow
    if (controller.isA("sap.fe.templates.ObjectPage.ObjectPageController")) {
      return controller._saveDocument(context);
    } else {
      return controller.editFlow.saveDocument(context);
    }
  }
  _exports.saveDocument = saveDocument;
  function getSelectedKey(dataLossPopup) {
    // For not using control IDs we introduced customData in the fragment and
    // use it here for finding the correct list in the dialog and for
    // determining the selected option from the list
    const dataLossOptionsList = dataLossPopup.getContent().find(element => element.data("listIdentifier") === "draftDataLossOptionsList");
    return dataLossOptionsList.getSelectedItem().data("itemKey");
  }
  _exports.getSelectedKey = getSelectedKey;
  function selectAndFocusFirstEntry(dataLossPopup) {
    // For not using control IDs we introduced customData in the fragment and
    // use it here for finding the correct list in the dialog.
    const dataLossOptionsList = dataLossPopup.getContent().find(element => element.data("listIdentifier") === "draftDataLossOptionsList");
    // Preselect the first entry in the list
    const firstListItemOption = dataLossOptionsList.getItems()[0];
    dataLossOptionsList.setSelectedItem(firstListItemOption);
    // By default set the focus on the first list item of the dialog
    // We do not set the focus on the button, but catch the ENTER key in the dialog
    // and process it as Ok, since focusing the button was reported as an ACC issue
    firstListItemOption === null || firstListItemOption === void 0 ? void 0 : firstListItemOption.focus();
  }

  /**
   * Executes the logic when the data loss dialog is confirmed.
   *
   * @param dataLossPopup Reference to the data loss dialog
   * @param controller Reference to the controller
   * @param dataLossConfirmationFollowUpFunction The action to be performed after the selected option has been executed
   * @param skipBindingToView Forwarded to discardDraft
   */
  _exports.selectAndFocusFirstEntry = selectAndFocusFirstEntry;
  function handleDataLossOk(dataLossPopup, controller, dataLossConfirmationFollowUpFunction, skipBindingToView) {
    const selectedKey = getSelectedKey(dataLossPopup);
    if (selectedKey === DraftDataLossOptions.Save) {
      saveDocument(controller).then(dataLossConfirmationFollowUpFunction).catch(function (error) {
        Log.error("Error while saving document", error);
      });
      dataLossPopup.close();
    } else if (selectedKey === DraftDataLossOptions.Keep) {
      dataLossConfirmationFollowUpFunction();
      dataLossPopup.close();
    } else if (selectedKey === DraftDataLossOptions.Discard) {
      discardDraft(controller, skipBindingToView).then(dataLossConfirmationFollowUpFunction).catch(function (error) {
        Log.error("Error while discarding draft", error);
      });
      dataLossPopup.close();
    }
  }
  _exports.handleDataLossOk = handleDataLossOk;
  return {
    performAfterDiscardorKeepDraft,
    discardDraft,
    saveDocument,
    getSelectedKey,
    selectAndFocusFirstEntry
  };
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/DataLossOrDraftDiscard/DataLossOrDraftDiscardHandler", ["sap/base/Log","sap/ui/core/Fragment","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/model/json/JSONModel"],function(e,t,n,o,s){"use strict";var a={};var i;(function(e){e["Save"]="draftDataLossOptionSave";e["Keep"]="draftDataLossOptionKeep";e["Discard"]="draftDataLossOptionDiscard"})(i||(i={}));let r;let c;function d(a,i,d,f){let u;r=a;c=i;const l="sap.fe.core.controls.DataLossOrDraftDiscard.DataLossDraft";const p=d.getView();const m={onDataLossOk:function(){g(u,d,r,f)},onDataLossCancel:function(){c();u.close()},setDataLossPopup:function(e){d.dataLossPopup=e}};const L=new s({}),v={bindingContexts:{this:L.createBindingContext("/")},models:{this:L}};if(d.dataLossPopup){u=d.dataLossPopup;u.open();D(u)}else{const s=o.loadTemplate(l,"fragment");Promise.resolve(n.process(s,{name:l},v)).then(e=>t.load({definition:e,controller:m})).then(e=>{u=e;D(u);e.addEventDelegate({onsapenter:function(){g(u,d,r,f)}});p.addDependent(u);u.open();m.setDataLossPopup(u)}).catch(function(t){e.error("Error while opening the Discard Dialog fragment",t)})}}function f(e,t,n,o){return new Promise(function(s,a){const i=function(t){const n=e(t);s(n)};const r=function(){t();a()};d(i,r,n,o)})}a.performAfterDiscardorKeepDraft=f;function u(e,t){const n=e.getView().getBindingContext();const o={skipBackNavigation:true,skipDiscardPopover:true,skipBindingToView:t!==undefined?t:true};return e.editFlow.cancelDocument(n,o)}a.discardDraft=u;function l(e){const t=e.getView().getBindingContext();if(e.isA("sap.fe.templates.ObjectPage.ObjectPageController")){return e._saveDocument(t)}else{return e.editFlow.saveDocument(t)}}a.saveDocument=l;function p(e){const t=e.getContent().find(e=>e.data("listIdentifier")==="draftDataLossOptionsList");return t.getSelectedItem().data("itemKey")}a.getSelectedKey=p;function D(e){const t=e.getContent().find(e=>e.data("listIdentifier")==="draftDataLossOptionsList");const n=t.getItems()[0];t.setSelectedItem(n);n===null||n===void 0?void 0:n.focus()}a.selectAndFocusFirstEntry=D;function g(t,n,o,s){const a=p(t);if(a===i.Save){l(n).then(o).catch(function(t){e.error("Error while saving document",t)});t.close()}else if(a===i.Keep){o();t.close()}else if(a===i.Discard){u(n,s).then(o).catch(function(t){e.error("Error while discarding draft",t)});t.close()}}a.handleDataLossOk=g;return{performAfterDiscardorKeepDraft:f,discardDraft:u,saveDocument:l,getSelectedKey:p,selectAndFocusFirstEntry:D}},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FieldWrapper-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/core/Control"], function (ClassSupport, Control) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9;
  var property = ClassSupport.property;
  var implementInterface = ClassSupport.implementInterface;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var association = ClassSupport.association;
  var aggregation = ClassSupport.aggregation;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let FieldWrapper = (_dec = defineUI5Class("sap.fe.core.controls.FieldWrapper"), _dec2 = implementInterface("sap.ui.core.IFormContent"), _dec3 = property({
    type: "sap.ui.core.TextAlign"
  }), _dec4 = property({
    type: "sap.ui.core.CSSSize",
    defaultValue: null
  }), _dec5 = property({
    type: "boolean",
    defaultValue: false
  }), _dec6 = property({
    type: "string",
    defaultValue: "Display"
  }), _dec7 = property({
    type: "boolean",
    defaultValue: false
  }), _dec8 = association({
    type: "sap.ui.core.Control",
    multiple: true,
    singularName: "ariaLabelledBy"
  }), _dec9 = aggregation({
    type: "sap.ui.core.Control",
    multiple: false,
    isDefault: true
  }), _dec10 = aggregation({
    type: "sap.ui.core.Control",
    multiple: true
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_Control) {
    _inheritsLoose(FieldWrapper, _Control);
    function FieldWrapper() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _Control.call(this, ...args) || this;
      _initializerDefineProperty(_this, "__implements__sap_ui_core_IFormContent", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "textAlign", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "width", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "formDoNotAdjustWidth", _descriptor4, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "editMode", _descriptor5, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "required", _descriptor6, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "ariaLabelledBy", _descriptor7, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "contentDisplay", _descriptor8, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "contentEdit", _descriptor9, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = FieldWrapper.prototype;
    _proto.enhanceAccessibilityState = function enhanceAccessibilityState(oElement, mAriaProps) {
      const oParent = this.getParent();
      if (oParent && oParent.enhanceAccessibilityState) {
        // use FieldWrapper as control, but aria properties of rendered inner control.
        oParent.enhanceAccessibilityState(this, mAriaProps);
      }
      return mAriaProps;
    };
    _proto.getAccessibilityInfo = function getAccessibilityInfo() {
      let oContent;
      if (this.editMode === "Display") {
        oContent = this.contentDisplay;
      } else {
        oContent = this.contentEdit.length ? this.contentEdit[0] : null;
      }
      return oContent && oContent.getAccessibilityInfo ? oContent.getAccessibilityInfo() : {};
    }

    /**
     * Returns the DOMNode ID to be used for the "labelFor" attribute.
     *
     * We forward the call of this method to the content control.
     *
     * @returns ID to be used for the <code>labelFor</code>
     */;
    _proto.getIdForLabel = function getIdForLabel() {
      var _oContent;
      let oContent;
      if (this.editMode === "Display") {
        oContent = this.contentDisplay;
      } else {
        oContent = this.contentEdit.length ? this.contentEdit[0] : null;
      }
      return (_oContent = oContent) === null || _oContent === void 0 ? void 0 : _oContent.getIdForLabel();
    };
    _proto._setAriaLabelledBy = function _setAriaLabelledBy(oContent) {
      if (oContent && oContent.addAriaLabelledBy) {
        const aAriaLabelledBy = this.ariaLabelledBy;
        for (let i = 0; i < aAriaLabelledBy.length; i++) {
          const sId = aAriaLabelledBy[i];
          const aAriaLabelledBys = oContent.getAriaLabelledBy() || [];
          if (aAriaLabelledBys.indexOf(sId) === -1) {
            oContent.addAriaLabelledBy(sId);
          }
        }
      }
    };
    _proto.onBeforeRendering = function onBeforeRendering() {
      // before calling the renderer of the FieldWrapper parent control may have set ariaLabelledBy
      // we ensure it is passed to its inner controls
      this._setAriaLabelledBy(this.contentDisplay);
      const aContentEdit = this.contentEdit;
      for (let i = 0; i < aContentEdit.length; i++) {
        this._setAriaLabelledBy(aContentEdit[i]);
      }
    };
    FieldWrapper.render = function render(oRm, oControl) {
      oRm.openStart("div", oControl);
      oRm.style("text-align", oControl.textAlign);
      if (oControl.editMode === "Display") {
        oRm.style("width", oControl.width);
        oRm.openEnd();
        oRm.renderControl(oControl.contentDisplay); // render the child Control for display
      } else {
        const aContentEdit = oControl.contentEdit;

        // if (aContentEdit.length > 1) {
        // 	oRm.class("sapUiMdcFieldBaseMoreFields");
        // }
        oRm.style("width", oControl.width);
        oRm.openEnd();
        for (let i = 0; i < aContentEdit.length; i++) {
          const oContent = aContentEdit[i]; // render the child Control  for edit
          oRm.renderControl(oContent);
        }
      }
      oRm.close("div"); // end of the complete Control
    };
    return FieldWrapper;
  }(Control), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "__implements__sap_ui_core_IFormContent", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return true;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "textAlign", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "width", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "formDoNotAdjustWidth", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "editMode", [_dec6], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "required", [_dec7], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "ariaLabelledBy", [_dec8], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "contentDisplay", [_dec9], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "contentEdit", [_dec10], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return FieldWrapper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FieldWrapper", ["sap/fe/core/helpers/ClassSupport","sap/ui/core/Control"],function(e,t){"use strict";var i,r,n,l,a,o,u,s,c,p,d,f,b,y,h,g,m,v,w,_,A;var z=e.property;var D=e.implementInterface;var E=e.defineUI5Class;var C=e.association;var L=e.aggregation;function B(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function I(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function O(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;j(e,t)}function j(e,t){j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return j(e,t)}function S(e,t,i,r,n){var l={};Object.keys(r).forEach(function(e){l[e]=r[e]});l.enumerable=!!l.enumerable;l.configurable=!!l.configurable;if("value"in l||l.initializer){l.writable=true}l=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},l);if(n&&l.initializer!==void 0){l.value=l.initializer?l.initializer.call(n):void 0;l.initializer=undefined}if(l.initializer===void 0){Object.defineProperty(e,t,l);l=null}return l}function x(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let F=(i=E("sap.fe.core.controls.FieldWrapper"),r=D("sap.ui.core.IFormContent"),n=z({type:"sap.ui.core.TextAlign"}),l=z({type:"sap.ui.core.CSSSize",defaultValue:null}),a=z({type:"boolean",defaultValue:false}),o=z({type:"string",defaultValue:"Display"}),u=z({type:"boolean",defaultValue:false}),s=C({type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}),c=L({type:"sap.ui.core.Control",multiple:false,isDefault:true}),p=L({type:"sap.ui.core.Control",multiple:true}),i(d=(f=function(e){O(t,e);function t(){var t;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++){r[n]=arguments[n]}t=e.call(this,...r)||this;B(t,"__implements__sap_ui_core_IFormContent",b,I(t));B(t,"textAlign",y,I(t));B(t,"width",h,I(t));B(t,"formDoNotAdjustWidth",g,I(t));B(t,"editMode",m,I(t));B(t,"required",v,I(t));B(t,"ariaLabelledBy",w,I(t));B(t,"contentDisplay",_,I(t));B(t,"contentEdit",A,I(t));return t}var i=t.prototype;i.enhanceAccessibilityState=function e(t,i){const r=this.getParent();if(r&&r.enhanceAccessibilityState){r.enhanceAccessibilityState(this,i)}return i};i.getAccessibilityInfo=function e(){let t;if(this.editMode==="Display"){t=this.contentDisplay}else{t=this.contentEdit.length?this.contentEdit[0]:null}return t&&t.getAccessibilityInfo?t.getAccessibilityInfo():{}};i.getIdForLabel=function e(){var t;let i;if(this.editMode==="Display"){i=this.contentDisplay}else{i=this.contentEdit.length?this.contentEdit[0]:null}return(t=i)===null||t===void 0?void 0:t.getIdForLabel()};i._setAriaLabelledBy=function e(t){if(t&&t.addAriaLabelledBy){const e=this.ariaLabelledBy;for(let i=0;i<e.length;i++){const r=e[i];const n=t.getAriaLabelledBy()||[];if(n.indexOf(r)===-1){t.addAriaLabelledBy(r)}}}};i.onBeforeRendering=function e(){this._setAriaLabelledBy(this.contentDisplay);const t=this.contentEdit;for(let e=0;e<t.length;e++){this._setAriaLabelledBy(t[e])}};t.render=function e(t,i){t.openStart("div",i);t.style("text-align",i.textAlign);if(i.editMode==="Display"){t.style("width",i.width);t.openEnd();t.renderControl(i.contentDisplay)}else{const e=i.contentEdit;t.style("width",i.width);t.openEnd();for(let i=0;i<e.length;i++){const r=e[i];t.renderControl(r)}}t.close("div")};return t}(t),b=S(f.prototype,"__implements__sap_ui_core_IFormContent",[r],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),y=S(f.prototype,"textAlign",[n],{configurable:true,enumerable:true,writable:true,initializer:null}),h=S(f.prototype,"width",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),g=S(f.prototype,"formDoNotAdjustWidth",[a],{configurable:true,enumerable:true,writable:true,initializer:null}),m=S(f.prototype,"editMode",[o],{configurable:true,enumerable:true,writable:true,initializer:null}),v=S(f.prototype,"required",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),w=S(f.prototype,"ariaLabelledBy",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),_=S(f.prototype,"contentDisplay",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),A=S(f.prototype,"contentEdit",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),f))||d);return F},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FileWrapper-dbg", ["sap/fe/core/CommonUtils", "sap/fe/core/converters/MetaModelConverter", "sap/fe/core/helpers/ClassSupport", "sap/fe/macros/ResourceModel", "sap/m/BusyDialog", "./FieldWrapper"], function (CommonUtils, MetaModelConverter, ClassSupport, ResourceModel, BusyDialog, FieldWrapper) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10;
  var property = ClassSupport.property;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var aggregation = ClassSupport.aggregation;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let FileWrapper = (_dec = defineUI5Class("sap.fe.core.controls.FileWrapper"), _dec2 = property({
    type: "sap.ui.core.URI"
  }), _dec3 = property({
    type: "string"
  }), _dec4 = property({
    type: "string"
  }), _dec5 = property({
    type: "string"
  }), _dec6 = aggregation({
    type: "sap.m.Avatar",
    multiple: false
  }), _dec7 = aggregation({
    type: "sap.ui.core.Icon",
    multiple: false
  }), _dec8 = aggregation({
    type: "sap.m.Link",
    multiple: false
  }), _dec9 = aggregation({
    type: "sap.m.Text",
    multiple: false
  }), _dec10 = aggregation({
    type: "sap.ui.unified.FileUploader",
    multiple: false
  }), _dec11 = aggregation({
    type: "sap.m.Button",
    multiple: false
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_FieldWrapper) {
    _inheritsLoose(FileWrapper, _FieldWrapper);
    function FileWrapper() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _FieldWrapper.call(this, ...args) || this;
      _initializerDefineProperty(_this, "uploadUrl", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "propertyPath", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "filename", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "mediaType", _descriptor4, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "avatar", _descriptor5, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "icon", _descriptor6, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "link", _descriptor7, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "text", _descriptor8, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "fileUploader", _descriptor9, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "deleteButton", _descriptor10, _assertThisInitialized(_this));
      _this._busy = false;
      return _this;
    }
    var _proto = FileWrapper.prototype;
    _proto.getAccessibilityInfo = function getAccessibilityInfo() {
      const accInfo = [];
      if (this.avatar) {
        accInfo.push(this.avatar);
      }
      if (this.icon) {
        accInfo.push(this.icon);
      }
      if (this.link) {
        accInfo.push(this.link);
      }
      if (this.text) {
        accInfo.push(this.text);
      }
      if (this.fileUploader) {
        accInfo.push(this.fileUploader);
      }
      if (this.deleteButton) {
        accInfo.push(this.deleteButton);
      }
      return {
        children: accInfo
      };
    };
    _proto.onBeforeRendering = function onBeforeRendering() {
      this._setAriaLabels();
      this._addSideEffects();
    };
    _proto._setAriaLabels = function _setAriaLabels() {
      this._setAriaLabelledBy(this.avatar);
      this._setAriaLabelledBy(this.icon);
      this._setAriaLabelledBy(this.link);
      this._setAriaLabelledBy(this.text);
      this._setAriaLabelledBy(this.fileUploader);
      this._setAriaLabelledBy(this.deleteButton);
    };
    _proto._addSideEffects = function _addSideEffects() {
      var _this$_getSideEffectC;
      // add control SideEffects for stream content, filename and mediatype
      const navigationProperties = [],
        view = CommonUtils.getTargetView(this),
        viewDataFullContextPath = view.getViewData().fullContextPath,
        metaModel = view.getModel().getMetaModel(),
        metaModelPath = metaModel.getMetaPath(viewDataFullContextPath),
        viewContext = metaModel.getContext(viewDataFullContextPath),
        dataViewModelPath = MetaModelConverter.getInvolvedDataModelObjects(viewContext),
        sourcePath = this.data("sourcePath"),
        fieldPath = sourcePath.replace(`${metaModelPath}`, ""),
        path = fieldPath.replace(this.propertyPath, "");
      navigationProperties.push({
        $NavigationPropertyPath: fieldPath
      });
      if (this.filename) {
        navigationProperties.push({
          $NavigationPropertyPath: path + this.filename
        });
      }
      if (this.mediaType) {
        navigationProperties.push({
          $NavigationPropertyPath: path + this.mediaType
        });
      }
      (_this$_getSideEffectC = this._getSideEffectController()) === null || _this$_getSideEffectC === void 0 ? void 0 : _this$_getSideEffectC.addControlSideEffects(dataViewModelPath.targetEntityType.fullyQualifiedName, {
        SourceProperties: [fieldPath],
        TargetEntities: navigationProperties,
        sourceControlId: this.getId()
      });
    };
    _proto._getSideEffectController = function _getSideEffectController() {
      const controller = this._getViewController();
      return controller ? controller._sideEffects : undefined;
    };
    _proto._getViewController = function _getViewController() {
      const view = CommonUtils.getTargetView(this);
      return view && view.getController();
    };
    _proto.getUploadUrl = function getUploadUrl() {
      // set upload url as canonical url for NavigationProperties
      // this is a workaround as some backends cannot resolve NavigationsProperties for stream types
      const context = this.getBindingContext();
      return context && this.uploadUrl ? this.uploadUrl.replace(context.getPath(), context.getCanonicalPath()) : "";
    };
    _proto.setUIBusy = function setUIBusy(busy) {
      // eslint-disable-next-line @typescript-eslint/no-this-alias
      const that = this;
      this._busy = busy;
      if (busy) {
        if (!this.busyDialog) {
          this.busyDialog = new BusyDialog({
            text: ResourceModel.getText("M_FILEWRAPPER_BUSY_DIALOG_TITLE"),
            showCancelButton: false
          });
        }
        setTimeout(function () {
          if (that._busy) {
            var _that$busyDialog;
            (_that$busyDialog = that.busyDialog) === null || _that$busyDialog === void 0 ? void 0 : _that$busyDialog.open();
          }
        }, 1000);
      } else {
        var _this$busyDialog;
        (_this$busyDialog = this.busyDialog) === null || _this$busyDialog === void 0 ? void 0 : _this$busyDialog.close(false);
      }
    };
    _proto.getUIBusy = function getUIBusy() {
      // eslint-disable-next-line @typescript-eslint/no-this-alias
      return this._busy;
    };
    FileWrapper.render = function render(renderManager, fileWrapper) {
      renderManager.openStart("div", fileWrapper); // FileWrapper control div
      renderManager.style("width", fileWrapper.width);
      renderManager.openEnd();

      // Outer Box
      renderManager.openStart("div"); // div for all controls
      renderManager.style("display", "flex");
      renderManager.style("box-sizing", "border-box");
      renderManager.style("justify-content", "space-between");
      renderManager.style("align-items", "center");
      renderManager.style("flex-wrap", "wrap");
      renderManager.style("align-content", "stretch");
      renderManager.style("width", "100%");
      renderManager.openEnd();

      // Display Mode
      renderManager.openStart("div"); // div for controls shown in Display mode
      renderManager.style("display", "flex");
      renderManager.style("align-items", "center");
      renderManager.openEnd();
      if (fileWrapper.avatar) {
        renderManager.renderControl(fileWrapper.avatar); // render the Avatar Control
      } else {
        renderManager.renderControl(fileWrapper.icon); // render the Icon Control
        renderManager.renderControl(fileWrapper.link); // render the Link Control
        renderManager.renderControl(fileWrapper.text); // render the Text Control for empty file indication
      }

      renderManager.close("div"); // div for controls shown in Display mode

      // Additional content for Edit Mode
      renderManager.openStart("div"); // div for controls shown in Display + Edit mode
      renderManager.style("display", "flex");
      renderManager.style("align-items", "center");
      renderManager.openEnd();
      renderManager.renderControl(fileWrapper.fileUploader); // render the FileUploader Control
      renderManager.renderControl(fileWrapper.deleteButton); // render the Delete Button Control
      renderManager.close("div"); // div for controls shown in Display + Edit mode

      renderManager.close("div"); // div for all controls

      renderManager.close("div"); // end of the complete Control
    };
    _proto.destroy = function destroy(bSuppressInvalidate) {
      const oSideEffects = this._getSideEffectController();
      if (oSideEffects) {
        oSideEffects.removeControlSideEffects(this);
      }
      delete this.busyDialog;
      FieldWrapper.prototype.destroy.apply(this, [bSuppressInvalidate]);
    };
    return FileWrapper;
  }(FieldWrapper), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "uploadUrl", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "propertyPath", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "filename", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "mediaType", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "avatar", [_dec6], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "icon", [_dec7], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "link", [_dec8], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "text", [_dec9], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "fileUploader", [_dec10], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor10 = _applyDecoratedDescriptor(_class2.prototype, "deleteButton", [_dec11], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return FileWrapper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FileWrapper", ["sap/fe/core/CommonUtils","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/ClassSupport","sap/fe/macros/ResourceModel","sap/m/BusyDialog","./FieldWrapper"],function(e,t,i,r,l,n){"use strict";var a,o,s,u,p,f,c,d,h,y,b,g,v,m,w,_,C,P,B,E,z,U,x;var S=i.property;var A=i.defineUI5Class;var T=i.aggregation;function I(e,t,i,r){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function L(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function D(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;O(e,t)}function O(e,t){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return O(e,t)}function M(e,t,i,r,l){var n={};Object.keys(r).forEach(function(e){n[e]=r[e]});n.enumerable=!!n.enumerable;n.configurable=!!n.configurable;if("value"in n||n.initializer){n.writable=true}n=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},n);if(l&&n.initializer!==void 0){n.value=n.initializer?n.initializer.call(l):void 0;n.initializer=undefined}if(n.initializer===void 0){Object.defineProperty(e,t,n);n=null}return n}function j(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let k=(a=A("sap.fe.core.controls.FileWrapper"),o=S({type:"sap.ui.core.URI"}),s=S({type:"string"}),u=S({type:"string"}),p=S({type:"string"}),f=T({type:"sap.m.Avatar",multiple:false}),c=T({type:"sap.ui.core.Icon",multiple:false}),d=T({type:"sap.m.Link",multiple:false}),h=T({type:"sap.m.Text",multiple:false}),y=T({type:"sap.ui.unified.FileUploader",multiple:false}),b=T({type:"sap.m.Button",multiple:false}),a(g=(v=function(i){D(a,i);function a(){var e;for(var t=arguments.length,r=new Array(t),l=0;l<t;l++){r[l]=arguments[l]}e=i.call(this,...r)||this;I(e,"uploadUrl",m,L(e));I(e,"propertyPath",w,L(e));I(e,"filename",_,L(e));I(e,"mediaType",C,L(e));I(e,"avatar",P,L(e));I(e,"icon",B,L(e));I(e,"link",E,L(e));I(e,"text",z,L(e));I(e,"fileUploader",U,L(e));I(e,"deleteButton",x,L(e));e._busy=false;return e}var o=a.prototype;o.getAccessibilityInfo=function e(){const t=[];if(this.avatar){t.push(this.avatar)}if(this.icon){t.push(this.icon)}if(this.link){t.push(this.link)}if(this.text){t.push(this.text)}if(this.fileUploader){t.push(this.fileUploader)}if(this.deleteButton){t.push(this.deleteButton)}return{children:t}};o.onBeforeRendering=function e(){this._setAriaLabels();this._addSideEffects()};o._setAriaLabels=function e(){this._setAriaLabelledBy(this.avatar);this._setAriaLabelledBy(this.icon);this._setAriaLabelledBy(this.link);this._setAriaLabelledBy(this.text);this._setAriaLabelledBy(this.fileUploader);this._setAriaLabelledBy(this.deleteButton)};o._addSideEffects=function i(){var r;const l=[],n=e.getTargetView(this),a=n.getViewData().fullContextPath,o=n.getModel().getMetaModel(),s=o.getMetaPath(a),u=o.getContext(a),p=t.getInvolvedDataModelObjects(u),f=this.data("sourcePath"),c=f.replace(`${s}`,""),d=c.replace(this.propertyPath,"");l.push({$NavigationPropertyPath:c});if(this.filename){l.push({$NavigationPropertyPath:d+this.filename})}if(this.mediaType){l.push({$NavigationPropertyPath:d+this.mediaType})}(r=this._getSideEffectController())===null||r===void 0?void 0:r.addControlSideEffects(p.targetEntityType.fullyQualifiedName,{SourceProperties:[c],TargetEntities:l,sourceControlId:this.getId()})};o._getSideEffectController=function e(){const t=this._getViewController();return t?t._sideEffects:undefined};o._getViewController=function t(){const i=e.getTargetView(this);return i&&i.getController()};o.getUploadUrl=function e(){const t=this.getBindingContext();return t&&this.uploadUrl?this.uploadUrl.replace(t.getPath(),t.getCanonicalPath()):""};o.setUIBusy=function e(t){const i=this;this._busy=t;if(t){if(!this.busyDialog){this.busyDialog=new l({text:r.getText("M_FILEWRAPPER_BUSY_DIALOG_TITLE"),showCancelButton:false})}setTimeout(function(){if(i._busy){var e;(e=i.busyDialog)===null||e===void 0?void 0:e.open()}},1e3)}else{var n;(n=this.busyDialog)===null||n===void 0?void 0:n.close(false)}};o.getUIBusy=function e(){return this._busy};a.render=function e(t,i){t.openStart("div",i);t.style("width",i.width);t.openEnd();t.openStart("div");t.style("display","flex");t.style("box-sizing","border-box");t.style("justify-content","space-between");t.style("align-items","center");t.style("flex-wrap","wrap");t.style("align-content","stretch");t.style("width","100%");t.openEnd();t.openStart("div");t.style("display","flex");t.style("align-items","center");t.openEnd();if(i.avatar){t.renderControl(i.avatar)}else{t.renderControl(i.icon);t.renderControl(i.link);t.renderControl(i.text)}t.close("div");t.openStart("div");t.style("display","flex");t.style("align-items","center");t.openEnd();t.renderControl(i.fileUploader);t.renderControl(i.deleteButton);t.close("div");t.close("div");t.close("div")};o.destroy=function e(t){const i=this._getSideEffectController();if(i){i.removeControlSideEffects(this)}delete this.busyDialog;n.prototype.destroy.apply(this,[t])};return a}(n),m=M(v.prototype,"uploadUrl",[o],{configurable:true,enumerable:true,writable:true,initializer:null}),w=M(v.prototype,"propertyPath",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),_=M(v.prototype,"filename",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),C=M(v.prototype,"mediaType",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),P=M(v.prototype,"avatar",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),B=M(v.prototype,"icon",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),E=M(v.prototype,"link",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),z=M(v.prototype,"text",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),U=M(v.prototype,"fileUploader",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),x=M(v.prototype,"deleteButton",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),v))||g);return k},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FilterBar-dbg", ["sap/fe/core/controls/filterbar/FilterContainer", "sap/fe/core/controls/filterbar/VisualFilterContainer", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/Core", "sap/ui/mdc/FilterBar", "sap/ui/mdc/filterbar/aligned/FilterItemLayout"], function (FilterContainer, VisualFilterContainer, ClassSupport, Core, MdcFilterBar, FilterItemLayout) {
  "use strict";

  var _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2;
  var property = ClassSupport.property;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var association = ClassSupport.association;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let FilterBar = (_dec = defineUI5Class("sap.fe.core.controls.FilterBar"), _dec2 = property({
    type: "string",
    defaultValue: "compact"
  }), _dec3 = association({
    type: "sap.m.SegmentedButton",
    multiple: false
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_MdcFilterBar) {
    _inheritsLoose(FilterBar, _MdcFilterBar);
    function FilterBar() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _MdcFilterBar.call(this, ...args) || this;
      _initializerDefineProperty(_this, "initialLayout", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "toggleControl", _descriptor2, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = FilterBar.prototype;
    _proto.setToggleControl = function setToggleControl(vToggle) {
      if (typeof vToggle === "string") {
        this._oSegmentedButton = Core.byId(vToggle);
      } else {
        this._oSegmentedButton = vToggle;
      }
      if (this.toggleControl && this._oSegmentedButton) {
        this._oSegmentedButton.detachEvent("select", this._toggleLayout.bind(this));
      }
      if (this._oSegmentedButton) {
        this._oSegmentedButton.attachEvent("select", this._toggleLayout.bind(this));
      }
      this.setAssociation("toggleControl", vToggle, true);
    };
    _proto._toggleLayout = function _toggleLayout() {
      // Since primary layout is always compact
      // hence set the secondary layout as visual filter only for the first time only
      if (!this._oSecondaryFilterBarLayout) {
        this._oSecondaryFilterBarLayout = new VisualFilterContainer();
      }

      // do not show Adapt Filters Button for visual layout
      if (this._oSecondaryFilterBarLayout.isA("sap.fe.core.controls.filterbar.VisualFilterContainer")) {
        this.setShowAdaptFiltersButton(false);
      } else {
        this.setShowAdaptFiltersButton(true);
      }

      // get all filter fields and button of the current layout
      const oCurrentFilterBarLayout = this._oFilterBarLayout;
      const oFilterItems = this.getFilterItems();
      const aFilterFields = oCurrentFilterBarLayout.getAllFilterFields();
      const aSortedFilterFields = this.getSortedFilterFields(oFilterItems, aFilterFields);
      const aButtons = oCurrentFilterBarLayout.getAllButtons();
      const aVisualFilterFields = oCurrentFilterBarLayout.getAllVisualFilterFields && oCurrentFilterBarLayout.getAllVisualFilterFields();
      if (this._oSecondaryFilterBarLayout.isA("sap.fe.core.controls.filterbar.VisualFilterContainer")) {
        this._oSecondaryFilterBarLayout.setAllFilterFields(aSortedFilterFields, aVisualFilterFields);
      }
      // use secondary filter bar layout as new layout
      this._oFilterBarLayout = this._oSecondaryFilterBarLayout;

      // insert all filter fields from current layout to new layout
      aFilterFields.forEach((oFilterField, iIndex) => {
        oCurrentFilterBarLayout.removeFilterField(oFilterField);
        this._oFilterBarLayout.insertFilterField(oFilterField, iIndex);
      });
      // insert all buttons from the current layout to the new layout
      aButtons.forEach(oButton => {
        oCurrentFilterBarLayout.removeButton(oButton);
        this._oFilterBarLayout.addButton(oButton);
      });

      // set the current filter bar layout to the secondary one
      this._oSecondaryFilterBarLayout = oCurrentFilterBarLayout;

      // update the layout aggregation of the filter bar and rerender the same.
      this.setAggregation("layout", this._oFilterBarLayout, true);
      this._oFilterBarLayout.rerender();
    };
    _proto.getSortedFilterFields = function getSortedFilterFields(aFilterItems, aFilterFields) {
      const aFilterIds = [];
      aFilterItems.forEach(function (oFilterItem) {
        aFilterIds.push(oFilterItem.getId());
      });
      aFilterFields.sort(function (aFirstItem, aSecondItem) {
        let sFirstItemVFId, sSecondItemVFId;
        aFirstItem.getContent().forEach(function (oInnerControl) {
          if (oInnerControl.isA("sap.ui.mdc.FilterField")) {
            sFirstItemVFId = oInnerControl.getId();
          }
        });
        aSecondItem.getContent().forEach(function (oInnerControl) {
          if (oInnerControl.isA("sap.ui.mdc.FilterField")) {
            sSecondItemVFId = oInnerControl.getId();
          }
        });
        return aFilterIds.indexOf(sFirstItemVFId) - aFilterIds.indexOf(sSecondItemVFId);
      });
      return aFilterFields;
    };
    _proto._createInnerLayout = function _createInnerLayout() {
      this._oFilterBarLayout = new FilterContainer();
      this._cLayoutItem = FilterItemLayout;
      this._oFilterBarLayout.getInner().addStyleClass("sapUiMdcFilterBarBaseAFLayout");
      this._addButtons();

      // TODO: Check with MDC if there is a better way to load visual filter on the basis of control property
      // _createInnerLayout is called on Init by the filter bar base.
      // This mean that we do not have access to the control properties yet
      // and hence we cannot decide on the basis of control properties whether initial layout should be compact or visual
      // As a result we have to do this workaround to always load the compact layout by default
      // And toogle the same in case the initialLayout was supposed to be visual filters.
      const oInnerLayout = this._oFilterBarLayout.getInner();
      const oFilterContainerInnerLayoutEventDelegate = {
        onBeforeRendering: () => {
          if (this.initialLayout === "visual") {
            this._toggleLayout();
          }
          oInnerLayout.removeEventDelegate(oFilterContainerInnerLayoutEventDelegate);
        }
      };
      oInnerLayout.addEventDelegate(oFilterContainerInnerLayoutEventDelegate);
      this.setAggregation("layout", this._oFilterBarLayout, true);
    };
    _proto.exit = function exit() {
      _MdcFilterBar.prototype.exit.call(this);
      // Sometimes upon external navigation this._SegmentedButton is already destroyed
      // so check if it exists and then only remove stuff
      if (this._oSegmentedButton) {
        this._oSegmentedButton.detachEvent("select", this._toggleLayout);
        delete this._oSegmentedButton;
      }
    };
    _proto.getSegmentedButton = function getSegmentedButton() {
      return this._oSegmentedButton;
    };
    return FilterBar;
  }(MdcFilterBar), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "initialLayout", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "toggleControl", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return FilterBar;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FilterBar", ["sap/fe/core/controls/filterbar/FilterContainer","sap/fe/core/controls/filterbar/VisualFilterContainer","sap/fe/core/helpers/ClassSupport","sap/ui/core/Core","sap/ui/mdc/FilterBar","sap/ui/mdc/filterbar/aligned/FilterItemLayout"],function(t,e,i,r,o,n){"use strict";var a,l,s,u,c,d,f;var h=i.property;var g=i.defineUI5Class;var y=i.association;function p(t,e,i,r){if(!i)return;Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function F(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function B(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;_(t,e)}function _(t,e){_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,i){e.__proto__=i;return e};return _(t,e)}function b(t,e,i,r,o){var n={};Object.keys(r).forEach(function(t){n[t]=r[t]});n.enumerable=!!n.enumerable;n.configurable=!!n.configurable;if("value"in n||n.initializer){n.writable=true}n=i.slice().reverse().reduce(function(i,r){return r(t,e,i)||i},n);if(o&&n.initializer!==void 0){n.value=n.initializer?n.initializer.call(o):void 0;n.initializer=undefined}if(n.initializer===void 0){Object.defineProperty(t,e,n);n=null}return n}function m(t,e){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let L=(a=g("sap.fe.core.controls.FilterBar"),l=h({type:"string",defaultValue:"compact"}),s=y({type:"sap.m.SegmentedButton",multiple:false}),a(u=(c=function(i){B(o,i);function o(){var t;for(var e=arguments.length,r=new Array(e),o=0;o<e;o++){r[o]=arguments[o]}t=i.call(this,...r)||this;p(t,"initialLayout",d,F(t));p(t,"toggleControl",f,F(t));return t}var a=o.prototype;a.setToggleControl=function t(e){if(typeof e==="string"){this._oSegmentedButton=r.byId(e)}else{this._oSegmentedButton=e}if(this.toggleControl&&this._oSegmentedButton){this._oSegmentedButton.detachEvent("select",this._toggleLayout.bind(this))}if(this._oSegmentedButton){this._oSegmentedButton.attachEvent("select",this._toggleLayout.bind(this))}this.setAssociation("toggleControl",e,true)};a._toggleLayout=function t(){if(!this._oSecondaryFilterBarLayout){this._oSecondaryFilterBarLayout=new e}if(this._oSecondaryFilterBarLayout.isA("sap.fe.core.controls.filterbar.VisualFilterContainer")){this.setShowAdaptFiltersButton(false)}else{this.setShowAdaptFiltersButton(true)}const i=this._oFilterBarLayout;const r=this.getFilterItems();const o=i.getAllFilterFields();const n=this.getSortedFilterFields(r,o);const a=i.getAllButtons();const l=i.getAllVisualFilterFields&&i.getAllVisualFilterFields();if(this._oSecondaryFilterBarLayout.isA("sap.fe.core.controls.filterbar.VisualFilterContainer")){this._oSecondaryFilterBarLayout.setAllFilterFields(n,l)}this._oFilterBarLayout=this._oSecondaryFilterBarLayout;o.forEach((t,e)=>{i.removeFilterField(t);this._oFilterBarLayout.insertFilterField(t,e)});a.forEach(t=>{i.removeButton(t);this._oFilterBarLayout.addButton(t)});this._oSecondaryFilterBarLayout=i;this.setAggregation("layout",this._oFilterBarLayout,true);this._oFilterBarLayout.rerender()};a.getSortedFilterFields=function t(e,i){const r=[];e.forEach(function(t){r.push(t.getId())});i.sort(function(t,e){let i,o;t.getContent().forEach(function(t){if(t.isA("sap.ui.mdc.FilterField")){i=t.getId()}});e.getContent().forEach(function(t){if(t.isA("sap.ui.mdc.FilterField")){o=t.getId()}});return r.indexOf(i)-r.indexOf(o)});return i};a._createInnerLayout=function e(){this._oFilterBarLayout=new t;this._cLayoutItem=n;this._oFilterBarLayout.getInner().addStyleClass("sapUiMdcFilterBarBaseAFLayout");this._addButtons();const i=this._oFilterBarLayout.getInner();const r={onBeforeRendering:()=>{if(this.initialLayout==="visual"){this._toggleLayout()}i.removeEventDelegate(r)}};i.addEventDelegate(r);this.setAggregation("layout",this._oFilterBarLayout,true)};a.exit=function t(){i.prototype.exit.call(this);if(this._oSegmentedButton){this._oSegmentedButton.detachEvent("select",this._toggleLayout);delete this._oSegmentedButton}};a.getSegmentedButton=function t(){return this._oSegmentedButton};return o}(o),d=b(c.prototype,"initialLayout",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),f=b(c.prototype,"toggleControl",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),c))||u);return L},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FormElementWrapper-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/core/Control"], function (ClassSupport, Control) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4;
  var property = ClassSupport.property;
  var implementInterface = ClassSupport.implementInterface;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var aggregation = ClassSupport.aggregation;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let FormElementWrapper = (_dec = defineUI5Class("sap.fe.core.controls.FormElementWrapper"), _dec2 = implementInterface("sap.ui.core.IFormContent"), _dec3 = property({
    type: "sap.ui.core.CSSSize",
    defaultValue: null
  }), _dec4 = property({
    type: "boolean",
    defaultValue: false
  }), _dec5 = aggregation({
    type: "sap.ui.core.Control",
    multiple: false,
    isDefault: true
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_Control) {
    _inheritsLoose(FormElementWrapper, _Control);
    function FormElementWrapper() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _Control.call(this, ...args) || this;
      _initializerDefineProperty(_this, "__implements__sap_ui_core_IFormContent", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "width", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "formDoNotAdjustWidth", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "content", _descriptor4, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = FormElementWrapper.prototype;
    _proto.getAccessibilityInfo = function getAccessibilityInfo() {
      const oContent = this.content;
      return oContent && oContent.getAccessibilityInfo ? oContent.getAccessibilityInfo() : {};
    };
    FormElementWrapper.render = function render(oRm, oControl) {
      oRm.openStart("div", oControl);
      oRm.style("min-height", "1rem");
      oRm.style("width", oControl.width);
      oRm.openEnd();
      oRm.openStart("div");
      oRm.style("display", "flex");
      oRm.style("box-sizing", "border-box");
      oRm.style("justify-content", "space-between");
      oRm.style("align-items", "center");
      oRm.style("flex-wrap", "wrap");
      oRm.style("align-content", "stretch");
      oRm.style("width", "100%");
      oRm.openEnd();
      oRm.renderControl(oControl.content); // render the child Control
      oRm.close("div");
      oRm.close("div"); // end of the complete Control
    };
    return FormElementWrapper;
  }(Control), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "__implements__sap_ui_core_IFormContent", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return true;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "width", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "formDoNotAdjustWidth", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "content", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return FormElementWrapper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/FormElementWrapper", ["sap/fe/core/helpers/ClassSupport","sap/ui/core/Control"],function(e,t){"use strict";var r,i,n,o,l,a,u,s,c,p,f;var b=e.property;var d=e.implementInterface;var y=e.defineUI5Class;var m=e.aggregation;function h(e,t,r,i){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function v(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function g(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;w(e,t)}function w(e,t){w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return w(e,t)}function _(e,t,r,i,n){var o={};Object.keys(i).forEach(function(e){o[e]=i[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},o);if(n&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(n):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function z(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let j=(r=y("sap.fe.core.controls.FormElementWrapper"),i=d("sap.ui.core.IFormContent"),n=b({type:"sap.ui.core.CSSSize",defaultValue:null}),o=b({type:"boolean",defaultValue:false}),l=m({type:"sap.ui.core.Control",multiple:false,isDefault:true}),r(a=(u=function(e){g(t,e);function t(){var t;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++){i[n]=arguments[n]}t=e.call(this,...i)||this;h(t,"__implements__sap_ui_core_IFormContent",s,v(t));h(t,"width",c,v(t));h(t,"formDoNotAdjustWidth",p,v(t));h(t,"content",f,v(t));return t}var r=t.prototype;r.getAccessibilityInfo=function e(){const t=this.content;return t&&t.getAccessibilityInfo?t.getAccessibilityInfo():{}};t.render=function e(t,r){t.openStart("div",r);t.style("min-height","1rem");t.style("width",r.width);t.openEnd();t.openStart("div");t.style("display","flex");t.style("box-sizing","border-box");t.style("justify-content","space-between");t.style("align-items","center");t.style("flex-wrap","wrap");t.style("align-content","stretch");t.style("width","100%");t.openEnd();t.renderControl(r.content);t.close("div");t.close("div")};return t}(t),s=_(u.prototype,"__implements__sap_ui_core_IFormContent",[i],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),c=_(u.prototype,"width",[n],{configurable:true,enumerable:true,writable:true,initializer:null}),p=_(u.prototype,"formDoNotAdjustWidth",[o],{configurable:true,enumerable:true,writable:true,initializer:null}),f=_(u.prototype,"content",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),u))||a);return j},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/MassEditSelect-dbg", ["sap/m/Select", "sap/m/SelectRenderer"], function (Select, SelectRenderer) {
  "use strict";

  const MassEditSelect = Select.extend("sap.fe.core.controls.MassEditSelect", {
    metadata: {
      properties: {
        showValueHelp: {
          type: "boolean"
        },
        valueHelpIconSrc: {
          type: "string"
        },
        selectValue: {
          type: "string"
        }
      },
      events: {
        valueHelpRequest: {}
      },
      interfaces: ["sap.ui.core.IFormContent"]
    },
    renderer: {
      apiVersion: 2,
      render: SelectRenderer.render
    }
  });
  return MassEditSelect;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/MassEditSelect", ["sap/m/Select","sap/m/SelectRenderer"],function(e,t){"use strict";const r=e.extend("sap.fe.core.controls.MassEditSelect",{metadata:{properties:{showValueHelp:{type:"boolean"},valueHelpIconSrc:{type:"string"},selectValue:{type:"string"}},events:{valueHelpRequest:{}},interfaces:["sap.ui.core.IFormContent"]},renderer:{apiVersion:2,render:t.render}});return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/MultiValueParameterDelegate-dbg", ["sap/ui/mdc/field/MultiValueFieldDelegate"], function (MultiValueFieldDelegate) {
  "use strict";

  const oMultiValueFieldDelegate = Object.assign({}, MultiValueFieldDelegate, {
    _transformConditions: function (aConditions, sKeyPath, sDescriptionPath) {
      const aTransformedItems = [];
      for (let i = 0; i < aConditions.length; i++) {
        const oItem = {};
        const oCondition = aConditions[i];
        oItem[sKeyPath] = oCondition.values[0];
        if (sDescriptionPath) {
          oItem[sDescriptionPath] = oCondition.values[1];
        }
        aTransformedItems.push(oItem);
      }
      return aTransformedItems;
    },
    updateItems: function (oPayload, aConditions, oMultiValueField) {
      const oListBinding = oMultiValueField.getBinding("items");
      const oBindingInfo = oMultiValueField.getBindingInfo("items");
      const sItemPath = oBindingInfo.path;
      const oTemplate = oBindingInfo.template;
      const oKeyBindingInfo = oTemplate.getBindingInfo("key");
      const sKeyPath = oKeyBindingInfo && oKeyBindingInfo.parts[0].path;
      const oDescriptionBindingInfo = oTemplate.getBindingInfo("description");
      const sDescriptionPath = oDescriptionBindingInfo && oDescriptionBindingInfo.parts[0].path;
      const oModel = oListBinding.getModel();
      oModel.setProperty(sItemPath, this._transformConditions(aConditions, sKeyPath, sDescriptionPath));
    }
  });
  return oMultiValueFieldDelegate;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/MultiValueParameterDelegate", ["sap/ui/mdc/field/MultiValueFieldDelegate"],function(t){"use strict";const n=Object.assign({},t,{_transformConditions:function(t,n,s){const e=[];for(let i=0;i<t.length;i++){const o={};const c=t[i];o[n]=c.values[0];if(s){o[s]=c.values[1]}e.push(o)}return e},updateItems:function(t,n,s){const e=s.getBinding("items");const i=s.getBindingInfo("items");const o=i.path;const c=i.template;const a=c.getBindingInfo("key");const r=a&&a.parts[0].path;const u=c.getBindingInfo("description");const d=u&&u.parts[0].path;const f=e.getModel();f.setProperty(o,this._transformConditions(n,r,d))}});return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/FilterContainer-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/mdc/filterbar/aligned/FilterContainer"], function (ClassSupport, MdcFilterContainer) {
  "use strict";

  var _dec, _class;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  /**
   * Constructor for a new FE filter container.
   *
   * @extends sap.ui.mdc.filterbar.aligned.FilterContainer
   * @class
   * @private
   * @alias sap.fe.core.controls.filterbar.FilterContainer
   */
  let FilterContainer = (_dec = defineUI5Class("sap.fe.core.controls.filterbar.FilterContainer"), _dec(_class = /*#__PURE__*/function (_MdcFilterContainer) {
    _inheritsLoose(FilterContainer, _MdcFilterContainer);
    function FilterContainer() {
      return _MdcFilterContainer.apply(this, arguments) || this;
    }
    var _proto = FilterContainer.prototype;
    _proto.init = function init() {
      this.aAllFilterFields = [];
      this.aAllVisualFilters = {};
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _MdcFilterContainer.prototype.init.call(this, ...args);
    };
    _proto.exit = function exit() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      // destroy layout
      _MdcFilterContainer.prototype.exit.call(this, ...args);
      // destroy all filter fields which are not in the layout
      this.aAllFilterFields.forEach(function (oFilterField) {
        oFilterField.destroy();
      });
      Object.keys(this.aAllVisualFilters).forEach(sKey => {
        this.aAllVisualFilters[sKey].destroy();
      });
    };
    _proto.insertFilterField = function insertFilterField(oControl, iIndex) {
      const oFilterItemLayoutEventDelegate = {
        onBeforeRendering: function () {
          // For compact filters the item layout needs to render both label and filter field.
          // hence use the original getContent of the FilterItemLayout
          if (oControl._fnGetContentCopy) {
            oControl.getContent = oControl._fnGetContentCopy;
          }
          oControl.removeEventDelegate(oFilterItemLayoutEventDelegate);
        }
      };
      oControl.addEventDelegate(oFilterItemLayoutEventDelegate);

      // In this layout there is no need to render visual filter
      // hence find the filter field from the layout and remove it's content aggregation
      oControl.getContent().forEach(oInnerControl => {
        const oContent = oInnerControl.getContent && oInnerControl.getContent();
        if (oInnerControl.isA("sap.ui.mdc.FilterField") && oContent && oContent.isA("sap.fe.core.controls.filterbar.VisualFilter")) {
          // store the visual filter for later use.
          const oVFId = oInnerControl.getId();
          this.aAllVisualFilters[oVFId] = oContent;
          // remove the content aggregation to render internal content of the field
          oInnerControl.setContent(null);
        }
      });

      // store filter fields to refer to when switching between layout
      this.aAllFilterFields.push(oControl);
      _MdcFilterContainer.prototype.insertFilterField.call(this, oControl, iIndex);
    };
    _proto.removeFilterField = function removeFilterField(oControl) {
      const oFilterFieldIndex = this.aAllFilterFields.findIndex(function (oFilterField) {
        return oFilterField.getId() === oControl.getId();
      });

      // Setting VF content for Fillterfield before removing
      oControl.getContent().forEach(oInnerControl => {
        if (oInnerControl.isA("sap.ui.mdc.FilterField") && !oInnerControl.getContent()) {
          const oVFId = oInnerControl.getId();
          if (this.aAllVisualFilters[oVFId]) {
            oInnerControl.setContent(this.aAllVisualFilters[oVFId]);
          }
        }
      });
      this.aAllFilterFields.splice(oFilterFieldIndex, 1);
      _MdcFilterContainer.prototype.removeFilterField.call(this, oControl);
    };
    _proto.removeAllFilterFields = function removeAllFilterFields() {
      this.aAllFilterFields = [];
      this.aAllVisualFilters = {};
      this.oLayout.removeAllContent();
    };
    _proto.getAllButtons = function getAllButtons() {
      return this.oLayout.getEndContent();
    };
    _proto.removeButton = function removeButton(oControl) {
      this.oLayout.removeEndContent(oControl);
    };
    _proto.getAllFilterFields = function getAllFilterFields() {
      return this.aAllFilterFields.slice();
    };
    _proto.getAllVisualFilterFields = function getAllVisualFilterFields() {
      return this.aAllVisualFilters;
    };
    _proto.setAllFilterFields = function setAllFilterFields(aFilterFields) {
      this.aAllFilterFields = aFilterFields;
    };
    return FilterContainer;
  }(MdcFilterContainer)) || _class);
  return FilterContainer;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/FilterContainer", ["sap/fe/core/helpers/ClassSupport","sap/ui/mdc/filterbar/aligned/FilterContainer"],function(t,e){"use strict";var i,l;var n=t.defineUI5Class;function r(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;o(t,e)}function o(t,e){o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,i){e.__proto__=i;return e};return o(t,e)}let s=(i=n("sap.fe.core.controls.filterbar.FilterContainer"),i(l=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.init=function e(){this.aAllFilterFields=[];this.aAllVisualFilters={};for(var i=arguments.length,l=new Array(i),n=0;n<i;n++){l[n]=arguments[n]}t.prototype.init.call(this,...l)};i.exit=function e(){for(var i=arguments.length,l=new Array(i),n=0;n<i;n++){l[n]=arguments[n]}t.prototype.exit.call(this,...l);this.aAllFilterFields.forEach(function(t){t.destroy()});Object.keys(this.aAllVisualFilters).forEach(t=>{this.aAllVisualFilters[t].destroy()})};i.insertFilterField=function e(i,l){const n={onBeforeRendering:function(){if(i._fnGetContentCopy){i.getContent=i._fnGetContentCopy}i.removeEventDelegate(n)}};i.addEventDelegate(n);i.getContent().forEach(t=>{const e=t.getContent&&t.getContent();if(t.isA("sap.ui.mdc.FilterField")&&e&&e.isA("sap.fe.core.controls.filterbar.VisualFilter")){const i=t.getId();this.aAllVisualFilters[i]=e;t.setContent(null)}});this.aAllFilterFields.push(i);t.prototype.insertFilterField.call(this,i,l)};i.removeFilterField=function e(i){const l=this.aAllFilterFields.findIndex(function(t){return t.getId()===i.getId()});i.getContent().forEach(t=>{if(t.isA("sap.ui.mdc.FilterField")&&!t.getContent()){const e=t.getId();if(this.aAllVisualFilters[e]){t.setContent(this.aAllVisualFilters[e])}}});this.aAllFilterFields.splice(l,1);t.prototype.removeFilterField.call(this,i)};i.removeAllFilterFields=function t(){this.aAllFilterFields=[];this.aAllVisualFilters={};this.oLayout.removeAllContent()};i.getAllButtons=function t(){return this.oLayout.getEndContent()};i.removeButton=function t(e){this.oLayout.removeEndContent(e)};i.getAllFilterFields=function t(){return this.aAllFilterFields.slice()};i.getAllVisualFilterFields=function t(){return this.aAllVisualFilters};i.setAllFilterFields=function t(e){this.aAllFilterFields=e};return e}(e))||l);return s},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/VisualFilter-dbg", ["sap/fe/core/CommonUtils", "sap/fe/core/controls/filterbar/utils/VisualFilterUtils", "sap/fe/core/helpers/ClassSupport", "sap/fe/macros/CommonHelper", "sap/fe/macros/filter/FilterUtils", "sap/m/VBox", "sap/ui/core/Core", "../../templating/FilterHelper"], function (CommonUtils, VisualFilterUtils, ClassSupport, CommonHelper, FilterUtils, VBox, Core, FilterHelper) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _dec5, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4;
  var getFiltersConditionsFromSelectionVariant = FilterHelper.getFiltersConditionsFromSelectionVariant;
  var property = ClassSupport.property;
  var implementInterface = ClassSupport.implementInterface;
  var event = ClassSupport.event;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  /**
   * Constructor for a new filterBar/aligned/FilterItemLayout.
   *
   * @param {string} [sId] ID for the new control, generated automatically if no ID is given
   * @param {object} [mSettings] Initial settings for the new control
   * @class Represents a filter item on the UI.
   * @extends sap.m.VBox
   * @implements {sap.ui.core.IFormContent}
   * @class
   * @private
   * @since 1.61.0
   * @alias control sap.fe.core.controls.filterbar.VisualFilter
   */
  let VisualFilter = (_dec = defineUI5Class("sap.fe.core.controls.filterbar.VisualFilter"), _dec2 = implementInterface("sap.ui.core.IFormContent"), _dec3 = property({
    type: "boolean"
  }), _dec4 = property({
    type: "string"
  }), _dec5 = event(), _dec(_class = (_class2 = /*#__PURE__*/function (_VBox) {
    _inheritsLoose(VisualFilter, _VBox);
    function VisualFilter() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _VBox.call(this, ...args) || this;
      _initializerDefineProperty(_this, "__implements__sap_ui_core_IFormContent", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "showValueHelp", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "valueHelpIconSrc", _descriptor3, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "valueHelpRequest", _descriptor4, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = VisualFilter.prototype;
    _proto.onAfterRendering = function onAfterRendering() {
      var _this$getParent;
      let sLabel;
      const oInteractiveChart = this.getItems()[1].getItems()[0];
      const sInternalContextPath = this.data("infoPath");
      const oInteractiveChartListBinding = oInteractiveChart.getBinding("segments") || oInteractiveChart.getBinding("bars") || oInteractiveChart.getBinding("points");
      const oInternalModelContext = oInteractiveChart.getBindingContext("internal");
      const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.macros");
      const bShowOverLayInitially = oInteractiveChart.data("showOverlayInitially");
      const oSelectionVariantAnnotation = oInteractiveChart.data("selectionVariantAnnotation") ? CommonHelper.parseCustomData(oInteractiveChart.data("selectionVariantAnnotation")) : {
        SelectOptions: []
      };
      const aRequiredProperties = oInteractiveChart.data("requiredProperties") ? CommonHelper.parseCustomData(oInteractiveChart.data("requiredProperties")) : [];
      const oMetaModel = oInteractiveChart.getModel().getMetaModel();
      const sEntitySetPath = oInteractiveChartListBinding ? oInteractiveChartListBinding.getPath() : "";
      let oFilterBar = (_this$getParent = this.getParent()) === null || _this$getParent === void 0 ? void 0 : _this$getParent.getParent();
      // TODO: Remove this part once 2170204347 is fixed
      if (oFilterBar.getMetadata().getElementName() === "sap.ui.mdc.filterbar.p13n.AdaptationFilterBar") {
        var _oFilterBar$getParent;
        oFilterBar = (_oFilterBar$getParent = oFilterBar.getParent()) === null || _oFilterBar$getParent === void 0 ? void 0 : _oFilterBar$getParent.getParent();
      }
      let oFilterBarConditions = {};
      let aPropertyInfoSet = [];
      let sFilterEntityName;
      if (oFilterBar.getMetadata().getElementName() === "sap.fe.core.controls.FilterBar") {
        oFilterBarConditions = oFilterBar.getConditions();
        aPropertyInfoSet = oFilterBar.getPropertyInfoSet();
        sFilterEntityName = oFilterBar.data("entityType").split("/")[1];
      }
      const aParameters = oInteractiveChart.data("parameters") ? oInteractiveChart.data("parameters").customData : [];
      const filterConditions = getFiltersConditionsFromSelectionVariant(sEntitySetPath, oMetaModel, oSelectionVariantAnnotation, VisualFilterUtils.getCustomConditions.bind(VisualFilterUtils));
      const oSelectionVariantConditions = VisualFilterUtils.convertFilterCondions(filterConditions);
      const mConditions = {};
      Object.keys(oFilterBarConditions).forEach(function (sKey) {
        if (oFilterBarConditions[sKey].length) {
          mConditions[sKey] = oFilterBarConditions[sKey];
        }
      });
      Object.keys(oSelectionVariantConditions).forEach(function (sKey) {
        if (!mConditions[sKey]) {
          mConditions[sKey] = oSelectionVariantConditions[sKey];
        }
      });
      if (bShowOverLayInitially === "true") {
        if (!Object.keys(oSelectionVariantAnnotation).length) {
          if (aRequiredProperties.length > 1) {
            oInternalModelContext.setProperty(sInternalContextPath, {
              showError: true,
              errorMessageTitle: oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),
              errorMessage: oResourceBundle.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_MULTIPLEVF")
            });
          } else {
            sLabel = oMetaModel.getObject(`${sEntitySetPath}/${aRequiredProperties[0]}@com.sap.vocabularies.Common.v1.Label`) || aRequiredProperties[0];
            oInternalModelContext.setProperty(sInternalContextPath, {
              showError: true,
              errorMessageTitle: oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),
              errorMessage: oResourceBundle.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_SINGLEVF", sLabel)
            });
          }
        } else {
          const aSelectOptions = [];
          const aNotMatchedConditions = [];
          if (oSelectionVariantAnnotation.SelectOptions) {
            oSelectionVariantAnnotation.SelectOptions.forEach(function (oSelectOption) {
              aSelectOptions.push(oSelectOption.PropertyName.$PropertyPath);
            });
          }
          if (oSelectionVariantAnnotation.Parameters) {
            oSelectionVariantAnnotation.Parameters.forEach(function (oParameter) {
              aSelectOptions.push(oParameter.PropertyName.$PropertyPath);
            });
          }
          aRequiredProperties.forEach(function (sPath) {
            if (aSelectOptions.indexOf(sPath) === -1) {
              aNotMatchedConditions.push(sPath);
            }
          });
          if (aNotMatchedConditions.length > 1) {
            oInternalModelContext.setProperty(sInternalContextPath, {
              showError: true,
              errorMessageTitle: oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),
              errorMessage: oResourceBundle.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_MULTIPLEVF")
            });
          } else {
            sLabel = oMetaModel.getObject(`${sEntitySetPath}/${aNotMatchedConditions[0]}@com.sap.vocabularies.Common.v1.Label`) || aNotMatchedConditions[0];
            oInternalModelContext.setProperty(sInternalContextPath, {
              showError: true,
              errorMessageTitle: oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),
              errorMessage: oResourceBundle.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_SINGLEVF", sLabel)
            });
          }
          if (aNotMatchedConditions.length > 1) {
            oInternalModelContext.setProperty(sInternalContextPath, {
              showError: true,
              errorMessageTitle: oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),
              errorMessage: oResourceBundle.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_MULTIPLEVF")
            });
          } else {
            oInternalModelContext.setProperty(sInternalContextPath, {
              showError: true,
              errorMessageTitle: oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),
              errorMessage: oResourceBundle.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_SINGLEVF", aNotMatchedConditions[0])
            });
          }
        }
      }
      if (!this._oChartBinding || this._oChartBinding !== oInteractiveChartListBinding) {
        if (this._oChartBinding) {
          this.detachDataReceivedHandler(this._oChartBinding);
        }
        this.attachDataRecivedHandler(oInteractiveChartListBinding);
        this._oChartBinding = oInteractiveChartListBinding;
      }
      const bShowOverlay = oInternalModelContext.getProperty(sInternalContextPath) && oInternalModelContext.getProperty(sInternalContextPath).showError;
      const sChartEntityName = sEntitySetPath !== "" ? sEntitySetPath.split("/")[1].split("(")[0] : "";
      if (aParameters && aParameters.length && sFilterEntityName === sChartEntityName) {
        const sBindingPath = FilterUtils.getBindingPathForParameters(oFilterBar, mConditions, aPropertyInfoSet, aParameters);
        if (sBindingPath) {
          oInteractiveChartListBinding.sPath = sBindingPath;
        }
      }
      // resume binding for only those visual filters that do not have a in parameter attached.
      // Bindings of visual filters with inParameters will be resumed later after considering in parameters.
      if (oInteractiveChartListBinding && oInteractiveChartListBinding.isSuspended() && !bShowOverlay) {
        oInteractiveChartListBinding.resume();
      }
    };
    _proto.attachDataRecivedHandler = function attachDataRecivedHandler(oInteractiveChartListBinding) {
      if (oInteractiveChartListBinding) {
        oInteractiveChartListBinding.attachEvent("dataReceived", this.onInternalDataReceived, this);
        this._oChartBinding = oInteractiveChartListBinding;
      }
    };
    _proto.detachDataReceivedHandler = function detachDataReceivedHandler(oInteractiveChartListBinding) {
      if (oInteractiveChartListBinding) {
        oInteractiveChartListBinding.detachEvent("dataReceived", this.onInternalDataReceived, this);
        this._oChartBinding = undefined;
      }
    };
    _proto.setShowValueHelp = function setShowValueHelp(bShowValueHelp) {
      if (this.getItems().length > 0) {
        const oVisualFilterControl = this.getItems()[0].getItems()[0];
        oVisualFilterControl.getContent().some(function (oInnerControl) {
          if (oInnerControl.isA("sap.m.Button")) {
            oInnerControl.setVisible(bShowValueHelp);
          }
        });
        this.setProperty("showValueHelp", bShowValueHelp);
      }
    };
    _proto.setValueHelpIconSrc = function setValueHelpIconSrc(sIconSrc) {
      if (this.getItems().length > 0) {
        const oVisualFilterControl = this.getItems()[0].getItems()[0];
        oVisualFilterControl.getContent().some(function (oInnerControl) {
          if (oInnerControl.isA("sap.m.Button")) {
            oInnerControl.setIcon(sIconSrc);
          }
        });
        this.setProperty("valueHelpIconSrc", sIconSrc);
      }
    };
    _proto.onInternalDataReceived = function onInternalDataReceived(oEvent) {
      const sId = this.getId();
      const oView = CommonUtils.getTargetView(this);
      const oInteractiveChart = this.getItems()[1].getItems()[0];
      const sInternalContextPath = this.data("infoPath");
      const oInternalModelContext = oInteractiveChart.getBindingContext("internal");
      const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.macros");
      const vUOM = oInteractiveChart.data("uom");
      VisualFilterUtils.updateChartScaleFactorTitle(oInteractiveChart, oView, sId, sInternalContextPath);
      if (oEvent.getParameter("error")) {
        const s18nMessageTitle = oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");
        const s18nMessage = oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_DATA_TEXT");
        VisualFilterUtils.applyErrorMessageAndTitle(s18nMessageTitle, s18nMessage, sInternalContextPath, oView);
      } else if (oEvent.getParameter("data")) {
        const oData = oEvent.getSource().getCurrentContexts();
        if (oData && oData.length === 0) {
          VisualFilterUtils.setNoDataMessage(sInternalContextPath, oResourceBundle, oView);
        } else {
          oInternalModelContext.setProperty(sInternalContextPath, {});
        }
        VisualFilterUtils.setMultiUOMMessage(oData, oInteractiveChart, sInternalContextPath, oResourceBundle, oView);
      }
      if (vUOM && (vUOM["ISOCurrency"] && vUOM["ISOCurrency"].$Path || vUOM["Unit"] && vUOM["Unit"].$Path)) {
        const oContexts = oEvent.getSource().getContexts();
        const oContextData = oContexts && oContexts[0].getObject();
        VisualFilterUtils.applyUOMToTitle(oInteractiveChart, oContextData, oView, sInternalContextPath);
      }
    };
    return VisualFilter;
  }(VBox), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "__implements__sap_ui_core_IFormContent", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return true;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "showValueHelp", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "valueHelpIconSrc", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "valueHelpRequest", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return VisualFilter;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/VisualFilter", ["sap/fe/core/CommonUtils","sap/fe/core/controls/filterbar/utils/VisualFilterUtils","sap/fe/core/helpers/ClassSupport","sap/fe/macros/CommonHelper","sap/fe/macros/filter/FilterUtils","sap/m/VBox","sap/ui/core/Core","../../templating/FilterHelper"],function(e,t,r,i,n,a,o,s){"use strict";var l,c,u,g,p,f,_,d,h,E,I;var m=s.getFiltersConditionsFromSelectionVariant;var T=r.property;var R=r.implementInterface;var S=r.event;var L=r.defineUI5Class;function b(e,t,r,i){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function P(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function v(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;y(e,t)}function y(e,t){y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return y(e,t)}function M(e,t,r,i,n){var a={};Object.keys(i).forEach(function(e){a[e]=i[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,i){return i(e,t,r)||r},a);if(n&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(n):void 0;a.initializer=undefined}if(a.initializer===void 0){Object.defineProperty(e,t,a);a=null}return a}function V(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let F=(l=L("sap.fe.core.controls.filterbar.VisualFilter"),c=R("sap.ui.core.IFormContent"),u=T({type:"boolean"}),g=T({type:"string"}),p=S(),l(f=(_=function(r){v(a,r);function a(){var e;for(var t=arguments.length,i=new Array(t),n=0;n<t;n++){i[n]=arguments[n]}e=r.call(this,...i)||this;b(e,"__implements__sap_ui_core_IFormContent",d,P(e));b(e,"showValueHelp",h,P(e));b(e,"valueHelpIconSrc",E,P(e));b(e,"valueHelpRequest",I,P(e));return e}var s=a.prototype;s.onAfterRendering=function e(){var r;let a;const s=this.getItems()[1].getItems()[0];const l=this.data("infoPath");const c=s.getBinding("segments")||s.getBinding("bars")||s.getBinding("points");const u=s.getBindingContext("internal");const g=o.getLibraryResourceBundle("sap.fe.macros");const p=s.data("showOverlayInitially");const f=s.data("selectionVariantAnnotation")?i.parseCustomData(s.data("selectionVariantAnnotation")):{SelectOptions:[]};const _=s.data("requiredProperties")?i.parseCustomData(s.data("requiredProperties")):[];const d=s.getModel().getMetaModel();const h=c?c.getPath():"";let E=(r=this.getParent())===null||r===void 0?void 0:r.getParent();if(E.getMetadata().getElementName()==="sap.ui.mdc.filterbar.p13n.AdaptationFilterBar"){var I;E=(I=E.getParent())===null||I===void 0?void 0:I.getParent()}let T={};let R=[];let S;if(E.getMetadata().getElementName()==="sap.fe.core.controls.FilterBar"){T=E.getConditions();R=E.getPropertyInfoSet();S=E.data("entityType").split("/")[1]}const L=s.data("parameters")?s.data("parameters").customData:[];const b=m(h,d,f,t.getCustomConditions.bind(t));const P=t.convertFilterCondions(b);const v={};Object.keys(T).forEach(function(e){if(T[e].length){v[e]=T[e]}});Object.keys(P).forEach(function(e){if(!v[e]){v[e]=P[e]}});if(p==="true"){if(!Object.keys(f).length){if(_.length>1){u.setProperty(l,{showError:true,errorMessageTitle:g.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),errorMessage:g.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_MULTIPLEVF")})}else{a=d.getObject(`${h}/${_[0]}@com.sap.vocabularies.Common.v1.Label`)||_[0];u.setProperty(l,{showError:true,errorMessageTitle:g.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),errorMessage:g.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_SINGLEVF",a)})}}else{const e=[];const t=[];if(f.SelectOptions){f.SelectOptions.forEach(function(t){e.push(t.PropertyName.$PropertyPath)})}if(f.Parameters){f.Parameters.forEach(function(t){e.push(t.PropertyName.$PropertyPath)})}_.forEach(function(r){if(e.indexOf(r)===-1){t.push(r)}});if(t.length>1){u.setProperty(l,{showError:true,errorMessageTitle:g.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),errorMessage:g.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_MULTIPLEVF")})}else{a=d.getObject(`${h}/${t[0]}@com.sap.vocabularies.Common.v1.Label`)||t[0];u.setProperty(l,{showError:true,errorMessageTitle:g.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),errorMessage:g.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_SINGLEVF",a)})}if(t.length>1){u.setProperty(l,{showError:true,errorMessageTitle:g.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),errorMessage:g.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_MULTIPLEVF")})}else{u.setProperty(l,{showError:true,errorMessageTitle:g.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE"),errorMessage:g.getText("M_VISUAL_FILTERS_PROVIDE_FILTER_VAL_SINGLEVF",t[0])})}}}if(!this._oChartBinding||this._oChartBinding!==c){if(this._oChartBinding){this.detachDataReceivedHandler(this._oChartBinding)}this.attachDataRecivedHandler(c);this._oChartBinding=c}const y=u.getProperty(l)&&u.getProperty(l).showError;const M=h!==""?h.split("/")[1].split("(")[0]:"";if(L&&L.length&&S===M){const e=n.getBindingPathForParameters(E,v,R,L);if(e){c.sPath=e}}if(c&&c.isSuspended()&&!y){c.resume()}};s.attachDataRecivedHandler=function e(t){if(t){t.attachEvent("dataReceived",this.onInternalDataReceived,this);this._oChartBinding=t}};s.detachDataReceivedHandler=function e(t){if(t){t.detachEvent("dataReceived",this.onInternalDataReceived,this);this._oChartBinding=undefined}};s.setShowValueHelp=function e(t){if(this.getItems().length>0){const e=this.getItems()[0].getItems()[0];e.getContent().some(function(e){if(e.isA("sap.m.Button")){e.setVisible(t)}});this.setProperty("showValueHelp",t)}};s.setValueHelpIconSrc=function e(t){if(this.getItems().length>0){const e=this.getItems()[0].getItems()[0];e.getContent().some(function(e){if(e.isA("sap.m.Button")){e.setIcon(t)}});this.setProperty("valueHelpIconSrc",t)}};s.onInternalDataReceived=function r(i){const n=this.getId();const a=e.getTargetView(this);const s=this.getItems()[1].getItems()[0];const l=this.data("infoPath");const c=s.getBindingContext("internal");const u=o.getLibraryResourceBundle("sap.fe.macros");const g=s.data("uom");t.updateChartScaleFactorTitle(s,a,n,l);if(i.getParameter("error")){const e=u.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");const r=u.getText("M_VISUAL_FILTERS_ERROR_DATA_TEXT");t.applyErrorMessageAndTitle(e,r,l,a)}else if(i.getParameter("data")){const e=i.getSource().getCurrentContexts();if(e&&e.length===0){t.setNoDataMessage(l,u,a)}else{c.setProperty(l,{})}t.setMultiUOMMessage(e,s,l,u,a)}if(g&&(g["ISOCurrency"]&&g["ISOCurrency"].$Path||g["Unit"]&&g["Unit"].$Path)){const e=i.getSource().getContexts();const r=e&&e[0].getObject();t.applyUOMToTitle(s,r,a,l)}};return a}(a),d=M(_.prototype,"__implements__sap_ui_core_IFormContent",[c],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),h=M(_.prototype,"showValueHelp",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),E=M(_.prototype,"valueHelpIconSrc",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),I=M(_.prototype,"valueHelpRequest",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),_))||f);return F},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/VisualFilterContainer-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/m/FlexBox", "sap/m/HeaderContainer", "sap/ui/core/library", "sap/ui/Device", "sap/ui/mdc/filterbar/IFilterContainer"], function (ClassSupport, FlexBox, HeaderContainer, coreLibrabry, Device, IFilterContainer) {
  "use strict";

  var _dec, _dec2, _class, _class2, _descriptor;
  var system = Device.system;
  var defineUI5Class = ClassSupport.defineUI5Class;
  var aggregation = ClassSupport.aggregation;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  /**
   * Constructor for a new Visual Filter Container.
   * Used for visual filters.
   *
   * @extends sap.ui.mdc.filterbar.IFilterContainer
   * @class
   * @private
   * @alias sap.fe.core.controls.filterbar.VisualFilterContainer
   */
  let VisualFilterContainer = (_dec = defineUI5Class("sap.fe.core.controls.filterbar.VisualFilterContainer"), _dec2 = aggregation({
    type: "sap.ui.core.Control",
    multiple: false,
    visibility: "hidden"
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_IFilterContainer) {
    _inheritsLoose(VisualFilterContainer, _IFilterContainer);
    function VisualFilterContainer() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _IFilterContainer.call(this, ...args) || this;
      _initializerDefineProperty(_this, "_layout", _descriptor, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = VisualFilterContainer.prototype;
    _proto.init = function init() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      _IFilterContainer.prototype.init.call(this, ...args);
      //var oRB = sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");
      const sDeviceSystem = system,
        Orientation = coreLibrabry.Orientation,
        sOrientation = sDeviceSystem.phone ? Orientation.Vertical : undefined,
        sDirection = sDeviceSystem.phone ? "ColumnReverse" : "Column";
      this.oHeaderContainer = new HeaderContainer({
        orientation: sOrientation
      });
      this.oButtonFlexBox = new FlexBox({
        alignItems: "End",
        justifyContent: "End"
      });
      this.oLayout = new FlexBox({
        direction: sDirection,
        // Direction is Column Reverse for Phone
        items: [this.oHeaderContainer, this.oButtonFlexBox]
      });
      this.aAllFilterFields = [];
      this.aVisualFilterFields = {};
    };
    _proto.exit = function exit() {
      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }
      // destroy layout
      _IFilterContainer.prototype.exit.call(this, ...args);
      // destroy all filter fields which are not in the layout
      const aAllFilterFields = this.getAllFilterFields();
      aAllFilterFields.forEach(function (oFilterField) {
        oFilterField.destroy();
      });
      this.oHeaderContainer = null;
      this.oButtonFlexBox = null;
      this.aAllFilterFields = [];
    };
    _proto.insertFilterField = function insertFilterField(oControl, iIndex) {
      const oFilterItemLayoutEventDelegate = {
        onBeforeRendering: function () {
          // visual filter does not need to render a label
          // hence override the getContent of the FilterItemLayout
          // and store the original getContent for later usage in the compact filters
          if (!oControl._fnGetContentCopy) {
            oControl._fnGetContentCopy = oControl.getContent;
          }
          // override getContent of FilterItemLayout
          // to add only filterField and not label
          oControl.getContent = function () {
            const aContent = [];
            aContent.push(oControl._oFilterField);
            return aContent;
          };
          oControl.removeEventDelegate(oFilterItemLayoutEventDelegate);
        }
      };
      oControl.addEventDelegate(oFilterItemLayoutEventDelegate);

      // Setting VF control for the Filterfield.
      const oVisualFilters = this.aVisualFilterFields;
      oControl.getContent().some(oInnerControl => {
        const sFFId = oInnerControl.getId();
        if (oVisualFilters[sFFId] && oInnerControl.isA("sap.ui.mdc.FilterField")) {
          oInnerControl.setContent(oVisualFilters[sFFId]);
          this.oHeaderContainer.insertContent(oControl, iIndex);
        }
      });
    };
    _proto.removeFilterField = function removeFilterField(oControl) {
      this.oHeaderContainer.removeContent(oControl);
    };
    _proto.removeAllFilterFields = function removeAllFilterFields() {
      this.aAllFilterFields = [];
      this.aVisualFilterFields = {};
      this.oHeaderContainer.removeAllContent();
    };
    _proto.getFilterFields = function getFilterFields() {
      return this.oHeaderContainer.getContent();
    };
    _proto.addButton = function addButton(oControl) {
      this.oButtonFlexBox.insertItem(oControl);
    };
    _proto.getAllButtons = function getAllButtons() {
      return this.oButtonFlexBox.getItems().reverse();
    };
    _proto.removeButton = function removeButton(oControl) {
      this.oButtonFlexBox.removeItem(oControl);
    };
    _proto.getAllFilterFields = function getAllFilterFields() {
      return this.aAllFilterFields.slice();
    };
    _proto.setAllFilterFields = function setAllFilterFields(aFilterFields, aVisualFilterFields) {
      this.aAllFilterFields = aFilterFields;
      this.aVisualFilterFields = aVisualFilterFields;
    };
    return VisualFilterContainer;
  }(IFilterContainer), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "_layout", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return VisualFilterContainer;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/VisualFilterContainer", ["sap/fe/core/helpers/ClassSupport","sap/m/FlexBox","sap/m/HeaderContainer","sap/ui/core/library","sap/ui/Device","sap/ui/mdc/filterbar/IFilterContainer"],function(e,t,i,n,r,o){"use strict";var l,a,s,u,c;var f=r.system;var d=e.defineUI5Class;var p=e.aggregation;function h(e,t,i,n){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function F(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function v(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;b(e,t)}function b(e,t){b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return b(e,t)}function C(e,t,i,n,r){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=i.slice().reverse().reduce(function(i,n){return n(e,t,i)||i},o);if(r&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(r):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function m(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let y=(l=d("sap.fe.core.controls.filterbar.VisualFilterContainer"),a=p({type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}),l(s=(u=function(e){v(r,e);function r(){var t;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++){n[r]=arguments[r]}t=e.call(this,...n)||this;h(t,"_layout",c,F(t));return t}var o=r.prototype;o.init=function r(){for(var o=arguments.length,l=new Array(o),a=0;a<o;a++){l[a]=arguments[a]}e.prototype.init.call(this,...l);const s=f,u=n.Orientation,c=s.phone?u.Vertical:undefined,d=s.phone?"ColumnReverse":"Column";this.oHeaderContainer=new i({orientation:c});this.oButtonFlexBox=new t({alignItems:"End",justifyContent:"End"});this.oLayout=new t({direction:d,items:[this.oHeaderContainer,this.oButtonFlexBox]});this.aAllFilterFields=[];this.aVisualFilterFields={}};o.exit=function t(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++){n[r]=arguments[r]}e.prototype.exit.call(this,...n);const o=this.getAllFilterFields();o.forEach(function(e){e.destroy()});this.oHeaderContainer=null;this.oButtonFlexBox=null;this.aAllFilterFields=[]};o.insertFilterField=function e(t,i){const n={onBeforeRendering:function(){if(!t._fnGetContentCopy){t._fnGetContentCopy=t.getContent}t.getContent=function(){const e=[];e.push(t._oFilterField);return e};t.removeEventDelegate(n)}};t.addEventDelegate(n);const r=this.aVisualFilterFields;t.getContent().some(e=>{const n=e.getId();if(r[n]&&e.isA("sap.ui.mdc.FilterField")){e.setContent(r[n]);this.oHeaderContainer.insertContent(t,i)}})};o.removeFilterField=function e(t){this.oHeaderContainer.removeContent(t)};o.removeAllFilterFields=function e(){this.aAllFilterFields=[];this.aVisualFilterFields={};this.oHeaderContainer.removeAllContent()};o.getFilterFields=function e(){return this.oHeaderContainer.getContent()};o.addButton=function e(t){this.oButtonFlexBox.insertItem(t)};o.getAllButtons=function e(){return this.oButtonFlexBox.getItems().reverse()};o.removeButton=function e(t){this.oButtonFlexBox.removeItem(t)};o.getAllFilterFields=function e(){return this.aAllFilterFields.slice()};o.setAllFilterFields=function e(t,i){this.aAllFilterFields=t;this.aVisualFilterFields=i};return r}(o),c=C(u.prototype,"_layout",[a],{configurable:true,enumerable:true,writable:true,initializer:null}),u))||s);return y},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/utils/VisualFilterUtils-dbg", ["sap/base/Log", "sap/fe/core/templating/FilterHelper", "sap/ui/core/format/NumberFormat", "sap/ui/mdc/condition/Condition", "sap/ui/model/odata/type/DateTimeOffset"], function (Log, FilterHelper, NumberFormat, Condition, DateTimeOffset) {
  "use strict";

  var getTypeCompliantValue = FilterHelper.getTypeCompliantValue;
  var getRangeProperty = FilterHelper.getRangeProperty;
  const VisualFilterUtils = {
    /**
     * Applies the median scale to the chart data.
     *
     * @param oInteractiveChart InteractiveChart in the VisualFilter control
     * @param oView Instance of the view
     * @param sVFId VisualFilter control ID
     * @param sInfoPath Internal model context path to store info.
     */
    applyMedianScaleToChartData: function (oInteractiveChart, oView, sVFId, sInfoPath) {
      const oData = [];
      const sMeasure = oInteractiveChart.data("measure");
      const oInternalModelContext = oView.getBindingContext("internal");
      const aAggregation = oInteractiveChart.getPoints && oInteractiveChart.getPoints() || oInteractiveChart.getBars && oInteractiveChart.getBars() || oInteractiveChart.getSegments && oInteractiveChart.getSegments();
      for (let i = 0; i < aAggregation.length; i++) {
        oData.push(aAggregation[i].getBindingContext().getObject());
      }
      const scaleFactor = this._getMedianScaleFactor(oData, sMeasure);
      if (scaleFactor && scaleFactor.iShortRefNumber && scaleFactor.scale) {
        oInternalModelContext.setProperty(`scalefactor/${sInfoPath}`, scaleFactor.scale);
        oInternalModelContext.setProperty(`scalefactorNumber/${sInfoPath}`, scaleFactor.iShortRefNumber);
      } else {
        oInternalModelContext.setProperty(`scalefactor/${sInfoPath}`, "");
        oInternalModelContext.setProperty(`scalefactorNumber/${sInfoPath}`, "");
        const oScaleTitle = oView.byId(`${sVFId}::ScaleUoMTitle`);
        const oMeasureDimensionTitle = oView.byId(`${sVFId}::MeasureDimensionTitle`);
        const sText = oScaleTitle.getText();
        if (sText === " | ") {
          oScaleTitle.setVisible(false);
          oMeasureDimensionTitle.setTooltip(oMeasureDimensionTitle.getText());
        }
      }
    },
    /**
     * Returns the median scale factor.
     *
     * @param oData VisualFilter data
     * @param sMeasureField Path of the measure
     * @returns Object containing scale and iShortRefNumber
     */
    _getMedianScaleFactor: function (oData, sMeasureField) {
      let i;
      let scaleFactor;
      oData.sort(function (a, b) {
        if (Number(a[sMeasureField]) < Number(b[sMeasureField])) {
          return -1;
        }
        if (Number(a[sMeasureField]) > Number(b[sMeasureField])) {
          return 1;
        }
        return 0;
      });
      if (oData.length > 0) {
        // get median index
        const iMid = oData.length / 2,
          // get mid of array
          // if iMid is whole number, array length is even, calculate median
          // if iMid is not whole number, array length is odd, take median as iMid - 1
          iMedian = iMid % 1 === 0 ? (parseFloat(oData[iMid - 1][sMeasureField]) + parseFloat(oData[iMid][sMeasureField])) / 2 : parseFloat(oData[Math.floor(iMid)][sMeasureField]),
          // get scale factor on median
          val = iMedian;
        for (i = 0; i < 14; i++) {
          scaleFactor = Math.pow(10, i);
          if (Math.round(Math.abs(val) / scaleFactor) < 10) {
            break;
          }
        }
      }
      const fixedInteger = NumberFormat.getIntegerInstance({
        style: "short",
        showScale: false,
        shortRefNumber: scaleFactor
      });

      // apply scale factor to other values and check
      for (i = 0; i < oData.length; i++) {
        const aData = oData[i],
          sScaledValue = fixedInteger.format(aData[sMeasureField]),
          aScaledValueParts = sScaledValue.split(".");
        // if scaled value has only 0 before decimal or 0 after decimal (example: 0.02)
        // then ignore this scale factor else proceed with this scale factor
        // if scaled value divided by 1000 is >= 1000 then also ignore scale factor
        if (!aScaledValueParts[1] && parseInt(aScaledValueParts[0], 10) === 0 || aScaledValueParts[1] && parseInt(aScaledValueParts[0], 10) === 0 && aScaledValueParts[1].indexOf("0") === 0 || sScaledValue / 1000 >= 1000) {
          scaleFactor = undefined;
          break;
        }
      }
      return {
        iShortRefNumber: scaleFactor,
        scale: scaleFactor ? fixedInteger.getScale() : ""
      };
    },
    /**
     * Returns the formatted number according to the rules of VisualChartFilters.
     *
     * @param value Value which needs to be formatted
     * @param scaleFactor ScaleFactor to which the value needs to be scaled
     * @param numberOfFractionalDigits NumberOfFractionalDigits digits in the decimals according to scale
     * @param currency Currency code
     * @returns The formatted number
     */
    getFormattedNumber: function (value, scaleFactor, numberOfFractionalDigits, currency) {
      let fixedInteger;
      value = typeof value === "string" ? Number(value.replace(/,/g, "")) : value;
      if (currency) {
        const currencyFormat = NumberFormat.getCurrencyInstance({
          showMeasure: false
        });
        return currencyFormat.format(parseFloat(value), currency);
        // parseFloat(value) is required otherwise -ve value are wrongly rounded off
        // Example: "-1.9" rounds off to -1 instead of -2. however -1.9 rounds off to -2
      } else if (scaleFactor) {
        fixedInteger = NumberFormat.getFloatInstance({
          style: "short",
          showScale: false,
          shortRefNumber: scaleFactor,
          shortDecimals: numberOfFractionalDigits
        });
        return fixedInteger.format(parseFloat(value));
      } else {
        fixedInteger = NumberFormat.getFloatInstance({
          decimals: numberOfFractionalDigits
        });
        return fixedInteger.format(parseFloat(value));
      }
    },
    /**
     * Applies the UOM to the title of the visual filter control.
     *
     * @param oInteractiveChart InteractiveChart in the VisualFilter control
     * @param oContextData Data of the VisualFilter
     * @param oView Instance of the view
     * @param sInfoPath Internal model context path to store info.
     */
    applyUOMToTitle: function (oInteractiveChart, oContextData, oView, sInfoPath) {
      const vUOM = oInteractiveChart.data("uom");
      let sUOM;
      let sCurrency;
      if (vUOM && vUOM["ISOCurrency"]) {
        sUOM = vUOM["ISOCurrency"];
        sCurrency = sUOM.$Path ? oContextData[sUOM.$Path] : sUOM;
      } else if (vUOM && vUOM["Unit"]) {
        sUOM = vUOM["Unit"];
      }
      if (sUOM) {
        const sUOMValue = sUOM.$Path ? oContextData[sUOM.$Path] : sUOM;
        const oInternalModelContext = oView.getBindingContext("internal");
        oInternalModelContext.setProperty(`uom/${sInfoPath}`, sUOMValue);
        if (sCurrency) {
          oInternalModelContext.setProperty(`currency/${sInfoPath}`, sUOMValue);
        }
      }
    },
    /**
     * Updates the scale factor in the title of the visual filter.
     *
     * @param oInteractiveChart InteractiveChart in the VisualFilter control
     * @param oView Instance of the view
     * @param sVFId VisualFilter control ID
     * @param sInfoPath Internal model context path to store info.
     */
    updateChartScaleFactorTitle: function (oInteractiveChart, oView, sVFId, sInfoPath) {
      if (!oInteractiveChart.data("scalefactor")) {
        this.applyMedianScaleToChartData(oInteractiveChart, oView, sVFId, sInfoPath);
      } else {
        const fixedInteger = NumberFormat.getIntegerInstance({
          style: "short",
          showScale: false,
          shortRefNumber: oInteractiveChart.data("scalefactor")
        });
        const oInternalModelContext = oView.getBindingContext("internal");
        oInternalModelContext.setProperty(`scalefactor/${sInfoPath}`, fixedInteger.getScale());
      }
    },
    /**
     *
     * @param s18nMessageTitle Text of the error message title.
     * @param s18nMessage Text of the error message description.
     * @param sInfoPath Internal model context path to store info.
     * @param oView Instance of the view.
     */
    applyErrorMessageAndTitle: function (s18nMessageTitle, s18nMessage, sInfoPath, oView) {
      const oInternalModelContext = oView.getBindingContext("internal");
      oInternalModelContext.setProperty(sInfoPath, {});
      oInternalModelContext.setProperty(sInfoPath, {
        errorMessageTitle: s18nMessageTitle,
        errorMessage: s18nMessage,
        showError: true
      });
    },
    /**
     * Checks if multiple units are present.
     *
     * @param oContexts Contexts of the VisualFilter
     * @param sUnitfield The path of the unit field
     * @returns Returns if multiple units are configured or not
     */
    checkMulitUnit: function (oContexts, sUnitfield) {
      const aData = [];
      if (oContexts && sUnitfield) {
        for (let i = 0; i < oContexts.length; i++) {
          const aContextData = oContexts[i] && oContexts[i].getObject();
          aData.push(aContextData[sUnitfield]);
        }
      }
      return !!aData.reduce(function (data, key) {
        return data === key ? data : NaN;
      });
    },
    /**
     * Sets an error message if multiple UOM are present.
     *
     * @param oData Data of the VisualFilter control
     * @param oInteractiveChart InteractiveChart in the VisualFilter control
     * @param sInfoPath Internal model context path to store info.
     * @param oResourceBundle The resource bundle
     * @param oView Instance of the view
     */
    setMultiUOMMessage: function (oData, oInteractiveChart, sInfoPath, oResourceBundle, oView) {
      const vUOM = oInteractiveChart.data("uom");
      const sIsCurrency = vUOM && vUOM["ISOCurrency"] && vUOM["ISOCurrency"].$Path;
      const sIsUnit = vUOM && vUOM["Unit"] && vUOM["Unit"].$Path;
      const sUnitfield = sIsCurrency || sIsUnit;
      let s18nMessageTitle, s18nMessage;
      if (sUnitfield) {
        if (!this.checkMulitUnit(oData, sUnitfield)) {
          if (sIsCurrency) {
            s18nMessageTitle = oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");
            s18nMessage = oResourceBundle.getText("M_VISUAL_FILTERS_MULTIPLE_CURRENCY", sUnitfield);
            this.applyErrorMessageAndTitle(s18nMessageTitle, s18nMessage, sInfoPath, oView);
            Log.warning(`Filter is set for multiple Currency for${sUnitfield}`);
          } else if (sIsUnit) {
            s18nMessageTitle = oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");
            s18nMessage = oResourceBundle.getText("M_VISUAL_FILTERS_MULTIPLE_UNIT", sUnitfield);
            this.applyErrorMessageAndTitle(s18nMessageTitle, s18nMessage, sInfoPath, oView);
            Log.warning(`Filter is set for multiple UOMs for${sUnitfield}`);
          }
        }
      }
    },
    /**
     * Sets an error message if response data is empty.
     *
     * @param sInfoPath Internal model context path to store info.
     * @param oResourceBundle The resource bundle
     * @param oView Instance of the view
     */
    setNoDataMessage: function (sInfoPath, oResourceBundle, oView) {
      const s18nMessageTitle = oResourceBundle.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");
      const s18nMessage = oResourceBundle.getText("M_VISUAL_FILTER_NO_DATA_TEXT");
      this.applyErrorMessageAndTitle(s18nMessageTitle, s18nMessage, sInfoPath, oView);
    },
    convertFilterCondions: function (oFilterConditions) {
      const oConvertedConditions = {};
      Object.keys(oFilterConditions).forEach(function (sKey) {
        const aConvertedConditions = [];
        const aConditions = oFilterConditions[sKey];
        for (let i = 0; i < aConditions.length; i++) {
          const values = aConditions[i].value2 ? [aConditions[i].value1, aConditions[i].value2] : [aConditions[i].value1];
          aConvertedConditions.push(Condition.createCondition(aConditions[i].operator, values, null, null, "Validated"));
        }
        if (aConvertedConditions.length) {
          oConvertedConditions[sKey] = aConvertedConditions;
        }
      });
      return oConvertedConditions;
    },
    getCustomConditions: function (Range, oValidProperty, sPropertyName) {
      let value1, value2;
      if (oValidProperty.$Type === "Edm.DateTimeOffset") {
        value1 = this._parseDateTime(getTypeCompliantValue(this._formatDateTime(Range.Low), oValidProperty.$Type));
        value2 = Range.High ? this._parseDateTime(getTypeCompliantValue(this._formatDateTime(Range.High), oValidProperty.$Type)) : null;
      } else {
        value1 = Range.Low;
        value2 = Range.High ? Range.High : null;
      }
      return {
        operator: Range.Option ? getRangeProperty(Range.Option.$EnumMember || Range.Option) : null,
        value1: value1,
        value2: value2,
        path: sPropertyName
      };
    },
    _parseDateTime: function (sValue) {
      return this._getDateTimeTypeInstance().parseValue(sValue, "string");
    },
    _formatDateTime: function (sValue) {
      return this._getDateTimeTypeInstance().formatValue(sValue, "string");
    },
    _getDateTimeTypeInstance: function () {
      return new DateTimeOffset({
        pattern: "yyyy-MM-ddTHH:mm:ssZ",
        calendarType: "Gregorian"
      }, {
        V4: true
      });
    }
  };
  return VisualFilterUtils;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/filterbar/utils/VisualFilterUtils", ["sap/base/Log","sap/fe/core/templating/FilterHelper","sap/ui/core/format/NumberFormat","sap/ui/mdc/condition/Condition","sap/ui/model/odata/type/DateTimeOffset"],function(e,t,r,n,a){"use strict";var s=t.getTypeCompliantValue;var o=t.getRangeProperty;const i={applyMedianScaleToChartData:function(e,t,r,n){const a=[];const s=e.data("measure");const o=t.getBindingContext("internal");const i=e.getPoints&&e.getPoints()||e.getBars&&e.getBars()||e.getSegments&&e.getSegments();for(let e=0;e<i.length;e++){a.push(i[e].getBindingContext().getObject())}const l=this._getMedianScaleFactor(a,s);if(l&&l.iShortRefNumber&&l.scale){o.setProperty(`scalefactor/${n}`,l.scale);o.setProperty(`scalefactorNumber/${n}`,l.iShortRefNumber)}else{o.setProperty(`scalefactor/${n}`,"");o.setProperty(`scalefactorNumber/${n}`,"");const e=t.byId(`${r}::ScaleUoMTitle`);const a=t.byId(`${r}::MeasureDimensionTitle`);const s=e.getText();if(s===" | "){e.setVisible(false);a.setTooltip(a.getText())}}},_getMedianScaleFactor:function(e,t){let n;let a;e.sort(function(e,r){if(Number(e[t])<Number(r[t])){return-1}if(Number(e[t])>Number(r[t])){return 1}return 0});if(e.length>0){const r=e.length/2,s=r%1===0?(parseFloat(e[r-1][t])+parseFloat(e[r][t]))/2:parseFloat(e[Math.floor(r)][t]),o=s;for(n=0;n<14;n++){a=Math.pow(10,n);if(Math.round(Math.abs(o)/a)<10){break}}}const s=r.getIntegerInstance({style:"short",showScale:false,shortRefNumber:a});for(n=0;n<e.length;n++){const r=e[n],o=s.format(r[t]),i=o.split(".");if(!i[1]&&parseInt(i[0],10)===0||i[1]&&parseInt(i[0],10)===0&&i[1].indexOf("0")===0||o/1e3>=1e3){a=undefined;break}}return{iShortRefNumber:a,scale:a?s.getScale():""}},getFormattedNumber:function(e,t,n,a){let s;e=typeof e==="string"?Number(e.replace(/,/g,"")):e;if(a){const t=r.getCurrencyInstance({showMeasure:false});return t.format(parseFloat(e),a)}else if(t){s=r.getFloatInstance({style:"short",showScale:false,shortRefNumber:t,shortDecimals:n});return s.format(parseFloat(e))}else{s=r.getFloatInstance({decimals:n});return s.format(parseFloat(e))}},applyUOMToTitle:function(e,t,r,n){const a=e.data("uom");let s;let o;if(a&&a["ISOCurrency"]){s=a["ISOCurrency"];o=s.$Path?t[s.$Path]:s}else if(a&&a["Unit"]){s=a["Unit"]}if(s){const e=s.$Path?t[s.$Path]:s;const a=r.getBindingContext("internal");a.setProperty(`uom/${n}`,e);if(o){a.setProperty(`currency/${n}`,e)}}},updateChartScaleFactorTitle:function(e,t,n,a){if(!e.data("scalefactor")){this.applyMedianScaleToChartData(e,t,n,a)}else{const n=r.getIntegerInstance({style:"short",showScale:false,shortRefNumber:e.data("scalefactor")});const s=t.getBindingContext("internal");s.setProperty(`scalefactor/${a}`,n.getScale())}},applyErrorMessageAndTitle:function(e,t,r,n){const a=n.getBindingContext("internal");a.setProperty(r,{});a.setProperty(r,{errorMessageTitle:e,errorMessage:t,showError:true})},checkMulitUnit:function(e,t){const r=[];if(e&&t){for(let n=0;n<e.length;n++){const a=e[n]&&e[n].getObject();r.push(a[t])}}return!!r.reduce(function(e,t){return e===t?e:NaN})},setMultiUOMMessage:function(t,r,n,a,s){const o=r.data("uom");const i=o&&o["ISOCurrency"]&&o["ISOCurrency"].$Path;const l=o&&o["Unit"]&&o["Unit"].$Path;const c=i||l;let u,f;if(c){if(!this.checkMulitUnit(t,c)){if(i){u=a.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");f=a.getText("M_VISUAL_FILTERS_MULTIPLE_CURRENCY",c);this.applyErrorMessageAndTitle(u,f,n,s);e.warning(`Filter is set for multiple Currency for${c}`)}else if(l){u=a.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");f=a.getText("M_VISUAL_FILTERS_MULTIPLE_UNIT",c);this.applyErrorMessageAndTitle(u,f,n,s);e.warning(`Filter is set for multiple UOMs for${c}`)}}}},setNoDataMessage:function(e,t,r){const n=t.getText("M_VISUAL_FILTERS_ERROR_MESSAGE_TITLE");const a=t.getText("M_VISUAL_FILTER_NO_DATA_TEXT");this.applyErrorMessageAndTitle(n,a,e,r)},convertFilterCondions:function(e){const t={};Object.keys(e).forEach(function(r){const a=[];const s=e[r];for(let e=0;e<s.length;e++){const t=s[e].value2?[s[e].value1,s[e].value2]:[s[e].value1];a.push(n.createCondition(s[e].operator,t,null,null,"Validated"))}if(a.length){t[r]=a}});return t},getCustomConditions:function(e,t,r){let n,a;if(t.$Type==="Edm.DateTimeOffset"){n=this._parseDateTime(s(this._formatDateTime(e.Low),t.$Type));a=e.High?this._parseDateTime(s(this._formatDateTime(e.High),t.$Type)):null}else{n=e.Low;a=e.High?e.High:null}return{operator:e.Option?o(e.Option.$EnumMember||e.Option):null,value1:n,value2:a,path:r}},_parseDateTime:function(e){return this._getDateTimeTypeInstance().parseValue(e,"string")},_formatDateTime:function(e){return this._getDateTimeTypeInstance().formatValue(e,"string")},_getDateTimeTypeInstance:function(){return new a({pattern:"yyyy-MM-ddTHH:mm:ssZ",calendarType:"Gregorian"},{V4:true})}};return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/massEdit/MassEditHandlers-dbg", ["sap/base/Log", "sap/fe/core/helpers/ModelHelper", "sap/fe/macros/internal/valuehelp/ValueListHelper", "sap/ui/core/Core"], function (Log, ModelHelper, ValueListHelper, Core) {
  "use strict";

  const MassEditHandlers = {
    /**
     * Called for property change in the transient context.
     *
     * @function
     * @param newValue New value of the property.
     * @param dataProperty Final context returned after the paginator action
     * @param mdcFieldId Final context returned after the paginator action
     */
    contextPropertyChange: function (newValue, dataProperty, mdcFieldId) {
      // Called for
      // 1. Out Parameters.
      // 2. Transient context property change.

      const source = Core.byId(mdcFieldId);
      const transCtx = source && source.getBindingContext();
      const fieldInfoModel = source && source.getModel("fieldsInfo");
      const values = fieldInfoModel.getProperty(`/values/${dataProperty}`) || fieldInfoModel.getProperty(`/unitData/${dataProperty}`) || [];
      if (transCtx && (values.inputType === "InputWithValueHelp" || values.inputType === "InputWithUnit") && !values.valueListInfo) {
        MassEditHandlers._setValueListInfo(transCtx, source, fieldInfoModel, dataProperty);
      }
      const isDialogOpen = fieldInfoModel && fieldInfoModel.getProperty("/isOpen");
      if (!isDialogOpen || !source.getVisible()) {
        return;
      }
      MassEditHandlers._updateSelectKey(source, dataProperty, newValue);
    },
    /**
     * Called for change in the MDC field.
     * This is called on selection done through VHD.
     * This is not called on change of the dropdown as we are using a custom MassEditSelect control and not general Select.
     *
     * @function
     * @param event Event object for change.
     * @param propertyName Property path.
     */
    handleMDCFieldChange: function (event, propertyName) {
      // Called for
      // 1. VHD property change.

      const source = event && event.getSource();
      const changePromise = event && event.getParameter("promise");
      const comboBox = source.getContent();
      if (!comboBox || !propertyName) {
        return;
      }
      changePromise.then(MassEditHandlers._updateSelectKeyForMDCFieldChange.bind(MassEditHandlers, source, propertyName)).catch(err => {
        Log.warning(`VHD selection couldn't be populated in the mass edit field.${err}`);
      });
    },
    /**
     * Called for selection change through the drop down.
     *
     * @function
     * @param event Event object for change.
     */
    handleSelectionChange: function (event) {
      // Called for Manual selection from dropdown(comboBox or select)
      // 1. VHD select.
      // 2. Any value change in the control.

      const source = event && event.getSource();
      const key = source.getSelectedKey();
      const params = source && key && key.split("/");
      let propertyName;
      if (params[0] === "UseValueHelpValue") {
        const prevItem = event.getParameter("previousSelectedItem");
        const selectKey = prevItem.getKey();
        propertyName = params.slice(1).join("/");
        MassEditHandlers._onVHSelect(source, propertyName, selectKey);
        return;
      }
      const fieldInfoModel = source && source.getModel("fieldsInfo");
      propertyName = MassEditHandlers._getPropertyNameFromKey(key);
      MassEditHandlers._updateSuggestionForFieldsWithInParameters(fieldInfoModel, propertyName, key.startsWith("Default/") || key.startsWith("ClearFieldValue/"), true);
      MassEditHandlers._updateSuggestionForFieldsWithOutParameters(fieldInfoModel, propertyName, key.startsWith("Default/") || key.startsWith("ClearFieldValue/"), false);
      MassEditHandlers._updateResults(source, params, true);
    },
    /**
     * Update selections to results and the suggests in drop downs.
     *
     * @function
     * @param source MDC field that was changed.
     * @param propertyName Property path.
     * @param value New value.
     */
    _updateSelectKeyForMDCFieldChange: function (source, propertyName, value) {
      const transCtx = source && source.getBindingContext();
      const fieldInfoModel = source && source.getModel("fieldsInfo");
      const values = fieldInfoModel.getProperty(`/values/${propertyName}`) || fieldInfoModel.getProperty(`/unitData/${propertyName}`) || [];
      if (transCtx && (values.inputType === "InputWithValueHelp" || values.inputType === "InputWithUnit") && !values.valueListInfo) {
        MassEditHandlers._setValueListInfo(transCtx, source, fieldInfoModel, propertyName);
      }
      MassEditHandlers._updateSuggestionForFieldsWithOutParameters(fieldInfoModel, propertyName, false, true);
      MassEditHandlers._updateSuggestionForFieldsWithInParameters(fieldInfoModel, propertyName, false, true);
      const formattedValue = source.getFormFormattedValue();
      MassEditHandlers._updateSelectKey(source, propertyName, value, formattedValue);
    },
    /**
     * Update suggests for all drop downs with InParameter as the propertyName.
     *
     * @function
     * @param fieldInfoModel Runtime model with parameters store information.
     * @param propertyName Property path.
     * @param resetValues Should the values be reset to original state.
     * @param keepExistingSelection Should the existing selection before update remain.
     */
    _updateSuggestionForFieldsWithInParameters: function (fieldInfoModel, propertyName, resetValues, keepExistingSelection) {
      const values = fieldInfoModel.getProperty("/values");
      const unitData = fieldInfoModel.getProperty("/unitData");
      const fieldPaths = Object.keys(values);
      const unitFieldPaths = Object.keys(unitData);
      fieldPaths.forEach(MassEditHandlers._updateInParameterSuggetions.bind(MassEditHandlers, fieldInfoModel, "/values/", propertyName, resetValues, keepExistingSelection));
      unitFieldPaths.forEach(MassEditHandlers._updateInParameterSuggetions.bind(MassEditHandlers, fieldInfoModel, "/unitData/", propertyName, resetValues, keepExistingSelection));
    },
    /**
     * Update suggests for a drop down with InParameter as the srcPropertyName.
     *
     * @function
     * @param fieldInfoModel Runtime model with parameters store information.
     * @param pathPrefix Path in the runtime model.
     * @param srcPropertyName The InParameter Property path.
     * @param resetValues Should the values be reset to original state.
     * @param keepExistingSelection Should the existing selection before update remain.
     * @param propertyName Property path that needs update of suggestions.
     */
    _updateInParameterSuggetions: function (fieldInfoModel, pathPrefix, srcPropertyName, resetValues, keepExistingSelection, propertyName) {
      const valueListInfo = fieldInfoModel.getProperty(`${pathPrefix + propertyName}/valueListInfo`);
      if (valueListInfo && srcPropertyName != propertyName) {
        const inParameters = valueListInfo.inParameters;
        if (inParameters && inParameters.length > 0 && inParameters.includes(srcPropertyName)) {
          MassEditHandlers._updateFieldPathSuggestions(fieldInfoModel, pathPrefix + propertyName, resetValues, keepExistingSelection);
        }
      }
    },
    /**
     * Update suggests for all OutParameter's drop downs of the propertyName.
     *
     * @function
     * @param fieldInfoModel Runtime model with parameters store information.
     * @param propertyName Property path.
     * @param resetValues Should the values be reset to original state.
     * @param keepExistingSelection Should the existing selection before update remain.
     */
    _updateSuggestionForFieldsWithOutParameters: function (fieldInfoModel, propertyName, resetValues, keepExistingSelection) {
      const valueListInfo = fieldInfoModel.getProperty(`/values/${propertyName}/valueListInfo`) || fieldInfoModel.getProperty(`/unitData/${propertyName}/valueListInfo`);
      if (valueListInfo && valueListInfo.outParameters) {
        const outParameters = valueListInfo.outParameters;
        if (outParameters.length && outParameters.length > 0) {
          MassEditHandlers._updateOutParameterSuggetions(outParameters, fieldInfoModel, resetValues, keepExistingSelection);
          const pathPrefix = fieldInfoModel.getProperty(`/values/${propertyName}`) && `/values/${propertyName}` || fieldInfoModel.getProperty(`/unitData/${propertyName}`) && `/unitData/${propertyName}`;
          if (pathPrefix) {
            MassEditHandlers._updateFieldPathSuggestions(fieldInfoModel, pathPrefix, false, true);
          }
        }
      }
    },
    /**
     * Update suggests for a drop down with InParameter as the srcPropertyName.
     *
     * @function
     * @param outParameters String arrary of OutParameter property paths.
     * @param fieldInfoModel Runtime model with parameters store information.
     * @param resetValues Should the values be reset to original state.
     * @param keepExistingSelection Should the existing selection before update remain.
     */
    _updateOutParameterSuggetions: function (outParameters, fieldInfoModel, resetValues, keepExistingSelection) {
      const values = fieldInfoModel.getProperty("/values");
      const unitData = fieldInfoModel.getProperty("/unitData");
      const fieldPaths = Object.keys(values);
      const unitFieldPaths = Object.keys(unitData);
      outParameters.forEach(outParameter => {
        if (fieldPaths.includes(outParameter)) {
          MassEditHandlers._updateFieldPathSuggestions(fieldInfoModel, `/values/${outParameter}`, resetValues, keepExistingSelection);
        } else if (unitFieldPaths.includes(outParameter)) {
          MassEditHandlers._updateFieldPathSuggestions(fieldInfoModel, `/unitData/${outParameter}`, resetValues, keepExistingSelection);
        }
      });
    },
    /**
     * Update suggests for a drop down of a field.
     *
     * @function
     * @param fieldInfoModel Runtime model with parameters store information.
     * @param fieldPathAbsolute Complete runtime property path.
     * @param resetValues Should the values be reset to original state.
     * @param keepExistingSelection Should the existing selection before update remain.
     */
    _updateFieldPathSuggestions: function (fieldInfoModel, fieldPathAbsolute, resetValues, keepExistingSelection) {
      const options = fieldInfoModel.getProperty(fieldPathAbsolute);
      const defaultOptions = options.defaultOptions;
      const selectedKey = fieldInfoModel.getProperty(`${fieldPathAbsolute}/selectedKey`);
      const existingSelection = keepExistingSelection && options.find(option => option.key === selectedKey);
      if (resetValues) {
        const selectOptions = options.selectOptions;
        options.length = 0;
        defaultOptions.forEach(defaultOption => options.push(defaultOption));
        selectOptions.forEach(selectOption => options.push(selectOption));
      } else {
        options.length = 0;
        defaultOptions.forEach(defaultOption => options.push(defaultOption));
      }
      fieldInfoModel.setProperty(fieldPathAbsolute, options);
      if (existingSelection && !options.includes(existingSelection)) {
        options.push(existingSelection);
        fieldInfoModel.setProperty(`${fieldPathAbsolute}/selectedKey`, selectedKey);
      }
    },
    /**
     * Update In and Out Parameters in the MED.
     *
     * @function
     * @param transCtx The transient context of the MED.
     * @param source MDC field.
     * @param fieldInfoModel Runtime model with parameters store information.
     * @param propertyName Property path.
     */
    _setValueListInfo: function (transCtx, source, fieldInfoModel, propertyName) {
      const propPath = fieldInfoModel.getProperty(`/values/${propertyName}`) && "/values/" || fieldInfoModel.getProperty(`/unitData/${propertyName}`) && "/unitData/";
      if (fieldInfoModel.getProperty(`${propPath}${propertyName}/valueListInfo`)) {
        return;
      }
      const valueListInfo = fieldInfoModel.getProperty(`${propPath}${propertyName}/valueListInfo`);
      if (!valueListInfo) {
        MassEditHandlers._requestValueList(transCtx, source, fieldInfoModel, propertyName);
      }
    },
    /**
     * Request and update In and Out Parameters in the MED.
     *
     * @function
     * @param transCtx The transient context of the MED.
     * @param source MDC field.
     * @param fieldInfoModel Runtime model with parameters store information.
     * @param propertyName Property path.
     */
    _requestValueList: function (transCtx, source, fieldInfoModel, propertyName) {
      var _fieldValueHelp$getDe;
      const metaPath = ModelHelper.getMetaPathForContext(transCtx);
      const propertyPath = metaPath && `${metaPath}/${propertyName}`;
      const dependents = source === null || source === void 0 ? void 0 : source.getDependents();
      const fieldHelp = source === null || source === void 0 ? void 0 : source.getFieldHelp();
      const fieldValueHelp = dependents === null || dependents === void 0 ? void 0 : dependents.find(dependent => dependent.getId() === fieldHelp);
      const payload = (_fieldValueHelp$getDe = fieldValueHelp.getDelegate()) === null || _fieldValueHelp$getDe === void 0 ? void 0 : _fieldValueHelp$getDe.payload;
      if (!(fieldValueHelp !== null && fieldValueHelp !== void 0 && fieldValueHelp.getBindingContext())) {
        fieldValueHelp === null || fieldValueHelp === void 0 ? void 0 : fieldValueHelp.setBindingContext(transCtx);
      }
      const metaModel = transCtx.getModel().getMetaModel();
      ValueListHelper.createVHUIModel(fieldValueHelp, propertyPath, metaModel);
      const valueListInfo = ValueListHelper.getValueListInfo(fieldValueHelp, propertyPath, payload);
      valueListInfo.then(vLinfos => {
        const vLinfo = vLinfos[0];
        const propPath = fieldInfoModel.getProperty(`/values/${propertyName}`) && "/values/" || fieldInfoModel.getProperty(`/unitData/${propertyName}`) && "/unitData/";
        const info = {
          inParameters: vLinfo.vhParameters && ValueListHelper.getInParameters(vLinfo.vhParameters).map(inParam => inParam.helpPath),
          outParameters: vLinfo.vhParameters && ValueListHelper.getOutParameters(vLinfo.vhParameters).map(outParam => outParam.helpPath)
        };
        fieldInfoModel.setProperty(`${propPath}${propertyName}/valueListInfo`, info);
        if (info.outParameters.length > 0) {
          MassEditHandlers._updateFieldPathSuggestions(fieldInfoModel, `/values/${propertyName}`, false, true);
        }
      }).catch(() => {
        Log.warning(`Mass Edit: Couldn't load valueList info for ${propertyPath}`);
      });
    },
    /**
     * Get field help control from MDC field.
     *
     * @function
     * @param transCtx The transient context of the MED.
     * @param source MDC field.
     * @returns Field Help control.
     */
    _getValueHelp: function (transCtx, source) {
      const dependents = source === null || source === void 0 ? void 0 : source.getDependents();
      const fieldHelp = source === null || source === void 0 ? void 0 : source.getFieldHelp();
      return dependents === null || dependents === void 0 ? void 0 : dependents.find(dependent => dependent.getId() === fieldHelp);
    },
    /**
     * Colled on drop down selection of VHD option.
     *
     * @function
     * @param source Custom Mass Edit Select control.
     * @param propertyName Property path.
     * @param selectKey Previous key before the VHD was selected.
     */
    _onVHSelect: function (source, propertyName, selectKey) {
      // Called for
      // 1. VHD selected.

      const fieldInfoModel = source && source.getModel("fieldsInfo");
      const propPath = fieldInfoModel.getProperty(`/values/${propertyName}`) && "/values/" || fieldInfoModel.getProperty(`/unitData/${propertyName}`) && "/unitData/";
      const transCtx = source.getBindingContext();
      const fieldValueHelp = MassEditHandlers._getValueHelp(transCtx, source.getParent());
      if (!(fieldValueHelp !== null && fieldValueHelp !== void 0 && fieldValueHelp.getBindingContext())) {
        fieldValueHelp === null || fieldValueHelp === void 0 ? void 0 : fieldValueHelp.setBindingContext(transCtx);
      }
      source.fireValueHelpRequest();
      fieldInfoModel.setProperty(`${propPath + propertyName}/selectedKey`, selectKey);
    },
    /**
     * Gets Property name from selection key.
     *
     * @function
     * @param key Selection key.
     * @returns Property name.
     */
    _getPropertyNameFromKey: function (key) {
      let propertyName = "";
      if (key.startsWith("Default/") || key.startsWith("ClearFieldValue/") || key.startsWith("UseValueHelpValue/")) {
        propertyName = key.substring(key.indexOf("/") + 1);
      } else {
        propertyName = key.substring(0, key.lastIndexOf("/"));
      }
      return propertyName;
    },
    /**
     * Update selection to Custom Mass Edit Select from MDC field.
     *
     * @function
     * @param source MDC field.
     * @param propertyName Property path.
     * @param value Value to update.
     * @param fullText Full text to use.
     */
    _updateSelectKey: function (source, propertyName, value, fullText) {
      // Called for
      // 1. VHD property change
      // 2. Out Parameters.
      // 3. Transient context property change.

      const comboBox = source.getContent();
      if (!comboBox || !propertyName) {
        return;
      }
      let key = comboBox.getSelectedKey();
      if ((key.startsWith("Default/") || key.startsWith("ClearFieldValue/")) && !value) {
        return;
      }
      const formattedText = MassEditHandlers._valueExists(fullText) ? fullText : value;
      const fieldInfoModel = source && source.getModel("fieldsInfo");
      const values = fieldInfoModel.getProperty(`/values/${propertyName}`) || fieldInfoModel.getProperty(`/unitData/${propertyName}`) || [];
      const propPath = fieldInfoModel.getProperty(`/values/${propertyName}`) && "/values/" || fieldInfoModel.getProperty(`/unitData/${propertyName}`) && "/unitData/";
      const relatedField = values.find(fieldData => {
        var _fieldData$textInfo;
        return (fieldData === null || fieldData === void 0 ? void 0 : (_fieldData$textInfo = fieldData.textInfo) === null || _fieldData$textInfo === void 0 ? void 0 : _fieldData$textInfo.value) === value || fieldData.text === value;
      });
      if (relatedField) {
        if (fullText && relatedField.textInfo && relatedField.textInfo.descriptionPath && (relatedField.text != formattedText || relatedField.textInfo.fullText != formattedText)) {
          // Update the full text only when provided.
          relatedField.text = formattedText;
          relatedField.textInfo.fullText = formattedText;
          relatedField.textInfo.description = source.getAdditionalValue();
        }
        if (relatedField.key === key) {
          fieldInfoModel.setProperty(`${propPath + propertyName}/selectedKey`, key);
          return;
        }
        key = relatedField.key;
      } else if ([undefined, null, ""].indexOf(value) === -1) {
        key = `${propertyName}/${value}`;
        const selectionInfo = {
          text: formattedText,
          key,
          textInfo: {
            description: source.getAdditionalValue(),
            descriptionPath: values && values.textInfo && values.textInfo.descriptionPath,
            fullText: formattedText,
            textArrangement: source.getDisplay(),
            value: source.getValue(),
            valuePath: propertyName
          }
        };
        values.push(selectionInfo);
        values.selectOptions = values.selectOptions || [];
        values.selectOptions.push(selectionInfo);
        fieldInfoModel.setProperty(propPath + propertyName, values);
      } else {
        key = `Default/${propertyName}`;
      }
      fieldInfoModel.setProperty(`${propPath + propertyName}/selectedKey`, key);
      MassEditHandlers._updateResults(comboBox);
    },
    /**
     * Get Value from Drop down.
     *
     * @function
     * @param source Drop down control.
     * @returns Value of selection.
     */
    _getValue: function (source) {
      var _getSelectedItem;
      return source.getMetadata().getName() === "sap.fe.core.controls.MassEditSelect" ? (_getSelectedItem = source.getSelectedItem()) === null || _getSelectedItem === void 0 ? void 0 : _getSelectedItem.getText() : source.getValue();
    },
    _getValueOnEmpty: function (oSource, fieldsInfoModel, value, sPropertyName) {
      if (!value) {
        const values = fieldsInfoModel.getProperty(`/values/${sPropertyName}`) || fieldsInfoModel.getProperty(`/unitData/${sPropertyName}`) || [];
        if (values.unitProperty) {
          value = 0;
          oSource.setValue(value);
        } else if (values.inputType === "CheckBox") {
          value = false;
        }
      }
      return value;
    },
    _valueExists: function (value) {
      return value != undefined && value != null;
    },
    /**
     * Updates selections to runtime model.
     *
     * @function
     * @param oSource Drop down control.
     * @param aParams Parts of key in runtime model.
     * @param updateTransCtx Should transient context be updated with the value.
     */
    _updateResults: function (oSource) {
      let aParams = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
      let updateTransCtx = arguments.length > 2 ? arguments[2] : undefined;
      // Called for
      // 1. VHD property change.
      // 2. Out parameter.
      // 3. transient context property change.
      const fieldsInfoModel = oSource && oSource.getModel("fieldsInfo");
      const oFieldsInfoData = fieldsInfoModel && fieldsInfoModel.getData();
      let value = MassEditHandlers._getValue(oSource);
      aParams = aParams.length > 0 ? aParams : oSource && oSource.getSelectedKey() && oSource.getSelectedKey().split("/");
      let oDataObject;
      const sPropertyName = oSource.data("fieldPath");
      if (aParams[0] === "Default") {
        oDataObject = {
          keyValue: aParams[1],
          value: aParams[0]
        };
      } else if (aParams[0] === "ClearFieldValue") {
        value = "";
        value = MassEditHandlers._getValueOnEmpty(oSource, fieldsInfoModel, value, sPropertyName);
        oDataObject = {
          keyValue: aParams[1],
          value: value
        };
      } else if (!aParams) {
        value = MassEditHandlers._getValueOnEmpty(oSource, fieldsInfoModel, value, sPropertyName);
        oDataObject = {
          keyValue: sPropertyName,
          value: value
        };
      } else {
        const propertyName = aParams.slice(0, -1).join("/");
        const propertyValues = fieldsInfoModel.getProperty(`/values/${propertyName}`) || fieldsInfoModel.getProperty(`/unitData/${propertyName}`) || [];
        const relatedField = (propertyValues || []).find(function (oFieldData) {
          var _oFieldData$textInfo;
          return (oFieldData === null || oFieldData === void 0 ? void 0 : (_oFieldData$textInfo = oFieldData.textInfo) === null || _oFieldData$textInfo === void 0 ? void 0 : _oFieldData$textInfo.value) === value || oFieldData.text === value;
        });
        oDataObject = {
          keyValue: propertyName,
          value: relatedField.textInfo && MassEditHandlers._valueExists(relatedField.textInfo.value) ? relatedField.textInfo.value : relatedField.text
        };
      }
      let bExistingElementindex = -1;
      for (let i = 0; i < oFieldsInfoData.results.length; i++) {
        if (oFieldsInfoData.results[i].keyValue === oDataObject.keyValue) {
          bExistingElementindex = i;
        }
      }
      if (bExistingElementindex !== -1) {
        oFieldsInfoData.results[bExistingElementindex] = oDataObject;
      } else {
        oFieldsInfoData.results.push(oDataObject);
      }
      if (updateTransCtx && !oDataObject.keyValue.includes("/")) {
        const transCtx = oSource.getBindingContext();
        if (aParams[0] === "Default" || aParams[0] === "ClearFieldValue") {
          transCtx.setProperty(oDataObject.keyValue, null);
        } else if (oDataObject) {
          transCtx.setProperty(oDataObject.keyValue, oDataObject.value);
        }
      }
    }
  };
  return MassEditHandlers;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/controls/massEdit/MassEditHandlers", ["sap/base/Log","sap/fe/core/helpers/ModelHelper","sap/fe/macros/internal/valuehelp/ValueListHelper","sap/ui/core/Core"],function(e,t,n,s){"use strict";const a={contextPropertyChange:function(e,t,n){const o=s.byId(n);const l=o&&o.getBindingContext();const i=o&&o.getModel("fieldsInfo");const u=i.getProperty(`/values/${t}`)||i.getProperty(`/unitData/${t}`)||[];if(l&&(u.inputType==="InputWithValueHelp"||u.inputType==="InputWithUnit")&&!u.valueListInfo){a._setValueListInfo(l,o,i,t)}const r=i&&i.getProperty("/isOpen");if(!r||!o.getVisible()){return}a._updateSelectKey(o,t,e)},handleMDCFieldChange:function(t,n){const s=t&&t.getSource();const o=t&&t.getParameter("promise");const l=s.getContent();if(!l||!n){return}o.then(a._updateSelectKeyForMDCFieldChange.bind(a,s,n)).catch(t=>{e.warning(`VHD selection couldn't be populated in the mass edit field.${t}`)})},handleSelectionChange:function(e){const t=e&&e.getSource();const n=t.getSelectedKey();const s=t&&n&&n.split("/");let o;if(s[0]==="UseValueHelpValue"){const n=e.getParameter("previousSelectedItem");const l=n.getKey();o=s.slice(1).join("/");a._onVHSelect(t,o,l);return}const l=t&&t.getModel("fieldsInfo");o=a._getPropertyNameFromKey(n);a._updateSuggestionForFieldsWithInParameters(l,o,n.startsWith("Default/")||n.startsWith("ClearFieldValue/"),true);a._updateSuggestionForFieldsWithOutParameters(l,o,n.startsWith("Default/")||n.startsWith("ClearFieldValue/"),false);a._updateResults(t,s,true)},_updateSelectKeyForMDCFieldChange:function(e,t,n){const s=e&&e.getBindingContext();const o=e&&e.getModel("fieldsInfo");const l=o.getProperty(`/values/${t}`)||o.getProperty(`/unitData/${t}`)||[];if(s&&(l.inputType==="InputWithValueHelp"||l.inputType==="InputWithUnit")&&!l.valueListInfo){a._setValueListInfo(s,e,o,t)}a._updateSuggestionForFieldsWithOutParameters(o,t,false,true);a._updateSuggestionForFieldsWithInParameters(o,t,false,true);const i=e.getFormFormattedValue();a._updateSelectKey(e,t,n,i)},_updateSuggestionForFieldsWithInParameters:function(e,t,n,s){const o=e.getProperty("/values");const l=e.getProperty("/unitData");const i=Object.keys(o);const u=Object.keys(l);i.forEach(a._updateInParameterSuggetions.bind(a,e,"/values/",t,n,s));u.forEach(a._updateInParameterSuggetions.bind(a,e,"/unitData/",t,n,s))},_updateInParameterSuggetions:function(e,t,n,s,o,l){const i=e.getProperty(`${t+l}/valueListInfo`);if(i&&n!=l){const u=i.inParameters;if(u&&u.length>0&&u.includes(n)){a._updateFieldPathSuggestions(e,t+l,s,o)}}},_updateSuggestionForFieldsWithOutParameters:function(e,t,n,s){const o=e.getProperty(`/values/${t}/valueListInfo`)||e.getProperty(`/unitData/${t}/valueListInfo`);if(o&&o.outParameters){const l=o.outParameters;if(l.length&&l.length>0){a._updateOutParameterSuggetions(l,e,n,s);const o=e.getProperty(`/values/${t}`)&&`/values/${t}`||e.getProperty(`/unitData/${t}`)&&`/unitData/${t}`;if(o){a._updateFieldPathSuggestions(e,o,false,true)}}}},_updateOutParameterSuggetions:function(e,t,n,s){const o=t.getProperty("/values");const l=t.getProperty("/unitData");const i=Object.keys(o);const u=Object.keys(l);e.forEach(e=>{if(i.includes(e)){a._updateFieldPathSuggestions(t,`/values/${e}`,n,s)}else if(u.includes(e)){a._updateFieldPathSuggestions(t,`/unitData/${e}`,n,s)}})},_updateFieldPathSuggestions:function(e,t,n,s){const a=e.getProperty(t);const o=a.defaultOptions;const l=e.getProperty(`${t}/selectedKey`);const i=s&&a.find(e=>e.key===l);if(n){const e=a.selectOptions;a.length=0;o.forEach(e=>a.push(e));e.forEach(e=>a.push(e))}else{a.length=0;o.forEach(e=>a.push(e))}e.setProperty(t,a);if(i&&!a.includes(i)){a.push(i);e.setProperty(`${t}/selectedKey`,l)}},_setValueListInfo:function(e,t,n,s){const o=n.getProperty(`/values/${s}`)&&"/values/"||n.getProperty(`/unitData/${s}`)&&"/unitData/";if(n.getProperty(`${o}${s}/valueListInfo`)){return}const l=n.getProperty(`${o}${s}/valueListInfo`);if(!l){a._requestValueList(e,t,n,s)}},_requestValueList:function(s,o,l,i){var u;const r=t.getMetaPathForContext(s);const d=r&&`${r}/${i}`;const c=o===null||o===void 0?void 0:o.getDependents();const g=o===null||o===void 0?void 0:o.getFieldHelp();const f=c===null||c===void 0?void 0:c.find(e=>e.getId()===g);const p=(u=f.getDelegate())===null||u===void 0?void 0:u.payload;if(!(f!==null&&f!==void 0&&f.getBindingContext())){f===null||f===void 0?void 0:f.setBindingContext(s)}const y=s.getModel().getMetaModel();n.createVHUIModel(f,d,y);const P=n.getValueListInfo(f,d,p);P.then(e=>{const t=e[0];const s=l.getProperty(`/values/${i}`)&&"/values/"||l.getProperty(`/unitData/${i}`)&&"/unitData/";const o={inParameters:t.vhParameters&&n.getInParameters(t.vhParameters).map(e=>e.helpPath),outParameters:t.vhParameters&&n.getOutParameters(t.vhParameters).map(e=>e.helpPath)};l.setProperty(`${s}${i}/valueListInfo`,o);if(o.outParameters.length>0){a._updateFieldPathSuggestions(l,`/values/${i}`,false,true)}}).catch(()=>{e.warning(`Mass Edit: Couldn't load valueList info for ${d}`)})},_getValueHelp:function(e,t){const n=t===null||t===void 0?void 0:t.getDependents();const s=t===null||t===void 0?void 0:t.getFieldHelp();return n===null||n===void 0?void 0:n.find(e=>e.getId()===s)},_onVHSelect:function(e,t,n){const s=e&&e.getModel("fieldsInfo");const o=s.getProperty(`/values/${t}`)&&"/values/"||s.getProperty(`/unitData/${t}`)&&"/unitData/";const l=e.getBindingContext();const i=a._getValueHelp(l,e.getParent());if(!(i!==null&&i!==void 0&&i.getBindingContext())){i===null||i===void 0?void 0:i.setBindingContext(l)}e.fireValueHelpRequest();s.setProperty(`${o+t}/selectedKey`,n)},_getPropertyNameFromKey:function(e){let t="";if(e.startsWith("Default/")||e.startsWith("ClearFieldValue/")||e.startsWith("UseValueHelpValue/")){t=e.substring(e.indexOf("/")+1)}else{t=e.substring(0,e.lastIndexOf("/"))}return t},_updateSelectKey:function(e,t,n,s){const o=e.getContent();if(!o||!t){return}let l=o.getSelectedKey();if((l.startsWith("Default/")||l.startsWith("ClearFieldValue/"))&&!n){return}const i=a._valueExists(s)?s:n;const u=e&&e.getModel("fieldsInfo");const r=u.getProperty(`/values/${t}`)||u.getProperty(`/unitData/${t}`)||[];const d=u.getProperty(`/values/${t}`)&&"/values/"||u.getProperty(`/unitData/${t}`)&&"/unitData/";const c=r.find(e=>{var t;return(e===null||e===void 0?void 0:(t=e.textInfo)===null||t===void 0?void 0:t.value)===n||e.text===n});if(c){if(s&&c.textInfo&&c.textInfo.descriptionPath&&(c.text!=i||c.textInfo.fullText!=i)){c.text=i;c.textInfo.fullText=i;c.textInfo.description=e.getAdditionalValue()}if(c.key===l){u.setProperty(`${d+t}/selectedKey`,l);return}l=c.key}else if([undefined,null,""].indexOf(n)===-1){l=`${t}/${n}`;const s={text:i,key:l,textInfo:{description:e.getAdditionalValue(),descriptionPath:r&&r.textInfo&&r.textInfo.descriptionPath,fullText:i,textArrangement:e.getDisplay(),value:e.getValue(),valuePath:t}};r.push(s);r.selectOptions=r.selectOptions||[];r.selectOptions.push(s);u.setProperty(d+t,r)}else{l=`Default/${t}`}u.setProperty(`${d+t}/selectedKey`,l);a._updateResults(o)},_getValue:function(e){var t;return e.getMetadata().getName()==="sap.fe.core.controls.MassEditSelect"?(t=e.getSelectedItem())===null||t===void 0?void 0:t.getText():e.getValue()},_getValueOnEmpty:function(e,t,n,s){if(!n){const a=t.getProperty(`/values/${s}`)||t.getProperty(`/unitData/${s}`)||[];if(a.unitProperty){n=0;e.setValue(n)}else if(a.inputType==="CheckBox"){n=false}}return n},_valueExists:function(e){return e!=undefined&&e!=null},_updateResults:function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let n=arguments.length>2?arguments[2]:undefined;const s=e&&e.getModel("fieldsInfo");const o=s&&s.getData();let l=a._getValue(e);t=t.length>0?t:e&&e.getSelectedKey()&&e.getSelectedKey().split("/");let i;const u=e.data("fieldPath");if(t[0]==="Default"){i={keyValue:t[1],value:t[0]}}else if(t[0]==="ClearFieldValue"){l="";l=a._getValueOnEmpty(e,s,l,u);i={keyValue:t[1],value:l}}else if(!t){l=a._getValueOnEmpty(e,s,l,u);i={keyValue:u,value:l}}else{const e=t.slice(0,-1).join("/");const n=s.getProperty(`/values/${e}`)||s.getProperty(`/unitData/${e}`)||[];const o=(n||[]).find(function(e){var t;return(e===null||e===void 0?void 0:(t=e.textInfo)===null||t===void 0?void 0:t.value)===l||e.text===l});i={keyValue:e,value:o.textInfo&&a._valueExists(o.textInfo.value)?o.textInfo.value:o.text}}let r=-1;for(let e=0;e<o.results.length;e++){if(o.results[e].keyValue===i.keyValue){r=e}}if(r!==-1){o.results[r]=i}else{o.results.push(i)}if(n&&!i.keyValue.includes("/")){const n=e.getBindingContext();if(t[0]==="Default"||t[0]==="ClearFieldValue"){n.setProperty(i.keyValue,null)}else if(i){n.setProperty(i.keyValue,i.value)}}}};return a},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/ConverterContext-dbg", ["sap/fe/core/converters/ManifestWrapper", "sap/fe/core/converters/MetaModelConverter", "sap/fe/core/templating/DataModelPathHelper"], function (ManifestWrapper, MetaModelConverter, DataModelPathHelper) {
  "use strict";

  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var getContextRelativeTargetObjectPath = DataModelPathHelper.getContextRelativeTargetObjectPath;
  var enhanceDataModelPath = DataModelPathHelper.enhanceDataModelPath;
  var getInvolvedDataModelObjectFromPath = MetaModelConverter.getInvolvedDataModelObjectFromPath;
  var convertTypes = MetaModelConverter.convertTypes;
  /**
   * Checks whether an object is an annotation term.
   *
   * @param vAnnotationPath
   * @returns `true` if it's an annotation term
   */
  const isAnnotationTerm = function (vAnnotationPath) {
    return typeof vAnnotationPath === "object";
  };
  function isServiceObject(objectPart) {
    return objectPart && objectPart.hasOwnProperty("_type");
  }
  const getDataModelPathForEntitySet = function (resolvedMetaPath, convertedTypes) {
    let rootEntitySet;
    let currentEntitySet;
    let previousEntitySet;
    let currentEntityType;
    let navigatedPaths = [];
    const navigationProperties = [];
    resolvedMetaPath.objectPath.forEach(objectPart => {
      var _currentEntitySet;
      if (isServiceObject(objectPart)) {
        switch (objectPart._type) {
          case "NavigationProperty":
            navigatedPaths.push(objectPart.name);
            navigationProperties.push(objectPart);
            currentEntityType = objectPart.targetType;
            if (previousEntitySet && previousEntitySet.navigationPropertyBinding.hasOwnProperty(navigatedPaths.join("/"))) {
              currentEntitySet = previousEntitySet.navigationPropertyBinding[navigatedPaths.join("/")];
              previousEntitySet = currentEntitySet;
              navigatedPaths = [];
            } else {
              currentEntitySet = undefined;
            }
            break;
          case "EntitySet":
            if (rootEntitySet === undefined) {
              rootEntitySet = objectPart;
            }
            currentEntitySet = objectPart;
            previousEntitySet = currentEntitySet;
            currentEntityType = (_currentEntitySet = currentEntitySet) === null || _currentEntitySet === void 0 ? void 0 : _currentEntitySet.entityType;
            break;
          default:
            break;
        }
      }
    });
    const dataModelPath = {
      startingEntitySet: rootEntitySet,
      targetEntityType: currentEntityType,
      targetEntitySet: currentEntitySet,
      navigationProperties: navigationProperties,
      contextLocation: undefined,
      targetObject: resolvedMetaPath.target,
      convertedTypes: convertedTypes
    };
    dataModelPath.contextLocation = dataModelPath;
    return dataModelPath;
  };

  /**
   * Create a ConverterContext object that will be used within the converters.
   *
   * @param {ConvertedMetadata} oConvertedTypes The converted annotation and service types
   * @param {BaseManifestSettings} oManifestSettings The manifestSettings that applies to this page
   * @param {TemplateType} templateType The type of template we're looking at right now
   * @param {IDiagnostics} diagnostics The diagnostics shim
   * @param {Function} mergeFn The function to be used to perfom some deep merges between object
   * @param {DataModelObjectPath} targetDataModelPath The global path to reach the entitySet
   * @returns {ConverterContext} A converter context for the converters
   */
  let ConverterContext = /*#__PURE__*/function () {
    function ConverterContext(convertedTypes, manifestSettings, diagnostics, mergeFn, targetDataModelPath) {
      this.convertedTypes = convertedTypes;
      this.manifestSettings = manifestSettings;
      this.diagnostics = diagnostics;
      this.mergeFn = mergeFn;
      this.targetDataModelPath = targetDataModelPath;
      this.manifestWrapper = new ManifestWrapper(this.manifestSettings, mergeFn);
      this.baseContextPath = getTargetObjectPath(this.targetDataModelPath);
    }
    var _proto = ConverterContext.prototype;
    _proto._getEntityTypeFromFullyQualifiedName = function _getEntityTypeFromFullyQualifiedName(fullyQualifiedName) {
      return this.convertedTypes.entityTypes.find(entityType => {
        if (fullyQualifiedName.startsWith(entityType.fullyQualifiedName)) {
          const replaceAnnotation = fullyQualifiedName.replace(entityType.fullyQualifiedName, "");
          return replaceAnnotation.startsWith("/") || replaceAnnotation.startsWith("@");
        }
        return false;
      });
    }

    /**
     * Retrieve the entityType associated with an annotation object.
     *
     * @param annotation The annotation object for which we want to find the entityType
     * @returns The EntityType the annotation refers to
     */;
    _proto.getAnnotationEntityType = function getAnnotationEntityType(annotation) {
      if (annotation) {
        const annotationPath = annotation.fullyQualifiedName;
        const targetEntityType = this._getEntityTypeFromFullyQualifiedName(annotationPath);
        if (!targetEntityType) {
          throw new Error(`Cannot find Entity Type for ${annotation.fullyQualifiedName}`);
        }
        return targetEntityType;
      } else {
        return this.targetDataModelPath.targetEntityType;
      }
    }

    /**
     * Retrieve the manifest settings defined for a specific control within controlConfiguration.
     *
     * @param vAnnotationPath The annotation path or object to evaluate
     * @returns The control configuration for that specific annotation path if it exists
     */;
    _proto.getManifestControlConfiguration = function getManifestControlConfiguration(vAnnotationPath) {
      if (isAnnotationTerm(vAnnotationPath)) {
        return this.manifestWrapper.getControlConfiguration(vAnnotationPath.fullyQualifiedName.replace(this.targetDataModelPath.targetEntityType.fullyQualifiedName, ""));
      }
      // Checking if there are multiple entity set in the manifest, and comparing the entity set of the ControlConfiguration with the one from the annotation.
      const sAnnotationPath = this.manifestWrapper.hasMultipleEntitySets() && this.baseContextPath !== `/${this.manifestWrapper.getEntitySet()}` ? `${this.baseContextPath}/${vAnnotationPath}` : vAnnotationPath;
      return this.manifestWrapper.getControlConfiguration(sAnnotationPath);
    }

    /**
     * Create an absolute annotation path based on the current meta model context.
     *
     * @param sAnnotationPath The relative annotation path
     * @returns The correct annotation path based on the current context
     */;
    _proto.getAbsoluteAnnotationPath = function getAbsoluteAnnotationPath(sAnnotationPath) {
      if (!sAnnotationPath) {
        return sAnnotationPath;
      }
      if (sAnnotationPath[0] === "/") {
        return sAnnotationPath;
      }
      return `${this.baseContextPath}/${sAnnotationPath}`;
    }

    /**
     * Retrieve the current entitySet.
     *
     * @returns The current EntitySet if it exists.
     */;
    _proto.getEntitySet = function getEntitySet() {
      return this.targetDataModelPath.targetEntitySet;
    }

    /**
     * Retrieve the context path.
     *
     * @returns The context path of the converter.
     */;
    _proto.getContextPath = function getContextPath() {
      return this.baseContextPath;
    }

    /**
     * Retrieve the current data model object path.
     *
     * @returns The current data model object path
     */;
    _proto.getDataModelObjectPath = function getDataModelObjectPath() {
      return this.targetDataModelPath;
    }

    /**
     * Get the EntityContainer.
     *
     * @returns The current service EntityContainer
     */;
    _proto.getEntityContainer = function getEntityContainer() {
      return this.convertedTypes.entityContainer;
    }

    /**
     * Get the EntityType based on the fully qualified name.
     *
     * @returns The current EntityType.
     */;
    _proto.getEntityType = function getEntityType() {
      return this.targetDataModelPath.targetEntityType;
    }

    /**
     * Gets the entity type of the parameter in case of a parameterized service.
     *
     * @returns The entity type of the parameter
     */;
    _proto.getParameterEntityType = function getParameterEntityType() {
      var _parameterEntityType$, _parameterEntityType$2;
      const parameterEntityType = this.targetDataModelPath.startingEntitySet.entityType;
      const isParameterized = !!((_parameterEntityType$ = parameterEntityType.annotations) !== null && _parameterEntityType$ !== void 0 && (_parameterEntityType$2 = _parameterEntityType$.Common) !== null && _parameterEntityType$2 !== void 0 && _parameterEntityType$2.ResultContext);
      return isParameterized && parameterEntityType;
    }

    /**
     * Retrieves an annotation from an entity type based on annotation path.
     *
     * @param annotationPath The annotation path to be evaluated
     * @returns The target annotation path as well as a converter context to go with it
     */;
    _proto.getEntityTypeAnnotation = function getEntityTypeAnnotation(annotationPath) {
      if (!annotationPath.includes("@")) {
        throw new Error(`Not an annotation path: '${annotationPath}'`);
      }
      const isAbsolute = annotationPath.startsWith("/");
      let path;
      if (isAbsolute) {
        // path can be used as-is
        path = annotationPath;
      } else {
        // build an absolute path based on the entity type (this function works on the type!)
        const base = this.getContextPath().split("@", 1)[0];
        path = base.endsWith("/") ? base + annotationPath : `${base}/${annotationPath}`;
      }
      const target = this.resolveAbsolutePath(path);
      const dataModelObjectPath = getInvolvedDataModelObjectFromPath({
        target: target.target,
        visitedObjects: target.objectPath
      }, this.convertedTypes, isAbsolute ? undefined : this.targetDataModelPath.contextLocation, true);
      return {
        annotation: target.target,
        converterContext: new ConverterContext(this.convertedTypes, this.manifestSettings, this.diagnostics, this.mergeFn, dataModelObjectPath)
      };
    }

    /**
     * Retrieve the type of template we're working on (e.g. ListReport / ObjectPage / ...).
     *
     * @returns The current tenplate type
     */;
    _proto.getTemplateType = function getTemplateType() {
      return this.manifestWrapper.getTemplateType();
    }

    /**
     * Retrieve the converted types.
     *
     * @returns The current converted types
     */;
    _proto.getConvertedTypes = function getConvertedTypes() {
      return this.convertedTypes;
    }

    /**
     * Retrieve a relative annotation path between an annotation path and an entity type.
     *
     * @param annotationPath
     * @param entityType
     * @returns The relative anntotation path.
     */;
    _proto.getRelativeAnnotationPath = function getRelativeAnnotationPath(annotationPath, entityType) {
      return annotationPath.replace(entityType.fullyQualifiedName, "");
    }

    /**
     * Transform an entityType based path to an entitySet based one (ui5 templating generally expect an entitySetBasedPath).
     *
     * @param annotationPath
     * @returns The EntitySet based annotation path
     */;
    _proto.getEntitySetBasedAnnotationPath = function getEntitySetBasedAnnotationPath(annotationPath) {
      if (!annotationPath) {
        return annotationPath;
      }
      const entityTypeFQN = this.targetDataModelPath.targetEntityType.fullyQualifiedName;
      if (this.targetDataModelPath.targetEntitySet || (this.baseContextPath.startsWith("/") && this.baseContextPath.match(/\//g) || []).length > 1) {
        let replacedAnnotationPath = annotationPath.replace(entityTypeFQN, "/");
        if (replacedAnnotationPath.length > 2 && replacedAnnotationPath[0] === "/" && replacedAnnotationPath[1] === "/") {
          replacedAnnotationPath = replacedAnnotationPath.substr(1);
        }
        return this.baseContextPath + (replacedAnnotationPath.startsWith("/") ? replacedAnnotationPath : `/${replacedAnnotationPath}`);
      } else {
        return `/${annotationPath}`;
      }
    }

    /**
     * Retrieve the manifest wrapper for the current context.
     *
     * @returns The current manifest wrapper
     */;
    _proto.getManifestWrapper = function getManifestWrapper() {
      return this.manifestWrapper;
    };
    _proto.getDiagnostics = function getDiagnostics() {
      return this.diagnostics;
    }

    /**
     * Retrieve the target from an absolute path.
     *
     * @param path The path we want to get the target
     * @returns The absolute path
     */;
    _proto.resolveAbsolutePath = function resolveAbsolutePath(path) {
      return this.convertedTypes.resolvePath(path);
    }

    /**
     * Retrieve a new converter context, scoped for a different context path.
     *
     * @param contextPath The path we want to orchestrate the converter context around
     * @returns The converted context for the sub path
     */;
    _proto.getConverterContextFor = function getConverterContextFor(contextPath) {
      const resolvedMetaPath = this.convertedTypes.resolvePath(contextPath);
      const targetPath = getDataModelPathForEntitySet(resolvedMetaPath, this.convertedTypes);
      return new ConverterContext(this.convertedTypes, this.manifestSettings, this.diagnostics, this.mergeFn, targetPath);
    }

    /**
     * Get all annotations of a given term and vocabulary on an entity type
     * (or on the current entity type if entityType isn't specified).
     *
     * @param vocabularyName
     * @param annotationTerm
     * @param [annotationSources]
     * @returns All the annotation for a specific term and vocabulary from an entity type
     */;
    _proto.getAnnotationsByTerm = function getAnnotationsByTerm(vocabularyName, annotationTerm) {
      let annotationSources = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [this.getEntityType()];
      let outAnnotations = [];
      annotationSources.forEach(annotationSource => {
        if (annotationSource) {
          const annotations = (annotationSource === null || annotationSource === void 0 ? void 0 : annotationSource.annotations[vocabularyName]) || {};
          if (annotations) {
            outAnnotations = Object.keys(annotations).filter(annotation => annotations[annotation].term === annotationTerm).reduce((previousValue, key) => {
              previousValue.push(annotations[key]);
              return previousValue;
            }, outAnnotations);
          }
        }
      });
      return outAnnotations;
    }

    /**
     * Retrieves the relative model path based on the current context path.
     *
     * @returns The relative model path or undefined if the path is not resolveable
     */;
    _proto.getRelativeModelPathFunction = function getRelativeModelPathFunction() {
      const targetDataModelPath = this.targetDataModelPath;
      return function (sPath) {
        const enhancedPath = enhanceDataModelPath(targetDataModelPath, sPath);
        return getContextRelativeTargetObjectPath(enhancedPath, true);
      };
    }

    /**
     * Create the converter context necessary for a macro based on a metamodel context.
     *
     * @param sEntitySetName
     * @param oMetaModelContext
     * @param diagnostics
     * @param mergeFn
     * @param targetDataModelPath
     * @param manifestSettings
     * @returns The current converter context
     */;
    ConverterContext.createConverterContextForMacro = function createConverterContextForMacro(sEntitySetName, oMetaModelContext, diagnostics, mergeFn, targetDataModelPath) {
      let manifestSettings = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};
      const oMetaModel = oMetaModelContext.isA("sap.ui.model.odata.v4.ODataMetaModel") ? oMetaModelContext : oMetaModelContext.getModel();
      const oConvertedMetadata = convertTypes(oMetaModel);
      let targetEntitySet = oConvertedMetadata.entitySets.find(entitySet => entitySet.name === sEntitySetName);
      if (!targetEntitySet) {
        targetEntitySet = oConvertedMetadata.singletons.find(entitySet => entitySet.name === sEntitySetName);
      }
      if (!targetDataModelPath || targetEntitySet !== targetDataModelPath.startingEntitySet) {
        targetDataModelPath = {
          startingEntitySet: targetEntitySet,
          navigationProperties: [],
          targetEntitySet: targetEntitySet,
          targetEntityType: targetEntitySet.entityType,
          targetObject: targetEntitySet,
          convertedTypes: oConvertedMetadata
        };
      }
      return new ConverterContext(oConvertedMetadata, manifestSettings, diagnostics, mergeFn, targetDataModelPath);
    };
    return ConverterContext;
  }();
  return ConverterContext;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/ConverterContext", ["sap/fe/core/converters/ManifestWrapper","sap/fe/core/converters/MetaModelConverter","sap/fe/core/templating/DataModelPathHelper"],function(t,e,n){"use strict";var i=n.getTargetObjectPath;var a=n.getContextRelativeTargetObjectPath;var r=n.enhanceDataModelPath;var o=e.getInvolvedDataModelObjectFromPath;var s=e.convertTypes;const u=function(t){return typeof t==="object"};function h(t){return t&&t.hasOwnProperty("_type")}const l=function(t,e){let n;let i;let a;let r;let o=[];const s=[];t.objectPath.forEach(t=>{var e;if(h(t)){switch(t._type){case"NavigationProperty":o.push(t.name);s.push(t);r=t.targetType;if(a&&a.navigationPropertyBinding.hasOwnProperty(o.join("/"))){i=a.navigationPropertyBinding[o.join("/")];a=i;o=[]}else{i=undefined}break;case"EntitySet":if(n===undefined){n=t}i=t;a=i;r=(e=i)===null||e===void 0?void 0:e.entityType;break;default:break}}});const u={startingEntitySet:n,targetEntityType:r,targetEntitySet:i,navigationProperties:s,contextLocation:undefined,targetObject:t.target,convertedTypes:e};u.contextLocation=u;return u};let c=function(){function e(e,n,a,r,o){this.convertedTypes=e;this.manifestSettings=n;this.diagnostics=a;this.mergeFn=r;this.targetDataModelPath=o;this.manifestWrapper=new t(this.manifestSettings,r);this.baseContextPath=i(this.targetDataModelPath)}var n=e.prototype;n._getEntityTypeFromFullyQualifiedName=function t(e){return this.convertedTypes.entityTypes.find(t=>{if(e.startsWith(t.fullyQualifiedName)){const n=e.replace(t.fullyQualifiedName,"");return n.startsWith("/")||n.startsWith("@")}return false})};n.getAnnotationEntityType=function t(e){if(e){const t=e.fullyQualifiedName;const n=this._getEntityTypeFromFullyQualifiedName(t);if(!n){throw new Error(`Cannot find Entity Type for ${e.fullyQualifiedName}`)}return n}else{return this.targetDataModelPath.targetEntityType}};n.getManifestControlConfiguration=function t(e){if(u(e)){return this.manifestWrapper.getControlConfiguration(e.fullyQualifiedName.replace(this.targetDataModelPath.targetEntityType.fullyQualifiedName,""))}const n=this.manifestWrapper.hasMultipleEntitySets()&&this.baseContextPath!==`/${this.manifestWrapper.getEntitySet()}`?`${this.baseContextPath}/${e}`:e;return this.manifestWrapper.getControlConfiguration(n)};n.getAbsoluteAnnotationPath=function t(e){if(!e){return e}if(e[0]==="/"){return e}return`${this.baseContextPath}/${e}`};n.getEntitySet=function t(){return this.targetDataModelPath.targetEntitySet};n.getContextPath=function t(){return this.baseContextPath};n.getDataModelObjectPath=function t(){return this.targetDataModelPath};n.getEntityContainer=function t(){return this.convertedTypes.entityContainer};n.getEntityType=function t(){return this.targetDataModelPath.targetEntityType};n.getParameterEntityType=function t(){var e,n;const i=this.targetDataModelPath.startingEntitySet.entityType;const a=!!((e=i.annotations)!==null&&e!==void 0&&(n=e.Common)!==null&&n!==void 0&&n.ResultContext);return a&&i};n.getEntityTypeAnnotation=function t(n){if(!n.includes("@")){throw new Error(`Not an annotation path: '${n}'`)}const i=n.startsWith("/");let a;if(i){a=n}else{const t=this.getContextPath().split("@",1)[0];a=t.endsWith("/")?t+n:`${t}/${n}`}const r=this.resolveAbsolutePath(a);const s=o({target:r.target,visitedObjects:r.objectPath},this.convertedTypes,i?undefined:this.targetDataModelPath.contextLocation,true);return{annotation:r.target,converterContext:new e(this.convertedTypes,this.manifestSettings,this.diagnostics,this.mergeFn,s)}};n.getTemplateType=function t(){return this.manifestWrapper.getTemplateType()};n.getConvertedTypes=function t(){return this.convertedTypes};n.getRelativeAnnotationPath=function t(e,n){return e.replace(n.fullyQualifiedName,"")};n.getEntitySetBasedAnnotationPath=function t(e){if(!e){return e}const n=this.targetDataModelPath.targetEntityType.fullyQualifiedName;if(this.targetDataModelPath.targetEntitySet||(this.baseContextPath.startsWith("/")&&this.baseContextPath.match(/\//g)||[]).length>1){let t=e.replace(n,"/");if(t.length>2&&t[0]==="/"&&t[1]==="/"){t=t.substr(1)}return this.baseContextPath+(t.startsWith("/")?t:`/${t}`)}else{return`/${e}`}};n.getManifestWrapper=function t(){return this.manifestWrapper};n.getDiagnostics=function t(){return this.diagnostics};n.resolveAbsolutePath=function t(e){return this.convertedTypes.resolvePath(e)};n.getConverterContextFor=function t(n){const i=this.convertedTypes.resolvePath(n);const a=l(i,this.convertedTypes);return new e(this.convertedTypes,this.manifestSettings,this.diagnostics,this.mergeFn,a)};n.getAnnotationsByTerm=function t(e,n){let i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[this.getEntityType()];let a=[];i.forEach(t=>{if(t){const i=(t===null||t===void 0?void 0:t.annotations[e])||{};if(i){a=Object.keys(i).filter(t=>i[t].term===n).reduce((t,e)=>{t.push(i[e]);return t},a)}}});return a};n.getRelativeModelPathFunction=function t(){const e=this.targetDataModelPath;return function(t){const n=r(e,t);return a(n,true)}};e.createConverterContextForMacro=function t(n,i,a,r,o){let u=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};const h=i.isA("sap.ui.model.odata.v4.ODataMetaModel")?i:i.getModel();const l=s(h);let c=l.entitySets.find(t=>t.name===n);if(!c){c=l.singletons.find(t=>t.name===n)}if(!o||c!==o.startingEntitySet){o={startingEntitySet:c,navigationProperties:[],targetEntitySet:c,targetEntityType:c.entityType,targetObject:c,convertedTypes:l}}return new e(l,u,a,r,o)};return e}();return c},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/ManifestSettings-dbg", [], function () {
  "use strict";

  var _exports = {};
  // ENUMS
  let TemplateType;
  (function (TemplateType) {
    TemplateType["ListReport"] = "ListReport";
    TemplateType["ObjectPage"] = "ObjectPage";
    TemplateType["AnalyticalListPage"] = "AnalyticalListPage";
  })(TemplateType || (TemplateType = {}));
  _exports.TemplateType = TemplateType;
  let ActionType;
  (function (ActionType) {
    ActionType["DataFieldForAction"] = "ForAction";
    ActionType["DataFieldForIntentBasedNavigation"] = "ForNavigation";
    ActionType["Default"] = "Default";
    ActionType["Primary"] = "Primary";
    ActionType["Secondary"] = "Secondary";
    ActionType["SwitchToActiveObject"] = "SwitchToActiveObject";
    ActionType["SwitchToDraftObject"] = "SwitchToDraftObject";
    ActionType["DraftActions"] = "DraftActions";
    ActionType["CollaborationAvatars"] = "CollaborationAvatars";
    ActionType["DefaultApply"] = "DefaultApply";
    ActionType["Menu"] = "Menu";
    ActionType["ShowFormDetails"] = "ShowFormDetails";
    ActionType["Copy"] = "Copy";
  })(ActionType || (ActionType = {}));
  _exports.ActionType = ActionType;
  let SelectionMode;
  (function (SelectionMode) {
    SelectionMode["Auto"] = "Auto";
    SelectionMode["None"] = "None";
    SelectionMode["Multi"] = "Multi";
    SelectionMode["Single"] = "Single";
  })(SelectionMode || (SelectionMode = {}));
  _exports.SelectionMode = SelectionMode;
  let VariantManagementType;
  (function (VariantManagementType) {
    VariantManagementType["Page"] = "Page";
    VariantManagementType["Control"] = "Control";
    VariantManagementType["None"] = "None";
  })(VariantManagementType || (VariantManagementType = {}));
  _exports.VariantManagementType = VariantManagementType;
  let CreationMode;
  (function (CreationMode) {
    CreationMode["NewPage"] = "NewPage";
    CreationMode["Inline"] = "Inline";
    CreationMode["CreationRow"] = "CreationRow";
    CreationMode["InlineCreationRows"] = "InlineCreationRows";
    CreationMode["External"] = "External";
  })(CreationMode || (CreationMode = {}));
  _exports.CreationMode = CreationMode;
  let VisualizationType; // Table
  (function (VisualizationType) {
    VisualizationType["Table"] = "Table";
    VisualizationType["Chart"] = "Chart";
  })(VisualizationType || (VisualizationType = {}));
  _exports.VisualizationType = VisualizationType;
  let AvailabilityType;
  (function (AvailabilityType) {
    AvailabilityType["Default"] = "Default";
    AvailabilityType["Adaptation"] = "Adaptation";
    AvailabilityType["Hidden"] = "Hidden";
  })(AvailabilityType || (AvailabilityType = {}));
  _exports.AvailabilityType = AvailabilityType;
  let Importance;
  (function (Importance) {
    Importance["High"] = "High";
    Importance["Medium"] = "Medium";
    Importance["Low"] = "Low";
    Importance["None"] = "None";
  })(Importance || (Importance = {}));
  _exports.Importance = Importance;
  let HorizontalAlign; // TYPES
  (function (HorizontalAlign) {
    HorizontalAlign["End"] = "End";
    HorizontalAlign["Begin"] = "Begin";
    HorizontalAlign["Center"] = "Center";
  })(HorizontalAlign || (HorizontalAlign = {}));
  _exports.HorizontalAlign = HorizontalAlign;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/ManifestSettings", [],function(){"use strict";var t={};let e;(function(t){t["ListReport"]="ListReport";t["ObjectPage"]="ObjectPage";t["AnalyticalListPage"]="AnalyticalListPage"})(e||(e={}));t.TemplateType=e;let n;(function(t){t["DataFieldForAction"]="ForAction";t["DataFieldForIntentBasedNavigation"]="ForNavigation";t["Default"]="Default";t["Primary"]="Primary";t["Secondary"]="Secondary";t["SwitchToActiveObject"]="SwitchToActiveObject";t["SwitchToDraftObject"]="SwitchToDraftObject";t["DraftActions"]="DraftActions";t["CollaborationAvatars"]="CollaborationAvatars";t["DefaultApply"]="DefaultApply";t["Menu"]="Menu";t["ShowFormDetails"]="ShowFormDetails";t["Copy"]="Copy"})(n||(n={}));t.ActionType=n;let i;(function(t){t["Auto"]="Auto";t["None"]="None";t["Multi"]="Multi";t["Single"]="Single"})(i||(i={}));t.SelectionMode=i;let a;(function(t){t["Page"]="Page";t["Control"]="Control";t["None"]="None"})(a||(a={}));t.VariantManagementType=a;let o;(function(t){t["NewPage"]="NewPage";t["Inline"]="Inline";t["CreationRow"]="CreationRow";t["InlineCreationRows"]="InlineCreationRows";t["External"]="External"})(o||(o={}));t.CreationMode=o;let l;(function(t){t["Table"]="Table";t["Chart"]="Chart"})(l||(l={}));t.VisualizationType=l;let r;(function(t){t["Default"]="Default";t["Adaptation"]="Adaptation";t["Hidden"]="Hidden"})(r||(r={}));t.AvailabilityType=r;let c;(function(t){t["High"]="High";t["Medium"]="Medium";t["Low"]="Low";t["None"]="None"})(c||(c={}));t.Importance=c;let u;(function(t){t["End"]="End";t["Begin"]="Begin";t["Center"]="Center"})(u||(u={}));t.HorizontalAlign=u;return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/ManifestWrapper-dbg", ["sap/fe/core/converters/ManifestSettings"], function (ManifestSettings) {
  "use strict";

  var VariantManagementType = ManifestSettings.VariantManagementType;
  function ensureAnnotationPath(obj, property) {
    const propertyValue = obj === null || obj === void 0 ? void 0 : obj[property];
    if (Array.isArray(propertyValue)) {
      propertyValue.forEach(entry => ensureAnnotationPath(entry, "annotationPath"));
    } else if (propertyValue && !propertyValue.includes("@")) {
      obj[property] = "@" + propertyValue;
    }
  }

  /**
   *
   */
  let ManifestWrapper = /*#__PURE__*/function () {
    /**
     * Creates a wrapper object to ensure the data returned from the manifest is consistent and everything is merged correctly.
     *
     * @param oManifestSettings The manifest settings for the current page
     * @param mergeFn A function that will be used to perform the merge
     * @returns The manifest wrapper object
     */
    function ManifestWrapper(oManifestSettings, mergeFn) {
      var _views;
      this.oManifestSettings = oManifestSettings;
      this.mergeFn = mergeFn;
      // Ensure that properties which are meant to contain an *annotation* path contain a '@'
      ensureAnnotationPath(this.oManifestSettings, "defaultTemplateAnnotationPath");
      (_views = this.oManifestSettings.views) === null || _views === void 0 ? void 0 : _views.paths.forEach(path => {
        ensureAnnotationPath(path, "annotationPath");
        ensureAnnotationPath(path, "primary");
        ensureAnnotationPath(path, "secondary");
      });
      if (this.oManifestSettings.controlConfiguration) {
        for (const controlConfiguration of Object.values(this.oManifestSettings.controlConfiguration)) {
          var _tableSettings;
          const quickVariantSelection = (_tableSettings = controlConfiguration.tableSettings) === null || _tableSettings === void 0 ? void 0 : _tableSettings.quickVariantSelection;
          ensureAnnotationPath(quickVariantSelection, "paths");
        }
      }
    }

    /**
     * Returns the current template type.
     *
     * @returns The type of the current template
     */
    var _proto = ManifestWrapper.prototype;
    _proto.getTemplateType = function getTemplateType() {
      return this.oManifestSettings.converterType;
    }

    /**
     * Checks whether the current template should display the filter bar.
     *
     * @returns `true` if the filter bar should be hidden
     */;
    _proto.isFilterBarHidden = function isFilterBarHidden() {
      var _this$oManifestSettin;
      return !!((_this$oManifestSettin = this.oManifestSettings) !== null && _this$oManifestSettin !== void 0 && _this$oManifestSettin.hideFilterBar);
    };
    _proto.useHiddenFilterBar = function useHiddenFilterBar() {
      var _this$oManifestSettin2;
      return !!((_this$oManifestSettin2 = this.oManifestSettings) !== null && _this$oManifestSettin2 !== void 0 && _this$oManifestSettin2.useHiddenFilterBar);
    }

    /**
     * Checks whether the current environment is a desktop or not.
     *
     * @returns `true` if we are on a desktop
     */;
    _proto.isDesktop = function isDesktop() {
      return !!this.oManifestSettings.isDesktop;
    }

    /**
     * Checks whether the current environment is a mobile phone or not.
     *
     * @returns `true` if we are on a mobile phone
     */;
    _proto.isPhone = function isPhone() {
      return !!this.oManifestSettings.isPhone;
    }

    /**
     * Retrieves the form containers (field groups or identification) defined in the manifest.
     *
     * @param facetTarget The target annotation path for this form
     * @returns A set of form containers defined in the manifest indexed by an iterable key
     */;
    _proto.getFormContainer = function getFormContainer(facetTarget) {
      var _this$oManifestSettin3;
      return (_this$oManifestSettin3 = this.oManifestSettings.controlConfiguration) === null || _this$oManifestSettin3 === void 0 ? void 0 : _this$oManifestSettin3[facetTarget];
    }
    /**
     * Retrieves the header facets defined in the manifest.
     *
     * @returns A set of header facets defined in the manifest indexed by an iterable key
     */;
    _proto.getHeaderFacets = function getHeaderFacets() {
      var _this$oManifestSettin4, _this$oManifestSettin5, _content, _content$header;
      return this.mergeFn({}, (_this$oManifestSettin4 = this.oManifestSettings.controlConfiguration) === null || _this$oManifestSettin4 === void 0 ? void 0 : (_this$oManifestSettin5 = _this$oManifestSettin4["@com.sap.vocabularies.UI.v1.HeaderFacets"]) === null || _this$oManifestSettin5 === void 0 ? void 0 : _this$oManifestSettin5.facets, (_content = this.oManifestSettings.content) === null || _content === void 0 ? void 0 : (_content$header = _content.header) === null || _content$header === void 0 ? void 0 : _content$header.facets);
    }
    /**
     * Retrieves the header actions defined in the manifest.
     *
     * @returns A set of actions defined in the manifest indexed by an iterable key
     */;
    _proto.getHeaderActions = function getHeaderActions() {
      var _this$oManifestSettin6, _this$oManifestSettin7;
      return ((_this$oManifestSettin6 = this.oManifestSettings.content) === null || _this$oManifestSettin6 === void 0 ? void 0 : (_this$oManifestSettin7 = _this$oManifestSettin6.header) === null || _this$oManifestSettin7 === void 0 ? void 0 : _this$oManifestSettin7.actions) || {};
    }
    /**
     * Retrieves the footer actions defined in the manifest.
     *
     * @returns A set of actions defined in the manifest indexed by an iterable key
     */;
    _proto.getFooterActions = function getFooterActions() {
      var _this$oManifestSettin8, _this$oManifestSettin9;
      return ((_this$oManifestSettin8 = this.oManifestSettings.content) === null || _this$oManifestSettin8 === void 0 ? void 0 : (_this$oManifestSettin9 = _this$oManifestSettin8.footer) === null || _this$oManifestSettin9 === void 0 ? void 0 : _this$oManifestSettin9.actions) || {};
    }

    /**
     * Retrieves the variant management as defined in the manifest.
     *
     * @returns A type of variant management
     */;
    _proto.getVariantManagement = function getVariantManagement() {
      return this.oManifestSettings.variantManagement || VariantManagementType.None;
    }

    /**
     * Retrieves the annotation Path for the SPV in the manifest.
     *
     * @returns The annotation path for the default SPV or undefined.
     */;
    _proto.getDefaultTemplateAnnotationPath = function getDefaultTemplateAnnotationPath() {
      return this.oManifestSettings.defaultTemplateAnnotationPath;
    }

    /**
     * Retrieves the control configuration as defined in the manifest for a specific annotation path.
     *
     * @param sAnnotationPath The relative annotation path
     * @private
     * @returns The control configuration
     */;
    _proto.getControlConfiguration = function getControlConfiguration(sAnnotationPath) {
      var _this$oManifestSettin10, _this$oManifestSettin11;
      return ((_this$oManifestSettin10 = this.oManifestSettings) === null || _this$oManifestSettin10 === void 0 ? void 0 : (_this$oManifestSettin11 = _this$oManifestSettin10.controlConfiguration) === null || _this$oManifestSettin11 === void 0 ? void 0 : _this$oManifestSettin11[sAnnotationPath]) || {};
    }
    /**
     * Retrieves the configured settings for a given navigation target.
     *
     * @param navigationOrCollectionName The name of the navigation to check
     * @returns The navigation settings configuration
     */;
    _proto.getNavigationConfiguration = function getNavigationConfiguration(navigationOrCollectionName) {
      var _this$oManifestSettin12, _this$oManifestSettin13;
      return ((_this$oManifestSettin12 = this.oManifestSettings) === null || _this$oManifestSettin12 === void 0 ? void 0 : (_this$oManifestSettin13 = _this$oManifestSettin12.navigation) === null || _this$oManifestSettin13 === void 0 ? void 0 : _this$oManifestSettin13[navigationOrCollectionName]) || {};
    }

    /**
     * Retrieves the view level.
     *
     * @returns The current view level
     */;
    _proto.getViewLevel = function getViewLevel() {
      var _this$oManifestSettin14;
      return ((_this$oManifestSettin14 = this.oManifestSettings) === null || _this$oManifestSettin14 === void 0 ? void 0 : _this$oManifestSettin14.viewLevel) || -1;
    }

    /**
     * Retrieves the contentDensities setting of the application.
     *
     * @returns The current content density
     */;
    _proto.getContentDensities = function getContentDensities() {
      var _this$oManifestSettin15;
      return ((_this$oManifestSettin15 = this.oManifestSettings) === null || _this$oManifestSettin15 === void 0 ? void 0 : _this$oManifestSettin15.contentDensities) || {
        cozy: false,
        compact: false
      };
    }

    /**
     * Checks whether we are in FCL mode or not.
     *
     * @returns `true` if we are in FCL
     */;
    _proto.isFclEnabled = function isFclEnabled() {
      var _this$oManifestSettin16;
      return !!((_this$oManifestSettin16 = this.oManifestSettings) !== null && _this$oManifestSettin16 !== void 0 && _this$oManifestSettin16.fclEnabled);
    }

    /**
     * Checks whether the current settings (application / shell) allows us to use condensed layout.
     *
     * @returns `true` if we can use the condensed layout, false otherwise
     */;
    _proto.isCondensedLayoutCompliant = function isCondensedLayoutCompliant() {
      var _this$oManifestSettin17, _this$oManifestSettin18;
      const manifestContentDensity = ((_this$oManifestSettin17 = this.oManifestSettings) === null || _this$oManifestSettin17 === void 0 ? void 0 : _this$oManifestSettin17.contentDensities) || {
        cozy: false,
        compact: false
      };
      const shellContentDensity = ((_this$oManifestSettin18 = this.oManifestSettings) === null || _this$oManifestSettin18 === void 0 ? void 0 : _this$oManifestSettin18.shellContentDensity) || "compact";
      let isCondensedLayoutCompliant = true;
      if ((manifestContentDensity === null || manifestContentDensity === void 0 ? void 0 : manifestContentDensity.cozy) === true && (manifestContentDensity === null || manifestContentDensity === void 0 ? void 0 : manifestContentDensity.compact) !== true || shellContentDensity === "cozy") {
        isCondensedLayoutCompliant = false;
      }
      return isCondensedLayoutCompliant;
    }
    /**
     * Checks whether the current settings (application / shell) uses compact mode as content density.
     *
     * @returns `true` if compact mode is set as content density, false otherwise
     */;
    _proto.isCompactType = function isCompactType() {
      var _this$oManifestSettin19;
      const manifestContentDensity = this.getContentDensities();
      const shellContentDensity = ((_this$oManifestSettin19 = this.oManifestSettings) === null || _this$oManifestSettin19 === void 0 ? void 0 : _this$oManifestSettin19.shellContentDensity) || "compact";
      return manifestContentDensity.compact !== false || shellContentDensity === "compact" ? true : false;
    }

    //region OP Specific

    /**
     * Retrieves the section layout defined in the manifest.
     *
     * @returns The type of section layout of the object page
     */;
    _proto.getSectionLayout = function getSectionLayout() {
      return this.oManifestSettings.sectionLayout;
    }

    /**
     * Retrieves the sections defined in the manifest.
     *
     * @returns A set of manifest sections indexed by an iterable key
     */;
    _proto.getSections = function getSections() {
      var _this$oManifestSettin20, _this$oManifestSettin21, _content2, _content2$body;
      return this.mergeFn({}, (_this$oManifestSettin20 = this.oManifestSettings.controlConfiguration) === null || _this$oManifestSettin20 === void 0 ? void 0 : (_this$oManifestSettin21 = _this$oManifestSettin20["@com.sap.vocabularies.UI.v1.Facets"]) === null || _this$oManifestSettin21 === void 0 ? void 0 : _this$oManifestSettin21.sections, (_content2 = this.oManifestSettings.content) === null || _content2 === void 0 ? void 0 : (_content2$body = _content2.body) === null || _content2$body === void 0 ? void 0 : _content2$body.sections);
    }

    /**
     * Returns true of the header of the application is editable and should appear in the facets.
     *
     * @returns `true` if the header if editable
     */;
    _proto.isHeaderEditable = function isHeaderEditable() {
      return this.getShowObjectPageHeader() && this.oManifestSettings.editableHeaderContent;
    }
    /**
     * Returns true if we should show the object page header.
     *
     * @returns `true` if the header should be displayed
     */;
    _proto.getShowAnchorBar = function getShowAnchorBar() {
      var _content3, _content3$header, _content4, _content4$header;
      return ((_content3 = this.oManifestSettings.content) === null || _content3 === void 0 ? void 0 : (_content3$header = _content3.header) === null || _content3$header === void 0 ? void 0 : _content3$header.anchorBarVisible) !== undefined ? !!((_content4 = this.oManifestSettings.content) !== null && _content4 !== void 0 && (_content4$header = _content4.header) !== null && _content4$header !== void 0 && _content4$header.anchorBarVisible) : true;
    }

    /**
     * Defines whether or not the section will be displayed in different tabs.
     *
     * @returns `true` if the icon tab bar should be used instead of scrolling
     */;
    _proto.useIconTabBar = function useIconTabBar() {
      return this.getShowAnchorBar() && this.oManifestSettings.sectionLayout === "Tabs";
    }

    /**
     * Returns true if the object page header is to be shown.
     *
     * @returns `true` if the object page header is to be displayed
     */;
    _proto.getShowObjectPageHeader = function getShowObjectPageHeader() {
      var _content5, _content5$header, _content6, _content6$header;
      return ((_content5 = this.oManifestSettings.content) === null || _content5 === void 0 ? void 0 : (_content5$header = _content5.header) === null || _content5$header === void 0 ? void 0 : _content5$header.visible) !== undefined ? !!((_content6 = this.oManifestSettings.content) !== null && _content6 !== void 0 && (_content6$header = _content6.header) !== null && _content6$header !== void 0 && _content6$header.visible) : true;
    }

    //endregion OP Specific

    //region LR Specific

    /**
     * Retrieves the multiple view configuration from the manifest.
     *
     * @returns The views that represent the manifest object
     */;
    _proto.getViewConfiguration = function getViewConfiguration() {
      return this.oManifestSettings.views;
    }

    /**
     * Retrieves the stickyMultiTabHeader configuration from the manifest.
     *
     * @returns Returns True if stickyMultiTabHeader is enabled or undefined
     */;
    _proto.getStickyMultiTabHeaderConfiguration = function getStickyMultiTabHeaderConfiguration() {
      const bStickyMultiTabHeader = this.oManifestSettings.stickyMultiTabHeader;
      return bStickyMultiTabHeader !== undefined ? bStickyMultiTabHeader : true;
    }

    /**
     * Retrieves the KPI configuration from the manifest.
     *
     * @returns Returns a map between KPI names and their respective configuration
     */;
    _proto.getKPIConfiguration = function getKPIConfiguration() {
      return this.oManifestSettings.keyPerformanceIndicators || {};
    }

    /**
     * Retrieves the filter configuration from the manifest.
     *
     * @returns The filter configuration from the manifest
     */;
    _proto.getFilterConfiguration = function getFilterConfiguration() {
      return this.getControlConfiguration("@com.sap.vocabularies.UI.v1.SelectionFields");
    }
    /**
     * Returns true if there are multiple entity sets to be displayed.
     *
     * @returns `true` if there are multiple entity sets
     */;
    _proto.hasMultipleEntitySets = function hasMultipleEntitySets() {
      const viewConfig = this.getViewConfiguration() || {
        paths: []
      };
      const manifestEntitySet = this.oManifestSettings.entitySet;
      return viewConfig.paths.find(path => {
        var _path;
        if ((_path = path) !== null && _path !== void 0 && _path.template) {
          return undefined;
        } else if (this.hasMultipleVisualizations(path)) {
          const {
            primary,
            secondary
          } = path;
          return primary.some(primaryPath => primaryPath.entitySet && primaryPath.entitySet !== manifestEntitySet) || secondary.some(secondaryPath => secondaryPath.entitySet && secondaryPath.entitySet !== manifestEntitySet);
        } else {
          path = path;
          return path.entitySet && path.entitySet !== manifestEntitySet;
        }
      }) !== undefined;
    }

    /**
     * Returns the context path for the template if it is specified in the manifest.
     *
     * @returns The context path for the template
     */;
    _proto.getContextPath = function getContextPath() {
      var _this$oManifestSettin22;
      return (_this$oManifestSettin22 = this.oManifestSettings) === null || _this$oManifestSettin22 === void 0 ? void 0 : _this$oManifestSettin22.contextPath;
    }

    /**
     * Returns true if there are multiple visualizations.
     *
     * @param path The path from the view
     * @returns `true` if there are multiple visualizations
     */;
    _proto.hasMultipleVisualizations = function hasMultipleVisualizations(path) {
      var _primary2, _secondary2;
      if (!path) {
        const viewConfig = this.getViewConfiguration() || {
          paths: []
        };
        return viewConfig.paths.some(viewPath => {
          var _primary, _secondary;
          return ((_primary = viewPath.primary) === null || _primary === void 0 ? void 0 : _primary.length) > 0 && ((_secondary = viewPath.secondary) === null || _secondary === void 0 ? void 0 : _secondary.length) > 0;
        });
      }
      return ((_primary2 = path.primary) === null || _primary2 === void 0 ? void 0 : _primary2.length) > 0 && ((_secondary2 = path.secondary) === null || _secondary2 === void 0 ? void 0 : _secondary2.length) > 0;
    }

    /**
     * Retrieves the entity set defined in the manifest.
     *
     * @returns The entity set defined in the manifest
     */;
    _proto.getEntitySet = function getEntitySet() {
      return this.oManifestSettings.entitySet;
    }

    //end region LR Specific
    ;
    return ManifestWrapper;
  }();
  return ManifestWrapper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/ManifestWrapper", ["sap/fe/core/converters/ManifestSettings"],function(t){"use strict";var n=t.VariantManagementType;function i(t,n){const e=t===null||t===void 0?void 0:t[n];if(Array.isArray(e)){e.forEach(t=>i(t,"annotationPath"))}else if(e&&!e.includes("@")){t[n]="@"+e}}let e=function(){function t(t,n){var e;this.oManifestSettings=t;this.mergeFn=n;i(this.oManifestSettings,"defaultTemplateAnnotationPath");(e=this.oManifestSettings.views)===null||e===void 0?void 0:e.paths.forEach(t=>{i(t,"annotationPath");i(t,"primary");i(t,"secondary")});if(this.oManifestSettings.controlConfiguration){for(const t of Object.values(this.oManifestSettings.controlConfiguration)){var o;const n=(o=t.tableSettings)===null||o===void 0?void 0:o.quickVariantSelection;i(n,"paths")}}}var e=t.prototype;e.getTemplateType=function t(){return this.oManifestSettings.converterType};e.isFilterBarHidden=function t(){var n;return!!((n=this.oManifestSettings)!==null&&n!==void 0&&n.hideFilterBar)};e.useHiddenFilterBar=function t(){var n;return!!((n=this.oManifestSettings)!==null&&n!==void 0&&n.useHiddenFilterBar)};e.isDesktop=function t(){return!!this.oManifestSettings.isDesktop};e.isPhone=function t(){return!!this.oManifestSettings.isPhone};e.getFormContainer=function t(n){var i;return(i=this.oManifestSettings.controlConfiguration)===null||i===void 0?void 0:i[n]};e.getHeaderFacets=function t(){var n,i,e,o;return this.mergeFn({},(n=this.oManifestSettings.controlConfiguration)===null||n===void 0?void 0:(i=n["@com.sap.vocabularies.UI.v1.HeaderFacets"])===null||i===void 0?void 0:i.facets,(e=this.oManifestSettings.content)===null||e===void 0?void 0:(o=e.header)===null||o===void 0?void 0:o.facets)};e.getHeaderActions=function t(){var n,i;return((n=this.oManifestSettings.content)===null||n===void 0?void 0:(i=n.header)===null||i===void 0?void 0:i.actions)||{}};e.getFooterActions=function t(){var n,i;return((n=this.oManifestSettings.content)===null||n===void 0?void 0:(i=n.footer)===null||i===void 0?void 0:i.actions)||{}};e.getVariantManagement=function t(){return this.oManifestSettings.variantManagement||n.None};e.getDefaultTemplateAnnotationPath=function t(){return this.oManifestSettings.defaultTemplateAnnotationPath};e.getControlConfiguration=function t(n){var i,e;return((i=this.oManifestSettings)===null||i===void 0?void 0:(e=i.controlConfiguration)===null||e===void 0?void 0:e[n])||{}};e.getNavigationConfiguration=function t(n){var i,e;return((i=this.oManifestSettings)===null||i===void 0?void 0:(e=i.navigation)===null||e===void 0?void 0:e[n])||{}};e.getViewLevel=function t(){var n;return((n=this.oManifestSettings)===null||n===void 0?void 0:n.viewLevel)||-1};e.getContentDensities=function t(){var n;return((n=this.oManifestSettings)===null||n===void 0?void 0:n.contentDensities)||{cozy:false,compact:false}};e.isFclEnabled=function t(){var n;return!!((n=this.oManifestSettings)!==null&&n!==void 0&&n.fclEnabled)};e.isCondensedLayoutCompliant=function t(){var n,i;const e=((n=this.oManifestSettings)===null||n===void 0?void 0:n.contentDensities)||{cozy:false,compact:false};const o=((i=this.oManifestSettings)===null||i===void 0?void 0:i.shellContentDensity)||"compact";let t=true;if((e===null||e===void 0?void 0:e.cozy)===true&&(e===null||e===void 0?void 0:e.compact)!==true||o==="cozy"){t=false}return t};e.isCompactType=function t(){var n;const i=this.getContentDensities();const e=((n=this.oManifestSettings)===null||n===void 0?void 0:n.shellContentDensity)||"compact";return i.compact!==false||e==="compact"?true:false};e.getSectionLayout=function t(){return this.oManifestSettings.sectionLayout};e.getSections=function t(){var n,i,e,o;return this.mergeFn({},(n=this.oManifestSettings.controlConfiguration)===null||n===void 0?void 0:(i=n["@com.sap.vocabularies.UI.v1.Facets"])===null||i===void 0?void 0:i.sections,(e=this.oManifestSettings.content)===null||e===void 0?void 0:(o=e.body)===null||o===void 0?void 0:o.sections)};e.isHeaderEditable=function t(){return this.getShowObjectPageHeader()&&this.oManifestSettings.editableHeaderContent};e.getShowAnchorBar=function t(){var n,i,e,o;return((n=this.oManifestSettings.content)===null||n===void 0?void 0:(i=n.header)===null||i===void 0?void 0:i.anchorBarVisible)!==undefined?!!((e=this.oManifestSettings.content)!==null&&e!==void 0&&(o=e.header)!==null&&o!==void 0&&o.anchorBarVisible):true};e.useIconTabBar=function t(){return this.getShowAnchorBar()&&this.oManifestSettings.sectionLayout==="Tabs"};e.getShowObjectPageHeader=function t(){var n,i,e,o;return((n=this.oManifestSettings.content)===null||n===void 0?void 0:(i=n.header)===null||i===void 0?void 0:i.visible)!==undefined?!!((e=this.oManifestSettings.content)!==null&&e!==void 0&&(o=e.header)!==null&&o!==void 0&&o.visible):true};e.getViewConfiguration=function t(){return this.oManifestSettings.views};e.getStickyMultiTabHeaderConfiguration=function t(){const n=this.oManifestSettings.stickyMultiTabHeader;return n!==undefined?n:true};e.getKPIConfiguration=function t(){return this.oManifestSettings.keyPerformanceIndicators||{}};e.getFilterConfiguration=function t(){return this.getControlConfiguration("@com.sap.vocabularies.UI.v1.SelectionFields")};e.hasMultipleEntitySets=function t(){const n=this.getViewConfiguration()||{paths:[]};const i=this.oManifestSettings.entitySet;return n.paths.find(t=>{var n;if((n=t)!==null&&n!==void 0&&n.template){return undefined}else if(this.hasMultipleVisualizations(t)){const{primary:n,secondary:e}=t;return n.some(t=>t.entitySet&&t.entitySet!==i)||e.some(t=>t.entitySet&&t.entitySet!==i)}else{t=t;return t.entitySet&&t.entitySet!==i}})!==undefined};e.getContextPath=function t(){var n;return(n=this.oManifestSettings)===null||n===void 0?void 0:n.contextPath};e.hasMultipleVisualizations=function t(n){var i,e;if(!n){const t=this.getViewConfiguration()||{paths:[]};return t.paths.some(t=>{var n,i;return((n=t.primary)===null||n===void 0?void 0:n.length)>0&&((i=t.secondary)===null||i===void 0?void 0:i.length)>0})}return((i=n.primary)===null||i===void 0?void 0:i.length)>0&&((e=n.secondary)===null||e===void 0?void 0:e.length)>0};e.getEntitySet=function t(){return this.oManifestSettings.entitySet};return t}();return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/MetaModelConverter-dbg", ["sap/fe/core/converters/common/AnnotationConverter", "../helpers/StableIdHelper"], function (AnnotationConverter, StableIdHelper) {
  "use strict";

  var _exports = {};
  var prepareId = StableIdHelper.prepareId;
  const VOCABULARY_ALIAS = {
    "Org.OData.Capabilities.V1": "Capabilities",
    "Org.OData.Core.V1": "Core",
    "Org.OData.Measures.V1": "Measures",
    "com.sap.vocabularies.Common.v1": "Common",
    "com.sap.vocabularies.UI.v1": "UI",
    "com.sap.vocabularies.Session.v1": "Session",
    "com.sap.vocabularies.Analytics.v1": "Analytics",
    "com.sap.vocabularies.PersonalData.v1": "PersonalData",
    "com.sap.vocabularies.Communication.v1": "Communication"
  };
  const DefaultEnvironmentCapabilities = {
    Chart: true,
    MicroChart: true,
    UShell: true,
    IntentBasedNavigation: true,
    AppState: true
  };
  _exports.DefaultEnvironmentCapabilities = DefaultEnvironmentCapabilities;
  function parsePropertyValue(annotationObject, propertyKey, currentTarget, annotationsLists, oCapabilities) {
    let value;
    const currentPropertyTarget = `${currentTarget}/${propertyKey}`;
    const typeOfAnnotation = typeof annotationObject;
    if (annotationObject === null) {
      value = {
        type: "Null",
        Null: null
      };
    } else if (typeOfAnnotation === "string") {
      value = {
        type: "String",
        String: annotationObject
      };
    } else if (typeOfAnnotation === "boolean") {
      value = {
        type: "Bool",
        Bool: annotationObject
      };
    } else if (typeOfAnnotation === "number") {
      value = {
        type: "Int",
        Int: annotationObject
      };
    } else if (Array.isArray(annotationObject)) {
      value = {
        type: "Collection",
        Collection: annotationObject.map((subAnnotationObject, subAnnotationObjectIndex) => parseAnnotationObject(subAnnotationObject, `${currentPropertyTarget}/${subAnnotationObjectIndex}`, annotationsLists, oCapabilities))
      };
      if (annotationObject.length > 0) {
        if (annotationObject[0].hasOwnProperty("$PropertyPath")) {
          value.Collection.type = "PropertyPath";
        } else if (annotationObject[0].hasOwnProperty("$Path")) {
          value.Collection.type = "Path";
        } else if (annotationObject[0].hasOwnProperty("$NavigationPropertyPath")) {
          value.Collection.type = "NavigationPropertyPath";
        } else if (annotationObject[0].hasOwnProperty("$AnnotationPath")) {
          value.Collection.type = "AnnotationPath";
        } else if (annotationObject[0].hasOwnProperty("$Type")) {
          value.Collection.type = "Record";
        } else if (annotationObject[0].hasOwnProperty("$If")) {
          value.Collection.type = "If";
        } else if (annotationObject[0].hasOwnProperty("$Or")) {
          value.Collection.type = "Or";
        } else if (annotationObject[0].hasOwnProperty("$And")) {
          value.Collection.type = "And";
        } else if (annotationObject[0].hasOwnProperty("$Eq")) {
          value.Collection.type = "Eq";
        } else if (annotationObject[0].hasOwnProperty("$Ne")) {
          value.Collection.type = "Ne";
        } else if (annotationObject[0].hasOwnProperty("$Not")) {
          value.Collection.type = "Not";
        } else if (annotationObject[0].hasOwnProperty("$Gt")) {
          value.Collection.type = "Gt";
        } else if (annotationObject[0].hasOwnProperty("$Ge")) {
          value.Collection.type = "Ge";
        } else if (annotationObject[0].hasOwnProperty("$Lt")) {
          value.Collection.type = "Lt";
        } else if (annotationObject[0].hasOwnProperty("$Le")) {
          value.Collection.type = "Le";
        } else if (annotationObject[0].hasOwnProperty("$Apply")) {
          value.Collection.type = "Apply";
        } else if (typeof annotationObject[0] === "object") {
          // $Type is optional...
          value.Collection.type = "Record";
        } else {
          value.Collection.type = "String";
        }
      }
    } else if (annotationObject.$Path !== undefined) {
      value = {
        type: "Path",
        Path: annotationObject.$Path
      };
    } else if (annotationObject.$Decimal !== undefined) {
      value = {
        type: "Decimal",
        Decimal: parseFloat(annotationObject.$Decimal)
      };
    } else if (annotationObject.$PropertyPath !== undefined) {
      value = {
        type: "PropertyPath",
        PropertyPath: annotationObject.$PropertyPath
      };
    } else if (annotationObject.$NavigationPropertyPath !== undefined) {
      value = {
        type: "NavigationPropertyPath",
        NavigationPropertyPath: annotationObject.$NavigationPropertyPath
      };
    } else if (annotationObject.$If !== undefined) {
      value = {
        type: "If",
        If: annotationObject.$If
      };
    } else if (annotationObject.$And !== undefined) {
      value = {
        type: "And",
        And: annotationObject.$And
      };
    } else if (annotationObject.$Or !== undefined) {
      value = {
        type: "Or",
        Or: annotationObject.$Or
      };
    } else if (annotationObject.$Not !== undefined) {
      value = {
        type: "Not",
        Not: annotationObject.$Not
      };
    } else if (annotationObject.$Eq !== undefined) {
      value = {
        type: "Eq",
        Eq: annotationObject.$Eq
      };
    } else if (annotationObject.$Ne !== undefined) {
      value = {
        type: "Ne",
        Ne: annotationObject.$Ne
      };
    } else if (annotationObject.$Gt !== undefined) {
      value = {
        type: "Gt",
        Gt: annotationObject.$Gt
      };
    } else if (annotationObject.$Ge !== undefined) {
      value = {
        type: "Ge",
        Ge: annotationObject.$Ge
      };
    } else if (annotationObject.$Lt !== undefined) {
      value = {
        type: "Lt",
        Lt: annotationObject.$Lt
      };
    } else if (annotationObject.$Le !== undefined) {
      value = {
        type: "Le",
        Le: annotationObject.$Le
      };
    } else if (annotationObject.$Apply !== undefined) {
      value = {
        type: "Apply",
        Apply: annotationObject.$Apply,
        Function: annotationObject.$Function
      };
    } else if (annotationObject.$AnnotationPath !== undefined) {
      value = {
        type: "AnnotationPath",
        AnnotationPath: annotationObject.$AnnotationPath
      };
    } else if (annotationObject.$EnumMember !== undefined) {
      value = {
        type: "EnumMember",
        EnumMember: `${mapNameToAlias(annotationObject.$EnumMember.split("/")[0])}/${annotationObject.$EnumMember.split("/")[1]}`
      };
    } else {
      value = {
        type: "Record",
        Record: parseAnnotationObject(annotationObject, currentTarget, annotationsLists, oCapabilities)
      };
    }
    return {
      name: propertyKey,
      value
    };
  }
  function mapNameToAlias(annotationName) {
    let [pathPart, annoPart] = annotationName.split("@");
    if (!annoPart) {
      annoPart = pathPart;
      pathPart = "";
    } else {
      pathPart += "@";
    }
    const lastDot = annoPart.lastIndexOf(".");
    return `${pathPart + VOCABULARY_ALIAS[annoPart.substr(0, lastDot)]}.${annoPart.substr(lastDot + 1)}`;
  }
  function parseAnnotationObject(annotationObject, currentObjectTarget, annotationsLists, oCapabilities) {
    let parsedAnnotationObject = {};
    const typeOfObject = typeof annotationObject;
    if (annotationObject === null) {
      parsedAnnotationObject = {
        type: "Null",
        Null: null
      };
    } else if (typeOfObject === "string") {
      parsedAnnotationObject = {
        type: "String",
        String: annotationObject
      };
    } else if (typeOfObject === "boolean") {
      parsedAnnotationObject = {
        type: "Bool",
        Bool: annotationObject
      };
    } else if (typeOfObject === "number") {
      parsedAnnotationObject = {
        type: "Int",
        Int: annotationObject
      };
    } else if (annotationObject.$AnnotationPath !== undefined) {
      parsedAnnotationObject = {
        type: "AnnotationPath",
        AnnotationPath: annotationObject.$AnnotationPath
      };
    } else if (annotationObject.$Path !== undefined) {
      parsedAnnotationObject = {
        type: "Path",
        Path: annotationObject.$Path
      };
    } else if (annotationObject.$Decimal !== undefined) {
      parsedAnnotationObject = {
        type: "Decimal",
        Decimal: parseFloat(annotationObject.$Decimal)
      };
    } else if (annotationObject.$PropertyPath !== undefined) {
      parsedAnnotationObject = {
        type: "PropertyPath",
        PropertyPath: annotationObject.$PropertyPath
      };
    } else if (annotationObject.$If !== undefined) {
      parsedAnnotationObject = {
        type: "If",
        If: annotationObject.$If
      };
    } else if (annotationObject.$And !== undefined) {
      parsedAnnotationObject = {
        type: "And",
        And: annotationObject.$And
      };
    } else if (annotationObject.$Or !== undefined) {
      parsedAnnotationObject = {
        type: "Or",
        Or: annotationObject.$Or
      };
    } else if (annotationObject.$Not !== undefined) {
      parsedAnnotationObject = {
        type: "Not",
        Not: annotationObject.$Not
      };
    } else if (annotationObject.$Eq !== undefined) {
      parsedAnnotationObject = {
        type: "Eq",
        Eq: annotationObject.$Eq
      };
    } else if (annotationObject.$Ne !== undefined) {
      parsedAnnotationObject = {
        type: "Ne",
        Ne: annotationObject.$Ne
      };
    } else if (annotationObject.$Gt !== undefined) {
      parsedAnnotationObject = {
        type: "Gt",
        Gt: annotationObject.$Gt
      };
    } else if (annotationObject.$Ge !== undefined) {
      parsedAnnotationObject = {
        type: "Ge",
        Ge: annotationObject.$Ge
      };
    } else if (annotationObject.$Lt !== undefined) {
      parsedAnnotationObject = {
        type: "Lt",
        Lt: annotationObject.$Lt
      };
    } else if (annotationObject.$Le !== undefined) {
      parsedAnnotationObject = {
        type: "Le",
        Le: annotationObject.$Le
      };
    } else if (annotationObject.$Apply !== undefined) {
      parsedAnnotationObject = {
        type: "Apply",
        Apply: annotationObject.$Apply,
        Function: annotationObject.$Function
      };
    } else if (annotationObject.$NavigationPropertyPath !== undefined) {
      parsedAnnotationObject = {
        type: "NavigationPropertyPath",
        NavigationPropertyPath: annotationObject.$NavigationPropertyPath
      };
    } else if (annotationObject.$EnumMember !== undefined) {
      parsedAnnotationObject = {
        type: "EnumMember",
        EnumMember: `${mapNameToAlias(annotationObject.$EnumMember.split("/")[0])}/${annotationObject.$EnumMember.split("/")[1]}`
      };
    } else if (Array.isArray(annotationObject)) {
      const parsedAnnotationCollection = parsedAnnotationObject;
      parsedAnnotationCollection.collection = annotationObject.map((subAnnotationObject, subAnnotationIndex) => parseAnnotationObject(subAnnotationObject, `${currentObjectTarget}/${subAnnotationIndex}`, annotationsLists, oCapabilities));
      if (annotationObject.length > 0) {
        if (annotationObject[0].hasOwnProperty("$PropertyPath")) {
          parsedAnnotationCollection.collection.type = "PropertyPath";
        } else if (annotationObject[0].hasOwnProperty("$Path")) {
          parsedAnnotationCollection.collection.type = "Path";
        } else if (annotationObject[0].hasOwnProperty("$NavigationPropertyPath")) {
          parsedAnnotationCollection.collection.type = "NavigationPropertyPath";
        } else if (annotationObject[0].hasOwnProperty("$AnnotationPath")) {
          parsedAnnotationCollection.collection.type = "AnnotationPath";
        } else if (annotationObject[0].hasOwnProperty("$Type")) {
          parsedAnnotationCollection.collection.type = "Record";
        } else if (annotationObject[0].hasOwnProperty("$If")) {
          parsedAnnotationCollection.collection.type = "If";
        } else if (annotationObject[0].hasOwnProperty("$And")) {
          parsedAnnotationCollection.collection.type = "And";
        } else if (annotationObject[0].hasOwnProperty("$Or")) {
          parsedAnnotationCollection.collection.type = "Or";
        } else if (annotationObject[0].hasOwnProperty("$Eq")) {
          parsedAnnotationCollection.collection.type = "Eq";
        } else if (annotationObject[0].hasOwnProperty("$Ne")) {
          parsedAnnotationCollection.collection.type = "Ne";
        } else if (annotationObject[0].hasOwnProperty("$Not")) {
          parsedAnnotationCollection.collection.type = "Not";
        } else if (annotationObject[0].hasOwnProperty("$Gt")) {
          parsedAnnotationCollection.collection.type = "Gt";
        } else if (annotationObject[0].hasOwnProperty("$Ge")) {
          parsedAnnotationCollection.collection.type = "Ge";
        } else if (annotationObject[0].hasOwnProperty("$Lt")) {
          parsedAnnotationCollection.collection.type = "Lt";
        } else if (annotationObject[0].hasOwnProperty("$Le")) {
          parsedAnnotationCollection.collection.type = "Le";
        } else if (annotationObject[0].hasOwnProperty("$Apply")) {
          parsedAnnotationCollection.collection.type = "Apply";
        } else if (typeof annotationObject[0] === "object") {
          parsedAnnotationCollection.collection.type = "Record";
        } else {
          parsedAnnotationCollection.collection.type = "String";
        }
      }
    } else {
      if (annotationObject.$Type) {
        const typeValue = annotationObject.$Type;
        parsedAnnotationObject.type = typeValue; //`${typeAlias}.${typeTerm}`;
      }

      const propertyValues = [];
      Object.keys(annotationObject).forEach(propertyKey => {
        if (propertyKey !== "$Type" && propertyKey !== "$If" && propertyKey !== "$Apply" && propertyKey !== "$And" && propertyKey !== "$Or" && propertyKey !== "$Ne" && propertyKey !== "$Gt" && propertyKey !== "$Ge" && propertyKey !== "$Lt" && propertyKey !== "$Le" && propertyKey !== "$Not" && propertyKey !== "$Eq" && !propertyKey.startsWith("@")) {
          propertyValues.push(parsePropertyValue(annotationObject[propertyKey], propertyKey, currentObjectTarget, annotationsLists, oCapabilities));
        } else if (propertyKey.startsWith("@")) {
          // Annotation of annotation
          createAnnotationLists({
            [propertyKey]: annotationObject[propertyKey]
          }, currentObjectTarget, annotationsLists, oCapabilities);
        }
      });
      parsedAnnotationObject.propertyValues = propertyValues;
    }
    return parsedAnnotationObject;
  }
  function getOrCreateAnnotationList(target, annotationsLists) {
    if (!annotationsLists.hasOwnProperty(target)) {
      annotationsLists[target] = {
        target: target,
        annotations: []
      };
    }
    return annotationsLists[target];
  }
  function createReferenceFacetId(referenceFacet) {
    const id = referenceFacet.ID ?? referenceFacet.Target.$AnnotationPath;
    return id ? prepareId(id) : id;
  }
  function removeChartAnnotations(annotationObject) {
    return annotationObject.filter(oRecord => {
      if (oRecord.Target && oRecord.Target.$AnnotationPath) {
        return oRecord.Target.$AnnotationPath.indexOf(`@${"com.sap.vocabularies.UI.v1.Chart"}`) === -1;
      } else {
        return true;
      }
    });
  }
  function removeIBNAnnotations(annotationObject) {
    return annotationObject.filter(oRecord => {
      return oRecord.$Type !== "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation";
    });
  }
  function handlePresentationVariant(annotationObject) {
    return annotationObject.filter(oRecord => {
      return oRecord.$AnnotationPath !== `@${"com.sap.vocabularies.UI.v1.Chart"}`;
    });
  }
  function createAnnotationLists(annotationObjects, annotationTarget, annotationLists, oCapabilities) {
    if (Object.keys(annotationObjects).length === 0) {
      return;
    }
    const outAnnotationObject = getOrCreateAnnotationList(annotationTarget, annotationLists);
    if (!oCapabilities.MicroChart) {
      delete annotationObjects[`@${"com.sap.vocabularies.UI.v1.Chart"}`];
    }
    for (let annotationKey in annotationObjects) {
      let annotationObject = annotationObjects[annotationKey];
      switch (annotationKey) {
        case `@${"com.sap.vocabularies.UI.v1.HeaderFacets"}`:
          if (!oCapabilities.MicroChart) {
            annotationObject = removeChartAnnotations(annotationObject);
            annotationObjects[annotationKey] = annotationObject;
          }
          break;
        case `@${"com.sap.vocabularies.UI.v1.Identification"}`:
          if (!oCapabilities.IntentBasedNavigation) {
            annotationObject = removeIBNAnnotations(annotationObject);
            annotationObjects[annotationKey] = annotationObject;
          }
          break;
        case `@${"com.sap.vocabularies.UI.v1.LineItem"}`:
          if (!oCapabilities.IntentBasedNavigation) {
            annotationObject = removeIBNAnnotations(annotationObject);
            annotationObjects[annotationKey] = annotationObject;
          }
          if (!oCapabilities.MicroChart) {
            annotationObject = removeChartAnnotations(annotationObject);
            annotationObjects[annotationKey] = annotationObject;
          }
          break;
        case `@${"com.sap.vocabularies.UI.v1.FieldGroup"}`:
          if (!oCapabilities.IntentBasedNavigation) {
            annotationObject.Data = removeIBNAnnotations(annotationObject.Data);
            annotationObjects[annotationKey] = annotationObject;
          }
          if (!oCapabilities.MicroChart) {
            annotationObject.Data = removeChartAnnotations(annotationObject.Data);
            annotationObjects[annotationKey] = annotationObject;
          }
          break;
        case `@${"com.sap.vocabularies.UI.v1.PresentationVariant"}`:
          if (!oCapabilities.Chart && annotationObject.Visualizations) {
            annotationObject.Visualizations = handlePresentationVariant(annotationObject.Visualizations);
            annotationObjects[annotationKey] = annotationObject;
          }
          break;
        default:
          break;
      }
      let currentOutAnnotationObject = outAnnotationObject;

      // Check for annotation of annotation
      const annotationOfAnnotationSplit = annotationKey.split("@");
      if (annotationOfAnnotationSplit.length > 2) {
        currentOutAnnotationObject = getOrCreateAnnotationList(`${annotationTarget}@${annotationOfAnnotationSplit[1]}`, annotationLists);
        annotationKey = annotationOfAnnotationSplit[2];
      } else {
        annotationKey = annotationOfAnnotationSplit[1];
      }
      const annotationQualifierSplit = annotationKey.split("#");
      const qualifier = annotationQualifierSplit[1];
      annotationKey = annotationQualifierSplit[0];
      const parsedAnnotationObject = {
        term: `${annotationKey}`,
        qualifier: qualifier
      };
      let currentAnnotationTarget = `${annotationTarget}@${parsedAnnotationObject.term}`;
      if (qualifier) {
        currentAnnotationTarget += `#${qualifier}`;
      }
      let isCollection = false;
      const typeofAnnotation = typeof annotationObject;
      if (annotationObject === null) {
        parsedAnnotationObject.value = {
          type: "Bool",
          Bool: annotationObject
        };
      } else if (typeofAnnotation === "string") {
        parsedAnnotationObject.value = {
          type: "String",
          String: annotationObject
        };
      } else if (typeofAnnotation === "boolean") {
        parsedAnnotationObject.value = {
          type: "Bool",
          Bool: annotationObject
        };
      } else if (typeofAnnotation === "number") {
        parsedAnnotationObject.value = {
          type: "Int",
          Int: annotationObject
        };
      } else if (annotationObject.$If !== undefined) {
        parsedAnnotationObject.value = {
          type: "If",
          If: annotationObject.$If
        };
      } else if (annotationObject.$And !== undefined) {
        parsedAnnotationObject.value = {
          type: "And",
          And: annotationObject.$And
        };
      } else if (annotationObject.$Or !== undefined) {
        parsedAnnotationObject.value = {
          type: "Or",
          Or: annotationObject.$Or
        };
      } else if (annotationObject.$Not !== undefined) {
        parsedAnnotationObject.value = {
          type: "Not",
          Not: annotationObject.$Not
        };
      } else if (annotationObject.$Eq !== undefined) {
        parsedAnnotationObject.value = {
          type: "Eq",
          Eq: annotationObject.$Eq
        };
      } else if (annotationObject.$Ne !== undefined) {
        parsedAnnotationObject.value = {
          type: "Ne",
          Ne: annotationObject.$Ne
        };
      } else if (annotationObject.$Gt !== undefined) {
        parsedAnnotationObject.value = {
          type: "Gt",
          Gt: annotationObject.$Gt
        };
      } else if (annotationObject.$Ge !== undefined) {
        parsedAnnotationObject.value = {
          type: "Ge",
          Ge: annotationObject.$Ge
        };
      } else if (annotationObject.$Lt !== undefined) {
        parsedAnnotationObject.value = {
          type: "Lt",
          Lt: annotationObject.$Lt
        };
      } else if (annotationObject.$Le !== undefined) {
        parsedAnnotationObject.value = {
          type: "Le",
          Le: annotationObject.$Le
        };
      } else if (annotationObject.$Apply !== undefined) {
        parsedAnnotationObject.value = {
          type: "Apply",
          Apply: annotationObject.$Apply,
          Function: annotationObject.$Function
        };
      } else if (annotationObject.$Path !== undefined) {
        parsedAnnotationObject.value = {
          type: "Path",
          Path: annotationObject.$Path
        };
      } else if (annotationObject.$AnnotationPath !== undefined) {
        parsedAnnotationObject.value = {
          type: "AnnotationPath",
          AnnotationPath: annotationObject.$AnnotationPath
        };
      } else if (annotationObject.$Decimal !== undefined) {
        parsedAnnotationObject.value = {
          type: "Decimal",
          Decimal: parseFloat(annotationObject.$Decimal)
        };
      } else if (annotationObject.$EnumMember !== undefined) {
        parsedAnnotationObject.value = {
          type: "EnumMember",
          EnumMember: `${mapNameToAlias(annotationObject.$EnumMember.split("/")[0])}/${annotationObject.$EnumMember.split("/")[1]}`
        };
      } else if (Array.isArray(annotationObject)) {
        isCollection = true;
        parsedAnnotationObject.collection = annotationObject.map((subAnnotationObject, subAnnotationIndex) => parseAnnotationObject(subAnnotationObject, `${currentAnnotationTarget}/${subAnnotationIndex}`, annotationLists, oCapabilities));
        if (annotationObject.length > 0) {
          if (annotationObject[0].hasOwnProperty("$PropertyPath")) {
            parsedAnnotationObject.collection.type = "PropertyPath";
          } else if (annotationObject[0].hasOwnProperty("$Path")) {
            parsedAnnotationObject.collection.type = "Path";
          } else if (annotationObject[0].hasOwnProperty("$NavigationPropertyPath")) {
            parsedAnnotationObject.collection.type = "NavigationPropertyPath";
          } else if (annotationObject[0].hasOwnProperty("$AnnotationPath")) {
            parsedAnnotationObject.collection.type = "AnnotationPath";
          } else if (annotationObject[0].hasOwnProperty("$Type")) {
            parsedAnnotationObject.collection.type = "Record";
          } else if (annotationObject[0].hasOwnProperty("$If")) {
            parsedAnnotationObject.collection.type = "If";
          } else if (annotationObject[0].hasOwnProperty("$Or")) {
            parsedAnnotationObject.collection.type = "Or";
          } else if (annotationObject[0].hasOwnProperty("$Eq")) {
            parsedAnnotationObject.collection.type = "Eq";
          } else if (annotationObject[0].hasOwnProperty("$Ne")) {
            parsedAnnotationObject.collection.type = "Ne";
          } else if (annotationObject[0].hasOwnProperty("$Not")) {
            parsedAnnotationObject.collection.type = "Not";
          } else if (annotationObject[0].hasOwnProperty("$Gt")) {
            parsedAnnotationObject.collection.type = "Gt";
          } else if (annotationObject[0].hasOwnProperty("$Ge")) {
            parsedAnnotationObject.collection.type = "Ge";
          } else if (annotationObject[0].hasOwnProperty("$Lt")) {
            parsedAnnotationObject.collection.type = "Lt";
          } else if (annotationObject[0].hasOwnProperty("$Le")) {
            parsedAnnotationObject.collection.type = "Le";
          } else if (annotationObject[0].hasOwnProperty("$And")) {
            parsedAnnotationObject.collection.type = "And";
          } else if (annotationObject[0].hasOwnProperty("$Apply")) {
            parsedAnnotationObject.collection.type = "Apply";
          } else if (typeof annotationObject[0] === "object") {
            parsedAnnotationObject.collection.type = "Record";
          } else {
            parsedAnnotationObject.collection.type = "String";
          }
        }
      } else {
        const record = {
          propertyValues: []
        };
        if (annotationObject.$Type) {
          const typeValue = annotationObject.$Type;
          record.type = `${typeValue}`;
        }
        const propertyValues = [];
        for (const propertyKey in annotationObject) {
          if (propertyKey !== "$Type" && !propertyKey.startsWith("@")) {
            propertyValues.push(parsePropertyValue(annotationObject[propertyKey], propertyKey, currentAnnotationTarget, annotationLists, oCapabilities));
          } else if (propertyKey.startsWith("@")) {
            // Annotation of record
            createAnnotationLists({
              [propertyKey]: annotationObject[propertyKey]
            }, currentAnnotationTarget, annotationLists, oCapabilities);
          }
        }
        record.propertyValues = propertyValues;
        parsedAnnotationObject.record = record;
      }
      parsedAnnotationObject.isCollection = isCollection;
      currentOutAnnotationObject.annotations.push(parsedAnnotationObject);
    }
  }
  function prepareProperty(propertyDefinition, entityTypeObject, propertyName) {
    return {
      _type: "Property",
      name: propertyName,
      fullyQualifiedName: `${entityTypeObject.fullyQualifiedName}/${propertyName}`,
      type: propertyDefinition.$Type,
      maxLength: propertyDefinition.$MaxLength,
      precision: propertyDefinition.$Precision,
      scale: propertyDefinition.$Scale,
      nullable: propertyDefinition.$Nullable
    };
  }
  function prepareNavigationProperty(navPropertyDefinition, entityTypeObject, navPropertyName) {
    let referentialConstraint = [];
    if (navPropertyDefinition.$ReferentialConstraint) {
      referentialConstraint = Object.keys(navPropertyDefinition.$ReferentialConstraint).map(sourcePropertyName => {
        return {
          sourceTypeName: entityTypeObject.name,
          sourceProperty: sourcePropertyName,
          targetTypeName: navPropertyDefinition.$Type,
          targetProperty: navPropertyDefinition.$ReferentialConstraint[sourcePropertyName]
        };
      });
    }
    const navigationProperty = {
      _type: "NavigationProperty",
      name: navPropertyName,
      fullyQualifiedName: `${entityTypeObject.fullyQualifiedName}/${navPropertyName}`,
      partner: navPropertyDefinition.$Partner,
      isCollection: navPropertyDefinition.$isCollection ? navPropertyDefinition.$isCollection : false,
      containsTarget: navPropertyDefinition.$ContainsTarget,
      targetTypeName: navPropertyDefinition.$Type,
      referentialConstraint
    };
    return navigationProperty;
  }
  function prepareEntitySet(entitySetDefinition, entitySetName, entityContainerName) {
    const entitySetObject = {
      _type: "EntitySet",
      name: entitySetName,
      navigationPropertyBinding: {},
      entityTypeName: entitySetDefinition.$Type,
      fullyQualifiedName: `${entityContainerName}/${entitySetName}`
    };
    return entitySetObject;
  }
  function prepareSingleton(singletonDefinition, singletonName, entityContainerName) {
    return {
      _type: "Singleton",
      name: singletonName,
      navigationPropertyBinding: {},
      entityTypeName: singletonDefinition.$Type,
      fullyQualifiedName: `${entityContainerName}/${singletonName}`,
      nullable: true
    };
  }
  function prepareActionImport(actionImport, actionImportName, entityContainerName) {
    return {
      _type: "ActionImport",
      name: actionImportName,
      fullyQualifiedName: `${entityContainerName}/${actionImportName}`,
      actionName: actionImport.$Action
    };
  }
  function prepareTypeDefinition(typeDefinition, typeName, namespacePrefix) {
    const typeObject = {
      _type: "TypeDefinition",
      name: typeName.substring(namespacePrefix.length),
      fullyQualifiedName: typeName,
      underlyingType: typeDefinition.$UnderlyingType
    };
    return typeObject;
  }
  function prepareComplexType(complexTypeDefinition, complexTypeName, namespacePrefix) {
    const complexTypeObject = {
      _type: "ComplexType",
      name: complexTypeName.substring(namespacePrefix.length),
      fullyQualifiedName: complexTypeName,
      properties: [],
      navigationProperties: []
    };
    const complexTypeProperties = Object.keys(complexTypeDefinition).filter(propertyNameOrNot => {
      if (propertyNameOrNot != "$Key" && propertyNameOrNot != "$kind") {
        return complexTypeDefinition[propertyNameOrNot].$kind === "Property";
      }
    }).sort((a, b) => a > b ? 1 : -1).map(propertyName => {
      return prepareProperty(complexTypeDefinition[propertyName], complexTypeObject, propertyName);
    });
    complexTypeObject.properties = complexTypeProperties;
    const complexTypeNavigationProperties = Object.keys(complexTypeDefinition).filter(propertyNameOrNot => {
      if (propertyNameOrNot != "$Key" && propertyNameOrNot != "$kind") {
        return complexTypeDefinition[propertyNameOrNot].$kind === "NavigationProperty";
      }
    }).sort((a, b) => a > b ? 1 : -1).map(navPropertyName => {
      return prepareNavigationProperty(complexTypeDefinition[navPropertyName], complexTypeObject, navPropertyName);
    });
    complexTypeObject.navigationProperties = complexTypeNavigationProperties;
    return complexTypeObject;
  }
  function prepareEntityKeys(entityTypeDefinition, oMetaModelData) {
    if (!entityTypeDefinition.$Key && entityTypeDefinition.$BaseType) {
      return prepareEntityKeys(oMetaModelData[entityTypeDefinition.$BaseType], oMetaModelData);
    }
    return entityTypeDefinition.$Key ?? []; //handling of entity types without key as well as basetype
  }

  function prepareEntityType(entityTypeDefinition, entityTypeName, namespacePrefix, metaModelData) {
    var _metaModelData$$Annot, _metaModelData$$Annot2;
    const entityType = {
      _type: "EntityType",
      name: entityTypeName.substring(namespacePrefix.length),
      fullyQualifiedName: entityTypeName,
      keys: [],
      entityProperties: [],
      navigationProperties: [],
      actions: {}
    };
    for (const key in entityTypeDefinition) {
      const value = entityTypeDefinition[key];
      switch (value.$kind) {
        case "Property":
          const property = prepareProperty(value, entityType, key);
          entityType.entityProperties.push(property);
          break;
        case "NavigationProperty":
          const navigationProperty = prepareNavigationProperty(value, entityType, key);
          entityType.navigationProperties.push(navigationProperty);
          break;
      }
    }
    entityType.keys = prepareEntityKeys(entityTypeDefinition, metaModelData).map(entityKey => entityType.entityProperties.find(property => property.name === entityKey)).filter(property => property !== undefined);

    // Check if there are filter facets defined for the entityType and if yes, check if all of them have an ID
    // The ID is optional, but it is internally taken for grouping filter fields and if it's not present
    // a fallback ID needs to be generated here.
    (_metaModelData$$Annot = metaModelData.$Annotations[entityType.fullyQualifiedName]) === null || _metaModelData$$Annot === void 0 ? void 0 : (_metaModelData$$Annot2 = _metaModelData$$Annot[`@${"com.sap.vocabularies.UI.v1.FilterFacets"}`]) === null || _metaModelData$$Annot2 === void 0 ? void 0 : _metaModelData$$Annot2.forEach(filterFacetAnnotation => {
      filterFacetAnnotation.ID = createReferenceFacetId(filterFacetAnnotation);
    });
    for (const entityProperty of entityType.entityProperties) {
      if (!metaModelData.$Annotations[entityProperty.fullyQualifiedName]) {
        metaModelData.$Annotations[entityProperty.fullyQualifiedName] = {};
      }
      if (!metaModelData.$Annotations[entityProperty.fullyQualifiedName][`@${"com.sap.vocabularies.UI.v1.DataFieldDefault"}`]) {
        metaModelData.$Annotations[entityProperty.fullyQualifiedName][`@${"com.sap.vocabularies.UI.v1.DataFieldDefault"}`] = {
          $Type: "com.sap.vocabularies.UI.v1.DataField",
          Value: {
            $Path: entityProperty.name
          }
        };
      }
    }
    return entityType;
  }
  function prepareAction(actionName, actionRawData, namespacePrefix) {
    var _actionRawData$$Retur;
    let actionEntityType = "";
    let actionFQN = actionName;
    if (actionRawData.$IsBound) {
      const bindingParameter = actionRawData.$Parameter[0];
      actionEntityType = bindingParameter.$Type;
      if (bindingParameter.$isCollection === true) {
        actionFQN = `${actionName}(Collection(${actionEntityType}))`;
      } else {
        actionFQN = `${actionName}(${actionEntityType})`;
      }
    }
    const parameters = actionRawData.$Parameter ?? [];
    return {
      _type: "Action",
      name: actionName.substring(namespacePrefix.length),
      fullyQualifiedName: actionFQN,
      isBound: actionRawData.$IsBound ?? false,
      isFunction: actionRawData.$kind === "Function",
      sourceType: actionEntityType,
      returnType: ((_actionRawData$$Retur = actionRawData.$ReturnType) === null || _actionRawData$$Retur === void 0 ? void 0 : _actionRawData$$Retur.$Type) ?? "",
      parameters: parameters.map(param => {
        return {
          _type: "ActionParameter",
          fullyQualifiedName: `${actionFQN}/${param.$Name}`,
          isCollection: param.$isCollection ?? false,
          name: param.$Name,
          type: param.$Type
        };
      })
    };
  }
  function parseEntityContainer(namespacePrefix, entityContainerName, entityContainerMetadata, result) {
    result.schema.entityContainer = {
      _type: "EntityContainer",
      name: entityContainerName.substring(namespacePrefix.length),
      fullyQualifiedName: entityContainerName
    };
    for (const elementName in entityContainerMetadata) {
      const elementValue = entityContainerMetadata[elementName];
      switch (elementValue.$kind) {
        case "EntitySet":
          result.schema.entitySets.push(prepareEntitySet(elementValue, elementName, entityContainerName));
          break;
        case "Singleton":
          result.schema.singletons.push(prepareSingleton(elementValue, elementName, entityContainerName));
          break;
        case "ActionImport":
          result.schema.actionImports.push(prepareActionImport(elementValue, elementName, entityContainerName));
          break;
      }
    }

    // link the navigation property bindings ($NavigationPropertyBinding)
    for (const entitySet of result.schema.entitySets) {
      const navPropertyBindings = entityContainerMetadata[entitySet.name].$NavigationPropertyBinding;
      if (navPropertyBindings) {
        for (const navPropName of Object.keys(navPropertyBindings)) {
          const targetEntitySet = result.schema.entitySets.find(entitySetName => entitySetName.name === navPropertyBindings[navPropName]);
          if (targetEntitySet) {
            entitySet.navigationPropertyBinding[navPropName] = targetEntitySet;
          }
        }
      }
    }
  }
  function parseAnnotations(annotations, capabilities) {
    const annotationLists = {};
    for (const target in annotations) {
      createAnnotationLists(annotations[target], target, annotationLists, capabilities);
    }

    // Sort by target length
    return Object.keys(annotationLists).sort((a, b) => a.length - b.length).map(annotationName => annotationLists[annotationName]);
  }
  function parseMetaModel(metaModel) {
    let capabilities = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DefaultEnvironmentCapabilities;
    const metaModelData = metaModel.getObject("/$");

    // assuming there is only one schema/namespace
    const namespacePrefix = Object.keys(metaModelData).find(key => metaModelData[key].$kind === "Schema") ?? "";
    const result = {
      identification: "metamodelResult",
      version: "4.0",
      schema: {
        namespace: namespacePrefix.slice(0, -1),
        entityContainer: {
          _type: "EntityContainer",
          name: "",
          fullyQualifiedName: ""
        },
        entitySets: [],
        entityTypes: [],
        complexTypes: [],
        typeDefinitions: [],
        singletons: [],
        associations: [],
        associationSets: [],
        actions: [],
        actionImports: [],
        annotations: {
          metamodelResult: []
        }
      },
      references: []
    };
    const parseMetaModelElement = (name, value) => {
      switch (value.$kind) {
        case "EntityContainer":
          parseEntityContainer(namespacePrefix, name, value, result);
          break;
        case "Action":
        case "Function":
          const action = prepareAction(name, value, namespacePrefix);
          result.schema.actions.push(action);
          break;
        case "EntityType":
          const entityType = prepareEntityType(value, name, namespacePrefix, metaModelData);
          result.schema.entityTypes.push(entityType);
          break;
        case "ComplexType":
          const complexType = prepareComplexType(value, name, namespacePrefix);
          result.schema.complexTypes.push(complexType);
          break;
        case "TypeDefinition":
          const typeDefinition = prepareTypeDefinition(value, name, namespacePrefix);
          result.schema.typeDefinitions.push(typeDefinition);
          break;
      }
    };
    for (const elementName in metaModelData) {
      const elementValue = metaModelData[elementName];
      if (Array.isArray(elementValue)) {
        // value can be an array in case of actions or functions
        for (const subElementValue of elementValue) {
          parseMetaModelElement(elementName, subElementValue);
        }
      } else {
        parseMetaModelElement(elementName, elementValue);
      }
    }
    result.schema.annotations.metamodelResult = parseAnnotations(metaModelData.$Annotations, capabilities);
    return result;
  }
  _exports.parseMetaModel = parseMetaModel;
  const mMetaModelMap = {};

  /**
   * Convert the ODataMetaModel into another format that allow for easy manipulation of the annotations.
   *
   * @param oMetaModel The ODataMetaModel
   * @param oCapabilities The current capabilities
   * @returns An object containing object-like annotations
   */
  function convertTypes(oMetaModel, oCapabilities) {
    const sMetaModelId = oMetaModel.id;
    if (!mMetaModelMap.hasOwnProperty(sMetaModelId)) {
      const parsedOutput = parseMetaModel(oMetaModel, oCapabilities);
      try {
        mMetaModelMap[sMetaModelId] = AnnotationConverter.convert(parsedOutput);
      } catch (oError) {
        throw new Error(oError);
      }
    }
    return mMetaModelMap[sMetaModelId];
  }
  _exports.convertTypes = convertTypes;
  function getConvertedTypes(oContext) {
    const oMetaModel = oContext.getModel();
    if (!oMetaModel.isA("sap.ui.model.odata.v4.ODataMetaModel")) {
      throw new Error("This should only be called on a ODataMetaModel");
    }
    return convertTypes(oMetaModel);
  }
  _exports.getConvertedTypes = getConvertedTypes;
  function deleteModelCacheData(oMetaModel) {
    delete mMetaModelMap[oMetaModel.id];
  }
  _exports.deleteModelCacheData = deleteModelCacheData;
  function convertMetaModelContext(oMetaModelContext) {
    let bIncludeVisitedObjects = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    const oConvertedMetadata = convertTypes(oMetaModelContext.getModel());
    const sPath = oMetaModelContext.getPath();
    const aPathSplit = sPath.split("/");
    let firstPart = aPathSplit[1];
    let beginIndex = 2;
    if (oConvertedMetadata.entityContainer.fullyQualifiedName === firstPart) {
      firstPart = aPathSplit[2];
      beginIndex++;
    }
    let targetEntitySet = oConvertedMetadata.entitySets.find(entitySet => entitySet.name === firstPart);
    if (!targetEntitySet) {
      targetEntitySet = oConvertedMetadata.singletons.find(singleton => singleton.name === firstPart);
    }
    let relativePath = aPathSplit.slice(beginIndex).join("/");
    const localObjects = [targetEntitySet];
    while (relativePath && relativePath.length > 0 && relativePath.startsWith("$NavigationPropertyBinding")) {
      var _sNavPropToCheck;
      let relativeSplit = relativePath.split("/");
      let idx = 0;
      let currentEntitySet, sNavPropToCheck;
      relativeSplit = relativeSplit.slice(1); // Removing "$NavigationPropertyBinding"
      while (!currentEntitySet && relativeSplit.length > idx) {
        if (relativeSplit[idx] !== "$NavigationPropertyBinding") {
          // Finding the correct entitySet for the navigaiton property binding example: "Set/_SalesOrder"
          sNavPropToCheck = relativeSplit.slice(0, idx + 1).join("/").replace("/$NavigationPropertyBinding", "");
          currentEntitySet = targetEntitySet && targetEntitySet.navigationPropertyBinding[sNavPropToCheck];
        }
        idx++;
      }
      if (!currentEntitySet) {
        // Fall back to Single nav prop if entitySet is not found.
        sNavPropToCheck = relativeSplit[0];
      }
      const aNavProps = ((_sNavPropToCheck = sNavPropToCheck) === null || _sNavPropToCheck === void 0 ? void 0 : _sNavPropToCheck.split("/")) || [];
      let targetEntityType = targetEntitySet && targetEntitySet.entityType;
      for (const sNavProp of aNavProps) {
        // Pushing all nav props to the visited objects. example: "Set", "_SalesOrder" for "Set/_SalesOrder"(in NavigationPropertyBinding)
        const targetNavProp = targetEntityType && targetEntityType.navigationProperties.find(navProp => navProp.name === sNavProp);
        if (targetNavProp) {
          localObjects.push(targetNavProp);
          targetEntityType = targetNavProp.targetType;
        } else {
          break;
        }
      }
      targetEntitySet = targetEntitySet && currentEntitySet || targetEntitySet && targetEntitySet.navigationPropertyBinding[relativeSplit[0]];
      if (targetEntitySet) {
        // Pushing the target entitySet to visited objects
        localObjects.push(targetEntitySet);
      }
      // Re-calculating the relative path
      // As each navigation name is enclosed between '$NavigationPropertyBinding' and '$' (to be able to access the entityset easily in the metamodel)
      // we need to remove the closing '$' to be able to switch to the next navigation
      relativeSplit = relativeSplit.slice(aNavProps.length || 1);
      if (relativeSplit.length && relativeSplit[0] === "$") {
        relativeSplit.shift();
      }
      relativePath = relativeSplit.join("/");
    }
    if (relativePath.startsWith("$Type")) {
      // As $Type@ is allowed as well
      if (relativePath.startsWith("$Type@")) {
        relativePath = relativePath.replace("$Type", "");
      } else {
        // We're anyway going to look on the entityType...
        relativePath = aPathSplit.slice(3).join("/");
      }
    }
    if (targetEntitySet && relativePath.length) {
      const oTarget = targetEntitySet.entityType.resolvePath(relativePath, bIncludeVisitedObjects);
      if (oTarget) {
        if (bIncludeVisitedObjects) {
          oTarget.visitedObjects = localObjects.concat(oTarget.visitedObjects);
        }
      } else if (targetEntitySet.entityType && targetEntitySet.entityType.actions) {
        // if target is an action or an action parameter
        const actions = targetEntitySet.entityType && targetEntitySet.entityType.actions;
        const relativeSplit = relativePath.split("/");
        if (actions[relativeSplit[0]]) {
          const action = actions[relativeSplit[0]];
          if (relativeSplit[1] && action.parameters) {
            const parameterName = relativeSplit[1];
            return action.parameters.find(parameter => {
              return parameter.fullyQualifiedName.endsWith(`/${parameterName}`);
            });
          } else if (relativePath.length === 1) {
            return action;
          }
        }
      }
      return oTarget;
    } else {
      if (bIncludeVisitedObjects) {
        return {
          target: targetEntitySet,
          visitedObjects: localObjects
        };
      }
      return targetEntitySet;
    }
  }
  _exports.convertMetaModelContext = convertMetaModelContext;
  function getInvolvedDataModelObjects(oMetaModelContext, oEntitySetMetaModelContext) {
    const oConvertedMetadata = convertTypes(oMetaModelContext.getModel());
    const metaModelContext = convertMetaModelContext(oMetaModelContext, true);
    let targetEntitySetLocation;
    if (oEntitySetMetaModelContext && oEntitySetMetaModelContext.getPath() !== "/") {
      targetEntitySetLocation = getInvolvedDataModelObjects(oEntitySetMetaModelContext);
    }
    return getInvolvedDataModelObjectFromPath(metaModelContext, oConvertedMetadata, targetEntitySetLocation);
  }
  _exports.getInvolvedDataModelObjects = getInvolvedDataModelObjects;
  function getInvolvedDataModelObjectFromPath(metaModelContext, convertedTypes, targetEntitySetLocation, onlyServiceObjects) {
    var _metaModelContext$tar, _outDataModelPath$tar;
    const dataModelObjects = metaModelContext.visitedObjects.filter(visitedObject => (visitedObject === null || visitedObject === void 0 ? void 0 : visitedObject.hasOwnProperty("_type")) && visitedObject._type !== "EntityType" && visitedObject._type !== "EntityContainer");
    if ((_metaModelContext$tar = metaModelContext.target) !== null && _metaModelContext$tar !== void 0 && _metaModelContext$tar.hasOwnProperty("_type") && metaModelContext.target._type !== "EntityType" && dataModelObjects[dataModelObjects.length - 1] !== metaModelContext.target && !onlyServiceObjects) {
      dataModelObjects.push(metaModelContext.target);
    }
    const navigationProperties = [];
    const rootEntitySet = dataModelObjects[0];
    let currentEntitySet = rootEntitySet;
    let currentEntityType = rootEntitySet.entityType;
    let currentObject;
    let navigatedPath = [];
    for (let i = 1; i < dataModelObjects.length; i++) {
      currentObject = dataModelObjects[i];
      if (currentObject._type === "NavigationProperty") {
        var _currentEntitySet;
        navigatedPath.push(currentObject.name);
        navigationProperties.push(currentObject);
        currentEntityType = currentObject.targetType;
        const boundEntitySet = (_currentEntitySet = currentEntitySet) === null || _currentEntitySet === void 0 ? void 0 : _currentEntitySet.navigationPropertyBinding[navigatedPath.join("/")];
        if (boundEntitySet) {
          currentEntitySet = boundEntitySet;
          navigatedPath = [];
        }
      }
      if (currentObject._type === "EntitySet" || currentObject._type === "Singleton") {
        currentEntitySet = currentObject;
        currentEntityType = currentEntitySet.entityType;
      }
    }
    if (navigatedPath.length > 0) {
      // Path without NavigationPropertyBinding --> no target entity set
      currentEntitySet = undefined;
    }
    if (targetEntitySetLocation && targetEntitySetLocation.startingEntitySet !== rootEntitySet) {
      // In case the entityset is not starting from the same location it may mean that we are doing too much work earlier for some reason
      // As such we need to redefine the context source for the targetEntitySetLocation
      const startingIndex = dataModelObjects.indexOf(targetEntitySetLocation.startingEntitySet);
      if (startingIndex !== -1) {
        // If it's not found I don't know what we can do (probably nothing)
        const requiredDataModelObjects = dataModelObjects.slice(0, startingIndex);
        targetEntitySetLocation.startingEntitySet = rootEntitySet;
        targetEntitySetLocation.navigationProperties = requiredDataModelObjects.filter(object => object._type === "NavigationProperty").concat(targetEntitySetLocation.navigationProperties);
      }
    }
    const outDataModelPath = {
      startingEntitySet: rootEntitySet,
      targetEntitySet: currentEntitySet,
      targetEntityType: currentEntityType,
      targetObject: metaModelContext.target,
      navigationProperties,
      contextLocation: targetEntitySetLocation,
      convertedTypes: convertedTypes
    };
    if (!((_outDataModelPath$tar = outDataModelPath.targetObject) !== null && _outDataModelPath$tar !== void 0 && _outDataModelPath$tar.hasOwnProperty("_type")) && onlyServiceObjects) {
      outDataModelPath.targetObject = currentObject;
    }
    if (!outDataModelPath.contextLocation) {
      outDataModelPath.contextLocation = outDataModelPath;
    }
    return outDataModelPath;
  }
  _exports.getInvolvedDataModelObjectFromPath = getInvolvedDataModelObjectFromPath;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/MetaModelConverter", ["sap/fe/core/converters/common/AnnotationConverter","../helpers/StableIdHelper"],function(e,t){"use strict";var n={};var i=t.prepareId;const o={"Org.OData.Capabilities.V1":"Capabilities","Org.OData.Core.V1":"Core","Org.OData.Measures.V1":"Measures","com.sap.vocabularies.Common.v1":"Common","com.sap.vocabularies.UI.v1":"UI","com.sap.vocabularies.Session.v1":"Session","com.sap.vocabularies.Analytics.v1":"Analytics","com.sap.vocabularies.PersonalData.v1":"PersonalData","com.sap.vocabularies.Communication.v1":"Communication"};const a={Chart:true,MicroChart:true,UShell:true,IntentBasedNavigation:true,AppState:true};n.DefaultEnvironmentCapabilities=a;function r(e,t,n,i,o){let a;const r=`${n}/${t}`;const p=typeof e;if(e===null){a={type:"Null",Null:null}}else if(p==="string"){a={type:"String",String:e}}else if(p==="boolean"){a={type:"Bool",Bool:e}}else if(p==="number"){a={type:"Int",Int:e}}else if(Array.isArray(e)){a={type:"Collection",Collection:e.map((e,t)=>s(e,`${r}/${t}`,i,o))};if(e.length>0){if(e[0].hasOwnProperty("$PropertyPath")){a.Collection.type="PropertyPath"}else if(e[0].hasOwnProperty("$Path")){a.Collection.type="Path"}else if(e[0].hasOwnProperty("$NavigationPropertyPath")){a.Collection.type="NavigationPropertyPath"}else if(e[0].hasOwnProperty("$AnnotationPath")){a.Collection.type="AnnotationPath"}else if(e[0].hasOwnProperty("$Type")){a.Collection.type="Record"}else if(e[0].hasOwnProperty("$If")){a.Collection.type="If"}else if(e[0].hasOwnProperty("$Or")){a.Collection.type="Or"}else if(e[0].hasOwnProperty("$And")){a.Collection.type="And"}else if(e[0].hasOwnProperty("$Eq")){a.Collection.type="Eq"}else if(e[0].hasOwnProperty("$Ne")){a.Collection.type="Ne"}else if(e[0].hasOwnProperty("$Not")){a.Collection.type="Not"}else if(e[0].hasOwnProperty("$Gt")){a.Collection.type="Gt"}else if(e[0].hasOwnProperty("$Ge")){a.Collection.type="Ge"}else if(e[0].hasOwnProperty("$Lt")){a.Collection.type="Lt"}else if(e[0].hasOwnProperty("$Le")){a.Collection.type="Le"}else if(e[0].hasOwnProperty("$Apply")){a.Collection.type="Apply"}else if(typeof e[0]==="object"){a.Collection.type="Record"}else{a.Collection.type="String"}}}else if(e.$Path!==undefined){a={type:"Path",Path:e.$Path}}else if(e.$Decimal!==undefined){a={type:"Decimal",Decimal:parseFloat(e.$Decimal)}}else if(e.$PropertyPath!==undefined){a={type:"PropertyPath",PropertyPath:e.$PropertyPath}}else if(e.$NavigationPropertyPath!==undefined){a={type:"NavigationPropertyPath",NavigationPropertyPath:e.$NavigationPropertyPath}}else if(e.$If!==undefined){a={type:"If",If:e.$If}}else if(e.$And!==undefined){a={type:"And",And:e.$And}}else if(e.$Or!==undefined){a={type:"Or",Or:e.$Or}}else if(e.$Not!==undefined){a={type:"Not",Not:e.$Not}}else if(e.$Eq!==undefined){a={type:"Eq",Eq:e.$Eq}}else if(e.$Ne!==undefined){a={type:"Ne",Ne:e.$Ne}}else if(e.$Gt!==undefined){a={type:"Gt",Gt:e.$Gt}}else if(e.$Ge!==undefined){a={type:"Ge",Ge:e.$Ge}}else if(e.$Lt!==undefined){a={type:"Lt",Lt:e.$Lt}}else if(e.$Le!==undefined){a={type:"Le",Le:e.$Le}}else if(e.$Apply!==undefined){a={type:"Apply",Apply:e.$Apply,Function:e.$Function}}else if(e.$AnnotationPath!==undefined){a={type:"AnnotationPath",AnnotationPath:e.$AnnotationPath}}else if(e.$EnumMember!==undefined){a={type:"EnumMember",EnumMember:`${l(e.$EnumMember.split("/")[0])}/${e.$EnumMember.split("/")[1]}`}}else{a={type:"Record",Record:s(e,n,i,o)}}return{name:t,value:a}}function l(e){let[t,n]=e.split("@");if(!n){n=t;t=""}else{t+="@"}const i=n.lastIndexOf(".");return`${t+o[n.substr(0,i)]}.${n.substr(i+1)}`}function s(e,t,n,i){let o={};const a=typeof e;if(e===null){o={type:"Null",Null:null}}else if(a==="string"){o={type:"String",String:e}}else if(a==="boolean"){o={type:"Bool",Bool:e}}else if(a==="number"){o={type:"Int",Int:e}}else if(e.$AnnotationPath!==undefined){o={type:"AnnotationPath",AnnotationPath:e.$AnnotationPath}}else if(e.$Path!==undefined){o={type:"Path",Path:e.$Path}}else if(e.$Decimal!==undefined){o={type:"Decimal",Decimal:parseFloat(e.$Decimal)}}else if(e.$PropertyPath!==undefined){o={type:"PropertyPath",PropertyPath:e.$PropertyPath}}else if(e.$If!==undefined){o={type:"If",If:e.$If}}else if(e.$And!==undefined){o={type:"And",And:e.$And}}else if(e.$Or!==undefined){o={type:"Or",Or:e.$Or}}else if(e.$Not!==undefined){o={type:"Not",Not:e.$Not}}else if(e.$Eq!==undefined){o={type:"Eq",Eq:e.$Eq}}else if(e.$Ne!==undefined){o={type:"Ne",Ne:e.$Ne}}else if(e.$Gt!==undefined){o={type:"Gt",Gt:e.$Gt}}else if(e.$Ge!==undefined){o={type:"Ge",Ge:e.$Ge}}else if(e.$Lt!==undefined){o={type:"Lt",Lt:e.$Lt}}else if(e.$Le!==undefined){o={type:"Le",Le:e.$Le}}else if(e.$Apply!==undefined){o={type:"Apply",Apply:e.$Apply,Function:e.$Function}}else if(e.$NavigationPropertyPath!==undefined){o={type:"NavigationPropertyPath",NavigationPropertyPath:e.$NavigationPropertyPath}}else if(e.$EnumMember!==undefined){o={type:"EnumMember",EnumMember:`${l(e.$EnumMember.split("/")[0])}/${e.$EnumMember.split("/")[1]}`}}else if(Array.isArray(e)){const a=o;a.collection=e.map((e,o)=>s(e,`${t}/${o}`,n,i));if(e.length>0){if(e[0].hasOwnProperty("$PropertyPath")){a.collection.type="PropertyPath"}else if(e[0].hasOwnProperty("$Path")){a.collection.type="Path"}else if(e[0].hasOwnProperty("$NavigationPropertyPath")){a.collection.type="NavigationPropertyPath"}else if(e[0].hasOwnProperty("$AnnotationPath")){a.collection.type="AnnotationPath"}else if(e[0].hasOwnProperty("$Type")){a.collection.type="Record"}else if(e[0].hasOwnProperty("$If")){a.collection.type="If"}else if(e[0].hasOwnProperty("$And")){a.collection.type="And"}else if(e[0].hasOwnProperty("$Or")){a.collection.type="Or"}else if(e[0].hasOwnProperty("$Eq")){a.collection.type="Eq"}else if(e[0].hasOwnProperty("$Ne")){a.collection.type="Ne"}else if(e[0].hasOwnProperty("$Not")){a.collection.type="Not"}else if(e[0].hasOwnProperty("$Gt")){a.collection.type="Gt"}else if(e[0].hasOwnProperty("$Ge")){a.collection.type="Ge"}else if(e[0].hasOwnProperty("$Lt")){a.collection.type="Lt"}else if(e[0].hasOwnProperty("$Le")){a.collection.type="Le"}else if(e[0].hasOwnProperty("$Apply")){a.collection.type="Apply"}else if(typeof e[0]==="object"){a.collection.type="Record"}else{a.collection.type="String"}}}else{if(e.$Type){const t=e.$Type;o.type=t}const a=[];Object.keys(e).forEach(o=>{if(o!=="$Type"&&o!=="$If"&&o!=="$Apply"&&o!=="$And"&&o!=="$Or"&&o!=="$Ne"&&o!=="$Gt"&&o!=="$Ge"&&o!=="$Lt"&&o!=="$Le"&&o!=="$Not"&&o!=="$Eq"&&!o.startsWith("@")){a.push(r(e[o],o,t,n,i))}else if(o.startsWith("@")){$({[o]:e[o]},t,n,i)}});o.propertyValues=a}return o}function p(e,t){if(!t.hasOwnProperty(e)){t[e]={target:e,annotations:[]}}return t[e]}function y(e){const t=e.ID??e.Target.$AnnotationPath;return t?i(t):t}function c(e){return e.filter(e=>{if(e.Target&&e.Target.$AnnotationPath){return e.Target.$AnnotationPath.indexOf(`@${"com.sap.vocabularies.UI.v1.Chart"}`)===-1}else{return true}})}function f(e){return e.filter(e=>e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")}function u(e){return e.filter(e=>e.$AnnotationPath!==`@${"com.sap.vocabularies.UI.v1.Chart"}`)}function $(e,t,n,i){if(Object.keys(e).length===0){return}const o=p(t,n);if(!i.MicroChart){delete e[`@${"com.sap.vocabularies.UI.v1.Chart"}`]}for(let a in e){let y=e[a];switch(a){case`@${"com.sap.vocabularies.UI.v1.HeaderFacets"}`:if(!i.MicroChart){y=c(y);e[a]=y}break;case`@${"com.sap.vocabularies.UI.v1.Identification"}`:if(!i.IntentBasedNavigation){y=f(y);e[a]=y}break;case`@${"com.sap.vocabularies.UI.v1.LineItem"}`:if(!i.IntentBasedNavigation){y=f(y);e[a]=y}if(!i.MicroChart){y=c(y);e[a]=y}break;case`@${"com.sap.vocabularies.UI.v1.FieldGroup"}`:if(!i.IntentBasedNavigation){y.Data=f(y.Data);e[a]=y}if(!i.MicroChart){y.Data=c(y.Data);e[a]=y}break;case`@${"com.sap.vocabularies.UI.v1.PresentationVariant"}`:if(!i.Chart&&y.Visualizations){y.Visualizations=u(y.Visualizations);e[a]=y}break;default:break}let d=o;const h=a.split("@");if(h.length>2){d=p(`${t}@${h[1]}`,n);a=h[2]}else{a=h[1]}const P=a.split("#");const m=P[1];a=P[0];const g={term:`${a}`,qualifier:m};let v=`${t}@${g.term}`;if(m){v+=`#${m}`}let O=false;const N=typeof y;if(y===null){g.value={type:"Bool",Bool:y}}else if(N==="string"){g.value={type:"String",String:y}}else if(N==="boolean"){g.value={type:"Bool",Bool:y}}else if(N==="number"){g.value={type:"Int",Int:y}}else if(y.$If!==undefined){g.value={type:"If",If:y.$If}}else if(y.$And!==undefined){g.value={type:"And",And:y.$And}}else if(y.$Or!==undefined){g.value={type:"Or",Or:y.$Or}}else if(y.$Not!==undefined){g.value={type:"Not",Not:y.$Not}}else if(y.$Eq!==undefined){g.value={type:"Eq",Eq:y.$Eq}}else if(y.$Ne!==undefined){g.value={type:"Ne",Ne:y.$Ne}}else if(y.$Gt!==undefined){g.value={type:"Gt",Gt:y.$Gt}}else if(y.$Ge!==undefined){g.value={type:"Ge",Ge:y.$Ge}}else if(y.$Lt!==undefined){g.value={type:"Lt",Lt:y.$Lt}}else if(y.$Le!==undefined){g.value={type:"Le",Le:y.$Le}}else if(y.$Apply!==undefined){g.value={type:"Apply",Apply:y.$Apply,Function:y.$Function}}else if(y.$Path!==undefined){g.value={type:"Path",Path:y.$Path}}else if(y.$AnnotationPath!==undefined){g.value={type:"AnnotationPath",AnnotationPath:y.$AnnotationPath}}else if(y.$Decimal!==undefined){g.value={type:"Decimal",Decimal:parseFloat(y.$Decimal)}}else if(y.$EnumMember!==undefined){g.value={type:"EnumMember",EnumMember:`${l(y.$EnumMember.split("/")[0])}/${y.$EnumMember.split("/")[1]}`}}else if(Array.isArray(y)){O=true;g.collection=y.map((e,t)=>s(e,`${v}/${t}`,n,i));if(y.length>0){if(y[0].hasOwnProperty("$PropertyPath")){g.collection.type="PropertyPath"}else if(y[0].hasOwnProperty("$Path")){g.collection.type="Path"}else if(y[0].hasOwnProperty("$NavigationPropertyPath")){g.collection.type="NavigationPropertyPath"}else if(y[0].hasOwnProperty("$AnnotationPath")){g.collection.type="AnnotationPath"}else if(y[0].hasOwnProperty("$Type")){g.collection.type="Record"}else if(y[0].hasOwnProperty("$If")){g.collection.type="If"}else if(y[0].hasOwnProperty("$Or")){g.collection.type="Or"}else if(y[0].hasOwnProperty("$Eq")){g.collection.type="Eq"}else if(y[0].hasOwnProperty("$Ne")){g.collection.type="Ne"}else if(y[0].hasOwnProperty("$Not")){g.collection.type="Not"}else if(y[0].hasOwnProperty("$Gt")){g.collection.type="Gt"}else if(y[0].hasOwnProperty("$Ge")){g.collection.type="Ge"}else if(y[0].hasOwnProperty("$Lt")){g.collection.type="Lt"}else if(y[0].hasOwnProperty("$Le")){g.collection.type="Le"}else if(y[0].hasOwnProperty("$And")){g.collection.type="And"}else if(y[0].hasOwnProperty("$Apply")){g.collection.type="Apply"}else if(typeof y[0]==="object"){g.collection.type="Record"}else{g.collection.type="String"}}}else{const e={propertyValues:[]};if(y.$Type){const t=y.$Type;e.type=`${t}`}const t=[];for(const e in y){if(e!=="$Type"&&!e.startsWith("@")){t.push(r(y[e],e,v,n,i))}else if(e.startsWith("@")){$({[e]:y[e]},v,n,i)}}e.propertyValues=t;g.record=e}g.isCollection=O;d.annotations.push(g)}}function d(e,t,n){return{_type:"Property",name:n,fullyQualifiedName:`${t.fullyQualifiedName}/${n}`,type:e.$Type,maxLength:e.$MaxLength,precision:e.$Precision,scale:e.$Scale,nullable:e.$Nullable}}function h(e,t,n){let i=[];if(e.$ReferentialConstraint){i=Object.keys(e.$ReferentialConstraint).map(n=>({sourceTypeName:t.name,sourceProperty:n,targetTypeName:e.$Type,targetProperty:e.$ReferentialConstraint[n]}))}const o={_type:"NavigationProperty",name:n,fullyQualifiedName:`${t.fullyQualifiedName}/${n}`,partner:e.$Partner,isCollection:e.$isCollection?e.$isCollection:false,containsTarget:e.$ContainsTarget,targetTypeName:e.$Type,referentialConstraint:i};return o}function P(e,t,n){const i={_type:"EntitySet",name:t,navigationPropertyBinding:{},entityTypeName:e.$Type,fullyQualifiedName:`${n}/${t}`};return i}function m(e,t,n){return{_type:"Singleton",name:t,navigationPropertyBinding:{},entityTypeName:e.$Type,fullyQualifiedName:`${n}/${t}`,nullable:true}}function g(e,t,n){return{_type:"ActionImport",name:t,fullyQualifiedName:`${n}/${t}`,actionName:e.$Action}}function v(e,t,n){const i={_type:"TypeDefinition",name:t.substring(n.length),fullyQualifiedName:t,underlyingType:e.$UnderlyingType};return i}function O(e,t,n){const i={_type:"ComplexType",name:t.substring(n.length),fullyQualifiedName:t,properties:[],navigationProperties:[]};const o=Object.keys(e).filter(t=>{if(t!="$Key"&&t!="$kind"){return e[t].$kind==="Property"}}).sort((e,t)=>e>t?1:-1).map(t=>d(e[t],i,t));i.properties=o;const a=Object.keys(e).filter(t=>{if(t!="$Key"&&t!="$kind"){return e[t].$kind==="NavigationProperty"}}).sort((e,t)=>e>t?1:-1).map(t=>h(e[t],i,t));i.navigationProperties=a;return i}function N(e,t){if(!e.$Key&&e.$BaseType){return N(t[e.$BaseType],t)}return e.$Key??[]}function b(e,t,n,i){var o,a;const r={_type:"EntityType",name:t.substring(n.length),fullyQualifiedName:t,keys:[],entityProperties:[],navigationProperties:[],actions:{}};for(const t in e){const n=e[t];switch(n.$kind){case"Property":const e=d(n,r,t);r.entityProperties.push(e);break;case"NavigationProperty":const i=h(n,r,t);r.navigationProperties.push(i);break}}r.keys=N(e,i).map(e=>r.entityProperties.find(t=>t.name===e)).filter(e=>e!==undefined);(o=i.$Annotations[r.fullyQualifiedName])===null||o===void 0?void 0:(a=o[`@${"com.sap.vocabularies.UI.v1.FilterFacets"}`])===null||a===void 0?void 0:a.forEach(e=>{e.ID=y(e)});for(const e of r.entityProperties){if(!i.$Annotations[e.fullyQualifiedName]){i.$Annotations[e.fullyQualifiedName]={}}if(!i.$Annotations[e.fullyQualifiedName][`@${"com.sap.vocabularies.UI.v1.DataFieldDefault"}`]){i.$Annotations[e.fullyQualifiedName][`@${"com.sap.vocabularies.UI.v1.DataFieldDefault"}`]={$Type:"com.sap.vocabularies.UI.v1.DataField",Value:{$Path:e.name}}}}return r}function A(e,t,n){var i;let o="";let a=e;if(t.$IsBound){const n=t.$Parameter[0];o=n.$Type;if(n.$isCollection===true){a=`${e}(Collection(${o}))`}else{a=`${e}(${o})`}}const r=t.$Parameter??[];return{_type:"Action",name:e.substring(n.length),fullyQualifiedName:a,isBound:t.$IsBound??false,isFunction:t.$kind==="Function",sourceType:o,returnType:((i=t.$ReturnType)===null||i===void 0?void 0:i.$Type)??"",parameters:r.map(e=>({_type:"ActionParameter",fullyQualifiedName:`${a}/${e.$Name}`,isCollection:e.$isCollection??false,name:e.$Name,type:e.$Type}))}}function T(e,t,n,i){i.schema.entityContainer={_type:"EntityContainer",name:t.substring(e.length),fullyQualifiedName:t};for(const e in n){const o=n[e];switch(o.$kind){case"EntitySet":i.schema.entitySets.push(P(o,e,t));break;case"Singleton":i.schema.singletons.push(m(o,e,t));break;case"ActionImport":i.schema.actionImports.push(g(o,e,t));break}}for(const e of i.schema.entitySets){const t=n[e.name].$NavigationPropertyBinding;if(t){for(const n of Object.keys(t)){const o=i.schema.entitySets.find(e=>e.name===t[n]);if(o){e.navigationPropertyBinding[n]=o}}}}}function C(e,t){const n={};for(const i in e){$(e[i],i,n,t)}return Object.keys(n).sort((e,t)=>e.length-t.length).map(e=>n[e])}function w(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a;const n=e.getObject("/$");const i=Object.keys(n).find(e=>n[e].$kind==="Schema")??"";const o={identification:"metamodelResult",version:"4.0",schema:{namespace:i.slice(0,-1),entityContainer:{_type:"EntityContainer",name:"",fullyQualifiedName:""},entitySets:[],entityTypes:[],complexTypes:[],typeDefinitions:[],singletons:[],associations:[],associationSets:[],actions:[],actionImports:[],annotations:{metamodelResult:[]}},references:[]};const r=(e,t)=>{switch(t.$kind){case"EntityContainer":T(i,e,t,o);break;case"Action":case"Function":const a=A(e,t,i);o.schema.actions.push(a);break;case"EntityType":const r=b(t,e,i,n);o.schema.entityTypes.push(r);break;case"ComplexType":const l=O(t,e,i);o.schema.complexTypes.push(l);break;case"TypeDefinition":const s=v(t,e,i);o.schema.typeDefinitions.push(s);break}};for(const e in n){const t=n[e];if(Array.isArray(t)){for(const n of t){r(e,n)}}else{r(e,t)}}o.schema.annotations.metamodelResult=C(n.$Annotations,t);return o}n.parseMetaModel=w;const I={};function E(t,n){const i=t.id;if(!I.hasOwnProperty(i)){const o=w(t,n);try{I[i]=e.convert(o)}catch(e){throw new Error(e)}}return I[i]}n.convertTypes=E;function L(e){const t=e.getModel();if(!t.isA("sap.ui.model.odata.v4.ODataMetaModel")){throw new Error("This should only be called on a ODataMetaModel")}return E(t)}n.getConvertedTypes=L;function D(e){delete I[e.id]}n.deleteModelCacheData=D;function G(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const n=E(e.getModel());const i=e.getPath();const o=i.split("/");let a=o[1];let r=2;if(n.entityContainer.fullyQualifiedName===a){a=o[2];r++}let l=n.entitySets.find(e=>e.name===a);if(!l){l=n.singletons.find(e=>e.name===a)}let s=o.slice(r).join("/");const p=[l];while(s&&s.length>0&&s.startsWith("$NavigationPropertyBinding")){var y;let e=s.split("/");let t=0;let n,i;e=e.slice(1);while(!n&&e.length>t){if(e[t]!=="$NavigationPropertyBinding"){i=e.slice(0,t+1).join("/").replace("/$NavigationPropertyBinding","");n=l&&l.navigationPropertyBinding[i]}t++}if(!n){i=e[0]}const o=((y=i)===null||y===void 0?void 0:y.split("/"))||[];let a=l&&l.entityType;for(const e of o){const t=a&&a.navigationProperties.find(t=>t.name===e);if(t){p.push(t);a=t.targetType}else{break}}l=l&&n||l&&l.navigationPropertyBinding[e[0]];if(l){p.push(l)}e=e.slice(o.length||1);if(e.length&&e[0]==="$"){e.shift()}s=e.join("/")}if(s.startsWith("$Type")){if(s.startsWith("$Type@")){s=s.replace("$Type","")}else{s=o.slice(3).join("/")}}if(l&&s.length){const e=l.entityType.resolvePath(s,t);if(e){if(t){e.visitedObjects=p.concat(e.visitedObjects)}}else if(l.entityType&&l.entityType.actions){const e=l.entityType&&l.entityType.actions;const t=s.split("/");if(e[t[0]]){const n=e[t[0]];if(t[1]&&n.parameters){const e=t[1];return n.parameters.find(t=>t.fullyQualifiedName.endsWith(`/${e}`))}else if(s.length===1){return n}}}return e}else{if(t){return{target:l,visitedObjects:p}}return l}}n.convertMetaModelContext=G;function M(e,t){const n=E(e.getModel());const i=G(e,true);let o;if(t&&t.getPath()!=="/"){o=M(t)}return k(i,n,o)}n.getInvolvedDataModelObjects=M;function k(e,t,n,i){var o,a;const r=e.visitedObjects.filter(e=>(e===null||e===void 0?void 0:e.hasOwnProperty("_type"))&&e._type!=="EntityType"&&e._type!=="EntityContainer");if((o=e.target)!==null&&o!==void 0&&o.hasOwnProperty("_type")&&e.target._type!=="EntityType"&&r[r.length-1]!==e.target&&!i){r.push(e.target)}const l=[];const s=r[0];let p=s;let y=s.entityType;let c;let f=[];for(let e=1;e<r.length;e++){c=r[e];if(c._type==="NavigationProperty"){var u;f.push(c.name);l.push(c);y=c.targetType;const e=(u=p)===null||u===void 0?void 0:u.navigationPropertyBinding[f.join("/")];if(e){p=e;f=[]}}if(c._type==="EntitySet"||c._type==="Singleton"){p=c;y=p.entityType}}if(f.length>0){p=undefined}if(n&&n.startingEntitySet!==s){const e=r.indexOf(n.startingEntitySet);if(e!==-1){const t=r.slice(0,e);n.startingEntitySet=s;n.navigationProperties=t.filter(e=>e._type==="NavigationProperty").concat(n.navigationProperties)}}const $={startingEntitySet:s,targetEntitySet:p,targetEntityType:y,targetObject:e.target,navigationProperties:l,contextLocation:n,convertedTypes:t};if(!((a=$.targetObject)!==null&&a!==void 0&&a.hasOwnProperty("_type"))&&i){$.targetObject=c}if(!$.contextLocation){$.contextLocation=$}return $}n.getInvolvedDataModelObjectFromPath=k;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/TemplateConverter-dbg", ["sap/base/util/merge", "sap/fe/core/converters/helpers/IssueManager", "./ConverterContext", "./ManifestSettings", "./MetaModelConverter", "./templates/ListReportConverter", "./templates/ObjectPageConverter"], function (merge, IssueManager, ConverterContext, ManifestSettings, MetaModelConverter, ListReportConverter, ObjectPageConverter) {
  "use strict";

  var _exports = {};
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  var convertTypes = MetaModelConverter.convertTypes;
  var TemplateType = ManifestSettings.TemplateType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategoryType = IssueManager.IssueCategoryType;
  var IssueCategory = IssueManager.IssueCategory;
  function handleErrorForCollectionFacets(oFacets, oDiagnostics, sEntitySetName, level) {
    oFacets.forEach(oFacet => {
      let Message = `For entity set ${sEntitySetName}`;
      if ((oFacet === null || oFacet === void 0 ? void 0 : oFacet.$Type) === "com.sap.vocabularies.UI.v1.CollectionFacet" && !(oFacet !== null && oFacet !== void 0 && oFacet.ID)) {
        var _IssueCategoryType$Fa;
        Message = `${Message}, ` + `level ${level}, the collection facet does not have an ID.`;
        oDiagnostics.addIssue(IssueCategory.Facets, IssueSeverity.High, Message, IssueCategoryType, IssueCategoryType === null || IssueCategoryType === void 0 ? void 0 : (_IssueCategoryType$Fa = IssueCategoryType.Facets) === null || _IssueCategoryType$Fa === void 0 ? void 0 : _IssueCategoryType$Fa.MissingID);
      }
      if ((oFacet === null || oFacet === void 0 ? void 0 : oFacet.$Type) === "com.sap.vocabularies.UI.v1.CollectionFacet" && level >= 3) {
        var _IssueCategoryType$Fa2;
        Message = `${Message}, collection facet ${oFacet.Label} is not supported at ` + `level ${level}`;
        oDiagnostics.addIssue(IssueCategory.Facets, IssueSeverity.Medium, Message, IssueCategoryType, IssueCategoryType === null || IssueCategoryType === void 0 ? void 0 : (_IssueCategoryType$Fa2 = IssueCategoryType.Facets) === null || _IssueCategoryType$Fa2 === void 0 ? void 0 : _IssueCategoryType$Fa2.UnSupportedLevel);
      }
      if (oFacet !== null && oFacet !== void 0 && oFacet.Facets) {
        handleErrorForCollectionFacets(oFacet === null || oFacet === void 0 ? void 0 : oFacet.Facets, oDiagnostics, sEntitySetName, ++level);
        level = level - 1;
      }
    });
  }

  /**
   * Based on a template type, convert the metamodel and manifest definition into a json structure for the page.
   *
   * @param sTemplateType The template type
   * @param oMetaModel The odata model metaModel
   * @param oManifestSettings The current manifest settings
   * @param oDiagnostics The diagnostics wrapper
   * @param sFullContextPath The context path to reach this page
   * @param oCapabilities
   * @param component The template component
   * @returns The target page definition
   */
  function convertPage(sTemplateType, oMetaModel, oManifestSettings, oDiagnostics, sFullContextPath, oCapabilities, component) {
    var _oConvertedMetadata$e;
    const oConvertedMetadata = convertTypes(oMetaModel, oCapabilities);
    oConvertedMetadata.diagnostics.forEach(annotationErrorDetail => {
      const checkIfIssueExists = oDiagnostics.checkIfIssueExists(IssueCategory.Annotation, IssueSeverity.High, annotationErrorDetail.message);
      if (!checkIfIssueExists) {
        oDiagnostics.addIssue(IssueCategory.Annotation, IssueSeverity.High, annotationErrorDetail.message);
      }
    });
    oConvertedMetadata === null || oConvertedMetadata === void 0 ? void 0 : (_oConvertedMetadata$e = oConvertedMetadata.entityTypes) === null || _oConvertedMetadata$e === void 0 ? void 0 : _oConvertedMetadata$e.forEach(oEntitySet => {
      var _oEntitySet$annotatio, _oEntitySet$annotatio2;
      if (oEntitySet !== null && oEntitySet !== void 0 && (_oEntitySet$annotatio = oEntitySet.annotations) !== null && _oEntitySet$annotatio !== void 0 && (_oEntitySet$annotatio2 = _oEntitySet$annotatio.UI) !== null && _oEntitySet$annotatio2 !== void 0 && _oEntitySet$annotatio2.Facets) {
        var _oEntitySet$annotatio3, _oEntitySet$annotatio4;
        handleErrorForCollectionFacets(oEntitySet === null || oEntitySet === void 0 ? void 0 : (_oEntitySet$annotatio3 = oEntitySet.annotations) === null || _oEntitySet$annotatio3 === void 0 ? void 0 : (_oEntitySet$annotatio4 = _oEntitySet$annotatio3.UI) === null || _oEntitySet$annotatio4 === void 0 ? void 0 : _oEntitySet$annotatio4.Facets, oDiagnostics, oEntitySet === null || oEntitySet === void 0 ? void 0 : oEntitySet.name, 1);
      }
    });
    const sTargetEntitySetName = oManifestSettings.entitySet;
    const sContextPath = (oManifestSettings === null || oManifestSettings === void 0 ? void 0 : oManifestSettings.contextPath) || (sFullContextPath === "/" ? sFullContextPath + sTargetEntitySetName : sFullContextPath);
    const oContext = oMetaModel.createBindingContext(sContextPath);
    const oFullContext = getInvolvedDataModelObjects(oContext);
    if (oFullContext) {
      let oConvertedPage = {};
      const converterContext = new ConverterContext(oConvertedMetadata, oManifestSettings, oDiagnostics, merge, oFullContext);
      switch (sTemplateType) {
        case TemplateType.ListReport:
        case TemplateType.AnalyticalListPage:
          oConvertedPage = ListReportConverter.convertPage(converterContext);
          break;
        case TemplateType.ObjectPage:
          oConvertedPage = ObjectPageConverter.convertPage(converterContext);
          break;
      }
      if (component !== null && component !== void 0 && component.extendPageDefinition) {
        oConvertedPage = component.extendPageDefinition(oConvertedPage, converterContext);
      }
      return oConvertedPage;
    }
    return undefined;
  }
  _exports.convertPage = convertPage;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/TemplateConverter", ["sap/base/util/merge","sap/fe/core/converters/helpers/IssueManager","./ConverterContext","./ManifestSettings","./MetaModelConverter","./templates/ListReportConverter","./templates/ObjectPageConverter"],function(e,t,o,n,i,a,s){"use strict";var l={};var v=i.getInvolvedDataModelObjects;var c=i.convertTypes;var d=n.TemplateType;var r=t.IssueSeverity;var u=t.IssueCategoryType;var f=t.IssueCategory;function g(e,t,o,n){e.forEach(e=>{let i=`For entity set ${o}`;if((e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.UI.v1.CollectionFacet"&&!(e!==null&&e!==void 0&&e.ID)){var a;i=`${i}, `+`level ${n}, the collection facet does not have an ID.`;t.addIssue(f.Facets,r.High,i,u,u===null||u===void 0?void 0:(a=u.Facets)===null||a===void 0?void 0:a.MissingID)}if((e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.UI.v1.CollectionFacet"&&n>=3){var s;i=`${i}, collection facet ${e.Label} is not supported at `+`level ${n}`;t.addIssue(f.Facets,r.Medium,i,u,u===null||u===void 0?void 0:(s=u.Facets)===null||s===void 0?void 0:s.UnSupportedLevel)}if(e!==null&&e!==void 0&&e.Facets){g(e===null||e===void 0?void 0:e.Facets,t,o,++n);n=n-1}})}function p(t,n,i,l,u,p,I){var y;const h=c(n,p);h.diagnostics.forEach(e=>{const t=l.checkIfIssueExists(f.Annotation,r.High,e.message);if(!t){l.addIssue(f.Annotation,r.High,e.message)}});h===null||h===void 0?void 0:(y=h.entityTypes)===null||y===void 0?void 0:y.forEach(e=>{var t,o;if(e!==null&&e!==void 0&&(t=e.annotations)!==null&&t!==void 0&&(o=t.UI)!==null&&o!==void 0&&o.Facets){var n,i;g(e===null||e===void 0?void 0:(n=e.annotations)===null||n===void 0?void 0:(i=n.UI)===null||i===void 0?void 0:i.Facets,l,e===null||e===void 0?void 0:e.name,1)}});const F=i.entitySet;const m=(i===null||i===void 0?void 0:i.contextPath)||(u==="/"?u+F:u);const C=n.createBindingContext(m);const b=v(C);if(b){let n={};const v=new o(h,i,l,e,b);switch(t){case d.ListReport:case d.AnalyticalListPage:n=a.convertPage(v);break;case d.ObjectPage:n=s.convertPage(v);break}if(I!==null&&I!==void 0&&I.extendPageDefinition){n=I.extendPageDefinition(n,v)}return n}return undefined}l.convertPage=p;return l},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/annotations/DataField-dbg", ["sap/fe/core/templating/DisplayModeFormatter", "sap/fe/core/templating/PropertyHelper", "../helpers/DataFieldHelper"], function (DisplayModeFormatter, PropertyHelper, DataFieldHelper) {
  "use strict";

  var _exports = {};
  var isReferencePropertyStaticallyHidden = DataFieldHelper.isReferencePropertyStaticallyHidden;
  var isProperty = PropertyHelper.isProperty;
  var isPathExpression = PropertyHelper.isPathExpression;
  var getAssociatedUnitProperty = PropertyHelper.getAssociatedUnitProperty;
  var getAssociatedTimezoneProperty = PropertyHelper.getAssociatedTimezoneProperty;
  var getAssociatedCurrencyProperty = PropertyHelper.getAssociatedCurrencyProperty;
  var getDisplayMode = DisplayModeFormatter.getDisplayMode;
  /**
   * Identifies if the given dataFieldAbstract that is passed is a "DataFieldForActionAbstract".
   * DataFieldForActionAbstract has an inline action defined.
   *
   * @param dataField DataField to be evaluated
   * @returns Validates that dataField is a DataFieldForActionAbstractType
   */
  function isDataFieldForActionAbstract(dataField) {
    return dataField.hasOwnProperty("Action");
  }

  /**
   * Identifies if the given dataFieldAbstract that is passed is a "DataField".
   * DataField has a value defined.
   *
   * @param dataField DataField to be evaluated
   * @returns Validate that dataField is a DataFieldTypes
   */
  _exports.isDataFieldForActionAbstract = isDataFieldForActionAbstract;
  function isDataFieldTypes(dataField) {
    return dataField.hasOwnProperty("Value");
  }

  /**
   * Retrieves the TargetValue from a DataPoint.
   *
   * @param source the target property or DataPoint
   * @returns The TargetValue as a decimal or a property path
   */
  _exports.isDataFieldTypes = isDataFieldTypes;
  function getTargetValueOnDataPoint(source) {
    let targetValue;
    if (isProperty(source)) {
      var _source$annotations, _source$annotations$U, _source$annotations$U2, _source$annotations$U3, _source$annotations$U4, _source$annotations2, _source$annotations2$, _source$annotations2$2, _source$annotations2$3, _source$annotations2$4;
      targetValue = ((_source$annotations = source.annotations) === null || _source$annotations === void 0 ? void 0 : (_source$annotations$U = _source$annotations.UI) === null || _source$annotations$U === void 0 ? void 0 : (_source$annotations$U2 = _source$annotations$U.DataFieldDefault) === null || _source$annotations$U2 === void 0 ? void 0 : (_source$annotations$U3 = _source$annotations$U2.Target) === null || _source$annotations$U3 === void 0 ? void 0 : (_source$annotations$U4 = _source$annotations$U3.$target) === null || _source$annotations$U4 === void 0 ? void 0 : _source$annotations$U4.TargetValue) ?? ((_source$annotations2 = source.annotations) === null || _source$annotations2 === void 0 ? void 0 : (_source$annotations2$ = _source$annotations2.UI) === null || _source$annotations2$ === void 0 ? void 0 : (_source$annotations2$2 = _source$annotations2$.DataFieldDefault) === null || _source$annotations2$2 === void 0 ? void 0 : (_source$annotations2$3 = _source$annotations2$2.Target) === null || _source$annotations2$3 === void 0 ? void 0 : (_source$annotations2$4 = _source$annotations2$3.$target) === null || _source$annotations2$4 === void 0 ? void 0 : _source$annotations2$4.MaximumValue);
    } else {
      targetValue = source.TargetValue ?? source.MaximumValue;
    }
    if (typeof targetValue === "number") {
      return targetValue.toString();
    }
    return isPathExpression(targetValue) ? targetValue : "100";
  }

  /**
   * Check if a property uses a DataPoint within a DataFieldDefault.
   *
   * @param property The property to be checked
   * @returns `true` if the referenced property has a DataPoint within the DataFieldDefault, false else
   * @private
   */
  _exports.getTargetValueOnDataPoint = getTargetValueOnDataPoint;
  const isDataPointFromDataFieldDefault = function (property) {
    var _property$annotations, _property$annotations2, _property$annotations3, _property$annotations4, _property$annotations5;
    return ((_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : (_property$annotations2 = _property$annotations.UI) === null || _property$annotations2 === void 0 ? void 0 : (_property$annotations3 = _property$annotations2.DataFieldDefault) === null || _property$annotations3 === void 0 ? void 0 : (_property$annotations4 = _property$annotations3.Target) === null || _property$annotations4 === void 0 ? void 0 : (_property$annotations5 = _property$annotations4.$target) === null || _property$annotations5 === void 0 ? void 0 : _property$annotations5.$Type) === "com.sap.vocabularies.UI.v1.DataPointType";
  };
  _exports.isDataPointFromDataFieldDefault = isDataPointFromDataFieldDefault;
  function getSemanticObjectPath(converterContext, object) {
    if (typeof object === "object") {
      var _object$Value;
      if (isDataFieldTypes(object) && (_object$Value = object.Value) !== null && _object$Value !== void 0 && _object$Value.$target) {
        var _object$Value2, _property$annotations6, _property$annotations7;
        const property = (_object$Value2 = object.Value) === null || _object$Value2 === void 0 ? void 0 : _object$Value2.$target;
        if ((property === null || property === void 0 ? void 0 : (_property$annotations6 = property.annotations) === null || _property$annotations6 === void 0 ? void 0 : (_property$annotations7 = _property$annotations6.Common) === null || _property$annotations7 === void 0 ? void 0 : _property$annotations7.SemanticObject) !== undefined) {
          return converterContext.getEntitySetBasedAnnotationPath(property === null || property === void 0 ? void 0 : property.fullyQualifiedName);
        }
      } else if (isProperty(object)) {
        var _object$annotations, _object$annotations$C;
        if ((object === null || object === void 0 ? void 0 : (_object$annotations = object.annotations) === null || _object$annotations === void 0 ? void 0 : (_object$annotations$C = _object$annotations.Common) === null || _object$annotations$C === void 0 ? void 0 : _object$annotations$C.SemanticObject) !== undefined) {
          return converterContext.getEntitySetBasedAnnotationPath(object === null || object === void 0 ? void 0 : object.fullyQualifiedName);
        }
      }
    }
    return undefined;
  }

  /**
   * Returns the navigation path prefix for a property path.
   *
   * @param path The property path For e.g. /EntityType/Navigation/Property
   * @returns The navigation path prefix For e.g. /EntityType/Navigation/
   */
  _exports.getSemanticObjectPath = getSemanticObjectPath;
  function _getNavigationPathPrefix(path) {
    return path.indexOf("/") > -1 ? path.substring(0, path.lastIndexOf("/") + 1) : "";
  }

  /**
   * Collect additional properties for the ALP table use-case.
   *
   * For e.g. If UI.Hidden points to a property, include this property in the additionalProperties of ComplexPropertyInfo object.
   *
   * @param target Property or DataField being processed
   * @param navigationPathPrefix Navigation path prefix, applicable in case of navigation properties.
   * @param tableType Table type.
   * @param relatedProperties The related properties identified so far.
   * @returns The related properties identified.
   */
  function _collectAdditionalPropertiesForAnalyticalTable(target, navigationPathPrefix, tableType, relatedProperties) {
    if (tableType === "AnalyticalTable") {
      var _target$annotations, _target$annotations$U;
      const hiddenAnnotation = (_target$annotations = target.annotations) === null || _target$annotations === void 0 ? void 0 : (_target$annotations$U = _target$annotations.UI) === null || _target$annotations$U === void 0 ? void 0 : _target$annotations$U.Hidden;
      if (hiddenAnnotation !== null && hiddenAnnotation !== void 0 && hiddenAnnotation.path && isProperty(hiddenAnnotation.$target)) {
        const hiddenAnnotationPropertyPath = navigationPathPrefix + hiddenAnnotation.path;
        // This property should be added to additionalProperties map for the ALP table use-case.
        relatedProperties.additionalProperties[hiddenAnnotationPropertyPath] = hiddenAnnotation.$target;
      }
    }
    return relatedProperties;
  }

  /**
   * Collect related properties from a property's annotations.
   *
   * @param path The property path
   * @param property The property to be considered
   * @param converterContext The converter context
   * @param ignoreSelf Whether to exclude the same property from related properties.
   * @param tableType The table type.
   * @param relatedProperties The related properties identified so far.
   * @param addUnitInTemplate True if the unit/currency property needs to be added in the export template
   * @param isAnnotatedAsHidden True if the DataField or the property are statically hidden
   * @returns The related properties identified.
   */
  function collectRelatedProperties(path, property, converterContext, ignoreSelf, tableType) {
    let relatedProperties = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {
      properties: {},
      additionalProperties: {},
      textOnlyPropertiesFromTextAnnotation: []
    };
    let addUnitInTemplate = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : false;
    let isAnnotatedAsHidden = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : false;
    /**
     * Helper to push unique related properties.
     *
     * @param key The property path
     * @param value The properties object containing value property, description property...
     * @returns Index at which the property is available
     */
    function _pushUnique(key, value) {
      if (!relatedProperties.properties.hasOwnProperty(key)) {
        relatedProperties.properties[key] = value;
      }
      return Object.keys(relatedProperties.properties).indexOf(key);
    }

    /**
     * Helper to append the export settings template with a formatted text.
     *
     * @param value Formatted text
     */
    function _appendTemplate(value) {
      relatedProperties.exportSettingsTemplate = relatedProperties.exportSettingsTemplate ? `${relatedProperties.exportSettingsTemplate}${value}` : `${value}`;
    }
    if (path && property) {
      var _property$annotations8, _property$annotations9;
      let valueIndex;
      let targetValue;
      let currencyOrUoMIndex;
      let timezoneOrUoMIndex;
      let dataPointIndex;
      if (isAnnotatedAsHidden) {
        // Collect underlying property
        valueIndex = _pushUnique(path, property);
        _appendTemplate(`{${valueIndex}}`);
        return relatedProperties;
      }
      const navigationPathPrefix = _getNavigationPathPrefix(path);

      // Check for Text annotation.
      const textAnnotation = (_property$annotations8 = property.annotations) === null || _property$annotations8 === void 0 ? void 0 : (_property$annotations9 = _property$annotations8.Common) === null || _property$annotations9 === void 0 ? void 0 : _property$annotations9.Text;
      if (relatedProperties.exportSettingsTemplate) {
        // FieldGroup use-case. Need to add each Field in new line.
        _appendTemplate("\n");
        relatedProperties.exportSettingsWrapping = true;
      }
      if (textAnnotation !== null && textAnnotation !== void 0 && textAnnotation.path && textAnnotation !== null && textAnnotation !== void 0 && textAnnotation.$target) {
        // Check for Text Arrangement.
        const dataModelObjectPath = converterContext.getDataModelObjectPath();
        const textAnnotationPropertyPath = navigationPathPrefix + textAnnotation.path;
        const displayMode = getDisplayMode(property, dataModelObjectPath);
        let descriptionIndex;
        switch (displayMode) {
          case "Value":
            valueIndex = _pushUnique(path, property);
            _appendTemplate(`{${valueIndex}}`);
            break;
          case "Description":
            descriptionIndex = _pushUnique(textAnnotationPropertyPath, textAnnotation.$target);
            _appendTemplate(`{${descriptionIndex}}`);
            relatedProperties.textOnlyPropertiesFromTextAnnotation.push(textAnnotationPropertyPath);
            break;
          case "ValueDescription":
            valueIndex = _pushUnique(path, property);
            descriptionIndex = _pushUnique(textAnnotationPropertyPath, textAnnotation.$target);
            _appendTemplate(`{${valueIndex}} ({${descriptionIndex}})`);
            break;
          case "DescriptionValue":
            valueIndex = _pushUnique(path, property);
            descriptionIndex = _pushUnique(textAnnotationPropertyPath, textAnnotation.$target);
            _appendTemplate(`{${descriptionIndex}} ({${valueIndex}})`);
            break;
          // no default
        }
      } else {
        var _property$annotations10, _property$annotations11, _property$annotations12, _property$annotations13, _property$annotations14, _property$annotations15, _property$Target, _property$Target$$tar, _property$Target2, _property$Target2$$ta, _property$annotations16, _property$annotations17, _property$annotations18, _property$annotations19, _property$annotations20;
        // Check for field containing Currency Or Unit Properties or Timezone
        const currencyOrUoMProperty = getAssociatedCurrencyProperty(property) || getAssociatedUnitProperty(property);
        const currencyOrUnitAnnotation = (property === null || property === void 0 ? void 0 : (_property$annotations10 = property.annotations) === null || _property$annotations10 === void 0 ? void 0 : (_property$annotations11 = _property$annotations10.Measures) === null || _property$annotations11 === void 0 ? void 0 : _property$annotations11.ISOCurrency) || (property === null || property === void 0 ? void 0 : (_property$annotations12 = property.annotations) === null || _property$annotations12 === void 0 ? void 0 : (_property$annotations13 = _property$annotations12.Measures) === null || _property$annotations13 === void 0 ? void 0 : _property$annotations13.Unit);
        const timezoneProperty = getAssociatedTimezoneProperty(property);
        const timezoneAnnotation = property === null || property === void 0 ? void 0 : (_property$annotations14 = property.annotations) === null || _property$annotations14 === void 0 ? void 0 : (_property$annotations15 = _property$annotations14.Common) === null || _property$annotations15 === void 0 ? void 0 : _property$annotations15.Timezone;
        if (currencyOrUoMProperty && currencyOrUnitAnnotation !== null && currencyOrUnitAnnotation !== void 0 && currencyOrUnitAnnotation.$target) {
          valueIndex = _pushUnique(path, property);
          currencyOrUoMIndex = _pushUnique(navigationPathPrefix + currencyOrUnitAnnotation.path, currencyOrUnitAnnotation.$target);
          if (addUnitInTemplate) {
            _appendTemplate(`{${valueIndex}}  {${currencyOrUoMIndex}}`);
          } else {
            relatedProperties.exportUnitName = navigationPathPrefix + currencyOrUnitAnnotation.path;
          }
        } else if (timezoneProperty && timezoneAnnotation !== null && timezoneAnnotation !== void 0 && timezoneAnnotation.$target) {
          valueIndex = _pushUnique(path, property);
          timezoneOrUoMIndex = _pushUnique(navigationPathPrefix + timezoneAnnotation.path, timezoneAnnotation.$target);
          if (addUnitInTemplate) {
            _appendTemplate(`{${valueIndex}}  {${timezoneOrUoMIndex}}`);
          } else {
            relatedProperties.exportTimezoneName = navigationPathPrefix + timezoneAnnotation.path;
          }
        } else if (((_property$Target = property.Target) === null || _property$Target === void 0 ? void 0 : (_property$Target$$tar = _property$Target.$target) === null || _property$Target$$tar === void 0 ? void 0 : _property$Target$$tar.$Type) === "com.sap.vocabularies.UI.v1.DataPointType" && !((_property$Target2 = property.Target) !== null && _property$Target2 !== void 0 && (_property$Target2$$ta = _property$Target2.$target) !== null && _property$Target2$$ta !== void 0 && _property$Target2$$ta.ValueFormat) || ((_property$annotations16 = property.annotations) === null || _property$annotations16 === void 0 ? void 0 : (_property$annotations17 = _property$annotations16.UI) === null || _property$annotations17 === void 0 ? void 0 : (_property$annotations18 = _property$annotations17.DataFieldDefault) === null || _property$annotations18 === void 0 ? void 0 : (_property$annotations19 = _property$annotations18.Target) === null || _property$annotations19 === void 0 ? void 0 : (_property$annotations20 = _property$annotations19.$target) === null || _property$annotations20 === void 0 ? void 0 : _property$annotations20.$Type) === "com.sap.vocabularies.UI.v1.DataPointType") {
          var _property$Target3, _property$Target3$$ta, _property$Target4, _property$annotations21, _property$annotations22;
          const dataPointProperty = (_property$Target3 = property.Target) === null || _property$Target3 === void 0 ? void 0 : (_property$Target3$$ta = _property$Target3.$target) === null || _property$Target3$$ta === void 0 ? void 0 : _property$Target3$$ta.Value.$target;
          const datapointTarget = (_property$Target4 = property.Target) === null || _property$Target4 === void 0 ? void 0 : _property$Target4.$target;
          // DataPoint use-case using DataFieldDefault.
          const dataPointDefaultProperty = (_property$annotations21 = property.annotations) === null || _property$annotations21 === void 0 ? void 0 : (_property$annotations22 = _property$annotations21.UI) === null || _property$annotations22 === void 0 ? void 0 : _property$annotations22.DataFieldDefault;
          valueIndex = _pushUnique(navigationPathPrefix ? navigationPathPrefix + path : path, dataPointDefaultProperty ? property : dataPointProperty);
          targetValue = getTargetValueOnDataPoint(dataPointDefaultProperty ? property : datapointTarget);
          if (isProperty(targetValue.$target)) {
            //in case it's a dynamic targetValue
            targetValue = targetValue;
            dataPointIndex = _pushUnique(navigationPathPrefix ? navigationPathPrefix + targetValue.$target.name : targetValue.$target.name, targetValue.$target);
            _appendTemplate(`{${valueIndex}}/{${dataPointIndex}}`);
          } else {
            relatedProperties.exportDataPointTargetValue = targetValue;
            _appendTemplate(`{${valueIndex}}/${targetValue}`);
          }
        } else if (property.$Type === "com.sap.vocabularies.Communication.v1.ContactType") {
          var _property$fn, _property$fn2;
          const contactProperty = (_property$fn = property.fn) === null || _property$fn === void 0 ? void 0 : _property$fn.$target;
          const contactPropertyPath = (_property$fn2 = property.fn) === null || _property$fn2 === void 0 ? void 0 : _property$fn2.path;
          valueIndex = _pushUnique(navigationPathPrefix ? navigationPathPrefix + contactPropertyPath : contactPropertyPath, contactProperty);
          _appendTemplate(`{${valueIndex}}`);
        } else if (!ignoreSelf) {
          // Collect underlying property
          valueIndex = _pushUnique(path, property);
          _appendTemplate(`{${valueIndex}}`);
          if (currencyOrUnitAnnotation) {
            relatedProperties.exportUnitString = `${currencyOrUnitAnnotation}`; // Hard-coded currency/unit
          } else if (timezoneAnnotation) {
            relatedProperties.exportTimezoneString = `${timezoneAnnotation}`; // Hard-coded timezone
          }
        }
      }

      relatedProperties = _collectAdditionalPropertiesForAnalyticalTable(property, navigationPathPrefix, tableType, relatedProperties);
      if (Object.keys(relatedProperties.additionalProperties).length > 0 && Object.keys(relatedProperties.properties).length === 0) {
        // Collect underlying property if not collected already.
        // This is to ensure that additionalProperties are made available only to complex property infos.
        valueIndex = _pushUnique(path, property);
        _appendTemplate(`{${valueIndex}}`);
      }
    }
    return relatedProperties;
  }

  /**
   * Collect properties consumed by a DataField.
   * This is for populating the ComplexPropertyInfos of the table delegate.
   *
   * @param dataField The DataField for which the properties need to be identified.
   * @param converterContext The converter context.
   * @param tableType The table type.
   * @param relatedProperties The properties identified so far.
   * @param isEmbedded True if the DataField is embedded in another annotation (e.g. FieldGroup).
   * @returns The properties related to the DataField.
   */
  _exports.collectRelatedProperties = collectRelatedProperties;
  function collectRelatedPropertiesRecursively(dataField, converterContext, tableType) {
    var _dataField$Target, _dataField$Target$$ta, _dataField$Target$$ta2;
    let relatedProperties = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {
      properties: {},
      additionalProperties: {},
      textOnlyPropertiesFromTextAnnotation: []
    };
    let isEmbedded = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
    let isStaticallyHidden = false;
    switch (dataField === null || dataField === void 0 ? void 0 : dataField.$Type) {
      case "com.sap.vocabularies.UI.v1.DataField":
      case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
      case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
      case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
      case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
        if (dataField.Value) {
          var _property$$target, _property$$target$ann, _property$$target$ann2;
          const property = dataField.Value;
          isStaticallyHidden = isReferencePropertyStaticallyHidden((_property$$target = property.$target) === null || _property$$target === void 0 ? void 0 : (_property$$target$ann = _property$$target.annotations) === null || _property$$target$ann === void 0 ? void 0 : (_property$$target$ann2 = _property$$target$ann.UI) === null || _property$$target$ann2 === void 0 ? void 0 : _property$$target$ann2.DataFieldDefault) || isReferencePropertyStaticallyHidden(dataField) || false;
          relatedProperties = collectRelatedProperties(property.path, property.$target, converterContext, false, tableType, relatedProperties, isEmbedded, isStaticallyHidden);
          const navigationPathPrefix = _getNavigationPathPrefix(property.path);
          relatedProperties = _collectAdditionalPropertiesForAnalyticalTable(dataField, navigationPathPrefix, tableType, relatedProperties);
        }
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldForAction":
      case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
        switch ((_dataField$Target = dataField.Target) === null || _dataField$Target === void 0 ? void 0 : (_dataField$Target$$ta = _dataField$Target.$target) === null || _dataField$Target$$ta === void 0 ? void 0 : _dataField$Target$$ta.$Type) {
          case "com.sap.vocabularies.UI.v1.FieldGroupType":
            (_dataField$Target$$ta2 = dataField.Target.$target.Data) === null || _dataField$Target$$ta2 === void 0 ? void 0 : _dataField$Target$$ta2.forEach(innerDataField => {
              relatedProperties = collectRelatedPropertiesRecursively(innerDataField, converterContext, tableType, relatedProperties, true);
            });
            break;
          case "com.sap.vocabularies.UI.v1.DataPointType":
            isStaticallyHidden = isReferencePropertyStaticallyHidden(dataField) ?? false;
            relatedProperties = collectRelatedProperties(dataField.Target.$target.Value.path, dataField, converterContext, false, tableType, relatedProperties, isEmbedded, isStaticallyHidden);
            break;
          case "com.sap.vocabularies.Communication.v1.ContactType":
            const dataFieldContact = dataField.Target.$target;
            isStaticallyHidden = isReferencePropertyStaticallyHidden(dataField) ?? false;
            relatedProperties = collectRelatedProperties(dataField.Target.value, dataFieldContact, converterContext, isStaticallyHidden, tableType, relatedProperties, isEmbedded, isStaticallyHidden);
            break;
          default:
            break;
        }
        break;
      default:
        break;
    }
    return relatedProperties;
  }
  _exports.collectRelatedPropertiesRecursively = collectRelatedPropertiesRecursively;
  const getDataFieldDataType = function (oDataField) {
    var _Value, _Value$$target, _Target, _Target$$target;
    let sDataType = oDataField.$Type;
    switch (sDataType) {
      case "com.sap.vocabularies.UI.v1.DataFieldForAction":
      case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
        sDataType = undefined;
        break;
      case "com.sap.vocabularies.UI.v1.DataField":
      case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
      case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
      case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
      case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
        sDataType = oDataField === null || oDataField === void 0 ? void 0 : (_Value = oDataField.Value) === null || _Value === void 0 ? void 0 : (_Value$$target = _Value.$target) === null || _Value$$target === void 0 ? void 0 : _Value$$target.type;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
      default:
        const sDataTypeForDataFieldForAnnotation = (_Target = oDataField.Target) === null || _Target === void 0 ? void 0 : (_Target$$target = _Target.$target) === null || _Target$$target === void 0 ? void 0 : _Target$$target.$Type;
        if (sDataTypeForDataFieldForAnnotation) {
          var _Target2, _Target4;
          if (((_Target2 = oDataField.Target) === null || _Target2 === void 0 ? void 0 : _Target2.$target.$Type) === "com.sap.vocabularies.Communication.v1.ContactType") {
            var _$target, _Target3, _Target3$$target;
            sDataType = (_$target = ((_Target3 = oDataField.Target) === null || _Target3 === void 0 ? void 0 : (_Target3$$target = _Target3.$target) === null || _Target3$$target === void 0 ? void 0 : _Target3$$target.fn).$target) === null || _$target === void 0 ? void 0 : _$target.type;
          } else if (((_Target4 = oDataField.Target) === null || _Target4 === void 0 ? void 0 : _Target4.$target.$Type) === "com.sap.vocabularies.UI.v1.DataPointType") {
            var _Target5, _Target5$$target, _Target5$$target$Valu, _Target5$$target$Valu2, _Target6, _Target6$$target, _Target6$$target$Valu;
            sDataType = ((_Target5 = oDataField.Target) === null || _Target5 === void 0 ? void 0 : (_Target5$$target = _Target5.$target) === null || _Target5$$target === void 0 ? void 0 : (_Target5$$target$Valu = _Target5$$target.Value) === null || _Target5$$target$Valu === void 0 ? void 0 : (_Target5$$target$Valu2 = _Target5$$target$Valu.$Path) === null || _Target5$$target$Valu2 === void 0 ? void 0 : _Target5$$target$Valu2.$Type) || ((_Target6 = oDataField.Target) === null || _Target6 === void 0 ? void 0 : (_Target6$$target = _Target6.$target) === null || _Target6$$target === void 0 ? void 0 : (_Target6$$target$Valu = _Target6$$target.Value) === null || _Target6$$target$Valu === void 0 ? void 0 : _Target6$$target$Valu.$target.type);
          } else {
            var _Target7;
            // e.g. FieldGroup or Chart
            // FieldGroup Properties have no type, so we define it as a boolean type to prevent exceptions during the calculation of the width
            sDataType = ((_Target7 = oDataField.Target) === null || _Target7 === void 0 ? void 0 : _Target7.$target.$Type) === "com.sap.vocabularies.UI.v1.ChartDefinitionType" ? undefined : "Edm.Boolean";
          }
        } else {
          sDataType = undefined;
        }
        break;
    }
    return sDataType;
  };
  _exports.getDataFieldDataType = getDataFieldDataType;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/annotations/DataField", ["sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/PropertyHelper","../helpers/DataFieldHelper"],function(e,t,a){"use strict";var i={};var o=a.isReferencePropertyStaticallyHidden;var l=t.isProperty;var n=t.isPathExpression;var r=t.getAssociatedUnitProperty;var d=t.getAssociatedTimezoneProperty;var v=t.getAssociatedCurrencyProperty;var s=e.getDisplayMode;function u(e){return e.hasOwnProperty("Action")}i.isDataFieldForActionAbstract=u;function c(e){return e.hasOwnProperty("Value")}i.isDataFieldTypes=c;function p(e){let t;if(l(e)){var a,i,o,r,d,v,s,u,c,p;t=((a=e.annotations)===null||a===void 0?void 0:(i=a.UI)===null||i===void 0?void 0:(o=i.DataFieldDefault)===null||o===void 0?void 0:(r=o.Target)===null||r===void 0?void 0:(d=r.$target)===null||d===void 0?void 0:d.TargetValue)??((v=e.annotations)===null||v===void 0?void 0:(s=v.UI)===null||s===void 0?void 0:(u=s.DataFieldDefault)===null||u===void 0?void 0:(c=u.Target)===null||c===void 0?void 0:(p=c.$target)===null||p===void 0?void 0:p.MaximumValue)}else{t=e.TargetValue??e.MaximumValue}if(typeof t==="number"){return t.toString()}return n(t)?t:"100"}i.getTargetValueOnDataPoint=p;const g=function(e){var t,a,i,o,l;return((t=e.annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(i=a.DataFieldDefault)===null||i===void 0?void 0:(o=i.Target)===null||o===void 0?void 0:(l=o.$target)===null||l===void 0?void 0:l.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"};i.isDataPointFromDataFieldDefault=g;function f(e,t){if(typeof t==="object"){var a;if(c(t)&&(a=t.Value)!==null&&a!==void 0&&a.$target){var i,o,n;const a=(i=t.Value)===null||i===void 0?void 0:i.$target;if((a===null||a===void 0?void 0:(o=a.annotations)===null||o===void 0?void 0:(n=o.Common)===null||n===void 0?void 0:n.SemanticObject)!==undefined){return e.getEntitySetBasedAnnotationPath(a===null||a===void 0?void 0:a.fullyQualifiedName)}}else if(l(t)){var r,d;if((t===null||t===void 0?void 0:(r=t.annotations)===null||r===void 0?void 0:(d=r.Common)===null||d===void 0?void 0:d.SemanticObject)!==undefined){return e.getEntitySetBasedAnnotationPath(t===null||t===void 0?void 0:t.fullyQualifiedName)}}}return undefined}i.getSemanticObjectPath=f;function $(e){return e.indexOf("/")>-1?e.substring(0,e.lastIndexOf("/")+1):""}function m(e,t,a,i){if(a==="AnalyticalTable"){var o,n;const a=(o=e.annotations)===null||o===void 0?void 0:(n=o.UI)===null||n===void 0?void 0:n.Hidden;if(a!==null&&a!==void 0&&a.path&&l(a.$target)){const e=t+a.path;i.additionalProperties[e]=a.$target}}return i}function T(e,t,a,i,o){let n=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{properties:{},additionalProperties:{},textOnlyPropertiesFromTextAnnotation:[]};let u=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;let c=arguments.length>7&&arguments[7]!==undefined?arguments[7]:false;function g(e,t){if(!n.properties.hasOwnProperty(e)){n.properties[e]=t}return Object.keys(n.properties).indexOf(e)}function f(e){n.exportSettingsTemplate=n.exportSettingsTemplate?`${n.exportSettingsTemplate}${e}`:`${e}`}if(e&&t){var T,y;let H;let R;let Q;let G;let q;if(c){H=g(e,t);f(`{${H}}`);return n}const J=$(e);const K=(T=t.annotations)===null||T===void 0?void 0:(y=T.Common)===null||y===void 0?void 0:y.Text;if(n.exportSettingsTemplate){f("\n");n.exportSettingsWrapping=true}if(K!==null&&K!==void 0&&K.path&&K!==null&&K!==void 0&&K.$target){const i=a.getDataModelObjectPath();const o=J+K.path;const l=s(t,i);let r;switch(l){case"Value":H=g(e,t);f(`{${H}}`);break;case"Description":r=g(o,K.$target);f(`{${r}}`);n.textOnlyPropertiesFromTextAnnotation.push(o);break;case"ValueDescription":H=g(e,t);r=g(o,K.$target);f(`{${H}} ({${r}})`);break;case"DescriptionValue":H=g(e,t);r=g(o,K.$target);f(`{${r}} ({${H}})`);break}}else{var b,D,h,F,I,U,P,x,V,k,A,O,S,C,N;const a=v(t)||r(t);const o=(t===null||t===void 0?void 0:(b=t.annotations)===null||b===void 0?void 0:(D=b.Measures)===null||D===void 0?void 0:D.ISOCurrency)||(t===null||t===void 0?void 0:(h=t.annotations)===null||h===void 0?void 0:(F=h.Measures)===null||F===void 0?void 0:F.Unit);const s=d(t);const c=t===null||t===void 0?void 0:(I=t.annotations)===null||I===void 0?void 0:(U=I.Common)===null||U===void 0?void 0:U.Timezone;if(a&&o!==null&&o!==void 0&&o.$target){H=g(e,t);Q=g(J+o.path,o.$target);if(u){f(`{${H}}  {${Q}}`)}else{n.exportUnitName=J+o.path}}else if(s&&c!==null&&c!==void 0&&c.$target){H=g(e,t);G=g(J+c.path,c.$target);if(u){f(`{${H}}  {${G}}`)}else{n.exportTimezoneName=J+c.path}}else if(((P=t.Target)===null||P===void 0?void 0:(x=P.$target)===null||x===void 0?void 0:x.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"&&!((V=t.Target)!==null&&V!==void 0&&(k=V.$target)!==null&&k!==void 0&&k.ValueFormat)||((A=t.annotations)===null||A===void 0?void 0:(O=A.UI)===null||O===void 0?void 0:(S=O.DataFieldDefault)===null||S===void 0?void 0:(C=S.Target)===null||C===void 0?void 0:(N=C.$target)===null||N===void 0?void 0:N.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){var W,j,w,B,M;const a=(W=t.Target)===null||W===void 0?void 0:(j=W.$target)===null||j===void 0?void 0:j.Value.$target;const i=(w=t.Target)===null||w===void 0?void 0:w.$target;const o=(B=t.annotations)===null||B===void 0?void 0:(M=B.UI)===null||M===void 0?void 0:M.DataFieldDefault;H=g(J?J+e:e,o?t:a);R=p(o?t:i);if(l(R.$target)){R=R;q=g(J?J+R.$target.name:R.$target.name,R.$target);f(`{${H}}/{${q}}`)}else{n.exportDataPointTargetValue=R;f(`{${H}}/${R}`)}}else if(t.$Type==="com.sap.vocabularies.Communication.v1.ContactType"){var E,z;const e=(E=t.fn)===null||E===void 0?void 0:E.$target;const a=(z=t.fn)===null||z===void 0?void 0:z.path;H=g(J?J+a:a,e);f(`{${H}}`)}else if(!i){H=g(e,t);f(`{${H}}`);if(o){n.exportUnitString=`${o}`}else if(c){n.exportTimezoneString=`${c}`}}}n=m(t,J,o,n);if(Object.keys(n.additionalProperties).length>0&&Object.keys(n.properties).length===0){H=g(e,t);f(`{${H}}`)}}return n}i.collectRelatedProperties=T;function y(e,t,a){var i,l,n;let r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{properties:{},additionalProperties:{},textOnlyPropertiesFromTextAnnotation:[]};let d=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;let v=false;switch(e===null||e===void 0?void 0:e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(e.Value){var s,u,c;const i=e.Value;v=o((s=i.$target)===null||s===void 0?void 0:(u=s.annotations)===null||u===void 0?void 0:(c=u.UI)===null||c===void 0?void 0:c.DataFieldDefault)||o(e)||false;r=T(i.path,i.$target,t,false,a,r,d,v);const l=$(i.path);r=m(e,l,a,r)}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":switch((i=e.Target)===null||i===void 0?void 0:(l=i.$target)===null||l===void 0?void 0:l.$Type){case"com.sap.vocabularies.UI.v1.FieldGroupType":(n=e.Target.$target.Data)===null||n===void 0?void 0:n.forEach(e=>{r=y(e,t,a,r,true)});break;case"com.sap.vocabularies.UI.v1.DataPointType":v=o(e)??false;r=T(e.Target.$target.Value.path,e,t,false,a,r,d,v);break;case"com.sap.vocabularies.Communication.v1.ContactType":const i=e.Target.$target;v=o(e)??false;r=T(e.Target.value,i,t,v,a,r,d,v);break;default:break}break;default:break}return r}i.collectRelatedPropertiesRecursively=y;const b=function(e){var t,a,i,o;let l=e.$Type;switch(l){case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":l=undefined;break;case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":l=e===null||e===void 0?void 0:(t=e.Value)===null||t===void 0?void 0:(a=t.$target)===null||a===void 0?void 0:a.type;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":default:const y=(i=e.Target)===null||i===void 0?void 0:(o=i.$target)===null||o===void 0?void 0:o.$Type;if(y){var n,r;if(((n=e.Target)===null||n===void 0?void 0:n.$target.$Type)==="com.sap.vocabularies.Communication.v1.ContactType"){var d,v,s;l=(d=((v=e.Target)===null||v===void 0?void 0:(s=v.$target)===null||s===void 0?void 0:s.fn).$target)===null||d===void 0?void 0:d.type}else if(((r=e.Target)===null||r===void 0?void 0:r.$target.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){var u,c,p,g,f,$,m;l=((u=e.Target)===null||u===void 0?void 0:(c=u.$target)===null||c===void 0?void 0:(p=c.Value)===null||p===void 0?void 0:(g=p.$Path)===null||g===void 0?void 0:g.$Type)||((f=e.Target)===null||f===void 0?void 0:($=f.$target)===null||$===void 0?void 0:(m=$.Value)===null||m===void 0?void 0:m.$target.type)}else{var T;l=((T=e.Target)===null||T===void 0?void 0:T.$target.$Type)==="com.sap.vocabularies.UI.v1.ChartDefinitionType"?undefined:"Edm.Boolean"}}else{l=undefined}break}return l};i.getDataFieldDataType=b;return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
 sap.ui.predefine("sap/fe/core/converters/common/AnnotationConverter-dbg", [], function() {
    var AnnotationConverter;
/******/ (function() { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ 634:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.convert = void 0;
const utils_1 = __webpack_require__(401);
/**
 *
 */
class Path {
    /**
     * @param pathExpression
     * @param targetName
     * @param annotationsTerm
     * @param term
     */
    constructor(pathExpression, targetName, annotationsTerm, term) {
        this.path = pathExpression.Path;
        this.type = 'Path';
        this.$target = targetName;
        this.term = term;
        this.annotationsTerm = annotationsTerm;
    }
}
/**
 * Creates a Map based on the fullyQualifiedName of each object part of the metadata.
 *
 * @param rawMetadata the rawMetadata we're working against
 * @returns the objectmap for easy access to the different object of the metadata
 */
function buildObjectMap(rawMetadata) {
    var _a;
    const objectMap = {};
    if ((_a = rawMetadata.schema.entityContainer) === null || _a === void 0 ? void 0 : _a.fullyQualifiedName) {
        objectMap[rawMetadata.schema.entityContainer.fullyQualifiedName] = rawMetadata.schema.entityContainer;
    }
    for (const entitySet of rawMetadata.schema.entitySets) {
        objectMap[entitySet.fullyQualifiedName] = entitySet;
    }
    for (const singleton of rawMetadata.schema.singletons) {
        objectMap[singleton.fullyQualifiedName] = singleton;
    }
    for (const action of rawMetadata.schema.actions) {
        objectMap[action.fullyQualifiedName] = action;
        if (action.isBound) {
            const unBoundActionName = action.fullyQualifiedName.split('(')[0];
            if (!objectMap[unBoundActionName]) {
                objectMap[unBoundActionName] = {
                    _type: 'UnboundGenericAction',
                    actions: []
                };
            }
            objectMap[unBoundActionName].actions.push(action);
            const actionSplit = action.fullyQualifiedName.split('(');
            objectMap[`${actionSplit[1].split(')')[0]}/${actionSplit[0]}`] = action;
        }
        for (const parameter of action.parameters) {
            objectMap[parameter.fullyQualifiedName] = parameter;
        }
    }
    for (const actionImport of rawMetadata.schema.actionImports) {
        objectMap[actionImport.fullyQualifiedName] = actionImport;
    }
    for (const complexType of rawMetadata.schema.complexTypes) {
        objectMap[complexType.fullyQualifiedName] = complexType;
        for (const property of complexType.properties) {
            objectMap[property.fullyQualifiedName] = property;
        }
    }
    for (const typeDefinition of rawMetadata.schema.typeDefinitions) {
        objectMap[typeDefinition.fullyQualifiedName] = typeDefinition;
    }
    for (const entityType of rawMetadata.schema.entityTypes) {
        entityType.annotations = {}; // 'annotations' property is mandatory
        objectMap[entityType.fullyQualifiedName] = entityType;
        objectMap[`Collection(${entityType.fullyQualifiedName})`] = entityType;
        for (const property of entityType.entityProperties) {
            objectMap[property.fullyQualifiedName] = property;
            // Handle complex types
            const complexTypeDefinition = objectMap[property.type];
            if ((0, utils_1.isComplexTypeDefinition)(complexTypeDefinition)) {
                for (const complexTypeProp of complexTypeDefinition.properties) {
                    const complexTypePropTarget = Object.assign(complexTypeProp, {
                        _type: 'Property',
                        fullyQualifiedName: property.fullyQualifiedName + '/' + complexTypeProp.name
                    });
                    objectMap[complexTypePropTarget.fullyQualifiedName] = complexTypePropTarget;
                }
            }
        }
        for (const navProperty of entityType.navigationProperties) {
            objectMap[navProperty.fullyQualifiedName] = navProperty;
        }
    }
    for (const annotationSource of Object.keys(rawMetadata.schema.annotations)) {
        for (const annotationList of rawMetadata.schema.annotations[annotationSource]) {
            const currentTargetName = (0, utils_1.unalias)(rawMetadata.references, annotationList.target);
            annotationList.annotations.forEach((annotation) => {
                let annotationFQN = `${currentTargetName}@${(0, utils_1.unalias)(rawMetadata.references, annotation.term)}`;
                if (annotation.qualifier) {
                    annotationFQN += `#${annotation.qualifier}`;
                }
                objectMap[annotationFQN] = annotation;
                annotation.fullyQualifiedName = annotationFQN;
            });
        }
    }
    return objectMap;
}
/**
 * Combine two strings representing path in the metamodel while ensuring their specificities (annotation...) are respected.
 *
 * @param currentTarget the current path
 * @param path the part we want to append
 * @returns the complete path including the extension.
 */
function combinePath(currentTarget, path) {
    if (path.startsWith('@')) {
        return currentTarget + (0, utils_1.unalias)(utils_1.defaultReferences, path);
    }
    else {
        return currentTarget + '/' + path;
    }
}
const ALL_ANNOTATION_ERRORS = {};
let ANNOTATION_ERRORS = [];
/**
 * @param path
 * @param oErrorMsg
 */
function addAnnotationErrorMessage(path, oErrorMsg) {
    if (!ALL_ANNOTATION_ERRORS[path]) {
        ALL_ANNOTATION_ERRORS[path] = [oErrorMsg];
    }
    else {
        ALL_ANNOTATION_ERRORS[path].push(oErrorMsg);
    }
}
/**
 * Resolves a specific path based on the objectMap.
 *
 * @param objectMap
 * @param currentTarget
 * @param path
 * @param pathOnly
 * @param includeVisitedObjects
 * @param annotationsTerm
 * @returns the resolved object
 */
function _resolveTarget(objectMap, currentTarget, path, pathOnly = false, includeVisitedObjects = false, annotationsTerm) {
    let oErrorMsg;
    if (!path) {
        return undefined;
    }
    const aVisitedObjects = [];
    if (currentTarget && currentTarget._type === 'Property') {
        currentTarget = objectMap[currentTarget.fullyQualifiedName.split('/')[0]];
    }
    path = combinePath(currentTarget.fullyQualifiedName, path);
    const pathSplit = path.split('/');
    const targetPathSplit = [];
    pathSplit.forEach((pathPart) => {
        // Separate out the annotation
        if (pathPart.indexOf('@') !== -1) {
            const [splittedPath, annotationPath] = pathPart.split('@');
            targetPathSplit.push(splittedPath);
            targetPathSplit.push(`@${annotationPath}`);
        }
        else {
            targetPathSplit.push(pathPart);
        }
    });
    let currentPath = path;
    let currentContext = currentTarget;
    const target = targetPathSplit.reduce((currentValue, pathPart) => {
        if (pathPart === '$Type' && currentValue._type === 'EntityType') {
            return currentValue;
        }
        if (pathPart === '$' && currentValue._type === 'EntitySet') {
            return currentValue;
        }
        if ((pathPart === '@$ui5.overload' || pathPart === '0') && currentValue._type === 'Action') {
            return currentValue;
        }
        if (pathPart.length === 0) {
            // Empty Path after an entitySet means entityType
            if (currentValue &&
                (currentValue._type === 'EntitySet' || currentValue._type === 'Singleton') &&
                currentValue.entityType) {
                if (includeVisitedObjects) {
                    aVisitedObjects.push(currentValue);
                }
                currentValue = currentValue.entityType;
            }
            if (currentValue && currentValue._type === 'NavigationProperty' && currentValue.targetType) {
                if (includeVisitedObjects) {
                    aVisitedObjects.push(currentValue);
                }
                currentValue = currentValue.targetType;
            }
            return currentValue;
        }
        if (includeVisitedObjects && currentValue !== null && currentValue !== undefined) {
            aVisitedObjects.push(currentValue);
        }
        if (!currentValue) {
            currentPath = pathPart;
        }
        else if ((currentValue._type === 'EntitySet' || currentValue._type === 'Singleton') && pathPart === '$Type') {
            currentValue = currentValue.targetType;
            return currentValue;
        }
        else if ((currentValue._type === 'EntitySet' || currentValue._type === 'Singleton') &&
            pathPart === '$NavigationPropertyBinding') {
            currentValue = currentValue.navigationPropertyBinding;
            return currentValue;
        }
        else if ((currentValue._type === 'EntitySet' || currentValue._type === 'Singleton') &&
            currentValue.entityType) {
            currentPath = combinePath(currentValue.entityTypeName, pathPart);
        }
        else if (currentValue._type === 'NavigationProperty') {
            currentPath = combinePath(currentValue.fullyQualifiedName, pathPart);
            if (!objectMap[currentPath]) {
                // Fallback log error
                currentPath = combinePath(currentValue.targetTypeName, pathPart);
            }
        }
        else if (currentValue._type === 'Property') {
            // ComplexType or Property
            if (currentValue.targetType) {
                currentPath = combinePath(currentValue.targetType.fullyQualifiedName, pathPart);
            }
            else {
                currentPath = combinePath(currentValue.fullyQualifiedName, pathPart);
            }
        }
        else if (currentValue._type === 'Action' && currentValue.isBound) {
            currentPath = combinePath(currentValue.fullyQualifiedName, pathPart);
            if (pathPart === '$Parameter') {
                return currentValue.parameters;
            }
            if (!objectMap[currentPath]) {
                currentPath = combinePath(currentValue.sourceType, pathPart);
            }
        }
        else if (currentValue._type === 'ActionParameter') {
            currentPath = combinePath(currentTarget.fullyQualifiedName.substring(0, currentTarget.fullyQualifiedName.lastIndexOf('/')), pathPart);
            if (!objectMap[currentPath]) {
                let lastIdx = currentTarget.fullyQualifiedName.lastIndexOf('/');
                if (lastIdx === -1) {
                    lastIdx = currentTarget.fullyQualifiedName.length;
                }
                currentPath = combinePath(objectMap[currentTarget.fullyQualifiedName.substring(0, lastIdx)].sourceType, pathPart);
            }
        }
        else {
            currentPath = combinePath(currentValue.fullyQualifiedName, pathPart);
            if (pathPart !== 'name' && currentValue[pathPart] !== undefined) {
                return currentValue[pathPart];
            }
            else if (pathPart === '$AnnotationPath' && currentValue.$target) {
                const contextToResolve = objectMap[currentValue.fullyQualifiedName.split('@')[0]];
                const subTarget = _resolveTarget(objectMap, contextToResolve, currentValue.value, false, true);
                subTarget.visitedObjects.forEach((visitedSubObject) => {
                    if (aVisitedObjects.indexOf(visitedSubObject) === -1) {
                        aVisitedObjects.push(visitedSubObject);
                    }
                });
                return subTarget.target;
            }
            else if (pathPart === '$Path' && currentValue.$target) {
                currentContext = aVisitedObjects
                    .concat()
                    .reverse()
                    .find((obj) => obj._type === 'EntityType' ||
                    obj._type === 'EntitySet' ||
                    obj._type === 'Singleton' ||
                    obj._type === 'NavigationProperty');
                if (currentContext) {
                    const subTarget = _resolveTarget(objectMap, currentContext, currentValue.path, false, true);
                    subTarget.visitedObjects.forEach((visitedSubObject) => {
                        if (aVisitedObjects.indexOf(visitedSubObject) === -1) {
                            aVisitedObjects.push(visitedSubObject);
                        }
                    });
                    return subTarget.target;
                }
                return currentValue.$target;
            }
            else if (pathPart.startsWith('$Path') && currentValue.$target) {
                const intermediateTarget = currentValue.$target;
                currentPath = combinePath(intermediateTarget.fullyQualifiedName, pathPart.substring(5));
            }
            else if (currentValue.hasOwnProperty('$Type') && !objectMap[currentPath]) {
                // This is now an annotation value
                const entityType = objectMap[currentValue.fullyQualifiedName.split('@')[0]];
                if (entityType) {
                    currentPath = combinePath(entityType.fullyQualifiedName, pathPart);
                }
            }
        }
        return objectMap[currentPath];
    }, null);
    if (!target) {
        if (annotationsTerm) {
            const annotationType = inferTypeFromTerm(annotationsTerm, currentTarget);
            oErrorMsg = {
                message: 'Unable to resolve the path expression: ' +
                    '\n' +
                    path +
                    '\n' +
                    '\n' +
                    'Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n' +
                    '<Annotation Term = ' +
                    annotationsTerm +
                    '>' +
                    '\n' +
                    '<Record Type = ' +
                    annotationType +
                    '>' +
                    '\n' +
                    '<AnnotationPath = ' +
                    path +
                    '>'
            };
            addAnnotationErrorMessage(path, oErrorMsg);
        }
        else {
            oErrorMsg = {
                message: 'Unable to resolve the path expression: ' +
                    path +
                    '\n' +
                    '\n' +
                    'Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n' +
                    '<Annotation Term = ' +
                    pathSplit[0] +
                    '>' +
                    '\n' +
                    '<PropertyValue  Path= ' +
                    pathSplit[1] +
                    '>'
            };
            addAnnotationErrorMessage(path, oErrorMsg);
        }
    }
    if (pathOnly) {
        return currentPath;
    }
    if (includeVisitedObjects) {
        return {
            visitedObjects: aVisitedObjects,
            target: target
        };
    }
    return target;
}
/**
 * Typeguard to check if the path contains an annotation.
 *
 * @param pathStr the path to evaluate
 * @returns true if there is an annotation in the path.
 */
function isAnnotationPath(pathStr) {
    return pathStr.indexOf('@') !== -1;
}
function parseValue(propertyValue, valueFQN, objectMap, context) {
    if (propertyValue === undefined) {
        return undefined;
    }
    switch (propertyValue.type) {
        case 'String':
            return propertyValue.String;
        case 'Int':
            return propertyValue.Int;
        case 'Bool':
            return propertyValue.Bool;
        case 'Decimal':
            return (0, utils_1.Decimal)(propertyValue.Decimal);
        case 'Date':
            return propertyValue.Date;
        case 'EnumMember':
            return (0, utils_1.alias)(context.rawMetadata.references, propertyValue.EnumMember);
        case 'PropertyPath':
            return {
                type: 'PropertyPath',
                value: propertyValue.PropertyPath,
                fullyQualifiedName: valueFQN,
                $target: _resolveTarget(objectMap, context.currentTarget, propertyValue.PropertyPath, false, false, context.currentTerm)
            };
        case 'NavigationPropertyPath':
            return {
                type: 'NavigationPropertyPath',
                value: propertyValue.NavigationPropertyPath,
                fullyQualifiedName: valueFQN,
                $target: _resolveTarget(objectMap, context.currentTarget, propertyValue.NavigationPropertyPath, false, false, context.currentTerm)
            };
        case 'AnnotationPath':
            const annotationTarget = _resolveTarget(objectMap, context.currentTarget, (0, utils_1.unalias)(context.rawMetadata.references, propertyValue.AnnotationPath), true, false, context.currentTerm);
            const annotationPath = {
                type: 'AnnotationPath',
                value: propertyValue.AnnotationPath,
                fullyQualifiedName: valueFQN,
                $target: annotationTarget,
                annotationsTerm: context.currentTerm,
                term: '',
                path: ''
            };
            context.unresolvedAnnotations.push({ inline: false, toResolve: annotationPath });
            return annotationPath;
        case 'Path':
            const $target = _resolveTarget(objectMap, context.currentTarget, propertyValue.Path, true, false, context.currentTerm);
            const path = new Path(propertyValue, $target, context.currentTerm, '');
            context.unresolvedAnnotations.push({
                inline: isAnnotationPath(propertyValue.Path),
                toResolve: path
            });
            return path;
        case 'Record':
            return parseRecord(propertyValue.Record, valueFQN, objectMap, context);
        case 'Collection':
            return parseCollection(propertyValue.Collection, valueFQN, objectMap, context);
        case 'Apply':
        case 'Null':
        case 'Not':
        case 'Eq':
        case 'Ne':
        case 'Gt':
        case 'Ge':
        case 'Lt':
        case 'Le':
        case 'If':
        case 'And':
        case 'Or':
        default:
            return propertyValue;
    }
}
/**
 * Infer the type of a term based on its type.
 *
 * @param annotationsTerm The annotation term
 * @param annotationTarget the annotation target
 * @param currentProperty the current property of the record
 * @returns the inferred type.
 */
function inferTypeFromTerm(annotationsTerm, annotationTarget, currentProperty) {
    let targetType = utils_1.TermToTypes[annotationsTerm];
    if (currentProperty) {
        annotationsTerm = annotationsTerm.split('.').slice(0, -1).join('.') + '.' + currentProperty;
        targetType = utils_1.TermToTypes[annotationsTerm];
    }
    const oErrorMsg = {
        isError: false,
        message: `The type of the record used within the term ${annotationsTerm} was not defined and was inferred as ${targetType}.
Hint: If possible, try to maintain the Type property for each Record.
<Annotations Target="${annotationTarget}">
	<Annotation Term="${annotationsTerm}">
		<Record>...</Record>
	</Annotation>
</Annotations>`
    };
    addAnnotationErrorMessage(annotationTarget + '/' + annotationsTerm, oErrorMsg);
    return targetType;
}
function isDataFieldWithForAction(annotationContent, annotationTerm) {
    return (annotationContent.hasOwnProperty('Action') &&
        (annotationTerm.$Type === 'com.sap.vocabularies.UI.v1.DataFieldForAction' ||
            annotationTerm.$Type === 'com.sap.vocabularies.UI.v1.DataFieldWithAction'));
}
function parseRecordType(recordDefinition, context) {
    let targetType;
    if (!recordDefinition.type && context.currentTerm) {
        targetType = inferTypeFromTerm(context.currentTerm, context.currentTarget.fullyQualifiedName, context.currentProperty);
    }
    else {
        targetType = (0, utils_1.unalias)(context.rawMetadata.references, recordDefinition.type);
    }
    return targetType;
}
function parseRecord(recordDefinition, currentFQN, objectMap, context) {
    const targetType = parseRecordType(recordDefinition, context);
    const annotationTerm = {
        $Type: targetType,
        fullyQualifiedName: currentFQN,
        annotations: {}
    };
    const annotationContent = {};
    if (Array.isArray(recordDefinition.annotations)) {
        const subAnnotationList = {
            target: currentFQN,
            annotations: recordDefinition.annotations,
            __source: context.currentSource
        };
        context.additionalAnnotations.push(subAnnotationList);
    }
    if (recordDefinition.propertyValues) {
        recordDefinition.propertyValues.forEach((propertyValue) => {
            var _a;
            context.currentProperty = propertyValue.name;
            annotationContent[propertyValue.name] = parseValue(propertyValue.value, `${currentFQN}/${propertyValue.name}`, objectMap, context);
            if (Array.isArray(propertyValue.annotations)) {
                const subAnnotationList = {
                    target: `${currentFQN}/${propertyValue.name}`,
                    annotations: propertyValue.annotations,
                    __source: context.currentSource
                };
                context.additionalAnnotations.push(subAnnotationList);
            }
            if (isDataFieldWithForAction(annotationContent, annotationTerm)) {
                // try to resolve to a bound action of the annotation target
                annotationContent.ActionTarget = (_a = context.currentTarget.actions) === null || _a === void 0 ? void 0 : _a[annotationContent.Action];
                if (!annotationContent.ActionTarget) {
                    const action = objectMap[annotationContent.Action];
                    if (action === null || action === void 0 ? void 0 : action.isBound) {
                        // bound action of a different entity type
                        annotationContent.ActionTarget = action;
                    }
                    else if (action) {
                        // unbound action --> resolve via the action import
                        annotationContent.ActionTarget = action.action;
                    }
                }
                if (!annotationContent.ActionTarget) {
                    // Add to diagnostics debugger;
                    ANNOTATION_ERRORS.push({
                        message: 'Unable to resolve the action ' +
                            annotationContent.Action +
                            ' defined for ' +
                            annotationTerm.fullyQualifiedName
                    });
                }
            }
        });
        context.currentProperty = undefined;
    }
    return Object.assign(annotationTerm, annotationContent);
}
/**
 * Retrieve or infer the collection type based on its content.
 *
 * @param collectionDefinition
 * @returns the type of the collection
 */
function getOrInferCollectionType(collectionDefinition) {
    let type = collectionDefinition.type;
    if (type === undefined && collectionDefinition.length > 0) {
        const firstColItem = collectionDefinition[0];
        if (firstColItem.hasOwnProperty('PropertyPath')) {
            type = 'PropertyPath';
        }
        else if (firstColItem.hasOwnProperty('Path')) {
            type = 'Path';
        }
        else if (firstColItem.hasOwnProperty('AnnotationPath')) {
            type = 'AnnotationPath';
        }
        else if (firstColItem.hasOwnProperty('NavigationPropertyPath')) {
            type = 'NavigationPropertyPath';
        }
        else if (typeof firstColItem === 'object' &&
            (firstColItem.hasOwnProperty('type') || firstColItem.hasOwnProperty('propertyValues'))) {
            type = 'Record';
        }
        else if (typeof firstColItem === 'string') {
            type = 'String';
        }
    }
    else if (type === undefined) {
        type = 'EmptyCollection';
    }
    return type;
}
function parseCollection(collectionDefinition, parentFQN, objectMap, context) {
    const collectionDefinitionType = getOrInferCollectionType(collectionDefinition);
    switch (collectionDefinitionType) {
        case 'PropertyPath':
            return collectionDefinition.map((propertyPath, propertyIdx) => {
                return {
                    type: 'PropertyPath',
                    value: propertyPath.PropertyPath,
                    fullyQualifiedName: `${parentFQN}/${propertyIdx}`,
                    $target: _resolveTarget(objectMap, context.currentTarget, propertyPath.PropertyPath, false, false, context.currentTerm)
                };
            });
        case 'Path':
            return collectionDefinition.map((pathValue) => {
                const $target = _resolveTarget(objectMap, context.currentTarget, pathValue.Path, true, false, context.currentTerm);
                const path = new Path(pathValue, $target, context.currentTerm, '');
                context.unresolvedAnnotations.push({
                    inline: isAnnotationPath(pathValue.Path),
                    toResolve: path
                });
                return path;
            });
        case 'AnnotationPath':
            return collectionDefinition.map((annotationPath, annotationIdx) => {
                const annotationTarget = _resolveTarget(objectMap, context.currentTarget, annotationPath.AnnotationPath, true, false, context.currentTerm);
                const annotationCollectionElement = {
                    type: 'AnnotationPath',
                    value: annotationPath.AnnotationPath,
                    fullyQualifiedName: `${parentFQN}/${annotationIdx}`,
                    $target: annotationTarget,
                    annotationsTerm: context.currentTerm,
                    term: '',
                    path: ''
                };
                context.unresolvedAnnotations.push({
                    inline: false,
                    toResolve: annotationCollectionElement
                });
                return annotationCollectionElement;
            });
        case 'NavigationPropertyPath':
            return collectionDefinition.map((navPropertyPath, navPropIdx) => {
                return {
                    type: 'NavigationPropertyPath',
                    value: navPropertyPath.NavigationPropertyPath,
                    fullyQualifiedName: `${parentFQN}/${navPropIdx}`,
                    $target: _resolveTarget(objectMap, context.currentTarget, navPropertyPath.NavigationPropertyPath, false, false, context.currentTerm)
                };
            });
        case 'Record':
            return collectionDefinition.map((recordDefinition, recordIdx) => {
                return parseRecord(recordDefinition, `${parentFQN}/${recordIdx}`, objectMap, context);
            });
        case 'Apply':
        case 'Null':
        case 'If':
        case 'Eq':
        case 'Ne':
        case 'Lt':
        case 'Gt':
        case 'Le':
        case 'Ge':
        case 'Not':
        case 'And':
        case 'Or':
            return collectionDefinition.map((ifValue) => {
                return ifValue;
            });
        case 'String':
            return collectionDefinition.map((stringValue) => {
                if (typeof stringValue === 'string') {
                    return stringValue;
                }
                else if (stringValue === undefined) {
                    return stringValue;
                }
                else {
                    return stringValue.String;
                }
            });
        default:
            if (collectionDefinition.length === 0) {
                return [];
            }
            throw new Error('Unsupported case');
    }
}
function convertAnnotation(annotation, objectMap, context) {
    if (annotation.record) {
        return parseRecord(annotation.record, annotation.fullyQualifiedName, objectMap, context);
    }
    else if (annotation.collection === undefined) {
        if (annotation.value) {
            return parseValue(annotation.value, annotation.fullyQualifiedName, objectMap, context);
        }
        else {
            return true;
        }
    }
    else if (annotation.collection) {
        const collection = parseCollection(annotation.collection, annotation.fullyQualifiedName, objectMap, context);
        collection.fullyQualifiedName = annotation.fullyQualifiedName;
        return collection;
    }
    else {
        throw new Error('Unsupported case');
    }
}
/**
 * Creates a resolvePath function for a given entityType.
 *
 * @param entityType The entityType for which the function should be created
 * @param objectMap The current objectMap
 * @returns the resolvePath function that starts at the entityType
 */
function createResolvePathFn(entityType, objectMap) {
    return function (relativePath, includeVisitedObjects) {
        const annotationTerm = '';
        return _resolveTarget(objectMap, entityType, relativePath, false, includeVisitedObjects, annotationTerm);
    };
}
function resolveV2NavigationProperty(navProp, associations, objectMap, outNavProp) {
    const targetAssociation = associations.find((association) => association.fullyQualifiedName === navProp.relationship);
    if (targetAssociation) {
        const associationEnd = targetAssociation.associationEnd.find((end) => end.role === navProp.toRole);
        if (associationEnd) {
            outNavProp.targetType = objectMap[associationEnd.type];
            outNavProp.isCollection = associationEnd.multiplicity === '*';
        }
    }
    outNavProp.referentialConstraint = navProp.referentialConstraint || [];
}
function resolveV4NavigationProperty(navProp, objectMap, outNavProp) {
    outNavProp.targetType = objectMap[navProp.targetTypeName];
    outNavProp.partner = navProp.partner;
    outNavProp.isCollection = navProp.isCollection;
    outNavProp.containsTarget = navProp.containsTarget;
    outNavProp.referentialConstraint = navProp.referentialConstraint;
}
function isV4NavigationProperty(navProp) {
    return !!navProp.targetTypeName;
}
function prepareNavigationProperties(navigationProperties, associations, objectMap) {
    return navigationProperties.map((navProp) => {
        const outNavProp = {
            _type: 'NavigationProperty',
            name: navProp.name,
            fullyQualifiedName: navProp.fullyQualifiedName,
            isCollection: false,
            containsTarget: false,
            referentialConstraint: [],
            annotations: {},
            partner: '',
            targetType: undefined,
            targetTypeName: ''
        };
        if (isV4NavigationProperty(navProp)) {
            resolveV4NavigationProperty(navProp, objectMap, outNavProp);
        }
        else {
            resolveV2NavigationProperty(navProp, associations, objectMap, outNavProp);
        }
        if (outNavProp.targetType) {
            outNavProp.targetTypeName = outNavProp.targetType.fullyQualifiedName;
        }
        objectMap[outNavProp.fullyQualifiedName] = outNavProp;
        return outNavProp;
    });
}
/**
 * @param entityTypes
 * @param associations
 * @param objectMap
 */
function resolveNavigationProperties(entityTypes, associations, objectMap) {
    entityTypes.forEach((entityType) => {
        entityType.navigationProperties = prepareNavigationProperties(entityType.navigationProperties, associations, objectMap);
        entityType.resolvePath = createResolvePathFn(entityType, objectMap);
    });
}
/**
 * @param namespace
 * @param actions
 * @param objectMap
 */
function linkActionsToEntityType(namespace, actions, objectMap) {
    actions.forEach((action) => {
        if (!action.annotations) {
            action.annotations = {};
        }
        if (action.isBound) {
            const sourceEntityType = objectMap[action.sourceType];
            action.sourceEntityType = sourceEntityType;
            if (sourceEntityType) {
                if (!sourceEntityType.actions) {
                    sourceEntityType.actions = {};
                }
                sourceEntityType.actions[`${namespace}.${action.name}`] = action;
            }
            action.returnEntityType = objectMap[action.returnType];
        }
    });
}
function linkActionImportsToActions(actionImports, objectMap) {
    actionImports.forEach((actionImport) => {
        actionImport.action = objectMap[actionImport.actionName];
    });
}
/**
 * @param entitySets
 * @param objectMap
 * @param references
 */
function linkEntityTypeToEntitySet(entitySets, objectMap, references) {
    entitySets.forEach((entitySet) => {
        entitySet.entityType = objectMap[entitySet.entityTypeName];
        if (!entitySet.entityType) {
            entitySet.entityType = objectMap[(0, utils_1.unalias)(references, entitySet.entityTypeName)];
        }
        if (!entitySet.annotations) {
            entitySet.annotations = {};
        }
        if (!entitySet.entityType.annotations) {
            entitySet.entityType.annotations = {};
        }
        entitySet.entityType.keys.forEach((keyProp) => {
            keyProp.isKey = true;
        });
    });
}
/**
 * @param singletons
 * @param objectMap
 * @param references
 */
function linkEntityTypeToSingleton(singletons, objectMap, references) {
    singletons.forEach((singleton) => {
        singleton.entityType = objectMap[singleton.entityTypeName];
        if (!singleton.entityType) {
            singleton.entityType = objectMap[(0, utils_1.unalias)(references, singleton.entityTypeName)];
        }
        if (!singleton.annotations) {
            singleton.annotations = {};
        }
        if (!singleton.entityType.annotations) {
            singleton.entityType.annotations = {};
        }
        singleton.entityType.keys.forEach((keyProp) => {
            keyProp.isKey = true;
        });
    });
}
/**
 * @param entityTypes
 * @param objectMap
 */
function linkPropertiesToComplexTypes(entityTypes, objectMap) {
    /**
     * @param property
     */
    function link(property) {
        if (!property.annotations) {
            property.annotations = {};
        }
        try {
            if (property.type.indexOf('Edm') !== 0) {
                let complexType;
                if (property.type.startsWith('Collection')) {
                    const complexTypeName = property.type.substring(11, property.type.length - 1);
                    complexType = objectMap[complexTypeName];
                }
                else {
                    complexType = objectMap[property.type];
                }
                if (complexType) {
                    property.targetType = complexType;
                    if (complexType.properties) {
                        complexType.properties.forEach(link);
                    }
                }
            }
        }
        catch (sError) {
            throw new Error('Property Type is not defined');
        }
    }
    entityTypes.forEach((entityType) => {
        entityType.entityProperties.forEach(link);
    });
}
/**
 * @param complexTypes
 * @param associations
 * @param objectMap
 */
function prepareComplexTypes(complexTypes, associations, objectMap) {
    complexTypes.forEach((complexType) => {
        complexType.annotations = {};
        complexType.properties.forEach((property) => {
            if (!property.annotations) {
                property.annotations = {};
            }
        });
        complexType.navigationProperties = prepareNavigationProperties(complexType.navigationProperties, associations, objectMap);
    });
}
/**
 * Split the alias from the term value.
 *
 * @param references the current set of references
 * @param termValue the value of the term
 * @returns the term alias and the actual term value
 */
function splitTerm(references, termValue) {
    const aliasedTerm = (0, utils_1.alias)(references, termValue);
    const lastDot = aliasedTerm.lastIndexOf('.');
    const termAlias = aliasedTerm.substring(0, lastDot);
    const term = aliasedTerm.substring(lastDot + 1);
    return [termAlias, term];
}
/**
 * Creates the function that will resolve a specific path.
 *
 * @param convertedOutput
 * @param objectMap
 * @returns the function that will allow to resolve element globally.
 */
function createGlobalResolve(convertedOutput, objectMap) {
    return function resolvePath(sPath, resolveDirectly = false) {
        if (resolveDirectly) {
            let targetPath = sPath;
            if (!sPath.startsWith('/')) {
                targetPath = `/${sPath}`;
            }
            const targetResolution = _resolveTarget(objectMap, convertedOutput, targetPath, false, true);
            if (targetResolution.target) {
                targetResolution.visitedObjects.push(targetResolution.target);
            }
            return {
                target: targetResolution.target,
                objectPath: targetResolution.visitedObjects
            };
        }
        const aPathSplit = sPath.split('/');
        if (aPathSplit.shift() !== '') {
            throw new Error('Cannot deal with relative path');
        }
        const entitySetName = aPathSplit.shift();
        const entitySet = convertedOutput.entitySets.find((et) => et.name === entitySetName);
        const singleton = convertedOutput.singletons.find((et) => et.name === entitySetName);
        if (!entitySet && !singleton) {
            return {
                target: convertedOutput.entityContainer,
                objectPath: [convertedOutput.entityContainer]
            };
        }
        if (aPathSplit.length === 0) {
            return {
                target: entitySet || singleton,
                objectPath: [convertedOutput.entityContainer, entitySet || singleton]
            };
        }
        else {
            const targetResolution = _resolveTarget(objectMap, entitySet || singleton, '/' + aPathSplit.join('/'), false, true);
            if (targetResolution.target) {
                targetResolution.visitedObjects.push(targetResolution.target);
            }
            return {
                target: targetResolution.target,
                objectPath: targetResolution.visitedObjects
            };
        }
    };
}
function ensureAnnotations(currentTarget, vocAlias) {
    if (!currentTarget.annotations) {
        currentTarget.annotations = {};
    }
    if (!currentTarget.annotations[vocAlias]) {
        currentTarget.annotations[vocAlias] = {};
    }
    if (!currentTarget.annotations._annotations) {
        currentTarget.annotations._annotations = {};
    }
}
function processAnnotations(currentContext, annotationList, objectMap, bOverrideExisting) {
    const currentTarget = currentContext.currentTarget;
    const currentTargetName = currentTarget.fullyQualifiedName;
    annotationList.annotations.forEach((annotation) => {
        var _a, _b;
        currentContext.currentSource = annotation.__source || annotationList.__source;
        const [vocAlias, vocTerm] = splitTerm(utils_1.defaultReferences, annotation.term);
        ensureAnnotations(currentTarget, vocAlias);
        const vocTermWithQualifier = `${vocTerm}${annotation.qualifier ? '#' + annotation.qualifier : ''}`;
        if (!bOverrideExisting && ((_b = (_a = currentTarget.annotations) === null || _a === void 0 ? void 0 : _a[vocAlias]) === null || _b === void 0 ? void 0 : _b[vocTermWithQualifier]) !== undefined) {
            return;
        }
        currentContext.currentTerm = annotation.term;
        currentTarget.annotations[vocAlias][vocTermWithQualifier] = convertAnnotation(annotation, objectMap, currentContext);
        switch (typeof currentTarget.annotations[vocAlias][vocTermWithQualifier]) {
            case 'string':
                // eslint-disable-next-line no-new-wrappers
                currentTarget.annotations[vocAlias][vocTermWithQualifier] = new String(currentTarget.annotations[vocAlias][vocTermWithQualifier]);
                break;
            case 'boolean':
                // eslint-disable-next-line no-new-wrappers
                currentTarget.annotations[vocAlias][vocTermWithQualifier] = new Boolean(currentTarget.annotations[vocAlias][vocTermWithQualifier]);
                break;
            default:
                // do nothing
                break;
        }
        if (currentTarget.annotations[vocAlias][vocTermWithQualifier] !== null &&
            typeof currentTarget.annotations[vocAlias][vocTermWithQualifier] === 'object' &&
            !currentTarget.annotations[vocAlias][vocTermWithQualifier].annotations) {
            currentTarget.annotations[vocAlias][vocTermWithQualifier].annotations = {};
        }
        if (currentTarget.annotations[vocAlias][vocTermWithQualifier] !== null &&
            typeof currentTarget.annotations[vocAlias][vocTermWithQualifier] === 'object') {
            currentTarget.annotations[vocAlias][vocTermWithQualifier].term = (0, utils_1.unalias)(utils_1.defaultReferences, `${vocAlias}.${vocTerm}`);
            currentTarget.annotations[vocAlias][vocTermWithQualifier].qualifier = annotation.qualifier;
            currentTarget.annotations[vocAlias][vocTermWithQualifier].__source = currentContext.currentSource;
        }
        const annotationTarget = `${currentTargetName}@${(0, utils_1.unalias)(utils_1.defaultReferences, vocAlias + '.' + vocTermWithQualifier)}`;
        if (Array.isArray(annotation.annotations)) {
            const subAnnotationList = {
                target: annotationTarget,
                annotations: annotation.annotations,
                __source: currentContext.currentSource
            };
            currentContext.additionalAnnotations.push(subAnnotationList);
        }
        else if (annotation.annotations && !currentTarget.annotations[vocAlias][vocTermWithQualifier].annotations) {
            currentTarget.annotations[vocAlias][vocTermWithQualifier].annotations = annotation.annotations;
        }
        currentTarget.annotations._annotations[`${vocAlias}.${vocTermWithQualifier}`] =
            currentTarget.annotations._annotations[(0, utils_1.unalias)(utils_1.defaultReferences, `${vocAlias}.${vocTermWithQualifier}`)] =
                currentTarget.annotations[vocAlias][vocTermWithQualifier];
        objectMap[annotationTarget] = currentTarget.annotations[vocAlias][vocTermWithQualifier];
    });
}
/**
 * Process all the unresolved targets so far to try and see if they are resolveable in the end.
 *
 * @param unresolvedTargets
 * @param objectMap
 */
function processUnresolvedTargets(unresolvedTargets, objectMap) {
    unresolvedTargets.forEach((resolvable) => {
        const targetToResolve = resolvable.toResolve;
        const targetStr = targetToResolve.$target;
        const resolvedTarget = objectMap[targetStr];
        const { annotationsTerm, annotationType } = targetToResolve;
        delete targetToResolve.annotationType;
        delete targetToResolve.annotationsTerm;
        if (resolvable.inline && !(resolvedTarget instanceof String)) {
            // inline the resolved target
            let keys;
            for (keys in targetToResolve) {
                delete targetToResolve[keys];
            }
            Object.assign(targetToResolve, resolvedTarget);
        }
        else {
            // assign the resolved target
            targetToResolve.$target = resolvedTarget;
        }
        if (!resolvedTarget) {
            targetToResolve.targetString = targetStr;
            if (annotationsTerm && annotationType) {
                const oErrorMsg = {
                    message: 'Unable to resolve the path expression: ' +
                        targetStr +
                        '\n' +
                        '\n' +
                        'Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n' +
                        '<Annotation Term = ' +
                        annotationsTerm +
                        '>' +
                        '\n' +
                        '<Record Type = ' +
                        annotationType +
                        '>' +
                        '\n' +
                        '<AnnotationPath = ' +
                        targetStr +
                        '>'
                };
                addAnnotationErrorMessage(targetStr, oErrorMsg);
            }
            else {
                const property = targetToResolve.term;
                const path = targetToResolve.path;
                const termInfo = targetStr ? targetStr.split('/')[0] : targetStr;
                const oErrorMsg = {
                    message: 'Unable to resolve the path expression: ' +
                        targetStr +
                        '\n' +
                        '\n' +
                        'Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n' +
                        '<Annotation Term = ' +
                        termInfo +
                        '>' +
                        '\n' +
                        '<PropertyValue Property = ' +
                        property +
                        '        Path= ' +
                        path +
                        '>'
                };
                addAnnotationErrorMessage(targetStr, oErrorMsg);
            }
        }
    });
}
/**
 * Merge annotation from different source together by overwriting at the term level.
 *
 * @param rawMetadata
 * @returns the resulting merged annotations
 */
function mergeAnnotations(rawMetadata) {
    const annotationListPerTarget = {};
    Object.keys(rawMetadata.schema.annotations).forEach((annotationSource) => {
        rawMetadata.schema.annotations[annotationSource].forEach((annotationList) => {
            const currentTargetName = (0, utils_1.unalias)(rawMetadata.references, annotationList.target);
            annotationList.__source = annotationSource;
            if (!annotationListPerTarget[currentTargetName]) {
                annotationListPerTarget[currentTargetName] = {
                    annotations: annotationList.annotations.concat(),
                    target: currentTargetName
                };
                annotationListPerTarget[currentTargetName].__source = annotationSource;
            }
            else {
                annotationList.annotations.forEach((annotation) => {
                    const findIndex = annotationListPerTarget[currentTargetName].annotations.findIndex((referenceAnnotation) => {
                        return (referenceAnnotation.term === annotation.term &&
                            referenceAnnotation.qualifier === annotation.qualifier);
                    });
                    annotation.__source = annotationSource;
                    if (findIndex !== -1) {
                        annotationListPerTarget[currentTargetName].annotations.splice(findIndex, 1, annotation);
                    }
                    else {
                        annotationListPerTarget[currentTargetName].annotations.push(annotation);
                    }
                });
            }
        });
    });
    return annotationListPerTarget;
}
/**
 * Convert a RawMetadata into an object representation to be used to easily navigate a metadata object and its annotation.
 *
 * @param rawMetadata
 * @returns the converted representation of the metadata.
 */
function convert(rawMetadata) {
    ANNOTATION_ERRORS = [];
    const objectMap = buildObjectMap(rawMetadata);
    resolveNavigationProperties(rawMetadata.schema.entityTypes, rawMetadata.schema.associations, objectMap);
    rawMetadata.schema.entityContainer.annotations = {};
    linkActionsToEntityType(rawMetadata.schema.namespace, rawMetadata.schema.actions, objectMap);
    linkActionImportsToActions(rawMetadata.schema.actionImports, objectMap);
    linkEntityTypeToEntitySet(rawMetadata.schema.entitySets, objectMap, rawMetadata.references);
    linkEntityTypeToSingleton(rawMetadata.schema.singletons, objectMap, rawMetadata.references);
    linkPropertiesToComplexTypes(rawMetadata.schema.entityTypes, objectMap);
    prepareComplexTypes(rawMetadata.schema.complexTypes, rawMetadata.schema.associations, objectMap);
    const unresolvedTargets = [];
    const unresolvedAnnotations = [];
    const annotationListPerTarget = mergeAnnotations(rawMetadata);
    Object.keys(annotationListPerTarget).forEach((currentTargetName) => {
        const annotationList = annotationListPerTarget[currentTargetName];
        const objectMapElement = objectMap[currentTargetName];
        if (!objectMapElement && (currentTargetName === null || currentTargetName === void 0 ? void 0 : currentTargetName.indexOf('@')) > 0) {
            unresolvedAnnotations.push(annotationList);
        }
        else if (objectMapElement) {
            let allTargets = [objectMapElement];
            let bOverrideExisting = true;
            if (objectMapElement._type === 'UnboundGenericAction') {
                allTargets = objectMapElement.actions;
                bOverrideExisting = false;
            }
            allTargets.forEach((currentTarget) => {
                const currentContext = {
                    additionalAnnotations: unresolvedAnnotations,
                    currentSource: annotationList.__source,
                    currentTarget: currentTarget,
                    currentTerm: '',
                    rawMetadata: rawMetadata,
                    unresolvedAnnotations: unresolvedTargets
                };
                processAnnotations(currentContext, annotationList, objectMap, bOverrideExisting);
            });
        }
    });
    const extraUnresolvedAnnotations = [];
    unresolvedAnnotations.forEach((annotationList) => {
        const currentTargetName = (0, utils_1.unalias)(rawMetadata.references, annotationList.target);
        let [baseObj, annotationPart] = currentTargetName.split('@');
        const targetSplit = annotationPart.split('/');
        baseObj = baseObj + '@' + targetSplit[0];
        const currentTarget = targetSplit.slice(1).reduce((currentObj, path) => {
            return currentObj === null || currentObj === void 0 ? void 0 : currentObj[path];
        }, objectMap[baseObj]);
        if (!currentTarget || typeof currentTarget !== 'object') {
            ANNOTATION_ERRORS.push({
                message: 'The following annotation target was not found on the service ' + currentTargetName
            });
        }
        else {
            const currentContext = {
                additionalAnnotations: extraUnresolvedAnnotations,
                currentSource: annotationList.__source,
                currentTarget: currentTarget,
                currentTerm: '',
                rawMetadata: rawMetadata,
                unresolvedAnnotations: unresolvedTargets
            };
            processAnnotations(currentContext, annotationList, objectMap, false);
        }
    });
    processUnresolvedTargets(unresolvedTargets, objectMap);
    for (const property in ALL_ANNOTATION_ERRORS) {
        ANNOTATION_ERRORS.push(ALL_ANNOTATION_ERRORS[property][0]);
    }
    rawMetadata.entitySets = rawMetadata.schema.entitySets;
    const extraReferences = rawMetadata.references.filter((reference) => {
        return utils_1.defaultReferences.find((defaultRef) => defaultRef.namespace === reference.namespace) === undefined;
    });
    const convertedOutput = {
        version: rawMetadata.version,
        annotations: rawMetadata.schema.annotations,
        namespace: rawMetadata.schema.namespace,
        entityContainer: rawMetadata.schema.entityContainer,
        actions: rawMetadata.schema.actions,
        actionImports: rawMetadata.schema.actionImports,
        entitySets: rawMetadata.schema.entitySets,
        singletons: rawMetadata.schema.singletons,
        entityTypes: rawMetadata.schema.entityTypes,
        complexTypes: rawMetadata.schema.complexTypes,
        typeDefinitions: rawMetadata.schema.typeDefinitions,
        references: utils_1.defaultReferences.concat(extraReferences),
        diagnostics: ANNOTATION_ERRORS.concat()
    };
    convertedOutput.resolvePath = createGlobalResolve(convertedOutput, objectMap);
    return convertedOutput;
}
exports.convert = convert;


/***/ }),

/***/ 995:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __exportStar = (this && this.__exportStar) || function(m, exports) {
    for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
__exportStar(__webpack_require__(634), exports);
__exportStar(__webpack_require__(127), exports);
__exportStar(__webpack_require__(401), exports);


/***/ }),

/***/ 401:
/***/ (function(__unused_webpack_module, exports) {


Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.Decimal = exports.isComplexTypeDefinition = exports.TermToTypes = exports.unalias = exports.alias = exports.defaultReferences = void 0;
exports.defaultReferences = [
    { alias: 'Capabilities', namespace: 'Org.OData.Capabilities.V1', uri: '' },
    { alias: 'Aggregation', namespace: 'Org.OData.Aggregation.V1', uri: '' },
    { alias: 'Validation', namespace: 'Org.OData.Validation.V1', uri: '' },
    { namespace: 'Org.OData.Core.V1', alias: 'Core', uri: '' },
    { namespace: 'Org.OData.Measures.V1', alias: 'Measures', uri: '' },
    { namespace: 'com.sap.vocabularies.Common.v1', alias: 'Common', uri: '' },
    { namespace: 'com.sap.vocabularies.UI.v1', alias: 'UI', uri: '' },
    { namespace: 'com.sap.vocabularies.Session.v1', alias: 'Session', uri: '' },
    { namespace: 'com.sap.vocabularies.Analytics.v1', alias: 'Analytics', uri: '' },
    { namespace: 'com.sap.vocabularies.CodeList.v1', alias: 'CodeList', uri: '' },
    { namespace: 'com.sap.vocabularies.PersonalData.v1', alias: 'PersonalData', uri: '' },
    { namespace: 'com.sap.vocabularies.Communication.v1', alias: 'Communication', uri: '' },
    { namespace: 'com.sap.vocabularies.HTML5.v1', alias: 'HTML5', uri: '' }
];
/**
 * Transform an unaliased string representation annotation to the aliased version.
 *
 * @param references currentReferences for the project
 * @param unaliasedValue the unaliased value
 * @returns the aliased string representing the same
 */
function alias(references, unaliasedValue) {
    if (!references.reverseReferenceMap) {
        references.reverseReferenceMap = references.reduce((map, ref) => {
            map[ref.namespace] = ref;
            return map;
        }, {});
    }
    if (!unaliasedValue) {
        return unaliasedValue;
    }
    const lastDotIndex = unaliasedValue.lastIndexOf('.');
    const namespace = unaliasedValue.substring(0, lastDotIndex);
    const value = unaliasedValue.substring(lastDotIndex + 1);
    const reference = references.reverseReferenceMap[namespace];
    if (reference) {
        return `${reference.alias}.${value}`;
    }
    else if (unaliasedValue.indexOf('@') !== -1) {
        // Try to see if it's an annotation Path like to_SalesOrder/@UI.LineItem
        const [preAlias, ...postAlias] = unaliasedValue.split('@');
        return `${preAlias}@${alias(references, postAlias.join('@'))}`;
    }
    else {
        return unaliasedValue;
    }
}
exports.alias = alias;
/**
 * Transform an aliased string representation annotation to the unaliased version.
 *
 * @param references currentReferences for the project
 * @param aliasedValue the aliased value
 * @returns the unaliased string representing the same
 */
function unalias(references, aliasedValue) {
    if (!references.referenceMap) {
        references.referenceMap = references.reduce((map, ref) => {
            map[ref.alias] = ref;
            return map;
        }, {});
    }
    if (!aliasedValue) {
        return aliasedValue;
    }
    const [vocAlias, ...value] = aliasedValue.split('.');
    const reference = references.referenceMap[vocAlias];
    if (reference) {
        return `${reference.namespace}.${value.join('.')}`;
    }
    else if (aliasedValue.indexOf('@') !== -1) {
        // Try to see if it's an annotation Path like to_SalesOrder/@UI.LineItem
        const [preAlias, ...postAlias] = aliasedValue.split('@');
        return `${preAlias}@${unalias(references, postAlias.join('@'))}`;
    }
    else {
        return aliasedValue;
    }
}
exports.unalias = unalias;
var TermToTypes;
(function (TermToTypes) {
    TermToTypes["Org.OData.Authorization.V1.SecuritySchemes"] = "Org.OData.Authorization.V1.SecurityScheme";
    TermToTypes["Org.OData.Authorization.V1.Authorizations"] = "Org.OData.Authorization.V1.Authorization";
    TermToTypes["Org.OData.Core.V1.Revisions"] = "Org.OData.Core.V1.RevisionType";
    TermToTypes["Org.OData.Core.V1.Links"] = "Org.OData.Core.V1.Link";
    TermToTypes["Org.OData.Core.V1.Example"] = "Org.OData.Core.V1.ExampleValue";
    TermToTypes["Org.OData.Core.V1.Messages"] = "Org.OData.Core.V1.MessageType";
    TermToTypes["Org.OData.Core.V1.ValueException"] = "Org.OData.Core.V1.ValueExceptionType";
    TermToTypes["Org.OData.Core.V1.ResourceException"] = "Org.OData.Core.V1.ResourceExceptionType";
    TermToTypes["Org.OData.Core.V1.DataModificationException"] = "Org.OData.Core.V1.DataModificationExceptionType";
    TermToTypes["Org.OData.Core.V1.IsLanguageDependent"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.DereferenceableIDs"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.ConventionalIDs"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.Permissions"] = "Org.OData.Core.V1.Permission";
    TermToTypes["Org.OData.Core.V1.DefaultNamespace"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.Immutable"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.Computed"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.ComputedDefaultValue"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.IsURL"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.IsMediaType"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.ContentDisposition"] = "Org.OData.Core.V1.ContentDispositionType";
    TermToTypes["Org.OData.Core.V1.OptimisticConcurrency"] = "Edm.PropertyPath";
    TermToTypes["Org.OData.Core.V1.AdditionalProperties"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.AutoExpand"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.AutoExpandReferences"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.MayImplement"] = "Org.OData.Core.V1.QualifiedTypeName";
    TermToTypes["Org.OData.Core.V1.Ordered"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.PositionalInsert"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Core.V1.AlternateKeys"] = "Org.OData.Core.V1.AlternateKey";
    TermToTypes["Org.OData.Core.V1.OptionalParameter"] = "Org.OData.Core.V1.OptionalParameterType";
    TermToTypes["Org.OData.Core.V1.OperationAvailable"] = "Edm.Boolean";
    TermToTypes["Org.OData.Core.V1.SymbolicName"] = "Org.OData.Core.V1.SimpleIdentifier";
    TermToTypes["Org.OData.Capabilities.V1.ConformanceLevel"] = "Org.OData.Capabilities.V1.ConformanceLevelType";
    TermToTypes["Org.OData.Capabilities.V1.AsynchronousRequestsSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.BatchContinueOnErrorSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.IsolationSupported"] = "Org.OData.Capabilities.V1.IsolationLevel";
    TermToTypes["Org.OData.Capabilities.V1.CrossJoinSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.CallbackSupported"] = "Org.OData.Capabilities.V1.CallbackType";
    TermToTypes["Org.OData.Capabilities.V1.ChangeTracking"] = "Org.OData.Capabilities.V1.ChangeTrackingType";
    TermToTypes["Org.OData.Capabilities.V1.CountRestrictions"] = "Org.OData.Capabilities.V1.CountRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.NavigationRestrictions"] = "Org.OData.Capabilities.V1.NavigationRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.IndexableByKey"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.TopSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.SkipSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.ComputeSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.SelectSupport"] = "Org.OData.Capabilities.V1.SelectSupportType";
    TermToTypes["Org.OData.Capabilities.V1.BatchSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.BatchSupport"] = "Org.OData.Capabilities.V1.BatchSupportType";
    TermToTypes["Org.OData.Capabilities.V1.FilterRestrictions"] = "Org.OData.Capabilities.V1.FilterRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.SortRestrictions"] = "Org.OData.Capabilities.V1.SortRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.ExpandRestrictions"] = "Org.OData.Capabilities.V1.ExpandRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.SearchRestrictions"] = "Org.OData.Capabilities.V1.SearchRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.KeyAsSegmentSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.QuerySegmentSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.InsertRestrictions"] = "Org.OData.Capabilities.V1.InsertRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.DeepInsertSupport"] = "Org.OData.Capabilities.V1.DeepInsertSupportType";
    TermToTypes["Org.OData.Capabilities.V1.UpdateRestrictions"] = "Org.OData.Capabilities.V1.UpdateRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.DeepUpdateSupport"] = "Org.OData.Capabilities.V1.DeepUpdateSupportType";
    TermToTypes["Org.OData.Capabilities.V1.DeleteRestrictions"] = "Org.OData.Capabilities.V1.DeleteRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.CollectionPropertyRestrictions"] = "Org.OData.Capabilities.V1.CollectionPropertyRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.OperationRestrictions"] = "Org.OData.Capabilities.V1.OperationRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.AnnotationValuesInQuerySupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Capabilities.V1.ModificationQueryOptions"] = "Org.OData.Capabilities.V1.ModificationQueryOptionsType";
    TermToTypes["Org.OData.Capabilities.V1.ReadRestrictions"] = "Org.OData.Capabilities.V1.ReadRestrictionsType";
    TermToTypes["Org.OData.Capabilities.V1.CustomHeaders"] = "Org.OData.Capabilities.V1.CustomParameter";
    TermToTypes["Org.OData.Capabilities.V1.CustomQueryOptions"] = "Org.OData.Capabilities.V1.CustomParameter";
    TermToTypes["Org.OData.Capabilities.V1.MediaLocationUpdateSupported"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Aggregation.V1.ApplySupported"] = "Org.OData.Aggregation.V1.ApplySupportedType";
    TermToTypes["Org.OData.Aggregation.V1.Groupable"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Aggregation.V1.Aggregatable"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Aggregation.V1.ContextDefiningProperties"] = "Edm.PropertyPath";
    TermToTypes["Org.OData.Aggregation.V1.LeveledHierarchy"] = "Edm.PropertyPath";
    TermToTypes["Org.OData.Aggregation.V1.RecursiveHierarchy"] = "Org.OData.Aggregation.V1.RecursiveHierarchyType";
    TermToTypes["Org.OData.Aggregation.V1.AvailableOnAggregates"] = "Org.OData.Aggregation.V1.AvailableOnAggregatesType";
    TermToTypes["Org.OData.Validation.V1.Minimum"] = "Edm.PrimitiveType";
    TermToTypes["Org.OData.Validation.V1.Maximum"] = "Edm.PrimitiveType";
    TermToTypes["Org.OData.Validation.V1.Exclusive"] = "Org.OData.Core.V1.Tag";
    TermToTypes["Org.OData.Validation.V1.AllowedValues"] = "Org.OData.Validation.V1.AllowedValue";
    TermToTypes["Org.OData.Validation.V1.MultipleOf"] = "Edm.Decimal";
    TermToTypes["Org.OData.Validation.V1.Constraint"] = "Org.OData.Validation.V1.ConstraintType";
    TermToTypes["Org.OData.Validation.V1.ItemsOf"] = "Org.OData.Validation.V1.ItemsOfType";
    TermToTypes["Org.OData.Validation.V1.OpenPropertyTypeConstraint"] = "Org.OData.Core.V1.QualifiedTypeName";
    TermToTypes["Org.OData.Validation.V1.DerivedTypeConstraint"] = "Org.OData.Core.V1.QualifiedTypeName";
    TermToTypes["Org.OData.Validation.V1.AllowedTerms"] = "Org.OData.Core.V1.QualifiedTermName";
    TermToTypes["Org.OData.Validation.V1.ApplicableTerms"] = "Org.OData.Core.V1.QualifiedTermName";
    TermToTypes["Org.OData.Validation.V1.MaxItems"] = "Edm.Int64";
    TermToTypes["Org.OData.Validation.V1.MinItems"] = "Edm.Int64";
    TermToTypes["Org.OData.Measures.V1.Scale"] = "Edm.Byte";
    TermToTypes["Org.OData.Measures.V1.DurationGranularity"] = "Org.OData.Measures.V1.DurationGranularityType";
    TermToTypes["com.sap.vocabularies.Analytics.v1.Dimension"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Analytics.v1.Measure"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Analytics.v1.AccumulativeMeasure"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Analytics.v1.RolledUpPropertyCount"] = "Edm.Int16";
    TermToTypes["com.sap.vocabularies.Analytics.v1.PlanningAction"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Analytics.v1.AggregatedProperties"] = "com.sap.vocabularies.Analytics.v1.AggregatedPropertyType";
    TermToTypes["com.sap.vocabularies.Common.v1.ServiceVersion"] = "Edm.Int32";
    TermToTypes["com.sap.vocabularies.Common.v1.ServiceSchemaVersion"] = "Edm.Int32";
    TermToTypes["com.sap.vocabularies.Common.v1.TextFor"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.Common.v1.IsLanguageIdentifier"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.TextFormat"] = "com.sap.vocabularies.Common.v1.TextFormatType";
    TermToTypes["com.sap.vocabularies.Common.v1.IsDigitSequence"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsUpperCase"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCurrency"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsUnit"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.UnitSpecificScale"] = "Edm.PrimitiveType";
    TermToTypes["com.sap.vocabularies.Common.v1.UnitSpecificPrecision"] = "Edm.PrimitiveType";
    TermToTypes["com.sap.vocabularies.Common.v1.SecondaryKey"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.Common.v1.MinOccurs"] = "Edm.Int64";
    TermToTypes["com.sap.vocabularies.Common.v1.MaxOccurs"] = "Edm.Int64";
    TermToTypes["com.sap.vocabularies.Common.v1.AssociationEntity"] = "Edm.NavigationPropertyPath";
    TermToTypes["com.sap.vocabularies.Common.v1.DerivedNavigation"] = "Edm.NavigationPropertyPath";
    TermToTypes["com.sap.vocabularies.Common.v1.Masked"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.MaskedAlways"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.SemanticObjectMapping"] = "com.sap.vocabularies.Common.v1.SemanticObjectMappingType";
    TermToTypes["com.sap.vocabularies.Common.v1.IsInstanceAnnotation"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.FilterExpressionRestrictions"] = "com.sap.vocabularies.Common.v1.FilterExpressionRestrictionType";
    TermToTypes["com.sap.vocabularies.Common.v1.FieldControl"] = "com.sap.vocabularies.Common.v1.FieldControlType";
    TermToTypes["com.sap.vocabularies.Common.v1.Application"] = "com.sap.vocabularies.Common.v1.ApplicationType";
    TermToTypes["com.sap.vocabularies.Common.v1.Timestamp"] = "Edm.DateTimeOffset";
    TermToTypes["com.sap.vocabularies.Common.v1.ErrorResolution"] = "com.sap.vocabularies.Common.v1.ErrorResolutionType";
    TermToTypes["com.sap.vocabularies.Common.v1.Messages"] = "Edm.ComplexType";
    TermToTypes["com.sap.vocabularies.Common.v1.numericSeverity"] = "com.sap.vocabularies.Common.v1.NumericMessageSeverityType";
    TermToTypes["com.sap.vocabularies.Common.v1.MaximumNumericMessageSeverity"] = "com.sap.vocabularies.Common.v1.NumericMessageSeverityType";
    TermToTypes["com.sap.vocabularies.Common.v1.IsActionCritical"] = "Edm.Boolean";
    TermToTypes["com.sap.vocabularies.Common.v1.Attributes"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.Common.v1.RelatedRecursiveHierarchy"] = "Edm.AnnotationPath";
    TermToTypes["com.sap.vocabularies.Common.v1.Interval"] = "com.sap.vocabularies.Common.v1.IntervalType";
    TermToTypes["com.sap.vocabularies.Common.v1.ResultContext"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.WeakReferentialConstraint"] = "com.sap.vocabularies.Common.v1.WeakReferentialConstraintType";
    TermToTypes["com.sap.vocabularies.Common.v1.IsNaturalPerson"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.ValueList"] = "com.sap.vocabularies.Common.v1.ValueListType";
    TermToTypes["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"] = "com.sap.vocabularies.Common.v1.SimpleIdentifier";
    TermToTypes["com.sap.vocabularies.Common.v1.ValueListWithFixedValues"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.ValueListMapping"] = "com.sap.vocabularies.Common.v1.ValueListMappingType";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarYear"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarHalfyear"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarQuarter"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarMonth"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarWeek"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsDayOfCalendarMonth"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsDayOfCalendarYear"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarYearHalfyear"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarYearQuarter"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarYearMonth"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarYearWeek"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsCalendarDate"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalYear"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalPeriod"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalQuarter"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalWeek"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalYearWeek"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.IsFiscalYearVariant"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.MutuallyExclusiveTerm"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Common.v1.DraftRoot"] = "com.sap.vocabularies.Common.v1.DraftRootType";
    TermToTypes["com.sap.vocabularies.Common.v1.DraftNode"] = "com.sap.vocabularies.Common.v1.DraftNodeType";
    TermToTypes["com.sap.vocabularies.Common.v1.DraftActivationVia"] = "com.sap.vocabularies.Common.v1.SimpleIdentifier";
    TermToTypes["com.sap.vocabularies.Common.v1.EditableFieldFor"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.Common.v1.SemanticKey"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.Common.v1.SideEffects"] = "com.sap.vocabularies.Common.v1.SideEffectsType";
    TermToTypes["com.sap.vocabularies.Common.v1.DefaultValuesFunction"] = "com.sap.vocabularies.Common.v1.QualifiedName";
    TermToTypes["com.sap.vocabularies.Common.v1.FilterDefaultValue"] = "Edm.PrimitiveType";
    TermToTypes["com.sap.vocabularies.Common.v1.FilterDefaultValueHigh"] = "Edm.PrimitiveType";
    TermToTypes["com.sap.vocabularies.Common.v1.SortOrder"] = "com.sap.vocabularies.Common.v1.SortOrderType";
    TermToTypes["com.sap.vocabularies.Common.v1.RecursiveHierarchy"] = "com.sap.vocabularies.Common.v1.RecursiveHierarchyType";
    TermToTypes["com.sap.vocabularies.Common.v1.CreatedAt"] = "Edm.DateTimeOffset";
    TermToTypes["com.sap.vocabularies.Common.v1.CreatedBy"] = "com.sap.vocabularies.Common.v1.UserID";
    TermToTypes["com.sap.vocabularies.Common.v1.ChangedAt"] = "Edm.DateTimeOffset";
    TermToTypes["com.sap.vocabularies.Common.v1.ChangedBy"] = "com.sap.vocabularies.Common.v1.UserID";
    TermToTypes["com.sap.vocabularies.Common.v1.ApplyMultiUnitBehaviorForSortingAndFiltering"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.CodeList.v1.CurrencyCodes"] = "com.sap.vocabularies.CodeList.v1.CodeListSource";
    TermToTypes["com.sap.vocabularies.CodeList.v1.UnitsOfMeasure"] = "com.sap.vocabularies.CodeList.v1.CodeListSource";
    TermToTypes["com.sap.vocabularies.CodeList.v1.StandardCode"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.CodeList.v1.ExternalCode"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.CodeList.v1.IsConfigurationDeprecationCode"] = "Edm.Boolean";
    TermToTypes["com.sap.vocabularies.Communication.v1.Contact"] = "com.sap.vocabularies.Communication.v1.ContactType";
    TermToTypes["com.sap.vocabularies.Communication.v1.Address"] = "com.sap.vocabularies.Communication.v1.AddressType";
    TermToTypes["com.sap.vocabularies.Communication.v1.IsEmailAddress"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Communication.v1.IsPhoneNumber"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Communication.v1.Event"] = "com.sap.vocabularies.Communication.v1.EventData";
    TermToTypes["com.sap.vocabularies.Communication.v1.Task"] = "com.sap.vocabularies.Communication.v1.TaskData";
    TermToTypes["com.sap.vocabularies.Communication.v1.Message"] = "com.sap.vocabularies.Communication.v1.MessageData";
    TermToTypes["com.sap.vocabularies.Hierarchy.v1.RecursiveHierarchy"] = "com.sap.vocabularies.Hierarchy.v1.RecursiveHierarchyType";
    TermToTypes["com.sap.vocabularies.PersonalData.v1.EntitySemantics"] = "com.sap.vocabularies.PersonalData.v1.EntitySemanticsType";
    TermToTypes["com.sap.vocabularies.PersonalData.v1.FieldSemantics"] = "com.sap.vocabularies.PersonalData.v1.FieldSemanticsType";
    TermToTypes["com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.Session.v1.StickySessionSupported"] = "com.sap.vocabularies.Session.v1.StickySessionSupportedType";
    TermToTypes["com.sap.vocabularies.UI.v1.HeaderInfo"] = "com.sap.vocabularies.UI.v1.HeaderInfoType";
    TermToTypes["com.sap.vocabularies.UI.v1.Identification"] = "com.sap.vocabularies.UI.v1.DataFieldAbstract";
    TermToTypes["com.sap.vocabularies.UI.v1.Badge"] = "com.sap.vocabularies.UI.v1.BadgeType";
    TermToTypes["com.sap.vocabularies.UI.v1.LineItem"] = "com.sap.vocabularies.UI.v1.DataFieldAbstract";
    TermToTypes["com.sap.vocabularies.UI.v1.StatusInfo"] = "com.sap.vocabularies.UI.v1.DataFieldAbstract";
    TermToTypes["com.sap.vocabularies.UI.v1.FieldGroup"] = "com.sap.vocabularies.UI.v1.FieldGroupType";
    TermToTypes["com.sap.vocabularies.UI.v1.ConnectedFields"] = "com.sap.vocabularies.UI.v1.ConnectedFieldsType";
    TermToTypes["com.sap.vocabularies.UI.v1.GeoLocations"] = "com.sap.vocabularies.UI.v1.GeoLocationType";
    TermToTypes["com.sap.vocabularies.UI.v1.GeoLocation"] = "com.sap.vocabularies.UI.v1.GeoLocationType";
    TermToTypes["com.sap.vocabularies.UI.v1.Contacts"] = "Edm.AnnotationPath";
    TermToTypes["com.sap.vocabularies.UI.v1.MediaResource"] = "com.sap.vocabularies.UI.v1.MediaResourceType";
    TermToTypes["com.sap.vocabularies.UI.v1.DataPoint"] = "com.sap.vocabularies.UI.v1.DataPointType";
    TermToTypes["com.sap.vocabularies.UI.v1.KPI"] = "com.sap.vocabularies.UI.v1.KPIType";
    TermToTypes["com.sap.vocabularies.UI.v1.Chart"] = "com.sap.vocabularies.UI.v1.ChartDefinitionType";
    TermToTypes["com.sap.vocabularies.UI.v1.ValueCriticality"] = "com.sap.vocabularies.UI.v1.ValueCriticalityType";
    TermToTypes["com.sap.vocabularies.UI.v1.CriticalityLabels"] = "com.sap.vocabularies.UI.v1.CriticalityLabelType";
    TermToTypes["com.sap.vocabularies.UI.v1.SelectionFields"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.UI.v1.Facets"] = "com.sap.vocabularies.UI.v1.Facet";
    TermToTypes["com.sap.vocabularies.UI.v1.HeaderFacets"] = "com.sap.vocabularies.UI.v1.Facet";
    TermToTypes["com.sap.vocabularies.UI.v1.QuickViewFacets"] = "com.sap.vocabularies.UI.v1.Facet";
    TermToTypes["com.sap.vocabularies.UI.v1.QuickCreateFacets"] = "com.sap.vocabularies.UI.v1.Facet";
    TermToTypes["com.sap.vocabularies.UI.v1.FilterFacets"] = "com.sap.vocabularies.UI.v1.ReferenceFacet";
    TermToTypes["com.sap.vocabularies.UI.v1.SelectionPresentationVariant"] = "com.sap.vocabularies.UI.v1.SelectionPresentationVariantType";
    TermToTypes["com.sap.vocabularies.UI.v1.PresentationVariant"] = "com.sap.vocabularies.UI.v1.PresentationVariantType";
    TermToTypes["com.sap.vocabularies.UI.v1.SelectionVariant"] = "com.sap.vocabularies.UI.v1.SelectionVariantType";
    TermToTypes["com.sap.vocabularies.UI.v1.ThingPerspective"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.IsSummary"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.PartOfPreview"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.Map"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.Gallery"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.IsImageURL"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.IsImage"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.MultiLineText"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.TextArrangement"] = "com.sap.vocabularies.UI.v1.TextArrangementType";
    TermToTypes["com.sap.vocabularies.UI.v1.Importance"] = "com.sap.vocabularies.UI.v1.ImportanceType";
    TermToTypes["com.sap.vocabularies.UI.v1.Hidden"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.CreateHidden"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.UpdateHidden"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.DeleteHidden"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.HiddenFilter"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.DataFieldDefault"] = "com.sap.vocabularies.UI.v1.DataFieldAbstract";
    TermToTypes["com.sap.vocabularies.UI.v1.Criticality"] = "com.sap.vocabularies.UI.v1.CriticalityType";
    TermToTypes["com.sap.vocabularies.UI.v1.CriticalityCalculation"] = "com.sap.vocabularies.UI.v1.CriticalityCalculationType";
    TermToTypes["com.sap.vocabularies.UI.v1.Emphasized"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.UI.v1.OrderBy"] = "Edm.PropertyPath";
    TermToTypes["com.sap.vocabularies.UI.v1.ParameterDefaultValue"] = "Edm.PrimitiveType";
    TermToTypes["com.sap.vocabularies.UI.v1.RecommendationState"] = "com.sap.vocabularies.UI.v1.RecommendationStateType";
    TermToTypes["com.sap.vocabularies.UI.v1.RecommendationList"] = "com.sap.vocabularies.UI.v1.RecommendationListType";
    TermToTypes["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"] = "Org.OData.Core.V1.Tag";
    TermToTypes["com.sap.vocabularies.HTML5.v1.CssDefaults"] = "com.sap.vocabularies.HTML5.v1.CssDefaultsType";
})(TermToTypes = exports.TermToTypes || (exports.TermToTypes = {}));
/**
 * Differentiate between a ComplexType and a TypeDefinition.
 * @param complexTypeDefinition
 * @returns true if the value is a complex type
 */
function isComplexTypeDefinition(complexTypeDefinition) {
    return (!!complexTypeDefinition && complexTypeDefinition._type === 'ComplexType' && !!complexTypeDefinition.properties);
}
exports.isComplexTypeDefinition = isComplexTypeDefinition;
function Decimal(value) {
    return {
        isDecimal() {
            return true;
        },
        valueOf() {
            return value;
        },
        toString() {
            return value.toString();
        }
    };
}
exports.Decimal = Decimal;


/***/ }),

/***/ 127:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.revertTermToGenericType = void 0;
const utils_1 = __webpack_require__(401);
/**
 * Revert an object to its raw type equivalent.
 *
 * @param references the current reference
 * @param value the value to revert
 * @returns the raw value
 */
function revertObjectToRawType(references, value) {
    var _a, _b, _c, _d, _e, _f;
    let result;
    if (Array.isArray(value)) {
        result = {
            type: 'Collection',
            Collection: value.map((anno) => revertCollectionItemToRawType(references, anno))
        };
    }
    else if ((_a = value.isDecimal) === null || _a === void 0 ? void 0 : _a.call(value)) {
        result = {
            type: 'Decimal',
            Decimal: value.valueOf()
        };
    }
    else if ((_b = value.isString) === null || _b === void 0 ? void 0 : _b.call(value)) {
        const valueMatches = value.valueOf().split('.');
        if (valueMatches.length > 1 && references.find((ref) => ref.alias === valueMatches[0])) {
            result = {
                type: 'EnumMember',
                EnumMember: value.valueOf()
            };
        }
        else {
            result = {
                type: 'String',
                String: value.valueOf()
            };
        }
    }
    else if ((_c = value.isInt) === null || _c === void 0 ? void 0 : _c.call(value)) {
        result = {
            type: 'Int',
            Int: value.valueOf()
        };
    }
    else if ((_d = value.isFloat) === null || _d === void 0 ? void 0 : _d.call(value)) {
        result = {
            type: 'Float',
            Float: value.valueOf()
        };
    }
    else if ((_e = value.isDate) === null || _e === void 0 ? void 0 : _e.call(value)) {
        result = {
            type: 'Date',
            Date: value.valueOf()
        };
    }
    else if ((_f = value.isBoolean) === null || _f === void 0 ? void 0 : _f.call(value)) {
        result = {
            type: 'Bool',
            Bool: value.valueOf() === 'true'
        };
    }
    else if (value.type === 'Path') {
        result = {
            type: 'Path',
            Path: value.path
        };
    }
    else if (value.type === 'AnnotationPath') {
        result = {
            type: 'AnnotationPath',
            AnnotationPath: value.value
        };
    }
    else if (value.type === 'Apply') {
        result = {
            type: 'Apply',
            Apply: value.Apply
        };
    }
    else if (value.type === 'Null') {
        result = {
            type: 'Null'
        };
    }
    else if (value.type === 'PropertyPath') {
        result = {
            type: 'PropertyPath',
            PropertyPath: value.value
        };
    }
    else if (value.type === 'NavigationPropertyPath') {
        result = {
            type: 'NavigationPropertyPath',
            NavigationPropertyPath: value.value
        };
    }
    else if (Object.prototype.hasOwnProperty.call(value, '$Type')) {
        result = {
            type: 'Record',
            Record: revertCollectionItemToRawType(references, value)
        };
    }
    return result;
}
/**
 * Revert a value to its raw value depending on its type.
 *
 * @param references the current set of reference
 * @param value the value to revert
 * @returns the raw expression
 */
function revertValueToRawType(references, value) {
    let result;
    const valueConstructor = value === null || value === void 0 ? void 0 : value.constructor.name;
    switch (valueConstructor) {
        case 'String':
        case 'string':
            const valueMatches = value.toString().split('.');
            if (valueMatches.length > 1 && references.find((ref) => ref.alias === valueMatches[0])) {
                result = {
                    type: 'EnumMember',
                    EnumMember: value.toString()
                };
            }
            else {
                result = {
                    type: 'String',
                    String: value.toString()
                };
            }
            break;
        case 'Boolean':
        case 'boolean':
            result = {
                type: 'Bool',
                Bool: value.valueOf()
            };
            break;
        case 'Number':
        case 'number':
            if (value.toString() === value.toFixed()) {
                result = {
                    type: 'Int',
                    Int: value.valueOf()
                };
            }
            else {
                result = {
                    type: 'Decimal',
                    Decimal: value.valueOf()
                };
            }
            break;
        case 'object':
        default:
            result = revertObjectToRawType(references, value);
            break;
    }
    return result;
}
const restrictedKeys = ['$Type', 'term', '__source', 'qualifier', 'ActionTarget', 'fullyQualifiedName', 'annotations'];
/**
 * Revert the current embedded annotations to their raw type.
 *
 * @param references the current set of reference
 * @param currentAnnotations the collection item to evaluate
 * @param targetAnnotations the place where we need to add the annotation
 */
function revertAnnotationsToRawType(references, currentAnnotations, targetAnnotations) {
    Object.keys(currentAnnotations)
        .filter((key) => key !== '_annotations')
        .forEach((key) => {
        Object.keys(currentAnnotations[key]).forEach((term) => {
            const parsedAnnotation = revertTermToGenericType(references, currentAnnotations[key][term]);
            if (!parsedAnnotation.term) {
                const unaliasedTerm = (0, utils_1.unalias)(references, `${key}.${term}`);
                if (unaliasedTerm) {
                    const qualifiedSplit = unaliasedTerm.split('#');
                    parsedAnnotation.term = qualifiedSplit[0];
                    if (qualifiedSplit.length > 1) {
                        // Sub Annotation with a qualifier, not sure when that can happen in real scenarios
                        parsedAnnotation.qualifier = qualifiedSplit[1];
                    }
                }
            }
            targetAnnotations.push(parsedAnnotation);
        });
    });
}
/**
 * Revert the current collection item to the corresponding raw annotation.
 *
 * @param references the current set of reference
 * @param collectionItem the collection item to evaluate
 * @returns the raw type equivalent
 */
function revertCollectionItemToRawType(references, collectionItem) {
    if (typeof collectionItem === 'string') {
        return collectionItem;
    }
    else if (typeof collectionItem === 'object') {
        if (collectionItem.hasOwnProperty('$Type')) {
            // Annotation Record
            const outItem = {
                type: collectionItem.$Type,
                propertyValues: []
            };
            // Could validate keys and type based on $Type
            Object.keys(collectionItem).forEach((collectionKey) => {
                if (restrictedKeys.indexOf(collectionKey) === -1) {
                    const value = collectionItem[collectionKey];
                    outItem.propertyValues.push({
                        name: collectionKey,
                        value: revertValueToRawType(references, value)
                    });
                }
                else if (collectionKey === 'annotations' && Object.keys(collectionItem[collectionKey]).length > 0) {
                    outItem.annotations = [];
                    revertAnnotationsToRawType(references, collectionItem[collectionKey], outItem.annotations);
                }
            });
            return outItem;
        }
        else if (collectionItem.type === 'PropertyPath') {
            return {
                type: 'PropertyPath',
                PropertyPath: collectionItem.value
            };
        }
        else if (collectionItem.type === 'AnnotationPath') {
            return {
                type: 'AnnotationPath',
                AnnotationPath: collectionItem.value
            };
        }
        else if (collectionItem.type === 'NavigationPropertyPath') {
            return {
                type: 'NavigationPropertyPath',
                NavigationPropertyPath: collectionItem.value
            };
        }
    }
    return undefined;
}
/**
 * Revert an annotation term to it's generic or raw equivalent.
 *
 * @param references the reference of the current context
 * @param annotation the annotation term to revert
 * @returns the raw annotation
 */
function revertTermToGenericType(references, annotation) {
    const baseAnnotation = {
        term: annotation.term,
        qualifier: annotation.qualifier
    };
    if (Array.isArray(annotation)) {
        // Collection
        if (annotation.hasOwnProperty('annotations') && Object.keys(annotation.annotations).length > 0) {
            // Annotation on a collection itself, not sure when that happens if at all
            baseAnnotation.annotations = [];
            revertAnnotationsToRawType(references, annotation.annotations, baseAnnotation.annotations);
        }
        return {
            ...baseAnnotation,
            collection: annotation.map((anno) => revertCollectionItemToRawType(references, anno))
        };
    }
    else if (annotation.hasOwnProperty('$Type')) {
        return { ...baseAnnotation, record: revertCollectionItemToRawType(references, annotation) };
    }
    else {
        return { ...baseAnnotation, value: revertValueToRawType(references, annotation) };
    }
}
exports.revertTermToGenericType = revertTermToGenericType;


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__(995);
/******/ 	AnnotationConverter = __webpack_exports__;
/******/ 	
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQW5ub3RhdGlvbkNvbnZlcnRlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQStCQSx5Q0FBMkc7QUFFM0c7O0dBRUc7QUFDSCxNQUFNLElBQUk7SUFRTjs7Ozs7T0FLRztJQUNILFlBQVksY0FBOEIsRUFBRSxVQUFrQixFQUFFLGVBQXVCLEVBQUUsSUFBWTtRQUNqRyxJQUFJLENBQUMsSUFBSSxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUM7UUFDaEMsSUFBSSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUM7UUFDbkIsSUFBSSxDQUFDLE9BQU8sR0FBRyxVQUFVLENBQUM7UUFDMUIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7SUFDM0MsQ0FBQztDQUNKO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFTLGNBQWMsQ0FBQyxXQUF3Qjs7SUFDNUMsTUFBTSxTQUFTLEdBQVEsRUFBRSxDQUFDO0lBQzFCLElBQUksaUJBQVcsQ0FBQyxNQUFNLENBQUMsZUFBZSwwQ0FBRSxrQkFBa0IsRUFBRTtRQUN4RCxTQUFTLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsa0JBQWtCLENBQUMsR0FBRyxXQUFXLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQztLQUN6RztJQUNELEtBQUssTUFBTSxTQUFTLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUU7UUFDbkQsU0FBUyxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLFNBQVMsQ0FBQztLQUN2RDtJQUNELEtBQUssTUFBTSxTQUFTLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUU7UUFDbkQsU0FBUyxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLFNBQVMsQ0FBQztLQUN2RDtJQUNELEtBQUssTUFBTSxNQUFNLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUU7UUFDN0MsU0FBUyxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLE1BQU0sQ0FBQztRQUM5QyxJQUFJLE1BQU0sQ0FBQyxPQUFPLEVBQUU7WUFDaEIsTUFBTSxpQkFBaUIsR0FBRyxNQUFNLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xFLElBQUksQ0FBQyxTQUFTLENBQUMsaUJBQWlCLENBQUMsRUFBRTtnQkFDL0IsU0FBUyxDQUFDLGlCQUFpQixDQUFDLEdBQUc7b0JBQzNCLEtBQUssRUFBRSxzQkFBc0I7b0JBQzdCLE9BQU8sRUFBRSxFQUFFO2lCQUNkLENBQUM7YUFDTDtZQUNELFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDbEQsTUFBTSxXQUFXLEdBQUcsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUN6RCxTQUFTLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLFdBQVcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDO1NBQzNFO1FBRUQsS0FBSyxNQUFNLFNBQVMsSUFBSSxNQUFNLENBQUMsVUFBVSxFQUFFO1lBQ3ZDLFNBQVMsQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsR0FBRyxTQUFTLENBQUM7U0FDdkQ7S0FDSjtJQUNELEtBQUssTUFBTSxZQUFZLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxhQUFhLEVBQUU7UUFDekQsU0FBUyxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLFlBQVksQ0FBQztLQUM3RDtJQUNELEtBQUssTUFBTSxXQUFXLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUU7UUFDdkQsU0FBUyxDQUFDLFdBQVcsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLFdBQVcsQ0FBQztRQUN4RCxLQUFLLE1BQU0sUUFBUSxJQUFJLFdBQVcsQ0FBQyxVQUFVLEVBQUU7WUFDM0MsU0FBUyxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLFFBQVEsQ0FBQztTQUNyRDtLQUNKO0lBQ0QsS0FBSyxNQUFNLGNBQWMsSUFBSSxXQUFXLENBQUMsTUFBTSxDQUFDLGVBQWUsRUFBRTtRQUM3RCxTQUFTLENBQUMsY0FBYyxDQUFDLGtCQUFrQixDQUFDLEdBQUcsY0FBYyxDQUFDO0tBQ2pFO0lBQ0QsS0FBSyxNQUFNLFVBQVUsSUFBSSxXQUFXLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRTtRQUNwRCxVQUF5QixDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUMsQ0FBQyxzQ0FBc0M7UUFDbkYsU0FBUyxDQUFDLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLFVBQVUsQ0FBQztRQUN0RCxTQUFTLENBQUMsY0FBYyxVQUFVLENBQUMsa0JBQWtCLEdBQUcsQ0FBQyxHQUFHLFVBQVUsQ0FBQztRQUN2RSxLQUFLLE1BQU0sUUFBUSxJQUFJLFVBQVUsQ0FBQyxnQkFBZ0IsRUFBRTtZQUNoRCxTQUFTLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsUUFBUSxDQUFDO1lBQ2xELHVCQUF1QjtZQUN2QixNQUFNLHFCQUFxQixHQUFHLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFpQyxDQUFDO1lBQ3ZGLElBQUksbUNBQXVCLEVBQUMscUJBQXFCLENBQUMsRUFBRTtnQkFDaEQsS0FBSyxNQUFNLGVBQWUsSUFBSSxxQkFBcUIsQ0FBQyxVQUFVLEVBQUU7b0JBQzVELE1BQU0scUJBQXFCLEdBQWdCLE1BQU0sQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFO3dCQUN0RSxLQUFLLEVBQUUsVUFBVTt3QkFDakIsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLGtCQUFrQixHQUFHLEdBQUcsR0FBRyxlQUFlLENBQUMsSUFBSTtxQkFDL0UsQ0FBQyxDQUFDO29CQUNILFNBQVMsQ0FBQyxxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLHFCQUFxQixDQUFDO2lCQUMvRTthQUNKO1NBQ0o7UUFDRCxLQUFLLE1BQU0sV0FBVyxJQUFJLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRTtZQUN2RCxTQUFTLENBQUMsV0FBVyxDQUFDLGtCQUFrQixDQUFDLEdBQUcsV0FBVyxDQUFDO1NBQzNEO0tBQ0o7SUFFRCxLQUFLLE1BQU0sZ0JBQWdCLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1FBQ3hFLEtBQUssTUFBTSxjQUFjLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsRUFBRTtZQUMzRSxNQUFNLGlCQUFpQixHQUFHLG1CQUFPLEVBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDakYsY0FBYyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRTtnQkFDOUMsSUFBSSxhQUFhLEdBQUcsR0FBRyxpQkFBaUIsSUFBSSxtQkFBTyxFQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7Z0JBQy9GLElBQUksVUFBVSxDQUFDLFNBQVMsRUFBRTtvQkFDdEIsYUFBYSxJQUFJLElBQUksVUFBVSxDQUFDLFNBQVMsRUFBRSxDQUFDO2lCQUMvQztnQkFDRCxTQUFTLENBQUMsYUFBYSxDQUFDLEdBQUcsVUFBVSxDQUFDO2dCQUNyQyxVQUF5QixDQUFDLGtCQUFrQixHQUFHLGFBQWEsQ0FBQztZQUNsRSxDQUFDLENBQUMsQ0FBQztTQUNOO0tBQ0o7SUFDRCxPQUFPLFNBQVMsQ0FBQztBQUNyQixDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0gsU0FBUyxXQUFXLENBQUMsYUFBcUIsRUFBRSxJQUFZO0lBQ3BELElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUN0QixPQUFPLGFBQWEsR0FBRyxtQkFBTyxFQUFDLHlCQUFpQixFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzNEO1NBQU07UUFDSCxPQUFPLGFBQWEsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDO0tBQ3JDO0FBQ0wsQ0FBQztBQUVELE1BQU0scUJBQXFCLEdBQVEsRUFBRSxDQUFDO0FBQ3RDLElBQUksaUJBQWlCLEdBQTBCLEVBQUUsQ0FBQztBQUVsRDs7O0dBR0c7QUFDSCxTQUFTLHlCQUF5QixDQUFDLElBQVksRUFBRSxTQUFjO0lBQzNELElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUM5QixxQkFBcUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0tBQzdDO1NBQU07UUFDSCxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7S0FDL0M7QUFDTCxDQUFDO0FBRUQ7Ozs7Ozs7Ozs7R0FVRztBQUNILFNBQVMsY0FBYyxDQUNuQixTQUFjLEVBQ2QsYUFBa0IsRUFDbEIsSUFBWSxFQUNaLFdBQW9CLEtBQUssRUFDekIsd0JBQWlDLEtBQUssRUFDdEMsZUFBd0I7SUFFeEIsSUFBSSxTQUFTLENBQUM7SUFDZCxJQUFJLENBQUMsSUFBSSxFQUFFO1FBQ1AsT0FBTyxTQUFTLENBQUM7S0FDcEI7SUFDRCxNQUFNLGVBQWUsR0FBVSxFQUFFLENBQUM7SUFDbEMsSUFBSSxhQUFhLElBQUksYUFBYSxDQUFDLEtBQUssS0FBSyxVQUFVLEVBQUU7UUFDckQsYUFBYSxHQUFHLFNBQVMsQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDN0U7SUFDRCxJQUFJLEdBQUcsV0FBVyxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUUzRCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2xDLE1BQU0sZUFBZSxHQUFhLEVBQUUsQ0FBQztJQUNyQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUU7UUFDM0IsOEJBQThCO1FBQzlCLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtZQUM5QixNQUFNLENBQUMsWUFBWSxFQUFFLGNBQWMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDM0QsZUFBZSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNuQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksY0FBYyxFQUFFLENBQUMsQ0FBQztTQUM5QzthQUFNO1lBQ0gsZUFBZSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUNsQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0gsSUFBSSxXQUFXLEdBQUcsSUFBSSxDQUFDO0lBQ3ZCLElBQUksY0FBYyxHQUFHLGFBQWEsQ0FBQztJQUNuQyxNQUFNLE1BQU0sR0FBRyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBaUIsRUFBRSxRQUFRLEVBQUUsRUFBRTtRQUNsRSxJQUFJLFFBQVEsS0FBSyxPQUFPLElBQUksWUFBWSxDQUFDLEtBQUssS0FBSyxZQUFZLEVBQUU7WUFDN0QsT0FBTyxZQUFZLENBQUM7U0FDdkI7UUFDRCxJQUFJLFFBQVEsS0FBSyxHQUFHLElBQUksWUFBWSxDQUFDLEtBQUssS0FBSyxXQUFXLEVBQUU7WUFDeEQsT0FBTyxZQUFZLENBQUM7U0FDdkI7UUFDRCxJQUFJLENBQUMsUUFBUSxLQUFLLGdCQUFnQixJQUFJLFFBQVEsS0FBSyxHQUFHLENBQUMsSUFBSSxZQUFZLENBQUMsS0FBSyxLQUFLLFFBQVEsRUFBRTtZQUN4RixPQUFPLFlBQVksQ0FBQztTQUN2QjtRQUNELElBQUksUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDdkIsaURBQWlEO1lBQ2pELElBQ0ksWUFBWTtnQkFDWixDQUFDLFlBQVksQ0FBQyxLQUFLLEtBQUssV0FBVyxJQUFJLFlBQVksQ0FBQyxLQUFLLEtBQUssV0FBVyxDQUFDO2dCQUMxRSxZQUFZLENBQUMsVUFBVSxFQUN6QjtnQkFDRSxJQUFJLHFCQUFxQixFQUFFO29CQUN2QixlQUFlLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO2lCQUN0QztnQkFDRCxZQUFZLEdBQUcsWUFBWSxDQUFDLFVBQVUsQ0FBQzthQUMxQztZQUNELElBQUksWUFBWSxJQUFJLFlBQVksQ0FBQyxLQUFLLEtBQUssb0JBQW9CLElBQUksWUFBWSxDQUFDLFVBQVUsRUFBRTtnQkFDeEYsSUFBSSxxQkFBcUIsRUFBRTtvQkFDdkIsZUFBZSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztpQkFDdEM7Z0JBQ0QsWUFBWSxHQUFHLFlBQVksQ0FBQyxVQUFVLENBQUM7YUFDMUM7WUFDRCxPQUFPLFlBQVksQ0FBQztTQUN2QjtRQUNELElBQUkscUJBQXFCLElBQUksWUFBWSxLQUFLLElBQUksSUFBSSxZQUFZLEtBQUssU0FBUyxFQUFFO1lBQzlFLGVBQWUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7U0FDdEM7UUFDRCxJQUFJLENBQUMsWUFBWSxFQUFFO1lBQ2YsV0FBVyxHQUFHLFFBQVEsQ0FBQztTQUMxQjthQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxLQUFLLFdBQVcsSUFBSSxZQUFZLENBQUMsS0FBSyxLQUFLLFdBQVcsQ0FBQyxJQUFJLFFBQVEsS0FBSyxPQUFPLEVBQUU7WUFDM0csWUFBWSxHQUFHLFlBQVksQ0FBQyxVQUFVLENBQUM7WUFDdkMsT0FBTyxZQUFZLENBQUM7U0FDdkI7YUFBTSxJQUNILENBQUMsWUFBWSxDQUFDLEtBQUssS0FBSyxXQUFXLElBQUksWUFBWSxDQUFDLEtBQUssS0FBSyxXQUFXLENBQUM7WUFDMUUsUUFBUSxLQUFLLDRCQUE0QixFQUMzQztZQUNFLFlBQVksR0FBRyxZQUFZLENBQUMseUJBQXlCLENBQUM7WUFDdEQsT0FBTyxZQUFZLENBQUM7U0FDdkI7YUFBTSxJQUNILENBQUMsWUFBWSxDQUFDLEtBQUssS0FBSyxXQUFXLElBQUksWUFBWSxDQUFDLEtBQUssS0FBSyxXQUFXLENBQUM7WUFDMUUsWUFBWSxDQUFDLFVBQVUsRUFDekI7WUFDRSxXQUFXLEdBQUcsV0FBVyxDQUFDLFlBQVksQ0FBQyxjQUFjLEVBQUUsUUFBUSxDQUFDLENBQUM7U0FDcEU7YUFBTSxJQUFJLFlBQVksQ0FBQyxLQUFLLEtBQUssb0JBQW9CLEVBQUU7WUFDcEQsV0FBVyxHQUFHLFdBQVcsQ0FBQyxZQUFZLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDckUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRTtnQkFDekIscUJBQXFCO2dCQUNyQixXQUFXLEdBQUcsV0FBVyxDQUFDLFlBQVksQ0FBQyxjQUFjLEVBQUUsUUFBUSxDQUFDLENBQUM7YUFDcEU7U0FDSjthQUFNLElBQUksWUFBWSxDQUFDLEtBQUssS0FBSyxVQUFVLEVBQUU7WUFDMUMsMEJBQTBCO1lBQzFCLElBQUksWUFBWSxDQUFDLFVBQVUsRUFBRTtnQkFDekIsV0FBVyxHQUFHLFdBQVcsQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLGtCQUFrQixFQUFFLFFBQVEsQ0FBQyxDQUFDO2FBQ25GO2lCQUFNO2dCQUNILFdBQVcsR0FBRyxXQUFXLENBQUMsWUFBWSxDQUFDLGtCQUFrQixFQUFFLFFBQVEsQ0FBQyxDQUFDO2FBQ3hFO1NBQ0o7YUFBTSxJQUFJLFlBQVksQ0FBQyxLQUFLLEtBQUssUUFBUSxJQUFJLFlBQVksQ0FBQyxPQUFPLEVBQUU7WUFDaEUsV0FBVyxHQUFHLFdBQVcsQ0FBQyxZQUFZLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDckUsSUFBSSxRQUFRLEtBQUssWUFBWSxFQUFFO2dCQUMzQixPQUFPLFlBQVksQ0FBQyxVQUFVLENBQUM7YUFDbEM7WUFFRCxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxFQUFFO2dCQUN6QixXQUFXLEdBQUcsV0FBVyxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7YUFDaEU7U0FDSjthQUFNLElBQUksWUFBWSxDQUFDLEtBQUssS0FBSyxpQkFBaUIsRUFBRTtZQUNqRCxXQUFXLEdBQUcsV0FBVyxDQUNyQixhQUFhLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxhQUFhLENBQUMsa0JBQWtCLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQ2hHLFFBQVEsQ0FDWCxDQUFDO1lBQ0YsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRTtnQkFDekIsSUFBSSxPQUFPLEdBQUcsYUFBYSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDaEUsSUFBSSxPQUFPLEtBQUssQ0FBQyxDQUFDLEVBQUU7b0JBQ2hCLE9BQU8sR0FBRyxhQUFhLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDO2lCQUNyRDtnQkFDRCxXQUFXLEdBQUcsV0FBVyxDQUNwQixTQUFTLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQVksQ0FBQyxVQUFVLEVBQ3hGLFFBQVEsQ0FDWCxDQUFDO2FBQ0w7U0FDSjthQUFNO1lBQ0gsV0FBVyxHQUFHLFdBQVcsQ0FBQyxZQUFZLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDckUsSUFBSSxRQUFRLEtBQUssTUFBTSxJQUFJLFlBQVksQ0FBQyxRQUFRLENBQUMsS0FBSyxTQUFTLEVBQUU7Z0JBQzdELE9BQU8sWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQ2pDO2lCQUFNLElBQUksUUFBUSxLQUFLLGlCQUFpQixJQUFJLFlBQVksQ0FBQyxPQUFPLEVBQUU7Z0JBQy9ELE1BQU0sZ0JBQWdCLEdBQUcsU0FBUyxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbEYsTUFBTSxTQUFTLEdBQVEsY0FBYyxDQUFDLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRSxZQUFZLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztnQkFDcEcsU0FBUyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxnQkFBcUIsRUFBRSxFQUFFO29CQUN2RCxJQUFJLGVBQWUsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTt3QkFDbEQsZUFBZSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO3FCQUMxQztnQkFDTCxDQUFDLENBQUMsQ0FBQztnQkFDSCxPQUFPLFNBQVMsQ0FBQyxNQUFNLENBQUM7YUFDM0I7aUJBQU0sSUFBSSxRQUFRLEtBQUssT0FBTyxJQUFJLFlBQVksQ0FBQyxPQUFPLEVBQUU7Z0JBQ3JELGNBQWMsR0FBRyxlQUFlO3FCQUMzQixNQUFNLEVBQUU7cUJBQ1IsT0FBTyxFQUFFO3FCQUNULElBQUksQ0FDRCxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQ0osR0FBRyxDQUFDLEtBQUssS0FBSyxZQUFZO29CQUMxQixHQUFHLENBQUMsS0FBSyxLQUFLLFdBQVc7b0JBQ3pCLEdBQUcsQ0FBQyxLQUFLLEtBQUssV0FBVztvQkFDekIsR0FBRyxDQUFDLEtBQUssS0FBSyxvQkFBb0IsQ0FDekMsQ0FBQztnQkFDTixJQUFJLGNBQWMsRUFBRTtvQkFDaEIsTUFBTSxTQUFTLEdBQVEsY0FBYyxDQUFDLFNBQVMsRUFBRSxjQUFjLEVBQUUsWUFBWSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7b0JBQ2pHLFNBQVMsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUMsZ0JBQXFCLEVBQUUsRUFBRTt3QkFDdkQsSUFBSSxlQUFlLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7NEJBQ2xELGVBQWUsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQzt5QkFDMUM7b0JBQ0wsQ0FBQyxDQUFDLENBQUM7b0JBQ0gsT0FBTyxTQUFTLENBQUMsTUFBTSxDQUFDO2lCQUMzQjtnQkFDRCxPQUFPLFlBQVksQ0FBQyxPQUFPLENBQUM7YUFDL0I7aUJBQU0sSUFBSSxRQUFRLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLFlBQVksQ0FBQyxPQUFPLEVBQUU7Z0JBQzdELE1BQU0sa0JBQWtCLEdBQUcsWUFBWSxDQUFDLE9BQU8sQ0FBQztnQkFDaEQsV0FBVyxHQUFHLFdBQVcsQ0FBQyxrQkFBa0IsQ0FBQyxrQkFBa0IsRUFBRSxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDM0Y7aUJBQU0sSUFBSSxZQUFZLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxFQUFFO2dCQUN4RSxrQ0FBa0M7Z0JBQ2xDLE1BQU0sVUFBVSxHQUFHLFNBQVMsQ0FBQyxZQUFZLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzVFLElBQUksVUFBVSxFQUFFO29CQUNaLFdBQVcsR0FBRyxXQUFXLENBQUMsVUFBVSxDQUFDLGtCQUFrQixFQUFFLFFBQVEsQ0FBQyxDQUFDO2lCQUN0RTthQUNKO1NBQ0o7UUFDRCxPQUFPLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNsQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDVCxJQUFJLENBQUMsTUFBTSxFQUFFO1FBQ1QsSUFBSSxlQUFlLEVBQUU7WUFDakIsTUFBTSxjQUFjLEdBQUcsaUJBQWlCLENBQUMsZUFBZSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1lBQ3pFLFNBQVMsR0FBRztnQkFDUixPQUFPLEVBQ0gseUNBQXlDO29CQUN6QyxJQUFJO29CQUNKLElBQUk7b0JBQ0osSUFBSTtvQkFDSixJQUFJO29CQUNKLDBKQUEwSjtvQkFDMUoscUJBQXFCO29CQUNyQixlQUFlO29CQUNmLEdBQUc7b0JBQ0gsSUFBSTtvQkFDSixpQkFBaUI7b0JBQ2pCLGNBQWM7b0JBQ2QsR0FBRztvQkFDSCxJQUFJO29CQUNKLG9CQUFvQjtvQkFDcEIsSUFBSTtvQkFDSixHQUFHO2FBQ1YsQ0FBQztZQUNGLHlCQUF5QixDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztTQUM5QzthQUFNO1lBQ0gsU0FBUyxHQUFHO2dCQUNSLE9BQU8sRUFDSCx5Q0FBeUM7b0JBQ3pDLElBQUk7b0JBQ0osSUFBSTtvQkFDSixJQUFJO29CQUNKLDBKQUEwSjtvQkFDMUoscUJBQXFCO29CQUNyQixTQUFTLENBQUMsQ0FBQyxDQUFDO29CQUNaLEdBQUc7b0JBQ0gsSUFBSTtvQkFDSix3QkFBd0I7b0JBQ3hCLFNBQVMsQ0FBQyxDQUFDLENBQUM7b0JBQ1osR0FBRzthQUNWLENBQUM7WUFDRix5QkFBeUIsQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7U0FDOUM7S0FDSjtJQUNELElBQUksUUFBUSxFQUFFO1FBQ1YsT0FBTyxXQUFXLENBQUM7S0FDdEI7SUFDRCxJQUFJLHFCQUFxQixFQUFFO1FBQ3ZCLE9BQU87WUFDSCxjQUFjLEVBQUUsZUFBZTtZQUMvQixNQUFNLEVBQUUsTUFBTTtTQUNqQixDQUFDO0tBQ0w7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFTLGdCQUFnQixDQUFDLE9BQWU7SUFDckMsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ3ZDLENBQUM7QUFFRCxTQUFTLFVBQVUsQ0FBQyxhQUF5QixFQUFFLFFBQWdCLEVBQUUsU0FBYyxFQUFFLE9BQTBCO0lBQ3ZHLElBQUksYUFBYSxLQUFLLFNBQVMsRUFBRTtRQUM3QixPQUFPLFNBQVMsQ0FBQztLQUNwQjtJQUNELFFBQVEsYUFBYSxDQUFDLElBQUksRUFBRTtRQUN4QixLQUFLLFFBQVE7WUFDVCxPQUFPLGFBQWEsQ0FBQyxNQUFNLENBQUM7UUFDaEMsS0FBSyxLQUFLO1lBQ04sT0FBTyxhQUFhLENBQUMsR0FBRyxDQUFDO1FBQzdCLEtBQUssTUFBTTtZQUNQLE9BQU8sYUFBYSxDQUFDLElBQUksQ0FBQztRQUM5QixLQUFLLFNBQVM7WUFDVixPQUFPLG1CQUFPLEVBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzFDLEtBQUssTUFBTTtZQUNQLE9BQU8sYUFBYSxDQUFDLElBQUksQ0FBQztRQUM5QixLQUFLLFlBQVk7WUFDYixPQUFPLGlCQUFLLEVBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzNFLEtBQUssY0FBYztZQUNmLE9BQU87Z0JBQ0gsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLEtBQUssRUFBRSxhQUFhLENBQUMsWUFBWTtnQkFDakMsa0JBQWtCLEVBQUUsUUFBUTtnQkFDNUIsT0FBTyxFQUFFLGNBQWMsQ0FDbkIsU0FBUyxFQUNULE9BQU8sQ0FBQyxhQUFhLEVBQ3JCLGFBQWEsQ0FBQyxZQUFZLEVBQzFCLEtBQUssRUFDTCxLQUFLLEVBQ0wsT0FBTyxDQUFDLFdBQVcsQ0FDdEI7YUFDSixDQUFDO1FBQ04sS0FBSyx3QkFBd0I7WUFDekIsT0FBTztnQkFDSCxJQUFJLEVBQUUsd0JBQXdCO2dCQUM5QixLQUFLLEVBQUUsYUFBYSxDQUFDLHNCQUFzQjtnQkFDM0Msa0JBQWtCLEVBQUUsUUFBUTtnQkFDNUIsT0FBTyxFQUFFLGNBQWMsQ0FDbkIsU0FBUyxFQUNULE9BQU8sQ0FBQyxhQUFhLEVBQ3JCLGFBQWEsQ0FBQyxzQkFBc0IsRUFDcEMsS0FBSyxFQUNMLEtBQUssRUFDTCxPQUFPLENBQUMsV0FBVyxDQUN0QjthQUNKLENBQUM7UUFDTixLQUFLLGdCQUFnQjtZQUNqQixNQUFNLGdCQUFnQixHQUFHLGNBQWMsQ0FDbkMsU0FBUyxFQUNULE9BQU8sQ0FBQyxhQUFhLEVBQ3JCLG1CQUFPLEVBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLGNBQWMsQ0FBVyxFQUMvRSxJQUFJLEVBQ0osS0FBSyxFQUNMLE9BQU8sQ0FBQyxXQUFXLENBQ3RCLENBQUM7WUFDRixNQUFNLGNBQWMsR0FBRztnQkFDbkIsSUFBSSxFQUFFLGdCQUFnQjtnQkFDdEIsS0FBSyxFQUFFLGFBQWEsQ0FBQyxjQUFjO2dCQUNuQyxrQkFBa0IsRUFBRSxRQUFRO2dCQUM1QixPQUFPLEVBQUUsZ0JBQWdCO2dCQUN6QixlQUFlLEVBQUUsT0FBTyxDQUFDLFdBQVc7Z0JBQ3BDLElBQUksRUFBRSxFQUFFO2dCQUNSLElBQUksRUFBRSxFQUFFO2FBQ1gsQ0FBQztZQUNGLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxjQUFjLEVBQUUsQ0FBQyxDQUFDO1lBQ2pGLE9BQU8sY0FBYyxDQUFDO1FBQzFCLEtBQUssTUFBTTtZQUNQLE1BQU0sT0FBTyxHQUFHLGNBQWMsQ0FDMUIsU0FBUyxFQUNULE9BQU8sQ0FBQyxhQUFhLEVBQ3JCLGFBQWEsQ0FBQyxJQUFJLEVBQ2xCLElBQUksRUFDSixLQUFLLEVBQ0wsT0FBTyxDQUFDLFdBQVcsQ0FDdEIsQ0FBQztZQUNGLE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUN2RSxPQUFPLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDO2dCQUMvQixNQUFNLEVBQUUsZ0JBQWdCLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQztnQkFDNUMsU0FBUyxFQUFFLElBQUk7YUFDbEIsQ0FBQyxDQUFDO1lBQ0gsT0FBTyxJQUFJLENBQUM7UUFFaEIsS0FBSyxRQUFRO1lBQ1QsT0FBTyxXQUFXLENBQUMsYUFBYSxDQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzNFLEtBQUssWUFBWTtZQUNiLE9BQU8sZUFBZSxDQUFDLGFBQWEsQ0FBQyxVQUFVLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNuRixLQUFLLE9BQU8sQ0FBQztRQUNiLEtBQUssTUFBTSxDQUFDO1FBQ1osS0FBSyxLQUFLLENBQUM7UUFDWCxLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssSUFBSSxDQUFDO1FBQ1YsS0FBSyxJQUFJLENBQUM7UUFDVixLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssSUFBSSxDQUFDO1FBQ1YsS0FBSyxJQUFJLENBQUM7UUFDVixLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssS0FBSyxDQUFDO1FBQ1gsS0FBSyxJQUFJLENBQUM7UUFDVjtZQUNJLE9BQU8sYUFBYSxDQUFDO0tBQzVCO0FBQ0wsQ0FBQztBQUVEOzs7Ozs7O0dBT0c7QUFDSCxTQUFTLGlCQUFpQixDQUFDLGVBQXVCLEVBQUUsZ0JBQXdCLEVBQUUsZUFBd0I7SUFDbEcsSUFBSSxVQUFVLEdBQUksbUJBQW1CLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDdkQsSUFBSSxlQUFlLEVBQUU7UUFDakIsZUFBZSxHQUFHLGVBQWUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLEdBQUcsZUFBZSxDQUFDO1FBQzVGLFVBQVUsR0FBSSxtQkFBbUIsQ0FBQyxlQUFlLENBQUMsQ0FBQztLQUN0RDtJQUNELE1BQU0sU0FBUyxHQUFHO1FBQ2QsT0FBTyxFQUFFLEtBQUs7UUFDZCxPQUFPLEVBQUUsK0NBQStDLGVBQWUsd0NBQXdDLFVBQVU7O3VCQUUxRyxnQkFBZ0I7cUJBQ2xCLGVBQWU7OztlQUdyQjtLQUNWLENBQUM7SUFDRix5QkFBeUIsQ0FBQyxnQkFBZ0IsR0FBRyxHQUFHLEdBQUcsZUFBZSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQy9FLE9BQU8sVUFBVSxDQUFDO0FBQ3RCLENBQUM7QUFFRCxTQUFTLHdCQUF3QixDQUFDLGlCQUFzQixFQUFFLGNBQW1CO0lBQ3pFLE9BQU8sQ0FDSCxpQkFBaUIsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDO1FBQzFDLENBQUMsY0FBYyxDQUFDLEtBQUssS0FBSywrQ0FBK0M7WUFDckUsY0FBYyxDQUFDLEtBQUssS0FBSyxnREFBZ0QsQ0FBQyxDQUNqRixDQUFDO0FBQ04sQ0FBQztBQUVELFNBQVMsZUFBZSxDQUFDLGdCQUFrQyxFQUFFLE9BQTBCO0lBQ25GLElBQUksVUFBVSxDQUFDO0lBQ2YsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksSUFBSSxPQUFPLENBQUMsV0FBVyxFQUFFO1FBQy9DLFVBQVUsR0FBRyxpQkFBaUIsQ0FDMUIsT0FBTyxDQUFDLFdBQVcsRUFDbkIsT0FBTyxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsRUFDeEMsT0FBTyxDQUFDLGVBQWUsQ0FDMUIsQ0FBQztLQUNMO1NBQU07UUFDSCxVQUFVLEdBQUcsbUJBQU8sRUFBQyxPQUFPLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUMvRTtJQUNELE9BQU8sVUFBVSxDQUFDO0FBQ3RCLENBQUM7QUFFRCxTQUFTLFdBQVcsQ0FDaEIsZ0JBQWtDLEVBQ2xDLFVBQWtCLEVBQ2xCLFNBQWMsRUFDZCxPQUEwQjtJQUUxQixNQUFNLFVBQVUsR0FBRyxlQUFlLENBQUMsZ0JBQWdCLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFFOUQsTUFBTSxjQUFjLEdBQVE7UUFDeEIsS0FBSyxFQUFFLFVBQVU7UUFDakIsa0JBQWtCLEVBQUUsVUFBVTtRQUM5QixXQUFXLEVBQUUsRUFBRTtLQUNsQixDQUFDO0lBQ0YsTUFBTSxpQkFBaUIsR0FBUSxFQUFFLENBQUM7SUFDbEMsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxFQUFFO1FBQzdDLE1BQU0saUJBQWlCLEdBQUc7WUFDdEIsTUFBTSxFQUFFLFVBQVU7WUFDbEIsV0FBVyxFQUFFLGdCQUFnQixDQUFDLFdBQVc7WUFDekMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxhQUFhO1NBQ2xDLENBQUM7UUFDRixPQUFPLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7S0FDekQ7SUFDRCxJQUFJLGdCQUFnQixDQUFDLGNBQWMsRUFBRTtRQUNqQyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUMsYUFBNEIsRUFBRSxFQUFFOztZQUNyRSxPQUFPLENBQUMsZUFBZSxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUM7WUFDN0MsaUJBQWlCLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxHQUFHLFVBQVUsQ0FDOUMsYUFBYSxDQUFDLEtBQUssRUFDbkIsR0FBRyxVQUFVLElBQUksYUFBYSxDQUFDLElBQUksRUFBRSxFQUNyQyxTQUFTLEVBQ1QsT0FBTyxDQUNWLENBQUM7WUFDRixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxFQUFFO2dCQUMxQyxNQUFNLGlCQUFpQixHQUFHO29CQUN0QixNQUFNLEVBQUUsR0FBRyxVQUFVLElBQUksYUFBYSxDQUFDLElBQUksRUFBRTtvQkFDN0MsV0FBVyxFQUFFLGFBQWEsQ0FBQyxXQUFXO29CQUN0QyxRQUFRLEVBQUUsT0FBTyxDQUFDLGFBQWE7aUJBQ2xDLENBQUM7Z0JBQ0YsT0FBTyxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO2FBQ3pEO1lBQ0QsSUFBSSx3QkFBd0IsQ0FBQyxpQkFBaUIsRUFBRSxjQUFjLENBQUMsRUFBRTtnQkFDN0QsNERBQTREO2dCQUM1RCxpQkFBaUIsQ0FBQyxZQUFZLEdBQUcsYUFBTyxDQUFDLGFBQWEsQ0FBQyxPQUFPLDBDQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUUzRixJQUFJLENBQUMsaUJBQWlCLENBQUMsWUFBWSxFQUFFO29CQUNqQyxNQUFNLE1BQU0sR0FBRyxTQUFTLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQ25ELElBQUksTUFBTSxhQUFOLE1BQU0sdUJBQU4sTUFBTSxDQUFFLE9BQU8sRUFBRTt3QkFDakIsMENBQTBDO3dCQUMxQyxpQkFBaUIsQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDO3FCQUMzQzt5QkFBTSxJQUFJLE1BQU0sRUFBRTt3QkFDZixtREFBbUQ7d0JBQ25ELGlCQUFpQixDQUFDLFlBQVksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO3FCQUNsRDtpQkFDSjtnQkFFRCxJQUFJLENBQUMsaUJBQWlCLENBQUMsWUFBWSxFQUFFO29CQUNqQywrQkFBK0I7b0JBQy9CLGlCQUFpQixDQUFDLElBQUksQ0FBQzt3QkFDbkIsT0FBTyxFQUNILCtCQUErQjs0QkFDL0IsaUJBQWlCLENBQUMsTUFBTTs0QkFDeEIsZUFBZTs0QkFDZixjQUFjLENBQUMsa0JBQWtCO3FCQUN4QyxDQUFDLENBQUM7aUJBQ047YUFDSjtRQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxDQUFDLGVBQWUsR0FBRyxTQUFTLENBQUM7S0FDdkM7SUFDRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLGlCQUFpQixDQUFDLENBQUM7QUFDNUQsQ0FBQztBQXVCRDs7Ozs7R0FLRztBQUNILFNBQVMsd0JBQXdCLENBQUMsb0JBQTJCO0lBQ3pELElBQUksSUFBSSxHQUFvQixvQkFBNEIsQ0FBQyxJQUFJLENBQUM7SUFDOUQsSUFBSSxJQUFJLEtBQUssU0FBUyxJQUFJLG9CQUFvQixDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7UUFDdkQsTUFBTSxZQUFZLEdBQUcsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0MsSUFBSSxZQUFZLENBQUMsY0FBYyxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQzdDLElBQUksR0FBRyxjQUFjLENBQUM7U0FDekI7YUFBTSxJQUFJLFlBQVksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDNUMsSUFBSSxHQUFHLE1BQU0sQ0FBQztTQUNqQjthQUFNLElBQUksWUFBWSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO1lBQ3RELElBQUksR0FBRyxnQkFBZ0IsQ0FBQztTQUMzQjthQUFNLElBQUksWUFBWSxDQUFDLGNBQWMsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFO1lBQzlELElBQUksR0FBRyx3QkFBd0IsQ0FBQztTQUNuQzthQUFNLElBQ0gsT0FBTyxZQUFZLEtBQUssUUFBUTtZQUNoQyxDQUFDLFlBQVksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLElBQUksWUFBWSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLEVBQ3hGO1lBQ0UsSUFBSSxHQUFHLFFBQVEsQ0FBQztTQUNuQjthQUFNLElBQUksT0FBTyxZQUFZLEtBQUssUUFBUSxFQUFFO1lBQ3pDLElBQUksR0FBRyxRQUFRLENBQUM7U0FDbkI7S0FDSjtTQUFNLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRTtRQUMzQixJQUFJLEdBQUcsaUJBQWlCLENBQUM7S0FDNUI7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNoQixDQUFDO0FBRUQsU0FBUyxlQUFlLENBQUMsb0JBQTJCLEVBQUUsU0FBaUIsRUFBRSxTQUFjLEVBQUUsT0FBMEI7SUFDL0csTUFBTSx3QkFBd0IsR0FBRyx3QkFBd0IsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ2hGLFFBQVEsd0JBQXdCLEVBQUU7UUFDOUIsS0FBSyxjQUFjO1lBQ2YsT0FBTyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxZQUFZLEVBQUUsV0FBVyxFQUFFLEVBQUU7Z0JBQzFELE9BQU87b0JBQ0gsSUFBSSxFQUFFLGNBQWM7b0JBQ3BCLEtBQUssRUFBRSxZQUFZLENBQUMsWUFBWTtvQkFDaEMsa0JBQWtCLEVBQUUsR0FBRyxTQUFTLElBQUksV0FBVyxFQUFFO29CQUNqRCxPQUFPLEVBQUUsY0FBYyxDQUNuQixTQUFTLEVBQ1QsT0FBTyxDQUFDLGFBQWEsRUFDckIsWUFBWSxDQUFDLFlBQVksRUFDekIsS0FBSyxFQUNMLEtBQUssRUFDTCxPQUFPLENBQUMsV0FBVyxDQUN0QjtpQkFDSixDQUFDO1lBQ04sQ0FBQyxDQUFDLENBQUM7UUFDUCxLQUFLLE1BQU07WUFDUCxPQUFPLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFO2dCQUMxQyxNQUFNLE9BQU8sR0FBRyxjQUFjLENBQzFCLFNBQVMsRUFDVCxPQUFPLENBQUMsYUFBYSxFQUNyQixTQUFTLENBQUMsSUFBSSxFQUNkLElBQUksRUFDSixLQUFLLEVBQ0wsT0FBTyxDQUFDLFdBQVcsQ0FDdEIsQ0FBQztnQkFDRixNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLENBQUM7Z0JBQ25FLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUM7b0JBQy9CLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDO29CQUN4QyxTQUFTLEVBQUUsSUFBSTtpQkFDbEIsQ0FBQyxDQUFDO2dCQUNILE9BQU8sSUFBSSxDQUFDO1lBQ2hCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsS0FBSyxnQkFBZ0I7WUFDakIsT0FBTyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxjQUFjLEVBQUUsYUFBYSxFQUFFLEVBQUU7Z0JBQzlELE1BQU0sZ0JBQWdCLEdBQUcsY0FBYyxDQUNuQyxTQUFTLEVBQ1QsT0FBTyxDQUFDLGFBQWEsRUFDckIsY0FBYyxDQUFDLGNBQWMsRUFDN0IsSUFBSSxFQUNKLEtBQUssRUFDTCxPQUFPLENBQUMsV0FBVyxDQUN0QixDQUFDO2dCQUNGLE1BQU0sMkJBQTJCLEdBQUc7b0JBQ2hDLElBQUksRUFBRSxnQkFBZ0I7b0JBQ3RCLEtBQUssRUFBRSxjQUFjLENBQUMsY0FBYztvQkFDcEMsa0JBQWtCLEVBQUUsR0FBRyxTQUFTLElBQUksYUFBYSxFQUFFO29CQUNuRCxPQUFPLEVBQUUsZ0JBQWdCO29CQUN6QixlQUFlLEVBQUUsT0FBTyxDQUFDLFdBQVc7b0JBQ3BDLElBQUksRUFBRSxFQUFFO29CQUNSLElBQUksRUFBRSxFQUFFO2lCQUNYLENBQUM7Z0JBQ0YsT0FBTyxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQztvQkFDL0IsTUFBTSxFQUFFLEtBQUs7b0JBQ2IsU0FBUyxFQUFFLDJCQUEyQjtpQkFDekMsQ0FBQyxDQUFDO2dCQUNILE9BQU8sMkJBQTJCLENBQUM7WUFDdkMsQ0FBQyxDQUFDLENBQUM7UUFDUCxLQUFLLHdCQUF3QjtZQUN6QixPQUFPLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDLGVBQWUsRUFBRSxVQUFVLEVBQUUsRUFBRTtnQkFDNUQsT0FBTztvQkFDSCxJQUFJLEVBQUUsd0JBQXdCO29CQUM5QixLQUFLLEVBQUUsZUFBZSxDQUFDLHNCQUFzQjtvQkFDN0Msa0JBQWtCLEVBQUUsR0FBRyxTQUFTLElBQUksVUFBVSxFQUFFO29CQUNoRCxPQUFPLEVBQUUsY0FBYyxDQUNuQixTQUFTLEVBQ1QsT0FBTyxDQUFDLGFBQWEsRUFDckIsZUFBZSxDQUFDLHNCQUFzQixFQUN0QyxLQUFLLEVBQ0wsS0FBSyxFQUNMLE9BQU8sQ0FBQyxXQUFXLENBQ3RCO2lCQUNKLENBQUM7WUFDTixDQUFDLENBQUMsQ0FBQztRQUNQLEtBQUssUUFBUTtZQUNULE9BQU8sb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsU0FBUyxFQUFFLEVBQUU7Z0JBQzVELE9BQU8sV0FBVyxDQUFDLGdCQUFnQixFQUFFLEdBQUcsU0FBUyxJQUFJLFNBQVMsRUFBRSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUMxRixDQUFDLENBQUMsQ0FBQztRQUNQLEtBQUssT0FBTyxDQUFDO1FBQ2IsS0FBSyxNQUFNLENBQUM7UUFDWixLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssSUFBSSxDQUFDO1FBQ1YsS0FBSyxJQUFJLENBQUM7UUFDVixLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssSUFBSSxDQUFDO1FBQ1YsS0FBSyxJQUFJLENBQUM7UUFDVixLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssS0FBSyxDQUFDO1FBQ1gsS0FBSyxLQUFLLENBQUM7UUFDWCxLQUFLLElBQUk7WUFDTCxPQUFPLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFO2dCQUN4QyxPQUFPLE9BQU8sQ0FBQztZQUNuQixDQUFDLENBQUMsQ0FBQztRQUNQLEtBQUssUUFBUTtZQUNULE9BQU8sb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLEVBQUU7Z0JBQzVDLElBQUksT0FBTyxXQUFXLEtBQUssUUFBUSxFQUFFO29CQUNqQyxPQUFPLFdBQVcsQ0FBQztpQkFDdEI7cUJBQU0sSUFBSSxXQUFXLEtBQUssU0FBUyxFQUFFO29CQUNsQyxPQUFPLFdBQVcsQ0FBQztpQkFDdEI7cUJBQU07b0JBQ0gsT0FBTyxXQUFXLENBQUMsTUFBTSxDQUFDO2lCQUM3QjtZQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ1A7WUFDSSxJQUFJLG9CQUFvQixDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7Z0JBQ25DLE9BQU8sRUFBRSxDQUFDO2FBQ2I7WUFDRCxNQUFNLElBQUksS0FBSyxDQUFDLGtCQUFrQixDQUFDLENBQUM7S0FDM0M7QUFDTCxDQUFDO0FBY0QsU0FBUyxpQkFBaUIsQ0FBQyxVQUFzQixFQUFFLFNBQWMsRUFBRSxPQUEwQjtJQUN6RixJQUFJLFVBQVUsQ0FBQyxNQUFNLEVBQUU7UUFDbkIsT0FBTyxXQUFXLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0tBQzVGO1NBQU0sSUFBSSxVQUFVLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRTtRQUM1QyxJQUFJLFVBQVUsQ0FBQyxLQUFLLEVBQUU7WUFDbEIsT0FBTyxVQUFVLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQzFGO2FBQU07WUFDSCxPQUFPLElBQUksQ0FBQztTQUNmO0tBQ0o7U0FBTSxJQUFJLFVBQVUsQ0FBQyxVQUFVLEVBQUU7UUFDOUIsTUFBTSxVQUFVLEdBQVEsZUFBZSxDQUNuQyxVQUFVLENBQUMsVUFBVSxFQUNyQixVQUFVLENBQUMsa0JBQWtCLEVBQzdCLFNBQVMsRUFDVCxPQUFPLENBQ1YsQ0FBQztRQUNGLFVBQVUsQ0FBQyxrQkFBa0IsR0FBRyxVQUFVLENBQUMsa0JBQWtCLENBQUM7UUFDOUQsT0FBTyxVQUFVLENBQUM7S0FDckI7U0FBTTtRQUNILE1BQU0sSUFBSSxLQUFLLENBQUMsa0JBQWtCLENBQUMsQ0FBQztLQUN2QztBQUNMLENBQUM7QUFFRDs7Ozs7O0dBTUc7QUFDSCxTQUFTLG1CQUFtQixDQUFDLFVBQXNCLEVBQUUsU0FBOEI7SUFDL0UsT0FBTyxVQUFVLFlBQW9CLEVBQUUscUJBQThCO1FBQ2pFLE1BQU0sY0FBYyxHQUFXLEVBQUUsQ0FBQztRQUNsQyxPQUFPLGNBQWMsQ0FBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUscUJBQXFCLEVBQUUsY0FBYyxDQUFDLENBQUM7SUFDN0csQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQUVELFNBQVMsMkJBQTJCLENBQ2hDLE9BQWdDLEVBQ2hDLFlBQThCLEVBQzlCLFNBQThCLEVBQzlCLFVBQThCO0lBRTlCLE1BQU0saUJBQWlCLEdBQUcsWUFBWSxDQUFDLElBQUksQ0FDdkMsQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxrQkFBa0IsS0FBSyxPQUFPLENBQUMsWUFBWSxDQUMzRSxDQUFDO0lBQ0YsSUFBSSxpQkFBaUIsRUFBRTtRQUNuQixNQUFNLGNBQWMsR0FBRyxpQkFBaUIsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxLQUFLLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNuRyxJQUFJLGNBQWMsRUFBRTtZQUNoQixVQUFVLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkQsVUFBVSxDQUFDLFlBQVksR0FBRyxjQUFjLENBQUMsWUFBWSxLQUFLLEdBQUcsQ0FBQztTQUNqRTtLQUNKO0lBQ0QsVUFBVSxDQUFDLHFCQUFxQixHQUFHLE9BQU8sQ0FBQyxxQkFBcUIsSUFBSSxFQUFFLENBQUM7QUFDM0UsQ0FBQztBQUVELFNBQVMsMkJBQTJCLENBQ2hDLE9BQWdDLEVBQ2hDLFNBQThCLEVBQzlCLFVBQThCO0lBRTlCLFVBQVUsQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUMxRCxVQUFVLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUM7SUFDckMsVUFBVSxDQUFDLFlBQVksR0FBRyxPQUFPLENBQUMsWUFBWSxDQUFDO0lBQy9DLFVBQVUsQ0FBQyxjQUFjLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQztJQUNuRCxVQUFVLENBQUMscUJBQXFCLEdBQUcsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0FBQ3JFLENBQUM7QUFFRCxTQUFTLHNCQUFzQixDQUMzQixPQUEwRDtJQUUxRCxPQUFPLENBQUMsQ0FBRSxPQUFrQyxDQUFDLGNBQWMsQ0FBQztBQUNoRSxDQUFDO0FBRUQsU0FBUywyQkFBMkIsQ0FDaEMsb0JBQTJFLEVBQzNFLFlBQThCLEVBQzlCLFNBQThCO0lBRTlCLE9BQU8sb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUU7UUFDeEMsTUFBTSxVQUFVLEdBQXVCO1lBQ25DLEtBQUssRUFBRSxvQkFBb0I7WUFDM0IsSUFBSSxFQUFFLE9BQU8sQ0FBQyxJQUFJO1lBQ2xCLGtCQUFrQixFQUFFLE9BQU8sQ0FBQyxrQkFBa0I7WUFDOUMsWUFBWSxFQUFFLEtBQUs7WUFDbkIsY0FBYyxFQUFFLEtBQUs7WUFDckIscUJBQXFCLEVBQUUsRUFBRTtZQUN6QixXQUFXLEVBQUUsRUFBRTtZQUNmLE9BQU8sRUFBRSxFQUFFO1lBQ1gsVUFBVSxFQUFFLFNBQWdCO1lBQzVCLGNBQWMsRUFBRSxFQUFFO1NBQ3JCLENBQUM7UUFDRixJQUFJLHNCQUFzQixDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ2pDLDJCQUEyQixDQUFDLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7U0FDL0Q7YUFBTTtZQUNILDJCQUEyQixDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1NBQzdFO1FBQ0QsSUFBSSxVQUFVLENBQUMsVUFBVSxFQUFFO1lBQ3ZCLFVBQVUsQ0FBQyxjQUFjLEdBQUcsVUFBVSxDQUFDLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQztTQUN4RTtRQUNELFNBQVMsQ0FBQyxVQUFVLENBQUMsa0JBQWtCLENBQUMsR0FBRyxVQUFVLENBQUM7UUFDdEQsT0FBTyxVQUFVLENBQUM7SUFDdEIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQVMsMkJBQTJCLENBQ2hDLFdBQTRCLEVBQzVCLFlBQThCLEVBQzlCLFNBQThCO0lBRTlCLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRTtRQUMvQixVQUFVLENBQUMsb0JBQW9CLEdBQUcsMkJBQTJCLENBQ3pELFVBQVUsQ0FBQyxvQkFBb0IsRUFDL0IsWUFBWSxFQUNaLFNBQVMsQ0FDWixDQUFDO1FBQ0QsVUFBeUIsQ0FBQyxXQUFXLEdBQUcsbUJBQW1CLENBQUMsVUFBd0IsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUN0RyxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRDs7OztHQUlHO0FBQ0gsU0FBUyx1QkFBdUIsQ0FBQyxTQUFpQixFQUFFLE9BQWlCLEVBQUUsU0FBOEI7SUFDakcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO1FBQ3ZCLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFO1lBQ3JCLE1BQU0sQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1NBQzNCO1FBQ0QsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFO1lBQ2hCLE1BQU0sZ0JBQWdCLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUN0RCxNQUFNLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7WUFDM0MsSUFBSSxnQkFBZ0IsRUFBRTtnQkFDbEIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRTtvQkFDM0IsZ0JBQWdCLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztpQkFDakM7Z0JBQ0QsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLEdBQUcsU0FBUyxJQUFJLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQzthQUNwRTtZQUNELE1BQU0sQ0FBQyxnQkFBZ0IsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1NBQzFEO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBRUQsU0FBUywwQkFBMEIsQ0FBQyxhQUE2QixFQUFFLFNBQThCO0lBQzdGLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxZQUFZLEVBQUUsRUFBRTtRQUNuQyxZQUFZLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDN0QsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQVMseUJBQXlCLENBQzlCLFVBQXVCLEVBQ3ZCLFNBQThCLEVBQzlCLFVBQTZCO0lBRTdCLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRTtRQUM3QixTQUFTLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDM0QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEVBQUU7WUFDdkIsU0FBUyxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUMsbUJBQU8sRUFBQyxVQUFVLEVBQUUsU0FBUyxDQUFDLGNBQWMsQ0FBVyxDQUFDLENBQUM7U0FDN0Y7UUFDRCxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRTtZQUN4QixTQUFTLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztTQUM5QjtRQUNELElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRTtZQUNuQyxTQUFTLENBQUMsVUFBVSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7U0FDekM7UUFDRCxTQUFTLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFpQixFQUFFLEVBQUU7WUFDcEQsT0FBTyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDekIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRDs7OztHQUlHO0FBQ0gsU0FBUyx5QkFBeUIsQ0FDOUIsVUFBdUIsRUFDdkIsU0FBOEIsRUFDOUIsVUFBNkI7SUFFN0IsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFO1FBQzdCLFNBQVMsQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsRUFBRTtZQUN2QixTQUFTLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQyxtQkFBTyxFQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsY0FBYyxDQUFXLENBQUMsQ0FBQztTQUM3RjtRQUNELElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFO1lBQ3hCLFNBQVMsQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1NBQzlCO1FBQ0QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsV0FBVyxFQUFFO1lBQ25DLFNBQVMsQ0FBQyxVQUFVLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztTQUN6QztRQUNELFNBQVMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQWlCLEVBQUUsRUFBRTtZQUNwRCxPQUFPLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUN6QixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQUVEOzs7R0FHRztBQUNILFNBQVMsNEJBQTRCLENBQUMsV0FBeUIsRUFBRSxTQUE4QjtJQUMzRjs7T0FFRztJQUNILFNBQVMsSUFBSSxDQUFDLFFBQWtCO1FBQzVCLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFO1lBQ3ZCLFFBQVEsQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1NBQzdCO1FBRUQsSUFBSTtZQUNBLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUNwQyxJQUFJLFdBQXlDLENBQUM7Z0JBQzlDLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLEVBQUU7b0JBQ3hDLE1BQU0sZUFBZSxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztvQkFDOUUsV0FBVyxHQUFHLFNBQVMsQ0FBQyxlQUFlLENBQWdCLENBQUM7aUJBQzNEO3FCQUFNO29CQUNILFdBQVcsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBZ0IsQ0FBQztpQkFDekQ7Z0JBQ0QsSUFBSSxXQUFXLEVBQUU7b0JBQ2IsUUFBUSxDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUM7b0JBQ2xDLElBQUksV0FBVyxDQUFDLFVBQVUsRUFBRTt3QkFDeEIsV0FBVyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7cUJBQ3hDO2lCQUNKO2FBQ0o7U0FDSjtRQUFDLE9BQU8sTUFBTSxFQUFFO1lBQ2IsTUFBTSxJQUFJLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO1NBQ25EO0lBQ0wsQ0FBQztJQUVELFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRTtRQUMvQixVQUFVLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlDLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSCxTQUFTLG1CQUFtQixDQUN4QixZQUE4QixFQUM5QixZQUE4QixFQUM5QixTQUE4QjtJQUU5QixZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLEVBQUU7UUFDaEMsV0FBMkIsQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1FBQzlDLFdBQVcsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUU7WUFDeEMsSUFBSSxDQUFFLFFBQXFCLENBQUMsV0FBVyxFQUFFO2dCQUNwQyxRQUFxQixDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7YUFDM0M7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILFdBQVcsQ0FBQyxvQkFBb0IsR0FBRywyQkFBMkIsQ0FDMUQsV0FBVyxDQUFDLG9CQUFvQixFQUNoQyxZQUFZLEVBQ1osU0FBUyxDQUNaLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRDs7Ozs7O0dBTUc7QUFDSCxTQUFTLFNBQVMsQ0FBQyxVQUE2QixFQUFFLFNBQWlCO0lBQy9ELE1BQU0sV0FBVyxHQUFHLGlCQUFLLEVBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ2pELE1BQU0sT0FBTyxHQUFHLFdBQVcsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDN0MsTUFBTSxTQUFTLEdBQUcsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDcEQsTUFBTSxJQUFJLEdBQUcsV0FBVyxDQUFDLFNBQVMsQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDaEQsT0FBTyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUM3QixDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0gsU0FBUyxtQkFBbUIsQ0FBQyxlQUFrQyxFQUFFLFNBQThCO0lBQzNGLE9BQU8sU0FBUyxXQUFXLENBQUksS0FBYSxFQUFFLGtCQUEyQixLQUFLO1FBQzFFLElBQUksZUFBZSxFQUFFO1lBQ2pCLElBQUksVUFBVSxHQUFHLEtBQUssQ0FBQztZQUN2QixJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDeEIsVUFBVSxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7YUFDNUI7WUFDRCxNQUFNLGdCQUFnQixHQUFRLGNBQWMsQ0FBQyxTQUFTLEVBQUUsZUFBZSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDbEcsSUFBSSxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUU7Z0JBQ3pCLGdCQUFnQixDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDakU7WUFDRCxPQUFPO2dCQUNILE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxNQUFNO2dCQUMvQixVQUFVLEVBQUUsZ0JBQWdCLENBQUMsY0FBYzthQUM5QyxDQUFDO1NBQ0w7UUFDRCxNQUFNLFVBQVUsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLElBQUksVUFBVSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUMzQixNQUFNLElBQUksS0FBSyxDQUFDLGdDQUFnQyxDQUFDLENBQUM7U0FDckQ7UUFDRCxNQUFNLGFBQWEsR0FBRyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDekMsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFhLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEtBQUssYUFBYSxDQUFDLENBQUM7UUFDaEcsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFhLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEtBQUssYUFBYSxDQUFDLENBQUM7UUFDaEcsSUFBSSxDQUFDLFNBQVMsSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUMxQixPQUFPO2dCQUNILE1BQU0sRUFBRSxlQUFlLENBQUMsZUFBZTtnQkFDdkMsVUFBVSxFQUFFLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQzthQUN6QixDQUFDO1NBQzVCO1FBQ0QsSUFBSSxVQUFVLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUN6QixPQUFPO2dCQUNILE1BQU0sRUFBRSxTQUFTLElBQUksU0FBUztnQkFDOUIsVUFBVSxFQUFFLENBQUMsZUFBZSxDQUFDLGVBQWUsRUFBRSxTQUFTLElBQUksU0FBUyxDQUFDO2FBQ2pELENBQUM7U0FDNUI7YUFBTTtZQUNILE1BQU0sZ0JBQWdCLEdBQVEsY0FBYyxDQUN4QyxTQUFTLEVBQ1QsU0FBUyxJQUFJLFNBQVMsRUFDdEIsR0FBRyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQzFCLEtBQUssRUFDTCxJQUFJLENBQ1AsQ0FBQztZQUNGLElBQUksZ0JBQWdCLENBQUMsTUFBTSxFQUFFO2dCQUN6QixnQkFBZ0IsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQ2pFO1lBQ0QsT0FBTztnQkFDSCxNQUFNLEVBQUUsZ0JBQWdCLENBQUMsTUFBTTtnQkFDL0IsVUFBVSxFQUFFLGdCQUFnQixDQUFDLGNBQWM7YUFDOUMsQ0FBQztTQUNMO0lBQ0wsQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQVlELFNBQVMsaUJBQWlCLENBQUMsYUFBa0IsRUFBRSxRQUFnQjtJQUMzRCxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRTtRQUM1QixhQUFhLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztLQUNsQztJQUNELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxFQUFFO1FBQ3RDLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDO0tBQzVDO0lBQ0QsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFO1FBQ3pDLGFBQWEsQ0FBQyxXQUFXLENBQUMsWUFBWSxHQUFHLEVBQUUsQ0FBQztLQUMvQztBQUNMLENBQUM7QUFFRCxTQUFTLGtCQUFrQixDQUN2QixjQUFpQyxFQUNqQyxjQUE4QixFQUM5QixTQUE4QixFQUM5QixpQkFBMEI7SUFFMUIsTUFBTSxhQUFhLEdBQUcsY0FBYyxDQUFDLGFBQWEsQ0FBQztJQUNuRCxNQUFNLGlCQUFpQixHQUFHLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQztJQUMzRCxjQUFjLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQXlCLEVBQUUsRUFBRTs7UUFDN0QsY0FBYyxDQUFDLGFBQWEsR0FBSSxVQUFrQixDQUFDLFFBQVEsSUFBSyxjQUFzQixDQUFDLFFBQVEsQ0FBQztRQUNoRyxNQUFNLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxHQUFHLFNBQVMsQ0FBQyx5QkFBaUIsRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUUsaUJBQWlCLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBRTNDLE1BQU0sb0JBQW9CLEdBQUcsR0FBRyxPQUFPLEdBQUcsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ25HLElBQUksQ0FBQyxpQkFBaUIsSUFBSSwwQkFBYSxDQUFDLFdBQVcsMENBQUcsUUFBUSxDQUFDLDBDQUFHLG9CQUFvQixDQUFDLE1BQUssU0FBUyxFQUFFO1lBQ25HLE9BQU87U0FDVjtRQUNELGNBQWMsQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQztRQUM3QyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsaUJBQWlCLENBQ3pFLFVBQXdCLEVBQ3hCLFNBQVMsRUFDVCxjQUFjLENBQ2pCLENBQUM7UUFFRixRQUFRLE9BQU8sYUFBYSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFO1lBQ3RFLEtBQUssUUFBUTtnQkFDVCwyQ0FBMkM7Z0JBQzNDLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUMsR0FBRyxJQUFJLE1BQU0sQ0FDbEUsYUFBYSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUM1RCxDQUFDO2dCQUNGLE1BQU07WUFDVixLQUFLLFNBQVM7Z0JBQ1YsMkNBQTJDO2dCQUMzQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsSUFBSSxPQUFPLENBQ25FLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FDNUQsQ0FBQztnQkFDRixNQUFNO1lBQ1Y7Z0JBQ0ksYUFBYTtnQkFDYixNQUFNO1NBQ2I7UUFDRCxJQUNJLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUMsS0FBSyxJQUFJO1lBQ2xFLE9BQU8sYUFBYSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLFFBQVE7WUFDN0UsQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsV0FBVyxFQUN4RTtZQUNFLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1NBQzlFO1FBQ0QsSUFDSSxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEtBQUssSUFBSTtZQUNsRSxPQUFPLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUMsS0FBSyxRQUFRLEVBQy9FO1lBQ0UsYUFBYSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLElBQUksR0FBRyxtQkFBTyxFQUNwRSx5QkFBaUIsRUFDakIsR0FBRyxRQUFRLElBQUksT0FBTyxFQUFFLENBQzNCLENBQUM7WUFDRixhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUM7WUFDM0YsYUFBYSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLFFBQVEsR0FBRyxjQUFjLENBQUMsYUFBYSxDQUFDO1NBQ3JHO1FBQ0QsTUFBTSxnQkFBZ0IsR0FBRyxHQUFHLGlCQUFpQixJQUFJLG1CQUFPLEVBQ3BELHlCQUFpQixFQUNqQixRQUFRLEdBQUcsR0FBRyxHQUFHLG9CQUFvQixDQUN4QyxFQUFFLENBQUM7UUFDSixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ3ZDLE1BQU0saUJBQWlCLEdBQUc7Z0JBQ3RCLE1BQU0sRUFBRSxnQkFBZ0I7Z0JBQ3hCLFdBQVcsRUFBRSxVQUFVLENBQUMsV0FBVztnQkFDbkMsUUFBUSxFQUFFLGNBQWMsQ0FBQyxhQUFhO2FBQ3pDLENBQUM7WUFDRixjQUFjLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7U0FDaEU7YUFBTSxJQUFJLFVBQVUsQ0FBQyxXQUFXLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsV0FBVyxFQUFFO1lBQ3pHLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDLFdBQVcsQ0FBQztTQUNsRztRQUNELGFBQWEsQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLEdBQUcsUUFBUSxJQUFJLG9CQUFvQixFQUFFLENBQUM7WUFDekUsYUFBYSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsbUJBQU8sRUFBQyx5QkFBaUIsRUFBRSxHQUFHLFFBQVEsSUFBSSxvQkFBb0IsRUFBRSxDQUFFLENBQUM7Z0JBQ3RHLGFBQWEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUNsRSxTQUFTLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxhQUFhLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFDNUYsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFTLHdCQUF3QixDQUFDLGlCQUFnQyxFQUFFLFNBQThCO0lBQzlGLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFO1FBQ3JDLE1BQU0sZUFBZSxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUM7UUFDN0MsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUFDLE9BQU8sQ0FBQztRQUMxQyxNQUFNLGNBQWMsR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDNUMsTUFBTSxFQUFFLGVBQWUsRUFBRSxjQUFjLEVBQUUsR0FBRyxlQUFlLENBQUM7UUFDNUQsT0FBTyxlQUFlLENBQUMsY0FBYyxDQUFDO1FBQ3RDLE9BQU8sZUFBZSxDQUFDLGVBQWUsQ0FBQztRQUV2QyxJQUFJLFVBQVUsQ0FBQyxNQUFNLElBQUksQ0FBQyxDQUFDLGNBQWMsWUFBWSxNQUFNLENBQUMsRUFBRTtZQUMxRCw2QkFBNkI7WUFDN0IsSUFBSSxJQUFrQyxDQUFDO1lBQ3ZDLEtBQUssSUFBSSxJQUFJLGVBQWUsRUFBRTtnQkFDMUIsT0FBTyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDaEM7WUFFRCxNQUFNLENBQUMsTUFBTSxDQUFDLGVBQWUsRUFBRSxjQUFjLENBQUMsQ0FBQztTQUNsRDthQUFNO1lBQ0gsNkJBQTZCO1lBQzdCLGVBQWUsQ0FBQyxPQUFPLEdBQUcsY0FBYyxDQUFDO1NBQzVDO1FBRUQsSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNqQixlQUFlLENBQUMsWUFBWSxHQUFHLFNBQVMsQ0FBQztZQUN6QyxJQUFJLGVBQWUsSUFBSSxjQUFjLEVBQUU7Z0JBQ25DLE1BQU0sU0FBUyxHQUFHO29CQUNkLE9BQU8sRUFDSCx5Q0FBeUM7d0JBQ3pDLFNBQVM7d0JBQ1QsSUFBSTt3QkFDSixJQUFJO3dCQUNKLDBKQUEwSjt3QkFDMUoscUJBQXFCO3dCQUNyQixlQUFlO3dCQUNmLEdBQUc7d0JBQ0gsSUFBSTt3QkFDSixpQkFBaUI7d0JBQ2pCLGNBQWM7d0JBQ2QsR0FBRzt3QkFDSCxJQUFJO3dCQUNKLG9CQUFvQjt3QkFDcEIsU0FBUzt3QkFDVCxHQUFHO2lCQUNWLENBQUM7Z0JBQ0YseUJBQXlCLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO2FBQ25EO2lCQUFNO2dCQUNILE1BQU0sUUFBUSxHQUFHLGVBQWUsQ0FBQyxJQUFJLENBQUM7Z0JBQ3RDLE1BQU0sSUFBSSxHQUFHLGVBQWUsQ0FBQyxJQUFJLENBQUM7Z0JBQ2xDLE1BQU0sUUFBUSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO2dCQUNqRSxNQUFNLFNBQVMsR0FBRztvQkFDZCxPQUFPLEVBQ0gseUNBQXlDO3dCQUN6QyxTQUFTO3dCQUNULElBQUk7d0JBQ0osSUFBSTt3QkFDSiwwSkFBMEo7d0JBQzFKLHFCQUFxQjt3QkFDckIsUUFBUTt3QkFDUixHQUFHO3dCQUNILElBQUk7d0JBQ0osNEJBQTRCO3dCQUM1QixRQUFRO3dCQUNSLGdCQUFnQjt3QkFDaEIsSUFBSTt3QkFDSixHQUFHO2lCQUNWLENBQUM7Z0JBQ0YseUJBQXlCLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO2FBQ25EO1NBQ0o7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRDs7Ozs7R0FLRztBQUNILFNBQVMsZ0JBQWdCLENBQUMsV0FBd0I7SUFDOUMsTUFBTSx1QkFBdUIsR0FBbUMsRUFBRSxDQUFDO0lBQ25FLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxFQUFFO1FBQ3JFLFdBQVcsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBOEIsRUFBRSxFQUFFO1lBQ3hGLE1BQU0saUJBQWlCLEdBQUcsbUJBQU8sRUFBQyxXQUFXLENBQUMsVUFBVSxFQUFFLGNBQWMsQ0FBQyxNQUFNLENBQVcsQ0FBQztZQUMxRixjQUFzQixDQUFDLFFBQVEsR0FBRyxnQkFBZ0IsQ0FBQztZQUNwRCxJQUFJLENBQUMsdUJBQXVCLENBQUMsaUJBQWlCLENBQUMsRUFBRTtnQkFDN0MsdUJBQXVCLENBQUMsaUJBQWlCLENBQUMsR0FBRztvQkFDekMsV0FBVyxFQUFFLGNBQWMsQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFO29CQUNoRCxNQUFNLEVBQUUsaUJBQWlCO2lCQUM1QixDQUFDO2dCQUNELHVCQUF1QixDQUFDLGlCQUFpQixDQUFTLENBQUMsUUFBUSxHQUFHLGdCQUFnQixDQUFDO2FBQ25GO2lCQUFNO2dCQUNILGNBQWMsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxFQUFFLEVBQUU7b0JBQzlDLE1BQU0sU0FBUyxHQUFHLHVCQUF1QixDQUFDLGlCQUFpQixDQUFDLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FDOUUsQ0FBQyxtQkFBbUIsRUFBRSxFQUFFO3dCQUNwQixPQUFPLENBQ0gsbUJBQW1CLENBQUMsSUFBSSxLQUFLLFVBQVUsQ0FBQyxJQUFJOzRCQUM1QyxtQkFBbUIsQ0FBQyxTQUFTLEtBQUssVUFBVSxDQUFDLFNBQVMsQ0FDekQsQ0FBQztvQkFDTixDQUFDLENBQ0osQ0FBQztvQkFDRCxVQUFrQixDQUFDLFFBQVEsR0FBRyxnQkFBZ0IsQ0FBQztvQkFDaEQsSUFBSSxTQUFTLEtBQUssQ0FBQyxDQUFDLEVBQUU7d0JBQ2xCLHVCQUF1QixDQUFDLGlCQUFpQixDQUFDLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDO3FCQUMzRjt5QkFBTTt3QkFDSCx1QkFBdUIsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7cUJBQzNFO2dCQUNMLENBQUMsQ0FBQyxDQUFDO2FBQ047UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyx1QkFBdUIsQ0FBQztBQUNuQyxDQUFDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxTQUFnQixPQUFPLENBQUMsV0FBd0I7SUFDNUMsaUJBQWlCLEdBQUcsRUFBRSxDQUFDO0lBQ3ZCLE1BQU0sU0FBUyxHQUFHLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUM5QywyQkFBMkIsQ0FDdkIsV0FBVyxDQUFDLE1BQU0sQ0FBQyxXQUEyQixFQUM5QyxXQUFXLENBQUMsTUFBTSxDQUFDLFlBQVksRUFDL0IsU0FBUyxDQUNaLENBQUM7SUFDRCxXQUFXLENBQUMsTUFBTSxDQUFDLGVBQW1DLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztJQUN6RSx1QkFBdUIsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQW1CLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDekcsMEJBQTBCLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDeEUseUJBQXlCLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxVQUF5QixFQUFFLFNBQVMsRUFBRSxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDM0cseUJBQXlCLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxVQUF5QixFQUFFLFNBQVMsRUFBRSxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDM0csNEJBQTRCLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxXQUEyQixFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ3hGLG1CQUFtQixDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsWUFBNkIsRUFBRSxXQUFXLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNsSCxNQUFNLGlCQUFpQixHQUFrQixFQUFFLENBQUM7SUFDNUMsTUFBTSxxQkFBcUIsR0FBcUIsRUFBRSxDQUFDO0lBQ25ELE1BQU0sdUJBQXVCLEdBQW1DLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzlGLE1BQU0sQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxFQUFFO1FBQy9ELE1BQU0sY0FBYyxHQUFHLHVCQUF1QixDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDbEUsTUFBTSxnQkFBZ0IsR0FBRyxTQUFTLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUN0RCxJQUFJLENBQUMsZ0JBQWdCLElBQUksa0JBQWlCLGFBQWpCLGlCQUFpQix1QkFBakIsaUJBQWlCLENBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFHLENBQUMsRUFBRTtZQUMxRCxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7U0FDOUM7YUFBTSxJQUFJLGdCQUFnQixFQUFFO1lBQ3pCLElBQUksVUFBVSxHQUFHLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNwQyxJQUFJLGlCQUFpQixHQUFHLElBQUksQ0FBQztZQUM3QixJQUFJLGdCQUFnQixDQUFDLEtBQUssS0FBSyxzQkFBc0IsRUFBRTtnQkFDbkQsVUFBVSxHQUFHLGdCQUFnQixDQUFDLE9BQU8sQ0FBQztnQkFDdEMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDO2FBQzdCO1lBQ0QsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGFBQWEsRUFBRSxFQUFFO2dCQUNqQyxNQUFNLGNBQWMsR0FBc0I7b0JBQ3RDLHFCQUFxQixFQUFFLHFCQUFxQjtvQkFDNUMsYUFBYSxFQUFHLGNBQXNCLENBQUMsUUFBUTtvQkFDL0MsYUFBYSxFQUFFLGFBQWE7b0JBQzVCLFdBQVcsRUFBRSxFQUFFO29CQUNmLFdBQVcsRUFBRSxXQUFXO29CQUN4QixxQkFBcUIsRUFBRSxpQkFBaUI7aUJBQzNDLENBQUM7Z0JBQ0Ysa0JBQWtCLENBQUMsY0FBYyxFQUFFLGNBQWMsRUFBRSxTQUFTLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztZQUNyRixDQUFDLENBQUMsQ0FBQztTQUNOO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxNQUFNLDBCQUEwQixHQUFxQixFQUFFLENBQUM7SUFDeEQscUJBQXFCLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBYyxFQUFFLEVBQUU7UUFDN0MsTUFBTSxpQkFBaUIsR0FBRyxtQkFBTyxFQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsY0FBYyxDQUFDLE1BQU0sQ0FBVyxDQUFDO1FBQzNGLElBQUksQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDLEdBQUcsaUJBQWlCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzdELE1BQU0sV0FBVyxHQUFHLGNBQWMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUMsT0FBTyxHQUFHLE9BQU8sR0FBRyxHQUFHLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pDLE1BQU0sYUFBYSxHQUFHLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsVUFBVSxFQUFFLElBQUksRUFBRSxFQUFFO1lBQ25FLE9BQU8sVUFBVSxhQUFWLFVBQVUsdUJBQVYsVUFBVSxDQUFHLElBQUksQ0FBQyxDQUFDO1FBQzlCLENBQUMsRUFBRSxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUN2QixJQUFJLENBQUMsYUFBYSxJQUFJLE9BQU8sYUFBYSxLQUFLLFFBQVEsRUFBRTtZQUNyRCxpQkFBaUIsQ0FBQyxJQUFJLENBQUM7Z0JBQ25CLE9BQU8sRUFBRSwrREFBK0QsR0FBRyxpQkFBaUI7YUFDL0YsQ0FBQyxDQUFDO1NBQ047YUFBTTtZQUNILE1BQU0sY0FBYyxHQUFzQjtnQkFDdEMscUJBQXFCLEVBQUUsMEJBQTBCO2dCQUNqRCxhQUFhLEVBQUcsY0FBc0IsQ0FBQyxRQUFRO2dCQUMvQyxhQUFhLEVBQUUsYUFBYTtnQkFDNUIsV0FBVyxFQUFFLEVBQUU7Z0JBQ2YsV0FBVyxFQUFFLFdBQVc7Z0JBQ3hCLHFCQUFxQixFQUFFLGlCQUFpQjthQUMzQyxDQUFDO1lBQ0Ysa0JBQWtCLENBQUMsY0FBYyxFQUFFLGNBQWMsRUFBRSxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDeEU7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUNILHdCQUF3QixDQUFDLGlCQUFpQixFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ3ZELEtBQUssTUFBTSxRQUFRLElBQUkscUJBQXFCLEVBQUU7UUFDMUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDOUQ7SUFDQSxXQUFtQixDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQztJQUNoRSxNQUFNLGVBQWUsR0FBRyxXQUFXLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQW9CLEVBQUUsRUFBRTtRQUMzRSxPQUFPLHlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLFNBQVMsS0FBSyxTQUFTLENBQUMsU0FBUyxDQUFDLEtBQUssU0FBUyxDQUFDO0lBQzlHLENBQUMsQ0FBQyxDQUFDO0lBQ0gsTUFBTSxlQUFlLEdBQStCO1FBQ2hELE9BQU8sRUFBRSxXQUFXLENBQUMsT0FBTztRQUM1QixXQUFXLEVBQUUsV0FBVyxDQUFDLE1BQU0sQ0FBQyxXQUFXO1FBQzNDLFNBQVMsRUFBRSxXQUFXLENBQUMsTUFBTSxDQUFDLFNBQVM7UUFDdkMsZUFBZSxFQUFFLFdBQVcsQ0FBQyxNQUFNLENBQUMsZUFBa0M7UUFDdEUsT0FBTyxFQUFFLFdBQVcsQ0FBQyxNQUFNLENBQUMsT0FBbUI7UUFDL0MsYUFBYSxFQUFFLFdBQVcsQ0FBQyxNQUFNLENBQUMsYUFBYTtRQUMvQyxVQUFVLEVBQUUsV0FBVyxDQUFDLE1BQU0sQ0FBQyxVQUF5QjtRQUN4RCxVQUFVLEVBQUUsV0FBVyxDQUFDLE1BQU0sQ0FBQyxVQUF5QjtRQUN4RCxXQUFXLEVBQUUsV0FBVyxDQUFDLE1BQU0sQ0FBQyxXQUEyQjtRQUMzRCxZQUFZLEVBQUUsV0FBVyxDQUFDLE1BQU0sQ0FBQyxZQUE2QjtRQUM5RCxlQUFlLEVBQUUsV0FBVyxDQUFDLE1BQU0sQ0FBQyxlQUFtQztRQUN2RSxVQUFVLEVBQUUseUJBQWlCLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQztRQUNyRCxXQUFXLEVBQUUsaUJBQWlCLENBQUMsTUFBTSxFQUFFO0tBQzFDLENBQUM7SUFDRixlQUFlLENBQUMsV0FBVyxHQUFHLG1CQUFtQixDQUFDLGVBQW9DLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDbkcsT0FBTyxlQUFvQyxDQUFDO0FBQ2hELENBQUM7QUE5RkQsMEJBOEZDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqOUNELGdEQUE0QjtBQUM1QixnREFBNEI7QUFDNUIsZ0RBQXdCOzs7Ozs7Ozs7OztBQ0RYLHlCQUFpQixHQUFzQjtJQUNoRCxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsU0FBUyxFQUFFLDJCQUEyQixFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUU7SUFDMUUsRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUFFLFNBQVMsRUFBRSwwQkFBMEIsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFO0lBQ3hFLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUseUJBQXlCLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRTtJQUN0RSxFQUFFLFNBQVMsRUFBRSxtQkFBbUIsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUU7SUFDMUQsRUFBRSxTQUFTLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFO0lBQ2xFLEVBQUUsU0FBUyxFQUFFLGdDQUFnQyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRTtJQUN6RSxFQUFFLFNBQVMsRUFBRSw0QkFBNEIsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUU7SUFDakUsRUFBRSxTQUFTLEVBQUUsaUNBQWlDLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFO0lBQzNFLEVBQUUsU0FBUyxFQUFFLG1DQUFtQyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRTtJQUMvRSxFQUFFLFNBQVMsRUFBRSxrQ0FBa0MsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUU7SUFDN0UsRUFBRSxTQUFTLEVBQUUsc0NBQXNDLEVBQUUsS0FBSyxFQUFFLGNBQWMsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFO0lBQ3JGLEVBQUUsU0FBUyxFQUFFLHVDQUF1QyxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRTtJQUN2RixFQUFFLFNBQVMsRUFBRSwrQkFBK0IsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUU7Q0FDMUUsQ0FBQztBQU9GOzs7Ozs7R0FNRztBQUNILFNBQWdCLEtBQUssQ0FBQyxVQUE2QixFQUFFLGNBQXNCO0lBQ3ZFLElBQUksQ0FBQyxVQUFVLENBQUMsbUJBQW1CLEVBQUU7UUFDakMsVUFBVSxDQUFDLG1CQUFtQixHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUE4QixFQUFFLEdBQUcsRUFBRSxFQUFFO1lBQ3ZGLEdBQUcsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLEdBQUcsR0FBRyxDQUFDO1lBQ3pCLE9BQU8sR0FBRyxDQUFDO1FBQ2YsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0tBQ1Y7SUFDRCxJQUFJLENBQUMsY0FBYyxFQUFFO1FBQ2pCLE9BQU8sY0FBYyxDQUFDO0tBQ3pCO0lBQ0QsTUFBTSxZQUFZLEdBQUcsY0FBYyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNyRCxNQUFNLFNBQVMsR0FBRyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQztJQUM1RCxNQUFNLEtBQUssR0FBRyxjQUFjLENBQUMsU0FBUyxDQUFDLFlBQVksR0FBRyxDQUFDLENBQUMsQ0FBQztJQUN6RCxNQUFNLFNBQVMsR0FBRyxVQUFVLENBQUMsbUJBQW1CLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDNUQsSUFBSSxTQUFTLEVBQUU7UUFDWCxPQUFPLEdBQUcsU0FBUyxDQUFDLEtBQUssSUFBSSxLQUFLLEVBQUUsQ0FBQztLQUN4QztTQUFNLElBQUksY0FBYyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtRQUMzQyx3RUFBd0U7UUFDeEUsTUFBTSxDQUFDLFFBQVEsRUFBRSxHQUFHLFNBQVMsQ0FBQyxHQUFHLGNBQWMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDM0QsT0FBTyxHQUFHLFFBQVEsSUFBSSxLQUFLLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO0tBQ2xFO1NBQU07UUFDSCxPQUFPLGNBQWMsQ0FBQztLQUN6QjtBQUNMLENBQUM7QUF2QkQsc0JBdUJDO0FBRUQ7Ozs7OztHQU1HO0FBQ0gsU0FBZ0IsT0FBTyxDQUFDLFVBQTZCLEVBQUUsWUFBZ0M7SUFDbkYsSUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLEVBQUU7UUFDMUIsVUFBVSxDQUFDLFlBQVksR0FBRyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBOEIsRUFBRSxHQUFHLEVBQUUsRUFBRTtZQUNoRixHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQztZQUNyQixPQUFPLEdBQUcsQ0FBQztRQUNmLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztLQUNWO0lBQ0QsSUFBSSxDQUFDLFlBQVksRUFBRTtRQUNmLE9BQU8sWUFBWSxDQUFDO0tBQ3ZCO0lBQ0QsTUFBTSxDQUFDLFFBQVEsRUFBRSxHQUFHLEtBQUssQ0FBQyxHQUFHLFlBQVksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDckQsTUFBTSxTQUFTLEdBQUcsVUFBVSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNwRCxJQUFJLFNBQVMsRUFBRTtRQUNYLE9BQU8sR0FBRyxTQUFTLENBQUMsU0FBUyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztLQUN0RDtTQUFNLElBQUksWUFBWSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtRQUN6Qyx3RUFBd0U7UUFDeEUsTUFBTSxDQUFDLFFBQVEsRUFBRSxHQUFHLFNBQVMsQ0FBQyxHQUFHLFlBQVksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLFFBQVEsSUFBSSxPQUFPLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO0tBQ3BFO1NBQU07UUFDSCxPQUFPLFlBQVksQ0FBQztLQUN2QjtBQUNMLENBQUM7QUFyQkQsMEJBcUJDO0FBRUQsSUFBWSxXQWdQWDtBQWhQRCxXQUFZLFdBQVc7SUFDbkIsdUdBQTBGO0lBQzFGLHFHQUF3RjtJQUN4Riw2RUFBZ0U7SUFDaEUsaUVBQW9EO0lBQ3BELDJFQUE4RDtJQUM5RCwyRUFBOEQ7SUFDOUQsd0ZBQTJFO0lBQzNFLDhGQUFpRjtJQUNqRiw4R0FBaUc7SUFDakcsOEVBQWlFO0lBQ2pFLDZFQUFnRTtJQUNoRSwwRUFBNkQ7SUFDN0QsNkVBQWdFO0lBQ2hFLDJFQUE4RDtJQUM5RCxvRUFBdUQ7SUFDdkQsbUVBQXNEO0lBQ3RELCtFQUFrRTtJQUNsRSxnRUFBbUQ7SUFDbkQsc0VBQXlEO0lBQ3pELGdHQUFtRjtJQUNuRiwyRUFBOEQ7SUFDOUQsK0VBQWtFO0lBQ2xFLHFFQUF3RDtJQUN4RCwrRUFBa0U7SUFDbEUscUZBQXdFO0lBQ3hFLGtFQUFxRDtJQUNyRCwyRUFBOEQ7SUFDOUQsaUZBQW9FO0lBQ3BFLDhGQUFpRjtJQUNqRixtRUFBc0Q7SUFDdEQsb0ZBQXVFO0lBQ3ZFLDRHQUErRjtJQUMvRixnR0FBbUY7SUFDbkYsZ0dBQW1GO0lBQ25GLHdHQUEyRjtJQUMzRixxRkFBd0U7SUFDeEUscUdBQXdGO0lBQ3hGLHdHQUEyRjtJQUMzRiw4R0FBaUc7SUFDakcsd0hBQTJHO0lBQzNHLGlGQUFvRTtJQUNwRSwrRUFBa0U7SUFDbEUsZ0ZBQW1FO0lBQ25FLG1GQUFzRTtJQUN0RSxzR0FBeUY7SUFDekYsaUZBQW9FO0lBQ3BFLG9HQUF1RjtJQUN2RixnSEFBbUc7SUFDbkcsNEdBQStGO0lBQy9GLGdIQUFtRztJQUNuRyxnSEFBbUc7SUFDbkcsd0ZBQTJFO0lBQzNFLHdGQUEyRTtJQUMzRSxnSEFBbUc7SUFDbkcsOEdBQWlHO0lBQ2pHLGdIQUFtRztJQUNuRyw4R0FBaUc7SUFDakcsZ0hBQW1HO0lBQ25HLHdJQUEySDtJQUMzSCxzSEFBeUc7SUFDekcsbUdBQXNGO0lBQ3RGLDRIQUErRztJQUMvRyw0R0FBK0Y7SUFDL0Ysb0dBQXVGO0lBQ3ZGLHlHQUE0RjtJQUM1RiwrRkFBa0Y7SUFDbEYsc0dBQXlGO0lBQ3pGLDJFQUE4RDtJQUM5RCw4RUFBaUU7SUFDakUsc0ZBQXlFO0lBQ3pFLDZFQUFnRTtJQUNoRSw4R0FBaUc7SUFDakcsb0hBQXVHO0lBQ3ZHLG9FQUF1RDtJQUN2RCxvRUFBdUQ7SUFDdkQsMEVBQTZEO0lBQzdELDZGQUFnRjtJQUNoRixpRUFBb0Q7SUFDcEQsNEZBQStFO0lBQy9FLHNGQUF5RTtJQUN6RSx5R0FBNEY7SUFDNUYsb0dBQXVGO0lBQ3ZGLDJGQUE4RTtJQUM5RSw4RkFBaUY7SUFDakYsNkRBQWdEO0lBQ2hELDZEQUFnRDtJQUNoRCx1REFBMEM7SUFDMUMsMEdBQTZGO0lBQzdGLG9GQUF1RTtJQUN2RSxrRkFBcUU7SUFDckUsOEZBQWlGO0lBQ2pGLG9GQUF1RTtJQUN2RSx5RkFBNEU7SUFDNUUsa0lBQXFIO0lBQ3JILDBFQUE2RDtJQUM3RCxnRkFBbUU7SUFDbkUsMEVBQTZEO0lBQzdELDRGQUErRTtJQUMvRSwwR0FBNkY7SUFDN0YsdUZBQTBFO0lBQzFFLG1GQUFzRTtJQUN0RSxrRkFBcUU7SUFDckUsOEVBQWlFO0lBQ2pFLHFGQUF3RTtJQUN4RSx5RkFBNEU7SUFDNUUsK0VBQWtFO0lBQ2xFLHFFQUF3RDtJQUN4RCxxRUFBd0Q7SUFDeEQsOEZBQWlGO0lBQ2pGLDhGQUFpRjtJQUNqRiw4RUFBaUU7SUFDakUsb0ZBQXVFO0lBQ3ZFLGdJQUFtSDtJQUNuSCw0RkFBK0U7SUFDL0UsNklBQWdJO0lBQ2hJLDhHQUFpRztJQUNqRyw0R0FBK0Y7SUFDL0YsOEVBQWlFO0lBQ2pFLG9IQUF1RztJQUN2RywwRUFBNkQ7SUFDN0QsMkhBQThHO0lBQzlHLHlJQUE0SDtJQUM1SCw4RUFBaUU7SUFDakUsNkVBQWdFO0lBQ2hFLDhGQUFpRjtJQUNqRixzR0FBeUY7SUFDekYscUZBQXdFO0lBQ3hFLHdJQUEySDtJQUMzSCx1RkFBMEU7SUFDMUUsd0dBQTJGO0lBQzNGLDZIQUFnSDtJQUNoSCxnR0FBbUY7SUFDbkYsc0hBQXlHO0lBQ3pHLHNGQUF5RTtJQUN6RSwwRkFBNkU7SUFDN0UseUZBQTRFO0lBQzVFLHVGQUEwRTtJQUMxRSxzRkFBeUU7SUFDekUsNEZBQStFO0lBQy9FLDJGQUE4RTtJQUM5RSw4RkFBaUY7SUFDakYsNkZBQWdGO0lBQ2hGLDJGQUE4RTtJQUM5RSwwRkFBNkU7SUFDN0Usc0ZBQXlFO0lBQ3pFLG9GQUF1RTtJQUN2RSxzRkFBeUU7SUFDekUsMEZBQTZFO0lBQzdFLHVGQUEwRTtJQUMxRSwyRkFBOEU7SUFDOUUsb0ZBQXVFO0lBQ3ZFLHdGQUEyRTtJQUMzRSx5RkFBNEU7SUFDNUUsMkZBQThFO0lBQzlFLDZGQUFnRjtJQUNoRix3R0FBMkY7SUFDM0Ysd0dBQTJGO0lBQzNGLG9IQUF1RztJQUN2RyxtRkFBc0U7SUFDdEUsOEVBQWlFO0lBQ2pFLDRHQUErRjtJQUMvRixvSEFBdUc7SUFDdkcsc0ZBQXlFO0lBQ3pFLDBGQUE2RTtJQUM3RSx3R0FBMkY7SUFDM0YsMEhBQTZHO0lBQzdHLDhFQUFpRTtJQUNqRSxpR0FBb0Y7SUFDcEYsOEVBQWlFO0lBQ2pFLGlHQUFvRjtJQUNwRixvSEFBdUc7SUFDdkcsaUhBQW9HO0lBQ3BHLGtIQUFxRztJQUNyRyxpRkFBb0U7SUFDcEUsaUZBQW9FO0lBQ3BFLDhGQUFpRjtJQUNqRixrSEFBcUc7SUFDckcsa0hBQXFHO0lBQ3JHLDZGQUFnRjtJQUNoRiw0RkFBK0U7SUFDL0UsOEdBQWlHO0lBQ2pHLDRHQUErRjtJQUMvRixrSEFBcUc7SUFDckcsZ0lBQW1IO0lBQ25ILGdJQUFtSDtJQUNuSCw4SEFBaUg7SUFDakgsbUdBQXNGO0lBQ3RGLG9HQUF1RjtJQUN2RixvSUFBdUg7SUFDdkgsa0dBQXFGO0lBQ3JGLHlHQUE0RjtJQUM1Rix3RkFBMkU7SUFDM0UsbUdBQXNGO0lBQ3RGLHFHQUF3RjtJQUN4RixrR0FBcUY7SUFDckYsNEdBQStGO0lBQy9GLHFHQUF3RjtJQUN4RixvR0FBdUY7SUFDdkYseUVBQTREO0lBQzVELHdHQUEyRjtJQUMzRixnR0FBbUY7SUFDbkYsb0ZBQXVFO0lBQ3ZFLGtHQUFxRjtJQUNyRiw4R0FBaUc7SUFDakcsK0dBQWtHO0lBQ2xHLDhFQUFpRTtJQUNqRSxxRkFBd0U7SUFDeEUsMkZBQThFO0lBQzlFLDhGQUFpRjtJQUNqRixnR0FBbUY7SUFDbkYsb0dBQXVGO0lBQ3ZGLHNJQUF5SDtJQUN6SCxvSEFBdUc7SUFDdkcsOEdBQWlHO0lBQ2pHLG9GQUF1RTtJQUN2RSw2RUFBZ0U7SUFDaEUsaUZBQW9FO0lBQ3BFLHVFQUEwRDtJQUMxRCwyRUFBOEQ7SUFDOUQsOEVBQWlFO0lBQ2pFLDJFQUE4RDtJQUM5RCxpRkFBb0U7SUFDcEUsNEdBQStGO0lBQy9GLGtHQUFxRjtJQUNyRiwwRUFBNkQ7SUFDN0QsZ0ZBQW1FO0lBQ25FLGdGQUFtRTtJQUNuRSxnRkFBbUU7SUFDbkUsZ0ZBQW1FO0lBQ25FLDJHQUE4RjtJQUM5RixvR0FBdUY7SUFDdkYsMEhBQTZHO0lBQzdHLDhFQUFpRTtJQUNqRSxzRUFBeUQ7SUFDekQscUZBQXdFO0lBQ3hFLG9IQUF1RztJQUN2RyxrSEFBcUc7SUFDckcsZ0dBQW1GO0lBQ25GLDBHQUE2RjtBQUNqRyxDQUFDLEVBaFBXLFdBQVcsR0FBWCxtQkFBVyxLQUFYLG1CQUFXLFFBZ1B0QjtBQUVEOzs7O0dBSUc7QUFDSCxTQUFnQix1QkFBdUIsQ0FDbkMscUJBQW9EO0lBRXBELE9BQU8sQ0FDSCxDQUFDLENBQUMscUJBQXFCLElBQUkscUJBQXFCLENBQUMsS0FBSyxLQUFLLGFBQWEsSUFBSSxDQUFDLENBQUMscUJBQXFCLENBQUMsVUFBVSxDQUNqSCxDQUFDO0FBQ04sQ0FBQztBQU5ELDBEQU1DO0FBRUQsU0FBZ0IsT0FBTyxDQUFDLEtBQWE7SUFDakMsT0FBTztRQUNILFNBQVM7WUFDTCxPQUFPLElBQUksQ0FBQztRQUNoQixDQUFDO1FBQ0QsT0FBTztZQUNILE9BQU8sS0FBSyxDQUFDO1FBQ2pCLENBQUM7UUFDRCxRQUFRO1lBQ0osT0FBTyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDNUIsQ0FBQztLQUNKLENBQUM7QUFDTixDQUFDO0FBWkQsMEJBWUM7Ozs7Ozs7Ozs7O0FDcFZELHlDQUFrQztBQUVsQzs7Ozs7O0dBTUc7QUFDSCxTQUFTLHFCQUFxQixDQUFDLFVBQXVCLEVBQUUsS0FBVTs7SUFDOUQsSUFBSSxNQUE4QixDQUFDO0lBQ25DLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUN0QixNQUFNLEdBQUc7WUFDTCxJQUFJLEVBQUUsWUFBWTtZQUNsQixVQUFVLEVBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsNkJBQTZCLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFVO1NBQzVGLENBQUM7S0FDTDtTQUFNLElBQUksV0FBSyxDQUFDLFNBQVMscURBQUksRUFBRTtRQUM1QixNQUFNLEdBQUc7WUFDTCxJQUFJLEVBQUUsU0FBUztZQUNmLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFO1NBQzNCLENBQUM7S0FDTDtTQUFNLElBQUksV0FBSyxDQUFDLFFBQVEscURBQUksRUFBRTtRQUMzQixNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2hELElBQUksWUFBWSxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssS0FBSyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUNwRixNQUFNLEdBQUc7Z0JBQ0wsSUFBSSxFQUFFLFlBQVk7Z0JBQ2xCLFVBQVUsRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFO2FBQzlCLENBQUM7U0FDTDthQUFNO1lBQ0gsTUFBTSxHQUFHO2dCQUNMLElBQUksRUFBRSxRQUFRO2dCQUNkLE1BQU0sRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFO2FBQzFCLENBQUM7U0FDTDtLQUNKO1NBQU0sSUFBSSxXQUFLLENBQUMsS0FBSyxxREFBSSxFQUFFO1FBQ3hCLE1BQU0sR0FBRztZQUNMLElBQUksRUFBRSxLQUFLO1lBQ1gsR0FBRyxFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUU7U0FDdkIsQ0FBQztLQUNMO1NBQU0sSUFBSSxXQUFLLENBQUMsT0FBTyxxREFBSSxFQUFFO1FBQzFCLE1BQU0sR0FBRztZQUNMLElBQUksRUFBRSxPQUFPO1lBQ2IsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUU7U0FDekIsQ0FBQztLQUNMO1NBQU0sSUFBSSxXQUFLLENBQUMsTUFBTSxxREFBSSxFQUFFO1FBQ3pCLE1BQU0sR0FBRztZQUNMLElBQUksRUFBRSxNQUFNO1lBQ1osSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUU7U0FDeEIsQ0FBQztLQUNMO1NBQU0sSUFBSSxXQUFLLENBQUMsU0FBUyxxREFBSSxFQUFFO1FBQzVCLE1BQU0sR0FBRztZQUNMLElBQUksRUFBRSxNQUFNO1lBQ1osSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUUsS0FBSyxNQUFNO1NBQ25DLENBQUM7S0FDTDtTQUFNLElBQUksS0FBSyxDQUFDLElBQUksS0FBSyxNQUFNLEVBQUU7UUFDOUIsTUFBTSxHQUFHO1lBQ0wsSUFBSSxFQUFFLE1BQU07WUFDWixJQUFJLEVBQUUsS0FBSyxDQUFDLElBQUk7U0FDbkIsQ0FBQztLQUNMO1NBQU0sSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLGdCQUFnQixFQUFFO1FBQ3hDLE1BQU0sR0FBRztZQUNMLElBQUksRUFBRSxnQkFBZ0I7WUFDdEIsY0FBYyxFQUFFLEtBQUssQ0FBQyxLQUFLO1NBQzlCLENBQUM7S0FDTDtTQUFNLElBQUksS0FBSyxDQUFDLElBQUksS0FBSyxPQUFPLEVBQUU7UUFDL0IsTUFBTSxHQUFHO1lBQ0wsSUFBSSxFQUFFLE9BQU87WUFDYixLQUFLLEVBQUUsS0FBSyxDQUFDLEtBQUs7U0FDckIsQ0FBQztLQUNMO1NBQU0sSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLE1BQU0sRUFBRTtRQUM5QixNQUFNLEdBQUc7WUFDTCxJQUFJLEVBQUUsTUFBTTtTQUNmLENBQUM7S0FDTDtTQUFNLElBQUksS0FBSyxDQUFDLElBQUksS0FBSyxjQUFjLEVBQUU7UUFDdEMsTUFBTSxHQUFHO1lBQ0wsSUFBSSxFQUFFLGNBQWM7WUFDcEIsWUFBWSxFQUFFLEtBQUssQ0FBQyxLQUFLO1NBQzVCLENBQUM7S0FDTDtTQUFNLElBQUksS0FBSyxDQUFDLElBQUksS0FBSyx3QkFBd0IsRUFBRTtRQUNoRCxNQUFNLEdBQUc7WUFDTCxJQUFJLEVBQUUsd0JBQXdCO1lBQzlCLHNCQUFzQixFQUFFLEtBQUssQ0FBQyxLQUFLO1NBQ3RDLENBQUM7S0FDTDtTQUFNLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsRUFBRTtRQUM3RCxNQUFNLEdBQUc7WUFDTCxJQUFJLEVBQUUsUUFBUTtZQUNkLE1BQU0sRUFBRSw2QkFBNkIsQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFxQjtTQUMvRSxDQUFDO0tBQ0w7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0gsU0FBUyxvQkFBb0IsQ0FBQyxVQUF1QixFQUFFLEtBQVU7SUFDN0QsSUFBSSxNQUE4QixDQUFDO0lBQ25DLE1BQU0sZ0JBQWdCLEdBQUcsS0FBSyxhQUFMLEtBQUssdUJBQUwsS0FBSyxDQUFFLFdBQVcsQ0FBQyxJQUFJLENBQUM7SUFDakQsUUFBUSxnQkFBZ0IsRUFBRTtRQUN0QixLQUFLLFFBQVEsQ0FBQztRQUNkLEtBQUssUUFBUTtZQUNULE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDakQsSUFBSSxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxLQUFLLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFO2dCQUNwRixNQUFNLEdBQUc7b0JBQ0wsSUFBSSxFQUFFLFlBQVk7b0JBQ2xCLFVBQVUsRUFBRSxLQUFLLENBQUMsUUFBUSxFQUFFO2lCQUMvQixDQUFDO2FBQ0w7aUJBQU07Z0JBQ0gsTUFBTSxHQUFHO29CQUNMLElBQUksRUFBRSxRQUFRO29CQUNkLE1BQU0sRUFBRSxLQUFLLENBQUMsUUFBUSxFQUFFO2lCQUMzQixDQUFDO2FBQ0w7WUFDRCxNQUFNO1FBQ1YsS0FBSyxTQUFTLENBQUM7UUFDZixLQUFLLFNBQVM7WUFDVixNQUFNLEdBQUc7Z0JBQ0wsSUFBSSxFQUFFLE1BQU07Z0JBQ1osSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUU7YUFDeEIsQ0FBQztZQUNGLE1BQU07UUFFVixLQUFLLFFBQVEsQ0FBQztRQUNkLEtBQUssUUFBUTtZQUNULElBQUksS0FBSyxDQUFDLFFBQVEsRUFBRSxLQUFLLEtBQUssQ0FBQyxPQUFPLEVBQUUsRUFBRTtnQkFDdEMsTUFBTSxHQUFHO29CQUNMLElBQUksRUFBRSxLQUFLO29CQUNYLEdBQUcsRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFO2lCQUN2QixDQUFDO2FBQ0w7aUJBQU07Z0JBQ0gsTUFBTSxHQUFHO29CQUNMLElBQUksRUFBRSxTQUFTO29CQUNmLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFO2lCQUMzQixDQUFDO2FBQ0w7WUFDRCxNQUFNO1FBQ1YsS0FBSyxRQUFRLENBQUM7UUFDZDtZQUNJLE1BQU0sR0FBRyxxQkFBcUIsQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDbEQsTUFBTTtLQUNiO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQztBQUVELE1BQU0sY0FBYyxHQUFHLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLGNBQWMsRUFBRSxvQkFBb0IsRUFBRSxhQUFhLENBQUMsQ0FBQztBQUV2SDs7Ozs7O0dBTUc7QUFDSCxTQUFTLDBCQUEwQixDQUMvQixVQUF1QixFQUN2QixrQkFBdUIsRUFDdkIsaUJBQWtDO0lBRWxDLE1BQU0sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUM7U0FDMUIsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLEtBQUssY0FBYyxDQUFDO1NBQ3ZDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFO1FBQ2IsTUFBTSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1lBQ2xELE1BQU0sZ0JBQWdCLEdBQUcsdUJBQXVCLENBQUMsVUFBVSxFQUFFLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDNUYsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksRUFBRTtnQkFDeEIsTUFBTSxhQUFhLEdBQUcsbUJBQU8sRUFBQyxVQUFVLEVBQUUsR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQztnQkFDNUQsSUFBSSxhQUFhLEVBQUU7b0JBQ2YsTUFBTSxjQUFjLEdBQUcsYUFBYSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDaEQsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDMUMsSUFBSSxjQUFjLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTt3QkFDM0IsbUZBQW1GO3dCQUNuRixnQkFBZ0IsQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO3FCQUNsRDtpQkFDSjthQUNKO1lBQ0QsaUJBQWlCLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNYLENBQUM7QUFFRDs7Ozs7O0dBTUc7QUFDSCxTQUFTLDZCQUE2QixDQUNsQyxVQUF1QixFQUN2QixjQUFtQjtJQVNuQixJQUFJLE9BQU8sY0FBYyxLQUFLLFFBQVEsRUFBRTtRQUNwQyxPQUFPLGNBQWMsQ0FBQztLQUN6QjtTQUFNLElBQUksT0FBTyxjQUFjLEtBQUssUUFBUSxFQUFFO1FBQzNDLElBQUksY0FBYyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUN4QyxvQkFBb0I7WUFDcEIsTUFBTSxPQUFPLEdBQXFCO2dCQUM5QixJQUFJLEVBQUUsY0FBYyxDQUFDLEtBQUs7Z0JBQzFCLGNBQWMsRUFBRSxFQUFXO2FBQzlCLENBQUM7WUFDRiw4Q0FBOEM7WUFDOUMsTUFBTSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxhQUFhLEVBQUUsRUFBRTtnQkFDbEQsSUFBSSxjQUFjLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO29CQUM5QyxNQUFNLEtBQUssR0FBRyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUM7b0JBQzVDLE9BQU8sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDO3dCQUN4QixJQUFJLEVBQUUsYUFBYTt3QkFDbkIsS0FBSyxFQUFFLG9CQUFvQixDQUFDLFVBQVUsRUFBRSxLQUFLLENBQWU7cUJBQy9ELENBQUMsQ0FBQztpQkFDTjtxQkFBTSxJQUFJLGFBQWEsS0FBSyxhQUFhLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO29CQUNqRyxPQUFPLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztvQkFDekIsMEJBQTBCLENBQUMsVUFBVSxFQUFFLGNBQWMsQ0FBQyxhQUFhLENBQUMsRUFBRSxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7aUJBQzlGO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFDSCxPQUFPLE9BQU8sQ0FBQztTQUNsQjthQUFNLElBQUksY0FBYyxDQUFDLElBQUksS0FBSyxjQUFjLEVBQUU7WUFDL0MsT0FBTztnQkFDSCxJQUFJLEVBQUUsY0FBYztnQkFDcEIsWUFBWSxFQUFFLGNBQWMsQ0FBQyxLQUFLO2FBQ3JDLENBQUM7U0FDTDthQUFNLElBQUksY0FBYyxDQUFDLElBQUksS0FBSyxnQkFBZ0IsRUFBRTtZQUNqRCxPQUFPO2dCQUNILElBQUksRUFBRSxnQkFBZ0I7Z0JBQ3RCLGNBQWMsRUFBRSxjQUFjLENBQUMsS0FBSzthQUN2QyxDQUFDO1NBQ0w7YUFBTSxJQUFJLGNBQWMsQ0FBQyxJQUFJLEtBQUssd0JBQXdCLEVBQUU7WUFDekQsT0FBTztnQkFDSCxJQUFJLEVBQUUsd0JBQXdCO2dCQUM5QixzQkFBc0IsRUFBRSxjQUFjLENBQUMsS0FBSzthQUMvQyxDQUFDO1NBQ0w7S0FDSjtJQUNELE9BQU8sU0FBUyxDQUFDO0FBQ3JCLENBQUM7QUFFRDs7Ozs7O0dBTUc7QUFDSCxTQUFnQix1QkFBdUIsQ0FBQyxVQUF1QixFQUFFLFVBQStCO0lBQzVGLE1BQU0sY0FBYyxHQUFrQjtRQUNsQyxJQUFJLEVBQUUsVUFBVSxDQUFDLElBQUk7UUFDckIsU0FBUyxFQUFFLFVBQVUsQ0FBQyxTQUFTO0tBQ2xDLENBQUM7SUFDRixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUU7UUFDM0IsYUFBYTtRQUNiLElBQUksVUFBVSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFFLFVBQWtCLENBQUMsV0FBVyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUNyRywwRUFBMEU7WUFDMUUsY0FBYyxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7WUFDaEMsMEJBQTBCLENBQUMsVUFBVSxFQUFHLFVBQWtCLENBQUMsV0FBVyxFQUFFLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUN2RztRQUNELE9BQU87WUFDSCxHQUFHLGNBQWM7WUFDakIsVUFBVSxFQUFFLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLDZCQUE2QixDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBVTtTQUNqRyxDQUFDO0tBQ0w7U0FBTSxJQUFJLFVBQVUsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDM0MsT0FBTyxFQUFFLEdBQUcsY0FBYyxFQUFFLE1BQU0sRUFBRSw2QkFBNkIsQ0FBQyxVQUFVLEVBQUUsVUFBVSxDQUFRLEVBQUUsQ0FBQztLQUN0RztTQUFNO1FBQ0gsT0FBTyxFQUFFLEdBQUcsY0FBYyxFQUFFLEtBQUssRUFBRSxvQkFBb0IsQ0FBQyxVQUFVLEVBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQztLQUNyRjtBQUNMLENBQUM7QUFyQkQsMERBcUJDOzs7Ozs7O1VDM1JEO1VBQ0E7O1VBRUE7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7O1VBRUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7Ozs7VUV0QkE7VUFDQTtVQUNBO1VBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Bbm5vdGF0aW9uQ29udmVydGVyLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac2FwLXV4K2Fubm90YXRpb24tY29udmVydGVyQDAuNS4yMi9ub2RlX21vZHVsZXMvQHNhcC11eC9hbm5vdGF0aW9uLWNvbnZlcnRlci9zcmMvY29udmVydGVyLnRzIiwid2VicGFjazovL0Fubm90YXRpb25Db252ZXJ0ZXIvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzYXAtdXgrYW5ub3RhdGlvbi1jb252ZXJ0ZXJAMC41LjIyL25vZGVfbW9kdWxlcy9Ac2FwLXV4L2Fubm90YXRpb24tY29udmVydGVyL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly9Bbm5vdGF0aW9uQ29udmVydGVyLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac2FwLXV4K2Fubm90YXRpb24tY29udmVydGVyQDAuNS4yMi9ub2RlX21vZHVsZXMvQHNhcC11eC9hbm5vdGF0aW9uLWNvbnZlcnRlci9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vQW5ub3RhdGlvbkNvbnZlcnRlci8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQHNhcC11eCthbm5vdGF0aW9uLWNvbnZlcnRlckAwLjUuMjIvbm9kZV9tb2R1bGVzL0BzYXAtdXgvYW5ub3RhdGlvbi1jb252ZXJ0ZXIvc3JjL3dyaXRlYmFjay50cyIsIndlYnBhY2s6Ly9Bbm5vdGF0aW9uQ29udmVydGVyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0Fubm90YXRpb25Db252ZXJ0ZXIvd2VicGFjay9iZWZvcmUtc3RhcnR1cCIsIndlYnBhY2s6Ly9Bbm5vdGF0aW9uQ29udmVydGVyL3dlYnBhY2svc3RhcnR1cCIsIndlYnBhY2s6Ly9Bbm5vdGF0aW9uQ29udmVydGVyL3dlYnBhY2svYWZ0ZXItc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7XG4gICAgQW5ub3RhdGlvbkxpc3QsXG4gICAgQW5ub3RhdGlvblJlY29yZCxcbiAgICBFeHByZXNzaW9uLFxuICAgIFBhdGhFeHByZXNzaW9uLFxuICAgIFByb3BlcnR5VmFsdWUsXG4gICAgUmF3TWV0YWRhdGEsXG4gICAgUmVmZXJlbmNlLFxuICAgIENvbXBsZXhUeXBlLFxuICAgIFR5cGVEZWZpbml0aW9uLFxuICAgIFJhd1Byb3BlcnR5LFxuICAgIEFubm90YXRpb24sXG4gICAgQWN0aW9uLFxuICAgIEVudGl0eVR5cGUsXG4gICAgUmF3RW50aXR5VHlwZSxcbiAgICBSYXdBc3NvY2lhdGlvbixcbiAgICBOYXZpZ2F0aW9uUHJvcGVydHksXG4gICAgQmFzZU5hdmlnYXRpb25Qcm9wZXJ0eSxcbiAgICBSYXdWNE5hdmlnYXRpb25Qcm9wZXJ0eSxcbiAgICBSYXdWMk5hdmlnYXRpb25Qcm9wZXJ0eSxcbiAgICBFbnRpdHlTZXQsXG4gICAgUHJvcGVydHksXG4gICAgU2luZ2xldG9uLFxuICAgIFJhd0NvbXBsZXhUeXBlLFxuICAgIENvbnZlcnRlZE1ldGFkYXRhLFxuICAgIFJlc29sdXRpb25UYXJnZXQsXG4gICAgRW50aXR5Q29udGFpbmVyLFxuICAgIFJhd0Fubm90YXRpb24sXG4gICAgQWN0aW9uSW1wb3J0XG59IGZyb20gJ0BzYXAtdXgvdm9jYWJ1bGFyaWVzLXR5cGVzJztcbmltcG9ydCB0eXBlIHsgUmVmZXJlbmNlc1dpdGhNYXAgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IGFsaWFzLCBEZWNpbWFsLCBkZWZhdWx0UmVmZXJlbmNlcywgaXNDb21wbGV4VHlwZURlZmluaXRpb24sIFRlcm1Ub1R5cGVzLCB1bmFsaWFzIH0gZnJvbSAnLi91dGlscyc7XG5cbi8qKlxuICpcbiAqL1xuY2xhc3MgUGF0aCB7XG4gICAgcGF0aDogc3RyaW5nO1xuICAgICR0YXJnZXQ6IHN0cmluZztcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgYW5ub3RhdGlvbnNUZXJtOiBzdHJpbmc7XG4gICAgYW5ub3RhdGlvblR5cGU6IHN0cmluZztcbiAgICB0ZXJtOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gcGF0aEV4cHJlc3Npb25cbiAgICAgKiBAcGFyYW0gdGFyZ2V0TmFtZVxuICAgICAqIEBwYXJhbSBhbm5vdGF0aW9uc1Rlcm1cbiAgICAgKiBAcGFyYW0gdGVybVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHBhdGhFeHByZXNzaW9uOiBQYXRoRXhwcmVzc2lvbiwgdGFyZ2V0TmFtZTogc3RyaW5nLCBhbm5vdGF0aW9uc1Rlcm06IHN0cmluZywgdGVybTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGhFeHByZXNzaW9uLlBhdGg7XG4gICAgICAgIHRoaXMudHlwZSA9ICdQYXRoJztcbiAgICAgICAgdGhpcy4kdGFyZ2V0ID0gdGFyZ2V0TmFtZTtcbiAgICAgICAgdGhpcy50ZXJtID0gdGVybTtcbiAgICAgICAgdGhpcy5hbm5vdGF0aW9uc1Rlcm0gPSBhbm5vdGF0aW9uc1Rlcm07XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBNYXAgYmFzZWQgb24gdGhlIGZ1bGx5UXVhbGlmaWVkTmFtZSBvZiBlYWNoIG9iamVjdCBwYXJ0IG9mIHRoZSBtZXRhZGF0YS5cbiAqXG4gKiBAcGFyYW0gcmF3TWV0YWRhdGEgdGhlIHJhd01ldGFkYXRhIHdlJ3JlIHdvcmtpbmcgYWdhaW5zdFxuICogQHJldHVybnMgdGhlIG9iamVjdG1hcCBmb3IgZWFzeSBhY2Nlc3MgdG8gdGhlIGRpZmZlcmVudCBvYmplY3Qgb2YgdGhlIG1ldGFkYXRhXG4gKi9cbmZ1bmN0aW9uIGJ1aWxkT2JqZWN0TWFwKHJhd01ldGFkYXRhOiBSYXdNZXRhZGF0YSk6IFJlY29yZDxzdHJpbmcsIGFueT4ge1xuICAgIGNvbnN0IG9iamVjdE1hcDogYW55ID0ge307XG4gICAgaWYgKHJhd01ldGFkYXRhLnNjaGVtYS5lbnRpdHlDb250YWluZXI/LmZ1bGx5UXVhbGlmaWVkTmFtZSkge1xuICAgICAgICBvYmplY3RNYXBbcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eUNvbnRhaW5lci5mdWxseVF1YWxpZmllZE5hbWVdID0gcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eUNvbnRhaW5lcjtcbiAgICB9XG4gICAgZm9yIChjb25zdCBlbnRpdHlTZXQgb2YgcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eVNldHMpIHtcbiAgICAgICAgb2JqZWN0TWFwW2VudGl0eVNldC5mdWxseVF1YWxpZmllZE5hbWVdID0gZW50aXR5U2V0O1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IHNpbmdsZXRvbiBvZiByYXdNZXRhZGF0YS5zY2hlbWEuc2luZ2xldG9ucykge1xuICAgICAgICBvYmplY3RNYXBbc2luZ2xldG9uLmZ1bGx5UXVhbGlmaWVkTmFtZV0gPSBzaW5nbGV0b247XG4gICAgfVxuICAgIGZvciAoY29uc3QgYWN0aW9uIG9mIHJhd01ldGFkYXRhLnNjaGVtYS5hY3Rpb25zKSB7XG4gICAgICAgIG9iamVjdE1hcFthY3Rpb24uZnVsbHlRdWFsaWZpZWROYW1lXSA9IGFjdGlvbjtcbiAgICAgICAgaWYgKGFjdGlvbi5pc0JvdW5kKSB7XG4gICAgICAgICAgICBjb25zdCB1bkJvdW5kQWN0aW9uTmFtZSA9IGFjdGlvbi5mdWxseVF1YWxpZmllZE5hbWUuc3BsaXQoJygnKVswXTtcbiAgICAgICAgICAgIGlmICghb2JqZWN0TWFwW3VuQm91bmRBY3Rpb25OYW1lXSkge1xuICAgICAgICAgICAgICAgIG9iamVjdE1hcFt1bkJvdW5kQWN0aW9uTmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgIF90eXBlOiAnVW5ib3VuZEdlbmVyaWNBY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiBbXVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvYmplY3RNYXBbdW5Cb3VuZEFjdGlvbk5hbWVdLmFjdGlvbnMucHVzaChhY3Rpb24pO1xuICAgICAgICAgICAgY29uc3QgYWN0aW9uU3BsaXQgPSBhY3Rpb24uZnVsbHlRdWFsaWZpZWROYW1lLnNwbGl0KCcoJyk7XG4gICAgICAgICAgICBvYmplY3RNYXBbYCR7YWN0aW9uU3BsaXRbMV0uc3BsaXQoJyknKVswXX0vJHthY3Rpb25TcGxpdFswXX1gXSA9IGFjdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgcGFyYW1ldGVyIG9mIGFjdGlvbi5wYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICBvYmplY3RNYXBbcGFyYW1ldGVyLmZ1bGx5UXVhbGlmaWVkTmFtZV0gPSBwYXJhbWV0ZXI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9yIChjb25zdCBhY3Rpb25JbXBvcnQgb2YgcmF3TWV0YWRhdGEuc2NoZW1hLmFjdGlvbkltcG9ydHMpIHtcbiAgICAgICAgb2JqZWN0TWFwW2FjdGlvbkltcG9ydC5mdWxseVF1YWxpZmllZE5hbWVdID0gYWN0aW9uSW1wb3J0O1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGNvbXBsZXhUeXBlIG9mIHJhd01ldGFkYXRhLnNjaGVtYS5jb21wbGV4VHlwZXMpIHtcbiAgICAgICAgb2JqZWN0TWFwW2NvbXBsZXhUeXBlLmZ1bGx5UXVhbGlmaWVkTmFtZV0gPSBjb21wbGV4VHlwZTtcbiAgICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBvZiBjb21wbGV4VHlwZS5wcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBvYmplY3RNYXBbcHJvcGVydHkuZnVsbHlRdWFsaWZpZWROYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3QgdHlwZURlZmluaXRpb24gb2YgcmF3TWV0YWRhdGEuc2NoZW1hLnR5cGVEZWZpbml0aW9ucykge1xuICAgICAgICBvYmplY3RNYXBbdHlwZURlZmluaXRpb24uZnVsbHlRdWFsaWZpZWROYW1lXSA9IHR5cGVEZWZpbml0aW9uO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGVudGl0eVR5cGUgb2YgcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eVR5cGVzKSB7XG4gICAgICAgIChlbnRpdHlUeXBlIGFzIEVudGl0eVR5cGUpLmFubm90YXRpb25zID0ge307IC8vICdhbm5vdGF0aW9ucycgcHJvcGVydHkgaXMgbWFuZGF0b3J5XG4gICAgICAgIG9iamVjdE1hcFtlbnRpdHlUeXBlLmZ1bGx5UXVhbGlmaWVkTmFtZV0gPSBlbnRpdHlUeXBlO1xuICAgICAgICBvYmplY3RNYXBbYENvbGxlY3Rpb24oJHtlbnRpdHlUeXBlLmZ1bGx5UXVhbGlmaWVkTmFtZX0pYF0gPSBlbnRpdHlUeXBlO1xuICAgICAgICBmb3IgKGNvbnN0IHByb3BlcnR5IG9mIGVudGl0eVR5cGUuZW50aXR5UHJvcGVydGllcykge1xuICAgICAgICAgICAgb2JqZWN0TWFwW3Byb3BlcnR5LmZ1bGx5UXVhbGlmaWVkTmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBjb21wbGV4IHR5cGVzXG4gICAgICAgICAgICBjb25zdCBjb21wbGV4VHlwZURlZmluaXRpb24gPSBvYmplY3RNYXBbcHJvcGVydHkudHlwZV0gYXMgQ29tcGxleFR5cGUgfCBUeXBlRGVmaW5pdGlvbjtcbiAgICAgICAgICAgIGlmIChpc0NvbXBsZXhUeXBlRGVmaW5pdGlvbihjb21wbGV4VHlwZURlZmluaXRpb24pKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb21wbGV4VHlwZVByb3Agb2YgY29tcGxleFR5cGVEZWZpbml0aW9uLnByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29tcGxleFR5cGVQcm9wVGFyZ2V0OiBSYXdQcm9wZXJ0eSA9IE9iamVjdC5hc3NpZ24oY29tcGxleFR5cGVQcm9wLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdHlwZTogJ1Byb3BlcnR5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGx5UXVhbGlmaWVkTmFtZTogcHJvcGVydHkuZnVsbHlRdWFsaWZpZWROYW1lICsgJy8nICsgY29tcGxleFR5cGVQcm9wLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIG9iamVjdE1hcFtjb21wbGV4VHlwZVByb3BUYXJnZXQuZnVsbHlRdWFsaWZpZWROYW1lXSA9IGNvbXBsZXhUeXBlUHJvcFRhcmdldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBuYXZQcm9wZXJ0eSBvZiBlbnRpdHlUeXBlLm5hdmlnYXRpb25Qcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBvYmplY3RNYXBbbmF2UHJvcGVydHkuZnVsbHlRdWFsaWZpZWROYW1lXSA9IG5hdlByb3BlcnR5O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBhbm5vdGF0aW9uU291cmNlIG9mIE9iamVjdC5rZXlzKHJhd01ldGFkYXRhLnNjaGVtYS5hbm5vdGF0aW9ucykpIHtcbiAgICAgICAgZm9yIChjb25zdCBhbm5vdGF0aW9uTGlzdCBvZiByYXdNZXRhZGF0YS5zY2hlbWEuYW5ub3RhdGlvbnNbYW5ub3RhdGlvblNvdXJjZV0pIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRUYXJnZXROYW1lID0gdW5hbGlhcyhyYXdNZXRhZGF0YS5yZWZlcmVuY2VzLCBhbm5vdGF0aW9uTGlzdC50YXJnZXQpO1xuICAgICAgICAgICAgYW5ub3RhdGlvbkxpc3QuYW5ub3RhdGlvbnMuZm9yRWFjaCgoYW5ub3RhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBhbm5vdGF0aW9uRlFOID0gYCR7Y3VycmVudFRhcmdldE5hbWV9QCR7dW5hbGlhcyhyYXdNZXRhZGF0YS5yZWZlcmVuY2VzLCBhbm5vdGF0aW9uLnRlcm0pfWA7XG4gICAgICAgICAgICAgICAgaWYgKGFubm90YXRpb24ucXVhbGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGFubm90YXRpb25GUU4gKz0gYCMke2Fubm90YXRpb24ucXVhbGlmaWVyfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9iamVjdE1hcFthbm5vdGF0aW9uRlFOXSA9IGFubm90YXRpb247XG4gICAgICAgICAgICAgICAgKGFubm90YXRpb24gYXMgQW5ub3RhdGlvbikuZnVsbHlRdWFsaWZpZWROYW1lID0gYW5ub3RhdGlvbkZRTjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmplY3RNYXA7XG59XG5cbi8qKlxuICogQ29tYmluZSB0d28gc3RyaW5ncyByZXByZXNlbnRpbmcgcGF0aCBpbiB0aGUgbWV0YW1vZGVsIHdoaWxlIGVuc3VyaW5nIHRoZWlyIHNwZWNpZmljaXRpZXMgKGFubm90YXRpb24uLi4pIGFyZSByZXNwZWN0ZWQuXG4gKlxuICogQHBhcmFtIGN1cnJlbnRUYXJnZXQgdGhlIGN1cnJlbnQgcGF0aFxuICogQHBhcmFtIHBhdGggdGhlIHBhcnQgd2Ugd2FudCB0byBhcHBlbmRcbiAqIEByZXR1cm5zIHRoZSBjb21wbGV0ZSBwYXRoIGluY2x1ZGluZyB0aGUgZXh0ZW5zaW9uLlxuICovXG5mdW5jdGlvbiBjb21iaW5lUGF0aChjdXJyZW50VGFyZ2V0OiBzdHJpbmcsIHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHBhdGguc3RhcnRzV2l0aCgnQCcpKSB7XG4gICAgICAgIHJldHVybiBjdXJyZW50VGFyZ2V0ICsgdW5hbGlhcyhkZWZhdWx0UmVmZXJlbmNlcywgcGF0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRUYXJnZXQgKyAnLycgKyBwYXRoO1xuICAgIH1cbn1cblxuY29uc3QgQUxMX0FOTk9UQVRJT05fRVJST1JTOiBhbnkgPSB7fTtcbmxldCBBTk5PVEFUSU9OX0VSUk9SUzogeyBtZXNzYWdlOiBzdHJpbmcgfVtdID0gW107XG5cbi8qKlxuICogQHBhcmFtIHBhdGhcbiAqIEBwYXJhbSBvRXJyb3JNc2dcbiAqL1xuZnVuY3Rpb24gYWRkQW5ub3RhdGlvbkVycm9yTWVzc2FnZShwYXRoOiBzdHJpbmcsIG9FcnJvck1zZzogYW55KSB7XG4gICAgaWYgKCFBTExfQU5OT1RBVElPTl9FUlJPUlNbcGF0aF0pIHtcbiAgICAgICAgQUxMX0FOTk9UQVRJT05fRVJST1JTW3BhdGhdID0gW29FcnJvck1zZ107XG4gICAgfSBlbHNlIHtcbiAgICAgICAgQUxMX0FOTk9UQVRJT05fRVJST1JTW3BhdGhdLnB1c2gob0Vycm9yTXNnKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVzb2x2ZXMgYSBzcGVjaWZpYyBwYXRoIGJhc2VkIG9uIHRoZSBvYmplY3RNYXAuXG4gKlxuICogQHBhcmFtIG9iamVjdE1hcFxuICogQHBhcmFtIGN1cnJlbnRUYXJnZXRcbiAqIEBwYXJhbSBwYXRoXG4gKiBAcGFyYW0gcGF0aE9ubHlcbiAqIEBwYXJhbSBpbmNsdWRlVmlzaXRlZE9iamVjdHNcbiAqIEBwYXJhbSBhbm5vdGF0aW9uc1Rlcm1cbiAqIEByZXR1cm5zIHRoZSByZXNvbHZlZCBvYmplY3RcbiAqL1xuZnVuY3Rpb24gX3Jlc29sdmVUYXJnZXQoXG4gICAgb2JqZWN0TWFwOiBhbnksXG4gICAgY3VycmVudFRhcmdldDogYW55LFxuICAgIHBhdGg6IHN0cmluZyxcbiAgICBwYXRoT25seTogYm9vbGVhbiA9IGZhbHNlLFxuICAgIGluY2x1ZGVWaXNpdGVkT2JqZWN0czogYm9vbGVhbiA9IGZhbHNlLFxuICAgIGFubm90YXRpb25zVGVybT86IHN0cmluZ1xuKSB7XG4gICAgbGV0IG9FcnJvck1zZztcbiAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgY29uc3QgYVZpc2l0ZWRPYmplY3RzOiBhbnlbXSA9IFtdO1xuICAgIGlmIChjdXJyZW50VGFyZ2V0ICYmIGN1cnJlbnRUYXJnZXQuX3R5cGUgPT09ICdQcm9wZXJ0eScpIHtcbiAgICAgICAgY3VycmVudFRhcmdldCA9IG9iamVjdE1hcFtjdXJyZW50VGFyZ2V0LmZ1bGx5UXVhbGlmaWVkTmFtZS5zcGxpdCgnLycpWzBdXTtcbiAgICB9XG4gICAgcGF0aCA9IGNvbWJpbmVQYXRoKGN1cnJlbnRUYXJnZXQuZnVsbHlRdWFsaWZpZWROYW1lLCBwYXRoKTtcblxuICAgIGNvbnN0IHBhdGhTcGxpdCA9IHBhdGguc3BsaXQoJy8nKTtcbiAgICBjb25zdCB0YXJnZXRQYXRoU3BsaXQ6IHN0cmluZ1tdID0gW107XG4gICAgcGF0aFNwbGl0LmZvckVhY2goKHBhdGhQYXJ0KSA9PiB7XG4gICAgICAgIC8vIFNlcGFyYXRlIG91dCB0aGUgYW5ub3RhdGlvblxuICAgICAgICBpZiAocGF0aFBhcnQuaW5kZXhPZignQCcpICE9PSAtMSkge1xuICAgICAgICAgICAgY29uc3QgW3NwbGl0dGVkUGF0aCwgYW5ub3RhdGlvblBhdGhdID0gcGF0aFBhcnQuc3BsaXQoJ0AnKTtcbiAgICAgICAgICAgIHRhcmdldFBhdGhTcGxpdC5wdXNoKHNwbGl0dGVkUGF0aCk7XG4gICAgICAgICAgICB0YXJnZXRQYXRoU3BsaXQucHVzaChgQCR7YW5ub3RhdGlvblBhdGh9YCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXRQYXRoU3BsaXQucHVzaChwYXRoUGFydCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBsZXQgY3VycmVudFBhdGggPSBwYXRoO1xuICAgIGxldCBjdXJyZW50Q29udGV4dCA9IGN1cnJlbnRUYXJnZXQ7XG4gICAgY29uc3QgdGFyZ2V0ID0gdGFyZ2V0UGF0aFNwbGl0LnJlZHVjZSgoY3VycmVudFZhbHVlOiBhbnksIHBhdGhQYXJ0KSA9PiB7XG4gICAgICAgIGlmIChwYXRoUGFydCA9PT0gJyRUeXBlJyAmJiBjdXJyZW50VmFsdWUuX3R5cGUgPT09ICdFbnRpdHlUeXBlJykge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGF0aFBhcnQgPT09ICckJyAmJiBjdXJyZW50VmFsdWUuX3R5cGUgPT09ICdFbnRpdHlTZXQnKSB7XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICgocGF0aFBhcnQgPT09ICdAJHVpNS5vdmVybG9hZCcgfHwgcGF0aFBhcnQgPT09ICcwJykgJiYgY3VycmVudFZhbHVlLl90eXBlID09PSAnQWN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGF0aFBhcnQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBFbXB0eSBQYXRoIGFmdGVyIGFuIGVudGl0eVNldCBtZWFucyBlbnRpdHlUeXBlXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlICYmXG4gICAgICAgICAgICAgICAgKGN1cnJlbnRWYWx1ZS5fdHlwZSA9PT0gJ0VudGl0eVNldCcgfHwgY3VycmVudFZhbHVlLl90eXBlID09PSAnU2luZ2xldG9uJykgJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWUuZW50aXR5VHlwZVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgaWYgKGluY2x1ZGVWaXNpdGVkT2JqZWN0cykge1xuICAgICAgICAgICAgICAgICAgICBhVmlzaXRlZE9iamVjdHMucHVzaChjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWUgPSBjdXJyZW50VmFsdWUuZW50aXR5VHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgJiYgY3VycmVudFZhbHVlLl90eXBlID09PSAnTmF2aWdhdGlvblByb3BlcnR5JyAmJiBjdXJyZW50VmFsdWUudGFyZ2V0VHlwZSkge1xuICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlVmlzaXRlZE9iamVjdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgYVZpc2l0ZWRPYmplY3RzLnB1c2goY3VycmVudFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlID0gY3VycmVudFZhbHVlLnRhcmdldFR5cGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbmNsdWRlVmlzaXRlZE9iamVjdHMgJiYgY3VycmVudFZhbHVlICE9PSBudWxsICYmIGN1cnJlbnRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBhVmlzaXRlZE9iamVjdHMucHVzaChjdXJyZW50VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICBjdXJyZW50UGF0aCA9IHBhdGhQYXJ0O1xuICAgICAgICB9IGVsc2UgaWYgKChjdXJyZW50VmFsdWUuX3R5cGUgPT09ICdFbnRpdHlTZXQnIHx8IGN1cnJlbnRWYWx1ZS5fdHlwZSA9PT0gJ1NpbmdsZXRvbicpICYmIHBhdGhQYXJ0ID09PSAnJFR5cGUnKSB7XG4gICAgICAgICAgICBjdXJyZW50VmFsdWUgPSBjdXJyZW50VmFsdWUudGFyZ2V0VHlwZTtcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50VmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAoY3VycmVudFZhbHVlLl90eXBlID09PSAnRW50aXR5U2V0JyB8fCBjdXJyZW50VmFsdWUuX3R5cGUgPT09ICdTaW5nbGV0b24nKSAmJlxuICAgICAgICAgICAgcGF0aFBhcnQgPT09ICckTmF2aWdhdGlvblByb3BlcnR5QmluZGluZydcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjdXJyZW50VmFsdWUgPSBjdXJyZW50VmFsdWUubmF2aWdhdGlvblByb3BlcnR5QmluZGluZztcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50VmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAoY3VycmVudFZhbHVlLl90eXBlID09PSAnRW50aXR5U2V0JyB8fCBjdXJyZW50VmFsdWUuX3R5cGUgPT09ICdTaW5nbGV0b24nKSAmJlxuICAgICAgICAgICAgY3VycmVudFZhbHVlLmVudGl0eVR5cGVcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjdXJyZW50UGF0aCA9IGNvbWJpbmVQYXRoKGN1cnJlbnRWYWx1ZS5lbnRpdHlUeXBlTmFtZSwgcGF0aFBhcnQpO1xuICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRWYWx1ZS5fdHlwZSA9PT0gJ05hdmlnYXRpb25Qcm9wZXJ0eScpIHtcbiAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gY29tYmluZVBhdGgoY3VycmVudFZhbHVlLmZ1bGx5UXVhbGlmaWVkTmFtZSwgcGF0aFBhcnQpO1xuICAgICAgICAgICAgaWYgKCFvYmplY3RNYXBbY3VycmVudFBhdGhdKSB7XG4gICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgbG9nIGVycm9yXG4gICAgICAgICAgICAgICAgY3VycmVudFBhdGggPSBjb21iaW5lUGF0aChjdXJyZW50VmFsdWUudGFyZ2V0VHlwZU5hbWUsIHBhdGhQYXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50VmFsdWUuX3R5cGUgPT09ICdQcm9wZXJ0eScpIHtcbiAgICAgICAgICAgIC8vIENvbXBsZXhUeXBlIG9yIFByb3BlcnR5XG4gICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlLnRhcmdldFR5cGUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IGNvbWJpbmVQYXRoKGN1cnJlbnRWYWx1ZS50YXJnZXRUeXBlLmZ1bGx5UXVhbGlmaWVkTmFtZSwgcGF0aFBhcnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IGNvbWJpbmVQYXRoKGN1cnJlbnRWYWx1ZS5mdWxseVF1YWxpZmllZE5hbWUsIHBhdGhQYXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50VmFsdWUuX3R5cGUgPT09ICdBY3Rpb24nICYmIGN1cnJlbnRWYWx1ZS5pc0JvdW5kKSB7XG4gICAgICAgICAgICBjdXJyZW50UGF0aCA9IGNvbWJpbmVQYXRoKGN1cnJlbnRWYWx1ZS5mdWxseVF1YWxpZmllZE5hbWUsIHBhdGhQYXJ0KTtcbiAgICAgICAgICAgIGlmIChwYXRoUGFydCA9PT0gJyRQYXJhbWV0ZXInKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRWYWx1ZS5wYXJhbWV0ZXJzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIW9iamVjdE1hcFtjdXJyZW50UGF0aF0pIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IGNvbWJpbmVQYXRoKGN1cnJlbnRWYWx1ZS5zb3VyY2VUeXBlLCBwYXRoUGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFZhbHVlLl90eXBlID09PSAnQWN0aW9uUGFyYW1ldGVyJykge1xuICAgICAgICAgICAgY3VycmVudFBhdGggPSBjb21iaW5lUGF0aChcbiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0LmZ1bGx5UXVhbGlmaWVkTmFtZS5zdWJzdHJpbmcoMCwgY3VycmVudFRhcmdldC5mdWxseVF1YWxpZmllZE5hbWUubGFzdEluZGV4T2YoJy8nKSksXG4gICAgICAgICAgICAgICAgcGF0aFBhcnRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoIW9iamVjdE1hcFtjdXJyZW50UGF0aF0pIHtcbiAgICAgICAgICAgICAgICBsZXQgbGFzdElkeCA9IGN1cnJlbnRUYXJnZXQuZnVsbHlRdWFsaWZpZWROYW1lLmxhc3RJbmRleE9mKCcvJyk7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3RJZHggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RJZHggPSBjdXJyZW50VGFyZ2V0LmZ1bGx5UXVhbGlmaWVkTmFtZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gY29tYmluZVBhdGgoXG4gICAgICAgICAgICAgICAgICAgIChvYmplY3RNYXBbY3VycmVudFRhcmdldC5mdWxseVF1YWxpZmllZE5hbWUuc3Vic3RyaW5nKDAsIGxhc3RJZHgpXSBhcyBBY3Rpb24pLnNvdXJjZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHBhdGhQYXJ0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gY29tYmluZVBhdGgoY3VycmVudFZhbHVlLmZ1bGx5UXVhbGlmaWVkTmFtZSwgcGF0aFBhcnQpO1xuICAgICAgICAgICAgaWYgKHBhdGhQYXJ0ICE9PSAnbmFtZScgJiYgY3VycmVudFZhbHVlW3BhdGhQYXJ0XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRWYWx1ZVtwYXRoUGFydF07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhQYXJ0ID09PSAnJEFubm90YXRpb25QYXRoJyAmJiBjdXJyZW50VmFsdWUuJHRhcmdldCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRleHRUb1Jlc29sdmUgPSBvYmplY3RNYXBbY3VycmVudFZhbHVlLmZ1bGx5UXVhbGlmaWVkTmFtZS5zcGxpdCgnQCcpWzBdXTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWJUYXJnZXQ6IGFueSA9IF9yZXNvbHZlVGFyZ2V0KG9iamVjdE1hcCwgY29udGV4dFRvUmVzb2x2ZSwgY3VycmVudFZhbHVlLnZhbHVlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgc3ViVGFyZ2V0LnZpc2l0ZWRPYmplY3RzLmZvckVhY2goKHZpc2l0ZWRTdWJPYmplY3Q6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYVZpc2l0ZWRPYmplY3RzLmluZGV4T2YodmlzaXRlZFN1Yk9iamVjdCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhVmlzaXRlZE9iamVjdHMucHVzaCh2aXNpdGVkU3ViT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBzdWJUYXJnZXQudGFyZ2V0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRoUGFydCA9PT0gJyRQYXRoJyAmJiBjdXJyZW50VmFsdWUuJHRhcmdldCkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0ID0gYVZpc2l0ZWRPYmplY3RzXG4gICAgICAgICAgICAgICAgICAgIC5jb25jYXQoKVxuICAgICAgICAgICAgICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgKG9iaikgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouX3R5cGUgPT09ICdFbnRpdHlUeXBlJyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5fdHlwZSA9PT0gJ0VudGl0eVNldCcgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouX3R5cGUgPT09ICdTaW5nbGV0b24nIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLl90eXBlID09PSAnTmF2aWdhdGlvblByb3BlcnR5J1xuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJUYXJnZXQ6IGFueSA9IF9yZXNvbHZlVGFyZ2V0KG9iamVjdE1hcCwgY3VycmVudENvbnRleHQsIGN1cnJlbnRWYWx1ZS5wYXRoLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHN1YlRhcmdldC52aXNpdGVkT2JqZWN0cy5mb3JFYWNoKCh2aXNpdGVkU3ViT2JqZWN0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVmlzaXRlZE9iamVjdHMuaW5kZXhPZih2aXNpdGVkU3ViT2JqZWN0KSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVmlzaXRlZE9iamVjdHMucHVzaCh2aXNpdGVkU3ViT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJUYXJnZXQudGFyZ2V0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudFZhbHVlLiR0YXJnZXQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhQYXJ0LnN0YXJ0c1dpdGgoJyRQYXRoJykgJiYgY3VycmVudFZhbHVlLiR0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnRlcm1lZGlhdGVUYXJnZXQgPSBjdXJyZW50VmFsdWUuJHRhcmdldDtcbiAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IGNvbWJpbmVQYXRoKGludGVybWVkaWF0ZVRhcmdldC5mdWxseVF1YWxpZmllZE5hbWUsIHBhdGhQYXJ0LnN1YnN0cmluZyg1KSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRWYWx1ZS5oYXNPd25Qcm9wZXJ0eSgnJFR5cGUnKSAmJiAhb2JqZWN0TWFwW2N1cnJlbnRQYXRoXSkge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgbm93IGFuIGFubm90YXRpb24gdmFsdWVcbiAgICAgICAgICAgICAgICBjb25zdCBlbnRpdHlUeXBlID0gb2JqZWN0TWFwW2N1cnJlbnRWYWx1ZS5mdWxseVF1YWxpZmllZE5hbWUuc3BsaXQoJ0AnKVswXV07XG4gICAgICAgICAgICAgICAgaWYgKGVudGl0eVR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhdGggPSBjb21iaW5lUGF0aChlbnRpdHlUeXBlLmZ1bGx5UXVhbGlmaWVkTmFtZSwgcGF0aFBhcnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0TWFwW2N1cnJlbnRQYXRoXTtcbiAgICB9LCBudWxsKTtcbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICBpZiAoYW5ub3RhdGlvbnNUZXJtKSB7XG4gICAgICAgICAgICBjb25zdCBhbm5vdGF0aW9uVHlwZSA9IGluZmVyVHlwZUZyb21UZXJtKGFubm90YXRpb25zVGVybSwgY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICBvRXJyb3JNc2cgPSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAgICAgICAgICAgJ1VuYWJsZSB0byByZXNvbHZlIHRoZSBwYXRoIGV4cHJlc3Npb246ICcgK1xuICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgIHBhdGggK1xuICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICdcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJ0hpbnQ6IENoZWNrIGFuZCBjb3JyZWN0IHRoZSBwYXRoIHZhbHVlcyB1bmRlciB0aGUgZm9sbG93aW5nIHN0cnVjdHVyZSBpbiB0aGUgbWV0YWRhdGEgKGFubm90YXRpb24ueG1sIGZpbGUgb3IgQ0RTIGFubm90YXRpb25zIGZvciB0aGUgYXBwbGljYXRpb24pOiBcXG5cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxBbm5vdGF0aW9uIFRlcm0gPSAnICtcbiAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbnNUZXJtICtcbiAgICAgICAgICAgICAgICAgICAgJz4nICtcbiAgICAgICAgICAgICAgICAgICAgJ1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAnPFJlY29yZCBUeXBlID0gJyArXG4gICAgICAgICAgICAgICAgICAgIGFubm90YXRpb25UeXBlICtcbiAgICAgICAgICAgICAgICAgICAgJz4nICtcbiAgICAgICAgICAgICAgICAgICAgJ1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAnPEFubm90YXRpb25QYXRoID0gJyArXG4gICAgICAgICAgICAgICAgICAgIHBhdGggK1xuICAgICAgICAgICAgICAgICAgICAnPidcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhZGRBbm5vdGF0aW9uRXJyb3JNZXNzYWdlKHBhdGgsIG9FcnJvck1zZyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvRXJyb3JNc2cgPSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAgICAgICAgICAgJ1VuYWJsZSB0byByZXNvbHZlIHRoZSBwYXRoIGV4cHJlc3Npb246ICcgK1xuICAgICAgICAgICAgICAgICAgICBwYXRoICtcbiAgICAgICAgICAgICAgICAgICAgJ1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICdIaW50OiBDaGVjayBhbmQgY29ycmVjdCB0aGUgcGF0aCB2YWx1ZXMgdW5kZXIgdGhlIGZvbGxvd2luZyBzdHJ1Y3R1cmUgaW4gdGhlIG1ldGFkYXRhIChhbm5vdGF0aW9uLnhtbCBmaWxlIG9yIENEUyBhbm5vdGF0aW9ucyBmb3IgdGhlIGFwcGxpY2F0aW9uKTogXFxuXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICc8QW5ub3RhdGlvbiBUZXJtID0gJyArXG4gICAgICAgICAgICAgICAgICAgIHBhdGhTcGxpdFswXSArXG4gICAgICAgICAgICAgICAgICAgICc+JyArXG4gICAgICAgICAgICAgICAgICAgICdcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxQcm9wZXJ0eVZhbHVlICBQYXRoPSAnICtcbiAgICAgICAgICAgICAgICAgICAgcGF0aFNwbGl0WzFdICtcbiAgICAgICAgICAgICAgICAgICAgJz4nXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYWRkQW5ub3RhdGlvbkVycm9yTWVzc2FnZShwYXRoLCBvRXJyb3JNc2cpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChwYXRoT25seSkge1xuICAgICAgICByZXR1cm4gY3VycmVudFBhdGg7XG4gICAgfVxuICAgIGlmIChpbmNsdWRlVmlzaXRlZE9iamVjdHMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZpc2l0ZWRPYmplY3RzOiBhVmlzaXRlZE9iamVjdHMsXG4gICAgICAgICAgICB0YXJnZXQ6IHRhcmdldFxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuXG4vKipcbiAqIFR5cGVndWFyZCB0byBjaGVjayBpZiB0aGUgcGF0aCBjb250YWlucyBhbiBhbm5vdGF0aW9uLlxuICpcbiAqIEBwYXJhbSBwYXRoU3RyIHRoZSBwYXRoIHRvIGV2YWx1YXRlXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZXJlIGlzIGFuIGFubm90YXRpb24gaW4gdGhlIHBhdGguXG4gKi9cbmZ1bmN0aW9uIGlzQW5ub3RhdGlvblBhdGgocGF0aFN0cjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHBhdGhTdHIuaW5kZXhPZignQCcpICE9PSAtMTtcbn1cblxuZnVuY3Rpb24gcGFyc2VWYWx1ZShwcm9wZXJ0eVZhbHVlOiBFeHByZXNzaW9uLCB2YWx1ZUZRTjogc3RyaW5nLCBvYmplY3RNYXA6IGFueSwgY29udGV4dDogQ29udmVyc2lvbkNvbnRleHQpIHtcbiAgICBpZiAocHJvcGVydHlWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHN3aXRjaCAocHJvcGVydHlWYWx1ZS50eXBlKSB7XG4gICAgICAgIGNhc2UgJ1N0cmluZyc6XG4gICAgICAgICAgICByZXR1cm4gcHJvcGVydHlWYWx1ZS5TdHJpbmc7XG4gICAgICAgIGNhc2UgJ0ludCc6XG4gICAgICAgICAgICByZXR1cm4gcHJvcGVydHlWYWx1ZS5JbnQ7XG4gICAgICAgIGNhc2UgJ0Jvb2wnOlxuICAgICAgICAgICAgcmV0dXJuIHByb3BlcnR5VmFsdWUuQm9vbDtcbiAgICAgICAgY2FzZSAnRGVjaW1hbCc6XG4gICAgICAgICAgICByZXR1cm4gRGVjaW1hbChwcm9wZXJ0eVZhbHVlLkRlY2ltYWwpO1xuICAgICAgICBjYXNlICdEYXRlJzpcbiAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlLkRhdGU7XG4gICAgICAgIGNhc2UgJ0VudW1NZW1iZXInOlxuICAgICAgICAgICAgcmV0dXJuIGFsaWFzKGNvbnRleHQucmF3TWV0YWRhdGEucmVmZXJlbmNlcywgcHJvcGVydHlWYWx1ZS5FbnVtTWVtYmVyKTtcbiAgICAgICAgY2FzZSAnUHJvcGVydHlQYXRoJzpcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1Byb3BlcnR5UGF0aCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHByb3BlcnR5VmFsdWUuUHJvcGVydHlQYXRoLFxuICAgICAgICAgICAgICAgIGZ1bGx5UXVhbGlmaWVkTmFtZTogdmFsdWVGUU4sXG4gICAgICAgICAgICAgICAgJHRhcmdldDogX3Jlc29sdmVUYXJnZXQoXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdE1hcCxcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVZhbHVlLlByb3BlcnR5UGF0aCxcbiAgICAgICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUZXJtXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAnTmF2aWdhdGlvblByb3BlcnR5UGF0aCc6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdOYXZpZ2F0aW9uUHJvcGVydHlQYXRoJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogcHJvcGVydHlWYWx1ZS5OYXZpZ2F0aW9uUHJvcGVydHlQYXRoLFxuICAgICAgICAgICAgICAgIGZ1bGx5UXVhbGlmaWVkTmFtZTogdmFsdWVGUU4sXG4gICAgICAgICAgICAgICAgJHRhcmdldDogX3Jlc29sdmVUYXJnZXQoXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdE1hcCxcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eVZhbHVlLk5hdmlnYXRpb25Qcm9wZXJ0eVBhdGgsXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGVybVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgJ0Fubm90YXRpb25QYXRoJzpcbiAgICAgICAgICAgIGNvbnN0IGFubm90YXRpb25UYXJnZXQgPSBfcmVzb2x2ZVRhcmdldChcbiAgICAgICAgICAgICAgICBvYmplY3RNYXAsXG4gICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICAgIHVuYWxpYXMoY29udGV4dC5yYXdNZXRhZGF0YS5yZWZlcmVuY2VzLCBwcm9wZXJ0eVZhbHVlLkFubm90YXRpb25QYXRoKSBhcyBzdHJpbmcsXG4gICAgICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUZXJtXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgYW5ub3RhdGlvblBhdGggPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0Fubm90YXRpb25QYXRoJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogcHJvcGVydHlWYWx1ZS5Bbm5vdGF0aW9uUGF0aCxcbiAgICAgICAgICAgICAgICBmdWxseVF1YWxpZmllZE5hbWU6IHZhbHVlRlFOLFxuICAgICAgICAgICAgICAgICR0YXJnZXQ6IGFubm90YXRpb25UYXJnZXQsXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbnNUZXJtOiBjb250ZXh0LmN1cnJlbnRUZXJtLFxuICAgICAgICAgICAgICAgIHRlcm06ICcnLFxuICAgICAgICAgICAgICAgIHBhdGg6ICcnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29udGV4dC51bnJlc29sdmVkQW5ub3RhdGlvbnMucHVzaCh7IGlubGluZTogZmFsc2UsIHRvUmVzb2x2ZTogYW5ub3RhdGlvblBhdGggfSk7XG4gICAgICAgICAgICByZXR1cm4gYW5ub3RhdGlvblBhdGg7XG4gICAgICAgIGNhc2UgJ1BhdGgnOlxuICAgICAgICAgICAgY29uc3QgJHRhcmdldCA9IF9yZXNvbHZlVGFyZ2V0KFxuICAgICAgICAgICAgICAgIG9iamVjdE1hcCxcbiAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUYXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHlWYWx1ZS5QYXRoLFxuICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGVybVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IHBhdGggPSBuZXcgUGF0aChwcm9wZXJ0eVZhbHVlLCAkdGFyZ2V0LCBjb250ZXh0LmN1cnJlbnRUZXJtLCAnJyk7XG4gICAgICAgICAgICBjb250ZXh0LnVucmVzb2x2ZWRBbm5vdGF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpbmxpbmU6IGlzQW5ub3RhdGlvblBhdGgocHJvcGVydHlWYWx1ZS5QYXRoKSxcbiAgICAgICAgICAgICAgICB0b1Jlc29sdmU6IHBhdGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHBhdGg7XG5cbiAgICAgICAgY2FzZSAnUmVjb3JkJzpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVJlY29yZChwcm9wZXJ0eVZhbHVlLlJlY29yZCwgdmFsdWVGUU4sIG9iamVjdE1hcCwgY29udGV4dCk7XG4gICAgICAgIGNhc2UgJ0NvbGxlY3Rpb24nOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlQ29sbGVjdGlvbihwcm9wZXJ0eVZhbHVlLkNvbGxlY3Rpb24sIHZhbHVlRlFOLCBvYmplY3RNYXAsIGNvbnRleHQpO1xuICAgICAgICBjYXNlICdBcHBseSc6XG4gICAgICAgIGNhc2UgJ051bGwnOlxuICAgICAgICBjYXNlICdOb3QnOlxuICAgICAgICBjYXNlICdFcSc6XG4gICAgICAgIGNhc2UgJ05lJzpcbiAgICAgICAgY2FzZSAnR3QnOlxuICAgICAgICBjYXNlICdHZSc6XG4gICAgICAgIGNhc2UgJ0x0JzpcbiAgICAgICAgY2FzZSAnTGUnOlxuICAgICAgICBjYXNlICdJZic6XG4gICAgICAgIGNhc2UgJ0FuZCc6XG4gICAgICAgIGNhc2UgJ09yJzpcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbmZlciB0aGUgdHlwZSBvZiBhIHRlcm0gYmFzZWQgb24gaXRzIHR5cGUuXG4gKlxuICogQHBhcmFtIGFubm90YXRpb25zVGVybSBUaGUgYW5ub3RhdGlvbiB0ZXJtXG4gKiBAcGFyYW0gYW5ub3RhdGlvblRhcmdldCB0aGUgYW5ub3RhdGlvbiB0YXJnZXRcbiAqIEBwYXJhbSBjdXJyZW50UHJvcGVydHkgdGhlIGN1cnJlbnQgcHJvcGVydHkgb2YgdGhlIHJlY29yZFxuICogQHJldHVybnMgdGhlIGluZmVycmVkIHR5cGUuXG4gKi9cbmZ1bmN0aW9uIGluZmVyVHlwZUZyb21UZXJtKGFubm90YXRpb25zVGVybTogc3RyaW5nLCBhbm5vdGF0aW9uVGFyZ2V0OiBzdHJpbmcsIGN1cnJlbnRQcm9wZXJ0eT86IHN0cmluZykge1xuICAgIGxldCB0YXJnZXRUeXBlID0gKFRlcm1Ub1R5cGVzIGFzIGFueSlbYW5ub3RhdGlvbnNUZXJtXTtcbiAgICBpZiAoY3VycmVudFByb3BlcnR5KSB7XG4gICAgICAgIGFubm90YXRpb25zVGVybSA9IGFubm90YXRpb25zVGVybS5zcGxpdCgnLicpLnNsaWNlKDAsIC0xKS5qb2luKCcuJykgKyAnLicgKyBjdXJyZW50UHJvcGVydHk7XG4gICAgICAgIHRhcmdldFR5cGUgPSAoVGVybVRvVHlwZXMgYXMgYW55KVthbm5vdGF0aW9uc1Rlcm1dO1xuICAgIH1cbiAgICBjb25zdCBvRXJyb3JNc2cgPSB7XG4gICAgICAgIGlzRXJyb3I6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiBgVGhlIHR5cGUgb2YgdGhlIHJlY29yZCB1c2VkIHdpdGhpbiB0aGUgdGVybSAke2Fubm90YXRpb25zVGVybX0gd2FzIG5vdCBkZWZpbmVkIGFuZCB3YXMgaW5mZXJyZWQgYXMgJHt0YXJnZXRUeXBlfS5cbkhpbnQ6IElmIHBvc3NpYmxlLCB0cnkgdG8gbWFpbnRhaW4gdGhlIFR5cGUgcHJvcGVydHkgZm9yIGVhY2ggUmVjb3JkLlxuPEFubm90YXRpb25zIFRhcmdldD1cIiR7YW5ub3RhdGlvblRhcmdldH1cIj5cblx0PEFubm90YXRpb24gVGVybT1cIiR7YW5ub3RhdGlvbnNUZXJtfVwiPlxuXHRcdDxSZWNvcmQ+Li4uPC9SZWNvcmQ+XG5cdDwvQW5ub3RhdGlvbj5cbjwvQW5ub3RhdGlvbnM+YFxuICAgIH07XG4gICAgYWRkQW5ub3RhdGlvbkVycm9yTWVzc2FnZShhbm5vdGF0aW9uVGFyZ2V0ICsgJy8nICsgYW5ub3RhdGlvbnNUZXJtLCBvRXJyb3JNc2cpO1xuICAgIHJldHVybiB0YXJnZXRUeXBlO1xufVxuXG5mdW5jdGlvbiBpc0RhdGFGaWVsZFdpdGhGb3JBY3Rpb24oYW5ub3RhdGlvbkNvbnRlbnQ6IGFueSwgYW5ub3RhdGlvblRlcm06IGFueSkge1xuICAgIHJldHVybiAoXG4gICAgICAgIGFubm90YXRpb25Db250ZW50Lmhhc093blByb3BlcnR5KCdBY3Rpb24nKSAmJlxuICAgICAgICAoYW5ub3RhdGlvblRlcm0uJFR5cGUgPT09ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5EYXRhRmllbGRGb3JBY3Rpb24nIHx8XG4gICAgICAgICAgICBhbm5vdGF0aW9uVGVybS4kVHlwZSA9PT0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkRhdGFGaWVsZFdpdGhBY3Rpb24nKVxuICAgICk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlUmVjb3JkVHlwZShyZWNvcmREZWZpbml0aW9uOiBBbm5vdGF0aW9uUmVjb3JkLCBjb250ZXh0OiBDb252ZXJzaW9uQ29udGV4dCkge1xuICAgIGxldCB0YXJnZXRUeXBlO1xuICAgIGlmICghcmVjb3JkRGVmaW5pdGlvbi50eXBlICYmIGNvbnRleHQuY3VycmVudFRlcm0pIHtcbiAgICAgICAgdGFyZ2V0VHlwZSA9IGluZmVyVHlwZUZyb21UZXJtKFxuICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGVybSxcbiAgICAgICAgICAgIGNvbnRleHQuY3VycmVudFRhcmdldC5mdWxseVF1YWxpZmllZE5hbWUsXG4gICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRQcm9wZXJ0eVxuICAgICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldFR5cGUgPSB1bmFsaWFzKGNvbnRleHQucmF3TWV0YWRhdGEucmVmZXJlbmNlcywgcmVjb3JkRGVmaW5pdGlvbi50eXBlKTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldFR5cGU7XG59XG5cbmZ1bmN0aW9uIHBhcnNlUmVjb3JkKFxuICAgIHJlY29yZERlZmluaXRpb246IEFubm90YXRpb25SZWNvcmQsXG4gICAgY3VycmVudEZRTjogc3RyaW5nLFxuICAgIG9iamVjdE1hcDogYW55LFxuICAgIGNvbnRleHQ6IENvbnZlcnNpb25Db250ZXh0XG4pIHtcbiAgICBjb25zdCB0YXJnZXRUeXBlID0gcGFyc2VSZWNvcmRUeXBlKHJlY29yZERlZmluaXRpb24sIGNvbnRleHQpO1xuXG4gICAgY29uc3QgYW5ub3RhdGlvblRlcm06IGFueSA9IHtcbiAgICAgICAgJFR5cGU6IHRhcmdldFR5cGUsXG4gICAgICAgIGZ1bGx5UXVhbGlmaWVkTmFtZTogY3VycmVudEZRTixcbiAgICAgICAgYW5ub3RhdGlvbnM6IHt9XG4gICAgfTtcbiAgICBjb25zdCBhbm5vdGF0aW9uQ29udGVudDogYW55ID0ge307XG4gICAgaWYgKEFycmF5LmlzQXJyYXkocmVjb3JkRGVmaW5pdGlvbi5hbm5vdGF0aW9ucykpIHtcbiAgICAgICAgY29uc3Qgc3ViQW5ub3RhdGlvbkxpc3QgPSB7XG4gICAgICAgICAgICB0YXJnZXQ6IGN1cnJlbnRGUU4sXG4gICAgICAgICAgICBhbm5vdGF0aW9uczogcmVjb3JkRGVmaW5pdGlvbi5hbm5vdGF0aW9ucyxcbiAgICAgICAgICAgIF9fc291cmNlOiBjb250ZXh0LmN1cnJlbnRTb3VyY2VcbiAgICAgICAgfTtcbiAgICAgICAgY29udGV4dC5hZGRpdGlvbmFsQW5ub3RhdGlvbnMucHVzaChzdWJBbm5vdGF0aW9uTGlzdCk7XG4gICAgfVxuICAgIGlmIChyZWNvcmREZWZpbml0aW9uLnByb3BlcnR5VmFsdWVzKSB7XG4gICAgICAgIHJlY29yZERlZmluaXRpb24ucHJvcGVydHlWYWx1ZXMuZm9yRWFjaCgocHJvcGVydHlWYWx1ZTogUHJvcGVydHlWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgY29udGV4dC5jdXJyZW50UHJvcGVydHkgPSBwcm9wZXJ0eVZhbHVlLm5hbWU7XG4gICAgICAgICAgICBhbm5vdGF0aW9uQ29udGVudFtwcm9wZXJ0eVZhbHVlLm5hbWVdID0gcGFyc2VWYWx1ZShcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVZhbHVlLnZhbHVlLFxuICAgICAgICAgICAgICAgIGAke2N1cnJlbnRGUU59LyR7cHJvcGVydHlWYWx1ZS5uYW1lfWAsXG4gICAgICAgICAgICAgICAgb2JqZWN0TWFwLFxuICAgICAgICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wZXJ0eVZhbHVlLmFubm90YXRpb25zKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN1YkFubm90YXRpb25MaXN0ID0ge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGAke2N1cnJlbnRGUU59LyR7cHJvcGVydHlWYWx1ZS5uYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgIGFubm90YXRpb25zOiBwcm9wZXJ0eVZhbHVlLmFubm90YXRpb25zLFxuICAgICAgICAgICAgICAgICAgICBfX3NvdXJjZTogY29udGV4dC5jdXJyZW50U291cmNlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmFkZGl0aW9uYWxBbm5vdGF0aW9ucy5wdXNoKHN1YkFubm90YXRpb25MaXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0RhdGFGaWVsZFdpdGhGb3JBY3Rpb24oYW5ub3RhdGlvbkNvbnRlbnQsIGFubm90YXRpb25UZXJtKSkge1xuICAgICAgICAgICAgICAgIC8vIHRyeSB0byByZXNvbHZlIHRvIGEgYm91bmQgYWN0aW9uIG9mIHRoZSBhbm5vdGF0aW9uIHRhcmdldFxuICAgICAgICAgICAgICAgIGFubm90YXRpb25Db250ZW50LkFjdGlvblRhcmdldCA9IGNvbnRleHQuY3VycmVudFRhcmdldC5hY3Rpb25zPy5bYW5ub3RhdGlvbkNvbnRlbnQuQWN0aW9uXTtcblxuICAgICAgICAgICAgICAgIGlmICghYW5ub3RhdGlvbkNvbnRlbnQuQWN0aW9uVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IG9iamVjdE1hcFthbm5vdGF0aW9uQ29udGVudC5BY3Rpb25dO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uPy5pc0JvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBib3VuZCBhY3Rpb24gb2YgYSBkaWZmZXJlbnQgZW50aXR5IHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGFubm90YXRpb25Db250ZW50LkFjdGlvblRhcmdldCA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVuYm91bmQgYWN0aW9uIC0tPiByZXNvbHZlIHZpYSB0aGUgYWN0aW9uIGltcG9ydFxuICAgICAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbkNvbnRlbnQuQWN0aW9uVGFyZ2V0ID0gYWN0aW9uLmFjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghYW5ub3RhdGlvbkNvbnRlbnQuQWN0aW9uVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0byBkaWFnbm9zdGljcyBkZWJ1Z2dlcjtcbiAgICAgICAgICAgICAgICAgICAgQU5OT1RBVElPTl9FUlJPUlMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdVbmFibGUgdG8gcmVzb2x2ZSB0aGUgYWN0aW9uICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFubm90YXRpb25Db250ZW50LkFjdGlvbiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyBkZWZpbmVkIGZvciAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbm5vdGF0aW9uVGVybS5mdWxseVF1YWxpZmllZE5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29udGV4dC5jdXJyZW50UHJvcGVydHkgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKGFubm90YXRpb25UZXJtLCBhbm5vdGF0aW9uQ29udGVudCk7XG59XG5cbmV4cG9ydCB0eXBlIENvbGxlY3Rpb25UeXBlID1cbiAgICB8ICdQcm9wZXJ0eVBhdGgnXG4gICAgfCAnUGF0aCdcbiAgICB8ICdJZidcbiAgICB8ICdBcHBseSdcbiAgICB8ICdOdWxsJ1xuICAgIHwgJ0FuZCdcbiAgICB8ICdFcSdcbiAgICB8ICdOZSdcbiAgICB8ICdOb3QnXG4gICAgfCAnR3QnXG4gICAgfCAnR2UnXG4gICAgfCAnTHQnXG4gICAgfCAnTGUnXG4gICAgfCAnT3InXG4gICAgfCAnQW5ub3RhdGlvblBhdGgnXG4gICAgfCAnTmF2aWdhdGlvblByb3BlcnR5UGF0aCdcbiAgICB8ICdSZWNvcmQnXG4gICAgfCAnU3RyaW5nJ1xuICAgIHwgJ0VtcHR5Q29sbGVjdGlvbic7XG5cbi8qKlxuICogUmV0cmlldmUgb3IgaW5mZXIgdGhlIGNvbGxlY3Rpb24gdHlwZSBiYXNlZCBvbiBpdHMgY29udGVudC5cbiAqXG4gKiBAcGFyYW0gY29sbGVjdGlvbkRlZmluaXRpb25cbiAqIEByZXR1cm5zIHRoZSB0eXBlIG9mIHRoZSBjb2xsZWN0aW9uXG4gKi9cbmZ1bmN0aW9uIGdldE9ySW5mZXJDb2xsZWN0aW9uVHlwZShjb2xsZWN0aW9uRGVmaW5pdGlvbjogYW55W10pOiBDb2xsZWN0aW9uVHlwZSB7XG4gICAgbGV0IHR5cGU6IENvbGxlY3Rpb25UeXBlID0gKGNvbGxlY3Rpb25EZWZpbml0aW9uIGFzIGFueSkudHlwZTtcbiAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkICYmIGNvbGxlY3Rpb25EZWZpbml0aW9uLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZmlyc3RDb2xJdGVtID0gY29sbGVjdGlvbkRlZmluaXRpb25bMF07XG4gICAgICAgIGlmIChmaXJzdENvbEl0ZW0uaGFzT3duUHJvcGVydHkoJ1Byb3BlcnR5UGF0aCcpKSB7XG4gICAgICAgICAgICB0eXBlID0gJ1Byb3BlcnR5UGF0aCc7XG4gICAgICAgIH0gZWxzZSBpZiAoZmlyc3RDb2xJdGVtLmhhc093blByb3BlcnR5KCdQYXRoJykpIHtcbiAgICAgICAgICAgIHR5cGUgPSAnUGF0aCc7XG4gICAgICAgIH0gZWxzZSBpZiAoZmlyc3RDb2xJdGVtLmhhc093blByb3BlcnR5KCdBbm5vdGF0aW9uUGF0aCcpKSB7XG4gICAgICAgICAgICB0eXBlID0gJ0Fubm90YXRpb25QYXRoJztcbiAgICAgICAgfSBlbHNlIGlmIChmaXJzdENvbEl0ZW0uaGFzT3duUHJvcGVydHkoJ05hdmlnYXRpb25Qcm9wZXJ0eVBhdGgnKSkge1xuICAgICAgICAgICAgdHlwZSA9ICdOYXZpZ2F0aW9uUHJvcGVydHlQYXRoJztcbiAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgIHR5cGVvZiBmaXJzdENvbEl0ZW0gPT09ICdvYmplY3QnICYmXG4gICAgICAgICAgICAoZmlyc3RDb2xJdGVtLmhhc093blByb3BlcnR5KCd0eXBlJykgfHwgZmlyc3RDb2xJdGVtLmhhc093blByb3BlcnR5KCdwcm9wZXJ0eVZhbHVlcycpKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHR5cGUgPSAnUmVjb3JkJztcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZmlyc3RDb2xJdGVtID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdHlwZSA9ICdTdHJpbmcnO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdHlwZSA9ICdFbXB0eUNvbGxlY3Rpb24nO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZTtcbn1cblxuZnVuY3Rpb24gcGFyc2VDb2xsZWN0aW9uKGNvbGxlY3Rpb25EZWZpbml0aW9uOiBhbnlbXSwgcGFyZW50RlFOOiBzdHJpbmcsIG9iamVjdE1hcDogYW55LCBjb250ZXh0OiBDb252ZXJzaW9uQ29udGV4dCkge1xuICAgIGNvbnN0IGNvbGxlY3Rpb25EZWZpbml0aW9uVHlwZSA9IGdldE9ySW5mZXJDb2xsZWN0aW9uVHlwZShjb2xsZWN0aW9uRGVmaW5pdGlvbik7XG4gICAgc3dpdGNoIChjb2xsZWN0aW9uRGVmaW5pdGlvblR5cGUpIHtcbiAgICAgICAgY2FzZSAnUHJvcGVydHlQYXRoJzpcbiAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uRGVmaW5pdGlvbi5tYXAoKHByb3BlcnR5UGF0aCwgcHJvcGVydHlJZHgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnUHJvcGVydHlQYXRoJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHByb3BlcnR5UGF0aC5Qcm9wZXJ0eVBhdGgsXG4gICAgICAgICAgICAgICAgICAgIGZ1bGx5UXVhbGlmaWVkTmFtZTogYCR7cGFyZW50RlFOfS8ke3Byb3BlcnR5SWR4fWAsXG4gICAgICAgICAgICAgICAgICAgICR0YXJnZXQ6IF9yZXNvbHZlVGFyZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlQYXRoLlByb3BlcnR5UGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUZXJtXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIGNhc2UgJ1BhdGgnOlxuICAgICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb25EZWZpbml0aW9uLm1hcCgocGF0aFZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgJHRhcmdldCA9IF9yZXNvbHZlVGFyZ2V0KFxuICAgICAgICAgICAgICAgICAgICBvYmplY3RNYXAsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgcGF0aFZhbHVlLlBhdGgsXG4gICAgICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUZXJtXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoID0gbmV3IFBhdGgocGF0aFZhbHVlLCAkdGFyZ2V0LCBjb250ZXh0LmN1cnJlbnRUZXJtLCAnJyk7XG4gICAgICAgICAgICAgICAgY29udGV4dC51bnJlc29sdmVkQW5ub3RhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlubGluZTogaXNBbm5vdGF0aW9uUGF0aChwYXRoVmFsdWUuUGF0aCksXG4gICAgICAgICAgICAgICAgICAgIHRvUmVzb2x2ZTogcGF0aFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXRoO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIGNhc2UgJ0Fubm90YXRpb25QYXRoJzpcbiAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uRGVmaW5pdGlvbi5tYXAoKGFubm90YXRpb25QYXRoLCBhbm5vdGF0aW9uSWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYW5ub3RhdGlvblRhcmdldCA9IF9yZXNvbHZlVGFyZ2V0KFxuICAgICAgICAgICAgICAgICAgICBvYmplY3RNYXAsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvblBhdGguQW5ub3RhdGlvblBhdGgsXG4gICAgICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUZXJtXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhbm5vdGF0aW9uQ29sbGVjdGlvbkVsZW1lbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdBbm5vdGF0aW9uUGF0aCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhbm5vdGF0aW9uUGF0aC5Bbm5vdGF0aW9uUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgZnVsbHlRdWFsaWZpZWROYW1lOiBgJHtwYXJlbnRGUU59LyR7YW5ub3RhdGlvbklkeH1gLFxuICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0OiBhbm5vdGF0aW9uVGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICBhbm5vdGF0aW9uc1Rlcm06IGNvbnRleHQuY3VycmVudFRlcm0sXG4gICAgICAgICAgICAgICAgICAgIHRlcm06ICcnLFxuICAgICAgICAgICAgICAgICAgICBwYXRoOiAnJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29udGV4dC51bnJlc29sdmVkQW5ub3RhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlubGluZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRvUmVzb2x2ZTogYW5ub3RhdGlvbkNvbGxlY3Rpb25FbGVtZW50XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFubm90YXRpb25Db2xsZWN0aW9uRWxlbWVudDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBjYXNlICdOYXZpZ2F0aW9uUHJvcGVydHlQYXRoJzpcbiAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uRGVmaW5pdGlvbi5tYXAoKG5hdlByb3BlcnR5UGF0aCwgbmF2UHJvcElkeCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdOYXZpZ2F0aW9uUHJvcGVydHlQYXRoJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5hdlByb3BlcnR5UGF0aC5OYXZpZ2F0aW9uUHJvcGVydHlQYXRoLFxuICAgICAgICAgICAgICAgICAgICBmdWxseVF1YWxpZmllZE5hbWU6IGAke3BhcmVudEZRTn0vJHtuYXZQcm9wSWR4fWAsXG4gICAgICAgICAgICAgICAgICAgICR0YXJnZXQ6IF9yZXNvbHZlVGFyZ2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWFwLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmF2UHJvcGVydHlQYXRoLk5hdmlnYXRpb25Qcm9wZXJ0eVBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGVybVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBjYXNlICdSZWNvcmQnOlxuICAgICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb25EZWZpbml0aW9uLm1hcCgocmVjb3JkRGVmaW5pdGlvbiwgcmVjb3JkSWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlUmVjb3JkKHJlY29yZERlZmluaXRpb24sIGAke3BhcmVudEZRTn0vJHtyZWNvcmRJZHh9YCwgb2JqZWN0TWFwLCBjb250ZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBjYXNlICdBcHBseSc6XG4gICAgICAgIGNhc2UgJ051bGwnOlxuICAgICAgICBjYXNlICdJZic6XG4gICAgICAgIGNhc2UgJ0VxJzpcbiAgICAgICAgY2FzZSAnTmUnOlxuICAgICAgICBjYXNlICdMdCc6XG4gICAgICAgIGNhc2UgJ0d0JzpcbiAgICAgICAgY2FzZSAnTGUnOlxuICAgICAgICBjYXNlICdHZSc6XG4gICAgICAgIGNhc2UgJ05vdCc6XG4gICAgICAgIGNhc2UgJ0FuZCc6XG4gICAgICAgIGNhc2UgJ09yJzpcbiAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uRGVmaW5pdGlvbi5tYXAoKGlmVmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWZWYWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBjYXNlICdTdHJpbmcnOlxuICAgICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb25EZWZpbml0aW9uLm1hcCgoc3RyaW5nVmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0cmluZ1ZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nVmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdHJpbmdWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmdWYWx1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nVmFsdWUuU3RyaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgaWYgKGNvbGxlY3Rpb25EZWZpbml0aW9uLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgY2FzZScpO1xuICAgIH1cbn1cblxudHlwZSBSZXNvbHZlYWJsZSA9IHtcbiAgICBpbmxpbmU6IGJvb2xlYW47XG4gICAgdG9SZXNvbHZlOiB7XG4gICAgICAgICR0YXJnZXQ6IHN0cmluZztcbiAgICAgICAgdGFyZ2V0U3RyaW5nPzogc3RyaW5nO1xuICAgICAgICBhbm5vdGF0aW9uc1Rlcm0/OiBzdHJpbmc7XG4gICAgICAgIGFubm90YXRpb25UeXBlPzogc3RyaW5nO1xuICAgICAgICB0ZXJtOiBzdHJpbmc7XG4gICAgICAgIHBhdGg6IHN0cmluZztcbiAgICB9O1xufTtcblxuZnVuY3Rpb24gY29udmVydEFubm90YXRpb24oYW5ub3RhdGlvbjogQW5ub3RhdGlvbiwgb2JqZWN0TWFwOiBhbnksIGNvbnRleHQ6IENvbnZlcnNpb25Db250ZXh0KTogYW55IHtcbiAgICBpZiAoYW5ub3RhdGlvbi5yZWNvcmQpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlUmVjb3JkKGFubm90YXRpb24ucmVjb3JkLCBhbm5vdGF0aW9uLmZ1bGx5UXVhbGlmaWVkTmFtZSwgb2JqZWN0TWFwLCBjb250ZXh0KTtcbiAgICB9IGVsc2UgaWYgKGFubm90YXRpb24uY29sbGVjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChhbm5vdGF0aW9uLnZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VWYWx1ZShhbm5vdGF0aW9uLnZhbHVlLCBhbm5vdGF0aW9uLmZ1bGx5UXVhbGlmaWVkTmFtZSwgb2JqZWN0TWFwLCBjb250ZXh0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChhbm5vdGF0aW9uLmNvbGxlY3Rpb24pIHtcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjogYW55ID0gcGFyc2VDb2xsZWN0aW9uKFxuICAgICAgICAgICAgYW5ub3RhdGlvbi5jb2xsZWN0aW9uLFxuICAgICAgICAgICAgYW5ub3RhdGlvbi5mdWxseVF1YWxpZmllZE5hbWUsXG4gICAgICAgICAgICBvYmplY3RNYXAsXG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgICk7XG4gICAgICAgIGNvbGxlY3Rpb24uZnVsbHlRdWFsaWZpZWROYW1lID0gYW5ub3RhdGlvbi5mdWxseVF1YWxpZmllZE5hbWU7XG4gICAgICAgIHJldHVybiBjb2xsZWN0aW9uO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgY2FzZScpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgcmVzb2x2ZVBhdGggZnVuY3Rpb24gZm9yIGEgZ2l2ZW4gZW50aXR5VHlwZS5cbiAqXG4gKiBAcGFyYW0gZW50aXR5VHlwZSBUaGUgZW50aXR5VHlwZSBmb3Igd2hpY2ggdGhlIGZ1bmN0aW9uIHNob3VsZCBiZSBjcmVhdGVkXG4gKiBAcGFyYW0gb2JqZWN0TWFwIFRoZSBjdXJyZW50IG9iamVjdE1hcFxuICogQHJldHVybnMgdGhlIHJlc29sdmVQYXRoIGZ1bmN0aW9uIHRoYXQgc3RhcnRzIGF0IHRoZSBlbnRpdHlUeXBlXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZVJlc29sdmVQYXRoRm4oZW50aXR5VHlwZTogRW50aXR5VHlwZSwgb2JqZWN0TWFwOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChyZWxhdGl2ZVBhdGg6IHN0cmluZywgaW5jbHVkZVZpc2l0ZWRPYmplY3RzOiBib29sZWFuKTogYW55IHtcbiAgICAgICAgY29uc3QgYW5ub3RhdGlvblRlcm06IHN0cmluZyA9ICcnO1xuICAgICAgICByZXR1cm4gX3Jlc29sdmVUYXJnZXQob2JqZWN0TWFwLCBlbnRpdHlUeXBlLCByZWxhdGl2ZVBhdGgsIGZhbHNlLCBpbmNsdWRlVmlzaXRlZE9iamVjdHMsIGFubm90YXRpb25UZXJtKTtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiByZXNvbHZlVjJOYXZpZ2F0aW9uUHJvcGVydHkoXG4gICAgbmF2UHJvcDogUmF3VjJOYXZpZ2F0aW9uUHJvcGVydHksXG4gICAgYXNzb2NpYXRpb25zOiBSYXdBc3NvY2lhdGlvbltdLFxuICAgIG9iamVjdE1hcDogUmVjb3JkPHN0cmluZywgYW55PixcbiAgICBvdXROYXZQcm9wOiBOYXZpZ2F0aW9uUHJvcGVydHlcbik6IHZvaWQge1xuICAgIGNvbnN0IHRhcmdldEFzc29jaWF0aW9uID0gYXNzb2NpYXRpb25zLmZpbmQoXG4gICAgICAgIChhc3NvY2lhdGlvbikgPT4gYXNzb2NpYXRpb24uZnVsbHlRdWFsaWZpZWROYW1lID09PSBuYXZQcm9wLnJlbGF0aW9uc2hpcFxuICAgICk7XG4gICAgaWYgKHRhcmdldEFzc29jaWF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGFzc29jaWF0aW9uRW5kID0gdGFyZ2V0QXNzb2NpYXRpb24uYXNzb2NpYXRpb25FbmQuZmluZCgoZW5kKSA9PiBlbmQucm9sZSA9PT0gbmF2UHJvcC50b1JvbGUpO1xuICAgICAgICBpZiAoYXNzb2NpYXRpb25FbmQpIHtcbiAgICAgICAgICAgIG91dE5hdlByb3AudGFyZ2V0VHlwZSA9IG9iamVjdE1hcFthc3NvY2lhdGlvbkVuZC50eXBlXTtcbiAgICAgICAgICAgIG91dE5hdlByb3AuaXNDb2xsZWN0aW9uID0gYXNzb2NpYXRpb25FbmQubXVsdGlwbGljaXR5ID09PSAnKic7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb3V0TmF2UHJvcC5yZWZlcmVudGlhbENvbnN0cmFpbnQgPSBuYXZQcm9wLnJlZmVyZW50aWFsQ29uc3RyYWludCB8fCBbXTtcbn1cblxuZnVuY3Rpb24gcmVzb2x2ZVY0TmF2aWdhdGlvblByb3BlcnR5KFxuICAgIG5hdlByb3A6IFJhd1Y0TmF2aWdhdGlvblByb3BlcnR5LFxuICAgIG9iamVjdE1hcDogUmVjb3JkPHN0cmluZywgYW55PixcbiAgICBvdXROYXZQcm9wOiBOYXZpZ2F0aW9uUHJvcGVydHlcbik6IHZvaWQge1xuICAgIG91dE5hdlByb3AudGFyZ2V0VHlwZSA9IG9iamVjdE1hcFtuYXZQcm9wLnRhcmdldFR5cGVOYW1lXTtcbiAgICBvdXROYXZQcm9wLnBhcnRuZXIgPSBuYXZQcm9wLnBhcnRuZXI7XG4gICAgb3V0TmF2UHJvcC5pc0NvbGxlY3Rpb24gPSBuYXZQcm9wLmlzQ29sbGVjdGlvbjtcbiAgICBvdXROYXZQcm9wLmNvbnRhaW5zVGFyZ2V0ID0gbmF2UHJvcC5jb250YWluc1RhcmdldDtcbiAgICBvdXROYXZQcm9wLnJlZmVyZW50aWFsQ29uc3RyYWludCA9IG5hdlByb3AucmVmZXJlbnRpYWxDb25zdHJhaW50O1xufVxuXG5mdW5jdGlvbiBpc1Y0TmF2aWdhdGlvblByb3BlcnR5KFxuICAgIG5hdlByb3A6IFJhd1YyTmF2aWdhdGlvblByb3BlcnR5IHwgUmF3VjROYXZpZ2F0aW9uUHJvcGVydHlcbik6IG5hdlByb3AgaXMgUmF3VjROYXZpZ2F0aW9uUHJvcGVydHkge1xuICAgIHJldHVybiAhIShuYXZQcm9wIGFzIEJhc2VOYXZpZ2F0aW9uUHJvcGVydHkpLnRhcmdldFR5cGVOYW1lO1xufVxuXG5mdW5jdGlvbiBwcmVwYXJlTmF2aWdhdGlvblByb3BlcnRpZXMoXG4gICAgbmF2aWdhdGlvblByb3BlcnRpZXM6IChSYXdWNE5hdmlnYXRpb25Qcm9wZXJ0eSB8IFJhd1YyTmF2aWdhdGlvblByb3BlcnR5KVtdLFxuICAgIGFzc29jaWF0aW9uczogUmF3QXNzb2NpYXRpb25bXSxcbiAgICBvYmplY3RNYXA6IFJlY29yZDxzdHJpbmcsIGFueT5cbikge1xuICAgIHJldHVybiBuYXZpZ2F0aW9uUHJvcGVydGllcy5tYXAoKG5hdlByb3ApID0+IHtcbiAgICAgICAgY29uc3Qgb3V0TmF2UHJvcDogTmF2aWdhdGlvblByb3BlcnR5ID0ge1xuICAgICAgICAgICAgX3R5cGU6ICdOYXZpZ2F0aW9uUHJvcGVydHknLFxuICAgICAgICAgICAgbmFtZTogbmF2UHJvcC5uYW1lLFxuICAgICAgICAgICAgZnVsbHlRdWFsaWZpZWROYW1lOiBuYXZQcm9wLmZ1bGx5UXVhbGlmaWVkTmFtZSxcbiAgICAgICAgICAgIGlzQ29sbGVjdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBjb250YWluc1RhcmdldDogZmFsc2UsXG4gICAgICAgICAgICByZWZlcmVudGlhbENvbnN0cmFpbnQ6IFtdLFxuICAgICAgICAgICAgYW5ub3RhdGlvbnM6IHt9LFxuICAgICAgICAgICAgcGFydG5lcjogJycsXG4gICAgICAgICAgICB0YXJnZXRUeXBlOiB1bmRlZmluZWQgYXMgYW55LFxuICAgICAgICAgICAgdGFyZ2V0VHlwZU5hbWU6ICcnXG4gICAgICAgIH07XG4gICAgICAgIGlmIChpc1Y0TmF2aWdhdGlvblByb3BlcnR5KG5hdlByb3ApKSB7XG4gICAgICAgICAgICByZXNvbHZlVjROYXZpZ2F0aW9uUHJvcGVydHkobmF2UHJvcCwgb2JqZWN0TWFwLCBvdXROYXZQcm9wKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmVWMk5hdmlnYXRpb25Qcm9wZXJ0eShuYXZQcm9wLCBhc3NvY2lhdGlvbnMsIG9iamVjdE1hcCwgb3V0TmF2UHJvcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG91dE5hdlByb3AudGFyZ2V0VHlwZSkge1xuICAgICAgICAgICAgb3V0TmF2UHJvcC50YXJnZXRUeXBlTmFtZSA9IG91dE5hdlByb3AudGFyZ2V0VHlwZS5mdWxseVF1YWxpZmllZE5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgb2JqZWN0TWFwW291dE5hdlByb3AuZnVsbHlRdWFsaWZpZWROYW1lXSA9IG91dE5hdlByb3A7XG4gICAgICAgIHJldHVybiBvdXROYXZQcm9wO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIEBwYXJhbSBlbnRpdHlUeXBlc1xuICogQHBhcmFtIGFzc29jaWF0aW9uc1xuICogQHBhcmFtIG9iamVjdE1hcFxuICovXG5mdW5jdGlvbiByZXNvbHZlTmF2aWdhdGlvblByb3BlcnRpZXMoXG4gICAgZW50aXR5VHlwZXM6IFJhd0VudGl0eVR5cGVbXSxcbiAgICBhc3NvY2lhdGlvbnM6IFJhd0Fzc29jaWF0aW9uW10sXG4gICAgb2JqZWN0TWFwOiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pOiB2b2lkIHtcbiAgICBlbnRpdHlUeXBlcy5mb3JFYWNoKChlbnRpdHlUeXBlKSA9PiB7XG4gICAgICAgIGVudGl0eVR5cGUubmF2aWdhdGlvblByb3BlcnRpZXMgPSBwcmVwYXJlTmF2aWdhdGlvblByb3BlcnRpZXMoXG4gICAgICAgICAgICBlbnRpdHlUeXBlLm5hdmlnYXRpb25Qcm9wZXJ0aWVzLFxuICAgICAgICAgICAgYXNzb2NpYXRpb25zLFxuICAgICAgICAgICAgb2JqZWN0TWFwXG4gICAgICAgICk7XG4gICAgICAgIChlbnRpdHlUeXBlIGFzIEVudGl0eVR5cGUpLnJlc29sdmVQYXRoID0gY3JlYXRlUmVzb2x2ZVBhdGhGbihlbnRpdHlUeXBlIGFzIEVudGl0eVR5cGUsIG9iamVjdE1hcCk7XG4gICAgfSk7XG59XG5cbi8qKlxuICogQHBhcmFtIG5hbWVzcGFjZVxuICogQHBhcmFtIGFjdGlvbnNcbiAqIEBwYXJhbSBvYmplY3RNYXBcbiAqL1xuZnVuY3Rpb24gbGlua0FjdGlvbnNUb0VudGl0eVR5cGUobmFtZXNwYWNlOiBzdHJpbmcsIGFjdGlvbnM6IEFjdGlvbltdLCBvYmplY3RNYXA6IFJlY29yZDxzdHJpbmcsIGFueT4pOiB2b2lkIHtcbiAgICBhY3Rpb25zLmZvckVhY2goKGFjdGlvbikgPT4ge1xuICAgICAgICBpZiAoIWFjdGlvbi5hbm5vdGF0aW9ucykge1xuICAgICAgICAgICAgYWN0aW9uLmFubm90YXRpb25zID0ge307XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGlvbi5pc0JvdW5kKSB7XG4gICAgICAgICAgICBjb25zdCBzb3VyY2VFbnRpdHlUeXBlID0gb2JqZWN0TWFwW2FjdGlvbi5zb3VyY2VUeXBlXTtcbiAgICAgICAgICAgIGFjdGlvbi5zb3VyY2VFbnRpdHlUeXBlID0gc291cmNlRW50aXR5VHlwZTtcbiAgICAgICAgICAgIGlmIChzb3VyY2VFbnRpdHlUeXBlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzb3VyY2VFbnRpdHlUeXBlLmFjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlRW50aXR5VHlwZS5hY3Rpb25zID0ge307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNvdXJjZUVudGl0eVR5cGUuYWN0aW9uc1tgJHtuYW1lc3BhY2V9LiR7YWN0aW9uLm5hbWV9YF0gPSBhY3Rpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhY3Rpb24ucmV0dXJuRW50aXR5VHlwZSA9IG9iamVjdE1hcFthY3Rpb24ucmV0dXJuVHlwZV07XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gbGlua0FjdGlvbkltcG9ydHNUb0FjdGlvbnMoYWN0aW9uSW1wb3J0czogQWN0aW9uSW1wb3J0W10sIG9iamVjdE1hcDogUmVjb3JkPHN0cmluZywgYW55Pik6IHZvaWQge1xuICAgIGFjdGlvbkltcG9ydHMuZm9yRWFjaCgoYWN0aW9uSW1wb3J0KSA9PiB7XG4gICAgICAgIGFjdGlvbkltcG9ydC5hY3Rpb24gPSBvYmplY3RNYXBbYWN0aW9uSW1wb3J0LmFjdGlvbk5hbWVdO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIEBwYXJhbSBlbnRpdHlTZXRzXG4gKiBAcGFyYW0gb2JqZWN0TWFwXG4gKiBAcGFyYW0gcmVmZXJlbmNlc1xuICovXG5mdW5jdGlvbiBsaW5rRW50aXR5VHlwZVRvRW50aXR5U2V0KFxuICAgIGVudGl0eVNldHM6IEVudGl0eVNldFtdLFxuICAgIG9iamVjdE1hcDogUmVjb3JkPHN0cmluZywgYW55PixcbiAgICByZWZlcmVuY2VzOiBSZWZlcmVuY2VzV2l0aE1hcFxuKTogdm9pZCB7XG4gICAgZW50aXR5U2V0cy5mb3JFYWNoKChlbnRpdHlTZXQpID0+IHtcbiAgICAgICAgZW50aXR5U2V0LmVudGl0eVR5cGUgPSBvYmplY3RNYXBbZW50aXR5U2V0LmVudGl0eVR5cGVOYW1lXTtcbiAgICAgICAgaWYgKCFlbnRpdHlTZXQuZW50aXR5VHlwZSkge1xuICAgICAgICAgICAgZW50aXR5U2V0LmVudGl0eVR5cGUgPSBvYmplY3RNYXBbdW5hbGlhcyhyZWZlcmVuY2VzLCBlbnRpdHlTZXQuZW50aXR5VHlwZU5hbWUpIGFzIHN0cmluZ107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFlbnRpdHlTZXQuYW5ub3RhdGlvbnMpIHtcbiAgICAgICAgICAgIGVudGl0eVNldC5hbm5vdGF0aW9ucyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghZW50aXR5U2V0LmVudGl0eVR5cGUuYW5ub3RhdGlvbnMpIHtcbiAgICAgICAgICAgIGVudGl0eVNldC5lbnRpdHlUeXBlLmFubm90YXRpb25zID0ge307XG4gICAgICAgIH1cbiAgICAgICAgZW50aXR5U2V0LmVudGl0eVR5cGUua2V5cy5mb3JFYWNoKChrZXlQcm9wOiBQcm9wZXJ0eSkgPT4ge1xuICAgICAgICAgICAga2V5UHJvcC5pc0tleSA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIEBwYXJhbSBzaW5nbGV0b25zXG4gKiBAcGFyYW0gb2JqZWN0TWFwXG4gKiBAcGFyYW0gcmVmZXJlbmNlc1xuICovXG5mdW5jdGlvbiBsaW5rRW50aXR5VHlwZVRvU2luZ2xldG9uKFxuICAgIHNpbmdsZXRvbnM6IFNpbmdsZXRvbltdLFxuICAgIG9iamVjdE1hcDogUmVjb3JkPHN0cmluZywgYW55PixcbiAgICByZWZlcmVuY2VzOiBSZWZlcmVuY2VzV2l0aE1hcFxuKTogdm9pZCB7XG4gICAgc2luZ2xldG9ucy5mb3JFYWNoKChzaW5nbGV0b24pID0+IHtcbiAgICAgICAgc2luZ2xldG9uLmVudGl0eVR5cGUgPSBvYmplY3RNYXBbc2luZ2xldG9uLmVudGl0eVR5cGVOYW1lXTtcbiAgICAgICAgaWYgKCFzaW5nbGV0b24uZW50aXR5VHlwZSkge1xuICAgICAgICAgICAgc2luZ2xldG9uLmVudGl0eVR5cGUgPSBvYmplY3RNYXBbdW5hbGlhcyhyZWZlcmVuY2VzLCBzaW5nbGV0b24uZW50aXR5VHlwZU5hbWUpIGFzIHN0cmluZ107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzaW5nbGV0b24uYW5ub3RhdGlvbnMpIHtcbiAgICAgICAgICAgIHNpbmdsZXRvbi5hbm5vdGF0aW9ucyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2luZ2xldG9uLmVudGl0eVR5cGUuYW5ub3RhdGlvbnMpIHtcbiAgICAgICAgICAgIHNpbmdsZXRvbi5lbnRpdHlUeXBlLmFubm90YXRpb25zID0ge307XG4gICAgICAgIH1cbiAgICAgICAgc2luZ2xldG9uLmVudGl0eVR5cGUua2V5cy5mb3JFYWNoKChrZXlQcm9wOiBQcm9wZXJ0eSkgPT4ge1xuICAgICAgICAgICAga2V5UHJvcC5pc0tleSA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIEBwYXJhbSBlbnRpdHlUeXBlc1xuICogQHBhcmFtIG9iamVjdE1hcFxuICovXG5mdW5jdGlvbiBsaW5rUHJvcGVydGllc1RvQ29tcGxleFR5cGVzKGVudGl0eVR5cGVzOiBFbnRpdHlUeXBlW10sIG9iamVjdE1hcDogUmVjb3JkPHN0cmluZywgYW55Pikge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxpbmsocHJvcGVydHk6IFByb3BlcnR5KSB7XG4gICAgICAgIGlmICghcHJvcGVydHkuYW5ub3RhdGlvbnMpIHtcbiAgICAgICAgICAgIHByb3BlcnR5LmFubm90YXRpb25zID0ge307XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5LnR5cGUuaW5kZXhPZignRWRtJykgIT09IDApIHtcbiAgICAgICAgICAgICAgICBsZXQgY29tcGxleFR5cGU6IENvbXBsZXhUeXBlIHwgVHlwZURlZmluaXRpb247XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5LnR5cGUuc3RhcnRzV2l0aCgnQ29sbGVjdGlvbicpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBsZXhUeXBlTmFtZSA9IHByb3BlcnR5LnR5cGUuc3Vic3RyaW5nKDExLCBwcm9wZXJ0eS50eXBlLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV4VHlwZSA9IG9iamVjdE1hcFtjb21wbGV4VHlwZU5hbWVdIGFzIENvbXBsZXhUeXBlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXhUeXBlID0gb2JqZWN0TWFwW3Byb3BlcnR5LnR5cGVdIGFzIENvbXBsZXhUeXBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29tcGxleFR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkudGFyZ2V0VHlwZSA9IGNvbXBsZXhUeXBlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGxleFR5cGUucHJvcGVydGllcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxleFR5cGUucHJvcGVydGllcy5mb3JFYWNoKGxpbmspO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChzRXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUHJvcGVydHkgVHlwZSBpcyBub3QgZGVmaW5lZCcpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZW50aXR5VHlwZXMuZm9yRWFjaCgoZW50aXR5VHlwZSkgPT4ge1xuICAgICAgICBlbnRpdHlUeXBlLmVudGl0eVByb3BlcnRpZXMuZm9yRWFjaChsaW5rKTtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gY29tcGxleFR5cGVzXG4gKiBAcGFyYW0gYXNzb2NpYXRpb25zXG4gKiBAcGFyYW0gb2JqZWN0TWFwXG4gKi9cbmZ1bmN0aW9uIHByZXBhcmVDb21wbGV4VHlwZXMoXG4gICAgY29tcGxleFR5cGVzOiBSYXdDb21wbGV4VHlwZVtdLFxuICAgIGFzc29jaWF0aW9uczogUmF3QXNzb2NpYXRpb25bXSxcbiAgICBvYmplY3RNYXA6IFJlY29yZDxzdHJpbmcsIGFueT5cbikge1xuICAgIGNvbXBsZXhUeXBlcy5mb3JFYWNoKChjb21wbGV4VHlwZSkgPT4ge1xuICAgICAgICAoY29tcGxleFR5cGUgYXMgQ29tcGxleFR5cGUpLmFubm90YXRpb25zID0ge307XG4gICAgICAgIGNvbXBsZXhUeXBlLnByb3BlcnRpZXMuZm9yRWFjaCgocHJvcGVydHkpID0+IHtcbiAgICAgICAgICAgIGlmICghKHByb3BlcnR5IGFzIFByb3BlcnR5KS5hbm5vdGF0aW9ucykge1xuICAgICAgICAgICAgICAgIChwcm9wZXJ0eSBhcyBQcm9wZXJ0eSkuYW5ub3RhdGlvbnMgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29tcGxleFR5cGUubmF2aWdhdGlvblByb3BlcnRpZXMgPSBwcmVwYXJlTmF2aWdhdGlvblByb3BlcnRpZXMoXG4gICAgICAgICAgICBjb21wbGV4VHlwZS5uYXZpZ2F0aW9uUHJvcGVydGllcyxcbiAgICAgICAgICAgIGFzc29jaWF0aW9ucyxcbiAgICAgICAgICAgIG9iamVjdE1hcFxuICAgICAgICApO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIFNwbGl0IHRoZSBhbGlhcyBmcm9tIHRoZSB0ZXJtIHZhbHVlLlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2VzIHRoZSBjdXJyZW50IHNldCBvZiByZWZlcmVuY2VzXG4gKiBAcGFyYW0gdGVybVZhbHVlIHRoZSB2YWx1ZSBvZiB0aGUgdGVybVxuICogQHJldHVybnMgdGhlIHRlcm0gYWxpYXMgYW5kIHRoZSBhY3R1YWwgdGVybSB2YWx1ZVxuICovXG5mdW5jdGlvbiBzcGxpdFRlcm0ocmVmZXJlbmNlczogUmVmZXJlbmNlc1dpdGhNYXAsIHRlcm1WYWx1ZTogc3RyaW5nKSB7XG4gICAgY29uc3QgYWxpYXNlZFRlcm0gPSBhbGlhcyhyZWZlcmVuY2VzLCB0ZXJtVmFsdWUpO1xuICAgIGNvbnN0IGxhc3REb3QgPSBhbGlhc2VkVGVybS5sYXN0SW5kZXhPZignLicpO1xuICAgIGNvbnN0IHRlcm1BbGlhcyA9IGFsaWFzZWRUZXJtLnN1YnN0cmluZygwLCBsYXN0RG90KTtcbiAgICBjb25zdCB0ZXJtID0gYWxpYXNlZFRlcm0uc3Vic3RyaW5nKGxhc3REb3QgKyAxKTtcbiAgICByZXR1cm4gW3Rlcm1BbGlhcywgdGVybV07XG59XG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgZnVuY3Rpb24gdGhhdCB3aWxsIHJlc29sdmUgYSBzcGVjaWZpYyBwYXRoLlxuICpcbiAqIEBwYXJhbSBjb252ZXJ0ZWRPdXRwdXRcbiAqIEBwYXJhbSBvYmplY3RNYXBcbiAqIEByZXR1cm5zIHRoZSBmdW5jdGlvbiB0aGF0IHdpbGwgYWxsb3cgdG8gcmVzb2x2ZSBlbGVtZW50IGdsb2JhbGx5LlxuICovXG5mdW5jdGlvbiBjcmVhdGVHbG9iYWxSZXNvbHZlKGNvbnZlcnRlZE91dHB1dDogQ29udmVydGVkTWV0YWRhdGEsIG9iamVjdE1hcDogUmVjb3JkPHN0cmluZywgYW55Pikge1xuICAgIHJldHVybiBmdW5jdGlvbiByZXNvbHZlUGF0aDxUPihzUGF0aDogc3RyaW5nLCByZXNvbHZlRGlyZWN0bHk6IGJvb2xlYW4gPSBmYWxzZSk6IFJlc29sdXRpb25UYXJnZXQ8VD4ge1xuICAgICAgICBpZiAocmVzb2x2ZURpcmVjdGx5KSB7XG4gICAgICAgICAgICBsZXQgdGFyZ2V0UGF0aCA9IHNQYXRoO1xuICAgICAgICAgICAgaWYgKCFzUGF0aC5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRQYXRoID0gYC8ke3NQYXRofWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRSZXNvbHV0aW9uOiBhbnkgPSBfcmVzb2x2ZVRhcmdldChvYmplY3RNYXAsIGNvbnZlcnRlZE91dHB1dCwgdGFyZ2V0UGF0aCwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgaWYgKHRhcmdldFJlc29sdXRpb24udGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0UmVzb2x1dGlvbi52aXNpdGVkT2JqZWN0cy5wdXNoKHRhcmdldFJlc29sdXRpb24udGFyZ2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXRSZXNvbHV0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBvYmplY3RQYXRoOiB0YXJnZXRSZXNvbHV0aW9uLnZpc2l0ZWRPYmplY3RzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFQYXRoU3BsaXQgPSBzUGF0aC5zcGxpdCgnLycpO1xuICAgICAgICBpZiAoYVBhdGhTcGxpdC5zaGlmdCgpICE9PSAnJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZGVhbCB3aXRoIHJlbGF0aXZlIHBhdGgnKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbnRpdHlTZXROYW1lID0gYVBhdGhTcGxpdC5zaGlmdCgpO1xuICAgICAgICBjb25zdCBlbnRpdHlTZXQgPSBjb252ZXJ0ZWRPdXRwdXQuZW50aXR5U2V0cy5maW5kKChldDogRW50aXR5U2V0KSA9PiBldC5uYW1lID09PSBlbnRpdHlTZXROYW1lKTtcbiAgICAgICAgY29uc3Qgc2luZ2xldG9uID0gY29udmVydGVkT3V0cHV0LnNpbmdsZXRvbnMuZmluZCgoZXQ6IFNpbmdsZXRvbikgPT4gZXQubmFtZSA9PT0gZW50aXR5U2V0TmFtZSk7XG4gICAgICAgIGlmICghZW50aXR5U2V0ICYmICFzaW5nbGV0b24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBjb252ZXJ0ZWRPdXRwdXQuZW50aXR5Q29udGFpbmVyLFxuICAgICAgICAgICAgICAgIG9iamVjdFBhdGg6IFtjb252ZXJ0ZWRPdXRwdXQuZW50aXR5Q29udGFpbmVyXVxuICAgICAgICAgICAgfSBhcyBSZXNvbHV0aW9uVGFyZ2V0PFQ+O1xuICAgICAgICB9XG4gICAgICAgIGlmIChhUGF0aFNwbGl0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IGVudGl0eVNldCB8fCBzaW5nbGV0b24sXG4gICAgICAgICAgICAgICAgb2JqZWN0UGF0aDogW2NvbnZlcnRlZE91dHB1dC5lbnRpdHlDb250YWluZXIsIGVudGl0eVNldCB8fCBzaW5nbGV0b25dXG4gICAgICAgICAgICB9IGFzIFJlc29sdXRpb25UYXJnZXQ8VD47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXRSZXNvbHV0aW9uOiBhbnkgPSBfcmVzb2x2ZVRhcmdldChcbiAgICAgICAgICAgICAgICBvYmplY3RNYXAsXG4gICAgICAgICAgICAgICAgZW50aXR5U2V0IHx8IHNpbmdsZXRvbixcbiAgICAgICAgICAgICAgICAnLycgKyBhUGF0aFNwbGl0LmpvaW4oJy8nKSxcbiAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKHRhcmdldFJlc29sdXRpb24udGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0UmVzb2x1dGlvbi52aXNpdGVkT2JqZWN0cy5wdXNoKHRhcmdldFJlc29sdXRpb24udGFyZ2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXRSZXNvbHV0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBvYmplY3RQYXRoOiB0YXJnZXRSZXNvbHV0aW9uLnZpc2l0ZWRPYmplY3RzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcbn1cblxudHlwZSBDb252ZXJzaW9uQ29udGV4dCA9IHtcbiAgICB1bnJlc29sdmVkQW5ub3RhdGlvbnM6IFJlc29sdmVhYmxlW107XG4gICAgYWRkaXRpb25hbEFubm90YXRpb25zOiBBbm5vdGF0aW9uTGlzdFtdO1xuICAgIHJhd01ldGFkYXRhOiBSYXdNZXRhZGF0YTtcbiAgICBjdXJyZW50U291cmNlOiBzdHJpbmc7XG4gICAgY3VycmVudFRhcmdldDogYW55O1xuICAgIGN1cnJlbnRQcm9wZXJ0eT86IHN0cmluZztcbiAgICBjdXJyZW50VGVybTogc3RyaW5nO1xufTtcblxuZnVuY3Rpb24gZW5zdXJlQW5ub3RhdGlvbnMoY3VycmVudFRhcmdldDogYW55LCB2b2NBbGlhczogc3RyaW5nKSB7XG4gICAgaWYgKCFjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zKSB7XG4gICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnMgPSB7fTtcbiAgICB9XG4gICAgaWYgKCFjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXSkge1xuICAgICAgICBjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXSA9IHt9O1xuICAgIH1cbiAgICBpZiAoIWN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnMuX2Fubm90YXRpb25zKSB7XG4gICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnMuX2Fubm90YXRpb25zID0ge307XG4gICAgfVxufVxuXG5mdW5jdGlvbiBwcm9jZXNzQW5ub3RhdGlvbnMoXG4gICAgY3VycmVudENvbnRleHQ6IENvbnZlcnNpb25Db250ZXh0LFxuICAgIGFubm90YXRpb25MaXN0OiBBbm5vdGF0aW9uTGlzdCxcbiAgICBvYmplY3RNYXA6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgYk92ZXJyaWRlRXhpc3Rpbmc6IGJvb2xlYW5cbikge1xuICAgIGNvbnN0IGN1cnJlbnRUYXJnZXQgPSBjdXJyZW50Q29udGV4dC5jdXJyZW50VGFyZ2V0O1xuICAgIGNvbnN0IGN1cnJlbnRUYXJnZXROYW1lID0gY3VycmVudFRhcmdldC5mdWxseVF1YWxpZmllZE5hbWU7XG4gICAgYW5ub3RhdGlvbkxpc3QuYW5ub3RhdGlvbnMuZm9yRWFjaCgoYW5ub3RhdGlvbjogUmF3QW5ub3RhdGlvbikgPT4ge1xuICAgICAgICBjdXJyZW50Q29udGV4dC5jdXJyZW50U291cmNlID0gKGFubm90YXRpb24gYXMgYW55KS5fX3NvdXJjZSB8fCAoYW5ub3RhdGlvbkxpc3QgYXMgYW55KS5fX3NvdXJjZTtcbiAgICAgICAgY29uc3QgW3ZvY0FsaWFzLCB2b2NUZXJtXSA9IHNwbGl0VGVybShkZWZhdWx0UmVmZXJlbmNlcywgYW5ub3RhdGlvbi50ZXJtKTtcbiAgICAgICAgZW5zdXJlQW5ub3RhdGlvbnMoY3VycmVudFRhcmdldCwgdm9jQWxpYXMpO1xuXG4gICAgICAgIGNvbnN0IHZvY1Rlcm1XaXRoUXVhbGlmaWVyID0gYCR7dm9jVGVybX0ke2Fubm90YXRpb24ucXVhbGlmaWVyID8gJyMnICsgYW5ub3RhdGlvbi5xdWFsaWZpZXIgOiAnJ31gO1xuICAgICAgICBpZiAoIWJPdmVycmlkZUV4aXN0aW5nICYmIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnM/Llt2b2NBbGlhc10/Llt2b2NUZXJtV2l0aFF1YWxpZmllcl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGN1cnJlbnRDb250ZXh0LmN1cnJlbnRUZXJtID0gYW5ub3RhdGlvbi50ZXJtO1xuICAgICAgICBjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXVt2b2NUZXJtV2l0aFF1YWxpZmllcl0gPSBjb252ZXJ0QW5ub3RhdGlvbihcbiAgICAgICAgICAgIGFubm90YXRpb24gYXMgQW5ub3RhdGlvbixcbiAgICAgICAgICAgIG9iamVjdE1hcCxcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0XG4gICAgICAgICk7XG5cbiAgICAgICAgc3dpdGNoICh0eXBlb2YgY3VycmVudFRhcmdldC5hbm5vdGF0aW9uc1t2b2NBbGlhc11bdm9jVGVybVdpdGhRdWFsaWZpZXJdKSB7XG4gICAgICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1uZXctd3JhcHBlcnNcbiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXVt2b2NUZXJtV2l0aFF1YWxpZmllcl0gPSBuZXcgU3RyaW5nKFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXVt2b2NUZXJtV2l0aFF1YWxpZmllcl1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5ldy13cmFwcGVyc1xuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnNbdm9jQWxpYXNdW3ZvY1Rlcm1XaXRoUXVhbGlmaWVyXSA9IG5ldyBCb29sZWFuKFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXVt2b2NUZXJtV2l0aFF1YWxpZmllcl1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgY3VycmVudFRhcmdldC5hbm5vdGF0aW9uc1t2b2NBbGlhc11bdm9jVGVybVdpdGhRdWFsaWZpZXJdICE9PSBudWxsICYmXG4gICAgICAgICAgICB0eXBlb2YgY3VycmVudFRhcmdldC5hbm5vdGF0aW9uc1t2b2NBbGlhc11bdm9jVGVybVdpdGhRdWFsaWZpZXJdID09PSAnb2JqZWN0JyAmJlxuICAgICAgICAgICAgIWN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnNbdm9jQWxpYXNdW3ZvY1Rlcm1XaXRoUXVhbGlmaWVyXS5hbm5vdGF0aW9uc1xuICAgICAgICApIHtcbiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnNbdm9jQWxpYXNdW3ZvY1Rlcm1XaXRoUXVhbGlmaWVyXS5hbm5vdGF0aW9ucyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnNbdm9jQWxpYXNdW3ZvY1Rlcm1XaXRoUXVhbGlmaWVyXSAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgdHlwZW9mIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnNbdm9jQWxpYXNdW3ZvY1Rlcm1XaXRoUXVhbGlmaWVyXSA9PT0gJ29iamVjdCdcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXVt2b2NUZXJtV2l0aFF1YWxpZmllcl0udGVybSA9IHVuYWxpYXMoXG4gICAgICAgICAgICAgICAgZGVmYXVsdFJlZmVyZW5jZXMsXG4gICAgICAgICAgICAgICAgYCR7dm9jQWxpYXN9LiR7dm9jVGVybX1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY3VycmVudFRhcmdldC5hbm5vdGF0aW9uc1t2b2NBbGlhc11bdm9jVGVybVdpdGhRdWFsaWZpZXJdLnF1YWxpZmllciA9IGFubm90YXRpb24ucXVhbGlmaWVyO1xuICAgICAgICAgICAgY3VycmVudFRhcmdldC5hbm5vdGF0aW9uc1t2b2NBbGlhc11bdm9jVGVybVdpdGhRdWFsaWZpZXJdLl9fc291cmNlID0gY3VycmVudENvbnRleHQuY3VycmVudFNvdXJjZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbm5vdGF0aW9uVGFyZ2V0ID0gYCR7Y3VycmVudFRhcmdldE5hbWV9QCR7dW5hbGlhcyhcbiAgICAgICAgICAgIGRlZmF1bHRSZWZlcmVuY2VzLFxuICAgICAgICAgICAgdm9jQWxpYXMgKyAnLicgKyB2b2NUZXJtV2l0aFF1YWxpZmllclxuICAgICAgICApfWA7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGFubm90YXRpb24uYW5ub3RhdGlvbnMpKSB7XG4gICAgICAgICAgICBjb25zdCBzdWJBbm5vdGF0aW9uTGlzdCA9IHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IGFubm90YXRpb25UYXJnZXQsXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbnM6IGFubm90YXRpb24uYW5ub3RhdGlvbnMsXG4gICAgICAgICAgICAgICAgX19zb3VyY2U6IGN1cnJlbnRDb250ZXh0LmN1cnJlbnRTb3VyY2VcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjdXJyZW50Q29udGV4dC5hZGRpdGlvbmFsQW5ub3RhdGlvbnMucHVzaChzdWJBbm5vdGF0aW9uTGlzdCk7XG4gICAgICAgIH0gZWxzZSBpZiAoYW5ub3RhdGlvbi5hbm5vdGF0aW9ucyAmJiAhY3VycmVudFRhcmdldC5hbm5vdGF0aW9uc1t2b2NBbGlhc11bdm9jVGVybVdpdGhRdWFsaWZpZXJdLmFubm90YXRpb25zKSB7XG4gICAgICAgICAgICBjdXJyZW50VGFyZ2V0LmFubm90YXRpb25zW3ZvY0FsaWFzXVt2b2NUZXJtV2l0aFF1YWxpZmllcl0uYW5ub3RhdGlvbnMgPSBhbm5vdGF0aW9uLmFubm90YXRpb25zO1xuICAgICAgICB9XG4gICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnMuX2Fubm90YXRpb25zW2Ake3ZvY0FsaWFzfS4ke3ZvY1Rlcm1XaXRoUXVhbGlmaWVyfWBdID1cbiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnMuX2Fubm90YXRpb25zW3VuYWxpYXMoZGVmYXVsdFJlZmVyZW5jZXMsIGAke3ZvY0FsaWFzfS4ke3ZvY1Rlcm1XaXRoUXVhbGlmaWVyfWApIV0gPVxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQuYW5ub3RhdGlvbnNbdm9jQWxpYXNdW3ZvY1Rlcm1XaXRoUXVhbGlmaWVyXTtcbiAgICAgICAgb2JqZWN0TWFwW2Fubm90YXRpb25UYXJnZXRdID0gY3VycmVudFRhcmdldC5hbm5vdGF0aW9uc1t2b2NBbGlhc11bdm9jVGVybVdpdGhRdWFsaWZpZXJdO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIFByb2Nlc3MgYWxsIHRoZSB1bnJlc29sdmVkIHRhcmdldHMgc28gZmFyIHRvIHRyeSBhbmQgc2VlIGlmIHRoZXkgYXJlIHJlc29sdmVhYmxlIGluIHRoZSBlbmQuXG4gKlxuICogQHBhcmFtIHVucmVzb2x2ZWRUYXJnZXRzXG4gKiBAcGFyYW0gb2JqZWN0TWFwXG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NVbnJlc29sdmVkVGFyZ2V0cyh1bnJlc29sdmVkVGFyZ2V0czogUmVzb2x2ZWFibGVbXSwgb2JqZWN0TWFwOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG4gICAgdW5yZXNvbHZlZFRhcmdldHMuZm9yRWFjaCgocmVzb2x2YWJsZSkgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXRUb1Jlc29sdmUgPSByZXNvbHZhYmxlLnRvUmVzb2x2ZTtcbiAgICAgICAgY29uc3QgdGFyZ2V0U3RyID0gdGFyZ2V0VG9SZXNvbHZlLiR0YXJnZXQ7XG4gICAgICAgIGNvbnN0IHJlc29sdmVkVGFyZ2V0ID0gb2JqZWN0TWFwW3RhcmdldFN0cl07XG4gICAgICAgIGNvbnN0IHsgYW5ub3RhdGlvbnNUZXJtLCBhbm5vdGF0aW9uVHlwZSB9ID0gdGFyZ2V0VG9SZXNvbHZlO1xuICAgICAgICBkZWxldGUgdGFyZ2V0VG9SZXNvbHZlLmFubm90YXRpb25UeXBlO1xuICAgICAgICBkZWxldGUgdGFyZ2V0VG9SZXNvbHZlLmFubm90YXRpb25zVGVybTtcblxuICAgICAgICBpZiAocmVzb2x2YWJsZS5pbmxpbmUgJiYgIShyZXNvbHZlZFRhcmdldCBpbnN0YW5jZW9mIFN0cmluZykpIHtcbiAgICAgICAgICAgIC8vIGlubGluZSB0aGUgcmVzb2x2ZWQgdGFyZ2V0XG4gICAgICAgICAgICBsZXQga2V5czoga2V5b2YgdHlwZW9mIHRhcmdldFRvUmVzb2x2ZTtcbiAgICAgICAgICAgIGZvciAoa2V5cyBpbiB0YXJnZXRUb1Jlc29sdmUpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0VG9SZXNvbHZlW2tleXNdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHRhcmdldFRvUmVzb2x2ZSwgcmVzb2x2ZWRUYXJnZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gYXNzaWduIHRoZSByZXNvbHZlZCB0YXJnZXRcbiAgICAgICAgICAgIHRhcmdldFRvUmVzb2x2ZS4kdGFyZ2V0ID0gcmVzb2x2ZWRUYXJnZXQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXJlc29sdmVkVGFyZ2V0KSB7XG4gICAgICAgICAgICB0YXJnZXRUb1Jlc29sdmUudGFyZ2V0U3RyaW5nID0gdGFyZ2V0U3RyO1xuICAgICAgICAgICAgaWYgKGFubm90YXRpb25zVGVybSAmJiBhbm5vdGF0aW9uVHlwZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9FcnJvck1zZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICdVbmFibGUgdG8gcmVzb2x2ZSB0aGUgcGF0aCBleHByZXNzaW9uOiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0ciArXG4gICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnSGludDogQ2hlY2sgYW5kIGNvcnJlY3QgdGhlIHBhdGggdmFsdWVzIHVuZGVyIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlIGluIHRoZSBtZXRhZGF0YSAoYW5ub3RhdGlvbi54bWwgZmlsZSBvciBDRFMgYW5ub3RhdGlvbnMgZm9yIHRoZSBhcHBsaWNhdGlvbik6IFxcblxcbicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxBbm5vdGF0aW9uIFRlcm0gPSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFubm90YXRpb25zVGVybSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1xcbicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxSZWNvcmQgVHlwZSA9ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvblR5cGUgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJz4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8QW5ub3RhdGlvblBhdGggPSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0ciArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGFkZEFubm90YXRpb25FcnJvck1lc3NhZ2UodGFyZ2V0U3RyLCBvRXJyb3JNc2cpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHRhcmdldFRvUmVzb2x2ZS50ZXJtO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGggPSB0YXJnZXRUb1Jlc29sdmUucGF0aDtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXJtSW5mbyA9IHRhcmdldFN0ciA/IHRhcmdldFN0ci5zcGxpdCgnLycpWzBdIDogdGFyZ2V0U3RyO1xuICAgICAgICAgICAgICAgIGNvbnN0IG9FcnJvck1zZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICdVbmFibGUgdG8gcmVzb2x2ZSB0aGUgcGF0aCBleHByZXNzaW9uOiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0ciArXG4gICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnSGludDogQ2hlY2sgYW5kIGNvcnJlY3QgdGhlIHBhdGggdmFsdWVzIHVuZGVyIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlIGluIHRoZSBtZXRhZGF0YSAoYW5ub3RhdGlvbi54bWwgZmlsZSBvciBDRFMgYW5ub3RhdGlvbnMgZm9yIHRoZSBhcHBsaWNhdGlvbik6IFxcblxcbicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxBbm5vdGF0aW9uIFRlcm0gPSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlcm1JbmZvICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnXFxuJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPFByb3BlcnR5VmFsdWUgUHJvcGVydHkgPSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5ICtcbiAgICAgICAgICAgICAgICAgICAgICAgICcgICAgICAgIFBhdGg9ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGFkZEFubm90YXRpb25FcnJvck1lc3NhZ2UodGFyZ2V0U3RyLCBvRXJyb3JNc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8qKlxuICogTWVyZ2UgYW5ub3RhdGlvbiBmcm9tIGRpZmZlcmVudCBzb3VyY2UgdG9nZXRoZXIgYnkgb3ZlcndyaXRpbmcgYXQgdGhlIHRlcm0gbGV2ZWwuXG4gKlxuICogQHBhcmFtIHJhd01ldGFkYXRhXG4gKiBAcmV0dXJucyB0aGUgcmVzdWx0aW5nIG1lcmdlZCBhbm5vdGF0aW9uc1xuICovXG5mdW5jdGlvbiBtZXJnZUFubm90YXRpb25zKHJhd01ldGFkYXRhOiBSYXdNZXRhZGF0YSk6IFJlY29yZDxzdHJpbmcsIEFubm90YXRpb25MaXN0PiB7XG4gICAgY29uc3QgYW5ub3RhdGlvbkxpc3RQZXJUYXJnZXQ6IFJlY29yZDxzdHJpbmcsIEFubm90YXRpb25MaXN0PiA9IHt9O1xuICAgIE9iamVjdC5rZXlzKHJhd01ldGFkYXRhLnNjaGVtYS5hbm5vdGF0aW9ucykuZm9yRWFjaCgoYW5ub3RhdGlvblNvdXJjZSkgPT4ge1xuICAgICAgICByYXdNZXRhZGF0YS5zY2hlbWEuYW5ub3RhdGlvbnNbYW5ub3RhdGlvblNvdXJjZV0uZm9yRWFjaCgoYW5ub3RhdGlvbkxpc3Q6IEFubm90YXRpb25MaXN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50VGFyZ2V0TmFtZSA9IHVuYWxpYXMocmF3TWV0YWRhdGEucmVmZXJlbmNlcywgYW5ub3RhdGlvbkxpc3QudGFyZ2V0KSBhcyBzdHJpbmc7XG4gICAgICAgICAgICAoYW5ub3RhdGlvbkxpc3QgYXMgYW55KS5fX3NvdXJjZSA9IGFubm90YXRpb25Tb3VyY2U7XG4gICAgICAgICAgICBpZiAoIWFubm90YXRpb25MaXN0UGVyVGFyZ2V0W2N1cnJlbnRUYXJnZXROYW1lXSkge1xuICAgICAgICAgICAgICAgIGFubm90YXRpb25MaXN0UGVyVGFyZ2V0W2N1cnJlbnRUYXJnZXROYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbnM6IGFubm90YXRpb25MaXN0LmFubm90YXRpb25zLmNvbmNhdCgpLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGN1cnJlbnRUYXJnZXROYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAoYW5ub3RhdGlvbkxpc3RQZXJUYXJnZXRbY3VycmVudFRhcmdldE5hbWVdIGFzIGFueSkuX19zb3VyY2UgPSBhbm5vdGF0aW9uU291cmNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uTGlzdC5hbm5vdGF0aW9ucy5mb3JFYWNoKChhbm5vdGF0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmRJbmRleCA9IGFubm90YXRpb25MaXN0UGVyVGFyZ2V0W2N1cnJlbnRUYXJnZXROYW1lXS5hbm5vdGF0aW9ucy5maW5kSW5kZXgoXG4gICAgICAgICAgICAgICAgICAgICAgICAocmVmZXJlbmNlQW5ub3RhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUFubm90YXRpb24udGVybSA9PT0gYW5ub3RhdGlvbi50ZXJtICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUFubm90YXRpb24ucXVhbGlmaWVyID09PSBhbm5vdGF0aW9uLnF1YWxpZmllclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIChhbm5vdGF0aW9uIGFzIGFueSkuX19zb3VyY2UgPSBhbm5vdGF0aW9uU291cmNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmluZEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbkxpc3RQZXJUYXJnZXRbY3VycmVudFRhcmdldE5hbWVdLmFubm90YXRpb25zLnNwbGljZShmaW5kSW5kZXgsIDEsIGFubm90YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbkxpc3RQZXJUYXJnZXRbY3VycmVudFRhcmdldE5hbWVdLmFubm90YXRpb25zLnB1c2goYW5ub3RhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGFubm90YXRpb25MaXN0UGVyVGFyZ2V0O1xufVxuXG4vKipcbiAqIENvbnZlcnQgYSBSYXdNZXRhZGF0YSBpbnRvIGFuIG9iamVjdCByZXByZXNlbnRhdGlvbiB0byBiZSB1c2VkIHRvIGVhc2lseSBuYXZpZ2F0ZSBhIG1ldGFkYXRhIG9iamVjdCBhbmQgaXRzIGFubm90YXRpb24uXG4gKlxuICogQHBhcmFtIHJhd01ldGFkYXRhXG4gKiBAcmV0dXJucyB0aGUgY29udmVydGVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBtZXRhZGF0YS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnQocmF3TWV0YWRhdGE6IFJhd01ldGFkYXRhKTogQ29udmVydGVkTWV0YWRhdGEge1xuICAgIEFOTk9UQVRJT05fRVJST1JTID0gW107XG4gICAgY29uc3Qgb2JqZWN0TWFwID0gYnVpbGRPYmplY3RNYXAocmF3TWV0YWRhdGEpO1xuICAgIHJlc29sdmVOYXZpZ2F0aW9uUHJvcGVydGllcyhcbiAgICAgICAgcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eVR5cGVzIGFzIEVudGl0eVR5cGVbXSxcbiAgICAgICAgcmF3TWV0YWRhdGEuc2NoZW1hLmFzc29jaWF0aW9ucyxcbiAgICAgICAgb2JqZWN0TWFwXG4gICAgKTtcbiAgICAocmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eUNvbnRhaW5lciBhcyBFbnRpdHlDb250YWluZXIpLmFubm90YXRpb25zID0ge307XG4gICAgbGlua0FjdGlvbnNUb0VudGl0eVR5cGUocmF3TWV0YWRhdGEuc2NoZW1hLm5hbWVzcGFjZSwgcmF3TWV0YWRhdGEuc2NoZW1hLmFjdGlvbnMgYXMgQWN0aW9uW10sIG9iamVjdE1hcCk7XG4gICAgbGlua0FjdGlvbkltcG9ydHNUb0FjdGlvbnMocmF3TWV0YWRhdGEuc2NoZW1hLmFjdGlvbkltcG9ydHMsIG9iamVjdE1hcCk7XG4gICAgbGlua0VudGl0eVR5cGVUb0VudGl0eVNldChyYXdNZXRhZGF0YS5zY2hlbWEuZW50aXR5U2V0cyBhcyBFbnRpdHlTZXRbXSwgb2JqZWN0TWFwLCByYXdNZXRhZGF0YS5yZWZlcmVuY2VzKTtcbiAgICBsaW5rRW50aXR5VHlwZVRvU2luZ2xldG9uKHJhd01ldGFkYXRhLnNjaGVtYS5zaW5nbGV0b25zIGFzIFNpbmdsZXRvbltdLCBvYmplY3RNYXAsIHJhd01ldGFkYXRhLnJlZmVyZW5jZXMpO1xuICAgIGxpbmtQcm9wZXJ0aWVzVG9Db21wbGV4VHlwZXMocmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eVR5cGVzIGFzIEVudGl0eVR5cGVbXSwgb2JqZWN0TWFwKTtcbiAgICBwcmVwYXJlQ29tcGxleFR5cGVzKHJhd01ldGFkYXRhLnNjaGVtYS5jb21wbGV4VHlwZXMgYXMgQ29tcGxleFR5cGVbXSwgcmF3TWV0YWRhdGEuc2NoZW1hLmFzc29jaWF0aW9ucywgb2JqZWN0TWFwKTtcbiAgICBjb25zdCB1bnJlc29sdmVkVGFyZ2V0czogUmVzb2x2ZWFibGVbXSA9IFtdO1xuICAgIGNvbnN0IHVucmVzb2x2ZWRBbm5vdGF0aW9uczogQW5ub3RhdGlvbkxpc3RbXSA9IFtdO1xuICAgIGNvbnN0IGFubm90YXRpb25MaXN0UGVyVGFyZ2V0OiBSZWNvcmQ8c3RyaW5nLCBBbm5vdGF0aW9uTGlzdD4gPSBtZXJnZUFubm90YXRpb25zKHJhd01ldGFkYXRhKTtcbiAgICBPYmplY3Qua2V5cyhhbm5vdGF0aW9uTGlzdFBlclRhcmdldCkuZm9yRWFjaCgoY3VycmVudFRhcmdldE5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgYW5ub3RhdGlvbkxpc3QgPSBhbm5vdGF0aW9uTGlzdFBlclRhcmdldFtjdXJyZW50VGFyZ2V0TmFtZV07XG4gICAgICAgIGNvbnN0IG9iamVjdE1hcEVsZW1lbnQgPSBvYmplY3RNYXBbY3VycmVudFRhcmdldE5hbWVdO1xuICAgICAgICBpZiAoIW9iamVjdE1hcEVsZW1lbnQgJiYgY3VycmVudFRhcmdldE5hbWU/LmluZGV4T2YoJ0AnKSA+IDApIHtcbiAgICAgICAgICAgIHVucmVzb2x2ZWRBbm5vdGF0aW9ucy5wdXNoKGFubm90YXRpb25MaXN0KTtcbiAgICAgICAgfSBlbHNlIGlmIChvYmplY3RNYXBFbGVtZW50KSB7XG4gICAgICAgICAgICBsZXQgYWxsVGFyZ2V0cyA9IFtvYmplY3RNYXBFbGVtZW50XTtcbiAgICAgICAgICAgIGxldCBiT3ZlcnJpZGVFeGlzdGluZyA9IHRydWU7XG4gICAgICAgICAgICBpZiAob2JqZWN0TWFwRWxlbWVudC5fdHlwZSA9PT0gJ1VuYm91bmRHZW5lcmljQWN0aW9uJykge1xuICAgICAgICAgICAgICAgIGFsbFRhcmdldHMgPSBvYmplY3RNYXBFbGVtZW50LmFjdGlvbnM7XG4gICAgICAgICAgICAgICAgYk92ZXJyaWRlRXhpc3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFsbFRhcmdldHMuZm9yRWFjaCgoY3VycmVudFRhcmdldCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZXh0OiBDb252ZXJzaW9uQ29udGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbEFubm90YXRpb25zOiB1bnJlc29sdmVkQW5ub3RhdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTb3VyY2U6IChhbm5vdGF0aW9uTGlzdCBhcyBhbnkpLl9fc291cmNlLFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0OiBjdXJyZW50VGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGVybTogJycsXG4gICAgICAgICAgICAgICAgICAgIHJhd01ldGFkYXRhOiByYXdNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgdW5yZXNvbHZlZEFubm90YXRpb25zOiB1bnJlc29sdmVkVGFyZ2V0c1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcHJvY2Vzc0Fubm90YXRpb25zKGN1cnJlbnRDb250ZXh0LCBhbm5vdGF0aW9uTGlzdCwgb2JqZWN0TWFwLCBiT3ZlcnJpZGVFeGlzdGluZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgZXh0cmFVbnJlc29sdmVkQW5ub3RhdGlvbnM6IEFubm90YXRpb25MaXN0W10gPSBbXTtcbiAgICB1bnJlc29sdmVkQW5ub3RhdGlvbnMuZm9yRWFjaCgoYW5ub3RhdGlvbkxpc3QpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudFRhcmdldE5hbWUgPSB1bmFsaWFzKHJhd01ldGFkYXRhLnJlZmVyZW5jZXMsIGFubm90YXRpb25MaXN0LnRhcmdldCkgYXMgc3RyaW5nO1xuICAgICAgICBsZXQgW2Jhc2VPYmosIGFubm90YXRpb25QYXJ0XSA9IGN1cnJlbnRUYXJnZXROYW1lLnNwbGl0KCdAJyk7XG4gICAgICAgIGNvbnN0IHRhcmdldFNwbGl0ID0gYW5ub3RhdGlvblBhcnQuc3BsaXQoJy8nKTtcbiAgICAgICAgYmFzZU9iaiA9IGJhc2VPYmogKyAnQCcgKyB0YXJnZXRTcGxpdFswXTtcbiAgICAgICAgY29uc3QgY3VycmVudFRhcmdldCA9IHRhcmdldFNwbGl0LnNsaWNlKDEpLnJlZHVjZSgoY3VycmVudE9iaiwgcGF0aCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRPYmo/LltwYXRoXTtcbiAgICAgICAgfSwgb2JqZWN0TWFwW2Jhc2VPYmpdKTtcbiAgICAgICAgaWYgKCFjdXJyZW50VGFyZ2V0IHx8IHR5cGVvZiBjdXJyZW50VGFyZ2V0ICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgQU5OT1RBVElPTl9FUlJPUlMucHVzaCh7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1RoZSBmb2xsb3dpbmcgYW5ub3RhdGlvbiB0YXJnZXQgd2FzIG5vdCBmb3VuZCBvbiB0aGUgc2VydmljZSAnICsgY3VycmVudFRhcmdldE5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudENvbnRleHQ6IENvbnZlcnNpb25Db250ZXh0ID0ge1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxBbm5vdGF0aW9uczogZXh0cmFVbnJlc29sdmVkQW5ub3RhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VycmVudFNvdXJjZTogKGFubm90YXRpb25MaXN0IGFzIGFueSkuX19zb3VyY2UsXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldDogY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgICBjdXJyZW50VGVybTogJycsXG4gICAgICAgICAgICAgICAgcmF3TWV0YWRhdGE6IHJhd01ldGFkYXRhLFxuICAgICAgICAgICAgICAgIHVucmVzb2x2ZWRBbm5vdGF0aW9uczogdW5yZXNvbHZlZFRhcmdldHNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBwcm9jZXNzQW5ub3RhdGlvbnMoY3VycmVudENvbnRleHQsIGFubm90YXRpb25MaXN0LCBvYmplY3RNYXAsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHByb2Nlc3NVbnJlc29sdmVkVGFyZ2V0cyh1bnJlc29sdmVkVGFyZ2V0cywgb2JqZWN0TWFwKTtcbiAgICBmb3IgKGNvbnN0IHByb3BlcnR5IGluIEFMTF9BTk5PVEFUSU9OX0VSUk9SUykge1xuICAgICAgICBBTk5PVEFUSU9OX0VSUk9SUy5wdXNoKEFMTF9BTk5PVEFUSU9OX0VSUk9SU1twcm9wZXJ0eV1bMF0pO1xuICAgIH1cbiAgICAocmF3TWV0YWRhdGEgYXMgYW55KS5lbnRpdHlTZXRzID0gcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eVNldHM7XG4gICAgY29uc3QgZXh0cmFSZWZlcmVuY2VzID0gcmF3TWV0YWRhdGEucmVmZXJlbmNlcy5maWx0ZXIoKHJlZmVyZW5jZTogUmVmZXJlbmNlKSA9PiB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0UmVmZXJlbmNlcy5maW5kKChkZWZhdWx0UmVmKSA9PiBkZWZhdWx0UmVmLm5hbWVzcGFjZSA9PT0gcmVmZXJlbmNlLm5hbWVzcGFjZSkgPT09IHVuZGVmaW5lZDtcbiAgICB9KTtcbiAgICBjb25zdCBjb252ZXJ0ZWRPdXRwdXQ6IFBhcnRpYWw8Q29udmVydGVkTWV0YWRhdGE+ID0ge1xuICAgICAgICB2ZXJzaW9uOiByYXdNZXRhZGF0YS52ZXJzaW9uLFxuICAgICAgICBhbm5vdGF0aW9uczogcmF3TWV0YWRhdGEuc2NoZW1hLmFubm90YXRpb25zLFxuICAgICAgICBuYW1lc3BhY2U6IHJhd01ldGFkYXRhLnNjaGVtYS5uYW1lc3BhY2UsXG4gICAgICAgIGVudGl0eUNvbnRhaW5lcjogcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eUNvbnRhaW5lciBhcyBFbnRpdHlDb250YWluZXIsXG4gICAgICAgIGFjdGlvbnM6IHJhd01ldGFkYXRhLnNjaGVtYS5hY3Rpb25zIGFzIEFjdGlvbltdLFxuICAgICAgICBhY3Rpb25JbXBvcnRzOiByYXdNZXRhZGF0YS5zY2hlbWEuYWN0aW9uSW1wb3J0cyxcbiAgICAgICAgZW50aXR5U2V0czogcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eVNldHMgYXMgRW50aXR5U2V0W10sXG4gICAgICAgIHNpbmdsZXRvbnM6IHJhd01ldGFkYXRhLnNjaGVtYS5zaW5nbGV0b25zIGFzIFNpbmdsZXRvbltdLFxuICAgICAgICBlbnRpdHlUeXBlczogcmF3TWV0YWRhdGEuc2NoZW1hLmVudGl0eVR5cGVzIGFzIEVudGl0eVR5cGVbXSxcbiAgICAgICAgY29tcGxleFR5cGVzOiByYXdNZXRhZGF0YS5zY2hlbWEuY29tcGxleFR5cGVzIGFzIENvbXBsZXhUeXBlW10sXG4gICAgICAgIHR5cGVEZWZpbml0aW9uczogcmF3TWV0YWRhdGEuc2NoZW1hLnR5cGVEZWZpbml0aW9ucyBhcyBUeXBlRGVmaW5pdGlvbltdLFxuICAgICAgICByZWZlcmVuY2VzOiBkZWZhdWx0UmVmZXJlbmNlcy5jb25jYXQoZXh0cmFSZWZlcmVuY2VzKSxcbiAgICAgICAgZGlhZ25vc3RpY3M6IEFOTk9UQVRJT05fRVJST1JTLmNvbmNhdCgpXG4gICAgfTtcbiAgICBjb252ZXJ0ZWRPdXRwdXQucmVzb2x2ZVBhdGggPSBjcmVhdGVHbG9iYWxSZXNvbHZlKGNvbnZlcnRlZE91dHB1dCBhcyBDb252ZXJ0ZWRNZXRhZGF0YSwgb2JqZWN0TWFwKTtcbiAgICByZXR1cm4gY29udmVydGVkT3V0cHV0IGFzIENvbnZlcnRlZE1ldGFkYXRhO1xufVxuIiwiZXhwb3J0ICogZnJvbSAnLi9jb252ZXJ0ZXInO1xuZXhwb3J0ICogZnJvbSAnLi93cml0ZWJhY2snO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscyc7XG4iLCJpbXBvcnQgdHlwZSB7IFJlZmVyZW5jZSwgQ29tcGxleFR5cGUsIFR5cGVEZWZpbml0aW9uIH0gZnJvbSAnQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXMnO1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRSZWZlcmVuY2VzOiBSZWZlcmVuY2VzV2l0aE1hcCA9IFtcbiAgICB7IGFsaWFzOiAnQ2FwYWJpbGl0aWVzJywgbmFtZXNwYWNlOiAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMScsIHVyaTogJycgfSxcbiAgICB7IGFsaWFzOiAnQWdncmVnYXRpb24nLCBuYW1lc3BhY2U6ICdPcmcuT0RhdGEuQWdncmVnYXRpb24uVjEnLCB1cmk6ICcnIH0sXG4gICAgeyBhbGlhczogJ1ZhbGlkYXRpb24nLCBuYW1lc3BhY2U6ICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMScsIHVyaTogJycgfSxcbiAgICB7IG5hbWVzcGFjZTogJ09yZy5PRGF0YS5Db3JlLlYxJywgYWxpYXM6ICdDb3JlJywgdXJpOiAnJyB9LFxuICAgIHsgbmFtZXNwYWNlOiAnT3JnLk9EYXRhLk1lYXN1cmVzLlYxJywgYWxpYXM6ICdNZWFzdXJlcycsIHVyaTogJycgfSxcbiAgICB7IG5hbWVzcGFjZTogJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MScsIGFsaWFzOiAnQ29tbW9uJywgdXJpOiAnJyB9LFxuICAgIHsgbmFtZXNwYWNlOiAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEnLCBhbGlhczogJ1VJJywgdXJpOiAnJyB9LFxuICAgIHsgbmFtZXNwYWNlOiAnY29tLnNhcC52b2NhYnVsYXJpZXMuU2Vzc2lvbi52MScsIGFsaWFzOiAnU2Vzc2lvbicsIHVyaTogJycgfSxcbiAgICB7IG5hbWVzcGFjZTogJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkFuYWx5dGljcy52MScsIGFsaWFzOiAnQW5hbHl0aWNzJywgdXJpOiAnJyB9LFxuICAgIHsgbmFtZXNwYWNlOiAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29kZUxpc3QudjEnLCBhbGlhczogJ0NvZGVMaXN0JywgdXJpOiAnJyB9LFxuICAgIHsgbmFtZXNwYWNlOiAnY29tLnNhcC52b2NhYnVsYXJpZXMuUGVyc29uYWxEYXRhLnYxJywgYWxpYXM6ICdQZXJzb25hbERhdGEnLCB1cmk6ICcnIH0sXG4gICAgeyBuYW1lc3BhY2U6ICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tdW5pY2F0aW9uLnYxJywgYWxpYXM6ICdDb21tdW5pY2F0aW9uJywgdXJpOiAnJyB9LFxuICAgIHsgbmFtZXNwYWNlOiAnY29tLnNhcC52b2NhYnVsYXJpZXMuSFRNTDUudjEnLCBhbGlhczogJ0hUTUw1JywgdXJpOiAnJyB9XG5dO1xuXG5leHBvcnQgdHlwZSBSZWZlcmVuY2VzV2l0aE1hcCA9IFJlZmVyZW5jZVtdICYge1xuICAgIHJlZmVyZW5jZU1hcD86IFJlY29yZDxzdHJpbmcsIFJlZmVyZW5jZT47XG4gICAgcmV2ZXJzZVJlZmVyZW5jZU1hcD86IFJlY29yZDxzdHJpbmcsIFJlZmVyZW5jZT47XG59O1xuXG4vKipcbiAqIFRyYW5zZm9ybSBhbiB1bmFsaWFzZWQgc3RyaW5nIHJlcHJlc2VudGF0aW9uIGFubm90YXRpb24gdG8gdGhlIGFsaWFzZWQgdmVyc2lvbi5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlcyBjdXJyZW50UmVmZXJlbmNlcyBmb3IgdGhlIHByb2plY3RcbiAqIEBwYXJhbSB1bmFsaWFzZWRWYWx1ZSB0aGUgdW5hbGlhc2VkIHZhbHVlXG4gKiBAcmV0dXJucyB0aGUgYWxpYXNlZCBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBzYW1lXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbGlhcyhyZWZlcmVuY2VzOiBSZWZlcmVuY2VzV2l0aE1hcCwgdW5hbGlhc2VkVmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKCFyZWZlcmVuY2VzLnJldmVyc2VSZWZlcmVuY2VNYXApIHtcbiAgICAgICAgcmVmZXJlbmNlcy5yZXZlcnNlUmVmZXJlbmNlTWFwID0gcmVmZXJlbmNlcy5yZWR1Y2UoKG1hcDogUmVjb3JkPHN0cmluZywgUmVmZXJlbmNlPiwgcmVmKSA9PiB7XG4gICAgICAgICAgICBtYXBbcmVmLm5hbWVzcGFjZV0gPSByZWY7XG4gICAgICAgICAgICByZXR1cm4gbWFwO1xuICAgICAgICB9LCB7fSk7XG4gICAgfVxuICAgIGlmICghdW5hbGlhc2VkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHVuYWxpYXNlZFZhbHVlO1xuICAgIH1cbiAgICBjb25zdCBsYXN0RG90SW5kZXggPSB1bmFsaWFzZWRWYWx1ZS5sYXN0SW5kZXhPZignLicpO1xuICAgIGNvbnN0IG5hbWVzcGFjZSA9IHVuYWxpYXNlZFZhbHVlLnN1YnN0cmluZygwLCBsYXN0RG90SW5kZXgpO1xuICAgIGNvbnN0IHZhbHVlID0gdW5hbGlhc2VkVmFsdWUuc3Vic3RyaW5nKGxhc3REb3RJbmRleCArIDEpO1xuICAgIGNvbnN0IHJlZmVyZW5jZSA9IHJlZmVyZW5jZXMucmV2ZXJzZVJlZmVyZW5jZU1hcFtuYW1lc3BhY2VdO1xuICAgIGlmIChyZWZlcmVuY2UpIHtcbiAgICAgICAgcmV0dXJuIGAke3JlZmVyZW5jZS5hbGlhc30uJHt2YWx1ZX1gO1xuICAgIH0gZWxzZSBpZiAodW5hbGlhc2VkVmFsdWUuaW5kZXhPZignQCcpICE9PSAtMSkge1xuICAgICAgICAvLyBUcnkgdG8gc2VlIGlmIGl0J3MgYW4gYW5ub3RhdGlvbiBQYXRoIGxpa2UgdG9fU2FsZXNPcmRlci9AVUkuTGluZUl0ZW1cbiAgICAgICAgY29uc3QgW3ByZUFsaWFzLCAuLi5wb3N0QWxpYXNdID0gdW5hbGlhc2VkVmFsdWUuc3BsaXQoJ0AnKTtcbiAgICAgICAgcmV0dXJuIGAke3ByZUFsaWFzfUAke2FsaWFzKHJlZmVyZW5jZXMsIHBvc3RBbGlhcy5qb2luKCdAJykpfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHVuYWxpYXNlZFZhbHVlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUcmFuc2Zvcm0gYW4gYWxpYXNlZCBzdHJpbmcgcmVwcmVzZW50YXRpb24gYW5ub3RhdGlvbiB0byB0aGUgdW5hbGlhc2VkIHZlcnNpb24uXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZXMgY3VycmVudFJlZmVyZW5jZXMgZm9yIHRoZSBwcm9qZWN0XG4gKiBAcGFyYW0gYWxpYXNlZFZhbHVlIHRoZSBhbGlhc2VkIHZhbHVlXG4gKiBAcmV0dXJucyB0aGUgdW5hbGlhc2VkIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHNhbWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuYWxpYXMocmVmZXJlbmNlczogUmVmZXJlbmNlc1dpdGhNYXAsIGFsaWFzZWRWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXJlZmVyZW5jZXMucmVmZXJlbmNlTWFwKSB7XG4gICAgICAgIHJlZmVyZW5jZXMucmVmZXJlbmNlTWFwID0gcmVmZXJlbmNlcy5yZWR1Y2UoKG1hcDogUmVjb3JkPHN0cmluZywgUmVmZXJlbmNlPiwgcmVmKSA9PiB7XG4gICAgICAgICAgICBtYXBbcmVmLmFsaWFzXSA9IHJlZjtcbiAgICAgICAgICAgIHJldHVybiBtYXA7XG4gICAgICAgIH0sIHt9KTtcbiAgICB9XG4gICAgaWYgKCFhbGlhc2VkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGFsaWFzZWRWYWx1ZTtcbiAgICB9XG4gICAgY29uc3QgW3ZvY0FsaWFzLCAuLi52YWx1ZV0gPSBhbGlhc2VkVmFsdWUuc3BsaXQoJy4nKTtcbiAgICBjb25zdCByZWZlcmVuY2UgPSByZWZlcmVuY2VzLnJlZmVyZW5jZU1hcFt2b2NBbGlhc107XG4gICAgaWYgKHJlZmVyZW5jZSkge1xuICAgICAgICByZXR1cm4gYCR7cmVmZXJlbmNlLm5hbWVzcGFjZX0uJHt2YWx1ZS5qb2luKCcuJyl9YDtcbiAgICB9IGVsc2UgaWYgKGFsaWFzZWRWYWx1ZS5pbmRleE9mKCdAJykgIT09IC0xKSB7XG4gICAgICAgIC8vIFRyeSB0byBzZWUgaWYgaXQncyBhbiBhbm5vdGF0aW9uIFBhdGggbGlrZSB0b19TYWxlc09yZGVyL0BVSS5MaW5lSXRlbVxuICAgICAgICBjb25zdCBbcHJlQWxpYXMsIC4uLnBvc3RBbGlhc10gPSBhbGlhc2VkVmFsdWUuc3BsaXQoJ0AnKTtcbiAgICAgICAgcmV0dXJuIGAke3ByZUFsaWFzfUAke3VuYWxpYXMocmVmZXJlbmNlcywgcG9zdEFsaWFzLmpvaW4oJ0AnKSl9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYWxpYXNlZFZhbHVlO1xuICAgIH1cbn1cblxuZXhwb3J0IGVudW0gVGVybVRvVHlwZXMge1xuICAgICdPcmcuT0RhdGEuQXV0aG9yaXphdGlvbi5WMS5TZWN1cml0eVNjaGVtZXMnID0gJ09yZy5PRGF0YS5BdXRob3JpemF0aW9uLlYxLlNlY3VyaXR5U2NoZW1lJyxcbiAgICAnT3JnLk9EYXRhLkF1dGhvcml6YXRpb24uVjEuQXV0aG9yaXphdGlvbnMnID0gJ09yZy5PRGF0YS5BdXRob3JpemF0aW9uLlYxLkF1dGhvcml6YXRpb24nLFxuICAgICdPcmcuT0RhdGEuQ29yZS5WMS5SZXZpc2lvbnMnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlJldmlzaW9uVHlwZScsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkxpbmtzJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5MaW5rJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuRXhhbXBsZScgPSAnT3JnLk9EYXRhLkNvcmUuVjEuRXhhbXBsZVZhbHVlJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuTWVzc2FnZXMnID0gJ09yZy5PRGF0YS5Db3JlLlYxLk1lc3NhZ2VUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuVmFsdWVFeGNlcHRpb24nID0gJ09yZy5PRGF0YS5Db3JlLlYxLlZhbHVlRXhjZXB0aW9uVHlwZScsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLlJlc291cmNlRXhjZXB0aW9uJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5SZXNvdXJjZUV4Y2VwdGlvblR5cGUnLFxuICAgICdPcmcuT0RhdGEuQ29yZS5WMS5EYXRhTW9kaWZpY2F0aW9uRXhjZXB0aW9uJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5EYXRhTW9kaWZpY2F0aW9uRXhjZXB0aW9uVHlwZScsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLklzTGFuZ3VhZ2VEZXBlbmRlbnQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkRlcmVmZXJlbmNlYWJsZUlEcycgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuQ29udmVudGlvbmFsSURzJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ29yZS5WMS5QZXJtaXNzaW9ucycgPSAnT3JnLk9EYXRhLkNvcmUuVjEuUGVybWlzc2lvbicsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkRlZmF1bHROYW1lc3BhY2UnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkltbXV0YWJsZScgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuQ29tcHV0ZWQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkNvbXB1dGVkRGVmYXVsdFZhbHVlJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ29yZS5WMS5Jc1VSTCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuSXNNZWRpYVR5cGUnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkNvbnRlbnREaXNwb3NpdGlvbicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuQ29udGVudERpc3Bvc2l0aW9uVHlwZScsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLk9wdGltaXN0aWNDb25jdXJyZW5jeScgPSAnRWRtLlByb3BlcnR5UGF0aCcsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkFkZGl0aW9uYWxQcm9wZXJ0aWVzJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ29yZS5WMS5BdXRvRXhwYW5kJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ29yZS5WMS5BdXRvRXhwYW5kUmVmZXJlbmNlcycgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuTWF5SW1wbGVtZW50JyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5RdWFsaWZpZWRUeXBlTmFtZScsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLk9yZGVyZWQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLlBvc2l0aW9uYWxJbnNlcnQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLkFsdGVybmF0ZUtleXMnID0gJ09yZy5PRGF0YS5Db3JlLlYxLkFsdGVybmF0ZUtleScsXG4gICAgJ09yZy5PRGF0YS5Db3JlLlYxLk9wdGlvbmFsUGFyYW1ldGVyJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5PcHRpb25hbFBhcmFtZXRlclR5cGUnLFxuICAgICdPcmcuT0RhdGEuQ29yZS5WMS5PcGVyYXRpb25BdmFpbGFibGUnID0gJ0VkbS5Cb29sZWFuJyxcbiAgICAnT3JnLk9EYXRhLkNvcmUuVjEuU3ltYm9saWNOYW1lJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5TaW1wbGVJZGVudGlmaWVyJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Db25mb3JtYW5jZUxldmVsJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkNvbmZvcm1hbmNlTGV2ZWxUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Bc3luY2hyb25vdXNSZXF1ZXN0c1N1cHBvcnRlZCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5CYXRjaENvbnRpbnVlT25FcnJvclN1cHBvcnRlZCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Jc29sYXRpb25TdXBwb3J0ZWQnID0gJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuSXNvbGF0aW9uTGV2ZWwnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkNyb3NzSm9pblN1cHBvcnRlZCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5DYWxsYmFja1N1cHBvcnRlZCcgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5DYWxsYmFja1R5cGUnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkNoYW5nZVRyYWNraW5nJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkNoYW5nZVRyYWNraW5nVHlwZScsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuQ291bnRSZXN0cmljdGlvbnMnID0gJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuQ291bnRSZXN0cmljdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5OYXZpZ2F0aW9uUmVzdHJpY3Rpb25zJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLk5hdmlnYXRpb25SZXN0cmljdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5JbmRleGFibGVCeUtleScgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Ub3BTdXBwb3J0ZWQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuU2tpcFN1cHBvcnRlZCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Db21wdXRlU3VwcG9ydGVkJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLlNlbGVjdFN1cHBvcnQnID0gJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuU2VsZWN0U3VwcG9ydFR5cGUnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkJhdGNoU3VwcG9ydGVkJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkJhdGNoU3VwcG9ydCcgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5CYXRjaFN1cHBvcnRUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5GaWx0ZXJSZXN0cmljdGlvbnMnID0gJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuRmlsdGVyUmVzdHJpY3Rpb25zVHlwZScsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuU29ydFJlc3RyaWN0aW9ucycgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Tb3J0UmVzdHJpY3Rpb25zVHlwZScsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuRXhwYW5kUmVzdHJpY3Rpb25zJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkV4cGFuZFJlc3RyaWN0aW9uc1R5cGUnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLlNlYXJjaFJlc3RyaWN0aW9ucycgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5TZWFyY2hSZXN0cmljdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5LZXlBc1NlZ21lbnRTdXBwb3J0ZWQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuUXVlcnlTZWdtZW50U3VwcG9ydGVkJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkluc2VydFJlc3RyaWN0aW9ucycgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5JbnNlcnRSZXN0cmljdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5EZWVwSW5zZXJ0U3VwcG9ydCcgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5EZWVwSW5zZXJ0U3VwcG9ydFR5cGUnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLlVwZGF0ZVJlc3RyaWN0aW9ucycgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5VcGRhdGVSZXN0cmljdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5EZWVwVXBkYXRlU3VwcG9ydCcgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5EZWVwVXBkYXRlU3VwcG9ydFR5cGUnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkRlbGV0ZVJlc3RyaWN0aW9ucycgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5EZWxldGVSZXN0cmljdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Db2xsZWN0aW9uUHJvcGVydHlSZXN0cmljdGlvbnMnID0gJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuQ29sbGVjdGlvblByb3BlcnR5UmVzdHJpY3Rpb25zVHlwZScsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuT3BlcmF0aW9uUmVzdHJpY3Rpb25zJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLk9wZXJhdGlvblJlc3RyaWN0aW9uc1R5cGUnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkFubm90YXRpb25WYWx1ZXNJblF1ZXJ5U3VwcG9ydGVkJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLk1vZGlmaWNhdGlvblF1ZXJ5T3B0aW9ucycgPSAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5Nb2RpZmljYXRpb25RdWVyeU9wdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5SZWFkUmVzdHJpY3Rpb25zJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLlJlYWRSZXN0cmljdGlvbnNUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkNhcGFiaWxpdGllcy5WMS5DdXN0b21IZWFkZXJzJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkN1c3RvbVBhcmFtZXRlcicsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuQ3VzdG9tUXVlcnlPcHRpb25zJyA9ICdPcmcuT0RhdGEuQ2FwYWJpbGl0aWVzLlYxLkN1c3RvbVBhcmFtZXRlcicsXG4gICAgJ09yZy5PRGF0YS5DYXBhYmlsaXRpZXMuVjEuTWVkaWFMb2NhdGlvblVwZGF0ZVN1cHBvcnRlZCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkFnZ3JlZ2F0aW9uLlYxLkFwcGx5U3VwcG9ydGVkJyA9ICdPcmcuT0RhdGEuQWdncmVnYXRpb24uVjEuQXBwbHlTdXBwb3J0ZWRUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkFnZ3JlZ2F0aW9uLlYxLkdyb3VwYWJsZScgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkFnZ3JlZ2F0aW9uLlYxLkFnZ3JlZ2F0YWJsZScgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnT3JnLk9EYXRhLkFnZ3JlZ2F0aW9uLlYxLkNvbnRleHREZWZpbmluZ1Byb3BlcnRpZXMnID0gJ0VkbS5Qcm9wZXJ0eVBhdGgnLFxuICAgICdPcmcuT0RhdGEuQWdncmVnYXRpb24uVjEuTGV2ZWxlZEhpZXJhcmNoeScgPSAnRWRtLlByb3BlcnR5UGF0aCcsXG4gICAgJ09yZy5PRGF0YS5BZ2dyZWdhdGlvbi5WMS5SZWN1cnNpdmVIaWVyYXJjaHknID0gJ09yZy5PRGF0YS5BZ2dyZWdhdGlvbi5WMS5SZWN1cnNpdmVIaWVyYXJjaHlUeXBlJyxcbiAgICAnT3JnLk9EYXRhLkFnZ3JlZ2F0aW9uLlYxLkF2YWlsYWJsZU9uQWdncmVnYXRlcycgPSAnT3JnLk9EYXRhLkFnZ3JlZ2F0aW9uLlYxLkF2YWlsYWJsZU9uQWdncmVnYXRlc1R5cGUnLFxuICAgICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMS5NaW5pbXVtJyA9ICdFZG0uUHJpbWl0aXZlVHlwZScsXG4gICAgJ09yZy5PRGF0YS5WYWxpZGF0aW9uLlYxLk1heGltdW0nID0gJ0VkbS5QcmltaXRpdmVUeXBlJyxcbiAgICAnT3JnLk9EYXRhLlZhbGlkYXRpb24uVjEuRXhjbHVzaXZlJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMS5BbGxvd2VkVmFsdWVzJyA9ICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMS5BbGxvd2VkVmFsdWUnLFxuICAgICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMS5NdWx0aXBsZU9mJyA9ICdFZG0uRGVjaW1hbCcsXG4gICAgJ09yZy5PRGF0YS5WYWxpZGF0aW9uLlYxLkNvbnN0cmFpbnQnID0gJ09yZy5PRGF0YS5WYWxpZGF0aW9uLlYxLkNvbnN0cmFpbnRUeXBlJyxcbiAgICAnT3JnLk9EYXRhLlZhbGlkYXRpb24uVjEuSXRlbXNPZicgPSAnT3JnLk9EYXRhLlZhbGlkYXRpb24uVjEuSXRlbXNPZlR5cGUnLFxuICAgICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMS5PcGVuUHJvcGVydHlUeXBlQ29uc3RyYWludCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuUXVhbGlmaWVkVHlwZU5hbWUnLFxuICAgICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMS5EZXJpdmVkVHlwZUNvbnN0cmFpbnQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlF1YWxpZmllZFR5cGVOYW1lJyxcbiAgICAnT3JnLk9EYXRhLlZhbGlkYXRpb24uVjEuQWxsb3dlZFRlcm1zJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5RdWFsaWZpZWRUZXJtTmFtZScsXG4gICAgJ09yZy5PRGF0YS5WYWxpZGF0aW9uLlYxLkFwcGxpY2FibGVUZXJtcycgPSAnT3JnLk9EYXRhLkNvcmUuVjEuUXVhbGlmaWVkVGVybU5hbWUnLFxuICAgICdPcmcuT0RhdGEuVmFsaWRhdGlvbi5WMS5NYXhJdGVtcycgPSAnRWRtLkludDY0JyxcbiAgICAnT3JnLk9EYXRhLlZhbGlkYXRpb24uVjEuTWluSXRlbXMnID0gJ0VkbS5JbnQ2NCcsXG4gICAgJ09yZy5PRGF0YS5NZWFzdXJlcy5WMS5TY2FsZScgPSAnRWRtLkJ5dGUnLFxuICAgICdPcmcuT0RhdGEuTWVhc3VyZXMuVjEuRHVyYXRpb25HcmFudWxhcml0eScgPSAnT3JnLk9EYXRhLk1lYXN1cmVzLlYxLkR1cmF0aW9uR3JhbnVsYXJpdHlUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQW5hbHl0aWNzLnYxLkRpbWVuc2lvbicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQW5hbHl0aWNzLnYxLk1lYXN1cmUnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkFuYWx5dGljcy52MS5BY2N1bXVsYXRpdmVNZWFzdXJlJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5BbmFseXRpY3MudjEuUm9sbGVkVXBQcm9wZXJ0eUNvdW50JyA9ICdFZG0uSW50MTYnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5BbmFseXRpY3MudjEuUGxhbm5pbmdBY3Rpb24nID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkFuYWx5dGljcy52MS5BZ2dyZWdhdGVkUHJvcGVydGllcycgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQW5hbHl0aWNzLnYxLkFnZ3JlZ2F0ZWRQcm9wZXJ0eVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuU2VydmljZVZlcnNpb24nID0gJ0VkbS5JbnQzMicsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5TZXJ2aWNlU2NoZW1hVmVyc2lvbicgPSAnRWRtLkludDMyJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlRleHRGb3InID0gJ0VkbS5Qcm9wZXJ0eVBhdGgnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNMYW5ndWFnZUlkZW50aWZpZXInID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5UZXh0Rm9ybWF0JyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuVGV4dEZvcm1hdFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNEaWdpdFNlcXVlbmNlJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNVcHBlckNhc2UnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0N1cnJlbmN5JyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNVbml0JyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuVW5pdFNwZWNpZmljU2NhbGUnID0gJ0VkbS5QcmltaXRpdmVUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlVuaXRTcGVjaWZpY1ByZWNpc2lvbicgPSAnRWRtLlByaW1pdGl2ZVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuU2Vjb25kYXJ5S2V5JyA9ICdFZG0uUHJvcGVydHlQYXRoJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLk1pbk9jY3VycycgPSAnRWRtLkludDY0JyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLk1heE9jY3VycycgPSAnRWRtLkludDY0JyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkFzc29jaWF0aW9uRW50aXR5JyA9ICdFZG0uTmF2aWdhdGlvblByb3BlcnR5UGF0aCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5EZXJpdmVkTmF2aWdhdGlvbicgPSAnRWRtLk5hdmlnYXRpb25Qcm9wZXJ0eVBhdGgnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuTWFza2VkJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuTWFza2VkQWx3YXlzJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuU2VtYW50aWNPYmplY3RNYXBwaW5nJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuU2VtYW50aWNPYmplY3RNYXBwaW5nVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0luc3RhbmNlQW5ub3RhdGlvbicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkZpbHRlckV4cHJlc3Npb25SZXN0cmljdGlvbnMnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5GaWx0ZXJFeHByZXNzaW9uUmVzdHJpY3Rpb25UeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkZpZWxkQ29udHJvbCcgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkZpZWxkQ29udHJvbFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuQXBwbGljYXRpb24nID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5BcHBsaWNhdGlvblR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuVGltZXN0YW1wJyA9ICdFZG0uRGF0ZVRpbWVPZmZzZXQnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuRXJyb3JSZXNvbHV0aW9uJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuRXJyb3JSZXNvbHV0aW9uVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5NZXNzYWdlcycgPSAnRWRtLkNvbXBsZXhUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLm51bWVyaWNTZXZlcml0eScgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLk51bWVyaWNNZXNzYWdlU2V2ZXJpdHlUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLk1heGltdW1OdW1lcmljTWVzc2FnZVNldmVyaXR5JyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuTnVtZXJpY01lc3NhZ2VTZXZlcml0eVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNBY3Rpb25Dcml0aWNhbCcgPSAnRWRtLkJvb2xlYW4nLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuQXR0cmlidXRlcycgPSAnRWRtLlByb3BlcnR5UGF0aCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5SZWxhdGVkUmVjdXJzaXZlSGllcmFyY2h5JyA9ICdFZG0uQW5ub3RhdGlvblBhdGgnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSW50ZXJ2YWwnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5JbnRlcnZhbFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuUmVzdWx0Q29udGV4dCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLldlYWtSZWZlcmVudGlhbENvbnN0cmFpbnQnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5XZWFrUmVmZXJlbnRpYWxDb25zdHJhaW50VHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc05hdHVyYWxQZXJzb24nID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5WYWx1ZUxpc3QnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5WYWx1ZUxpc3RUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlZhbHVlTGlzdFJlbGV2YW50UXVhbGlmaWVycycgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlNpbXBsZUlkZW50aWZpZXInLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuVmFsdWVMaXN0V2l0aEZpeGVkVmFsdWVzJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuVmFsdWVMaXN0TWFwcGluZycgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlZhbHVlTGlzdE1hcHBpbmdUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLklzQ2FsZW5kYXJZZWFyJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNDYWxlbmRhckhhbGZ5ZWFyJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNDYWxlbmRhclF1YXJ0ZXInID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0NhbGVuZGFyTW9udGgnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0NhbGVuZGFyV2VlaycgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLklzRGF5T2ZDYWxlbmRhck1vbnRoJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNEYXlPZkNhbGVuZGFyWWVhcicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLklzQ2FsZW5kYXJZZWFySGFsZnllYXInID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0NhbGVuZGFyWWVhclF1YXJ0ZXInID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0NhbGVuZGFyWWVhck1vbnRoJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNDYWxlbmRhclllYXJXZWVrJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNDYWxlbmRhckRhdGUnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0Zpc2NhbFllYXInID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0Zpc2NhbFBlcmlvZCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLklzRmlzY2FsWWVhclBlcmlvZCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLklzRmlzY2FsUXVhcnRlcicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLklzRmlzY2FsWWVhclF1YXJ0ZXInID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0Zpc2NhbFdlZWsnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0Zpc2NhbFllYXJXZWVrJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuSXNEYXlPZkZpc2NhbFllYXInID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Jc0Zpc2NhbFllYXJWYXJpYW50JyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuTXV0dWFsbHlFeGNsdXNpdmVUZXJtJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuRHJhZnRSb290JyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuRHJhZnRSb290VHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5EcmFmdE5vZGUnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5EcmFmdE5vZGVUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkRyYWZ0QWN0aXZhdGlvblZpYScgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlNpbXBsZUlkZW50aWZpZXInLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuRWRpdGFibGVGaWVsZEZvcicgPSAnRWRtLlByb3BlcnR5UGF0aCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5TZW1hbnRpY0tleScgPSAnRWRtLlByb3BlcnR5UGF0aCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5TaWRlRWZmZWN0cycgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlNpZGVFZmZlY3RzVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5EZWZhdWx0VmFsdWVzRnVuY3Rpb24nID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5RdWFsaWZpZWROYW1lJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkZpbHRlckRlZmF1bHRWYWx1ZScgPSAnRWRtLlByaW1pdGl2ZVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuRmlsdGVyRGVmYXVsdFZhbHVlSGlnaCcgPSAnRWRtLlByaW1pdGl2ZVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuU29ydE9yZGVyJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuU29ydE9yZGVyVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5SZWN1cnNpdmVIaWVyYXJjaHknID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5SZWN1cnNpdmVIaWVyYXJjaHlUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkNyZWF0ZWRBdCcgPSAnRWRtLkRhdGVUaW1lT2Zmc2V0JyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLkNyZWF0ZWRCeScgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbW9uLnYxLlVzZXJJRCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5DaGFuZ2VkQXQnID0gJ0VkbS5EYXRlVGltZU9mZnNldCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5DaGFuZ2VkQnknID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW1vbi52MS5Vc2VySUQnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tb24udjEuQXBwbHlNdWx0aVVuaXRCZWhhdmlvckZvclNvcnRpbmdBbmRGaWx0ZXJpbmcnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvZGVMaXN0LnYxLkN1cnJlbmN5Q29kZXMnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvZGVMaXN0LnYxLkNvZGVMaXN0U291cmNlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29kZUxpc3QudjEuVW5pdHNPZk1lYXN1cmUnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvZGVMaXN0LnYxLkNvZGVMaXN0U291cmNlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29kZUxpc3QudjEuU3RhbmRhcmRDb2RlJyA9ICdFZG0uUHJvcGVydHlQYXRoJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29kZUxpc3QudjEuRXh0ZXJuYWxDb2RlJyA9ICdFZG0uUHJvcGVydHlQYXRoJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29kZUxpc3QudjEuSXNDb25maWd1cmF0aW9uRGVwcmVjYXRpb25Db2RlJyA9ICdFZG0uQm9vbGVhbicsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW11bmljYXRpb24udjEuQ29udGFjdCcgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbXVuaWNhdGlvbi52MS5Db250YWN0VHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW11bmljYXRpb24udjEuQWRkcmVzcycgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbXVuaWNhdGlvbi52MS5BZGRyZXNzVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW11bmljYXRpb24udjEuSXNFbWFpbEFkZHJlc3MnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW11bmljYXRpb24udjEuSXNQaG9uZU51bWJlcicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbXVuaWNhdGlvbi52MS5FdmVudCcgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuQ29tbXVuaWNhdGlvbi52MS5FdmVudERhdGEnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tdW5pY2F0aW9uLnYxLlRhc2snID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW11bmljYXRpb24udjEuVGFza0RhdGEnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5Db21tdW5pY2F0aW9uLnYxLk1lc3NhZ2UnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLkNvbW11bmljYXRpb24udjEuTWVzc2FnZURhdGEnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5IaWVyYXJjaHkudjEuUmVjdXJzaXZlSGllcmFyY2h5JyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5IaWVyYXJjaHkudjEuUmVjdXJzaXZlSGllcmFyY2h5VHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlBlcnNvbmFsRGF0YS52MS5FbnRpdHlTZW1hbnRpY3MnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlBlcnNvbmFsRGF0YS52MS5FbnRpdHlTZW1hbnRpY3NUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuUGVyc29uYWxEYXRhLnYxLkZpZWxkU2VtYW50aWNzJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5QZXJzb25hbERhdGEudjEuRmllbGRTZW1hbnRpY3NUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuUGVyc29uYWxEYXRhLnYxLklzUG90ZW50aWFsbHlQZXJzb25hbCcgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuUGVyc29uYWxEYXRhLnYxLklzUG90ZW50aWFsbHlTZW5zaXRpdmUnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlNlc3Npb24udjEuU3RpY2t5U2Vzc2lvblN1cHBvcnRlZCcgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuU2Vzc2lvbi52MS5TdGlja3lTZXNzaW9uU3VwcG9ydGVkVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkhlYWRlckluZm8nID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkhlYWRlckluZm9UeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuSWRlbnRpZmljYXRpb24nID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkRhdGFGaWVsZEFic3RyYWN0JyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuQmFkZ2UnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkJhZGdlVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkxpbmVJdGVtJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5EYXRhRmllbGRBYnN0cmFjdCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlN0YXR1c0luZm8nID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkRhdGFGaWVsZEFic3RyYWN0JyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuRmllbGRHcm91cCcgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuRmllbGRHcm91cFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5Db25uZWN0ZWRGaWVsZHMnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkNvbm5lY3RlZEZpZWxkc1R5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5HZW9Mb2NhdGlvbnMnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkdlb0xvY2F0aW9uVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkdlb0xvY2F0aW9uJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5HZW9Mb2NhdGlvblR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5Db250YWN0cycgPSAnRWRtLkFubm90YXRpb25QYXRoJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuTWVkaWFSZXNvdXJjZScgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuTWVkaWFSZXNvdXJjZVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5EYXRhUG9pbnQnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkRhdGFQb2ludFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5LUEknID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLktQSVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5DaGFydCcgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuQ2hhcnREZWZpbml0aW9uVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlZhbHVlQ3JpdGljYWxpdHknID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlZhbHVlQ3JpdGljYWxpdHlUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuQ3JpdGljYWxpdHlMYWJlbHMnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkNyaXRpY2FsaXR5TGFiZWxUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuU2VsZWN0aW9uRmllbGRzJyA9ICdFZG0uUHJvcGVydHlQYXRoJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuRmFjZXRzJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5GYWNldCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkhlYWRlckZhY2V0cycgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuRmFjZXQnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5RdWlja1ZpZXdGYWNldHMnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkZhY2V0JyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuUXVpY2tDcmVhdGVGYWNldHMnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkZhY2V0JyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuRmlsdGVyRmFjZXRzJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5SZWZlcmVuY2VGYWNldCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnQnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnRUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuUHJlc2VudGF0aW9uVmFyaWFudCcgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuUHJlc2VudGF0aW9uVmFyaWFudFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5TZWxlY3Rpb25WYXJpYW50JyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5TZWxlY3Rpb25WYXJpYW50VHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlRoaW5nUGVyc3BlY3RpdmUnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLklzU3VtbWFyeScgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuUGFydE9mUHJldmlldycgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuTWFwJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5HYWxsZXJ5JyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5Jc0ltYWdlVVJMJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5Jc0ltYWdlJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5NdWx0aUxpbmVUZXh0JyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5UZXh0QXJyYW5nZW1lbnQnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlRleHRBcnJhbmdlbWVudFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5JbXBvcnRhbmNlJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5JbXBvcnRhbmNlVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkhpZGRlbicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuQ3JlYXRlSGlkZGVuJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5VcGRhdGVIaWRkZW4nID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkRlbGV0ZUhpZGRlbicgPSAnT3JnLk9EYXRhLkNvcmUuVjEuVGFnJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuSGlkZGVuRmlsdGVyJyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5EYXRhRmllbGREZWZhdWx0JyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5EYXRhRmllbGRBYnN0cmFjdCcsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkNyaXRpY2FsaXR5JyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5Dcml0aWNhbGl0eVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5Dcml0aWNhbGl0eUNhbGN1bGF0aW9uJyA9ICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5Dcml0aWNhbGl0eUNhbGN1bGF0aW9uVHlwZScsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLkVtcGhhc2l6ZWQnID0gJ09yZy5PRGF0YS5Db3JlLlYxLlRhZycsXG4gICAgJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLk9yZGVyQnknID0gJ0VkbS5Qcm9wZXJ0eVBhdGgnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5QYXJhbWV0ZXJEZWZhdWx0VmFsdWUnID0gJ0VkbS5QcmltaXRpdmVUeXBlJyxcbiAgICAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuUmVjb21tZW5kYXRpb25TdGF0ZScgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuVUkudjEuUmVjb21tZW5kYXRpb25TdGF0ZVR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5SZWNvbW1lbmRhdGlvbkxpc3QnID0gJ2NvbS5zYXAudm9jYWJ1bGFyaWVzLlVJLnYxLlJlY29tbWVuZGF0aW9uTGlzdFR5cGUnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5FeGNsdWRlRnJvbU5hdmlnYXRpb25Db250ZXh0JyA9ICdPcmcuT0RhdGEuQ29yZS5WMS5UYWcnLFxuICAgICdjb20uc2FwLnZvY2FidWxhcmllcy5IVE1MNS52MS5Dc3NEZWZhdWx0cycgPSAnY29tLnNhcC52b2NhYnVsYXJpZXMuSFRNTDUudjEuQ3NzRGVmYXVsdHNUeXBlJ1xufVxuXG4vKipcbiAqIERpZmZlcmVudGlhdGUgYmV0d2VlbiBhIENvbXBsZXhUeXBlIGFuZCBhIFR5cGVEZWZpbml0aW9uLlxuICogQHBhcmFtIGNvbXBsZXhUeXBlRGVmaW5pdGlvblxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgdmFsdWUgaXMgYSBjb21wbGV4IHR5cGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tcGxleFR5cGVEZWZpbml0aW9uKFxuICAgIGNvbXBsZXhUeXBlRGVmaW5pdGlvbj86IENvbXBsZXhUeXBlIHwgVHlwZURlZmluaXRpb25cbik6IGNvbXBsZXhUeXBlRGVmaW5pdGlvbiBpcyBDb21wbGV4VHlwZSB7XG4gICAgcmV0dXJuIChcbiAgICAgICAgISFjb21wbGV4VHlwZURlZmluaXRpb24gJiYgY29tcGxleFR5cGVEZWZpbml0aW9uLl90eXBlID09PSAnQ29tcGxleFR5cGUnICYmICEhY29tcGxleFR5cGVEZWZpbml0aW9uLnByb3BlcnRpZXNcbiAgICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gRGVjaW1hbCh2YWx1ZTogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaXNEZWNpbWFsKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIHZhbHVlT2YoKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIHRvU3RyaW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuIiwiaW1wb3J0IHR5cGUge1xuICAgIEFubm90YXRpb25QYXRoRXhwcmVzc2lvbixcbiAgICBBbm5vdGF0aW9uUmVjb3JkLFxuICAgIEFubm90YXRpb25UZXJtLFxuICAgIEV4cHJlc3Npb24sXG4gICAgTmF2aWdhdGlvblByb3BlcnR5UGF0aEV4cHJlc3Npb24sXG4gICAgUGF0aEV4cHJlc3Npb24sXG4gICAgUHJvcGVydHlQYXRoRXhwcmVzc2lvbixcbiAgICBSYXdBbm5vdGF0aW9uLFxuICAgIFJlZmVyZW5jZVxufSBmcm9tICdAc2FwLXV4L3ZvY2FidWxhcmllcy10eXBlcyc7XG5pbXBvcnQgeyB1bmFsaWFzIH0gZnJvbSAnLi91dGlscyc7XG5cbi8qKlxuICogUmV2ZXJ0IGFuIG9iamVjdCB0byBpdHMgcmF3IHR5cGUgZXF1aXZhbGVudC5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlcyB0aGUgY3VycmVudCByZWZlcmVuY2VcbiAqIEBwYXJhbSB2YWx1ZSB0aGUgdmFsdWUgdG8gcmV2ZXJ0XG4gKiBAcmV0dXJucyB0aGUgcmF3IHZhbHVlXG4gKi9cbmZ1bmN0aW9uIHJldmVydE9iamVjdFRvUmF3VHlwZShyZWZlcmVuY2VzOiBSZWZlcmVuY2VbXSwgdmFsdWU6IGFueSkge1xuICAgIGxldCByZXN1bHQ6IEV4cHJlc3Npb24gfCB1bmRlZmluZWQ7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdDb2xsZWN0aW9uJyxcbiAgICAgICAgICAgIENvbGxlY3Rpb246IHZhbHVlLm1hcCgoYW5ubykgPT4gcmV2ZXJ0Q29sbGVjdGlvbkl0ZW1Ub1Jhd1R5cGUocmVmZXJlbmNlcywgYW5ubykpIGFzIGFueVtdXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmICh2YWx1ZS5pc0RlY2ltYWw/LigpKSB7XG4gICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdEZWNpbWFsJyxcbiAgICAgICAgICAgIERlY2ltYWw6IHZhbHVlLnZhbHVlT2YoKVxuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAodmFsdWUuaXNTdHJpbmc/LigpKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlTWF0Y2hlcyA9IHZhbHVlLnZhbHVlT2YoKS5zcGxpdCgnLicpO1xuICAgICAgICBpZiAodmFsdWVNYXRjaGVzLmxlbmd0aCA+IDEgJiYgcmVmZXJlbmNlcy5maW5kKChyZWYpID0+IHJlZi5hbGlhcyA9PT0gdmFsdWVNYXRjaGVzWzBdKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdFbnVtTWVtYmVyJyxcbiAgICAgICAgICAgICAgICBFbnVtTWVtYmVyOiB2YWx1ZS52YWx1ZU9mKClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1N0cmluZycsXG4gICAgICAgICAgICAgICAgU3RyaW5nOiB2YWx1ZS52YWx1ZU9mKClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHZhbHVlLmlzSW50Py4oKSkge1xuICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICB0eXBlOiAnSW50JyxcbiAgICAgICAgICAgIEludDogdmFsdWUudmFsdWVPZigpXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmICh2YWx1ZS5pc0Zsb2F0Py4oKSkge1xuICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICB0eXBlOiAnRmxvYXQnLFxuICAgICAgICAgICAgRmxvYXQ6IHZhbHVlLnZhbHVlT2YoKVxuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAodmFsdWUuaXNEYXRlPy4oKSkge1xuICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICB0eXBlOiAnRGF0ZScsXG4gICAgICAgICAgICBEYXRlOiB2YWx1ZS52YWx1ZU9mKClcbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHZhbHVlLmlzQm9vbGVhbj8uKCkpIHtcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgdHlwZTogJ0Jvb2wnLFxuICAgICAgICAgICAgQm9vbDogdmFsdWUudmFsdWVPZigpID09PSAndHJ1ZSdcbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHZhbHVlLnR5cGUgPT09ICdQYXRoJykge1xuICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICB0eXBlOiAnUGF0aCcsXG4gICAgICAgICAgICBQYXRoOiB2YWx1ZS5wYXRoXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmICh2YWx1ZS50eXBlID09PSAnQW5ub3RhdGlvblBhdGgnKSB7XG4gICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdBbm5vdGF0aW9uUGF0aCcsXG4gICAgICAgICAgICBBbm5vdGF0aW9uUGF0aDogdmFsdWUudmFsdWVcbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHZhbHVlLnR5cGUgPT09ICdBcHBseScpIHtcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgdHlwZTogJ0FwcGx5JyxcbiAgICAgICAgICAgIEFwcGx5OiB2YWx1ZS5BcHBseVxuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAodmFsdWUudHlwZSA9PT0gJ051bGwnKSB7XG4gICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdOdWxsJ1xuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAodmFsdWUudHlwZSA9PT0gJ1Byb3BlcnR5UGF0aCcpIHtcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgdHlwZTogJ1Byb3BlcnR5UGF0aCcsXG4gICAgICAgICAgICBQcm9wZXJ0eVBhdGg6IHZhbHVlLnZhbHVlXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmICh2YWx1ZS50eXBlID09PSAnTmF2aWdhdGlvblByb3BlcnR5UGF0aCcpIHtcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgdHlwZTogJ05hdmlnYXRpb25Qcm9wZXJ0eVBhdGgnLFxuICAgICAgICAgICAgTmF2aWdhdGlvblByb3BlcnR5UGF0aDogdmFsdWUudmFsdWVcbiAgICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJyRUeXBlJykpIHtcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgdHlwZTogJ1JlY29yZCcsXG4gICAgICAgICAgICBSZWNvcmQ6IHJldmVydENvbGxlY3Rpb25JdGVtVG9SYXdUeXBlKHJlZmVyZW5jZXMsIHZhbHVlKSBhcyBBbm5vdGF0aW9uUmVjb3JkXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogUmV2ZXJ0IGEgdmFsdWUgdG8gaXRzIHJhdyB2YWx1ZSBkZXBlbmRpbmcgb24gaXRzIHR5cGUuXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZXMgdGhlIGN1cnJlbnQgc2V0IG9mIHJlZmVyZW5jZVxuICogQHBhcmFtIHZhbHVlIHRoZSB2YWx1ZSB0byByZXZlcnRcbiAqIEByZXR1cm5zIHRoZSByYXcgZXhwcmVzc2lvblxuICovXG5mdW5jdGlvbiByZXZlcnRWYWx1ZVRvUmF3VHlwZShyZWZlcmVuY2VzOiBSZWZlcmVuY2VbXSwgdmFsdWU6IGFueSk6IEV4cHJlc3Npb24gfCB1bmRlZmluZWQge1xuICAgIGxldCByZXN1bHQ6IEV4cHJlc3Npb24gfCB1bmRlZmluZWQ7XG4gICAgY29uc3QgdmFsdWVDb25zdHJ1Y3RvciA9IHZhbHVlPy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIHN3aXRjaCAodmFsdWVDb25zdHJ1Y3Rvcikge1xuICAgICAgICBjYXNlICdTdHJpbmcnOlxuICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgY29uc3QgdmFsdWVNYXRjaGVzID0gdmFsdWUudG9TdHJpbmcoKS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgaWYgKHZhbHVlTWF0Y2hlcy5sZW5ndGggPiAxICYmIHJlZmVyZW5jZXMuZmluZCgocmVmKSA9PiByZWYuYWxpYXMgPT09IHZhbHVlTWF0Y2hlc1swXSkpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdFbnVtTWVtYmVyJyxcbiAgICAgICAgICAgICAgICAgICAgRW51bU1lbWJlcjogdmFsdWUudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1N0cmluZycsXG4gICAgICAgICAgICAgICAgICAgIFN0cmluZzogdmFsdWUudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnQm9vbGVhbic6XG4gICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdCb29sJyxcbiAgICAgICAgICAgICAgICBCb29sOiB2YWx1ZS52YWx1ZU9mKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdOdW1iZXInOlxuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgICAgaWYgKHZhbHVlLnRvU3RyaW5nKCkgPT09IHZhbHVlLnRvRml4ZWQoKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0ludCcsXG4gICAgICAgICAgICAgICAgICAgIEludDogdmFsdWUudmFsdWVPZigpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRGVjaW1hbCcsXG4gICAgICAgICAgICAgICAgICAgIERlY2ltYWw6IHZhbHVlLnZhbHVlT2YoKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJlc3VsdCA9IHJldmVydE9iamVjdFRvUmF3VHlwZShyZWZlcmVuY2VzLCB2YWx1ZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuY29uc3QgcmVzdHJpY3RlZEtleXMgPSBbJyRUeXBlJywgJ3Rlcm0nLCAnX19zb3VyY2UnLCAncXVhbGlmaWVyJywgJ0FjdGlvblRhcmdldCcsICdmdWxseVF1YWxpZmllZE5hbWUnLCAnYW5ub3RhdGlvbnMnXTtcblxuLyoqXG4gKiBSZXZlcnQgdGhlIGN1cnJlbnQgZW1iZWRkZWQgYW5ub3RhdGlvbnMgdG8gdGhlaXIgcmF3IHR5cGUuXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZXMgdGhlIGN1cnJlbnQgc2V0IG9mIHJlZmVyZW5jZVxuICogQHBhcmFtIGN1cnJlbnRBbm5vdGF0aW9ucyB0aGUgY29sbGVjdGlvbiBpdGVtIHRvIGV2YWx1YXRlXG4gKiBAcGFyYW0gdGFyZ2V0QW5ub3RhdGlvbnMgdGhlIHBsYWNlIHdoZXJlIHdlIG5lZWQgdG8gYWRkIHRoZSBhbm5vdGF0aW9uXG4gKi9cbmZ1bmN0aW9uIHJldmVydEFubm90YXRpb25zVG9SYXdUeXBlKFxuICAgIHJlZmVyZW5jZXM6IFJlZmVyZW5jZVtdLFxuICAgIGN1cnJlbnRBbm5vdGF0aW9uczogYW55LFxuICAgIHRhcmdldEFubm90YXRpb25zOiBSYXdBbm5vdGF0aW9uW11cbikge1xuICAgIE9iamVjdC5rZXlzKGN1cnJlbnRBbm5vdGF0aW9ucylcbiAgICAgICAgLmZpbHRlcigoa2V5KSA9PiBrZXkgIT09ICdfYW5ub3RhdGlvbnMnKVxuICAgICAgICAuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhjdXJyZW50QW5ub3RhdGlvbnNba2V5XSkuZm9yRWFjaCgodGVybSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZEFubm90YXRpb24gPSByZXZlcnRUZXJtVG9HZW5lcmljVHlwZShyZWZlcmVuY2VzLCBjdXJyZW50QW5ub3RhdGlvbnNba2V5XVt0ZXJtXSk7XG4gICAgICAgICAgICAgICAgaWYgKCFwYXJzZWRBbm5vdGF0aW9uLnRlcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5hbGlhc2VkVGVybSA9IHVuYWxpYXMocmVmZXJlbmNlcywgYCR7a2V5fS4ke3Rlcm19YCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmFsaWFzZWRUZXJtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBxdWFsaWZpZWRTcGxpdCA9IHVuYWxpYXNlZFRlcm0uc3BsaXQoJyMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZEFubm90YXRpb24udGVybSA9IHF1YWxpZmllZFNwbGl0WzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1YWxpZmllZFNwbGl0Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdWIgQW5ub3RhdGlvbiB3aXRoIGEgcXVhbGlmaWVyLCBub3Qgc3VyZSB3aGVuIHRoYXQgY2FuIGhhcHBlbiBpbiByZWFsIHNjZW5hcmlvc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZEFubm90YXRpb24ucXVhbGlmaWVyID0gcXVhbGlmaWVkU3BsaXRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGFyZ2V0QW5ub3RhdGlvbnMucHVzaChwYXJzZWRBbm5vdGF0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbn1cblxuLyoqXG4gKiBSZXZlcnQgdGhlIGN1cnJlbnQgY29sbGVjdGlvbiBpdGVtIHRvIHRoZSBjb3JyZXNwb25kaW5nIHJhdyBhbm5vdGF0aW9uLlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2VzIHRoZSBjdXJyZW50IHNldCBvZiByZWZlcmVuY2VcbiAqIEBwYXJhbSBjb2xsZWN0aW9uSXRlbSB0aGUgY29sbGVjdGlvbiBpdGVtIHRvIGV2YWx1YXRlXG4gKiBAcmV0dXJucyB0aGUgcmF3IHR5cGUgZXF1aXZhbGVudFxuICovXG5mdW5jdGlvbiByZXZlcnRDb2xsZWN0aW9uSXRlbVRvUmF3VHlwZShcbiAgICByZWZlcmVuY2VzOiBSZWZlcmVuY2VbXSxcbiAgICBjb2xsZWN0aW9uSXRlbTogYW55XG4pOlxuICAgIHwgQW5ub3RhdGlvblJlY29yZFxuICAgIHwgc3RyaW5nXG4gICAgfCBQcm9wZXJ0eVBhdGhFeHByZXNzaW9uXG4gICAgfCBQYXRoRXhwcmVzc2lvblxuICAgIHwgTmF2aWdhdGlvblByb3BlcnR5UGF0aEV4cHJlc3Npb25cbiAgICB8IEFubm90YXRpb25QYXRoRXhwcmVzc2lvblxuICAgIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAodHlwZW9mIGNvbGxlY3Rpb25JdGVtID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gY29sbGVjdGlvbkl0ZW07XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgY29sbGVjdGlvbkl0ZW0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGlmIChjb2xsZWN0aW9uSXRlbS5oYXNPd25Qcm9wZXJ0eSgnJFR5cGUnKSkge1xuICAgICAgICAgICAgLy8gQW5ub3RhdGlvbiBSZWNvcmRcbiAgICAgICAgICAgIGNvbnN0IG91dEl0ZW06IEFubm90YXRpb25SZWNvcmQgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogY29sbGVjdGlvbkl0ZW0uJFR5cGUsXG4gICAgICAgICAgICAgICAgcHJvcGVydHlWYWx1ZXM6IFtdIGFzIGFueVtdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gQ291bGQgdmFsaWRhdGUga2V5cyBhbmQgdHlwZSBiYXNlZCBvbiAkVHlwZVxuICAgICAgICAgICAgT2JqZWN0LmtleXMoY29sbGVjdGlvbkl0ZW0pLmZvckVhY2goKGNvbGxlY3Rpb25LZXkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdHJpY3RlZEtleXMuaW5kZXhPZihjb2xsZWN0aW9uS2V5KSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBjb2xsZWN0aW9uSXRlbVtjb2xsZWN0aW9uS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgb3V0SXRlbS5wcm9wZXJ0eVZhbHVlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGNvbGxlY3Rpb25LZXksXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcmV2ZXJ0VmFsdWVUb1Jhd1R5cGUocmVmZXJlbmNlcywgdmFsdWUpIGFzIEV4cHJlc3Npb25cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uS2V5ID09PSAnYW5ub3RhdGlvbnMnICYmIE9iamVjdC5rZXlzKGNvbGxlY3Rpb25JdGVtW2NvbGxlY3Rpb25LZXldKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dEl0ZW0uYW5ub3RhdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgcmV2ZXJ0QW5ub3RhdGlvbnNUb1Jhd1R5cGUocmVmZXJlbmNlcywgY29sbGVjdGlvbkl0ZW1bY29sbGVjdGlvbktleV0sIG91dEl0ZW0uYW5ub3RhdGlvbnMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIG91dEl0ZW07XG4gICAgICAgIH0gZWxzZSBpZiAoY29sbGVjdGlvbkl0ZW0udHlwZSA9PT0gJ1Byb3BlcnR5UGF0aCcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1Byb3BlcnR5UGF0aCcsXG4gICAgICAgICAgICAgICAgUHJvcGVydHlQYXRoOiBjb2xsZWN0aW9uSXRlbS52YWx1ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uSXRlbS50eXBlID09PSAnQW5ub3RhdGlvblBhdGgnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdBbm5vdGF0aW9uUGF0aCcsXG4gICAgICAgICAgICAgICAgQW5ub3RhdGlvblBhdGg6IGNvbGxlY3Rpb25JdGVtLnZhbHVlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2UgaWYgKGNvbGxlY3Rpb25JdGVtLnR5cGUgPT09ICdOYXZpZ2F0aW9uUHJvcGVydHlQYXRoJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnTmF2aWdhdGlvblByb3BlcnR5UGF0aCcsXG4gICAgICAgICAgICAgICAgTmF2aWdhdGlvblByb3BlcnR5UGF0aDogY29sbGVjdGlvbkl0ZW0udmFsdWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBSZXZlcnQgYW4gYW5ub3RhdGlvbiB0ZXJtIHRvIGl0J3MgZ2VuZXJpYyBvciByYXcgZXF1aXZhbGVudC5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlcyB0aGUgcmVmZXJlbmNlIG9mIHRoZSBjdXJyZW50IGNvbnRleHRcbiAqIEBwYXJhbSBhbm5vdGF0aW9uIHRoZSBhbm5vdGF0aW9uIHRlcm0gdG8gcmV2ZXJ0XG4gKiBAcmV0dXJucyB0aGUgcmF3IGFubm90YXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJldmVydFRlcm1Ub0dlbmVyaWNUeXBlKHJlZmVyZW5jZXM6IFJlZmVyZW5jZVtdLCBhbm5vdGF0aW9uOiBBbm5vdGF0aW9uVGVybTxhbnk+KTogUmF3QW5ub3RhdGlvbiB7XG4gICAgY29uc3QgYmFzZUFubm90YXRpb246IFJhd0Fubm90YXRpb24gPSB7XG4gICAgICAgIHRlcm06IGFubm90YXRpb24udGVybSxcbiAgICAgICAgcXVhbGlmaWVyOiBhbm5vdGF0aW9uLnF1YWxpZmllclxuICAgIH07XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYW5ub3RhdGlvbikpIHtcbiAgICAgICAgLy8gQ29sbGVjdGlvblxuICAgICAgICBpZiAoYW5ub3RhdGlvbi5oYXNPd25Qcm9wZXJ0eSgnYW5ub3RhdGlvbnMnKSAmJiBPYmplY3Qua2V5cygoYW5ub3RhdGlvbiBhcyBhbnkpLmFubm90YXRpb25zKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBBbm5vdGF0aW9uIG9uIGEgY29sbGVjdGlvbiBpdHNlbGYsIG5vdCBzdXJlIHdoZW4gdGhhdCBoYXBwZW5zIGlmIGF0IGFsbFxuICAgICAgICAgICAgYmFzZUFubm90YXRpb24uYW5ub3RhdGlvbnMgPSBbXTtcbiAgICAgICAgICAgIHJldmVydEFubm90YXRpb25zVG9SYXdUeXBlKHJlZmVyZW5jZXMsIChhbm5vdGF0aW9uIGFzIGFueSkuYW5ub3RhdGlvbnMsIGJhc2VBbm5vdGF0aW9uLmFubm90YXRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uYmFzZUFubm90YXRpb24sXG4gICAgICAgICAgICBjb2xsZWN0aW9uOiBhbm5vdGF0aW9uLm1hcCgoYW5ubykgPT4gcmV2ZXJ0Q29sbGVjdGlvbkl0ZW1Ub1Jhd1R5cGUocmVmZXJlbmNlcywgYW5ubykpIGFzIGFueVtdXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChhbm5vdGF0aW9uLmhhc093blByb3BlcnR5KCckVHlwZScpKSB7XG4gICAgICAgIHJldHVybiB7IC4uLmJhc2VBbm5vdGF0aW9uLCByZWNvcmQ6IHJldmVydENvbGxlY3Rpb25JdGVtVG9SYXdUeXBlKHJlZmVyZW5jZXMsIGFubm90YXRpb24pIGFzIGFueSB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7IC4uLmJhc2VBbm5vdGF0aW9uLCB2YWx1ZTogcmV2ZXJ0VmFsdWVUb1Jhd1R5cGUocmVmZXJlbmNlcywgYW5ub3RhdGlvbikgfTtcbiAgICB9XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5NSk7XG4iLCIiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=
    return AnnotationConverter;
    },true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/common/AnnotationConverter", [],function(){var a;(function(){"use strict";var e={634:function(a,e,t){Object.defineProperty(e,"__esModule",{value:true});e.convert=void 0;const o=t(401);class i{constructor(a,e,t,o){this.path=a.Path;this.type="Path";this.$target=e;this.term=o;this.annotationsTerm=t}}function r(a){var e;const t={};if((e=a.schema.entityContainer)===null||e===void 0?void 0:e.fullyQualifiedName){t[a.schema.entityContainer.fullyQualifiedName]=a.schema.entityContainer}for(const e of a.schema.entitySets){t[e.fullyQualifiedName]=e}for(const e of a.schema.singletons){t[e.fullyQualifiedName]=e}for(const e of a.schema.actions){t[e.fullyQualifiedName]=e;if(e.isBound){const a=e.fullyQualifiedName.split("(")[0];if(!t[a]){t[a]={_type:"UnboundGenericAction",actions:[]}}t[a].actions.push(e);const o=e.fullyQualifiedName.split("(");t[`${o[1].split(")")[0]}/${o[0]}`]=e}for(const a of e.parameters){t[a.fullyQualifiedName]=a}}for(const e of a.schema.actionImports){t[e.fullyQualifiedName]=e}for(const e of a.schema.complexTypes){t[e.fullyQualifiedName]=e;for(const a of e.properties){t[a.fullyQualifiedName]=a}}for(const e of a.schema.typeDefinitions){t[e.fullyQualifiedName]=e}for(const e of a.schema.entityTypes){e.annotations={};t[e.fullyQualifiedName]=e;t[`Collection(${e.fullyQualifiedName})`]=e;for(const a of e.entityProperties){t[a.fullyQualifiedName]=a;const e=t[a.type];if((0,o.isComplexTypeDefinition)(e)){for(const o of e.properties){const e=Object.assign(o,{_type:"Property",fullyQualifiedName:a.fullyQualifiedName+"/"+o.name});t[e.fullyQualifiedName]=e}}}for(const a of e.navigationProperties){t[a.fullyQualifiedName]=a}}for(const e of Object.keys(a.schema.annotations)){for(const i of a.schema.annotations[e]){const e=(0,o.unalias)(a.references,i.target);i.annotations.forEach(i=>{let r=`${e}@${(0,o.unalias)(a.references,i.term)}`;if(i.qualifier){r+=`#${i.qualifier}`}t[r]=i;i.fullyQualifiedName=r})}}return t}function n(a,e){if(e.startsWith("@")){return a+(0,o.unalias)(o.defaultReferences,e)}else{return a+"/"+e}}const s={};let c=[];function l(a,e){if(!s[a]){s[a]=[e]}else{s[a].push(e)}}function u(a,e,t,o=false,i=false,r){let s;if(!t){return undefined}const c=[];if(e&&e._type==="Property"){e=a[e.fullyQualifiedName.split("/")[0]]}t=n(e.fullyQualifiedName,t);const p=t.split("/");const m=[];p.forEach(a=>{if(a.indexOf("@")!==-1){const[e,t]=a.split("@");m.push(e);m.push(`@${t}`)}else{m.push(a)}});let f=t;let g=e;const y=m.reduce((t,o)=>{if(o==="$Type"&&t._type==="EntityType"){return t}if(o==="$"&&t._type==="EntitySet"){return t}if((o==="@$ui5.overload"||o==="0")&&t._type==="Action"){return t}if(o.length===0){if(t&&(t._type==="EntitySet"||t._type==="Singleton")&&t.entityType){if(i){c.push(t)}t=t.entityType}if(t&&t._type==="NavigationProperty"&&t.targetType){if(i){c.push(t)}t=t.targetType}return t}if(i&&t!==null&&t!==undefined){c.push(t)}if(!t){f=o}else if((t._type==="EntitySet"||t._type==="Singleton")&&o==="$Type"){t=t.targetType;return t}else if((t._type==="EntitySet"||t._type==="Singleton")&&o==="$NavigationPropertyBinding"){t=t.navigationPropertyBinding;return t}else if((t._type==="EntitySet"||t._type==="Singleton")&&t.entityType){f=n(t.entityTypeName,o)}else if(t._type==="NavigationProperty"){f=n(t.fullyQualifiedName,o);if(!a[f]){f=n(t.targetTypeName,o)}}else if(t._type==="Property"){if(t.targetType){f=n(t.targetType.fullyQualifiedName,o)}else{f=n(t.fullyQualifiedName,o)}}else if(t._type==="Action"&&t.isBound){f=n(t.fullyQualifiedName,o);if(o==="$Parameter"){return t.parameters}if(!a[f]){f=n(t.sourceType,o)}}else if(t._type==="ActionParameter"){f=n(e.fullyQualifiedName.substring(0,e.fullyQualifiedName.lastIndexOf("/")),o);if(!a[f]){let t=e.fullyQualifiedName.lastIndexOf("/");if(t===-1){t=e.fullyQualifiedName.length}f=n(a[e.fullyQualifiedName.substring(0,t)].sourceType,o)}}else{f=n(t.fullyQualifiedName,o);if(o!=="name"&&t[o]!==undefined){return t[o]}else if(o==="$AnnotationPath"&&t.$target){const e=a[t.fullyQualifiedName.split("@")[0]];const o=u(a,e,t.value,false,true);o.visitedObjects.forEach(a=>{if(c.indexOf(a)===-1){c.push(a)}});return o.target}else if(o==="$Path"&&t.$target){g=c.concat().reverse().find(a=>a._type==="EntityType"||a._type==="EntitySet"||a._type==="Singleton"||a._type==="NavigationProperty");if(g){const e=u(a,g,t.path,false,true);e.visitedObjects.forEach(a=>{if(c.indexOf(a)===-1){c.push(a)}});return e.target}return t.$target}else if(o.startsWith("$Path")&&t.$target){const a=t.$target;f=n(a.fullyQualifiedName,o.substring(5))}else if(t.hasOwnProperty("$Type")&&!a[f]){const e=a[t.fullyQualifiedName.split("@")[0]];if(e){f=n(e.fullyQualifiedName,o)}}}return a[f]},null);if(!y){if(r){const a=v(r,e);s={message:"Unable to resolve the path expression: "+"\n"+t+"\n"+"\n"+"Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n"+"<Annotation Term = "+r+">"+"\n"+"<Record Type = "+a+">"+"\n"+"<AnnotationPath = "+t+">"};l(t,s)}else{s={message:"Unable to resolve the path expression: "+t+"\n"+"\n"+"Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n"+"<Annotation Term = "+p[0]+">"+"\n"+"<PropertyValue  Path= "+p[1]+">"};l(t,s)}}if(o){return f}if(i){return{visitedObjects:c,target:y}}return y}function p(a){return a.indexOf("@")!==-1}function m(a,e,t,r){if(a===undefined){return undefined}switch(a.type){case"String":return a.String;case"Int":return a.Int;case"Bool":return a.Bool;case"Decimal":return(0,o.Decimal)(a.Decimal);case"Date":return a.Date;case"EnumMember":return(0,o.alias)(r.rawMetadata.references,a.EnumMember);case"PropertyPath":return{type:"PropertyPath",value:a.PropertyPath,fullyQualifiedName:e,$target:u(t,r.currentTarget,a.PropertyPath,false,false,r.currentTerm)};case"NavigationPropertyPath":return{type:"NavigationPropertyPath",value:a.NavigationPropertyPath,fullyQualifiedName:e,$target:u(t,r.currentTarget,a.NavigationPropertyPath,false,false,r.currentTerm)};case"AnnotationPath":const n=u(t,r.currentTarget,(0,o.unalias)(r.rawMetadata.references,a.AnnotationPath),true,false,r.currentTerm);const s={type:"AnnotationPath",value:a.AnnotationPath,fullyQualifiedName:e,$target:n,annotationsTerm:r.currentTerm,term:"",path:""};r.unresolvedAnnotations.push({inline:false,toResolve:s});return s;case"Path":const c=u(t,r.currentTarget,a.Path,true,false,r.currentTerm);const l=new i(a,c,r.currentTerm,"");r.unresolvedAnnotations.push({inline:p(a.Path),toResolve:l});return l;case"Record":return y(a.Record,e,t,r);case"Collection":return d(a.Collection,e,t,r);case"Apply":case"Null":case"Not":case"Eq":case"Ne":case"Gt":case"Ge":case"Lt":case"Le":case"If":case"And":case"Or":default:return a}}function v(a,e,t){let i=o.TermToTypes[a];if(t){a=a.split(".").slice(0,-1).join(".")+"."+t;i=o.TermToTypes[a]}const r={isError:false,message:`The type of the record used within the term ${a} was not defined and was inferred as ${i}.\nHint: If possible, try to maintain the Type property for each Record.\n<Annotations Target="${e}">\n\t<Annotation Term="${a}">\n\t\t<Record>...</Record>\n\t</Annotation>\n</Annotations>`};l(e+"/"+a,r);return i}function f(a,e){return a.hasOwnProperty("Action")&&(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")}function g(a,e){let t;if(!a.type&&e.currentTerm){t=v(e.currentTerm,e.currentTarget.fullyQualifiedName,e.currentProperty)}else{t=(0,o.unalias)(e.rawMetadata.references,a.type)}return t}function y(a,e,t,o){const i=g(a,o);const r={$Type:i,fullyQualifiedName:e,annotations:{}};const n={};if(Array.isArray(a.annotations)){const t={target:e,annotations:a.annotations,__source:o.currentSource};o.additionalAnnotations.push(t)}if(a.propertyValues){a.propertyValues.forEach(a=>{var i;o.currentProperty=a.name;n[a.name]=m(a.value,`${e}/${a.name}`,t,o);if(Array.isArray(a.annotations)){const t={target:`${e}/${a.name}`,annotations:a.annotations,__source:o.currentSource};o.additionalAnnotations.push(t)}if(f(n,r)){n.ActionTarget=(i=o.currentTarget.actions)===null||i===void 0?void 0:i[n.Action];if(!n.ActionTarget){const a=t[n.Action];if(a===null||a===void 0?void 0:a.isBound){n.ActionTarget=a}else if(a){n.ActionTarget=a.action}}if(!n.ActionTarget){c.push({message:"Unable to resolve the action "+n.Action+" defined for "+r.fullyQualifiedName})}}});o.currentProperty=undefined}return Object.assign(r,n)}function O(a){let e=a.type;if(e===undefined&&a.length>0){const t=a[0];if(t.hasOwnProperty("PropertyPath")){e="PropertyPath"}else if(t.hasOwnProperty("Path")){e="Path"}else if(t.hasOwnProperty("AnnotationPath")){e="AnnotationPath"}else if(t.hasOwnProperty("NavigationPropertyPath")){e="NavigationPropertyPath"}else if(typeof t==="object"&&(t.hasOwnProperty("type")||t.hasOwnProperty("propertyValues"))){e="Record"}else if(typeof t==="string"){e="String"}}else if(e===undefined){e="EmptyCollection"}return e}function d(a,e,t,o){const r=O(a);switch(r){case"PropertyPath":return a.map((a,i)=>({type:"PropertyPath",value:a.PropertyPath,fullyQualifiedName:`${e}/${i}`,$target:u(t,o.currentTarget,a.PropertyPath,false,false,o.currentTerm)}));case"Path":return a.map(a=>{const e=u(t,o.currentTarget,a.Path,true,false,o.currentTerm);const r=new i(a,e,o.currentTerm,"");o.unresolvedAnnotations.push({inline:p(a.Path),toResolve:r});return r});case"AnnotationPath":return a.map((a,i)=>{const r=u(t,o.currentTarget,a.AnnotationPath,true,false,o.currentTerm);const n={type:"AnnotationPath",value:a.AnnotationPath,fullyQualifiedName:`${e}/${i}`,$target:r,annotationsTerm:o.currentTerm,term:"",path:""};o.unresolvedAnnotations.push({inline:false,toResolve:n});return n});case"NavigationPropertyPath":return a.map((a,i)=>({type:"NavigationPropertyPath",value:a.NavigationPropertyPath,fullyQualifiedName:`${e}/${i}`,$target:u(t,o.currentTarget,a.NavigationPropertyPath,false,false,o.currentTerm)}));case"Record":return a.map((a,i)=>y(a,`${e}/${i}`,t,o));case"Apply":case"Null":case"If":case"Eq":case"Ne":case"Lt":case"Gt":case"Le":case"Ge":case"Not":case"And":case"Or":return a.map(a=>a);case"String":return a.map(a=>{if(typeof a==="string"){return a}else if(a===undefined){return a}else{return a.String}});default:if(a.length===0){return[]}throw new Error("Unsupported case")}}function C(a,e,t){if(a.record){return y(a.record,a.fullyQualifiedName,e,t)}else if(a.collection===undefined){if(a.value){return m(a.value,a.fullyQualifiedName,e,t)}else{return true}}else if(a.collection){const o=d(a.collection,a.fullyQualifiedName,e,t);o.fullyQualifiedName=a.fullyQualifiedName;return o}else{throw new Error("Unsupported case")}}function b(a,e){return function(t,o){const i="";return u(e,a,t,false,o,i)}}function T(a,e,t,o){const i=e.find(e=>e.fullyQualifiedName===a.relationship);if(i){const e=i.associationEnd.find(e=>e.role===a.toRole);if(e){o.targetType=t[e.type];o.isCollection=e.multiplicity==="*"}}o.referentialConstraint=a.referentialConstraint||[]}function D(a,e,t){t.targetType=e[a.targetTypeName];t.partner=a.partner;t.isCollection=a.isCollection;t.containsTarget=a.containsTarget;t.referentialConstraint=a.referentialConstraint}function h(a){return!!a.targetTypeName}function V(a,e,t){return a.map(a=>{const o={_type:"NavigationProperty",name:a.name,fullyQualifiedName:a.fullyQualifiedName,isCollection:false,containsTarget:false,referentialConstraint:[],annotations:{},partner:"",targetType:undefined,targetTypeName:""};if(h(a)){D(a,t,o)}else{T(a,e,t,o)}if(o.targetType){o.targetTypeName=o.targetType.fullyQualifiedName}t[o.fullyQualifiedName]=o;return o})}function P(a,e,t){a.forEach(a=>{a.navigationProperties=V(a.navigationProperties,e,t);a.resolvePath=b(a,t)})}function I(a,e,t){e.forEach(e=>{if(!e.annotations){e.annotations={}}if(e.isBound){const o=t[e.sourceType];e.sourceEntityType=o;if(o){if(!o.actions){o.actions={}}o.actions[`${a}.${e.name}`]=e}e.returnEntityType=t[e.returnType]}})}function A(a,e){a.forEach(a=>{a.action=e[a.actionName]})}function S(a,e,t){a.forEach(a=>{a.entityType=e[a.entityTypeName];if(!a.entityType){a.entityType=e[(0,o.unalias)(t,a.entityTypeName)]}if(!a.annotations){a.annotations={}}if(!a.entityType.annotations){a.entityType.annotations={}}a.entityType.keys.forEach(a=>{a.isKey=true})})}function E(a,e,t){a.forEach(a=>{a.entityType=e[a.entityTypeName];if(!a.entityType){a.entityType=e[(0,o.unalias)(t,a.entityTypeName)]}if(!a.annotations){a.annotations={}}if(!a.entityType.annotations){a.entityType.annotations={}}a.entityType.keys.forEach(a=>{a.isKey=true})})}function N(a,e){function t(a){if(!a.annotations){a.annotations={}}try{if(a.type.indexOf("Edm")!==0){let o;if(a.type.startsWith("Collection")){const t=a.type.substring(11,a.type.length-1);o=e[t]}else{o=e[a.type]}if(o){a.targetType=o;if(o.properties){o.properties.forEach(t)}}}}catch(a){throw new Error("Property Type is not defined")}}a.forEach(a=>{a.entityProperties.forEach(t)})}function U(a,e,t){a.forEach(a=>{a.annotations={};a.properties.forEach(a=>{if(!a.annotations){a.annotations={}}});a.navigationProperties=V(a.navigationProperties,e,t)})}function R(a,e){const t=(0,o.alias)(a,e);const i=t.lastIndexOf(".");const r=t.substring(0,i);const n=t.substring(i+1);return[r,n]}function $(a,e){return function t(o,i=false){if(i){let t=o;if(!o.startsWith("/")){t=`/${o}`}const i=u(e,a,t,false,true);if(i.target){i.visitedObjects.push(i.target)}return{target:i.target,objectPath:i.visitedObjects}}const r=o.split("/");if(r.shift()!==""){throw new Error("Cannot deal with relative path")}const n=r.shift();const s=a.entitySets.find(a=>a.name===n);const c=a.singletons.find(a=>a.name===n);if(!s&&!c){return{target:a.entityContainer,objectPath:[a.entityContainer]}}if(r.length===0){return{target:s||c,objectPath:[a.entityContainer,s||c]}}else{const a=u(e,s||c,"/"+r.join("/"),false,true);if(a.target){a.visitedObjects.push(a.target)}return{target:a.target,objectPath:a.visitedObjects}}}}function Q(a,e){if(!a.annotations){a.annotations={}}if(!a.annotations[e]){a.annotations[e]={}}if(!a.annotations._annotations){a.annotations._annotations={}}}function M(a,e,t,i){const r=a.currentTarget;const n=r.fullyQualifiedName;e.annotations.forEach(s=>{var c,l;a.currentSource=s.__source||e.__source;const[u,p]=R(o.defaultReferences,s.term);Q(r,u);const m=`${p}${s.qualifier?"#"+s.qualifier:""}`;if(!i&&((l=(c=r.annotations)===null||c===void 0?void 0:c[u])===null||l===void 0?void 0:l[m])!==undefined){return}a.currentTerm=s.term;r.annotations[u][m]=C(s,t,a);switch(typeof r.annotations[u][m]){case"string":r.annotations[u][m]=new String(r.annotations[u][m]);break;case"boolean":r.annotations[u][m]=new Boolean(r.annotations[u][m]);break;default:break}if(r.annotations[u][m]!==null&&typeof r.annotations[u][m]==="object"&&!r.annotations[u][m].annotations){r.annotations[u][m].annotations={}}if(r.annotations[u][m]!==null&&typeof r.annotations[u][m]==="object"){r.annotations[u][m].term=(0,o.unalias)(o.defaultReferences,`${u}.${p}`);r.annotations[u][m].qualifier=s.qualifier;r.annotations[u][m].__source=a.currentSource}const v=`${n}@${(0,o.unalias)(o.defaultReferences,u+"."+m)}`;if(Array.isArray(s.annotations)){const e={target:v,annotations:s.annotations,__source:a.currentSource};a.additionalAnnotations.push(e)}else if(s.annotations&&!r.annotations[u][m].annotations){r.annotations[u][m].annotations=s.annotations}r.annotations._annotations[`${u}.${m}`]=r.annotations._annotations[(0,o.unalias)(o.defaultReferences,`${u}.${m}`)]=r.annotations[u][m];t[v]=r.annotations[u][m]})}function x(a,e){a.forEach(a=>{const t=a.toResolve;const o=t.$target;const i=e[o];const{annotationsTerm:r,annotationType:n}=t;delete t.annotationType;delete t.annotationsTerm;if(a.inline&&!(i instanceof String)){let a;for(a in t){delete t[a]}Object.assign(t,i)}else{t.$target=i}if(!i){t.targetString=o;if(r&&n){const a={message:"Unable to resolve the path expression: "+o+"\n"+"\n"+"Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n"+"<Annotation Term = "+r+">"+"\n"+"<Record Type = "+n+">"+"\n"+"<AnnotationPath = "+o+">"};l(o,a)}else{const a=t.term;const e=t.path;const i=o?o.split("/")[0]:o;const r={message:"Unable to resolve the path expression: "+o+"\n"+"\n"+"Hint: Check and correct the path values under the following structure in the metadata (annotation.xml file or CDS annotations for the application): \n\n"+"<Annotation Term = "+i+">"+"\n"+"<PropertyValue Property = "+a+"        Path= "+e+">"};l(o,r)}}})}function _(a){const e={};Object.keys(a.schema.annotations).forEach(t=>{a.schema.annotations[t].forEach(i=>{const r=(0,o.unalias)(a.references,i.target);i.__source=t;if(!e[r]){e[r]={annotations:i.annotations.concat(),target:r};e[r].__source=t}else{i.annotations.forEach(a=>{const o=e[r].annotations.findIndex(e=>e.term===a.term&&e.qualifier===a.qualifier);a.__source=t;if(o!==-1){e[r].annotations.splice(o,1,a)}else{e[r].annotations.push(a)}})}})});return e}function F(a){c=[];const e=r(a);P(a.schema.entityTypes,a.schema.associations,e);a.schema.entityContainer.annotations={};I(a.schema.namespace,a.schema.actions,e);A(a.schema.actionImports,e);S(a.schema.entitySets,e,a.references);E(a.schema.singletons,e,a.references);N(a.schema.entityTypes,e);U(a.schema.complexTypes,a.schema.associations,e);const t=[];const i=[];const n=_(a);Object.keys(n).forEach(o=>{const r=n[o];const s=e[o];if(!s&&(o===null||o===void 0?void 0:o.indexOf("@"))>0){i.push(r)}else if(s){let o=[s];let n=true;if(s._type==="UnboundGenericAction"){o=s.actions;n=false}o.forEach(o=>{const s={additionalAnnotations:i,currentSource:r.__source,currentTarget:o,currentTerm:"",rawMetadata:a,unresolvedAnnotations:t};M(s,r,e,n)})}});const l=[];i.forEach(i=>{const r=(0,o.unalias)(a.references,i.target);let[n,s]=r.split("@");const u=s.split("/");n=n+"@"+u[0];const p=u.slice(1).reduce((a,e)=>a===null||a===void 0?void 0:a[e],e[n]);if(!p||typeof p!=="object"){c.push({message:"The following annotation target was not found on the service "+r})}else{const o={additionalAnnotations:l,currentSource:i.__source,currentTarget:p,currentTerm:"",rawMetadata:a,unresolvedAnnotations:t};M(o,i,e,false)}});x(t,e);for(const a in s){c.push(s[a][0])}a.entitySets=a.schema.entitySets;const u=a.references.filter(a=>o.defaultReferences.find(e=>e.namespace===a.namespace)===undefined);const p={version:a.version,annotations:a.schema.annotations,namespace:a.schema.namespace,entityContainer:a.schema.entityContainer,actions:a.schema.actions,actionImports:a.schema.actionImports,entitySets:a.schema.entitySets,singletons:a.schema.singletons,entityTypes:a.schema.entityTypes,complexTypes:a.schema.complexTypes,typeDefinitions:a.schema.typeDefinitions,references:o.defaultReferences.concat(u),diagnostics:c.concat()};p.resolvePath=$(p,e);return p}e.convert=F},995:function(a,e,t){var o=this&&this.__createBinding||(Object.create?function(a,e,t,o){if(o===undefined)o=t;var i=Object.getOwnPropertyDescriptor(e,t);if(!i||("get"in i?!e.__esModule:i.writable||i.configurable)){i={enumerable:true,get:function(){return e[t]}}}Object.defineProperty(a,o,i)}:function(a,e,t,o){if(o===undefined)o=t;a[o]=e[t]});var i=this&&this.__exportStar||function(a,e){for(var t in a)if(t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t))o(e,a,t)};Object.defineProperty(e,"__esModule",{value:true});i(t(634),e);i(t(127),e);i(t(401),e)},401:function(a,e){Object.defineProperty(e,"__esModule",{value:true});e.Decimal=e.isComplexTypeDefinition=e.TermToTypes=e.unalias=e.alias=e.defaultReferences=void 0;e.defaultReferences=[{alias:"Capabilities",namespace:"Org.OData.Capabilities.V1",uri:""},{alias:"Aggregation",namespace:"Org.OData.Aggregation.V1",uri:""},{alias:"Validation",namespace:"Org.OData.Validation.V1",uri:""},{namespace:"Org.OData.Core.V1",alias:"Core",uri:""},{namespace:"Org.OData.Measures.V1",alias:"Measures",uri:""},{namespace:"com.sap.vocabularies.Common.v1",alias:"Common",uri:""},{namespace:"com.sap.vocabularies.UI.v1",alias:"UI",uri:""},{namespace:"com.sap.vocabularies.Session.v1",alias:"Session",uri:""},{namespace:"com.sap.vocabularies.Analytics.v1",alias:"Analytics",uri:""},{namespace:"com.sap.vocabularies.CodeList.v1",alias:"CodeList",uri:""},{namespace:"com.sap.vocabularies.PersonalData.v1",alias:"PersonalData",uri:""},{namespace:"com.sap.vocabularies.Communication.v1",alias:"Communication",uri:""},{namespace:"com.sap.vocabularies.HTML5.v1",alias:"HTML5",uri:""}];function t(a,e){if(!a.reverseReferenceMap){a.reverseReferenceMap=a.reduce((a,e)=>{a[e.namespace]=e;return a},{})}if(!e){return e}const o=e.lastIndexOf(".");const i=e.substring(0,o);const r=e.substring(o+1);const n=a.reverseReferenceMap[i];if(n){return`${n.alias}.${r}`}else if(e.indexOf("@")!==-1){const[o,...i]=e.split("@");return`${o}@${t(a,i.join("@"))}`}else{return e}}e.alias=t;function o(a,e){if(!a.referenceMap){a.referenceMap=a.reduce((a,e)=>{a[e.alias]=e;return a},{})}if(!e){return e}const[t,...i]=e.split(".");const r=a.referenceMap[t];if(r){return`${r.namespace}.${i.join(".")}`}else if(e.indexOf("@")!==-1){const[t,...i]=e.split("@");return`${t}@${o(a,i.join("@"))}`}else{return e}}e.unalias=o;var i;(function(a){a["Org.OData.Authorization.V1.SecuritySchemes"]="Org.OData.Authorization.V1.SecurityScheme";a["Org.OData.Authorization.V1.Authorizations"]="Org.OData.Authorization.V1.Authorization";a["Org.OData.Core.V1.Revisions"]="Org.OData.Core.V1.RevisionType";a["Org.OData.Core.V1.Links"]="Org.OData.Core.V1.Link";a["Org.OData.Core.V1.Example"]="Org.OData.Core.V1.ExampleValue";a["Org.OData.Core.V1.Messages"]="Org.OData.Core.V1.MessageType";a["Org.OData.Core.V1.ValueException"]="Org.OData.Core.V1.ValueExceptionType";a["Org.OData.Core.V1.ResourceException"]="Org.OData.Core.V1.ResourceExceptionType";a["Org.OData.Core.V1.DataModificationException"]="Org.OData.Core.V1.DataModificationExceptionType";a["Org.OData.Core.V1.IsLanguageDependent"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.DereferenceableIDs"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.ConventionalIDs"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.Permissions"]="Org.OData.Core.V1.Permission";a["Org.OData.Core.V1.DefaultNamespace"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.Immutable"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.Computed"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.ComputedDefaultValue"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.IsURL"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.IsMediaType"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.ContentDisposition"]="Org.OData.Core.V1.ContentDispositionType";a["Org.OData.Core.V1.OptimisticConcurrency"]="Edm.PropertyPath";a["Org.OData.Core.V1.AdditionalProperties"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.AutoExpand"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.AutoExpandReferences"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.MayImplement"]="Org.OData.Core.V1.QualifiedTypeName";a["Org.OData.Core.V1.Ordered"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.PositionalInsert"]="Org.OData.Core.V1.Tag";a["Org.OData.Core.V1.AlternateKeys"]="Org.OData.Core.V1.AlternateKey";a["Org.OData.Core.V1.OptionalParameter"]="Org.OData.Core.V1.OptionalParameterType";a["Org.OData.Core.V1.OperationAvailable"]="Edm.Boolean";a["Org.OData.Core.V1.SymbolicName"]="Org.OData.Core.V1.SimpleIdentifier";a["Org.OData.Capabilities.V1.ConformanceLevel"]="Org.OData.Capabilities.V1.ConformanceLevelType";a["Org.OData.Capabilities.V1.AsynchronousRequestsSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.BatchContinueOnErrorSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.IsolationSupported"]="Org.OData.Capabilities.V1.IsolationLevel";a["Org.OData.Capabilities.V1.CrossJoinSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.CallbackSupported"]="Org.OData.Capabilities.V1.CallbackType";a["Org.OData.Capabilities.V1.ChangeTracking"]="Org.OData.Capabilities.V1.ChangeTrackingType";a["Org.OData.Capabilities.V1.CountRestrictions"]="Org.OData.Capabilities.V1.CountRestrictionsType";a["Org.OData.Capabilities.V1.NavigationRestrictions"]="Org.OData.Capabilities.V1.NavigationRestrictionsType";a["Org.OData.Capabilities.V1.IndexableByKey"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.TopSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.SkipSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.ComputeSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.SelectSupport"]="Org.OData.Capabilities.V1.SelectSupportType";a["Org.OData.Capabilities.V1.BatchSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.BatchSupport"]="Org.OData.Capabilities.V1.BatchSupportType";a["Org.OData.Capabilities.V1.FilterRestrictions"]="Org.OData.Capabilities.V1.FilterRestrictionsType";a["Org.OData.Capabilities.V1.SortRestrictions"]="Org.OData.Capabilities.V1.SortRestrictionsType";a["Org.OData.Capabilities.V1.ExpandRestrictions"]="Org.OData.Capabilities.V1.ExpandRestrictionsType";a["Org.OData.Capabilities.V1.SearchRestrictions"]="Org.OData.Capabilities.V1.SearchRestrictionsType";a["Org.OData.Capabilities.V1.KeyAsSegmentSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.QuerySegmentSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.InsertRestrictions"]="Org.OData.Capabilities.V1.InsertRestrictionsType";a["Org.OData.Capabilities.V1.DeepInsertSupport"]="Org.OData.Capabilities.V1.DeepInsertSupportType";a["Org.OData.Capabilities.V1.UpdateRestrictions"]="Org.OData.Capabilities.V1.UpdateRestrictionsType";a["Org.OData.Capabilities.V1.DeepUpdateSupport"]="Org.OData.Capabilities.V1.DeepUpdateSupportType";a["Org.OData.Capabilities.V1.DeleteRestrictions"]="Org.OData.Capabilities.V1.DeleteRestrictionsType";a["Org.OData.Capabilities.V1.CollectionPropertyRestrictions"]="Org.OData.Capabilities.V1.CollectionPropertyRestrictionsType";a["Org.OData.Capabilities.V1.OperationRestrictions"]="Org.OData.Capabilities.V1.OperationRestrictionsType";a["Org.OData.Capabilities.V1.AnnotationValuesInQuerySupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Capabilities.V1.ModificationQueryOptions"]="Org.OData.Capabilities.V1.ModificationQueryOptionsType";a["Org.OData.Capabilities.V1.ReadRestrictions"]="Org.OData.Capabilities.V1.ReadRestrictionsType";a["Org.OData.Capabilities.V1.CustomHeaders"]="Org.OData.Capabilities.V1.CustomParameter";a["Org.OData.Capabilities.V1.CustomQueryOptions"]="Org.OData.Capabilities.V1.CustomParameter";a["Org.OData.Capabilities.V1.MediaLocationUpdateSupported"]="Org.OData.Core.V1.Tag";a["Org.OData.Aggregation.V1.ApplySupported"]="Org.OData.Aggregation.V1.ApplySupportedType";a["Org.OData.Aggregation.V1.Groupable"]="Org.OData.Core.V1.Tag";a["Org.OData.Aggregation.V1.Aggregatable"]="Org.OData.Core.V1.Tag";a["Org.OData.Aggregation.V1.ContextDefiningProperties"]="Edm.PropertyPath";a["Org.OData.Aggregation.V1.LeveledHierarchy"]="Edm.PropertyPath";a["Org.OData.Aggregation.V1.RecursiveHierarchy"]="Org.OData.Aggregation.V1.RecursiveHierarchyType";a["Org.OData.Aggregation.V1.AvailableOnAggregates"]="Org.OData.Aggregation.V1.AvailableOnAggregatesType";a["Org.OData.Validation.V1.Minimum"]="Edm.PrimitiveType";a["Org.OData.Validation.V1.Maximum"]="Edm.PrimitiveType";a["Org.OData.Validation.V1.Exclusive"]="Org.OData.Core.V1.Tag";a["Org.OData.Validation.V1.AllowedValues"]="Org.OData.Validation.V1.AllowedValue";a["Org.OData.Validation.V1.MultipleOf"]="Edm.Decimal";a["Org.OData.Validation.V1.Constraint"]="Org.OData.Validation.V1.ConstraintType";a["Org.OData.Validation.V1.ItemsOf"]="Org.OData.Validation.V1.ItemsOfType";a["Org.OData.Validation.V1.OpenPropertyTypeConstraint"]="Org.OData.Core.V1.QualifiedTypeName";a["Org.OData.Validation.V1.DerivedTypeConstraint"]="Org.OData.Core.V1.QualifiedTypeName";a["Org.OData.Validation.V1.AllowedTerms"]="Org.OData.Core.V1.QualifiedTermName";a["Org.OData.Validation.V1.ApplicableTerms"]="Org.OData.Core.V1.QualifiedTermName";a["Org.OData.Validation.V1.MaxItems"]="Edm.Int64";a["Org.OData.Validation.V1.MinItems"]="Edm.Int64";a["Org.OData.Measures.V1.Scale"]="Edm.Byte";a["Org.OData.Measures.V1.DurationGranularity"]="Org.OData.Measures.V1.DurationGranularityType";a["com.sap.vocabularies.Analytics.v1.Dimension"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Analytics.v1.Measure"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Analytics.v1.AccumulativeMeasure"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Analytics.v1.RolledUpPropertyCount"]="Edm.Int16";a["com.sap.vocabularies.Analytics.v1.PlanningAction"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Analytics.v1.AggregatedProperties"]="com.sap.vocabularies.Analytics.v1.AggregatedPropertyType";a["com.sap.vocabularies.Common.v1.ServiceVersion"]="Edm.Int32";a["com.sap.vocabularies.Common.v1.ServiceSchemaVersion"]="Edm.Int32";a["com.sap.vocabularies.Common.v1.TextFor"]="Edm.PropertyPath";a["com.sap.vocabularies.Common.v1.IsLanguageIdentifier"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.TextFormat"]="com.sap.vocabularies.Common.v1.TextFormatType";a["com.sap.vocabularies.Common.v1.IsDigitSequence"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsUpperCase"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCurrency"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsUnit"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.UnitSpecificScale"]="Edm.PrimitiveType";a["com.sap.vocabularies.Common.v1.UnitSpecificPrecision"]="Edm.PrimitiveType";a["com.sap.vocabularies.Common.v1.SecondaryKey"]="Edm.PropertyPath";a["com.sap.vocabularies.Common.v1.MinOccurs"]="Edm.Int64";a["com.sap.vocabularies.Common.v1.MaxOccurs"]="Edm.Int64";a["com.sap.vocabularies.Common.v1.AssociationEntity"]="Edm.NavigationPropertyPath";a["com.sap.vocabularies.Common.v1.DerivedNavigation"]="Edm.NavigationPropertyPath";a["com.sap.vocabularies.Common.v1.Masked"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.MaskedAlways"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.SemanticObjectMapping"]="com.sap.vocabularies.Common.v1.SemanticObjectMappingType";a["com.sap.vocabularies.Common.v1.IsInstanceAnnotation"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.FilterExpressionRestrictions"]="com.sap.vocabularies.Common.v1.FilterExpressionRestrictionType";a["com.sap.vocabularies.Common.v1.FieldControl"]="com.sap.vocabularies.Common.v1.FieldControlType";a["com.sap.vocabularies.Common.v1.Application"]="com.sap.vocabularies.Common.v1.ApplicationType";a["com.sap.vocabularies.Common.v1.Timestamp"]="Edm.DateTimeOffset";a["com.sap.vocabularies.Common.v1.ErrorResolution"]="com.sap.vocabularies.Common.v1.ErrorResolutionType";a["com.sap.vocabularies.Common.v1.Messages"]="Edm.ComplexType";a["com.sap.vocabularies.Common.v1.numericSeverity"]="com.sap.vocabularies.Common.v1.NumericMessageSeverityType";a["com.sap.vocabularies.Common.v1.MaximumNumericMessageSeverity"]="com.sap.vocabularies.Common.v1.NumericMessageSeverityType";a["com.sap.vocabularies.Common.v1.IsActionCritical"]="Edm.Boolean";a["com.sap.vocabularies.Common.v1.Attributes"]="Edm.PropertyPath";a["com.sap.vocabularies.Common.v1.RelatedRecursiveHierarchy"]="Edm.AnnotationPath";a["com.sap.vocabularies.Common.v1.Interval"]="com.sap.vocabularies.Common.v1.IntervalType";a["com.sap.vocabularies.Common.v1.ResultContext"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.WeakReferentialConstraint"]="com.sap.vocabularies.Common.v1.WeakReferentialConstraintType";a["com.sap.vocabularies.Common.v1.IsNaturalPerson"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.ValueList"]="com.sap.vocabularies.Common.v1.ValueListType";a["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"]="com.sap.vocabularies.Common.v1.SimpleIdentifier";a["com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.ValueListMapping"]="com.sap.vocabularies.Common.v1.ValueListMappingType";a["com.sap.vocabularies.Common.v1.IsCalendarYear"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarHalfyear"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarQuarter"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarMonth"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarWeek"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsDayOfCalendarMonth"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsDayOfCalendarYear"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarYearHalfyear"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarYearQuarter"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarYearMonth"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarYearWeek"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsCalendarDate"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalYear"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalPeriod"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalQuarter"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalWeek"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalYearWeek"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.IsFiscalYearVariant"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.MutuallyExclusiveTerm"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Common.v1.DraftRoot"]="com.sap.vocabularies.Common.v1.DraftRootType";a["com.sap.vocabularies.Common.v1.DraftNode"]="com.sap.vocabularies.Common.v1.DraftNodeType";a["com.sap.vocabularies.Common.v1.DraftActivationVia"]="com.sap.vocabularies.Common.v1.SimpleIdentifier";a["com.sap.vocabularies.Common.v1.EditableFieldFor"]="Edm.PropertyPath";a["com.sap.vocabularies.Common.v1.SemanticKey"]="Edm.PropertyPath";a["com.sap.vocabularies.Common.v1.SideEffects"]="com.sap.vocabularies.Common.v1.SideEffectsType";a["com.sap.vocabularies.Common.v1.DefaultValuesFunction"]="com.sap.vocabularies.Common.v1.QualifiedName";a["com.sap.vocabularies.Common.v1.FilterDefaultValue"]="Edm.PrimitiveType";a["com.sap.vocabularies.Common.v1.FilterDefaultValueHigh"]="Edm.PrimitiveType";a["com.sap.vocabularies.Common.v1.SortOrder"]="com.sap.vocabularies.Common.v1.SortOrderType";a["com.sap.vocabularies.Common.v1.RecursiveHierarchy"]="com.sap.vocabularies.Common.v1.RecursiveHierarchyType";a["com.sap.vocabularies.Common.v1.CreatedAt"]="Edm.DateTimeOffset";a["com.sap.vocabularies.Common.v1.CreatedBy"]="com.sap.vocabularies.Common.v1.UserID";a["com.sap.vocabularies.Common.v1.ChangedAt"]="Edm.DateTimeOffset";a["com.sap.vocabularies.Common.v1.ChangedBy"]="com.sap.vocabularies.Common.v1.UserID";a["com.sap.vocabularies.Common.v1.ApplyMultiUnitBehaviorForSortingAndFiltering"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.CodeList.v1.CurrencyCodes"]="com.sap.vocabularies.CodeList.v1.CodeListSource";a["com.sap.vocabularies.CodeList.v1.UnitsOfMeasure"]="com.sap.vocabularies.CodeList.v1.CodeListSource";a["com.sap.vocabularies.CodeList.v1.StandardCode"]="Edm.PropertyPath";a["com.sap.vocabularies.CodeList.v1.ExternalCode"]="Edm.PropertyPath";a["com.sap.vocabularies.CodeList.v1.IsConfigurationDeprecationCode"]="Edm.Boolean";a["com.sap.vocabularies.Communication.v1.Contact"]="com.sap.vocabularies.Communication.v1.ContactType";a["com.sap.vocabularies.Communication.v1.Address"]="com.sap.vocabularies.Communication.v1.AddressType";a["com.sap.vocabularies.Communication.v1.IsEmailAddress"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Communication.v1.IsPhoneNumber"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Communication.v1.Event"]="com.sap.vocabularies.Communication.v1.EventData";a["com.sap.vocabularies.Communication.v1.Task"]="com.sap.vocabularies.Communication.v1.TaskData";a["com.sap.vocabularies.Communication.v1.Message"]="com.sap.vocabularies.Communication.v1.MessageData";a["com.sap.vocabularies.Hierarchy.v1.RecursiveHierarchy"]="com.sap.vocabularies.Hierarchy.v1.RecursiveHierarchyType";a["com.sap.vocabularies.PersonalData.v1.EntitySemantics"]="com.sap.vocabularies.PersonalData.v1.EntitySemanticsType";a["com.sap.vocabularies.PersonalData.v1.FieldSemantics"]="com.sap.vocabularies.PersonalData.v1.FieldSemanticsType";a["com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.Session.v1.StickySessionSupported"]="com.sap.vocabularies.Session.v1.StickySessionSupportedType";a["com.sap.vocabularies.UI.v1.HeaderInfo"]="com.sap.vocabularies.UI.v1.HeaderInfoType";a["com.sap.vocabularies.UI.v1.Identification"]="com.sap.vocabularies.UI.v1.DataFieldAbstract";a["com.sap.vocabularies.UI.v1.Badge"]="com.sap.vocabularies.UI.v1.BadgeType";a["com.sap.vocabularies.UI.v1.LineItem"]="com.sap.vocabularies.UI.v1.DataFieldAbstract";a["com.sap.vocabularies.UI.v1.StatusInfo"]="com.sap.vocabularies.UI.v1.DataFieldAbstract";a["com.sap.vocabularies.UI.v1.FieldGroup"]="com.sap.vocabularies.UI.v1.FieldGroupType";a["com.sap.vocabularies.UI.v1.ConnectedFields"]="com.sap.vocabularies.UI.v1.ConnectedFieldsType";a["com.sap.vocabularies.UI.v1.GeoLocations"]="com.sap.vocabularies.UI.v1.GeoLocationType";a["com.sap.vocabularies.UI.v1.GeoLocation"]="com.sap.vocabularies.UI.v1.GeoLocationType";a["com.sap.vocabularies.UI.v1.Contacts"]="Edm.AnnotationPath";a["com.sap.vocabularies.UI.v1.MediaResource"]="com.sap.vocabularies.UI.v1.MediaResourceType";a["com.sap.vocabularies.UI.v1.DataPoint"]="com.sap.vocabularies.UI.v1.DataPointType";a["com.sap.vocabularies.UI.v1.KPI"]="com.sap.vocabularies.UI.v1.KPIType";a["com.sap.vocabularies.UI.v1.Chart"]="com.sap.vocabularies.UI.v1.ChartDefinitionType";a["com.sap.vocabularies.UI.v1.ValueCriticality"]="com.sap.vocabularies.UI.v1.ValueCriticalityType";a["com.sap.vocabularies.UI.v1.CriticalityLabels"]="com.sap.vocabularies.UI.v1.CriticalityLabelType";a["com.sap.vocabularies.UI.v1.SelectionFields"]="Edm.PropertyPath";a["com.sap.vocabularies.UI.v1.Facets"]="com.sap.vocabularies.UI.v1.Facet";a["com.sap.vocabularies.UI.v1.HeaderFacets"]="com.sap.vocabularies.UI.v1.Facet";a["com.sap.vocabularies.UI.v1.QuickViewFacets"]="com.sap.vocabularies.UI.v1.Facet";a["com.sap.vocabularies.UI.v1.QuickCreateFacets"]="com.sap.vocabularies.UI.v1.Facet";a["com.sap.vocabularies.UI.v1.FilterFacets"]="com.sap.vocabularies.UI.v1.ReferenceFacet";a["com.sap.vocabularies.UI.v1.SelectionPresentationVariant"]="com.sap.vocabularies.UI.v1.SelectionPresentationVariantType";a["com.sap.vocabularies.UI.v1.PresentationVariant"]="com.sap.vocabularies.UI.v1.PresentationVariantType";a["com.sap.vocabularies.UI.v1.SelectionVariant"]="com.sap.vocabularies.UI.v1.SelectionVariantType";a["com.sap.vocabularies.UI.v1.ThingPerspective"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.IsSummary"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.PartOfPreview"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.Map"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.Gallery"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.IsImageURL"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.IsImage"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.MultiLineText"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.TextArrangement"]="com.sap.vocabularies.UI.v1.TextArrangementType";a["com.sap.vocabularies.UI.v1.Importance"]="com.sap.vocabularies.UI.v1.ImportanceType";a["com.sap.vocabularies.UI.v1.Hidden"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.CreateHidden"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.UpdateHidden"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.DeleteHidden"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.HiddenFilter"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.DataFieldDefault"]="com.sap.vocabularies.UI.v1.DataFieldAbstract";a["com.sap.vocabularies.UI.v1.Criticality"]="com.sap.vocabularies.UI.v1.CriticalityType";a["com.sap.vocabularies.UI.v1.CriticalityCalculation"]="com.sap.vocabularies.UI.v1.CriticalityCalculationType";a["com.sap.vocabularies.UI.v1.Emphasized"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.UI.v1.OrderBy"]="Edm.PropertyPath";a["com.sap.vocabularies.UI.v1.ParameterDefaultValue"]="Edm.PrimitiveType";a["com.sap.vocabularies.UI.v1.RecommendationState"]="com.sap.vocabularies.UI.v1.RecommendationStateType";a["com.sap.vocabularies.UI.v1.RecommendationList"]="com.sap.vocabularies.UI.v1.RecommendationListType";a["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]="Org.OData.Core.V1.Tag";a["com.sap.vocabularies.HTML5.v1.CssDefaults"]="com.sap.vocabularies.HTML5.v1.CssDefaultsType"})(i=e.TermToTypes||(e.TermToTypes={}));function r(a){return!!a&&a._type==="ComplexType"&&!!a.properties}e.isComplexTypeDefinition=r;function n(a){return{isDecimal(){return true},valueOf(){return a},toString(){return a.toString()}}}e.Decimal=n},127:function(a,e,t){Object.defineProperty(e,"__esModule",{value:true});e.revertTermToGenericType=void 0;const o=t(401);function i(a,e){var t,o,i,r,n,s;let l;if(Array.isArray(e)){l={type:"Collection",Collection:e.map(e=>c(a,e))}}else if((t=e.isDecimal)===null||t===void 0?void 0:t.call(e)){l={type:"Decimal",Decimal:e.valueOf()}}else if((o=e.isString)===null||o===void 0?void 0:o.call(e)){const t=e.valueOf().split(".");if(t.length>1&&a.find(a=>a.alias===t[0])){l={type:"EnumMember",EnumMember:e.valueOf()}}else{l={type:"String",String:e.valueOf()}}}else if((i=e.isInt)===null||i===void 0?void 0:i.call(e)){l={type:"Int",Int:e.valueOf()}}else if((r=e.isFloat)===null||r===void 0?void 0:r.call(e)){l={type:"Float",Float:e.valueOf()}}else if((n=e.isDate)===null||n===void 0?void 0:n.call(e)){l={type:"Date",Date:e.valueOf()}}else if((s=e.isBoolean)===null||s===void 0?void 0:s.call(e)){l={type:"Bool",Bool:e.valueOf()==="true"}}else if(e.type==="Path"){l={type:"Path",Path:e.path}}else if(e.type==="AnnotationPath"){l={type:"AnnotationPath",AnnotationPath:e.value}}else if(e.type==="Apply"){l={type:"Apply",Apply:e.Apply}}else if(e.type==="Null"){l={type:"Null"}}else if(e.type==="PropertyPath"){l={type:"PropertyPath",PropertyPath:e.value}}else if(e.type==="NavigationPropertyPath"){l={type:"NavigationPropertyPath",NavigationPropertyPath:e.value}}else if(Object.prototype.hasOwnProperty.call(e,"$Type")){l={type:"Record",Record:c(a,e)}}return l}function r(a,e){let t;const o=e===null||e===void 0?void 0:e.constructor.name;switch(o){case"String":case"string":const o=e.toString().split(".");if(o.length>1&&a.find(a=>a.alias===o[0])){t={type:"EnumMember",EnumMember:e.toString()}}else{t={type:"String",String:e.toString()}}break;case"Boolean":case"boolean":t={type:"Bool",Bool:e.valueOf()};break;case"Number":case"number":if(e.toString()===e.toFixed()){t={type:"Int",Int:e.valueOf()}}else{t={type:"Decimal",Decimal:e.valueOf()}}break;case"object":default:t=i(a,e);break}return t}const n=["$Type","term","__source","qualifier","ActionTarget","fullyQualifiedName","annotations"];function s(a,e,t){Object.keys(e).filter(a=>a!=="_annotations").forEach(i=>{Object.keys(e[i]).forEach(r=>{const n=l(a,e[i][r]);if(!n.term){const e=(0,o.unalias)(a,`${i}.${r}`);if(e){const a=e.split("#");n.term=a[0];if(a.length>1){n.qualifier=a[1]}}}t.push(n)})})}function c(a,e){if(typeof e==="string"){return e}else if(typeof e==="object"){if(e.hasOwnProperty("$Type")){const t={type:e.$Type,propertyValues:[]};Object.keys(e).forEach(o=>{if(n.indexOf(o)===-1){const i=e[o];t.propertyValues.push({name:o,value:r(a,i)})}else if(o==="annotations"&&Object.keys(e[o]).length>0){t.annotations=[];s(a,e[o],t.annotations)}});return t}else if(e.type==="PropertyPath"){return{type:"PropertyPath",PropertyPath:e.value}}else if(e.type==="AnnotationPath"){return{type:"AnnotationPath",AnnotationPath:e.value}}else if(e.type==="NavigationPropertyPath"){return{type:"NavigationPropertyPath",NavigationPropertyPath:e.value}}}return undefined}function l(a,e){const t={term:e.term,qualifier:e.qualifier};if(Array.isArray(e)){if(e.hasOwnProperty("annotations")&&Object.keys(e.annotations).length>0){t.annotations=[];s(a,e.annotations,t.annotations)}return{...t,collection:e.map(e=>c(a,e))}}else if(e.hasOwnProperty("$Type")){return{...t,record:c(a,e)}}else{return{...t,value:r(a,e)}}}e.revertTermToGenericType=l}};var t={};function o(a){var i=t[a];if(i!==undefined){return i.exports}var r=t[a]={exports:{}};e[a].call(r.exports,r,r.exports,o);return r.exports}var i=o(995);a=i})();return a},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Action-dbg", ["sap/base/Log", "sap/fe/core/converters/helpers/BindingHelper", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/converters/helpers/ID", "sap/fe/core/converters/ManifestSettings", "sap/fe/core/formatters/FPMFormatter", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/StableIdHelper"], function (Log, BindingHelper, ConfigurableObject, ID, ManifestSettings, fpmFormatter, BindingToolkit, StableIdHelper) {
  "use strict";

  var _exports = {};
  var replaceSpecialChars = StableIdHelper.replaceSpecialChars;
  var resolveBindingString = BindingToolkit.resolveBindingString;
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var isConstant = BindingToolkit.isConstant;
  var ifElse = BindingToolkit.ifElse;
  var greaterOrEqual = BindingToolkit.greaterOrEqual;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var formatResult = BindingToolkit.formatResult;
  var equal = BindingToolkit.equal;
  var compileExpression = BindingToolkit.compileExpression;
  var and = BindingToolkit.and;
  var ActionType = ManifestSettings.ActionType;
  var getCustomActionID = ID.getCustomActionID;
  var Placement = ConfigurableObject.Placement;
  var bindingContextPathVisitor = BindingHelper.bindingContextPathVisitor;
  let ButtonType;
  (function (ButtonType) {
    ButtonType["Accept"] = "Accept";
    ButtonType["Attention"] = "Attention";
    ButtonType["Back"] = "Back";
    ButtonType["Critical"] = "Critical";
    ButtonType["Default"] = "Default";
    ButtonType["Emphasized"] = "Emphasized";
    ButtonType["Ghost"] = "Ghost";
    ButtonType["Negative"] = "Negative";
    ButtonType["Neutral"] = "Neutral";
    ButtonType["Reject"] = "Reject";
    ButtonType["Success"] = "Success";
    ButtonType["Transparent"] = "Transparent";
    ButtonType["Unstyled"] = "Unstyled";
    ButtonType["Up"] = "Up";
  })(ButtonType || (ButtonType = {}));
  _exports.ButtonType = ButtonType;
  /**
   * Maps an action by its key, based on the given annotation actions and manifest configuration. The result already represents the
   * merged action from both configuration sources.
   *
   * This function also returns an indication whether the action can be a menu item, saying whether it is visible or of a specific type
   * that allows this.
   *
   * @param manifestActions Actions defined in the manifest
   * @param annotationActions Actions defined through annotations
   * @param hiddenActions Actions that are configured as hidden (additional to the visible property)
   * @param actionKey Key to look up
   * @returns Merged action and indicator whether it can be a menu item
   */
  function mapActionByKey(manifestActions, annotationActions, hiddenActions, actionKey) {
    const annotationAction = annotationActions.find(action => action.key === actionKey);
    const manifestAction = manifestActions[actionKey];
    const resultAction = {
      ...(annotationAction ?? manifestAction)
    };

    // Annotation action and manifest configuration already has to be merged here as insertCustomElements only considers top-level actions
    if (annotationAction) {
      // If enabled or visible is not set in the manifest, use the annotation value and hence do not overwrite
      resultAction.enabled = (manifestAction === null || manifestAction === void 0 ? void 0 : manifestAction.enabled) ?? annotationAction.enabled;
      resultAction.visible = (manifestAction === null || manifestAction === void 0 ? void 0 : manifestAction.visible) ?? annotationAction.visible;
      for (const prop in manifestAction || {}) {
        if (!annotationAction[prop] && prop !== "menu") {
          resultAction[prop] = manifestAction[prop];
        }
      }
    }
    const canBeMenuItem = ((resultAction === null || resultAction === void 0 ? void 0 : resultAction.visible) || (resultAction === null || resultAction === void 0 ? void 0 : resultAction.type) === ActionType.DataFieldForAction || (resultAction === null || resultAction === void 0 ? void 0 : resultAction.type) === ActionType.DataFieldForIntentBasedNavigation) && !hiddenActions.find(hiddenAction => hiddenAction.key === (resultAction === null || resultAction === void 0 ? void 0 : resultAction.key));
    return {
      action: resultAction,
      canBeMenuItem
    };
  }

  /**
   * Map the default action key of a menu to its actual action configuration and identify whether this default action is a command.
   *
   * @param menuAction Menu action to map the default action for
   * @param manifestActions Actions defined in the manifest
   * @param annotationActions Actions defined through annotations
   * @param commandActions Array of command actions to push the default action to if applicable
   * @param hiddenActions Actions that are configured as hidden (additional to the visible property)
   */
  function mapMenuDefaultAction(menuAction, manifestActions, annotationActions, commandActions, hiddenActions) {
    const {
      action,
      canBeMenuItem
    } = mapActionByKey(manifestActions, annotationActions, hiddenActions, menuAction.defaultAction);
    if (canBeMenuItem) {
      menuAction.defaultAction = action;
    }
    if (action.command) {
      commandActions[action.key] = action;
    }
  }

  /**
   * Map the menu item keys of a menu to their actual action configurations and identify whether they are commands.
   *
   * @param menuAction Menu action to map the menu items for
   * @param manifestActions Actions defined in the manifest
   * @param annotationActions Actions defined through annotations
   * @param commandActions Array of command actions to push the menu item actions to if applicable
   * @param hiddenActions Actions that are configured as hidden (additional to the visible property)
   */
  function mapMenuItems(menuAction, manifestActions, annotationActions, commandActions, hiddenActions) {
    const mappedMenuItems = [];
    for (const menuItemKey of menuAction.menu ?? []) {
      const {
        action,
        canBeMenuItem
      } = mapActionByKey(manifestActions, annotationActions, hiddenActions, menuItemKey);
      if (canBeMenuItem) {
        mappedMenuItems.push(action);
      }
      if (action.command) {
        commandActions[menuItemKey] = action;
      }
    }
    menuAction.menu = mappedMenuItems;

    // If the menu is set to invisible, it should be invisible, otherwise the visibility should be calculated from the items
    const visibleExpressions = mappedMenuItems.map(menuItem => resolveBindingString(menuItem.visible, "boolean"));
    menuAction.visible = compileExpression(and(resolveBindingString(menuAction.visible, "boolean"), or(...visibleExpressions)));
  }

  /**
   * Transforms the flat collection of actions into a nested structures of menus. The result is a record of actions that are either menus or
   * ones that do not appear in menus as menu items. It also returns a list of actions that have an assigned command.
   *
   * Note that menu items are already the merged result of annotation actions and their manifest configuration, as {@link insertCustomElements}
   * only considers root-level actions.
   *
   * @param manifestActions Actions defined in the manifest
   * @param annotationActions Actions defined through annotations
   * @param hiddenActions Actions that are configured as hidden (additional to the visible property)
   * @returns The transformed actions from the manifest and a list of command actions
   */
  function transformMenuActionsAndIdentifyCommands(manifestActions, annotationActions, hiddenActions) {
    const allActions = {};
    const actionKeysToDelete = [];
    const commandActions = {};
    for (const actionKey in manifestActions) {
      const manifestAction = manifestActions[actionKey];
      if (manifestAction.defaultAction !== undefined) {
        mapMenuDefaultAction(manifestAction, manifestActions, annotationActions, commandActions, hiddenActions);
      }
      if (manifestAction.type === ActionType.Menu) {
        var _manifestAction$menu;
        // Menu items should not appear as top-level actions themselves
        actionKeysToDelete.push(...manifestAction.menu);
        mapMenuItems(manifestAction, manifestActions, annotationActions, commandActions, hiddenActions);

        // Menu has no visible items, so remove it
        if (!((_manifestAction$menu = manifestAction.menu) !== null && _manifestAction$menu !== void 0 && _manifestAction$menu.length)) {
          actionKeysToDelete.push(manifestAction.key);
        }
      }
      if (manifestAction.command) {
        commandActions[actionKey] = manifestAction;
      }
      allActions[actionKey] = manifestAction;
    }
    actionKeysToDelete.forEach(actionKey => delete allActions[actionKey]);
    return {
      actions: allActions,
      commandActions: commandActions
    };
  }

  /**
   * Gets the binding expression for the enablement of a manifest action.
   *
   * @param manifestAction The action configured in the manifest
   * @param isAnnotationAction Whether the action, defined in manifest, corresponds to an existing annotation action.
   * @param converterContext
   * @returns Determined property value for the enablement
   */
  const _getManifestEnabled = function (manifestAction, isAnnotationAction, converterContext) {
    if (isAnnotationAction && manifestAction.enabled === undefined) {
      // If annotation action has no property defined in manifest,
      // do not overwrite it with manifest action's default value.
      return undefined;
    }
    const result = getManifestActionBooleanPropertyWithFormatter(manifestAction.enabled, converterContext);

    // Consider requiresSelection property to include selectedContexts in the binding expression
    return compileExpression(ifElse(manifestAction.requiresSelection === true, and(greaterOrEqual(pathInModel("numberOfSelectedContexts", "internal"), 1), result), result));
  };

  /**
   * Gets the binding expression for the visibility of a manifest action.
   *
   * @param manifestAction The action configured in the manifest
   * @param isAnnotationAction Whether the action, defined in manifest, corresponds to an existing annotation action.
   * @param converterContext
   * @returns Determined property value for the visibility
   */
  const _getManifestVisible = function (manifestAction, isAnnotationAction, converterContext) {
    if (isAnnotationAction && manifestAction.visible === undefined) {
      // If annotation action has no property defined in manifest,
      // do not overwrite it with manifest action's default value.
      return undefined;
    }
    const result = getManifestActionBooleanPropertyWithFormatter(manifestAction.visible, converterContext);
    return compileExpression(result);
  };

  /**
   * As some properties should not be overridable by the manifest, make sure that the manifest configuration gets the annotation values for these.
   *
   * @param manifestAction Action defined in the manifest
   * @param annotationAction Action defined through annotations
   */
  function overrideManifestConfigurationWithAnnotation(manifestAction, annotationAction) {
    if (!annotationAction) {
      return;
    }

    // Do not override the 'type' given in an annotation action
    manifestAction.type = annotationAction.type;
    manifestAction.annotationPath = annotationAction.annotationPath;
    manifestAction.press = annotationAction.press;

    // Only use the annotation values for enablement and visibility if not set in the manifest
    manifestAction.enabled = manifestAction.enabled ?? annotationAction.enabled;
    manifestAction.visible = manifestAction.visible ?? annotationAction.visible;
  }

  /**
   * Hide an action if it is a hidden header action.
   *
   * @param action The action to hide
   * @param hiddenActions Actions that are configured as hidden (additional to the visible property)
   */
  function hideActionIfHiddenAction(action, hiddenActions) {
    if (hiddenActions !== null && hiddenActions !== void 0 && hiddenActions.find(hiddenAction => hiddenAction.key === action.key)) {
      action.visible = "false";
    }
  }

  /**
   * Creates the action configuration based on the manifest settings.
   *
   * @param manifestActions The manifest actions
   * @param converterContext The converter context
   * @param annotationActions The annotation actions definition
   * @param navigationSettings The navigation settings
   * @param considerNavigationSettings The navigation settings to be considered
   * @param hiddenActions Actions that are configured as hidden (additional to the visible property)
   * @param facetName The facet where an action is displayed if it is inline
   * @returns The actions from the manifest
   */
  function getActionsFromManifest(manifestActions, converterContext, annotationActions, navigationSettings, considerNavigationSettings, hiddenActions, facetName) {
    const actions = {};
    for (const actionKey in manifestActions) {
      var _manifestAction$press, _manifestAction$posit;
      const manifestAction = manifestActions[actionKey];
      const lastDotIndex = ((_manifestAction$press = manifestAction.press) === null || _manifestAction$press === void 0 ? void 0 : _manifestAction$press.lastIndexOf(".")) || -1;
      const oAnnotationAction = annotationActions === null || annotationActions === void 0 ? void 0 : annotationActions.find(obj => obj.key === actionKey);

      // To identify the annotation action property overwrite via manifest use-case.
      const isAnnotationAction = !!oAnnotationAction;
      if (manifestAction.facetName) {
        facetName = manifestAction.facetName;
      }
      actions[actionKey] = {
        id: oAnnotationAction ? actionKey : getCustomActionID(actionKey),
        type: manifestAction.menu ? ActionType.Menu : ActionType.Default,
        visible: _getManifestVisible(manifestAction, isAnnotationAction, converterContext),
        enabled: _getManifestEnabled(manifestAction, isAnnotationAction, converterContext),
        handlerModule: manifestAction.press && manifestAction.press.substring(0, lastDotIndex).replace(/\./gi, "/"),
        handlerMethod: manifestAction.press && manifestAction.press.substring(lastDotIndex + 1),
        press: manifestAction.press,
        text: manifestAction.text,
        noWrap: manifestAction.__noWrap,
        key: replaceSpecialChars(actionKey),
        enableOnSelect: manifestAction.enableOnSelect,
        defaultValuesExtensionFunction: manifestAction.defaultValuesFunction,
        position: {
          anchor: (_manifestAction$posit = manifestAction.position) === null || _manifestAction$posit === void 0 ? void 0 : _manifestAction$posit.anchor,
          placement: manifestAction.position === undefined ? Placement.After : manifestAction.position.placement
        },
        isNavigable: isActionNavigable(manifestAction, navigationSettings, considerNavigationSettings),
        command: manifestAction.command,
        requiresSelection: manifestAction.requiresSelection === undefined ? false : manifestAction.requiresSelection,
        enableAutoScroll: enableAutoScroll(manifestAction),
        menu: manifestAction.menu ?? [],
        facetName: manifestAction.inline ? facetName : undefined,
        defaultAction: manifestAction.defaultAction
      };
      overrideManifestConfigurationWithAnnotation(actions[actionKey], oAnnotationAction);
      hideActionIfHiddenAction(actions[actionKey], hiddenActions);
    }
    return transformMenuActionsAndIdentifyCommands(actions, annotationActions ?? [], hiddenActions ?? []);
  }

  /**
   * Gets a binding expression representing a Boolean manifest property that can either be represented by a static value, a binding string,
   * or a runtime formatter function.
   *
   * @param propertyValue String representing the configured property value
   * @param converterContext
   * @returns A binding expression representing the property
   */
  _exports.getActionsFromManifest = getActionsFromManifest;
  function getManifestActionBooleanPropertyWithFormatter(propertyValue, converterContext) {
    const resolvedBinding = resolveBindingString(propertyValue, "boolean");
    let result;
    if (isConstant(resolvedBinding) && resolvedBinding.value === undefined) {
      // No property value configured in manifest for the custom action --> default value is true
      result = true;
    } else if (isConstant(resolvedBinding) && typeof resolvedBinding.value === "boolean") {
      // true / false
      result = resolvedBinding.value;
    } else if (isConstant(resolvedBinding) && typeof resolvedBinding.value === "string") {
      var _converterContext$get;
      // Then it's a module-method reference "sap.xxx.yyy.doSomething"
      const methodPath = resolvedBinding.value;
      // FIXME: The custom "isEnabled" check does not trigger (because none of the bound values changes)
      result = formatResult([pathInModel("/", "$view"), methodPath, pathInModel("selectedContexts", "internal")], fpmFormatter.customBooleanPropertyCheck, ((_converterContext$get = converterContext.getDataModelObjectPath().contextLocation) === null || _converterContext$get === void 0 ? void 0 : _converterContext$get.targetEntityType) || converterContext.getEntityType());
    } else {
      // then it's a binding
      result = resolvedBinding;
    }
    return result;
  }
  const removeDuplicateActions = actions => {
    let oMenuItemKeys = {};
    actions.forEach(action => {
      var _action$menu;
      if (action !== null && action !== void 0 && (_action$menu = action.menu) !== null && _action$menu !== void 0 && _action$menu.length) {
        oMenuItemKeys = action.menu.reduce((item, _ref) => {
          let {
            key
          } = _ref;
          if (key && !item[key]) {
            item[key] = true;
          }
          return item;
        }, oMenuItemKeys);
      }
    });
    return actions.filter(action => !oMenuItemKeys[action.key]);
  };

  /**
   * Method to determine the value of the 'enabled' property of an annotation-based action.
   *
   * @param converterContext The instance of the converter context
   * @param actionTarget The instance of the action
   * @returns The binding expression for the 'enabled' property of the action button.
   */
  _exports.removeDuplicateActions = removeDuplicateActions;
  function getEnabledForAnnotationAction(converterContext, actionTarget) {
    var _actionTarget$paramet;
    if ((actionTarget === null || actionTarget === void 0 ? void 0 : actionTarget.isBound) !== true) {
      return "true";
    }
    if (actionTarget !== null && actionTarget !== void 0 && (_actionTarget$paramet = actionTarget.parameters) !== null && _actionTarget$paramet !== void 0 && _actionTarget$paramet.length) {
      var _actionTarget$annotat, _actionTarget$annotat2;
      const bindingParameterFullName = actionTarget === null || actionTarget === void 0 ? void 0 : actionTarget.parameters[0].fullyQualifiedName,
        operationAvailableExpression = getExpressionFromAnnotation(actionTarget === null || actionTarget === void 0 ? void 0 : (_actionTarget$annotat = actionTarget.annotations.Core) === null || _actionTarget$annotat === void 0 ? void 0 : _actionTarget$annotat.OperationAvailable, [], undefined, path => bindingContextPathVisitor(path, converterContext, bindingParameterFullName));
      if ((actionTarget === null || actionTarget === void 0 ? void 0 : (_actionTarget$annotat2 = actionTarget.annotations.Core) === null || _actionTarget$annotat2 === void 0 ? void 0 : _actionTarget$annotat2.OperationAvailable) !== undefined) {
        return compileExpression(equal(operationAvailableExpression, true));
      }
    }
    return "true";
  }
  _exports.getEnabledForAnnotationAction = getEnabledForAnnotationAction;
  function getSemanticObjectMapping(mappings) {
    return mappings ? mappings.map(mapping => {
      return {
        LocalProperty: {
          $PropertyPath: mapping.LocalProperty.value
        },
        SemanticObjectProperty: mapping.SemanticObjectProperty
      };
    }) : [];
  }
  _exports.getSemanticObjectMapping = getSemanticObjectMapping;
  function isActionNavigable(action, navigationSettings, considerNavigationSettings) {
    var _action$afterExecutio, _action$afterExecutio2;
    let bIsNavigationConfigured = true;
    if (considerNavigationSettings) {
      const detailOrDisplay = navigationSettings && (navigationSettings.detail || navigationSettings.display);
      bIsNavigationConfigured = detailOrDisplay !== null && detailOrDisplay !== void 0 && detailOrDisplay.route ? true : false;
    }
    // when enableAutoScroll is true the navigateToInstance feature is disabled
    if (action && action.afterExecution && (((_action$afterExecutio = action.afterExecution) === null || _action$afterExecutio === void 0 ? void 0 : _action$afterExecutio.navigateToInstance) === false || ((_action$afterExecutio2 = action.afterExecution) === null || _action$afterExecutio2 === void 0 ? void 0 : _action$afterExecutio2.enableAutoScroll) === true) || !bIsNavigationConfigured) {
      return false;
    }
    return true;
  }
  _exports.isActionNavigable = isActionNavigable;
  function enableAutoScroll(action) {
    var _action$afterExecutio3;
    return (action === null || action === void 0 ? void 0 : (_action$afterExecutio3 = action.afterExecution) === null || _action$afterExecutio3 === void 0 ? void 0 : _action$afterExecutio3.enableAutoScroll) === true;
  }
  _exports.enableAutoScroll = enableAutoScroll;
  function dataFieldIsCopyAction(dataField) {
    var _dataField$annotation, _dataField$annotation2, _dataField$annotation3;
    return ((_dataField$annotation = dataField.annotations) === null || _dataField$annotation === void 0 ? void 0 : (_dataField$annotation2 = _dataField$annotation.UI) === null || _dataField$annotation2 === void 0 ? void 0 : (_dataField$annotation3 = _dataField$annotation2.IsCopyAction) === null || _dataField$annotation3 === void 0 ? void 0 : _dataField$annotation3.valueOf()) === true && dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction";
  }
  _exports.dataFieldIsCopyAction = dataFieldIsCopyAction;
  function getCopyAction(copyDataFields) {
    if (copyDataFields.length === 1) {
      return copyDataFields[0];
    }
    if (copyDataFields.length > 1) {
      Log.error("Multiple actions are annotated with isCopyAction. There can be only one standard copy action.");
    }
    return undefined;
  }
  _exports.getCopyAction = getCopyAction;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Action", ["sap/base/Log","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/ManifestSettings","sap/fe/core/formatters/FPMFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper"],function(e,n,t,i,o,a,r,l){"use strict";var u={};var s=l.replaceSpecialChars;var c=r.resolveBindingString;var d=r.pathInModel;var v=r.or;var f=r.isConstant;var p=r.ifElse;var b=r.greaterOrEqual;var m=r.getExpressionFromAnnotation;var y=r.formatResult;var g=r.equal;var h=r.compileExpression;var A=r.and;var S=o.ActionType;var C=i.getCustomActionID;var E=t.Placement;var k=n.bindingContextPathVisitor;let x;(function(e){e["Accept"]="Accept";e["Attention"]="Attention";e["Back"]="Back";e["Critical"]="Critical";e["Default"]="Default";e["Emphasized"]="Emphasized";e["Ghost"]="Ghost";e["Negative"]="Negative";e["Neutral"]="Neutral";e["Reject"]="Reject";e["Success"]="Success";e["Transparent"]="Transparent";e["Unstyled"]="Unstyled";e["Up"]="Up"})(x||(x={}));u.ButtonType=x;function F(e,n,t,i){const o=n.find(e=>e.key===i);const a=e[i];const r={...o??a};if(o){r.enabled=(a===null||a===void 0?void 0:a.enabled)??o.enabled;r.visible=(a===null||a===void 0?void 0:a.visible)??o.visible;for(const e in a||{}){if(!o[e]&&e!=="menu"){r[e]=a[e]}}}const l=((r===null||r===void 0?void 0:r.visible)||(r===null||r===void 0?void 0:r.type)===S.DataFieldForAction||(r===null||r===void 0?void 0:r.type)===S.DataFieldForIntentBasedNavigation)&&!t.find(e=>e.key===(r===null||r===void 0?void 0:r.key));return{action:r,canBeMenuItem:l}}function I(e,n,t,i,o){const{action:a,canBeMenuItem:r}=F(n,t,o,e.defaultAction);if(r){e.defaultAction=a}if(a.command){i[a.key]=a}}function M(e,n,t,i,o){const a=[];for(const r of e.menu??[]){const{action:e,canBeMenuItem:l}=F(n,t,o,r);if(l){a.push(e)}if(e.command){i[r]=e}}e.menu=a;const r=a.map(e=>c(e.visible,"boolean"));e.visible=h(A(c(e.visible,"boolean"),v(...r)))}function O(e,n,t){const i={};const o=[];const a={};for(const l in e){const u=e[l];if(u.defaultAction!==undefined){I(u,e,n,a,t)}if(u.type===S.Menu){var r;o.push(...u.menu);M(u,e,n,a,t);if(!((r=u.menu)!==null&&r!==void 0&&r.length)){o.push(u.key)}}if(u.command){a[l]=u}i[l]=u}o.forEach(e=>delete i[e]);return{actions:i,commandActions:a}}const P=function(e,n,t){if(n&&e.enabled===undefined){return undefined}const i=j(e.enabled,t);return h(p(e.requiresSelection===true,A(b(d("numberOfSelectedContexts","internal"),1),i),i))};const B=function(e,n,t){if(n&&e.visible===undefined){return undefined}const i=j(e.visible,t);return h(i)};function N(e,n){if(!n){return}e.type=n.type;e.annotationPath=n.annotationPath;e.press=n.press;e.enabled=e.enabled??n.enabled;e.visible=e.visible??n.visible}function D(e,n){if(n!==null&&n!==void 0&&n.find(n=>n.key===e.key)){e.visible="false"}}function T(e,n,t,i,o,a,r){const l={};for(const d in e){var u,c;const v=e[d];const f=((u=v.press)===null||u===void 0?void 0:u.lastIndexOf("."))||-1;const p=t===null||t===void 0?void 0:t.find(e=>e.key===d);const b=!!p;if(v.facetName){r=v.facetName}l[d]={id:p?d:C(d),type:v.menu?S.Menu:S.Default,visible:B(v,b,n),enabled:P(v,b,n),handlerModule:v.press&&v.press.substring(0,f).replace(/\./gi,"/"),handlerMethod:v.press&&v.press.substring(f+1),press:v.press,text:v.text,noWrap:v.__noWrap,key:s(d),enableOnSelect:v.enableOnSelect,defaultValuesExtensionFunction:v.defaultValuesFunction,position:{anchor:(c=v.position)===null||c===void 0?void 0:c.anchor,placement:v.position===undefined?E.After:v.position.placement},isNavigable:R(v,i,o),command:v.command,requiresSelection:v.requiresSelection===undefined?false:v.requiresSelection,enableAutoScroll:V(v),menu:v.menu??[],facetName:v.inline?r:undefined,defaultAction:v.defaultAction};N(l[d],p);D(l[d],a)}return O(l,t??[],a??[])}u.getActionsFromManifest=T;function j(e,n){const t=c(e,"boolean");let i;if(f(t)&&t.value===undefined){i=true}else if(f(t)&&typeof t.value==="boolean"){i=t.value}else if(f(t)&&typeof t.value==="string"){var o;const e=t.value;i=y([d("/","$view"),e,d("selectedContexts","internal")],a.customBooleanPropertyCheck,((o=n.getDataModelObjectPath().contextLocation)===null||o===void 0?void 0:o.targetEntityType)||n.getEntityType())}else{i=t}return i}const q=e=>{let n={};e.forEach(e=>{var t;if(e!==null&&e!==void 0&&(t=e.menu)!==null&&t!==void 0&&t.length){n=e.menu.reduce((e,n)=>{let{key:t}=n;if(t&&!e[t]){e[t]=true}return e},n)}});return e.filter(e=>!n[e.key])};u.removeDuplicateActions=q;function U(e,n){var t;if((n===null||n===void 0?void 0:n.isBound)!==true){return"true"}if(n!==null&&n!==void 0&&(t=n.parameters)!==null&&t!==void 0&&t.length){var i,o;const t=n===null||n===void 0?void 0:n.parameters[0].fullyQualifiedName,a=m(n===null||n===void 0?void 0:(i=n.annotations.Core)===null||i===void 0?void 0:i.OperationAvailable,[],undefined,n=>k(n,e,t));if((n===null||n===void 0?void 0:(o=n.annotations.Core)===null||o===void 0?void 0:o.OperationAvailable)!==undefined){return h(g(a,true))}}return"true"}u.getEnabledForAnnotationAction=U;function L(e){return e?e.map(e=>({LocalProperty:{$PropertyPath:e.LocalProperty.value},SemanticObjectProperty:e.SemanticObjectProperty})):[]}u.getSemanticObjectMapping=L;function R(e,n,t){var i,o;let a=true;if(t){const e=n&&(n.detail||n.display);a=e!==null&&e!==void 0&&e.route?true:false}if(e&&e.afterExecution&&(((i=e.afterExecution)===null||i===void 0?void 0:i.navigateToInstance)===false||((o=e.afterExecution)===null||o===void 0?void 0:o.enableAutoScroll)===true)||!a){return false}return true}u.isActionNavigable=R;function V(e){var n;return(e===null||e===void 0?void 0:(n=e.afterExecution)===null||n===void 0?void 0:n.enableAutoScroll)===true}u.enableAutoScroll=V;function $(e){var n,t,i;return((n=e.annotations)===null||n===void 0?void 0:(t=n.UI)===null||t===void 0?void 0:(i=t.IsCopyAction)===null||i===void 0?void 0:i.valueOf())===true&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"}u.dataFieldIsCopyAction=$;function w(n){if(n.length===1){return n[0]}if(n.length>1){e.error("Multiple actions are annotated with isCopyAction. There can be only one standard copy action.")}return undefined}u.getCopyAction=w;return u},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Chart-dbg", ["sap/base/Log", "sap/fe/core/converters/annotations/DataField", "sap/fe/core/converters/controls/Common/Action", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/converters/helpers/Key", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/templating/DataModelPathHelper", "sap/ui/core/Core", "../../helpers/Aggregation", "../../helpers/ID", "../../ManifestSettings"], function (Log, DataField, Action, ConfigurableObject, Key, BindingToolkit, DataModelPathHelper, Core, Aggregation, ID, ManifestSettings) {
  "use strict";

  var _exports = {};
  var VisualizationType = ManifestSettings.VisualizationType;
  var VariantManagementType = ManifestSettings.VariantManagementType;
  var TemplateType = ManifestSettings.TemplateType;
  var ActionType = ManifestSettings.ActionType;
  var getFilterBarID = ID.getFilterBarID;
  var getChartID = ID.getChartID;
  var AggregationHelper = Aggregation.AggregationHelper;
  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var not = BindingToolkit.not;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var equal = BindingToolkit.equal;
  var compileExpression = BindingToolkit.compileExpression;
  var KeyHelper = Key.KeyHelper;
  var OverrideType = ConfigurableObject.OverrideType;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var getActionsFromManifest = Action.getActionsFromManifest;
  var isDataFieldForActionAbstract = DataField.isDataFieldForActionAbstract;
  /**
   * Method to retrieve all chart actions from annotations.
   *
   * @param chartAnnotation
   * @param visualizationPath
   * @param converterContext
   * @returns The table annotation actions
   */
  function getChartActionsFromAnnotations(chartAnnotation, visualizationPath, converterContext) {
    const chartActions = [];
    if (chartAnnotation) {
      const aActions = chartAnnotation.Actions || [];
      aActions.forEach(dataField => {
        var _dataField$annotation, _dataField$annotation2, _dataField$annotation3, _ActionTarget;
        let chartAction;
        if (isDataFieldForActionAbstract(dataField) && !(((_dataField$annotation = dataField.annotations) === null || _dataField$annotation === void 0 ? void 0 : (_dataField$annotation2 = _dataField$annotation.UI) === null || _dataField$annotation2 === void 0 ? void 0 : (_dataField$annotation3 = _dataField$annotation2.Hidden) === null || _dataField$annotation3 === void 0 ? void 0 : _dataField$annotation3.valueOf()) === true) && !dataField.Inline && !dataField.Determining && !(dataField !== null && dataField !== void 0 && (_ActionTarget = dataField.ActionTarget) !== null && _ActionTarget !== void 0 && _ActionTarget.isBound)) {
          const key = KeyHelper.generateKeyFromDataField(dataField);
          switch (dataField.$Type) {
            case "com.sap.vocabularies.UI.v1.DataFieldForAction":
              chartAction = {
                type: ActionType.DataFieldForAction,
                annotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),
                key: key,
                visible: getCompileExpressionForAction(dataField, converterContext)
              };
              break;
            case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
              chartAction = {
                type: ActionType.DataFieldForIntentBasedNavigation,
                annotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),
                key: key,
                visible: getCompileExpressionForAction(dataField, converterContext),
                isNavigable: true
              };
              break;
          }
        }
        if (chartAction) {
          chartActions.push(chartAction);
        }
      });
    }
    return chartActions;
  }
  function getChartActions(chartAnnotation, visualizationPath, converterContext) {
    const aAnnotationActions = getChartActionsFromAnnotations(chartAnnotation, visualizationPath, converterContext);
    const manifestActions = getActionsFromManifest(converterContext.getManifestControlConfiguration(visualizationPath).actions, converterContext, aAnnotationActions);
    const actionOverwriteConfig = {
      enabled: OverrideType.overwrite,
      enableOnSelect: OverrideType.overwrite,
      visible: OverrideType.overwrite,
      command: OverrideType.overwrite
    };
    const chartActions = insertCustomElements(aAnnotationActions, manifestActions.actions, actionOverwriteConfig);
    return {
      actions: chartActions,
      commandActions: manifestActions.commandActions
    };
  }
  _exports.getChartActions = getChartActions;
  function getP13nMode(visualizationPath, converterContext) {
    var _chartManifestSetting;
    const chartManifestSettings = converterContext.getManifestControlConfiguration(visualizationPath);
    let personalization = true;
    const aPersonalization = [];
    if ((chartManifestSettings === null || chartManifestSettings === void 0 ? void 0 : (_chartManifestSetting = chartManifestSettings.chartSettings) === null || _chartManifestSetting === void 0 ? void 0 : _chartManifestSetting.personalization) !== undefined) {
      personalization = chartManifestSettings.chartSettings.personalization;
    }
    if (personalization) {
      //Variant Management should be enabled when personalization is enabled. Irrespective of wheather or not variant management is enabled, personalization should be enabled.
      if (personalization === true) {
        return "Sort,Type,Item";
      } else if (typeof personalization === "object") {
        if (personalization.type) {
          aPersonalization.push("Type");
        }
        if (personalization.item) {
          aPersonalization.push("Item");
        }
        if (personalization.sort) {
          aPersonalization.push("Sort");
        }
        return aPersonalization.join(",");
      }
    }
    return undefined;
  }

  /**
   * Create the ChartVisualization configuration that will be used to display a chart using the Chart building block.
   *
   * @param chartAnnotation The target chart annotation
   * @param visualizationPath The current visualization annotation path
   * @param converterContext The converter context
   * @param doNotCheckApplySupported Flag that indicates whether applysupported needs to be checked or not
   * @returns The chart visualization based on the annotation
   */
  _exports.getP13nMode = getP13nMode;
  function createChartVisualization(chartAnnotation, visualizationPath, converterContext, doNotCheckApplySupported) {
    const aggregationHelper = new AggregationHelper(converterContext.getEntityType(), converterContext);
    if (!doNotCheckApplySupported && !aggregationHelper.isAnalyticsSupported()) {
      throw new Error("ApplySupported is not added to the annotations");
    }
    const aTransAggregations = aggregationHelper.getTransAggregations();
    const aCustomAggregates = aggregationHelper.getCustomAggregateDefinitions();
    const mCustomAggregates = {};
    const pageManifestSettings = converterContext.getManifestWrapper();
    const variantManagement = pageManifestSettings.getVariantManagement();
    const p13nMode = getP13nMode(visualizationPath, converterContext);
    if (p13nMode === undefined && variantManagement === "Control") {
      Log.warning("Variant Management cannot be enabled when personalization is disabled");
    }
    if (aCustomAggregates) {
      const entityType = aggregationHelper.getEntityType();
      for (const customAggregate of aCustomAggregates) {
        var _customAggregate$anno, _customAggregate$anno2, _relatedCustomAggrega, _relatedCustomAggrega2, _relatedCustomAggrega3;
        const aContextDefiningProperties = customAggregate === null || customAggregate === void 0 ? void 0 : (_customAggregate$anno = customAggregate.annotations) === null || _customAggregate$anno === void 0 ? void 0 : (_customAggregate$anno2 = _customAggregate$anno.Aggregation) === null || _customAggregate$anno2 === void 0 ? void 0 : _customAggregate$anno2.ContextDefiningProperties;
        const qualifier = customAggregate === null || customAggregate === void 0 ? void 0 : customAggregate.qualifier;
        const relatedCustomAggregateProperty = qualifier && entityType.entityProperties.find(property => property.name === qualifier);
        const label = relatedCustomAggregateProperty && (relatedCustomAggregateProperty === null || relatedCustomAggregateProperty === void 0 ? void 0 : (_relatedCustomAggrega = relatedCustomAggregateProperty.annotations) === null || _relatedCustomAggrega === void 0 ? void 0 : (_relatedCustomAggrega2 = _relatedCustomAggrega.Common) === null || _relatedCustomAggrega2 === void 0 ? void 0 : (_relatedCustomAggrega3 = _relatedCustomAggrega2.Label) === null || _relatedCustomAggrega3 === void 0 ? void 0 : _relatedCustomAggrega3.toString());
        mCustomAggregates[qualifier] = {
          name: qualifier,
          label: label || `Custom Aggregate (${qualifier})`,
          sortable: true,
          sortOrder: "both",
          contextDefiningProperty: aContextDefiningProperties ? aContextDefiningProperties.map(oCtxDefProperty => {
            return oCtxDefProperty.value;
          }) : []
        };
      }
    }
    const mTransAggregations = {};
    const oResourceBundleCore = Core.getLibraryResourceBundle("sap.fe.core");
    if (aTransAggregations) {
      for (let i = 0; i < aTransAggregations.length; i++) {
        var _aTransAggregations$i, _aTransAggregations$i2, _aTransAggregations$i3, _aTransAggregations$i4, _aTransAggregations$i5, _aTransAggregations$i6;
        mTransAggregations[aTransAggregations[i].Name] = {
          name: aTransAggregations[i].Name,
          propertyPath: aTransAggregations[i].AggregatableProperty.valueOf().value,
          aggregationMethod: aTransAggregations[i].AggregationMethod,
          label: (_aTransAggregations$i = aTransAggregations[i]) !== null && _aTransAggregations$i !== void 0 && (_aTransAggregations$i2 = _aTransAggregations$i.annotations) !== null && _aTransAggregations$i2 !== void 0 && (_aTransAggregations$i3 = _aTransAggregations$i2.Common) !== null && _aTransAggregations$i3 !== void 0 && _aTransAggregations$i3.Label ? (_aTransAggregations$i4 = aTransAggregations[i]) === null || _aTransAggregations$i4 === void 0 ? void 0 : (_aTransAggregations$i5 = _aTransAggregations$i4.annotations) === null || _aTransAggregations$i5 === void 0 ? void 0 : (_aTransAggregations$i6 = _aTransAggregations$i5.Common) === null || _aTransAggregations$i6 === void 0 ? void 0 : _aTransAggregations$i6.Label.toString() : `${oResourceBundleCore.getText("AGGREGATABLE_PROPERTY")} (${aTransAggregations[i].Name})`,
          sortable: true,
          sortOrder: "both",
          custom: false
        };
      }
    }
    const aAggProps = aggregationHelper.getAggregatableProperties();
    const aGrpProps = aggregationHelper.getGroupableProperties();
    const mApplySupported = {};
    mApplySupported.$Type = "Org.OData.Aggregation.V1.ApplySupportedType";
    mApplySupported.AggregatableProperties = [];
    mApplySupported.GroupableProperties = [];
    for (let i = 0; aAggProps && i < aAggProps.length; i++) {
      var _aAggProps$i, _aAggProps$i2, _aAggProps$i2$Propert;
      const obj = {
        $Type: (_aAggProps$i = aAggProps[i]) === null || _aAggProps$i === void 0 ? void 0 : _aAggProps$i.$Type,
        Property: {
          $PropertyPath: (_aAggProps$i2 = aAggProps[i]) === null || _aAggProps$i2 === void 0 ? void 0 : (_aAggProps$i2$Propert = _aAggProps$i2.Property) === null || _aAggProps$i2$Propert === void 0 ? void 0 : _aAggProps$i2$Propert.value
        }
      };
      mApplySupported.AggregatableProperties.push(obj);
    }
    for (let i = 0; aGrpProps && i < aGrpProps.length; i++) {
      var _aGrpProps$i;
      const obj = {
        $PropertyPath: (_aGrpProps$i = aGrpProps[i]) === null || _aGrpProps$i === void 0 ? void 0 : _aGrpProps$i.value
      };
      mApplySupported.GroupableProperties.push(obj);
    }
    const chartActions = getChartActions(chartAnnotation, visualizationPath, converterContext);
    let [navigationPropertyPath /*, annotationPath*/] = visualizationPath.split("@");
    if (navigationPropertyPath.lastIndexOf("/") === navigationPropertyPath.length - 1) {
      // Drop trailing slash
      navigationPropertyPath = navigationPropertyPath.substr(0, navigationPropertyPath.length - 1);
    }
    const title = chartAnnotation.Title; // read title from chart annotation
    const dataModelPath = converterContext.getDataModelObjectPath();
    const isEntitySet = navigationPropertyPath.length === 0;
    const entityName = dataModelPath.targetEntitySet ? dataModelPath.targetEntitySet.name : dataModelPath.startingEntitySet.name;
    const sFilterbarId = isEntitySet ? getFilterBarID(converterContext.getContextPath()) : undefined;
    const oVizProperties = {
      legendGroup: {
        layout: {
          position: "bottom"
        }
      }
    };
    let autoBindOnInit;
    if (converterContext.getTemplateType() === TemplateType.ObjectPage) {
      autoBindOnInit = true;
    } else if (converterContext.getTemplateType() === TemplateType.ListReport || converterContext.getTemplateType() === TemplateType.AnalyticalListPage) {
      autoBindOnInit = false;
    }
    const hasMultipleVisualizations = converterContext.getManifestWrapper().hasMultipleVisualizations() || converterContext.getTemplateType() === "AnalyticalListPage";
    const onSegmentedButtonPressed = hasMultipleVisualizations ? ".handlers.onSegmentedButtonPressed" : "";
    const visible = hasMultipleVisualizations ? "{= ${pageInternal>alpContentView} !== 'Table'}" : "true";
    const allowedTransformations = aggregationHelper.getAllowedTransformations();
    mApplySupported.enableSearch = allowedTransformations ? allowedTransformations.indexOf("search") >= 0 : true;
    let qualifier = "";
    if (chartAnnotation.fullyQualifiedName.split("#").length > 1) {
      qualifier = chartAnnotation.fullyQualifiedName.split("#")[1];
    }
    return {
      type: VisualizationType.Chart,
      id: qualifier ? getChartID(isEntitySet ? entityName : navigationPropertyPath, qualifier, VisualizationType.Chart) : getChartID(isEntitySet ? entityName : navigationPropertyPath, VisualizationType.Chart),
      collection: getTargetObjectPath(converterContext.getDataModelObjectPath()),
      entityName: entityName,
      personalization: getP13nMode(visualizationPath, converterContext),
      navigationPath: navigationPropertyPath,
      annotationPath: converterContext.getAbsoluteAnnotationPath(visualizationPath),
      filterId: sFilterbarId,
      vizProperties: JSON.stringify(oVizProperties),
      actions: chartActions.actions,
      commandActions: chartActions.commandActions,
      title: title,
      autoBindOnInit: autoBindOnInit,
      onSegmentedButtonPressed: onSegmentedButtonPressed,
      visible: visible,
      customAgg: mCustomAggregates,
      transAgg: mTransAggregations,
      applySupported: mApplySupported,
      variantManagement: findVariantManagement(p13nMode, variantManagement)
    };
  }
  /**
   * Method to determine variant management.
   *
   * @param p13nMode
   * @param variantManagement
   * @returns The variant management for chart
   */
  _exports.createChartVisualization = createChartVisualization;
  function findVariantManagement(p13nMode, variantManagement) {
    return variantManagement === "Control" && !p13nMode ? VariantManagementType.None : variantManagement;
  }

  /**
   * Method to get compile expression for DataFieldForAction and DataFieldForIntentBasedNavigation.
   *
   * @param dataField
   * @param converterContext
   * @returns Compile expression for DataFieldForAction and DataFieldForIntentBasedNavigation
   */
  function getCompileExpressionForAction(dataField, converterContext) {
    var _dataField$annotation4, _dataField$annotation5;
    return compileExpression(not(equal(getExpressionFromAnnotation((_dataField$annotation4 = dataField.annotations) === null || _dataField$annotation4 === void 0 ? void 0 : (_dataField$annotation5 = _dataField$annotation4.UI) === null || _dataField$annotation5 === void 0 ? void 0 : _dataField$annotation5.Hidden, [], undefined, converterContext.getRelativeModelPathFunction()), true)));
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Chart", ["sap/base/Log","sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/ui/core/Core","../../helpers/Aggregation","../../helpers/ID","../../ManifestSettings"],function(e,t,n,o,a,i,r,l,s,d,g){"use strict";var c={};var u=g.VisualizationType;var p=g.VariantManagementType;var v=g.TemplateType;var f=g.ActionType;var m=d.getFilterBarID;var y=d.getChartID;var h=s.AggregationHelper;var b=r.getTargetObjectPath;var A=i.not;var P=i.getExpressionFromAnnotation;var T=i.equal;var C=i.compileExpression;var S=a.KeyHelper;var D=o.OverrideType;var M=o.insertCustomElements;var O=n.getActionsFromManifest;var F=t.isDataFieldForActionAbstract;function I(e,t,n){const o=[];if(e){const t=e.Actions||[];t.forEach(e=>{var t,a,i,r;let l;if(F(e)&&!(((t=e.annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(i=a.Hidden)===null||i===void 0?void 0:i.valueOf())===true)&&!e.Inline&&!e.Determining&&!(e!==null&&e!==void 0&&(r=e.ActionTarget)!==null&&r!==void 0&&r.isBound)){const t=S.generateKeyFromDataField(e);switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":l={type:f.DataFieldForAction,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:t,visible:$(e,n)};break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":l={type:f.DataFieldForIntentBasedNavigation,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:t,visible:$(e,n),isNavigable:true};break}}if(l){o.push(l)}})}return o}function E(e,t,n){const o=I(e,t,n);const a=O(n.getManifestControlConfiguration(t).actions,n,o);const i={enabled:D.overwrite,enableOnSelect:D.overwrite,visible:D.overwrite,command:D.overwrite};const r=M(o,a.actions,i);return{actions:r,commandActions:a.commandActions}}c.getChartActions=E;function N(e,t){var n;const o=t.getManifestControlConfiguration(e);let a=true;const i=[];if((o===null||o===void 0?void 0:(n=o.chartSettings)===null||n===void 0?void 0:n.personalization)!==undefined){a=o.chartSettings.personalization}if(a){if(a===true){return"Sort,Type,Item"}else if(typeof a==="object"){if(a.type){i.push("Type")}if(a.item){i.push("Item")}if(a.sort){i.push("Sort")}return i.join(",")}}return undefined}c.getP13nMode=N;function w(t,n,o,a){const i=new h(o.getEntityType(),o);if(!a&&!i.isAnalyticsSupported()){throw new Error("ApplySupported is not added to the annotations")}const r=i.getTransAggregations();const s=i.getCustomAggregateDefinitions();const d={};const g=o.getManifestWrapper();const c=g.getVariantManagement();const p=N(n,o);if(p===undefined&&c==="Control"){e.warning("Variant Management cannot be enabled when personalization is disabled")}if(s){const e=i.getEntityType();for(const t of s){var f,A,P,T,C;const n=t===null||t===void 0?void 0:(f=t.annotations)===null||f===void 0?void 0:(A=f.Aggregation)===null||A===void 0?void 0:A.ContextDefiningProperties;const o=t===null||t===void 0?void 0:t.qualifier;const a=o&&e.entityProperties.find(e=>e.name===o);const i=a&&(a===null||a===void 0?void 0:(P=a.annotations)===null||P===void 0?void 0:(T=P.Common)===null||T===void 0?void 0:(C=T.Label)===null||C===void 0?void 0:C.toString());d[o]={name:o,label:i||`Custom Aggregate (${o})`,sortable:true,sortOrder:"both",contextDefiningProperty:n?n.map(e=>e.value):[]}}}const S={};const D=l.getLibraryResourceBundle("sap.fe.core");if(r){for(let e=0;e<r.length;e++){var M,O,F,I,w,$;S[r[e].Name]={name:r[e].Name,propertyPath:r[e].AggregatableProperty.valueOf().value,aggregationMethod:r[e].AggregationMethod,label:(M=r[e])!==null&&M!==void 0&&(O=M.annotations)!==null&&O!==void 0&&(F=O.Common)!==null&&F!==void 0&&F.Label?(I=r[e])===null||I===void 0?void 0:(w=I.annotations)===null||w===void 0?void 0:($=w.Common)===null||$===void 0?void 0:$.Label.toString():`${D.getText("AGGREGATABLE_PROPERTY")} (${r[e].Name})`,sortable:true,sortOrder:"both",custom:false}}}const L=i.getAggregatableProperties();const x=i.getGroupableProperties();const z={};z.$Type="Org.OData.Aggregation.V1.ApplySupportedType";z.AggregatableProperties=[];z.GroupableProperties=[];for(let e=0;L&&e<L.length;e++){var V,j,G;const t={$Type:(V=L[e])===null||V===void 0?void 0:V.$Type,Property:{$PropertyPath:(j=L[e])===null||j===void 0?void 0:(G=j.Property)===null||G===void 0?void 0:G.value}};z.AggregatableProperties.push(t)}for(let e=0;x&&e<x.length;e++){var R;const t={$PropertyPath:(R=x[e])===null||R===void 0?void 0:R.value};z.GroupableProperties.push(t)}const k=E(t,n,o);let[H]=n.split("@");if(H.lastIndexOf("/")===H.length-1){H=H.substr(0,H.length-1)}const Q=t.Title;const U=o.getDataModelObjectPath();const K=H.length===0;const q=U.targetEntitySet?U.targetEntitySet.name:U.startingEntitySet.name;const W=K?m(o.getContextPath()):undefined;const J={legendGroup:{layout:{position:"bottom"}}};let Y;if(o.getTemplateType()===v.ObjectPage){Y=true}else if(o.getTemplateType()===v.ListReport||o.getTemplateType()===v.AnalyticalListPage){Y=false}const _=o.getManifestWrapper().hasMultipleVisualizations()||o.getTemplateType()==="AnalyticalListPage";const X=_?".handlers.onSegmentedButtonPressed":"";const Z=_?"{= ${pageInternal>alpContentView} !== 'Table'}":"true";const ee=i.getAllowedTransformations();z.enableSearch=ee?ee.indexOf("search")>=0:true;let te="";if(t.fullyQualifiedName.split("#").length>1){te=t.fullyQualifiedName.split("#")[1]}return{type:u.Chart,id:te?y(K?q:H,te,u.Chart):y(K?q:H,u.Chart),collection:b(o.getDataModelObjectPath()),entityName:q,personalization:N(n,o),navigationPath:H,annotationPath:o.getAbsoluteAnnotationPath(n),filterId:W,vizProperties:JSON.stringify(J),actions:k.actions,commandActions:k.commandActions,title:Q,autoBindOnInit:Y,onSegmentedButtonPressed:X,visible:Z,customAgg:d,transAgg:S,applySupported:z,variantManagement:B(p,c)}}c.createChartVisualization=w;function B(e,t){return t==="Control"&&!e?p.None:t}function $(e,t){var n,o;return C(A(T(P((n=e.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:o.Hidden,[],undefined,t.getRelativeModelPathFunction()),true)))}return c},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Criticality-dbg", ["sap/fe/core/formatters/TableFormatterTypes"], function (TableFormatterTypes) {
  "use strict";

  var _exports = {};
  var MessageType = TableFormatterTypes.MessageType;
  /**
   * Gets a MessageType enum value from a CriticalityType enum value.
   *
   * @param criticalityEnum The CriticalityType enum value
   * @returns Returns the MessageType enum value
   */
  function getMessageTypeFromCriticalityType(criticalityEnum) {
    let messageType;
    switch (criticalityEnum) {
      case "UI.CriticalityType/Negative":
      case "UI.CriticalityType/VeryNegative":
        messageType = MessageType.Error;
        break;
      case "UI.CriticalityType/Critical":
        messageType = MessageType.Warning;
        break;
      case "UI.CriticalityType/Positive":
      case "UI.CriticalityType/VeryPositive":
        messageType = MessageType.Success;
        break;
      case "UI.CriticalityType/Information":
        messageType = MessageType.Information;
        break;
      case "UI.CriticalityType/Neutral":
      default:
        messageType = MessageType.None;
    }
    return messageType;
  }
  _exports.getMessageTypeFromCriticalityType = getMessageTypeFromCriticalityType;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Criticality", ["sap/fe/core/formatters/TableFormatterTypes"],function(e){"use strict";var i={};var t=e.MessageType;function a(e){let i;switch(e){case"UI.CriticalityType/Negative":case"UI.CriticalityType/VeryNegative":i=t.Error;break;case"UI.CriticalityType/Critical":i=t.Warning;break;case"UI.CriticalityType/Positive":case"UI.CriticalityType/VeryPositive":i=t.Success;break;case"UI.CriticalityType/Information":i=t.Information;break;case"UI.CriticalityType/Neutral":default:i=t.None}return i}i.getMessageTypeFromCriticalityType=a;return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/DataVisualization-dbg", ["sap/fe/core/converters/helpers/IssueManager", "sap/fe/macros/CommonHelper", "../../ManifestSettings", "./Chart", "./Table"], function (IssueManager, CommonHelper, ManifestSettings, Chart, Table) {
  "use strict";

  var _exports = {};
  var createChartVisualization = Chart.createChartVisualization;
  var TemplateType = ManifestSettings.TemplateType;
  var IssueType = IssueManager.IssueType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategory = IssueManager.IssueCategory;
  const getVisualizationsFromPresentationVariant = function (presentationVariantAnnotation, visualizationPath, converterContext, isMacroOrMultipleView) {
    const visualizationAnnotations = [];
    const bIsALP = converterContext.getManifestWrapper().hasMultipleVisualizations() || converterContext.getTemplateType() === TemplateType.AnalyticalListPage;
    const baseVisualizationPath = visualizationPath.split("@")[0];
    if (isMacroOrMultipleView && !isPresentationCompliant(presentationVariantAnnotation, bIsALP)) {
      const entityType = converterContext.getEntityType();
      const defaultLineItemAnnotation = getDefaultLineItem(entityType);
      if (defaultLineItemAnnotation) {
        visualizationAnnotations.push({
          visualization: defaultLineItemAnnotation,
          annotationPath: `${baseVisualizationPath}${converterContext.getRelativeAnnotationPath(defaultLineItemAnnotation.fullyQualifiedName, entityType)}`,
          converterContext: converterContext
        });
      }
    }
    const visualizations = presentationVariantAnnotation.Visualizations;
    const pushFirstVizOfType = function (allowedTerms) {
      const firstViz = visualizations === null || visualizations === void 0 ? void 0 : visualizations.find(viz => {
        var _viz$$target;
        return allowedTerms.indexOf((_viz$$target = viz.$target) === null || _viz$$target === void 0 ? void 0 : _viz$$target.term) >= 0;
      });
      if (firstViz) {
        visualizationAnnotations.push({
          visualization: firstViz.$target,
          annotationPath: `${baseVisualizationPath}${firstViz.value}`,
          converterContext: converterContext
        });
      }
    };
    if (bIsALP) {
      // In case of ALP, we use the first LineItem and the first Chart
      pushFirstVizOfType(["com.sap.vocabularies.UI.v1.LineItem"]);
      pushFirstVizOfType(["com.sap.vocabularies.UI.v1.Chart"]);
    } else {
      // Otherwise, we use the first viz only (Chart or LineItem)
      pushFirstVizOfType(["com.sap.vocabularies.UI.v1.LineItem", "com.sap.vocabularies.UI.v1.Chart"]);
    }
    return visualizationAnnotations;
  };
  _exports.getVisualizationsFromPresentationVariant = getVisualizationsFromPresentationVariant;
  function getSelectionPresentationVariant(entityType, annotationPath, converterContext) {
    if (annotationPath) {
      const resolvedTarget = converterContext.getEntityTypeAnnotation(annotationPath);
      const selectionPresentationVariant = resolvedTarget.annotation;
      if (selectionPresentationVariant) {
        if (selectionPresentationVariant.term === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant") {
          return selectionPresentationVariant;
        }
      } else {
        throw new Error("Annotation Path for the SPV mentioned in the manifest is not found, Please add the SPV in the annotation");
      }
    } else {
      var _entityType$annotatio, _entityType$annotatio2;
      return (_entityType$annotatio = entityType.annotations) === null || _entityType$annotatio === void 0 ? void 0 : (_entityType$annotatio2 = _entityType$annotatio.UI) === null || _entityType$annotatio2 === void 0 ? void 0 : _entityType$annotatio2.SelectionPresentationVariant;
    }
  }
  _exports.getSelectionPresentationVariant = getSelectionPresentationVariant;
  function isSelectionPresentationCompliant(SelectionPresentationVariant, bIsALP) {
    const presentationVariant = SelectionPresentationVariant && SelectionPresentationVariant.PresentationVariant;
    if (presentationVariant) {
      return isPresentationCompliant(presentationVariant, bIsALP);
    } else {
      throw new Error("Presentation Variant is not present in the SPV annotation");
    }
  }
  _exports.isSelectionPresentationCompliant = isSelectionPresentationCompliant;
  function isPresentationCompliant(presentationVariant) {
    let bIsALP = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let bHasTable = false,
      bHasChart = false;
    if (bIsALP) {
      if (presentationVariant !== null && presentationVariant !== void 0 && presentationVariant.Visualizations) {
        const aVisualizations = presentationVariant.Visualizations;
        aVisualizations.forEach(oVisualization => {
          var _oVisualization$$targ, _oVisualization$$targ2;
          if (((_oVisualization$$targ = oVisualization.$target) === null || _oVisualization$$targ === void 0 ? void 0 : _oVisualization$$targ.term) === "com.sap.vocabularies.UI.v1.LineItem") {
            bHasTable = true;
          }
          if (((_oVisualization$$targ2 = oVisualization.$target) === null || _oVisualization$$targ2 === void 0 ? void 0 : _oVisualization$$targ2.term) === "com.sap.vocabularies.UI.v1.Chart") {
            bHasChart = true;
          }
        });
      }
      return bHasChart && bHasTable;
    } else {
      return (presentationVariant === null || presentationVariant === void 0 ? void 0 : presentationVariant.Visualizations) && !!presentationVariant.Visualizations.find(visualization => {
        var _visualization$$targe, _visualization$$targe2;
        return ((_visualization$$targe = visualization.$target) === null || _visualization$$targe === void 0 ? void 0 : _visualization$$targe.term) === "com.sap.vocabularies.UI.v1.LineItem" || ((_visualization$$targe2 = visualization.$target) === null || _visualization$$targe2 === void 0 ? void 0 : _visualization$$targe2.term) === "com.sap.vocabularies.UI.v1.Chart";
      });
    }
  }
  _exports.isPresentationCompliant = isPresentationCompliant;
  function getDefaultLineItem(entityType) {
    var _entityType$annotatio3;
    return (_entityType$annotatio3 = entityType.annotations.UI) === null || _entityType$annotatio3 === void 0 ? void 0 : _entityType$annotatio3.LineItem;
  }
  _exports.getDefaultLineItem = getDefaultLineItem;
  function getDefaultChart(entityType) {
    var _entityType$annotatio4;
    return (_entityType$annotatio4 = entityType.annotations.UI) === null || _entityType$annotatio4 === void 0 ? void 0 : _entityType$annotatio4.Chart;
  }
  _exports.getDefaultChart = getDefaultChart;
  function getDefaultPresentationVariant(entityType) {
    var _entityType$annotatio5, _entityType$annotatio6;
    return (_entityType$annotatio5 = entityType.annotations) === null || _entityType$annotatio5 === void 0 ? void 0 : (_entityType$annotatio6 = _entityType$annotatio5.UI) === null || _entityType$annotatio6 === void 0 ? void 0 : _entityType$annotatio6.PresentationVariant;
  }
  _exports.getDefaultPresentationVariant = getDefaultPresentationVariant;
  function getDefaultSelectionVariant(entityType) {
    var _entityType$annotatio7, _entityType$annotatio8;
    return (_entityType$annotatio7 = entityType.annotations) === null || _entityType$annotatio7 === void 0 ? void 0 : (_entityType$annotatio8 = _entityType$annotatio7.UI) === null || _entityType$annotatio8 === void 0 ? void 0 : _entityType$annotatio8.SelectionVariant;
  }
  _exports.getDefaultSelectionVariant = getDefaultSelectionVariant;
  function getSelectionVariant(entityType, converterContext) {
    const annotationPath = converterContext.getManifestWrapper().getDefaultTemplateAnnotationPath();
    const selectionPresentationVariant = getSelectionPresentationVariant(entityType, annotationPath, converterContext);
    let selectionVariant;
    if (selectionPresentationVariant) {
      selectionVariant = selectionPresentationVariant.SelectionVariant;
      if (selectionVariant) {
        return selectionVariant;
      }
    } else {
      selectionVariant = getDefaultSelectionVariant(entityType);
      return selectionVariant;
    }
  }
  _exports.getSelectionVariant = getSelectionVariant;
  function getDataVisualizationConfiguration(visualizationPath, isCondensedTableLayoutCompliant, inConverterContext, viewConfiguration, doNotCheckApplySupported, associatedPresentationVariantPath, isMacroOrMultipleView) {
    const resolvedTarget = visualizationPath !== "" ? inConverterContext.getEntityTypeAnnotation(visualizationPath) : {
      annotation: undefined,
      converterContext: inConverterContext
    };
    const resolvedAssociatedPresentationVariant = associatedPresentationVariantPath ? inConverterContext.getEntityTypeAnnotation(associatedPresentationVariantPath) : null;
    const resolvedVisualization = resolvedTarget.annotation;
    inConverterContext = resolvedTarget.converterContext;
    let visualizationAnnotations = [];
    let presentationVariantAnnotation;
    let presentationPath = "";
    let chartVisualization, tableVisualization;
    const sTerm = resolvedVisualization === null || resolvedVisualization === void 0 ? void 0 : resolvedVisualization.term;
    if (sTerm) {
      switch (sTerm) {
        case "com.sap.vocabularies.UI.v1.LineItem":
        case "com.sap.vocabularies.UI.v1.Chart":
          presentationVariantAnnotation = resolvedAssociatedPresentationVariant === null || resolvedAssociatedPresentationVariant === void 0 ? void 0 : resolvedAssociatedPresentationVariant.annotation;
          visualizationAnnotations.push({
            visualization: resolvedVisualization,
            annotationPath: visualizationPath,
            converterContext: inConverterContext
          });
          break;
        case "com.sap.vocabularies.UI.v1.PresentationVariant":
          presentationVariantAnnotation = resolvedVisualization;
          visualizationAnnotations = visualizationAnnotations.concat(getVisualizationsFromPresentationVariant(resolvedVisualization, visualizationPath, inConverterContext, isMacroOrMultipleView));
          break;
        case "com.sap.vocabularies.UI.v1.SelectionPresentationVariant":
          presentationVariantAnnotation = resolvedVisualization.PresentationVariant;
          // Presentation can be inline or outside the SelectionPresentationVariant
          presentationPath = presentationVariantAnnotation.fullyQualifiedName;
          visualizationAnnotations = visualizationAnnotations.concat(getVisualizationsFromPresentationVariant(presentationVariantAnnotation, visualizationPath, inConverterContext, isMacroOrMultipleView));
          break;
        default:
          break;
      }
      visualizationAnnotations.forEach(visualizationAnnotation => {
        const {
          visualization,
          annotationPath,
          converterContext
        } = visualizationAnnotation;
        switch (visualization.term) {
          case "com.sap.vocabularies.UI.v1.Chart":
            chartVisualization = createChartVisualization(visualization, annotationPath, converterContext, doNotCheckApplySupported);
            break;
          case "com.sap.vocabularies.UI.v1.LineItem":
          default:
            tableVisualization = Table.createTableVisualization(visualization, annotationPath, converterContext, presentationVariantAnnotation, isCondensedTableLayoutCompliant, viewConfiguration);
            break;
        }
      });
    } else {
      tableVisualization = Table.createDefaultTableVisualization(inConverterContext, !isMacroOrMultipleView);
      inConverterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Medium, IssueType.MISSING_LINEITEM);
    }
    const aVisualizations = [];
    let sPath = sTerm === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant" ? presentationPath : resolvedVisualization && resolvedVisualization.fullyQualifiedName;
    if (sPath === undefined) {
      sPath = "/";
    }
    if (chartVisualization) {
      aVisualizations.push(chartVisualization);
    }
    if (tableVisualization) {
      aVisualizations.push(tableVisualization);
    }
    return {
      visualizations: aVisualizations,
      annotationPath: inConverterContext.getEntitySetBasedAnnotationPath(sPath)
    };
  }

  /**
   * Return UI Control (LineItem/Chart) Context.
   *
   * @function
   * @name getUiControl
   * @param oPresentationContext Presentation context object (Presentation variant or UI.LineItem/Chart)
   * @param sControlPath Control path
   * @returns The Control (LineItem/Chart) context
   */
  _exports.getDataVisualizationConfiguration = getDataVisualizationConfiguration;
  function getUiControl(oPresentationContext, sControlPath) {
    const oPresentation = oPresentationContext.getObject(oPresentationContext.getPath()),
      oPresentationVariantPath = CommonHelper.createPresentationPathContext(oPresentationContext),
      oModel = oPresentationContext.getModel();
    if (CommonHelper._isPresentationVariantAnnotation(oPresentationVariantPath.getPath())) {
      // Uncomplete PresentationVariant can be passed to macro via SelectionPresentationVariant
      const aVisualizations = oPresentation.Visualizations;
      if (Array.isArray(aVisualizations)) {
        for (let i = 0; i < aVisualizations.length; i++) {
          if (aVisualizations[i].$AnnotationPath.indexOf(sControlPath) !== -1) {
            sControlPath = aVisualizations[i].$AnnotationPath;
            break;
          }
        }
      }
      return oModel.getMetaContext(oPresentationContext.getPath().split("@")[0] + sControlPath);
    }
    return oPresentationContext;
  }
  _exports.getUiControl = getUiControl;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/DataVisualization", ["sap/fe/core/converters/helpers/IssueManager","sap/fe/macros/CommonHelper","../../ManifestSettings","./Chart","./Table"],function(t,n,e,a,i){"use strict";var o={};var r=a.createChartVisualization;var s=e.TemplateType;var l=t.IssueType;var u=t.IssueSeverity;var c=t.IssueCategory;const v=function(t,n,e,a){const i=[];const o=e.getManifestWrapper().hasMultipleVisualizations()||e.getTemplateType()===s.AnalyticalListPage;const r=n.split("@")[0];if(a&&!m(t,o)){const t=e.getEntityType();const n=p(t);if(n){i.push({visualization:n,annotationPath:`${r}${e.getRelativeAnnotationPath(n.fullyQualifiedName,t)}`,converterContext:e})}}const l=t.Visualizations;const u=function(t){const n=l===null||l===void 0?void 0:l.find(n=>{var e;return t.indexOf((e=n.$target)===null||e===void 0?void 0:e.term)>=0});if(n){i.push({visualization:n.$target,annotationPath:`${r}${n.value}`,converterContext:e})}};if(o){u(["com.sap.vocabularies.UI.v1.LineItem"]);u(["com.sap.vocabularies.UI.v1.Chart"])}else{u(["com.sap.vocabularies.UI.v1.LineItem","com.sap.vocabularies.UI.v1.Chart"])}return i};o.getVisualizationsFromPresentationVariant=v;function f(t,n,e){if(n){const t=e.getEntityTypeAnnotation(n);const a=t.annotation;if(a){if(a.term==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){return a}}else{throw new Error("Annotation Path for the SPV mentioned in the manifest is not found, Please add the SPV in the annotation")}}else{var a,i;return(a=t.annotations)===null||a===void 0?void 0:(i=a.UI)===null||i===void 0?void 0:i.SelectionPresentationVariant}}o.getSelectionPresentationVariant=f;function d(t,n){const e=t&&t.PresentationVariant;if(e){return m(e,n)}else{throw new Error("Presentation Variant is not present in the SPV annotation")}}o.isSelectionPresentationCompliant=d;function m(t){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let e=false,a=false;if(n){if(t!==null&&t!==void 0&&t.Visualizations){const n=t.Visualizations;n.forEach(t=>{var n,i;if(((n=t.$target)===null||n===void 0?void 0:n.term)==="com.sap.vocabularies.UI.v1.LineItem"){e=true}if(((i=t.$target)===null||i===void 0?void 0:i.term)==="com.sap.vocabularies.UI.v1.Chart"){a=true}})}return a&&e}else{return(t===null||t===void 0?void 0:t.Visualizations)&&!!t.Visualizations.find(t=>{var n,e;return((n=t.$target)===null||n===void 0?void 0:n.term)==="com.sap.vocabularies.UI.v1.LineItem"||((e=t.$target)===null||e===void 0?void 0:e.term)==="com.sap.vocabularies.UI.v1.Chart"})}}o.isPresentationCompliant=m;function p(t){var n;return(n=t.annotations.UI)===null||n===void 0?void 0:n.LineItem}o.getDefaultLineItem=p;function h(t){var n;return(n=t.annotations.UI)===null||n===void 0?void 0:n.Chart}o.getDefaultChart=h;function g(t){var n,e;return(n=t.annotations)===null||n===void 0?void 0:(e=n.UI)===null||e===void 0?void 0:e.PresentationVariant}o.getDefaultPresentationVariant=g;function I(t){var n,e;return(n=t.annotations)===null||n===void 0?void 0:(e=n.UI)===null||e===void 0?void 0:e.SelectionVariant}o.getDefaultSelectionVariant=I;function P(t,n){const e=n.getManifestWrapper().getDefaultTemplateAnnotationPath();const a=f(t,e,n);let i;if(a){i=a.SelectionVariant;if(i){return i}}else{i=I(t);return i}}o.getSelectionVariant=P;function V(t,n,e,a,o,s,f){const d=t!==""?e.getEntityTypeAnnotation(t):{annotation:undefined,converterContext:e};const m=s?e.getEntityTypeAnnotation(s):null;const p=d.annotation;e=d.converterContext;let h=[];let g;let I="";let P,V;const b=p===null||p===void 0?void 0:p.term;if(b){switch(b){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":g=m===null||m===void 0?void 0:m.annotation;h.push({visualization:p,annotationPath:t,converterContext:e});break;case"com.sap.vocabularies.UI.v1.PresentationVariant":g=p;h=h.concat(v(p,t,e,f));break;case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":g=p.PresentationVariant;I=g.fullyQualifiedName;h=h.concat(v(g,t,e,f));break;default:break}h.forEach(t=>{const{visualization:e,annotationPath:s,converterContext:l}=t;switch(e.term){case"com.sap.vocabularies.UI.v1.Chart":P=r(e,s,l,o);break;case"com.sap.vocabularies.UI.v1.LineItem":default:V=i.createTableVisualization(e,s,l,g,n,a);break}})}else{V=i.createDefaultTableVisualization(e,!f);e.getDiagnostics().addIssue(c.Annotation,u.Medium,l.MISSING_LINEITEM)}const C=[];let U=b==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"?I:p&&p.fullyQualifiedName;if(U===undefined){U="/"}if(P){C.push(P)}if(V){C.push(V)}return{visualizations:C,annotationPath:e.getEntitySetBasedAnnotationPath(U)}}o.getDataVisualizationConfiguration=V;function b(t,e){const a=t.getObject(t.getPath()),i=n.createPresentationPathContext(t),o=t.getModel();if(n._isPresentationVariantAnnotation(i.getPath())){const n=a.Visualizations;if(Array.isArray(n)){for(let t=0;t<n.length;t++){if(n[t].$AnnotationPath.indexOf(e)!==-1){e=n[t].$AnnotationPath;break}}}return o.getMetaContext(t.getPath().split("@")[0]+e)}return t}o.getUiControl=b;return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Form-dbg", ["sap/fe/core/converters/annotations/DataField", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/templating/DataModelPathHelper", "../../../helpers/StableIdHelper", "../../helpers/ConfigurableObject", "../../helpers/DataFieldHelper", "../../helpers/ID", "../../helpers/Key", "../../ManifestSettings"], function (DataField, BindingToolkit, ModelHelper, DataModelPathHelper, StableIdHelper, ConfigurableObject, DataFieldHelper, ID, Key, ManifestSettings) {
  "use strict";

  var _exports = {};
  var ActionType = ManifestSettings.ActionType;
  var KeyHelper = Key.KeyHelper;
  var getFormStandardActionButtonID = ID.getFormStandardActionButtonID;
  var getFormID = ID.getFormID;
  var isReferencePropertyStaticallyHidden = DataFieldHelper.isReferencePropertyStaticallyHidden;
  var Placement = ConfigurableObject.Placement;
  var OverrideType = ConfigurableObject.OverrideType;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var createIdForAnnotation = StableIdHelper.createIdForAnnotation;
  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var getTargetEntitySetPath = DataModelPathHelper.getTargetEntitySetPath;
  var pathInModel = BindingToolkit.pathInModel;
  var not = BindingToolkit.not;
  var ifElse = BindingToolkit.ifElse;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var equal = BindingToolkit.equal;
  var compileExpression = BindingToolkit.compileExpression;
  var getSemanticObjectPath = DataField.getSemanticObjectPath;
  let FormElementType;
  (function (FormElementType) {
    FormElementType["Default"] = "Default";
    FormElementType["Slot"] = "Slot";
    FormElementType["Annotation"] = "Annotation";
  })(FormElementType || (FormElementType = {}));
  _exports.FormElementType = FormElementType;
  /**
   * Returns default format options for text fields on a form.
   *
   * @returns Collection of format options with default values
   */
  function getDefaultFormatOptionsForForm() {
    return {
      textLinesEdit: 4
    };
  }
  function isFieldPartOfPreview(field, formPartOfPreview) {
    var _field$annotations, _field$annotations$UI, _field$annotations2, _field$annotations2$U;
    // Both each form and field can have the PartOfPreview annotation. Only if the form is not hidden (not partOfPreview) we allow toggling on field level
    return (formPartOfPreview === null || formPartOfPreview === void 0 ? void 0 : formPartOfPreview.valueOf()) === false || ((_field$annotations = field.annotations) === null || _field$annotations === void 0 ? void 0 : (_field$annotations$UI = _field$annotations.UI) === null || _field$annotations$UI === void 0 ? void 0 : _field$annotations$UI.PartOfPreview) === undefined || ((_field$annotations2 = field.annotations) === null || _field$annotations2 === void 0 ? void 0 : (_field$annotations2$U = _field$annotations2.UI) === null || _field$annotations2$U === void 0 ? void 0 : _field$annotations2$U.PartOfPreview.valueOf()) === true;
  }
  function getFormElementsFromAnnotations(facetDefinition, converterContext) {
    const formElements = [];
    const resolvedTarget = converterContext.getEntityTypeAnnotation(facetDefinition.Target.value);
    const formAnnotation = resolvedTarget.annotation;
    converterContext = resolvedTarget.converterContext;
    function getDataFieldsFromAnnotations(field, formPartOfPreview) {
      var _field$annotations3, _field$annotations3$U, _field$annotations3$U2;
      const semanticObjectAnnotationPath = getSemanticObjectPath(converterContext, field);
      if (field.$Type !== "com.sap.vocabularies.UI.v1.DataFieldForAction" && field.$Type !== "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation" && !isReferencePropertyStaticallyHidden(field) && ((_field$annotations3 = field.annotations) === null || _field$annotations3 === void 0 ? void 0 : (_field$annotations3$U = _field$annotations3.UI) === null || _field$annotations3$U === void 0 ? void 0 : (_field$annotations3$U2 = _field$annotations3$U.Hidden) === null || _field$annotations3$U2 === void 0 ? void 0 : _field$annotations3$U2.valueOf()) !== true) {
        const formElement = {
          key: KeyHelper.generateKeyFromDataField(field),
          type: FormElementType.Annotation,
          annotationPath: `${converterContext.getEntitySetBasedAnnotationPath(field.fullyQualifiedName)}/`,
          semanticObjectPath: semanticObjectAnnotationPath,
          formatOptions: getDefaultFormatOptionsForForm(),
          isPartOfPreview: isFieldPartOfPreview(field, formPartOfPreview)
        };
        if (field.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && field.Target.$target.$Type === "com.sap.vocabularies.UI.v1.ConnectedFieldsType") {
          const connectedFields = Object.values(field.Target.$target.Data).filter(connectedField => connectedField === null || connectedField === void 0 ? void 0 : connectedField.hasOwnProperty("Value"));
          formElement.connectedFields = connectedFields.map(connnectedFieldElement => {
            return {
              semanticObjectPath: getSemanticObjectPath(converterContext, connnectedFieldElement)
            };
          });
        }
        formElements.push(formElement);
      }
    }
    switch (formAnnotation === null || formAnnotation === void 0 ? void 0 : formAnnotation.term) {
      case "com.sap.vocabularies.UI.v1.FieldGroup":
        formAnnotation.Data.forEach(field => {
          var _facetDefinition$anno, _facetDefinition$anno2;
          return getDataFieldsFromAnnotations(field, (_facetDefinition$anno = facetDefinition.annotations) === null || _facetDefinition$anno === void 0 ? void 0 : (_facetDefinition$anno2 = _facetDefinition$anno.UI) === null || _facetDefinition$anno2 === void 0 ? void 0 : _facetDefinition$anno2.PartOfPreview);
        });
        break;
      case "com.sap.vocabularies.UI.v1.Identification":
        formAnnotation.forEach(field => {
          var _facetDefinition$anno3, _facetDefinition$anno4;
          return getDataFieldsFromAnnotations(field, (_facetDefinition$anno3 = facetDefinition.annotations) === null || _facetDefinition$anno3 === void 0 ? void 0 : (_facetDefinition$anno4 = _facetDefinition$anno3.UI) === null || _facetDefinition$anno4 === void 0 ? void 0 : _facetDefinition$anno4.PartOfPreview);
        });
        break;
      case "com.sap.vocabularies.UI.v1.DataPoint":
        formElements.push({
          // key: KeyHelper.generateKeyFromDataField(formAnnotation),
          key: `DataPoint::${formAnnotation.qualifier ? formAnnotation.qualifier : ""}`,
          type: FormElementType.Annotation,
          annotationPath: `${converterContext.getEntitySetBasedAnnotationPath(formAnnotation.fullyQualifiedName)}/`
        });
        break;
      case "com.sap.vocabularies.Communication.v1.Contact":
        formElements.push({
          // key: KeyHelper.generateKeyFromDataField(formAnnotation),
          key: `Contact::${formAnnotation.qualifier ? formAnnotation.qualifier : ""}`,
          type: FormElementType.Annotation,
          annotationPath: `${converterContext.getEntitySetBasedAnnotationPath(formAnnotation.fullyQualifiedName)}/`
        });
        break;
      default:
        break;
    }
    return formElements;
  }
  function getFormElementsFromManifest(facetDefinition, converterContext) {
    const manifestWrapper = converterContext.getManifestWrapper();
    const manifestFormContainer = manifestWrapper.getFormContainer(facetDefinition.Target.value);
    const formElements = {};
    if (manifestFormContainer !== null && manifestFormContainer !== void 0 && manifestFormContainer.fields) {
      Object.keys(manifestFormContainer === null || manifestFormContainer === void 0 ? void 0 : manifestFormContainer.fields).forEach(fieldId => {
        formElements[fieldId] = {
          key: fieldId,
          id: `CustomFormElement::${fieldId}`,
          type: manifestFormContainer.fields[fieldId].type || FormElementType.Default,
          template: manifestFormContainer.fields[fieldId].template,
          label: manifestFormContainer.fields[fieldId].label,
          position: manifestFormContainer.fields[fieldId].position || {
            placement: Placement.After
          },
          formatOptions: {
            ...getDefaultFormatOptionsForForm(),
            ...manifestFormContainer.fields[fieldId].formatOptions
          }
        };
      });
    }
    return formElements;
  }
  _exports.getFormElementsFromManifest = getFormElementsFromManifest;
  function getFormContainer(facetDefinition, converterContext, actions) {
    var _facetDefinition$anno5, _facetDefinition$anno6, _resolvedTarget$conve, _facetDefinition$anno7, _facetDefinition$anno8, _facetDefinition$anno9;
    const sFormContainerId = createIdForAnnotation(facetDefinition);
    const sAnnotationPath = converterContext.getEntitySetBasedAnnotationPath(facetDefinition.fullyQualifiedName);
    const resolvedTarget = converterContext.getEntityTypeAnnotation(facetDefinition.Target.value);
    const isVisible = compileExpression(not(equal(true, getExpressionFromAnnotation((_facetDefinition$anno5 = facetDefinition.annotations) === null || _facetDefinition$anno5 === void 0 ? void 0 : (_facetDefinition$anno6 = _facetDefinition$anno5.UI) === null || _facetDefinition$anno6 === void 0 ? void 0 : _facetDefinition$anno6.Hidden))));
    let sEntitySetPath;
    // resolvedTarget doesn't have a entitySet in case Containments and Paramterized services.
    if (resolvedTarget.converterContext.getEntitySet() && resolvedTarget.converterContext.getEntitySet() !== converterContext.getEntitySet()) {
      sEntitySetPath = getTargetEntitySetPath(resolvedTarget.converterContext.getDataModelObjectPath());
    } else if (((_resolvedTarget$conve = resolvedTarget.converterContext.getDataModelObjectPath().targetObject) === null || _resolvedTarget$conve === void 0 ? void 0 : _resolvedTarget$conve.containsTarget) === true) {
      sEntitySetPath = getTargetObjectPath(resolvedTarget.converterContext.getDataModelObjectPath(), false);
    } else if (resolvedTarget.converterContext.getEntitySet() && !sEntitySetPath && ModelHelper.isSingleton(resolvedTarget.converterContext.getEntitySet())) {
      var _resolvedTarget$conve2;
      sEntitySetPath = (_resolvedTarget$conve2 = resolvedTarget.converterContext.getEntitySet()) === null || _resolvedTarget$conve2 === void 0 ? void 0 : _resolvedTarget$conve2.fullyQualifiedName;
    }
    const aFormElements = insertCustomElements(getFormElementsFromAnnotations(facetDefinition, converterContext), getFormElementsFromManifest(facetDefinition, converterContext), {
      formatOptions: OverrideType.overwrite
    });
    actions = actions !== undefined ? actions.filter(action => action.facetName == facetDefinition.fullyQualifiedName) : [];
    if (actions.length === 0) {
      actions = undefined;
    }
    const oActionShowDetails = {
      id: getFormStandardActionButtonID(sFormContainerId, "ShowHideDetails"),
      key: "StandardAction::ShowHideDetails",
      text: compileExpression(ifElse(equal(pathInModel("showDetails", "internal"), true), pathInModel("T_COMMON_OBJECT_PAGE_HIDE_FORM_CONTAINER_DETAILS", "sap.fe.i18n"), pathInModel("T_COMMON_OBJECT_PAGE_SHOW_FORM_CONTAINER_DETAILS", "sap.fe.i18n"))),
      type: ActionType.ShowFormDetails,
      press: "FormContainerRuntime.toggleDetails"
    };
    if (((_facetDefinition$anno7 = facetDefinition.annotations) === null || _facetDefinition$anno7 === void 0 ? void 0 : (_facetDefinition$anno8 = _facetDefinition$anno7.UI) === null || _facetDefinition$anno8 === void 0 ? void 0 : (_facetDefinition$anno9 = _facetDefinition$anno8.PartOfPreview) === null || _facetDefinition$anno9 === void 0 ? void 0 : _facetDefinition$anno9.valueOf()) !== false && aFormElements.some(oFormElement => oFormElement.isPartOfPreview === false)) {
      if (actions !== undefined) {
        actions.push(oActionShowDetails);
      } else {
        actions = [oActionShowDetails];
      }
    }
    return {
      id: sFormContainerId,
      formElements: aFormElements,
      annotationPath: sAnnotationPath,
      isVisible: isVisible,
      entitySet: sEntitySetPath,
      actions: actions
    };
  }
  _exports.getFormContainer = getFormContainer;
  function getFormContainersForCollection(facetDefinition, converterContext, actions) {
    var _facetDefinition$Face;
    const formContainers = [];
    (_facetDefinition$Face = facetDefinition.Facets) === null || _facetDefinition$Face === void 0 ? void 0 : _facetDefinition$Face.forEach(facet => {
      // Ignore level 3 collection facet
      if (facet.$Type === "com.sap.vocabularies.UI.v1.CollectionFacet") {
        return;
      }
      formContainers.push(getFormContainer(facet, converterContext, actions));
    });
    return formContainers;
  }
  function isReferenceFacet(facetDefinition) {
    return facetDefinition.$Type === "com.sap.vocabularies.UI.v1.ReferenceFacet";
  }
  _exports.isReferenceFacet = isReferenceFacet;
  function createFormDefinition(facetDefinition, isVisible, converterContext, actions) {
    var _facetDefinition$anno10, _facetDefinition$anno11, _facetDefinition$anno12;
    switch (facetDefinition.$Type) {
      case "com.sap.vocabularies.UI.v1.CollectionFacet":
        // Keep only valid children
        return {
          id: getFormID(facetDefinition),
          useFormContainerLabels: true,
          hasFacetsNotPartOfPreview: facetDefinition.Facets.some(childFacet => {
            var _childFacet$annotatio, _childFacet$annotatio2, _childFacet$annotatio3;
            return ((_childFacet$annotatio = childFacet.annotations) === null || _childFacet$annotatio === void 0 ? void 0 : (_childFacet$annotatio2 = _childFacet$annotatio.UI) === null || _childFacet$annotatio2 === void 0 ? void 0 : (_childFacet$annotatio3 = _childFacet$annotatio2.PartOfPreview) === null || _childFacet$annotatio3 === void 0 ? void 0 : _childFacet$annotatio3.valueOf()) === false;
          }),
          formContainers: getFormContainersForCollection(facetDefinition, converterContext, actions),
          isVisible: isVisible
        };
      case "com.sap.vocabularies.UI.v1.ReferenceFacet":
        return {
          id: getFormID(facetDefinition),
          useFormContainerLabels: false,
          hasFacetsNotPartOfPreview: ((_facetDefinition$anno10 = facetDefinition.annotations) === null || _facetDefinition$anno10 === void 0 ? void 0 : (_facetDefinition$anno11 = _facetDefinition$anno10.UI) === null || _facetDefinition$anno11 === void 0 ? void 0 : (_facetDefinition$anno12 = _facetDefinition$anno11.PartOfPreview) === null || _facetDefinition$anno12 === void 0 ? void 0 : _facetDefinition$anno12.valueOf()) === false,
          formContainers: [getFormContainer(facetDefinition, converterContext, actions)],
          isVisible: isVisible
        };
      default:
        throw new Error("Cannot create form based on ReferenceURLFacet");
    }
  }
  _exports.createFormDefinition = createFormDefinition;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Form", ["sap/fe/core/converters/annotations/DataField","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","../../../helpers/StableIdHelper","../../helpers/ConfigurableObject","../../helpers/DataFieldHelper","../../helpers/ID","../../helpers/Key","../../ManifestSettings"],function(e,t,a,n,o,i,r,l,s,v){"use strict";var c={};var d=v.ActionType;var u=s.KeyHelper;var f=l.getFormStandardActionButtonID;var p=l.getFormID;var m=r.isReferencePropertyStaticallyHidden;var y=i.Placement;var g=i.OverrideType;var P=i.insertCustomElements;var h=o.createIdForAnnotation;var O=n.getTargetObjectPath;var F=n.getTargetEntitySetPath;var b=t.pathInModel;var E=t.not;var I=t.ifElse;var C=t.getExpressionFromAnnotation;var T=t.equal;var D=t.compileExpression;var S=e.getSemanticObjectPath;let A;(function(e){e["Default"]="Default";e["Slot"]="Slot";e["Annotation"]="Annotation"})(A||(A={}));c.FormElementType=A;function w(){return{textLinesEdit:4}}function U(e,t){var a,n,o,i;return(t===null||t===void 0?void 0:t.valueOf())===false||((a=e.annotations)===null||a===void 0?void 0:(n=a.UI)===null||n===void 0?void 0:n.PartOfPreview)===undefined||((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:i.PartOfPreview.valueOf())===true}function N(e,t){const a=[];const n=t.getEntityTypeAnnotation(e.Target.value);const o=n.annotation;t=n.converterContext;function i(e,n){var o,i,r;const l=S(t,e);if(e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&!m(e)&&((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:(r=i.Hidden)===null||r===void 0?void 0:r.valueOf())!==true){const o={key:u.generateKeyFromDataField(e),type:A.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,semanticObjectPath:l,formatOptions:w(),isPartOfPreview:U(e,n)};if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&e.Target.$target.$Type==="com.sap.vocabularies.UI.v1.ConnectedFieldsType"){const a=Object.values(e.Target.$target.Data).filter(e=>e===null||e===void 0?void 0:e.hasOwnProperty("Value"));o.connectedFields=a.map(e=>({semanticObjectPath:S(t,e)}))}a.push(o)}}switch(o===null||o===void 0?void 0:o.term){case"com.sap.vocabularies.UI.v1.FieldGroup":o.Data.forEach(t=>{var a,n;return i(t,(a=e.annotations)===null||a===void 0?void 0:(n=a.UI)===null||n===void 0?void 0:n.PartOfPreview)});break;case"com.sap.vocabularies.UI.v1.Identification":o.forEach(t=>{var a,n;return i(t,(a=e.annotations)===null||a===void 0?void 0:(n=a.UI)===null||n===void 0?void 0:n.PartOfPreview)});break;case"com.sap.vocabularies.UI.v1.DataPoint":a.push({key:`DataPoint::${o.qualifier?o.qualifier:""}`,type:A.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName)}/`});break;case"com.sap.vocabularies.Communication.v1.Contact":a.push({key:`Contact::${o.qualifier?o.qualifier:""}`,type:A.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName)}/`});break;default:break}return a}function M(e,t){const a=t.getManifestWrapper();const n=a.getFormContainer(e.Target.value);const o={};if(n!==null&&n!==void 0&&n.fields){Object.keys(n===null||n===void 0?void 0:n.fields).forEach(e=>{o[e]={key:e,id:`CustomFormElement::${e}`,type:n.fields[e].type||A.Default,template:n.fields[e].template,label:n.fields[e].label,position:n.fields[e].position||{placement:y.After},formatOptions:{...w(),...n.fields[e].formatOptions}}})}return o}c.getFormElementsFromManifest=M;function $(e,t,n){var o,i,r,l,s,v;const c=h(e);const u=t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName);const p=t.getEntityTypeAnnotation(e.Target.value);const m=D(E(T(true,C((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:i.Hidden))));let y;if(p.converterContext.getEntitySet()&&p.converterContext.getEntitySet()!==t.getEntitySet()){y=F(p.converterContext.getDataModelObjectPath())}else if(((r=p.converterContext.getDataModelObjectPath().targetObject)===null||r===void 0?void 0:r.containsTarget)===true){y=O(p.converterContext.getDataModelObjectPath(),false)}else if(p.converterContext.getEntitySet()&&!y&&a.isSingleton(p.converterContext.getEntitySet())){var S;y=(S=p.converterContext.getEntitySet())===null||S===void 0?void 0:S.fullyQualifiedName}const A=P(N(e,t),M(e,t),{formatOptions:g.overwrite});n=n!==undefined?n.filter(t=>t.facetName==e.fullyQualifiedName):[];if(n.length===0){n=undefined}const w={id:f(c,"ShowHideDetails"),key:"StandardAction::ShowHideDetails",text:D(I(T(b("showDetails","internal"),true),b("T_COMMON_OBJECT_PAGE_HIDE_FORM_CONTAINER_DETAILS","sap.fe.i18n"),b("T_COMMON_OBJECT_PAGE_SHOW_FORM_CONTAINER_DETAILS","sap.fe.i18n"))),type:d.ShowFormDetails,press:"FormContainerRuntime.toggleDetails"};if(((l=e.annotations)===null||l===void 0?void 0:(s=l.UI)===null||s===void 0?void 0:(v=s.PartOfPreview)===null||v===void 0?void 0:v.valueOf())!==false&&A.some(e=>e.isPartOfPreview===false)){if(n!==undefined){n.push(w)}else{n=[w]}}return{id:c,formElements:A,annotationPath:u,isVisible:m,entitySet:y,actions:n}}c.getFormContainer=$;function _(e,t,a){var n;const o=[];(n=e.Facets)===null||n===void 0?void 0:n.forEach(e=>{if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return}o.push($(e,t,a))});return o}function x(e){return e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"}c.isReferenceFacet=x;function k(e,t,a,n){var o,i,r;switch(e.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":return{id:p(e),useFormContainerLabels:true,hasFacetsNotPartOfPreview:e.Facets.some(e=>{var t,a,n;return((t=e.annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(n=a.PartOfPreview)===null||n===void 0?void 0:n.valueOf())===false}),formContainers:_(e,a,n),isVisible:t};case"com.sap.vocabularies.UI.v1.ReferenceFacet":return{id:p(e),useFormContainerLabels:false,hasFacetsNotPartOfPreview:((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:(r=i.PartOfPreview)===null||r===void 0?void 0:r.valueOf())===false,formContainers:[$(e,a,n)],isVisible:t};default:throw new Error("Cannot create form based on ReferenceURLFacet")}}c.createFormDefinition=k;return c},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/KPI-dbg", ["sap/fe/core/converters/helpers/IssueManager", "sap/fe/core/converters/helpers/SelectionVariantHelper", "sap/fe/core/formatters/TableFormatterTypes", "sap/fe/core/templating/PropertyHelper", "../../helpers/Aggregation", "../../helpers/ID", "./Criticality"], function (IssueManager, SelectionVariantHelper, TableFormatterTypes, PropertyHelper, Aggregation, ID, Criticality) {
  "use strict";

  var _exports = {};
  var getMessageTypeFromCriticalityType = Criticality.getMessageTypeFromCriticalityType;
  var getKPIID = ID.getKPIID;
  var AggregationHelper = Aggregation.AggregationHelper;
  var isPathExpression = PropertyHelper.isPathExpression;
  var MessageType = TableFormatterTypes.MessageType;
  var getFilterDefinitionsFromSelectionVariant = SelectionVariantHelper.getFilterDefinitionsFromSelectionVariant;
  var IssueType = IssueManager.IssueType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategory = IssueManager.IssueCategory;
  const DeviationIndicatorFromTrendType = {
    "UI.TrendType/StrongUp": "Up",
    "UI.TrendType/Up": "Up",
    "UI.TrendType/StrongDown": "Down",
    "UI.TrendType/Down": "Down",
    "UI.TrendType/Sideways": "None"
  };
  const KPIChartTypeFromUI = {
    "UI.ChartType/ColumnStacked": "StackedColumn",
    "UI.ChartType/BarStacked": "StackedBar",
    "UI.ChartType/Donut": "Donut",
    "UI.ChartType/Line": "Line",
    "UI.ChartType/Bubble": "bubble",
    "UI.ChartType/Column": "column",
    "UI.ChartType/Bar": "bar",
    "UI.ChartType/VerticalBullet": "vertical_bullet",
    "UI.ChartType/Combination": "combination",
    "UI.ChartType/Scatter": "scatter"
  };
  function convertKPIChart(chartAnnotation, presentationVariantAnnotation) {
    var _presentationVariantA, _presentationVariantA2;
    if (chartAnnotation.Measures === undefined) {
      // We need at least 1 measure (but no dimension is allowed, e.g. for bubble chart)
      return undefined;
    }
    const charDimensions = chartAnnotation.Dimensions ? chartAnnotation.Dimensions.map(propertyPath => {
      var _chartAnnotation$Dime, _propertyPath$$target, _propertyPath$$target2, _dimAttribute$Role;
      const dimAttribute = (_chartAnnotation$Dime = chartAnnotation.DimensionAttributes) === null || _chartAnnotation$Dime === void 0 ? void 0 : _chartAnnotation$Dime.find(attribute => {
        var _attribute$Dimension;
        return ((_attribute$Dimension = attribute.Dimension) === null || _attribute$Dimension === void 0 ? void 0 : _attribute$Dimension.value) === propertyPath.value;
      });
      return {
        name: propertyPath.value,
        label: ((_propertyPath$$target = propertyPath.$target.annotations.Common) === null || _propertyPath$$target === void 0 ? void 0 : (_propertyPath$$target2 = _propertyPath$$target.Label) === null || _propertyPath$$target2 === void 0 ? void 0 : _propertyPath$$target2.toString()) || propertyPath.value,
        role: dimAttribute === null || dimAttribute === void 0 ? void 0 : (_dimAttribute$Role = dimAttribute.Role) === null || _dimAttribute$Role === void 0 ? void 0 : _dimAttribute$Role.replace("UI.ChartDimensionRoleType/", "")
      };
    }) : [];
    const chartMeasures = chartAnnotation.Measures.map(propertyPath => {
      var _chartAnnotation$Meas, _propertyPath$$target3, _propertyPath$$target4, _measureAttribute$Rol;
      const measureAttribute = (_chartAnnotation$Meas = chartAnnotation.MeasureAttributes) === null || _chartAnnotation$Meas === void 0 ? void 0 : _chartAnnotation$Meas.find(attribute => {
        var _attribute$Measure;
        return ((_attribute$Measure = attribute.Measure) === null || _attribute$Measure === void 0 ? void 0 : _attribute$Measure.value) === propertyPath.value;
      });
      return {
        name: propertyPath.value,
        label: ((_propertyPath$$target3 = propertyPath.$target.annotations.Common) === null || _propertyPath$$target3 === void 0 ? void 0 : (_propertyPath$$target4 = _propertyPath$$target3.Label) === null || _propertyPath$$target4 === void 0 ? void 0 : _propertyPath$$target4.toString()) || propertyPath.value,
        role: measureAttribute === null || measureAttribute === void 0 ? void 0 : (_measureAttribute$Rol = measureAttribute.Role) === null || _measureAttribute$Rol === void 0 ? void 0 : _measureAttribute$Rol.replace("UI.ChartMeasureRoleType/", "")
      };
    });
    return {
      chartType: KPIChartTypeFromUI[chartAnnotation.ChartType] || "Line",
      dimensions: charDimensions,
      measures: chartMeasures,
      sortOrder: presentationVariantAnnotation === null || presentationVariantAnnotation === void 0 ? void 0 : (_presentationVariantA = presentationVariantAnnotation.SortOrder) === null || _presentationVariantA === void 0 ? void 0 : _presentationVariantA.map(sortOrder => {
        var _sortOrder$Property;
        return {
          name: ((_sortOrder$Property = sortOrder.Property) === null || _sortOrder$Property === void 0 ? void 0 : _sortOrder$Property.value) || "",
          descending: !!sortOrder.Descending
        };
      }),
      maxItems: presentationVariantAnnotation === null || presentationVariantAnnotation === void 0 ? void 0 : (_presentationVariantA2 = presentationVariantAnnotation.MaxItems) === null || _presentationVariantA2 === void 0 ? void 0 : _presentationVariantA2.valueOf()
    };
  }
  function updateCurrency(datapointAnnotation, kpiDef) {
    var _targetValueProperty$, _targetValueProperty$3;
    const targetValueProperty = datapointAnnotation.Value.$target;
    if ((_targetValueProperty$ = targetValueProperty.annotations.Measures) !== null && _targetValueProperty$ !== void 0 && _targetValueProperty$.ISOCurrency) {
      var _targetValueProperty$2;
      const currency = (_targetValueProperty$2 = targetValueProperty.annotations.Measures) === null || _targetValueProperty$2 === void 0 ? void 0 : _targetValueProperty$2.ISOCurrency;
      if (isPathExpression(currency)) {
        kpiDef.datapoint.unit = {
          value: currency.$target.name,
          isCurrency: true,
          isPath: true
        };
      } else {
        kpiDef.datapoint.unit = {
          value: currency.toString(),
          isCurrency: true,
          isPath: false
        };
      }
    } else if ((_targetValueProperty$3 = targetValueProperty.annotations.Measures) !== null && _targetValueProperty$3 !== void 0 && _targetValueProperty$3.Unit) {
      var _targetValueProperty$4;
      const unit = (_targetValueProperty$4 = targetValueProperty.annotations.Measures) === null || _targetValueProperty$4 === void 0 ? void 0 : _targetValueProperty$4.Unit;
      if (isPathExpression(unit)) {
        kpiDef.datapoint.unit = {
          value: unit.$target.name,
          isCurrency: false,
          isPath: true
        };
      } else {
        kpiDef.datapoint.unit = {
          value: unit.toString(),
          isCurrency: false,
          isPath: false
        };
      }
    }
  }
  function updateCriticality(datapointAnnotation, aggregationHelper, kpiDef) {
    if (datapointAnnotation.Criticality) {
      if (typeof datapointAnnotation.Criticality === "object") {
        // Criticality is a path --> check if the corresponding property is aggregatable
        const criticalityProperty = datapointAnnotation.Criticality.$target;
        if (aggregationHelper.isPropertyAggregatable(criticalityProperty)) {
          kpiDef.datapoint.criticalityPath = datapointAnnotation.Criticality.path;
        } else {
          // The property isn't aggregatable --> we ignore it
          kpiDef.datapoint.criticalityValue = MessageType.None;
        }
      } else {
        // Criticality is an enum Value --> get the corresponding static value
        kpiDef.datapoint.criticalityValue = getMessageTypeFromCriticalityType(datapointAnnotation.Criticality);
      }
    } else if (datapointAnnotation.CriticalityCalculation) {
      kpiDef.datapoint.criticalityCalculationMode = datapointAnnotation.CriticalityCalculation.ImprovementDirection;
      kpiDef.datapoint.criticalityCalculationThresholds = [];
      switch (kpiDef.datapoint.criticalityCalculationMode) {
        case "UI.ImprovementDirectionType/Target":
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.DeviationRangeLowValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.ToleranceRangeLowValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.AcceptanceRangeLowValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.AcceptanceRangeHighValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.ToleranceRangeHighValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.DeviationRangeHighValue);
          break;
        case "UI.ImprovementDirectionType/Minimize":
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.AcceptanceRangeHighValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.ToleranceRangeHighValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.DeviationRangeHighValue);
          break;
        case "UI.ImprovementDirectionType/Maximize":
        default:
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.DeviationRangeLowValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.ToleranceRangeLowValue);
          kpiDef.datapoint.criticalityCalculationThresholds.push(datapointAnnotation.CriticalityCalculation.AcceptanceRangeLowValue);
      }
    } else {
      kpiDef.datapoint.criticalityValue = MessageType.None;
    }
  }
  function updateTrend(datapointAnnotation, aggregationHelper, kpiDef) {
    if (datapointAnnotation.Trend) {
      if (typeof datapointAnnotation.Trend === "object") {
        // Trend is a path --> check if the corresponding property is aggregatable
        const trendProperty = datapointAnnotation.Trend.$target;
        if (aggregationHelper.isPropertyAggregatable(trendProperty)) {
          kpiDef.datapoint.trendPath = datapointAnnotation.Trend.path;
        } else {
          // The property isn't aggregatable --> we ignore it
          kpiDef.datapoint.trendValue = "None";
        }
      } else {
        // Trend is an enum Value --> get the corresponding static value
        kpiDef.datapoint.trendValue = DeviationIndicatorFromTrendType[datapointAnnotation.Trend] || "None";
      }
    } else if (datapointAnnotation.TrendCalculation) {
      kpiDef.datapoint.trendCalculationIsRelative = datapointAnnotation.TrendCalculation.IsRelativeDifference ? true : false;
      if (datapointAnnotation.TrendCalculation.ReferenceValue.$target) {
        // Reference value is a path --> check if the corresponding property is aggregatable
        const referenceProperty = datapointAnnotation.TrendCalculation.ReferenceValue.$target;
        if (aggregationHelper.isPropertyAggregatable(referenceProperty)) {
          kpiDef.datapoint.trendCalculationReferencePath = datapointAnnotation.TrendCalculation.ReferenceValue.path;
        } else {
          // The property isn't aggregatable --> we ignore it and switch back to trend 'None'
          kpiDef.datapoint.trendValue = "None";
        }
      } else {
        // Reference value is a static value
        kpiDef.datapoint.trendCalculationReferenceValue = datapointAnnotation.TrendCalculation.ReferenceValue;
      }
      if (kpiDef.datapoint.trendCalculationReferencePath !== undefined || kpiDef.datapoint.trendCalculationReferenceValue !== undefined) {
        kpiDef.datapoint.trendCalculationTresholds = [datapointAnnotation.TrendCalculation.StrongDownDifference.valueOf(), datapointAnnotation.TrendCalculation.DownDifference.valueOf(), datapointAnnotation.TrendCalculation.UpDifference.valueOf(), datapointAnnotation.TrendCalculation.StrongUpDifference.valueOf()];
      }
    } else {
      kpiDef.datapoint.trendValue = "None";
    }
  }
  function updateTarget(datapointAnnotation, aggregationHelper, kpiDef) {
    if (datapointAnnotation.TargetValue) {
      if (datapointAnnotation.TargetValue.$target) {
        // Target value is a path --> check if the corresponding property is aggregatable (otherwise ignore)
        const targetProperty = datapointAnnotation.TargetValue.$target;
        if (aggregationHelper.isPropertyAggregatable(targetProperty)) {
          kpiDef.datapoint.targetPath = datapointAnnotation.TargetValue.path;
        }
      } else {
        // Target value is a static value
        kpiDef.datapoint.targetValue = datapointAnnotation.TargetValue;
      }
    }
  }
  function getNavigationInfoFromProperty(property) {
    const annotations = property.annotations["Common"] || {};

    // Look for the semanticObject annotation (if any)
    let semanticObjectAnnotation;
    Object.keys(annotations).forEach(annotationKey => {
      const annotation = annotations[annotationKey];
      if (annotation.term === "com.sap.vocabularies.Common.v1.SemanticObject") {
        if (!annotation.qualifier || !semanticObjectAnnotation) {
          // We always take the annotation without qualifier if there's one, otherwise we take the first one
          semanticObjectAnnotation = annotation;
        }
      }
    });
    if (semanticObjectAnnotation) {
      const result = {
        semanticObject: semanticObjectAnnotation.toString(),
        unavailableActions: []
      };

      // Look for the unavailable actions (if any)
      const annotationKey = Object.keys(annotations).find(key => {
        var _semanticObjectAnnota;
        return annotations[key].term === "com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions" && annotations[key].qualifier === ((_semanticObjectAnnota = semanticObjectAnnotation) === null || _semanticObjectAnnota === void 0 ? void 0 : _semanticObjectAnnota.qualifier);
      });
      if (annotationKey) {
        result.unavailableActions = annotations[annotationKey];
      }
      return result;
    } else {
      return undefined;
    }
  }
  function createKPIDefinition(kpiName, kpiConfig, converterContext) {
    var _datapointAnnotation$, _datapointAnnotation$2;
    const kpiConverterContext = converterContext.getConverterContextFor(`/${kpiConfig.entitySet}`);
    const aggregationHelper = new AggregationHelper(kpiConverterContext.getEntityType(), kpiConverterContext);
    if (!aggregationHelper.isAnalyticsSupported()) {
      // The entity doesn't support analytical queries
      converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Medium, IssueType.KPI_ISSUES.NO_ANALYTICS + kpiConfig.entitySet);
      return undefined;
    }
    let selectionVariantAnnotation;
    let datapointAnnotation;
    let presentationVariantAnnotation;
    let chartAnnotation;
    let navigationInfo;

    // Search for a KPI with the qualifier frmo the manifest
    const aKPIAnnotations = kpiConverterContext.getAnnotationsByTerm("UI", "com.sap.vocabularies.UI.v1.KPI");
    const targetKPI = aKPIAnnotations.find(kpi => {
      return kpi.qualifier === kpiConfig.qualifier;
    });
    if (targetKPI) {
      var _targetKPI$Detail, _presentationVariantA3, _presentationVariantA4, _presentationVariantA5, _targetKPI$Detail2;
      datapointAnnotation = targetKPI.DataPoint;
      selectionVariantAnnotation = targetKPI.SelectionVariant;
      presentationVariantAnnotation = (_targetKPI$Detail = targetKPI.Detail) === null || _targetKPI$Detail === void 0 ? void 0 : _targetKPI$Detail.DefaultPresentationVariant;
      chartAnnotation = (_presentationVariantA3 = presentationVariantAnnotation) === null || _presentationVariantA3 === void 0 ? void 0 : (_presentationVariantA4 = _presentationVariantA3.Visualizations) === null || _presentationVariantA4 === void 0 ? void 0 : (_presentationVariantA5 = _presentationVariantA4.find(viz => {
        return viz.$target.$Type === "com.sap.vocabularies.UI.v1.ChartDefinitionType";
      })) === null || _presentationVariantA5 === void 0 ? void 0 : _presentationVariantA5.$target;
      if ((_targetKPI$Detail2 = targetKPI.Detail) !== null && _targetKPI$Detail2 !== void 0 && _targetKPI$Detail2.SemanticObject) {
        var _targetKPI$Detail$Act;
        navigationInfo = {
          semanticObject: targetKPI.Detail.SemanticObject.toString(),
          action: (_targetKPI$Detail$Act = targetKPI.Detail.Action) === null || _targetKPI$Detail$Act === void 0 ? void 0 : _targetKPI$Detail$Act.toString(),
          unavailableActions: []
        };
      }
    } else {
      // Fallback: try to find a SPV with the same qualifier
      const aSPVAnnotations = kpiConverterContext.getAnnotationsByTerm("UI", "com.sap.vocabularies.UI.v1.SelectionPresentationVariant");
      const targetSPV = aSPVAnnotations.find(spv => {
        return spv.qualifier === kpiConfig.qualifier;
      });
      if (targetSPV) {
        var _presentationVariantA6, _presentationVariantA7, _presentationVariantA8, _presentationVariantA9, _presentationVariantA10, _presentationVariantA11;
        selectionVariantAnnotation = targetSPV.SelectionVariant;
        presentationVariantAnnotation = targetSPV.PresentationVariant;
        datapointAnnotation = (_presentationVariantA6 = presentationVariantAnnotation) === null || _presentationVariantA6 === void 0 ? void 0 : (_presentationVariantA7 = _presentationVariantA6.Visualizations) === null || _presentationVariantA7 === void 0 ? void 0 : (_presentationVariantA8 = _presentationVariantA7.find(viz => {
          return viz.$target.$Type === "com.sap.vocabularies.UI.v1.DataPointType";
        })) === null || _presentationVariantA8 === void 0 ? void 0 : _presentationVariantA8.$target;
        chartAnnotation = (_presentationVariantA9 = presentationVariantAnnotation) === null || _presentationVariantA9 === void 0 ? void 0 : (_presentationVariantA10 = _presentationVariantA9.Visualizations) === null || _presentationVariantA10 === void 0 ? void 0 : (_presentationVariantA11 = _presentationVariantA10.find(viz => {
          return viz.$target.$Type === "com.sap.vocabularies.UI.v1.ChartDefinitionType";
        })) === null || _presentationVariantA11 === void 0 ? void 0 : _presentationVariantA11.$target;
      } else {
        // Couldn't find a KPI or a SPV annotation with the qualifier from the manifest
        converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Medium, IssueType.KPI_ISSUES.KPI_NOT_FOUND + kpiConfig.qualifier);
        return undefined;
      }
    }
    if (!presentationVariantAnnotation || !datapointAnnotation || !chartAnnotation) {
      // Couldn't find a chart or datapoint definition
      converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Medium, IssueType.KPI_ISSUES.KPI_DETAIL_NOT_FOUND + kpiConfig.qualifier);
      return undefined;
    }
    const datapointProperty = datapointAnnotation.Value.$target;
    if (!aggregationHelper.isPropertyAggregatable(datapointProperty)) {
      // The main property of the KPI is not aggregatable --> We can't calculate its value so we ignore the KPI
      converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Medium, IssueType.KPI_ISSUES.MAIN_PROPERTY_NOT_AGGREGATABLE + kpiConfig.qualifier);
      return undefined;
    }

    // Chart definition
    const chartDef = convertKPIChart(chartAnnotation, presentationVariantAnnotation);
    if (!chartDef) {
      return undefined;
    }
    const kpiDef = {
      id: getKPIID(kpiName),
      entitySet: kpiConfig.entitySet,
      datapoint: {
        propertyPath: datapointAnnotation.Value.path,
        annotationPath: kpiConverterContext.getEntitySetBasedAnnotationPath(datapointAnnotation.fullyQualifiedName),
        title: (_datapointAnnotation$ = datapointAnnotation.Title) === null || _datapointAnnotation$ === void 0 ? void 0 : _datapointAnnotation$.toString(),
        description: (_datapointAnnotation$2 = datapointAnnotation.Description) === null || _datapointAnnotation$2 === void 0 ? void 0 : _datapointAnnotation$2.toString()
      },
      selectionVariantFilterDefinitions: selectionVariantAnnotation ? getFilterDefinitionsFromSelectionVariant(selectionVariantAnnotation) : undefined,
      chart: chartDef
    };

    // Navigation
    if (!navigationInfo) {
      // No navigationInfo was found in the KPI annotation --> try the outbound navigation from the manifest
      if (kpiConfig.detailNavigation) {
        navigationInfo = {
          outboundNavigation: kpiConfig.detailNavigation
        };
      } else {
        // No outbound navigation in the manifest --> try the semantic object on the Datapoint value
        navigationInfo = getNavigationInfoFromProperty(datapointProperty);
      }
    }
    if (navigationInfo) {
      kpiDef.navigation = navigationInfo;
    }
    updateCurrency(datapointAnnotation, kpiDef);
    updateCriticality(datapointAnnotation, aggregationHelper, kpiDef);
    updateTrend(datapointAnnotation, aggregationHelper, kpiDef);
    updateTarget(datapointAnnotation, aggregationHelper, kpiDef);
    return kpiDef;
  }

  /**
   * Creates the KPI definitions from the manifest and the annotations.
   *
   * @param converterContext The converter context for the page
   * @returns Returns an array of KPI definitions
   */
  function getKPIDefinitions(converterContext) {
    const kpiConfigs = converterContext.getManifestWrapper().getKPIConfiguration(),
      kpiDefs = [];
    Object.keys(kpiConfigs).forEach(kpiName => {
      const oDef = createKPIDefinition(kpiName, kpiConfigs[kpiName], converterContext);
      if (oDef) {
        kpiDefs.push(oDef);
      }
    });
    return kpiDefs;
  }
  _exports.getKPIDefinitions = getKPIDefinitions;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/KPI", ["sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/helpers/SelectionVariantHelper","sap/fe/core/formatters/TableFormatterTypes","sap/fe/core/templating/PropertyHelper","../../helpers/Aggregation","../../helpers/ID","./Criticality"],function(e,t,a,i,n,o,l){"use strict";var r={};var u=l.getMessageTypeFromCriticalityType;var c=o.getKPIID;var s=n.AggregationHelper;var d=i.isPathExpression;var v=a.MessageType;var p=t.getFilterDefinitionsFromSelectionVariant;var f=e.IssueType;var g=e.IssueSeverity;var y=e.IssueCategory;const C={"UI.TrendType/StrongUp":"Up","UI.TrendType/Up":"Up","UI.TrendType/StrongDown":"Down","UI.TrendType/Down":"Down","UI.TrendType/Sideways":"None"};const T={"UI.ChartType/ColumnStacked":"StackedColumn","UI.ChartType/BarStacked":"StackedBar","UI.ChartType/Donut":"Donut","UI.ChartType/Line":"Line","UI.ChartType/Bubble":"bubble","UI.ChartType/Column":"column","UI.ChartType/Bar":"bar","UI.ChartType/VerticalBullet":"vertical_bullet","UI.ChartType/Combination":"combination","UI.ChartType/Scatter":"scatter"};function h(e,t){var a,i;if(e.Measures===undefined){return undefined}const n=e.Dimensions?e.Dimensions.map(t=>{var a,i,n,o;const l=(a=e.DimensionAttributes)===null||a===void 0?void 0:a.find(e=>{var a;return((a=e.Dimension)===null||a===void 0?void 0:a.value)===t.value});return{name:t.value,label:((i=t.$target.annotations.Common)===null||i===void 0?void 0:(n=i.Label)===null||n===void 0?void 0:n.toString())||t.value,role:l===null||l===void 0?void 0:(o=l.Role)===null||o===void 0?void 0:o.replace("UI.ChartDimensionRoleType/","")}}):[];const o=e.Measures.map(t=>{var a,i,n,o;const l=(a=e.MeasureAttributes)===null||a===void 0?void 0:a.find(e=>{var a;return((a=e.Measure)===null||a===void 0?void 0:a.value)===t.value});return{name:t.value,label:((i=t.$target.annotations.Common)===null||i===void 0?void 0:(n=i.Label)===null||n===void 0?void 0:n.toString())||t.value,role:l===null||l===void 0?void 0:(o=l.Role)===null||o===void 0?void 0:o.replace("UI.ChartMeasureRoleType/","")}});return{chartType:T[e.ChartType]||"Line",dimensions:n,measures:o,sortOrder:t===null||t===void 0?void 0:(a=t.SortOrder)===null||a===void 0?void 0:a.map(e=>{var t;return{name:((t=e.Property)===null||t===void 0?void 0:t.value)||"",descending:!!e.Descending}}),maxItems:t===null||t===void 0?void 0:(i=t.MaxItems)===null||i===void 0?void 0:i.valueOf()}}function m(e,t){var a,i;const n=e.Value.$target;if((a=n.annotations.Measures)!==null&&a!==void 0&&a.ISOCurrency){var o;const e=(o=n.annotations.Measures)===null||o===void 0?void 0:o.ISOCurrency;if(d(e)){t.datapoint.unit={value:e.$target.name,isCurrency:true,isPath:true}}else{t.datapoint.unit={value:e.toString(),isCurrency:true,isPath:false}}}else if((i=n.annotations.Measures)!==null&&i!==void 0&&i.Unit){var l;const e=(l=n.annotations.Measures)===null||l===void 0?void 0:l.Unit;if(d(e)){t.datapoint.unit={value:e.$target.name,isCurrency:false,isPath:true}}else{t.datapoint.unit={value:e.toString(),isCurrency:false,isPath:false}}}}function I(e,t,a){if(e.Criticality){if(typeof e.Criticality==="object"){const i=e.Criticality.$target;if(t.isPropertyAggregatable(i)){a.datapoint.criticalityPath=e.Criticality.path}else{a.datapoint.criticalityValue=v.None}}else{a.datapoint.criticalityValue=u(e.Criticality)}}else if(e.CriticalityCalculation){a.datapoint.criticalityCalculationMode=e.CriticalityCalculation.ImprovementDirection;a.datapoint.criticalityCalculationThresholds=[];switch(a.datapoint.criticalityCalculationMode){case"UI.ImprovementDirectionType/Target":a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.DeviationRangeLowValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.ToleranceRangeLowValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.AcceptanceRangeLowValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.AcceptanceRangeHighValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.ToleranceRangeHighValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.DeviationRangeHighValue);break;case"UI.ImprovementDirectionType/Minimize":a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.AcceptanceRangeHighValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.ToleranceRangeHighValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.DeviationRangeHighValue);break;case"UI.ImprovementDirectionType/Maximize":default:a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.DeviationRangeLowValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.ToleranceRangeLowValue);a.datapoint.criticalityCalculationThresholds.push(e.CriticalityCalculation.AcceptanceRangeLowValue)}}else{a.datapoint.criticalityValue=v.None}}function S(e,t,a){if(e.Trend){if(typeof e.Trend==="object"){const i=e.Trend.$target;if(t.isPropertyAggregatable(i)){a.datapoint.trendPath=e.Trend.path}else{a.datapoint.trendValue="None"}}else{a.datapoint.trendValue=C[e.Trend]||"None"}}else if(e.TrendCalculation){a.datapoint.trendCalculationIsRelative=e.TrendCalculation.IsRelativeDifference?true:false;if(e.TrendCalculation.ReferenceValue.$target){const i=e.TrendCalculation.ReferenceValue.$target;if(t.isPropertyAggregatable(i)){a.datapoint.trendCalculationReferencePath=e.TrendCalculation.ReferenceValue.path}else{a.datapoint.trendValue="None"}}else{a.datapoint.trendCalculationReferenceValue=e.TrendCalculation.ReferenceValue}if(a.datapoint.trendCalculationReferencePath!==undefined||a.datapoint.trendCalculationReferenceValue!==undefined){a.datapoint.trendCalculationTresholds=[e.TrendCalculation.StrongDownDifference.valueOf(),e.TrendCalculation.DownDifference.valueOf(),e.TrendCalculation.UpDifference.valueOf(),e.TrendCalculation.StrongUpDifference.valueOf()]}}else{a.datapoint.trendValue="None"}}function D(e,t,a){if(e.TargetValue){if(e.TargetValue.$target){const i=e.TargetValue.$target;if(t.isPropertyAggregatable(i)){a.datapoint.targetPath=e.TargetValue.path}}else{a.datapoint.targetValue=e.TargetValue}}}function b(e){const t=e.annotations["Common"]||{};let a;Object.keys(t).forEach(e=>{const i=t[e];if(i.term==="com.sap.vocabularies.Common.v1.SemanticObject"){if(!i.qualifier||!a){a=i}}});if(a){const e={semanticObject:a.toString(),unavailableActions:[]};const i=Object.keys(t).find(e=>{var i;return t[e].term==="com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"&&t[e].qualifier===((i=a)===null||i===void 0?void 0:i.qualifier)});if(i){e.unavailableActions=t[i]}return e}else{return undefined}}function V(e,t,a){var i,n;const o=a.getConverterContextFor(`/${t.entitySet}`);const l=new s(o.getEntityType(),o);if(!l.isAnalyticsSupported()){a.getDiagnostics().addIssue(y.Annotation,g.Medium,f.KPI_ISSUES.NO_ANALYTICS+t.entitySet);return undefined}let r;let u;let d;let v;let C;const T=o.getAnnotationsByTerm("UI","com.sap.vocabularies.UI.v1.KPI");const V=T.find(e=>e.qualifier===t.qualifier);if(V){var U,P,A,R,O;u=V.DataPoint;r=V.SelectionVariant;d=(U=V.Detail)===null||U===void 0?void 0:U.DefaultPresentationVariant;v=(P=d)===null||P===void 0?void 0:(A=P.Visualizations)===null||A===void 0?void 0:(R=A.find(e=>e.$target.$Type==="com.sap.vocabularies.UI.v1.ChartDefinitionType"))===null||R===void 0?void 0:R.$target;if((O=V.Detail)!==null&&O!==void 0&&O.SemanticObject){var M;C={semanticObject:V.Detail.SemanticObject.toString(),action:(M=V.Detail.Action)===null||M===void 0?void 0:M.toString(),unavailableActions:[]}}}else{const e=o.getAnnotationsByTerm("UI","com.sap.vocabularies.UI.v1.SelectionPresentationVariant");const i=e.find(e=>e.qualifier===t.qualifier);if(i){var $,N,w,L,_,E;r=i.SelectionVariant;d=i.PresentationVariant;u=($=d)===null||$===void 0?void 0:(N=$.Visualizations)===null||N===void 0?void 0:(w=N.find(e=>e.$target.$Type==="com.sap.vocabularies.UI.v1.DataPointType"))===null||w===void 0?void 0:w.$target;v=(L=d)===null||L===void 0?void 0:(_=L.Visualizations)===null||_===void 0?void 0:(E=_.find(e=>e.$target.$Type==="com.sap.vocabularies.UI.v1.ChartDefinitionType"))===null||E===void 0?void 0:E.$target}else{a.getDiagnostics().addIssue(y.Annotation,g.Medium,f.KPI_ISSUES.KPI_NOT_FOUND+t.qualifier);return undefined}}if(!d||!u||!v){a.getDiagnostics().addIssue(y.Annotation,g.Medium,f.KPI_ISSUES.KPI_DETAIL_NOT_FOUND+t.qualifier);return undefined}const j=u.Value.$target;if(!l.isPropertyAggregatable(j)){a.getDiagnostics().addIssue(y.Annotation,g.Medium,f.KPI_ISSUES.MAIN_PROPERTY_NOT_AGGREGATABLE+t.qualifier);return undefined}const q=h(v,d);if(!q){return undefined}const K={id:c(e),entitySet:t.entitySet,datapoint:{propertyPath:u.Value.path,annotationPath:o.getEntitySetBasedAnnotationPath(u.fullyQualifiedName),title:(i=u.Title)===null||i===void 0?void 0:i.toString(),description:(n=u.Description)===null||n===void 0?void 0:n.toString()},selectionVariantFilterDefinitions:r?p(r):undefined,chart:q};if(!C){if(t.detailNavigation){C={outboundNavigation:t.detailNavigation}}else{C=b(j)}}if(C){K.navigation=C}m(u,K);I(u,l,K);S(u,l,K);D(u,l,K);return K}function U(e){const t=e.getManifestWrapper().getKPIConfiguration(),a=[];Object.keys(t).forEach(i=>{const n=V(i,t[i],e);if(n){a.push(n)}});return a}r.getKPIDefinitions=U;return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Table-dbg", ["sap/fe/core/converters/annotations/DataField", "sap/fe/core/converters/controls/Common/Action", "sap/fe/core/converters/helpers/BindingHelper", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/converters/helpers/IssueManager", "sap/fe/core/converters/helpers/Key", "sap/fe/core/formatters/TableFormatter", "sap/fe/core/formatters/TableFormatterTypes", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/helpers/StableIdHelper", "sap/fe/core/templating/DataModelPathHelper", "sap/fe/core/templating/DisplayModeFormatter", "sap/fe/core/templating/EntitySetHelper", "sap/fe/core/templating/PropertyHelper", "sap/fe/core/templating/UIFormatters", "sap/fe/macros/internal/helpers/ActionHelper", "sap/ui/core/Core", "../../helpers/Aggregation", "../../helpers/DataFieldHelper", "../../helpers/ID", "../../ManifestSettings", "./Criticality", "./table/StandardActions"], function (DataField, Action, BindingHelper, ConfigurableObject, IssueManager, Key, tableFormatters, TableFormatterTypes, BindingToolkit, ModelHelper, StableIdHelper, DataModelPathHelper, DisplayModeFormatter, EntitySetHelper, PropertyHelper, UIFormatters, ActionHelper, Core, Aggregation, DataFieldHelper, ID, ManifestSettings, Criticality, StandardActions) {
  "use strict";

  var _exports = {};
  var isInDisplayMode = StandardActions.isInDisplayMode;
  var isDraftOrStickySupported = StandardActions.isDraftOrStickySupported;
  var getStandardActionPaste = StandardActions.getStandardActionPaste;
  var getStandardActionMassEdit = StandardActions.getStandardActionMassEdit;
  var getStandardActionDelete = StandardActions.getStandardActionDelete;
  var getStandardActionCreate = StandardActions.getStandardActionCreate;
  var getRestrictions = StandardActions.getRestrictions;
  var getMassEditVisibility = StandardActions.getMassEditVisibility;
  var getInsertUpdateActionsTemplating = StandardActions.getInsertUpdateActionsTemplating;
  var getDeleteVisibility = StandardActions.getDeleteVisibility;
  var getCreationRow = StandardActions.getCreationRow;
  var getCreateVisibility = StandardActions.getCreateVisibility;
  var generateStandardActionsContext = StandardActions.generateStandardActionsContext;
  var getMessageTypeFromCriticalityType = Criticality.getMessageTypeFromCriticalityType;
  var VisualizationType = ManifestSettings.VisualizationType;
  var VariantManagementType = ManifestSettings.VariantManagementType;
  var TemplateType = ManifestSettings.TemplateType;
  var SelectionMode = ManifestSettings.SelectionMode;
  var Importance = ManifestSettings.Importance;
  var HorizontalAlign = ManifestSettings.HorizontalAlign;
  var CreationMode = ManifestSettings.CreationMode;
  var AvailabilityType = ManifestSettings.AvailabilityType;
  var ActionType = ManifestSettings.ActionType;
  var getTableID = ID.getTableID;
  var isReferencePropertyStaticallyHidden = DataFieldHelper.isReferencePropertyStaticallyHidden;
  var AggregationHelper = Aggregation.AggregationHelper;
  var isMultiValueField = UIFormatters.isMultiValueField;
  var isProperty = PropertyHelper.isProperty;
  var isPathExpression = PropertyHelper.isPathExpression;
  var isNavigationProperty = PropertyHelper.isNavigationProperty;
  var getAssociatedUnitProperty = PropertyHelper.getAssociatedUnitProperty;
  var getAssociatedTimezoneProperty = PropertyHelper.getAssociatedTimezoneProperty;
  var getAssociatedCurrencyProperty = PropertyHelper.getAssociatedCurrencyProperty;
  var getNonSortablePropertiesRestrictions = EntitySetHelper.getNonSortablePropertiesRestrictions;
  var getDisplayMode = DisplayModeFormatter.getDisplayMode;
  var isPathUpdatable = DataModelPathHelper.isPathUpdatable;
  var isPathSearchable = DataModelPathHelper.isPathSearchable;
  var isPathDeletable = DataModelPathHelper.isPathDeletable;
  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var enhanceDataModelPath = DataModelPathHelper.enhanceDataModelPath;
  var replaceSpecialChars = StableIdHelper.replaceSpecialChars;
  var generate = StableIdHelper.generate;
  var resolveBindingString = BindingToolkit.resolveBindingString;
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var not = BindingToolkit.not;
  var isConstant = BindingToolkit.isConstant;
  var ifElse = BindingToolkit.ifElse;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var formatResult = BindingToolkit.formatResult;
  var equal = BindingToolkit.equal;
  var EDM_TYPE_MAPPING = BindingToolkit.EDM_TYPE_MAPPING;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  var and = BindingToolkit.and;
  var MessageType = TableFormatterTypes.MessageType;
  var KeyHelper = Key.KeyHelper;
  var IssueType = IssueManager.IssueType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategoryType = IssueManager.IssueCategoryType;
  var IssueCategory = IssueManager.IssueCategory;
  var Placement = ConfigurableObject.Placement;
  var OverrideType = ConfigurableObject.OverrideType;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var UI = BindingHelper.UI;
  var Entity = BindingHelper.Entity;
  var removeDuplicateActions = Action.removeDuplicateActions;
  var isActionNavigable = Action.isActionNavigable;
  var getCopyAction = Action.getCopyAction;
  var getActionsFromManifest = Action.getActionsFromManifest;
  var dataFieldIsCopyAction = Action.dataFieldIsCopyAction;
  var isDataPointFromDataFieldDefault = DataField.isDataPointFromDataFieldDefault;
  var isDataFieldTypes = DataField.isDataFieldTypes;
  var isDataFieldForActionAbstract = DataField.isDataFieldForActionAbstract;
  var getTargetValueOnDataPoint = DataField.getTargetValueOnDataPoint;
  var getSemanticObjectPath = DataField.getSemanticObjectPath;
  var getDataFieldDataType = DataField.getDataFieldDataType;
  var collectRelatedPropertiesRecursively = DataField.collectRelatedPropertiesRecursively;
  var collectRelatedProperties = DataField.collectRelatedProperties;
  var ColumnType; // Custom Column from Manifest
  (function (ColumnType) {
    ColumnType["Default"] = "Default";
    ColumnType["Annotation"] = "Annotation";
    ColumnType["Slot"] = "Slot";
  })(ColumnType || (ColumnType = {}));
  /**
   * Returns an array of all annotation-based and manifest-based table actions.
   *
   * @param lineItemAnnotation
   * @param visualizationPath
   * @param converterContext
   * @param navigationSettings
   * @returns The complete table actions
   */
  function getTableActions(lineItemAnnotation, visualizationPath, converterContext, navigationSettings) {
    const aTableActions = getTableAnnotationActions(lineItemAnnotation, visualizationPath, converterContext);
    const aAnnotationActions = aTableActions.tableActions;
    const aHiddenActions = aTableActions.hiddenTableActions;
    const manifestActions = getActionsFromManifest(converterContext.getManifestControlConfiguration(visualizationPath).actions, converterContext, aAnnotationActions, navigationSettings, true, aHiddenActions);
    const actionOverwriteConfig = {
      isNavigable: OverrideType.overwrite,
      enableOnSelect: OverrideType.overwrite,
      enableAutoScroll: OverrideType.overwrite,
      enabled: OverrideType.overwrite,
      visible: OverrideType.overwrite,
      defaultValuesExtensionFunction: OverrideType.overwrite,
      command: OverrideType.overwrite
    };
    const actions = insertCustomElements(aAnnotationActions, manifestActions.actions, actionOverwriteConfig);
    return {
      actions,
      commandActions: manifestActions.commandActions
    };
  }

  /**
   * Returns an array of all columns, annotation-based as well as manifest based.
   * They are sorted and some properties can be overwritten via the manifest (check out the keys that can be overwritten).
   *
   * @param lineItemAnnotation Collection of data fields for representation in a table or list
   * @param visualizationPath
   * @param converterContext
   * @param navigationSettings
   * @returns Returns all table columns that should be available, regardless of templating or personalization or their origin
   */
  _exports.getTableActions = getTableActions;
  function getTableColumns(lineItemAnnotation, visualizationPath, converterContext, navigationSettings) {
    const annotationColumns = getColumnsFromAnnotations(lineItemAnnotation, visualizationPath, converterContext);
    const manifestColumns = getColumnsFromManifest(converterContext.getManifestControlConfiguration(visualizationPath).columns, annotationColumns, converterContext, converterContext.getAnnotationEntityType(lineItemAnnotation), navigationSettings);
    return insertCustomElements(annotationColumns, manifestColumns, {
      width: OverrideType.overwrite,
      importance: OverrideType.overwrite,
      horizontalAlign: OverrideType.overwrite,
      availability: OverrideType.overwrite,
      isNavigable: OverrideType.overwrite,
      settings: OverrideType.overwrite,
      formatOptions: OverrideType.overwrite
    });
  }

  /**
   * Retrieve the custom aggregation definitions from the entityType.
   *
   * @param entityType The target entity type.
   * @param tableColumns The array of columns for the entity type.
   * @param converterContext The converter context.
   * @returns The aggregate definitions from the entityType, or undefined if the entity doesn't support analytical queries.
   */
  _exports.getTableColumns = getTableColumns;
  const getAggregateDefinitionsFromEntityType = function (entityType, tableColumns, converterContext) {
    const aggregationHelper = new AggregationHelper(entityType, converterContext);
    function findColumnFromPath(path) {
      return tableColumns.find(column => {
        const annotationColumn = column;
        return annotationColumn.propertyInfos === undefined && annotationColumn.relativePath === path;
      });
    }
    if (!aggregationHelper.isAnalyticsSupported()) {
      return undefined;
    }

    // Keep a set of all currency/unit properties, as we don't want to consider them as aggregates
    // They are aggregates for technical reasons (to manage multi-units situations) but it doesn't make sense from a user standpoint
    const currencyOrUnitProperties = new Set();
    tableColumns.forEach(column => {
      const tableColumn = column;
      if (tableColumn.unit) {
        currencyOrUnitProperties.add(tableColumn.unit);
      }
    });
    const customAggregateAnnotations = aggregationHelper.getCustomAggregateDefinitions();
    const definitions = {};
    customAggregateAnnotations.forEach(annotation => {
      const aggregatedProperty = aggregationHelper._entityType.entityProperties.find(property => {
        return property.name === annotation.qualifier;
      });
      if (aggregatedProperty) {
        var _annotation$annotatio, _annotation$annotatio2;
        const contextDefiningProperties = (_annotation$annotatio = annotation.annotations) === null || _annotation$annotatio === void 0 ? void 0 : (_annotation$annotatio2 = _annotation$annotatio.Aggregation) === null || _annotation$annotatio2 === void 0 ? void 0 : _annotation$annotatio2.ContextDefiningProperties;
        definitions[aggregatedProperty.name] = contextDefiningProperties ? contextDefiningProperties.map(ctxDefProperty => {
          return ctxDefProperty.value;
        }) : [];
      }
    });
    const result = {};
    tableColumns.forEach(column => {
      const tableColumn = column;
      if (tableColumn.propertyInfos === undefined && tableColumn.relativePath) {
        const rawContextDefiningProperties = definitions[tableColumn.relativePath];

        // Ignore aggregates corresponding to currencies or units of measure
        if (rawContextDefiningProperties && !currencyOrUnitProperties.has(tableColumn.name)) {
          result[tableColumn.name] = {
            defaultAggregate: {},
            relativePath: tableColumn.relativePath
          };
          const contextDefiningProperties = [];
          rawContextDefiningProperties.forEach(contextDefiningPropertyName => {
            const foundColumn = findColumnFromPath(contextDefiningPropertyName);
            if (foundColumn) {
              contextDefiningProperties.push(foundColumn.name);
            }
          });
          if (contextDefiningProperties.length) {
            result[tableColumn.name].defaultAggregate.contextDefiningProperties = contextDefiningProperties;
          }
        }
      }
    });
    return result;
  };

  /**
   * Updates a table visualization for analytical use cases.
   *
   * @param tableVisualization The visualization to be updated
   * @param entityType The entity type displayed in the table
   * @param converterContext The converter context
   * @param presentationVariantAnnotation The presentationVariant annotation (if any)
   */
  _exports.getAggregateDefinitionsFromEntityType = getAggregateDefinitionsFromEntityType;
  function updateTableVisualizationForType(tableVisualization, entityType, converterContext, presentationVariantAnnotation) {
    if (tableVisualization.control.type === "AnalyticalTable") {
      const aggregatesDefinitions = getAggregateDefinitionsFromEntityType(entityType, tableVisualization.columns, converterContext),
        aggregationHelper = new AggregationHelper(entityType, converterContext);
      if (aggregatesDefinitions) {
        tableVisualization.enableAnalytics = true;
        tableVisualization.enable$select = false;
        tableVisualization.enable$$getKeepAliveContext = false;
        tableVisualization.aggregates = aggregatesDefinitions;
        _updatePropertyInfosWithAggregatesDefinitions(tableVisualization);
        const allowedTransformations = aggregationHelper.getAllowedTransformations();
        tableVisualization.enableAnalyticsSearch = allowedTransformations ? allowedTransformations.indexOf("search") >= 0 : true;

        // Add group and sort conditions from the presentation variant
        tableVisualization.annotation.groupConditions = getGroupConditions(presentationVariantAnnotation, tableVisualization.columns, tableVisualization.control.type);
        tableVisualization.annotation.aggregateConditions = getAggregateConditions(presentationVariantAnnotation, tableVisualization.columns);
      }
      tableVisualization.control.type = "GridTable"; // AnalyticalTable isn't a real type for the MDC:Table, so we always switch back to Grid
    } else if (tableVisualization.control.type === "ResponsiveTable") {
      tableVisualization.annotation.groupConditions = getGroupConditions(presentationVariantAnnotation, tableVisualization.columns, tableVisualization.control.type);
    } else if (tableVisualization.control.type === "TreeTable") {
      tableVisualization.enable$$getKeepAliveContext = false;
    }
  }

  /**
   * Get the navigation target path from manifest settings.
   *
   * @param converterContext The converter context
   * @param navigationPropertyPath The navigation path to check in the manifest settings
   * @returns Navigation path from manifest settings
   */
  _exports.updateTableVisualizationForType = updateTableVisualizationForType;
  function getNavigationTargetPath(converterContext, navigationPropertyPath) {
    const manifestWrapper = converterContext.getManifestWrapper();
    if (navigationPropertyPath && manifestWrapper.getNavigationConfiguration(navigationPropertyPath)) {
      const navConfig = manifestWrapper.getNavigationConfiguration(navigationPropertyPath);
      if (Object.keys(navConfig).length > 0) {
        return navigationPropertyPath;
      }
    }
    const dataModelPath = converterContext.getDataModelObjectPath();
    const contextPath = converterContext.getContextPath();
    const navConfigForContextPath = manifestWrapper.getNavigationConfiguration(contextPath);
    if (navConfigForContextPath && Object.keys(navConfigForContextPath).length > 0) {
      return contextPath;
    }
    return dataModelPath.targetEntitySet ? dataModelPath.targetEntitySet.name : dataModelPath.startingEntitySet.name;
  }

  /**
   * Sets the 'unit' and 'textArrangement' properties in columns when necessary.
   *
   * @param entityType The entity type displayed in the table
   * @param tableColumns The columns to be updated
   */
  function updateLinkedProperties(entityType, tableColumns) {
    function findColumnByPath(path) {
      return tableColumns.find(column => {
        const annotationColumn = column;
        return annotationColumn.propertyInfos === undefined && annotationColumn.relativePath === path;
      });
    }
    tableColumns.forEach(oColumn => {
      const oTableColumn = oColumn;
      if (oTableColumn.propertyInfos === undefined && oTableColumn.relativePath) {
        const oProperty = entityType.entityProperties.find(oProp => oProp.name === oTableColumn.relativePath);
        if (oProperty) {
          var _oProperty$annotation, _oProperty$annotation2, _oProperty$annotation7;
          const oUnit = getAssociatedCurrencyProperty(oProperty) || getAssociatedUnitProperty(oProperty);
          const oTimezone = getAssociatedTimezoneProperty(oProperty);
          const sTimezone = oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation = oProperty.annotations) === null || _oProperty$annotation === void 0 ? void 0 : (_oProperty$annotation2 = _oProperty$annotation.Common) === null || _oProperty$annotation2 === void 0 ? void 0 : _oProperty$annotation2.Timezone;
          if (oUnit) {
            const oUnitColumn = findColumnByPath(oUnit.name);
            oTableColumn.unit = oUnitColumn === null || oUnitColumn === void 0 ? void 0 : oUnitColumn.name;
          } else {
            var _oProperty$annotation3, _oProperty$annotation4, _oProperty$annotation5, _oProperty$annotation6;
            const sUnit = (oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation3 = oProperty.annotations) === null || _oProperty$annotation3 === void 0 ? void 0 : (_oProperty$annotation4 = _oProperty$annotation3.Measures) === null || _oProperty$annotation4 === void 0 ? void 0 : _oProperty$annotation4.ISOCurrency) || (oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation5 = oProperty.annotations) === null || _oProperty$annotation5 === void 0 ? void 0 : (_oProperty$annotation6 = _oProperty$annotation5.Measures) === null || _oProperty$annotation6 === void 0 ? void 0 : _oProperty$annotation6.Unit);
            if (sUnit) {
              oTableColumn.unitText = `${sUnit}`;
            }
          }
          if (oTimezone) {
            const oTimezoneColumn = findColumnByPath(oTimezone.name);
            oTableColumn.timezone = oTimezoneColumn === null || oTimezoneColumn === void 0 ? void 0 : oTimezoneColumn.name;
          } else if (sTimezone) {
            oTableColumn.timezoneText = sTimezone.toString();
          }
          const displayMode = getDisplayMode(oProperty),
            textAnnotation = (_oProperty$annotation7 = oProperty.annotations.Common) === null || _oProperty$annotation7 === void 0 ? void 0 : _oProperty$annotation7.Text;
          if (isPathExpression(textAnnotation) && displayMode !== "Value") {
            const oTextColumn = findColumnByPath(textAnnotation.path);
            if (oTextColumn && oTextColumn.name !== oTableColumn.name) {
              oTableColumn.textArrangement = {
                textProperty: oTextColumn.name,
                mode: displayMode
              };
            }
          }
        }
      }
    });
  }
  _exports.updateLinkedProperties = updateLinkedProperties;
  function getSemanticKeysAndTitleInfo(converterContext) {
    var _converterContext$get, _converterContext$get2, _converterContext$get3, _converterContext$get4, _converterContext$get5, _converterContext$get6, _converterContext$get7, _converterContext$get8, _converterContext$get9, _converterContext$get10, _converterContext$get11, _converterContext$get12, _converterContext$get13;
    const headerInfoTitlePath = (_converterContext$get = converterContext.getAnnotationEntityType()) === null || _converterContext$get === void 0 ? void 0 : (_converterContext$get2 = _converterContext$get.annotations) === null || _converterContext$get2 === void 0 ? void 0 : (_converterContext$get3 = _converterContext$get2.UI) === null || _converterContext$get3 === void 0 ? void 0 : (_converterContext$get4 = _converterContext$get3.HeaderInfo) === null || _converterContext$get4 === void 0 ? void 0 : (_converterContext$get5 = _converterContext$get4.Title) === null || _converterContext$get5 === void 0 ? void 0 : (_converterContext$get6 = _converterContext$get5.Value) === null || _converterContext$get6 === void 0 ? void 0 : _converterContext$get6.path;
    const semanticKeyAnnotations = (_converterContext$get7 = converterContext.getAnnotationEntityType()) === null || _converterContext$get7 === void 0 ? void 0 : (_converterContext$get8 = _converterContext$get7.annotations) === null || _converterContext$get8 === void 0 ? void 0 : (_converterContext$get9 = _converterContext$get8.Common) === null || _converterContext$get9 === void 0 ? void 0 : _converterContext$get9.SemanticKey;
    const headerInfoTypeName = converterContext === null || converterContext === void 0 ? void 0 : (_converterContext$get10 = converterContext.getAnnotationEntityType()) === null || _converterContext$get10 === void 0 ? void 0 : (_converterContext$get11 = _converterContext$get10.annotations) === null || _converterContext$get11 === void 0 ? void 0 : (_converterContext$get12 = _converterContext$get11.UI) === null || _converterContext$get12 === void 0 ? void 0 : (_converterContext$get13 = _converterContext$get12.HeaderInfo) === null || _converterContext$get13 === void 0 ? void 0 : _converterContext$get13.TypeName;
    const semanticKeyColumns = [];
    if (semanticKeyAnnotations) {
      semanticKeyAnnotations.forEach(function (oColumn) {
        semanticKeyColumns.push(oColumn.value);
      });
    }
    return {
      headerInfoTitlePath,
      semanticKeyColumns,
      headerInfoTypeName
    };
  }
  function createTableVisualization(lineItemAnnotation, visualizationPath, converterContext, presentationVariantAnnotation, isCondensedTableLayoutCompliant, viewConfiguration) {
    const tableManifestConfig = getTableManifestConfiguration(lineItemAnnotation, visualizationPath, converterContext, isCondensedTableLayoutCompliant);
    const {
      navigationPropertyPath
    } = splitPath(visualizationPath);
    const navigationTargetPath = getNavigationTargetPath(converterContext, navigationPropertyPath);
    const navigationSettings = converterContext.getManifestWrapper().getNavigationConfiguration(navigationTargetPath);
    const columns = getTableColumns(lineItemAnnotation, visualizationPath, converterContext, navigationSettings);
    const operationAvailableMap = getOperationAvailableMap(lineItemAnnotation, converterContext);
    const semanticKeysAndHeaderInfoTitle = getSemanticKeysAndTitleInfo(converterContext);
    const tableActions = getTableActions(lineItemAnnotation, visualizationPath, converterContext, navigationSettings);
    const oVisualization = {
      type: VisualizationType.Table,
      annotation: getTableAnnotationConfiguration(lineItemAnnotation, visualizationPath, converterContext, tableManifestConfig, columns, presentationVariantAnnotation, viewConfiguration),
      control: tableManifestConfig,
      actions: removeDuplicateActions(tableActions.actions),
      commandActions: tableActions.commandActions,
      columns: columns,
      operationAvailableMap: JSON.stringify(operationAvailableMap),
      operationAvailableProperties: getOperationAvailableProperties(operationAvailableMap, converterContext),
      headerInfoTitle: semanticKeysAndHeaderInfoTitle.headerInfoTitlePath,
      semanticKeys: semanticKeysAndHeaderInfoTitle.semanticKeyColumns,
      headerInfoTypeName: semanticKeysAndHeaderInfoTitle.headerInfoTypeName,
      enable$select: true,
      enable$$getKeepAliveContext: true
    };
    updateLinkedProperties(converterContext.getAnnotationEntityType(lineItemAnnotation), columns);
    updateTableVisualizationForType(oVisualization, converterContext.getAnnotationEntityType(lineItemAnnotation), converterContext, presentationVariantAnnotation);
    return oVisualization;
  }
  _exports.createTableVisualization = createTableVisualization;
  function createDefaultTableVisualization(converterContext, isBlankTable) {
    const tableManifestConfig = getTableManifestConfiguration(undefined, "", converterContext, false);
    const columns = getColumnsFromEntityType({}, converterContext.getEntityType(), [], [], converterContext, tableManifestConfig.type, []);
    const operationAvailableMap = getOperationAvailableMap(undefined, converterContext);
    const semanticKeysAndHeaderInfoTitle = getSemanticKeysAndTitleInfo(converterContext);
    const oVisualization = {
      type: VisualizationType.Table,
      annotation: getTableAnnotationConfiguration(undefined, "", converterContext, tableManifestConfig, isBlankTable ? [] : columns),
      control: tableManifestConfig,
      actions: [],
      columns: columns,
      operationAvailableMap: JSON.stringify(operationAvailableMap),
      operationAvailableProperties: getOperationAvailableProperties(operationAvailableMap, converterContext),
      headerInfoTitle: semanticKeysAndHeaderInfoTitle.headerInfoTitlePath,
      semanticKeys: semanticKeysAndHeaderInfoTitle.semanticKeyColumns,
      headerInfoTypeName: semanticKeysAndHeaderInfoTitle.headerInfoTypeName,
      enable$select: true,
      enable$$getKeepAliveContext: true
    };
    updateLinkedProperties(converterContext.getEntityType(), columns);
    updateTableVisualizationForType(oVisualization, converterContext.getEntityType(), converterContext);
    return oVisualization;
  }

  /**
   * Gets the map of Core.OperationAvailable property paths for all DataFieldForActions.
   *
   * @param lineItemAnnotation The instance of the line item
   * @param converterContext The instance of the converter context
   * @returns The record containing all action names and their corresponding Core.OperationAvailable property paths
   */
  _exports.createDefaultTableVisualization = createDefaultTableVisualization;
  function getOperationAvailableMap(lineItemAnnotation, converterContext) {
    return ActionHelper.getOperationAvailableMap(lineItemAnnotation, "table", converterContext);
  }

  /**
   * Gets updatable propertyPath for the current entityset if valid.
   *
   * @param converterContext The instance of the converter context
   * @returns The updatable property for the rows
   */
  function getCurrentEntitySetUpdatablePath(converterContext) {
    var _entitySet$annotation, _entitySet$annotation2, _entitySet$annotation3;
    const restrictions = getRestrictions(converterContext);
    const entitySet = converterContext.getEntitySet();
    const updatable = restrictions.isUpdatable;
    const isOnlyDynamicOnCurrentEntity = !isConstant(updatable.expression) && updatable.navigationExpression._type === "Unresolvable";
    const updatablePropertyPath = entitySet === null || entitySet === void 0 ? void 0 : (_entitySet$annotation = entitySet.annotations.Capabilities) === null || _entitySet$annotation === void 0 ? void 0 : (_entitySet$annotation2 = _entitySet$annotation.UpdateRestrictions) === null || _entitySet$annotation2 === void 0 ? void 0 : (_entitySet$annotation3 = _entitySet$annotation2.Updatable) === null || _entitySet$annotation3 === void 0 ? void 0 : _entitySet$annotation3.path;
    return isOnlyDynamicOnCurrentEntity ? updatablePropertyPath : "";
  }

  /**
   * Method to retrieve all property paths assigned to the Core.OperationAvailable annotation.
   *
   * @param operationAvailableMap The record consisting of actions and their Core.OperationAvailable property paths
   * @param converterContext The instance of the converter context
   * @returns The CSV string of all property paths associated with the Core.OperationAvailable annotation
   */
  function getOperationAvailableProperties(operationAvailableMap, converterContext) {
    const properties = new Set();
    for (const actionName in operationAvailableMap) {
      const propertyName = operationAvailableMap[actionName];
      if (propertyName === null) {
        // Annotation configured with explicit 'null' (action advertisement relevant)
        properties.add(actionName);
      } else if (typeof propertyName === "string") {
        // Add property paths and not Constant values.
        properties.add(propertyName);
      }
    }
    if (properties.size) {
      var _entityType$annotatio, _entityType$annotatio2, _entityType$annotatio3, _entityType$annotatio4, _entityType$annotatio5;
      // Some actions have an operation available based on property --> we need to load the HeaderInfo.Title property
      // so that the dialog on partial actions is displayed properly (BCP 2180271425)
      const entityType = converterContext.getEntityType();
      const titleProperty = (_entityType$annotatio = entityType.annotations) === null || _entityType$annotatio === void 0 ? void 0 : (_entityType$annotatio2 = _entityType$annotatio.UI) === null || _entityType$annotatio2 === void 0 ? void 0 : (_entityType$annotatio3 = _entityType$annotatio2.HeaderInfo) === null || _entityType$annotatio3 === void 0 ? void 0 : (_entityType$annotatio4 = _entityType$annotatio3.Title) === null || _entityType$annotatio4 === void 0 ? void 0 : (_entityType$annotatio5 = _entityType$annotatio4.Value) === null || _entityType$annotatio5 === void 0 ? void 0 : _entityType$annotatio5.path;
      if (titleProperty) {
        properties.add(titleProperty);
      }
    }
    return Array.from(properties).join(",");
  }

  /**
   * Iterates over the DataFieldForAction and DataFieldForIntentBasedNavigation of a line item and
   * returns all the UI.Hidden annotation expressions.
   *
   * @param lineItemAnnotation Collection of data fields used for representation in a table or list
   * @param currentEntityType Current entity type
   * @param contextDataModelObjectPath Object path of the data model
   * @param isEntitySet
   * @returns All the `UI.Hidden` path expressions found in the relevant actions
   */
  function getUIHiddenExpForActionsRequiringContext(lineItemAnnotation, currentEntityType, contextDataModelObjectPath, isEntitySet) {
    const aUiHiddenPathExpressions = [];
    lineItemAnnotation.forEach(dataField => {
      var _dataField$ActionTarg, _dataField$Inline;
      // Check if the lineItem context is the same as that of the action:
      if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction" && dataField !== null && dataField !== void 0 && (_dataField$ActionTarg = dataField.ActionTarget) !== null && _dataField$ActionTarg !== void 0 && _dataField$ActionTarg.isBound && currentEntityType === (dataField === null || dataField === void 0 ? void 0 : dataField.ActionTarget.sourceEntityType) || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation" && dataField.RequiresContext && (dataField === null || dataField === void 0 ? void 0 : (_dataField$Inline = dataField.Inline) === null || _dataField$Inline === void 0 ? void 0 : _dataField$Inline.valueOf()) !== true) {
        var _dataField$annotation, _dataField$annotation2, _dataField$annotation3;
        if (typeof ((_dataField$annotation = dataField.annotations) === null || _dataField$annotation === void 0 ? void 0 : (_dataField$annotation2 = _dataField$annotation.UI) === null || _dataField$annotation2 === void 0 ? void 0 : (_dataField$annotation3 = _dataField$annotation2.Hidden) === null || _dataField$annotation3 === void 0 ? void 0 : _dataField$annotation3.valueOf()) === "object") {
          aUiHiddenPathExpressions.push(equal(getBindingExpFromContext(dataField, contextDataModelObjectPath, isEntitySet), false));
        }
      }
    });
    return aUiHiddenPathExpressions;
  }

  /**
   * This method is used to change the context currently referenced by this binding by removing the last navigation property.
   *
   * It is used (specifically in this case), to transform a binding made for a NavProp context /MainObject/NavProp1/NavProp2,
   * into a binding on the previous context /MainObject/NavProp1.
   *
   * @param source DataFieldForAction | DataFieldForIntentBasedNavigation | CustomAction
   * @param contextDataModelObjectPath DataModelObjectPath
   * @param isEntitySet
   * @returns The binding expression
   */
  function getBindingExpFromContext(source, contextDataModelObjectPath, isEntitySet) {
    var _sExpression;
    let sExpression;
    if ((source === null || source === void 0 ? void 0 : source.$Type) === "com.sap.vocabularies.UI.v1.DataFieldForAction" || (source === null || source === void 0 ? void 0 : source.$Type) === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation") {
      var _annotations, _annotations$UI;
      sExpression = source === null || source === void 0 ? void 0 : (_annotations = source.annotations) === null || _annotations === void 0 ? void 0 : (_annotations$UI = _annotations.UI) === null || _annotations$UI === void 0 ? void 0 : _annotations$UI.Hidden;
    } else {
      sExpression = source === null || source === void 0 ? void 0 : source.visible;
    }
    let sPath;
    if ((_sExpression = sExpression) !== null && _sExpression !== void 0 && _sExpression.path) {
      sPath = sExpression.path;
    } else {
      sPath = sExpression;
    }
    if (sPath) {
      if (source !== null && source !== void 0 && source.visible) {
        sPath = sPath.substring(1, sPath.length - 1);
      }
      if (sPath.indexOf("/") > 0) {
        var _contextDataModelObje;
        //check if the navigation property is correct:
        const aSplitPath = sPath.split("/");
        const sNavigationPath = aSplitPath[0];
        if ((contextDataModelObjectPath === null || contextDataModelObjectPath === void 0 ? void 0 : (_contextDataModelObje = contextDataModelObjectPath.targetObject) === null || _contextDataModelObje === void 0 ? void 0 : _contextDataModelObje._type) === "NavigationProperty" && contextDataModelObjectPath.targetObject.partner === sNavigationPath) {
          return pathInModel(aSplitPath.slice(1).join("/"));
        } else {
          return constant(true);
        }
        // In case there is no navigation property, if it's an entitySet, the expression binding has to be returned:
      } else if (isEntitySet) {
        return pathInModel(sPath);
        // otherwise the expression binding cannot be taken into account for the selection mode evaluation:
      } else {
        return constant(true);
      }
    }
    return constant(true);
  }

  /**
   * Loop through the manifest actions and check the following:
   *
   * If the data field is also referenced as a custom action.
   * If the underlying manifest action is either a bound action or has the 'RequiresContext' property set to true.
   *
   * If so, the 'requiresSelection' property is forced to 'true' in the manifest.
   *
   * @param dataFieldId Id of the DataField evaluated
   * @param dataField DataField evaluated
   * @param manifestActions The actions defined in the manifest
   * @returns `true` if the DataField is found among the manifest actions
   */
  function updateManifestActionAndTagIt(dataFieldId, dataField, manifestActions) {
    return Object.keys(manifestActions).some(actionKey => {
      if (actionKey === dataFieldId) {
        var _ActionTarget;
        if (dataField !== null && dataField !== void 0 && (_ActionTarget = dataField.ActionTarget) !== null && _ActionTarget !== void 0 && _ActionTarget.isBound || dataField !== null && dataField !== void 0 && dataField.RequiresContext) {
          manifestActions[dataFieldId].requiresSelection = true;
        }
        return true;
      }
      return false;
    });
  }

  /**
   * Loop through the DataFieldForAction and DataFieldForIntentBasedNavigation of a line item and
   * check the following:
   * If at least one of them is always visible in the table toolbar and requires a context
   * If an action is also defined in the manifest, it is set aside and will be considered
   * when going through the manifest.
   *
   * @param lineItemAnnotation Collection of data fields for representation in a table or list
   * @param manifestActions The actions defined in the manifest
   * @param currentEntityType Current Entity Type
   * @returns `true` if there is at least 1 action that meets the criteria
   */
  function hasBoundActionsAlwaysVisibleInToolBar(lineItemAnnotation, manifestActions, currentEntityType) {
    return lineItemAnnotation.some(dataField => {
      var _dataField$Inline2, _dataField$annotation4, _dataField$annotation5, _dataField$annotation6, _dataField$annotation7, _dataField$annotation8, _dataField$annotation9;
      if ((dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation") && (dataField === null || dataField === void 0 ? void 0 : (_dataField$Inline2 = dataField.Inline) === null || _dataField$Inline2 === void 0 ? void 0 : _dataField$Inline2.valueOf()) !== true && (((_dataField$annotation4 = dataField.annotations) === null || _dataField$annotation4 === void 0 ? void 0 : (_dataField$annotation5 = _dataField$annotation4.UI) === null || _dataField$annotation5 === void 0 ? void 0 : (_dataField$annotation6 = _dataField$annotation5.Hidden) === null || _dataField$annotation6 === void 0 ? void 0 : _dataField$annotation6.valueOf()) === false || ((_dataField$annotation7 = dataField.annotations) === null || _dataField$annotation7 === void 0 ? void 0 : (_dataField$annotation8 = _dataField$annotation7.UI) === null || _dataField$annotation8 === void 0 ? void 0 : (_dataField$annotation9 = _dataField$annotation8.Hidden) === null || _dataField$annotation9 === void 0 ? void 0 : _dataField$annotation9.valueOf()) === undefined)) {
        if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction") {
          var _dataField$ActionTarg2;
          const manifestActionId = generate(["DataFieldForAction", dataField.Action]);
          // if the DataFieldForActon from annotation also exists in the manifest, its visibility will be evaluated later on
          if (updateManifestActionAndTagIt(manifestActionId, dataField, manifestActions)) {
            return false;
          }
          // Check if the lineItem context is the same as that of the action:
          return (dataField === null || dataField === void 0 ? void 0 : (_dataField$ActionTarg2 = dataField.ActionTarget) === null || _dataField$ActionTarg2 === void 0 ? void 0 : _dataField$ActionTarg2.isBound) && currentEntityType === (dataField === null || dataField === void 0 ? void 0 : dataField.ActionTarget.sourceEntityType);
        } else if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation") {
          // if the DataFieldForIntentBasedNavigation from annotation also exists in the manifest, its visibility will be evaluated later on
          if (updateManifestActionAndTagIt(`DataFieldForIntentBasedNavigation::${dataField.SemanticObject}::${dataField.Action}`, dataField, manifestActions)) {
            return false;
          }
          return dataField.RequiresContext;
        }
      }
      return false;
    });
  }
  function hasCustomActionsAlwaysVisibleInToolBar(manifestActions) {
    return Object.keys(manifestActions).some(actionKey => {
      var _action$visible;
      const action = manifestActions[actionKey];
      if (action.requiresSelection && ((_action$visible = action.visible) === null || _action$visible === void 0 ? void 0 : _action$visible.toString()) === "true") {
        return true;
      }
      return false;
    });
  }

  /**
   * Iterates over the custom actions (with key requiresSelection) declared in the manifest for the current line item and returns all the
   * visible key values as an expression.
   *
   * @param manifestActions The actions defined in the manifest
   * @returns Array<Expression<boolean>> All the visible path expressions of the actions that meet the criteria
   */
  function getVisibleExpForCustomActionsRequiringContext(manifestActions) {
    const aVisiblePathExpressions = [];
    if (manifestActions) {
      Object.keys(manifestActions).forEach(actionKey => {
        const action = manifestActions[actionKey];
        if (action.requiresSelection === true && action.visible !== undefined) {
          if (typeof action.visible === "string") {
            var _action$visible2;
            /*The final aim would be to check if the path expression depends on the parent context
            and considers only those expressions for the expression evaluation,
            but currently not possible from the manifest as the visible key is bound on the parent entity.
            Tricky to differentiate the path as it's done for the Hidden annotation.
            For the time being we consider all the paths of the manifest*/

            aVisiblePathExpressions.push(resolveBindingString(action === null || action === void 0 ? void 0 : (_action$visible2 = action.visible) === null || _action$visible2 === void 0 ? void 0 : _action$visible2.valueOf()));
          }
        }
      });
    }
    return aVisiblePathExpressions;
  }

  /**
   * Evaluate if the path is statically deletable or updatable.
   *
   * @param converterContext
   * @returns The table capabilities
   */
  function getCapabilityRestriction(converterContext) {
    const isDeletable = isPathDeletable(converterContext.getDataModelObjectPath());
    const isUpdatable = isPathUpdatable(converterContext.getDataModelObjectPath());
    return {
      isDeletable: !(isConstant(isDeletable) && isDeletable.value === false),
      isUpdatable: !(isConstant(isUpdatable) && isUpdatable.value === false)
    };
  }
  _exports.getCapabilityRestriction = getCapabilityRestriction;
  function getSelectionMode(lineItemAnnotation, visualizationPath, converterContext, isEntitySet, targetCapabilities, deleteButtonVisibilityExpression) {
    var _tableManifestSetting;
    let massEditVisibilityExpression = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : constant(false);
    if (!lineItemAnnotation) {
      return SelectionMode.None;
    }
    const tableManifestSettings = converterContext.getManifestControlConfiguration(visualizationPath);
    let selectionMode = (_tableManifestSetting = tableManifestSettings.tableSettings) === null || _tableManifestSetting === void 0 ? void 0 : _tableManifestSetting.selectionMode;
    let aHiddenBindingExpressions = [],
      aVisibleBindingExpressions = [];
    const manifestActions = getActionsFromManifest(converterContext.getManifestControlConfiguration(visualizationPath).actions, converterContext, [], undefined, false);
    let isParentDeletable, parentEntitySetDeletable;
    if (converterContext.getTemplateType() === TemplateType.ObjectPage) {
      isParentDeletable = isPathDeletable(converterContext.getDataModelObjectPath());
      parentEntitySetDeletable = isParentDeletable ? compileExpression(isParentDeletable, true) : isParentDeletable;
    }
    const bMassEditEnabled = !isConstant(massEditVisibilityExpression) || massEditVisibilityExpression.value !== false;
    if (selectionMode && selectionMode === SelectionMode.None && deleteButtonVisibilityExpression) {
      if (converterContext.getTemplateType() === TemplateType.ObjectPage && bMassEditEnabled) {
        // Mass Edit in OP is enabled only in edit mode.
        return compileExpression(ifElse(and(UI.IsEditable, massEditVisibilityExpression), constant("Multi"), ifElse(deleteButtonVisibilityExpression, constant("Multi"), constant("None"))));
      } else if (bMassEditEnabled) {
        return SelectionMode.Multi;
      }
      return compileExpression(ifElse(deleteButtonVisibilityExpression, constant("Multi"), constant("None")));
    }
    if (!selectionMode || selectionMode === SelectionMode.Auto) {
      selectionMode = SelectionMode.Multi;
    }
    if (bMassEditEnabled) {
      // Override default selection mode when mass edit is visible
      selectionMode = selectionMode === SelectionMode.Single ? SelectionMode.Single : SelectionMode.Multi;
    }
    if (hasBoundActionsAlwaysVisibleInToolBar(lineItemAnnotation, manifestActions.actions, converterContext.getEntityType()) || hasCustomActionsAlwaysVisibleInToolBar(manifestActions.actions)) {
      return selectionMode;
    }
    aHiddenBindingExpressions = getUIHiddenExpForActionsRequiringContext(lineItemAnnotation, converterContext.getEntityType(), converterContext.getDataModelObjectPath(), isEntitySet);
    aVisibleBindingExpressions = getVisibleExpForCustomActionsRequiringContext(manifestActions.actions);

    // No action requiring a context:
    if (aHiddenBindingExpressions.length === 0 && aVisibleBindingExpressions.length === 0 && (deleteButtonVisibilityExpression || bMassEditEnabled)) {
      if (!isEntitySet) {
        // Example: OP case
        if (targetCapabilities.isDeletable || parentEntitySetDeletable !== "false" || bMassEditEnabled) {
          // Building expression for delete and mass edit
          const buttonVisibilityExpression = or(deleteButtonVisibilityExpression || true,
          // default delete visibility as true
          massEditVisibilityExpression);
          return compileExpression(ifElse(and(UI.IsEditable, buttonVisibilityExpression), constant(selectionMode), constant(SelectionMode.None)));
        } else {
          return SelectionMode.None;
        }
        // EntitySet deletable:
      } else if (bMassEditEnabled) {
        // example: LR scenario
        return selectionMode;
      } else if (targetCapabilities.isDeletable && deleteButtonVisibilityExpression) {
        return compileExpression(ifElse(deleteButtonVisibilityExpression, constant(selectionMode), constant("None")));
        // EntitySet not deletable:
      } else {
        return SelectionMode.None;
      }
      // There are actions requiring a context:
    } else if (!isEntitySet) {
      // Example: OP case
      if (targetCapabilities.isDeletable || parentEntitySetDeletable !== "false" || bMassEditEnabled) {
        // Use selectionMode in edit mode if delete is enabled or mass edit is visible
        const editModebuttonVisibilityExpression = ifElse(bMassEditEnabled && !targetCapabilities.isDeletable, massEditVisibilityExpression, constant(true));
        return compileExpression(ifElse(and(UI.IsEditable, editModebuttonVisibilityExpression), constant(selectionMode), ifElse(or(...aHiddenBindingExpressions.concat(aVisibleBindingExpressions)), constant(selectionMode), constant(SelectionMode.None))));
      } else {
        return compileExpression(ifElse(or(...aHiddenBindingExpressions.concat(aVisibleBindingExpressions)), constant(selectionMode), constant(SelectionMode.None)));
      }
      //EntitySet deletable:
    } else if (targetCapabilities.isDeletable || bMassEditEnabled) {
      // Example: LR scenario
      return selectionMode;
      //EntitySet not deletable:
    } else {
      return compileExpression(ifElse(or(...aHiddenBindingExpressions.concat(aVisibleBindingExpressions), massEditVisibilityExpression), constant(selectionMode), constant(SelectionMode.None)));
    }
  }

  /**
   * Method to retrieve all table actions from annotations.
   *
   * @param lineItemAnnotation
   * @param visualizationPath
   * @param converterContext
   * @returns The table annotation actions
   */
  _exports.getSelectionMode = getSelectionMode;
  function getTableAnnotationActions(lineItemAnnotation, visualizationPath, converterContext) {
    const tableActions = [];
    const hiddenTableActions = [];
    const copyDataField = getCopyAction(lineItemAnnotation.filter(dataField => {
      return dataFieldIsCopyAction(dataField);
    }));
    if (copyDataField) {
      var _copyDataField$annota, _copyDataField$annota2, _copyDataField$Label;
      tableActions.push({
        type: ActionType.Copy,
        annotationPath: converterContext.getEntitySetBasedAnnotationPath(copyDataField.fullyQualifiedName),
        key: KeyHelper.generateKeyFromDataField(copyDataField),
        enabled: compileExpression(equal(pathInModel("numberOfSelectedContexts", "internal"), 1)),
        visible: compileExpression(not(equal(getExpressionFromAnnotation((_copyDataField$annota = copyDataField.annotations) === null || _copyDataField$annota === void 0 ? void 0 : (_copyDataField$annota2 = _copyDataField$annota.UI) === null || _copyDataField$annota2 === void 0 ? void 0 : _copyDataField$annota2.Hidden, [], undefined, converterContext.getRelativeModelPathFunction()), true))),
        text: ((_copyDataField$Label = copyDataField.Label) === null || _copyDataField$Label === void 0 ? void 0 : _copyDataField$Label.toString()) ?? Core.getLibraryResourceBundle("sap.fe.core").getText("C_COMMON_COPY"),
        isNavigable: true
      });
    }
    lineItemAnnotation.filter(dataField => {
      return !dataFieldIsCopyAction(dataField);
    }).forEach(dataField => {
      var _dataField$annotation10, _dataField$annotation11, _dataField$annotation12, _dataField$Inline3, _dataField$Determinin, _dataField$annotation13, _dataField$annotation14, _dataField$annotation15, _dataField$annotation16;
      if (((_dataField$annotation10 = dataField.annotations) === null || _dataField$annotation10 === void 0 ? void 0 : (_dataField$annotation11 = _dataField$annotation10.UI) === null || _dataField$annotation11 === void 0 ? void 0 : (_dataField$annotation12 = _dataField$annotation11.Hidden) === null || _dataField$annotation12 === void 0 ? void 0 : _dataField$annotation12.valueOf()) === true) {
        hiddenTableActions.push({
          type: ActionType.Default,
          key: KeyHelper.generateKeyFromDataField(dataField)
        });
      } else if (isDataFieldForActionAbstract(dataField) && ((_dataField$Inline3 = dataField.Inline) === null || _dataField$Inline3 === void 0 ? void 0 : _dataField$Inline3.valueOf()) !== true && ((_dataField$Determinin = dataField.Determining) === null || _dataField$Determinin === void 0 ? void 0 : _dataField$Determinin.valueOf()) !== true) {
        switch (dataField.$Type) {
          case "com.sap.vocabularies.UI.v1.DataFieldForAction":
            tableActions.push({
              type: ActionType.DataFieldForAction,
              annotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),
              key: KeyHelper.generateKeyFromDataField(dataField),
              visible: compileExpression(not(equal(getExpressionFromAnnotation((_dataField$annotation13 = dataField.annotations) === null || _dataField$annotation13 === void 0 ? void 0 : (_dataField$annotation14 = _dataField$annotation13.UI) === null || _dataField$annotation14 === void 0 ? void 0 : _dataField$annotation14.Hidden, [], undefined, converterContext.getRelativeModelPathFunction()), true))),
              isNavigable: true
            });
            break;
          case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
            tableActions.push({
              type: ActionType.DataFieldForIntentBasedNavigation,
              annotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),
              key: KeyHelper.generateKeyFromDataField(dataField),
              visible: compileExpression(not(equal(getExpressionFromAnnotation((_dataField$annotation15 = dataField.annotations) === null || _dataField$annotation15 === void 0 ? void 0 : (_dataField$annotation16 = _dataField$annotation15.UI) === null || _dataField$annotation16 === void 0 ? void 0 : _dataField$annotation16.Hidden, [], undefined, converterContext.getRelativeModelPathFunction()), true)))
            });
            break;
          default:
            break;
        }
      }
    });
    return {
      tableActions,
      hiddenTableActions
    };
  }
  function getHighlightRowBinding(criticalityAnnotation, isDraftRoot, targetEntityType) {
    let defaultHighlightRowDefinition = MessageType.None;
    if (criticalityAnnotation) {
      if (typeof criticalityAnnotation === "object") {
        defaultHighlightRowDefinition = getExpressionFromAnnotation(criticalityAnnotation);
      } else {
        // Enum Value so we get the corresponding static part
        defaultHighlightRowDefinition = getMessageTypeFromCriticalityType(criticalityAnnotation);
      }
    }
    const aMissingKeys = [];
    targetEntityType === null || targetEntityType === void 0 ? void 0 : targetEntityType.keys.forEach(key => {
      if (key.name !== "IsActiveEntity") {
        aMissingKeys.push(pathInModel(key.name, undefined));
      }
    });
    return formatResult([defaultHighlightRowDefinition, pathInModel(`filteredMessages`, "internal"), isDraftRoot && Entity.HasActive, isDraftRoot && Entity.IsActive, `${isDraftRoot}`, ...aMissingKeys], tableFormatters.rowHighlighting, targetEntityType);
  }
  function _getCreationBehaviour(lineItemAnnotation, tableManifestConfiguration, converterContext, navigationSettings, visualizationPath) {
    var _newAction2;
    const navigation = (navigationSettings === null || navigationSettings === void 0 ? void 0 : navigationSettings.create) || (navigationSettings === null || navigationSettings === void 0 ? void 0 : navigationSettings.detail);
    const tableManifestSettings = converterContext.getManifestControlConfiguration(visualizationPath);
    const originalTableSettings = tableManifestSettings && tableManifestSettings.tableSettings || {};
    // cross-app
    if (navigation !== null && navigation !== void 0 && navigation.outbound && navigation.outboundDetail && navigationSettings !== null && navigationSettings !== void 0 && navigationSettings.create) {
      return {
        mode: "External",
        outbound: navigation.outbound,
        outboundDetail: navigation.outboundDetail,
        navigationSettings: navigationSettings
      };
    }
    let newAction;
    if (lineItemAnnotation) {
      var _converterContext$get14, _targetAnnotationsCom, _targetAnnotationsSes;
      // in-app
      const targetAnnotations = (_converterContext$get14 = converterContext.getEntitySet()) === null || _converterContext$get14 === void 0 ? void 0 : _converterContext$get14.annotations;
      const targetAnnotationsCommon = targetAnnotations === null || targetAnnotations === void 0 ? void 0 : targetAnnotations.Common,
        targetAnnotationsSession = targetAnnotations === null || targetAnnotations === void 0 ? void 0 : targetAnnotations.Session;
      newAction = (targetAnnotationsCommon === null || targetAnnotationsCommon === void 0 ? void 0 : (_targetAnnotationsCom = targetAnnotationsCommon.DraftRoot) === null || _targetAnnotationsCom === void 0 ? void 0 : _targetAnnotationsCom.NewAction) || (targetAnnotationsSession === null || targetAnnotationsSession === void 0 ? void 0 : (_targetAnnotationsSes = targetAnnotationsSession.StickySessionSupported) === null || _targetAnnotationsSes === void 0 ? void 0 : _targetAnnotationsSes.NewAction);
      if (tableManifestConfiguration.creationMode === CreationMode.CreationRow && newAction) {
        // A combination of 'CreationRow' and 'NewAction' does not make sense
        throw Error(`Creation mode '${CreationMode.CreationRow}' can not be used with a custom 'new' action (${newAction})`);
      }
      if (navigation !== null && navigation !== void 0 && navigation.route) {
        var _newAction;
        // route specified
        return {
          mode: tableManifestConfiguration.creationMode,
          append: tableManifestConfiguration.createAtEnd,
          newAction: (_newAction = newAction) === null || _newAction === void 0 ? void 0 : _newAction.toString(),
          navigateToTarget: tableManifestConfiguration.creationMode === CreationMode.NewPage ? navigation.route : undefined // navigate only in NewPage mode
        };
      }
    }

    // no navigation or no route specified - fallback to inline create if original creation mode was 'NewPage'
    if (tableManifestConfiguration.creationMode === CreationMode.NewPage) {
      var _originalTableSetting;
      tableManifestConfiguration.creationMode = CreationMode.Inline;
      // In case there was no specific configuration for the createAtEnd we force it to false
      if (((_originalTableSetting = originalTableSettings.creationMode) === null || _originalTableSetting === void 0 ? void 0 : _originalTableSetting.createAtEnd) === undefined) {
        tableManifestConfiguration.createAtEnd = false;
      }
    }
    return {
      mode: tableManifestConfiguration.creationMode,
      append: tableManifestConfiguration.createAtEnd,
      newAction: (_newAction2 = newAction) === null || _newAction2 === void 0 ? void 0 : _newAction2.toString()
    };
  }
  const _getRowConfigurationProperty = function (lineItemAnnotation, converterContext, navigationSettings, targetPath, tableType) {
    let pressProperty, navigationTarget;
    let criticalityProperty = constant(MessageType.None);
    const targetEntityType = converterContext.getEntityType();
    if (navigationSettings && lineItemAnnotation) {
      var _navigationSettings$d, _navigationSettings$d2;
      navigationTarget = ((_navigationSettings$d = navigationSettings.display) === null || _navigationSettings$d === void 0 ? void 0 : _navigationSettings$d.target) || ((_navigationSettings$d2 = navigationSettings.detail) === null || _navigationSettings$d2 === void 0 ? void 0 : _navigationSettings$d2.outbound);
      if (navigationTarget) {
        pressProperty = ".handlers.onChevronPressNavigateOutBound( $controller ,'" + navigationTarget + "', ${$parameters>bindingContext})";
      } else if (targetEntityType) {
        var _navigationSettings$d3;
        const targetEntitySet = converterContext.getEntitySet();
        navigationTarget = (_navigationSettings$d3 = navigationSettings.detail) === null || _navigationSettings$d3 === void 0 ? void 0 : _navigationSettings$d3.route;
        if (navigationTarget && !ModelHelper.isSingleton(targetEntitySet)) {
          var _lineItemAnnotation$a, _lineItemAnnotation$a2;
          criticalityProperty = getHighlightRowBinding((_lineItemAnnotation$a = lineItemAnnotation.annotations) === null || _lineItemAnnotation$a === void 0 ? void 0 : (_lineItemAnnotation$a2 = _lineItemAnnotation$a.UI) === null || _lineItemAnnotation$a2 === void 0 ? void 0 : _lineItemAnnotation$a2.Criticality, !!ModelHelper.getDraftRoot(targetEntitySet) || !!ModelHelper.getDraftNode(targetEntitySet), targetEntityType);
          pressProperty = "API.onTableRowPress($event, $controller, ${$parameters>bindingContext}, { callExtension: true, targetPath: '" + targetPath + "', editable : " + (ModelHelper.getDraftRoot(targetEntitySet) || ModelHelper.getDraftNode(targetEntitySet) ? "!${$parameters>bindingContext}.getProperty('IsActiveEntity')" : "undefined") + (tableType === "AnalyticalTable" || tableType === "TreeTable" ? ", bRecreateContext: true" : "") + "})"; //Need to access to DraftRoot and DraftNode !!!!!!!
        } else {
          var _lineItemAnnotation$a3, _lineItemAnnotation$a4;
          criticalityProperty = getHighlightRowBinding((_lineItemAnnotation$a3 = lineItemAnnotation.annotations) === null || _lineItemAnnotation$a3 === void 0 ? void 0 : (_lineItemAnnotation$a4 = _lineItemAnnotation$a3.UI) === null || _lineItemAnnotation$a4 === void 0 ? void 0 : _lineItemAnnotation$a4.Criticality, false, targetEntityType);
        }
      }
    }
    const rowNavigatedExpression = formatResult([pathInModel("/deepestPath", "internal")], tableFormatters.navigatedRow, targetEntityType);
    return {
      press: pressProperty,
      action: pressProperty ? "Navigation" : undefined,
      rowHighlighting: compileExpression(criticalityProperty),
      rowNavigated: compileExpression(rowNavigatedExpression),
      visible: compileExpression(not(UI.IsInactive))
    };
  };

  /**
   * Retrieve the columns from the entityType.
   *
   * @param columnsToBeCreated The columns to be created.
   * @param entityType The target entity type.
   * @param annotationColumns The array of columns created based on LineItem annotations.
   * @param nonSortableColumns The array of all non sortable column names.
   * @param converterContext The converter context.
   * @param tableType The table type.
   * @param textOnlyColumnsFromTextAnnotation The array of columns from a property using a text annotation with textOnly as text arrangement.
   * @returns The column from the entityType
   */
  const getColumnsFromEntityType = function (columnsToBeCreated, entityType) {
    let annotationColumns = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
    let nonSortableColumns = arguments.length > 3 ? arguments[3] : undefined;
    let converterContext = arguments.length > 4 ? arguments[4] : undefined;
    let tableType = arguments.length > 5 ? arguments[5] : undefined;
    let textOnlyColumnsFromTextAnnotation = arguments.length > 6 ? arguments[6] : undefined;
    const tableColumns = annotationColumns;
    // Catch already existing columns - which were added before by LineItem Annotations
    const aggregationHelper = new AggregationHelper(entityType, converterContext);
    entityType.entityProperties.forEach(property => {
      // Catch already existing columns - which were added before by LineItem Annotations
      const exists = annotationColumns.some(column => {
        return column.name === property.name;
      });

      // if target type exists, it is a complex property and should be ignored
      if (!property.targetType && !exists) {
        const relatedPropertiesInfo = collectRelatedProperties(property.name, property, converterContext, true, tableType);
        const relatedPropertyNames = Object.keys(relatedPropertiesInfo.properties);
        const additionalPropertyNames = Object.keys(relatedPropertiesInfo.additionalProperties);
        if (relatedPropertiesInfo.textOnlyPropertiesFromTextAnnotation.length > 0) {
          // Include text properties found during analysis on getColumnsFromAnnotations
          textOnlyColumnsFromTextAnnotation.push(...relatedPropertiesInfo.textOnlyPropertiesFromTextAnnotation);
        }
        const columnInfo = getColumnDefinitionFromProperty(property, converterContext.getEntitySetBasedAnnotationPath(property.fullyQualifiedName), property.name, true, true, nonSortableColumns, aggregationHelper, converterContext, textOnlyColumnsFromTextAnnotation);
        const semanticKeys = converterContext.getAnnotationsByTerm("Common", "com.sap.vocabularies.Common.v1.SemanticKey", [converterContext.getEntityType()])[0];
        const oColumnDraftIndicator = getDefaultDraftIndicatorForColumn(columnInfo.name, semanticKeys, false, null);
        if (Object.keys(oColumnDraftIndicator).length > 0) {
          columnInfo.formatOptions = {
            ...oColumnDraftIndicator
          };
        }
        if (relatedPropertyNames.length > 0) {
          columnInfo.propertyInfos = relatedPropertyNames;
          columnInfo.exportSettings = {
            ...columnInfo.exportSettings,
            template: relatedPropertiesInfo.exportSettingsTemplate,
            wrap: relatedPropertiesInfo.exportSettingsWrapping
          };
          columnInfo.exportSettings.type = _getExportDataType(property.type, relatedPropertyNames.length > 1);
          if (relatedPropertiesInfo.exportUnitName) {
            columnInfo.exportSettings.unitProperty = relatedPropertiesInfo.exportUnitName;
            columnInfo.exportSettings.type = "Currency"; // Force to a currency because there's a unitProperty (otherwise the value isn't properly formatted when exported)
          } else if (relatedPropertiesInfo.exportUnitString) {
            columnInfo.exportSettings.unit = relatedPropertiesInfo.exportUnitString;
          }
          if (relatedPropertiesInfo.exportTimezoneName) {
            columnInfo.exportSettings.timezoneProperty = relatedPropertiesInfo.exportTimezoneName;
            columnInfo.exportSettings.utc = false;
          } else if (relatedPropertiesInfo.exportTimezoneString) {
            columnInfo.exportSettings.timezone = relatedPropertiesInfo.exportTimezoneString;
          }
          if (relatedPropertiesInfo.exportDataPointTargetValue) {
            columnInfo.exportDataPointTargetValue = relatedPropertiesInfo.exportDataPointTargetValue;
            columnInfo.exportSettings.type = "String";
          }

          // Collect information of related columns to be created.
          relatedPropertyNames.forEach(name => {
            columnsToBeCreated[name] = relatedPropertiesInfo.properties[name];
          });
        }
        if (additionalPropertyNames.length > 0) {
          columnInfo.additionalPropertyInfos = additionalPropertyNames;
          // Create columns for additional properties identified for ALP use case.
          additionalPropertyNames.forEach(name => {
            // Intentional overwrite as we require only one new PropertyInfo for a related Property.
            columnsToBeCreated[name] = relatedPropertiesInfo.additionalProperties[name];
          });
        }
        tableColumns.push(columnInfo);
      }
      // In case a property has defined a #TextOnly text arrangement don't only create the complex property with the text property as a child property,
      // but also the property itself as it can be used as within the sortConditions or on custom columns.
      // This step must be valide also from the columns added via LineItems or from a column available on the p13n.
      if (getDisplayMode(property) === "Description") {
        nonSortableColumns = nonSortableColumns.concat(property.name);
        tableColumns.push(getColumnDefinitionFromProperty(property, converterContext.getEntitySetBasedAnnotationPath(property.fullyQualifiedName), property.name, false, false, nonSortableColumns, aggregationHelper, converterContext, []));
      }
    });

    // Create a propertyInfo for each related property.
    const relatedColumns = _createRelatedColumns(columnsToBeCreated, tableColumns, nonSortableColumns, converterContext, entityType, textOnlyColumnsFromTextAnnotation);
    return tableColumns.concat(relatedColumns);
  };

  /**
   * Create a column definition from a property.
   *
   * @param property Entity type property for which the column is created
   * @param fullPropertyPath The full path to the target property
   * @param relativePath The relative path to the target property based on the context
   * @param useDataFieldPrefix Should be prefixed with "DataField::", else it will be prefixed with "Property::"
   * @param availableForAdaptation Decides whether the column should be available for adaptation
   * @param nonSortableColumns The array of all non-sortable column names
   * @param aggregationHelper The aggregationHelper for the entity
   * @param converterContext The converter context
   * @param textOnlyColumnsFromTextAnnotation The array of columns from a property using a text annotation with textOnly as text arrangement.
   * @returns The annotation column definition
   */
  _exports.getColumnsFromEntityType = getColumnsFromEntityType;
  const getColumnDefinitionFromProperty = function (property, fullPropertyPath, relativePath, useDataFieldPrefix, availableForAdaptation, nonSortableColumns, aggregationHelper, converterContext, textOnlyColumnsFromTextAnnotation) {
    var _property$annotations, _property$annotations2, _property$annotations3, _annotations2, _annotations2$UI;
    const name = useDataFieldPrefix ? relativePath : `Property::${relativePath}`;
    const key = (useDataFieldPrefix ? "DataField::" : "Property::") + replaceSpecialChars(relativePath);
    const semanticObjectAnnotationPath = getSemanticObjectPath(converterContext, property);
    const isHidden = ((_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : (_property$annotations2 = _property$annotations.UI) === null || _property$annotations2 === void 0 ? void 0 : (_property$annotations3 = _property$annotations2.Hidden) === null || _property$annotations3 === void 0 ? void 0 : _property$annotations3.valueOf()) === true;
    const groupPath = property.name ? _sliceAtSlash(property.name, true, false) : undefined;
    const isGroup = groupPath != property.name;
    const exportType = _getExportDataType(property.type);
    const sDateInputFormat = property.type === "Edm.Date" ? "YYYY-MM-DD" : undefined;
    const dataType = getDataFieldDataType(property);
    const propertyTypeConfig = getTypeConfig(property, dataType);
    const semanticKeys = converterContext.getAnnotationsByTerm("Common", "com.sap.vocabularies.Common.v1.SemanticKey", [converterContext.getEntityType()])[0];
    const isAPropertyFromTextOnlyAnnotation = textOnlyColumnsFromTextAnnotation && textOnlyColumnsFromTextAnnotation.indexOf(relativePath) >= 0;
    const sortable = (!isHidden || isAPropertyFromTextOnlyAnnotation) && nonSortableColumns.indexOf(relativePath) === -1;
    const typeConfig = {
      className: property.type || dataType,
      formatOptions: propertyTypeConfig.formatOptions,
      constraints: propertyTypeConfig.constraints
    };
    let exportSettings = null;
    if (_isExportableColumn(property)) {
      var _property$annotations4, _property$annotations5, _property$annotations6, _property$annotations7, _property$annotations8, _property$annotations9;
      const unitProperty = getAssociatedCurrencyProperty(property) || getAssociatedUnitProperty(property);
      const timezoneProperty = getAssociatedTimezoneProperty(property);
      const unitText = ((_property$annotations4 = property.annotations) === null || _property$annotations4 === void 0 ? void 0 : (_property$annotations5 = _property$annotations4.Measures) === null || _property$annotations5 === void 0 ? void 0 : _property$annotations5.ISOCurrency) || ((_property$annotations6 = property.annotations) === null || _property$annotations6 === void 0 ? void 0 : (_property$annotations7 = _property$annotations6.Measures) === null || _property$annotations7 === void 0 ? void 0 : _property$annotations7.Unit);
      const timezoneText = (_property$annotations8 = property.annotations) === null || _property$annotations8 === void 0 ? void 0 : (_property$annotations9 = _property$annotations8.Common) === null || _property$annotations9 === void 0 ? void 0 : _property$annotations9.Timezone;
      exportSettings = {
        type: exportType,
        inputFormat: sDateInputFormat,
        scale: property.scale,
        delimiter: property.type === "Edm.Int64"
      };
      if (unitProperty) {
        exportSettings.unitProperty = unitProperty.name;
        exportSettings.type = "Currency"; // Force to a currency because there's a unitProperty (otherwise the value isn't properly formatted when exported)
      } else if (unitText) {
        exportSettings.unit = `${unitText}`;
      }
      if (timezoneProperty) {
        exportSettings.timezoneProperty = timezoneProperty.name;
        exportSettings.utc = false;
      } else if (timezoneText) {
        exportSettings.timezone = timezoneText.toString();
      }
    }
    const collectedNavigationPropertyLabels = _getCollectedNavigationPropertyLabels(relativePath, converterContext);
    const column = {
      key: key,
      type: ColumnType.Annotation,
      label: getLabel(property, isGroup),
      groupLabel: isGroup ? getLabel(property) : undefined,
      group: isGroup ? groupPath : undefined,
      annotationPath: fullPropertyPath,
      semanticObjectPath: semanticObjectAnnotationPath,
      availability: !availableForAdaptation || isHidden ? AvailabilityType.Hidden : AvailabilityType.Adaptation,
      name: name,
      relativePath: relativePath,
      sortable: sortable,
      isGroupable: aggregationHelper.isAnalyticsSupported() ? !!aggregationHelper.isPropertyGroupable(property) : sortable,
      isKey: property.isKey,
      exportSettings: exportSettings,
      caseSensitive: isFilteringCaseSensitive(converterContext),
      typeConfig: typeConfig,
      importance: getImportance((_annotations2 = property.annotations) === null || _annotations2 === void 0 ? void 0 : (_annotations2$UI = _annotations2.UI) === null || _annotations2$UI === void 0 ? void 0 : _annotations2$UI.DataFieldDefault, semanticKeys),
      additionalLabels: collectedNavigationPropertyLabels
    };
    const sTooltip = _getTooltip(property);
    if (sTooltip) {
      column.tooltip = sTooltip;
    }
    const targetValuefromDP = getTargetValueOnDataPoint(property);
    if (isDataPointFromDataFieldDefault(property) && typeof targetValuefromDP === "string" && column.exportSettings) {
      column.exportDataPointTargetValue = targetValuefromDP;
      column.exportSettings.template = "{0}/" + targetValuefromDP;
    }
    return column;
  };

  /**
   * Returns Boolean true for exportable columns, false for non exportable columns.
   *
   * @param source The dataField or property to be evaluated
   * @returns True for exportable column, false for non exportable column
   * @private
   */

  function _isExportableColumn(source) {
    var _annotations$UI2;
    let propertyType, property;
    const dataFieldDefaultProperty = (_annotations$UI2 = source.annotations.UI) === null || _annotations$UI2 === void 0 ? void 0 : _annotations$UI2.DataFieldDefault;
    if (isProperty(source) && dataFieldDefaultProperty !== null && dataFieldDefaultProperty !== void 0 && dataFieldDefaultProperty.$Type) {
      if (isReferencePropertyStaticallyHidden(dataFieldDefaultProperty) === true) {
        return false;
      }
      propertyType = dataFieldDefaultProperty === null || dataFieldDefaultProperty === void 0 ? void 0 : dataFieldDefaultProperty.$Type;
    } else if (isReferencePropertyStaticallyHidden(source) === true) {
      return false;
    } else {
      var _Target, _Target$$target, _Value, _Value$$target, _Value$$target$annota, _Value$$target$annota2, _Value$$target$annota3, _Value2, _Value2$$target, _Value2$$target$annot, _Value2$$target$annot2;
      property = source;
      propertyType = property.$Type;
      if (propertyType === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && (_Target = property.Target) !== null && _Target !== void 0 && (_Target$$target = _Target.$target) !== null && _Target$$target !== void 0 && _Target$$target.$Type) {
        var _Target2, _Target2$$target;
        //For Chart
        propertyType = (_Target2 = property.Target) === null || _Target2 === void 0 ? void 0 : (_Target2$$target = _Target2.$target) === null || _Target2$$target === void 0 ? void 0 : _Target2$$target.$Type;
        return "com.sap.vocabularies.UI.v1.ChartDefinitionType".indexOf(propertyType) === -1;
      } else if (((_Value = property.Value) === null || _Value === void 0 ? void 0 : (_Value$$target = _Value.$target) === null || _Value$$target === void 0 ? void 0 : (_Value$$target$annota = _Value$$target.annotations) === null || _Value$$target$annota === void 0 ? void 0 : (_Value$$target$annota2 = _Value$$target$annota.Core) === null || _Value$$target$annota2 === void 0 ? void 0 : (_Value$$target$annota3 = _Value$$target$annota2.MediaType) === null || _Value$$target$annota3 === void 0 ? void 0 : _Value$$target$annota3.term) === "Org.OData.Core.V1.MediaType" && ((_Value2 = property.Value) === null || _Value2 === void 0 ? void 0 : (_Value2$$target = _Value2.$target) === null || _Value2$$target === void 0 ? void 0 : (_Value2$$target$annot = _Value2$$target.annotations) === null || _Value2$$target$annot === void 0 ? void 0 : (_Value2$$target$annot2 = _Value2$$target$annot.Core) === null || _Value2$$target$annot2 === void 0 ? void 0 : _Value2$$target$annot2.isURL) !== true) {
        //For Stream
        return false;
      }
    }
    return propertyType ? ["com.sap.vocabularies.UI.v1.DataFieldForAction", "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation", "com.sap.vocabularies.UI.v1.DataFieldForActionGroup"].indexOf(propertyType) === -1 : true;
  }

  /**
   * Returns Boolean true for valid columns, false for invalid columns.
   *
   * @param dataField Different DataField types defined in the annotations
   * @returns True for valid columns, false for invalid columns
   * @private
   */
  const _isValidColumn = function (dataField) {
    switch (dataField.$Type) {
      case "com.sap.vocabularies.UI.v1.DataFieldForAction":
      case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
        return !!dataField.Inline;
      case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
      case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
      case "com.sap.vocabularies.UI.v1.DataField":
      case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
      case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
      case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
        return true;
      default:
      // Todo: Replace with proper Log statement once available
      //  throw new Error("Unhandled DataField Abstract type: " + dataField.$Type);
    }
  };
  /**
   * Returns the binding expression to evaluate the visibility of a DataField or DataPoint annotation.
   *
   * SAP Fiori elements will evaluate either the UI.Hidden annotation defined on the annotation itself or on the target property.
   *
   * @param dataFieldModelPath The metapath referring to the annotation that is evaluated by SAP Fiori elements.
   * @param [formatOptions] FormatOptions optional.
   * @param formatOptions.isAnalytics This flag is used to check if the analytic table has GroupHeader expanded.
   * @returns An expression that you can bind to the UI.
   */
  const _getVisibleExpression = function (dataFieldModelPath, formatOptions) {
    var _targetObject$Target, _targetObject$Target$, _targetObject$annotat, _targetObject$annotat2, _propertyValue$annota, _propertyValue$annota2;
    const targetObject = dataFieldModelPath.targetObject;
    let propertyValue;
    if (targetObject) {
      switch (targetObject.$Type) {
        case "com.sap.vocabularies.UI.v1.DataField":
        case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
        case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
        case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
        case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
        case "com.sap.vocabularies.UI.v1.DataPointType":
          propertyValue = targetObject.Value.$target;
          break;
        case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
          // if it is a DataFieldForAnnotation pointing to a DataPoint we look at the dataPoint's value
          if ((targetObject === null || targetObject === void 0 ? void 0 : (_targetObject$Target = targetObject.Target) === null || _targetObject$Target === void 0 ? void 0 : (_targetObject$Target$ = _targetObject$Target.$target) === null || _targetObject$Target$ === void 0 ? void 0 : _targetObject$Target$.$Type) === "com.sap.vocabularies.UI.v1.DataPointType") {
            var _targetObject$Target$2;
            propertyValue = (_targetObject$Target$2 = targetObject.Target.$target) === null || _targetObject$Target$2 === void 0 ? void 0 : _targetObject$Target$2.Value.$target;
          }
          break;
        case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
        case "com.sap.vocabularies.UI.v1.DataFieldForAction":
        default:
          propertyValue = undefined;
      }
    }
    const isAnalyticalGroupHeaderExpanded = formatOptions !== null && formatOptions !== void 0 && formatOptions.isAnalytics ? UI.IsExpanded : constant(false);
    const isAnalyticalLeaf = formatOptions !== null && formatOptions !== void 0 && formatOptions.isAnalytics ? equal(UI.NodeLevel, 0) : constant(false);

    // A data field is visible if:
    // - the UI.Hidden expression in the original annotation does not evaluate to 'true'
    // - the UI.Hidden expression in the target property does not evaluate to 'true'
    // - in case of Analytics it's not visible for an expanded GroupHeader
    return and(...[not(equal(getExpressionFromAnnotation(targetObject === null || targetObject === void 0 ? void 0 : (_targetObject$annotat = targetObject.annotations) === null || _targetObject$annotat === void 0 ? void 0 : (_targetObject$annotat2 = _targetObject$annotat.UI) === null || _targetObject$annotat2 === void 0 ? void 0 : _targetObject$annotat2.Hidden), true)), ifElse(!!propertyValue, propertyValue && not(equal(getExpressionFromAnnotation((_propertyValue$annota = propertyValue.annotations) === null || _propertyValue$annota === void 0 ? void 0 : (_propertyValue$annota2 = _propertyValue$annota.UI) === null || _propertyValue$annota2 === void 0 ? void 0 : _propertyValue$annota2.Hidden), true)), true), or(not(isAnalyticalGroupHeaderExpanded), isAnalyticalLeaf)]);
  };

  /**
   * Returns hidden binding expressions for a field group.
   *
   * @param dataFieldGroup DataField defined in the annotations
   * @param fieldFormatOptions FormatOptions optional.
   * @returns Compile binding of field group expressions.
   * @private
   */
  _exports._getVisibleExpression = _getVisibleExpression;
  const _getFieldGroupHiddenExpressions = function (dataFieldGroup, fieldFormatOptions) {
    var _dataFieldGroup$Targe, _dataFieldGroup$Targe2;
    const fieldGroupHiddenExpressions = [];
    if (dataFieldGroup.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && ((_dataFieldGroup$Targe = dataFieldGroup.Target) === null || _dataFieldGroup$Targe === void 0 ? void 0 : (_dataFieldGroup$Targe2 = _dataFieldGroup$Targe.$target) === null || _dataFieldGroup$Targe2 === void 0 ? void 0 : _dataFieldGroup$Targe2.$Type) === "com.sap.vocabularies.UI.v1.FieldGroupType") {
      var _dataFieldGroup$annot, _dataFieldGroup$annot2;
      if (dataFieldGroup !== null && dataFieldGroup !== void 0 && (_dataFieldGroup$annot = dataFieldGroup.annotations) !== null && _dataFieldGroup$annot !== void 0 && (_dataFieldGroup$annot2 = _dataFieldGroup$annot.UI) !== null && _dataFieldGroup$annot2 !== void 0 && _dataFieldGroup$annot2.Hidden) {
        return compileExpression(not(equal(getExpressionFromAnnotation(dataFieldGroup.annotations.UI.Hidden), true)));
      } else {
        var _dataFieldGroup$Targe3;
        (_dataFieldGroup$Targe3 = dataFieldGroup.Target.$target.Data) === null || _dataFieldGroup$Targe3 === void 0 ? void 0 : _dataFieldGroup$Targe3.forEach(innerDataField => {
          fieldGroupHiddenExpressions.push(_getVisibleExpression({
            targetObject: innerDataField
          }, fieldFormatOptions));
        });
        return compileExpression(ifElse(or(...fieldGroupHiddenExpressions), constant(true), constant(false)));
      }
    } else {
      return undefined;
    }
  };

  /**
   * Returns the label for the property and dataField.
   *
   * @param [property] Property, DataField or Navigation Property defined in the annotations
   * @param isGroup
   * @returns Label of the property or DataField
   * @private
   */
  const getLabel = function (property) {
    let isGroup = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    if (!property) {
      return undefined;
    }
    if (isProperty(property) || isNavigationProperty(property)) {
      var _annotations3, _annotations3$UI, _dataFieldDefault$Lab, _property$annotations10, _property$annotations11;
      const dataFieldDefault = (_annotations3 = property.annotations) === null || _annotations3 === void 0 ? void 0 : (_annotations3$UI = _annotations3.UI) === null || _annotations3$UI === void 0 ? void 0 : _annotations3$UI.DataFieldDefault;
      if (dataFieldDefault && !dataFieldDefault.qualifier && (_dataFieldDefault$Lab = dataFieldDefault.Label) !== null && _dataFieldDefault$Lab !== void 0 && _dataFieldDefault$Lab.valueOf()) {
        var _dataFieldDefault$Lab2;
        return compileExpression(getExpressionFromAnnotation((_dataFieldDefault$Lab2 = dataFieldDefault.Label) === null || _dataFieldDefault$Lab2 === void 0 ? void 0 : _dataFieldDefault$Lab2.valueOf()));
      }
      return compileExpression(getExpressionFromAnnotation(((_property$annotations10 = property.annotations.Common) === null || _property$annotations10 === void 0 ? void 0 : (_property$annotations11 = _property$annotations10.Label) === null || _property$annotations11 === void 0 ? void 0 : _property$annotations11.valueOf()) || property.name));
    } else if (isDataFieldTypes(property)) {
      var _property$Label2, _property$Value, _property$Value$$targ, _property$Value$$targ2, _property$Value$$targ3, _property$Value$$targ4, _property$Value2, _property$Value2$$tar;
      if (!!isGroup && property.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation") {
        var _property$Label;
        return compileExpression(getExpressionFromAnnotation((_property$Label = property.Label) === null || _property$Label === void 0 ? void 0 : _property$Label.valueOf()));
      }
      return compileExpression(getExpressionFromAnnotation(((_property$Label2 = property.Label) === null || _property$Label2 === void 0 ? void 0 : _property$Label2.valueOf()) || ((_property$Value = property.Value) === null || _property$Value === void 0 ? void 0 : (_property$Value$$targ = _property$Value.$target) === null || _property$Value$$targ === void 0 ? void 0 : (_property$Value$$targ2 = _property$Value$$targ.annotations) === null || _property$Value$$targ2 === void 0 ? void 0 : (_property$Value$$targ3 = _property$Value$$targ2.Common) === null || _property$Value$$targ3 === void 0 ? void 0 : (_property$Value$$targ4 = _property$Value$$targ3.Label) === null || _property$Value$$targ4 === void 0 ? void 0 : _property$Value$$targ4.valueOf()) || ((_property$Value2 = property.Value) === null || _property$Value2 === void 0 ? void 0 : (_property$Value2$$tar = _property$Value2.$target) === null || _property$Value2$$tar === void 0 ? void 0 : _property$Value2$$tar.name)));
    } else if (property.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation") {
      var _property$Label3, _property$Target, _property$Target$$tar, _property$Target$$tar2, _property$Target$$tar3, _property$Target$$tar4, _property$Target$$tar5, _property$Target$$tar6;
      return compileExpression(getExpressionFromAnnotation(((_property$Label3 = property.Label) === null || _property$Label3 === void 0 ? void 0 : _property$Label3.valueOf()) || ((_property$Target = property.Target) === null || _property$Target === void 0 ? void 0 : (_property$Target$$tar = _property$Target.$target) === null || _property$Target$$tar === void 0 ? void 0 : (_property$Target$$tar2 = _property$Target$$tar.Value) === null || _property$Target$$tar2 === void 0 ? void 0 : (_property$Target$$tar3 = _property$Target$$tar2.$target) === null || _property$Target$$tar3 === void 0 ? void 0 : (_property$Target$$tar4 = _property$Target$$tar3.annotations) === null || _property$Target$$tar4 === void 0 ? void 0 : (_property$Target$$tar5 = _property$Target$$tar4.Common) === null || _property$Target$$tar5 === void 0 ? void 0 : (_property$Target$$tar6 = _property$Target$$tar5.Label) === null || _property$Target$$tar6 === void 0 ? void 0 : _property$Target$$tar6.valueOf())));
    } else {
      var _property$Label4;
      return compileExpression(getExpressionFromAnnotation((_property$Label4 = property.Label) === null || _property$Label4 === void 0 ? void 0 : _property$Label4.valueOf()));
    }
  };
  const _getTooltip = function (source) {
    var _source$annotations, _source$annotations$C;
    if (!source) {
      return undefined;
    }
    if (isProperty(source) || (_source$annotations = source.annotations) !== null && _source$annotations !== void 0 && (_source$annotations$C = _source$annotations.Common) !== null && _source$annotations$C !== void 0 && _source$annotations$C.QuickInfo) {
      var _source$annotations2, _source$annotations2$;
      return (_source$annotations2 = source.annotations) !== null && _source$annotations2 !== void 0 && (_source$annotations2$ = _source$annotations2.Common) !== null && _source$annotations2$ !== void 0 && _source$annotations2$.QuickInfo ? compileExpression(getExpressionFromAnnotation(source.annotations.Common.QuickInfo.valueOf())) : undefined;
    } else if (isDataFieldTypes(source)) {
      var _source$Value, _source$Value$$target, _source$Value$$target2, _source$Value$$target3;
      return (_source$Value = source.Value) !== null && _source$Value !== void 0 && (_source$Value$$target = _source$Value.$target) !== null && _source$Value$$target !== void 0 && (_source$Value$$target2 = _source$Value$$target.annotations) !== null && _source$Value$$target2 !== void 0 && (_source$Value$$target3 = _source$Value$$target2.Common) !== null && _source$Value$$target3 !== void 0 && _source$Value$$target3.QuickInfo ? compileExpression(getExpressionFromAnnotation(source.Value.$target.annotations.Common.QuickInfo.valueOf())) : undefined;
    } else if (source.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation") {
      var _source$Target, _datapointTarget$Valu, _datapointTarget$Valu2, _datapointTarget$Valu3, _datapointTarget$Valu4;
      const datapointTarget = (_source$Target = source.Target) === null || _source$Target === void 0 ? void 0 : _source$Target.$target;
      return datapointTarget !== null && datapointTarget !== void 0 && (_datapointTarget$Valu = datapointTarget.Value) !== null && _datapointTarget$Valu !== void 0 && (_datapointTarget$Valu2 = _datapointTarget$Valu.$target) !== null && _datapointTarget$Valu2 !== void 0 && (_datapointTarget$Valu3 = _datapointTarget$Valu2.annotations) !== null && _datapointTarget$Valu3 !== void 0 && (_datapointTarget$Valu4 = _datapointTarget$Valu3.Common) !== null && _datapointTarget$Valu4 !== void 0 && _datapointTarget$Valu4.QuickInfo ? compileExpression(getExpressionFromAnnotation(datapointTarget.Value.$target.annotations.Common.QuickInfo.valueOf())) : undefined;
    } else {
      return undefined;
    }
  };
  function getRowStatusVisibility(colName, isSemanticKeyInFieldGroup) {
    return formatResult([pathInModel(`semanticKeyHasDraftIndicator`, "internal"), pathInModel(`filteredMessages`, "internal"), colName, isSemanticKeyInFieldGroup], tableFormatters.getErrorStatusTextVisibilityFormatter);
  }

  /**
   * Creates a PropertyInfo for each identified property consumed by a LineItem.
   *
   * @param columnsToBeCreated Identified properties.
   * @param existingColumns The list of columns created for LineItems and Properties of entityType.
   * @param nonSortableColumns The array of column names which cannot be sorted.
   * @param converterContext The converter context.
   * @param entityType The entity type for the LineItem
   * @param textOnlyColumnsFromTextAnnotation The array of columns from a property using a text annotation with textOnly as text arrangement.
   * @returns The array of columns created.
   */
  _exports.getRowStatusVisibility = getRowStatusVisibility;
  const _createRelatedColumns = function (columnsToBeCreated, existingColumns, nonSortableColumns, converterContext, entityType, textOnlyColumnsFromTextAnnotation) {
    const relatedColumns = [];
    const relatedPropertyNameMap = {};
    const aggregationHelper = new AggregationHelper(entityType, converterContext);
    Object.keys(columnsToBeCreated).forEach(name => {
      const property = columnsToBeCreated[name],
        annotationPath = converterContext.getAbsoluteAnnotationPath(name),
        // Check whether the related column already exists.
        relatedColumn = existingColumns.find(column => column.name === name);
      if (relatedColumn === undefined) {
        // Case 1: Key contains DataField prefix to ensure all property columns have the same key format.
        // New created property column is set to hidden.
        relatedColumns.push(getColumnDefinitionFromProperty(property, annotationPath, name, true, false, nonSortableColumns, aggregationHelper, converterContext, textOnlyColumnsFromTextAnnotation));
      } else if (relatedColumn.annotationPath !== annotationPath || relatedColumn.propertyInfos) {
        // Case 2: The existing column points to a LineItem (or)
        // Case 3: This is a self reference from an existing column

        const newName = `Property::${name}`;

        // Checking whether the related property column has already been created in a previous iteration.
        if (!existingColumns.some(column => column.name === newName)) {
          // Create a new property column with 'Property::' prefix,
          // Set it to hidden as it is only consumed by Complex property infos.
          const column = getColumnDefinitionFromProperty(property, annotationPath, name, false, false, nonSortableColumns, aggregationHelper, converterContext, textOnlyColumnsFromTextAnnotation);
          column.isPartOfLineItem = relatedColumn.isPartOfLineItem;
          relatedColumns.push(column);
          relatedPropertyNameMap[name] = newName;
        } else if (existingColumns.some(column => column.name === newName) && existingColumns.some(column => {
          var _column$propertyInfos;
          return (_column$propertyInfos = column.propertyInfos) === null || _column$propertyInfos === void 0 ? void 0 : _column$propertyInfos.includes(name);
        })) {
          relatedPropertyNameMap[name] = newName;
        }
      }
    });

    // The property 'name' has been prefixed with 'Property::' for uniqueness.
    // Update the same in other propertyInfos[] references which point to this property.
    existingColumns.forEach(column => {
      var _column$propertyInfos2, _column$additionalPro;
      column.propertyInfos = (_column$propertyInfos2 = column.propertyInfos) === null || _column$propertyInfos2 === void 0 ? void 0 : _column$propertyInfos2.map(propertyInfo => relatedPropertyNameMap[propertyInfo] ?? propertyInfo);
      column.additionalPropertyInfos = (_column$additionalPro = column.additionalPropertyInfos) === null || _column$additionalPro === void 0 ? void 0 : _column$additionalPro.map(propertyInfo => relatedPropertyNameMap[propertyInfo] ?? propertyInfo);
    });
    return relatedColumns;
  };

  /**
   * Getting the Column Name
   * If it points to a DataField with one property or DataPoint with one property, it will use the property name
   * here to be consistent with the existing flex changes.
   *
   * @param dataField Different DataField types defined in the annotations
   * @returns The name of annotation columns
   * @private
   */
  const _getAnnotationColumnName = function (dataField) {
    var _dataField$Target, _dataField$Target$$ta, _dataField$Target$$ta2;
    // This is needed as we have flexibility changes already that we have to check against
    if (isDataFieldTypes(dataField)) {
      var _dataField$Value;
      return (_dataField$Value = dataField.Value) === null || _dataField$Value === void 0 ? void 0 : _dataField$Value.path;
    } else if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && (_dataField$Target = dataField.Target) !== null && _dataField$Target !== void 0 && (_dataField$Target$$ta = _dataField$Target.$target) !== null && _dataField$Target$$ta !== void 0 && (_dataField$Target$$ta2 = _dataField$Target$$ta.Value) !== null && _dataField$Target$$ta2 !== void 0 && _dataField$Target$$ta2.path) {
      var _dataField$Target2, _dataField$Target2$$t;
      // This is for removing duplicate properties. For example, 'Progress' Property is removed if it is already defined as a DataPoint
      return (_dataField$Target2 = dataField.Target) === null || _dataField$Target2 === void 0 ? void 0 : (_dataField$Target2$$t = _dataField$Target2.$target) === null || _dataField$Target2$$t === void 0 ? void 0 : _dataField$Target2$$t.Value.path;
    } else {
      return KeyHelper.generateKeyFromDataField(dataField);
    }
  };

  /**
   * Creates a PropertyInfo for the identified additional property for the ALP table use-case.
   *
   * For e.g. If UI.Hidden points to a property, include this technical property in the additionalProperties of ComplexPropertyInfo object.
   *
   * @param name The name of the property to be created.
   * @param columns The list of columns created for LineItems and Properties of entityType from the table visualization.
   * @returns The propertyInfo of the technical property to be added to the list of columns.
   * @private
   */

  const createTechnicalProperty = function (name, columns, relatedAdditionalPropertyNameMap) {
    const key = `Property_Technical::${name}`;
    // Validate if the technical property hasn't yet been created on previous iterations.
    const columnExists = columns.find(column => column.key === key);
    // Retrieve the simple property used by the hidden annotation, it will be used as a base for the mandatory attributes of newly created technical property. For e.g. relativePath
    const additionalProperty = !columnExists && columns.find(column => column.name === name && !column.propertyInfos);
    if (additionalProperty) {
      const technicalColumn = {
        key: key,
        type: ColumnType.Annotation,
        label: additionalProperty.label,
        annotationPath: additionalProperty.annotationPath,
        availability: AvailabilityType.Hidden,
        name: key,
        relativePath: additionalProperty.relativePath,
        sortable: false,
        isGroupable: false,
        isKey: false,
        exportSettings: null,
        caseSensitive: false,
        aggregatable: false,
        extension: {
          technicallyGroupable: true,
          technicallyAggregatable: true
        }
      };
      columns.push(technicalColumn);
      relatedAdditionalPropertyNameMap[name] = technicalColumn.name;
    }
  };

  /**
   * Determines if the data field labels have to be displayed in the table.
   *
   * @param fieldGroupName The `DataField` name being processed.
   * @param visualizationPath
   * @param converterContext
   * @returns `showDataFieldsLabel` value from the manifest
   * @private
   */
  const _getShowDataFieldsLabel = function (fieldGroupName, visualizationPath, converterContext) {
    var _converterContext$get15;
    const oColumns = (_converterContext$get15 = converterContext.getManifestControlConfiguration(visualizationPath)) === null || _converterContext$get15 === void 0 ? void 0 : _converterContext$get15.columns;
    const aColumnKeys = oColumns && Object.keys(oColumns);
    return aColumnKeys && !!aColumnKeys.find(function (key) {
      return key === fieldGroupName && oColumns[key].showDataFieldsLabel;
    });
  };

  /**
   * Determines the relative path of the property with respect to the root entity.
   *
   * @param dataField The `DataField` being processed.
   * @returns The relative path
   */
  const _getRelativePath = function (dataField) {
    var _Value3, _dataField$Target3;
    let relativePath = "";
    switch (dataField.$Type) {
      case "com.sap.vocabularies.UI.v1.DataField":
      case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
      case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
      case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
      case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
        relativePath = dataField === null || dataField === void 0 ? void 0 : (_Value3 = dataField.Value) === null || _Value3 === void 0 ? void 0 : _Value3.path;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
        relativePath = dataField === null || dataField === void 0 ? void 0 : (_dataField$Target3 = dataField.Target) === null || _dataField$Target3 === void 0 ? void 0 : _dataField$Target3.value;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldForAction":
      case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
      case "com.sap.vocabularies.UI.v1.DataFieldForActionGroup":
      case "com.sap.vocabularies.UI.v1.DataFieldWithActionGroup":
        relativePath = KeyHelper.generateKeyFromDataField(dataField);
        break;
    }
    return relativePath;
  };
  const _sliceAtSlash = function (path, isLastSlash, isLastPart) {
    const iSlashIndex = isLastSlash ? path.lastIndexOf("/") : path.indexOf("/");
    if (iSlashIndex === -1) {
      return path;
    }
    return isLastPart ? path.substring(iSlashIndex + 1, path.length) : path.substring(0, iSlashIndex);
  };

  /**
   * Determines if the column contains a multi-value field.
   *
   * @param dataField The DataField being processed
   * @param converterContext The converter context
   * @returns True if the DataField corresponds to a multi-value field.
   */
  const _isColumnMultiValued = function (dataField, converterContext) {
    if (isDataFieldTypes(dataField) && isPathExpression(dataField.Value)) {
      const propertyObjectPath = enhanceDataModelPath(converterContext.getDataModelObjectPath(), dataField.Value.path);
      return isMultiValueField(propertyObjectPath);
    } else {
      return false;
    }
  };

  /**
   * Determine whether a column is sortable.
   *
   * @param dataField The data field being processed
   * @param propertyPath The property path
   * @param nonSortableColumns Collection of non-sortable column names as per annotation
   * @returns True if the column is sortable
   */
  const _isColumnSortable = function (dataField, propertyPath, nonSortableColumns) {
    return nonSortableColumns.indexOf(propertyPath) === -1 && (
    // Column is not marked as non-sortable via annotation
    dataField.$Type === "com.sap.vocabularies.UI.v1.DataField" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithUrl" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithAction");
  };

  /**
   * Returns whether filtering on the table is case sensitive.
   *
   * @param converterContext The instance of the converter context
   * @returns Returns 'false' if FilterFunctions annotation supports 'tolower', else 'true'
   */
  const isFilteringCaseSensitive = function (converterContext) {
    const filterFunctions = _getFilterFunctions(converterContext);
    return Array.isArray(filterFunctions) ? filterFunctions.indexOf("tolower") === -1 : true;
  };
  _exports.isFilteringCaseSensitive = isFilteringCaseSensitive;
  function _getFilterFunctions(ConverterContext) {
    var _ConverterContext$get, _ConverterContext$get2, _ConverterContext$get3, _ConverterContext$get4, _ConverterContext$get5;
    if (ModelHelper.isSingleton(ConverterContext.getEntitySet())) {
      return undefined;
    }
    const capabilities = (_ConverterContext$get = ConverterContext.getEntitySet()) === null || _ConverterContext$get === void 0 ? void 0 : (_ConverterContext$get2 = _ConverterContext$get.annotations) === null || _ConverterContext$get2 === void 0 ? void 0 : _ConverterContext$get2.Capabilities;
    return (capabilities === null || capabilities === void 0 ? void 0 : capabilities.FilterFunctions) || ((_ConverterContext$get3 = ConverterContext.getEntityContainer()) === null || _ConverterContext$get3 === void 0 ? void 0 : (_ConverterContext$get4 = _ConverterContext$get3.annotations) === null || _ConverterContext$get4 === void 0 ? void 0 : (_ConverterContext$get5 = _ConverterContext$get4.Capabilities) === null || _ConverterContext$get5 === void 0 ? void 0 : _ConverterContext$get5.FilterFunctions);
  }

  /**
   * Returns default format options for text fields in a table.
   *
   * @param formatOptions
   * @returns Collection of format options with default values
   */
  function _getDefaultFormatOptionsForTable(formatOptions) {
    return formatOptions === undefined ? undefined : {
      textLinesEdit: 4,
      ...formatOptions
    };
  }
  function _findSemanticKeyValues(semanticKeys, name) {
    const aSemanticKeyValues = [];
    let bSemanticKeyFound = false;
    for (let i = 0; i < semanticKeys.length; i++) {
      aSemanticKeyValues.push(semanticKeys[i].value);
      if (semanticKeys[i].value === name) {
        bSemanticKeyFound = true;
      }
    }
    return {
      values: aSemanticKeyValues,
      semanticKeyFound: bSemanticKeyFound
    };
  }
  function _findProperties(semanticKeyValues, fieldGroupProperties) {
    let semanticKeyHasPropertyInFieldGroup = false;
    let sPropertyPath;
    if (semanticKeyValues && semanticKeyValues.length >= 1 && fieldGroupProperties && fieldGroupProperties.length >= 1) {
      for (let i = 0; i < semanticKeyValues.length; i++) {
        if ([semanticKeyValues[i]].some(tmp => fieldGroupProperties.indexOf(tmp) >= 0)) {
          semanticKeyHasPropertyInFieldGroup = true;
          sPropertyPath = semanticKeyValues[i];
          break;
        }
      }
    }
    return {
      semanticKeyHasPropertyInFieldGroup: semanticKeyHasPropertyInFieldGroup,
      fieldGroupPropertyPath: sPropertyPath
    };
  }
  function _findSemanticKeyValuesInFieldGroup(dataFieldGroup, semanticKeyValues) {
    var _dataFieldGroup$Targe4, _dataFieldGroup$Targe5;
    const aProperties = [];
    let _propertiesFound = {
      semanticKeyHasPropertyInFieldGroup: false,
      fieldGroupPropertyPath: undefined
    };
    if (dataFieldGroup && dataFieldGroup.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && ((_dataFieldGroup$Targe4 = dataFieldGroup.Target) === null || _dataFieldGroup$Targe4 === void 0 ? void 0 : (_dataFieldGroup$Targe5 = _dataFieldGroup$Targe4.$target) === null || _dataFieldGroup$Targe5 === void 0 ? void 0 : _dataFieldGroup$Targe5.$Type) === "com.sap.vocabularies.UI.v1.FieldGroupType") {
      var _dataFieldGroup$Targe6;
      (_dataFieldGroup$Targe6 = dataFieldGroup.Target.$target.Data) === null || _dataFieldGroup$Targe6 === void 0 ? void 0 : _dataFieldGroup$Targe6.forEach(innerDataField => {
        if ((innerDataField.$Type === "com.sap.vocabularies.UI.v1.DataField" || innerDataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithUrl") && innerDataField.Value) {
          aProperties.push(innerDataField.Value.path);
        }
        _propertiesFound = _findProperties(semanticKeyValues, aProperties);
      });
    }
    return {
      semanticKeyHasPropertyInFieldGroup: _propertiesFound.semanticKeyHasPropertyInFieldGroup,
      propertyPath: _propertiesFound.fieldGroupPropertyPath
    };
  }

  /**
   * Returns default format options with draftIndicator for a column.
   *
   * @param name
   * @param semanticKeys
   * @param isFieldGroupColumn
   * @param dataFieldGroup
   * @returns Collection of format options with default values
   */
  function getDefaultDraftIndicatorForColumn(name, semanticKeys, isFieldGroupColumn, dataFieldGroup) {
    if (!semanticKeys) {
      return {};
    }
    const semanticKey = _findSemanticKeyValues(semanticKeys, name);
    const semanticKeyInFieldGroup = _findSemanticKeyValuesInFieldGroup(dataFieldGroup, semanticKey.values);
    if (semanticKey.semanticKeyFound) {
      const formatOptionsObj = {
        hasDraftIndicator: true,
        semantickeys: semanticKey.values,
        objectStatusTextVisibility: compileExpression(getRowStatusVisibility(name, false))
      };
      if (isFieldGroupColumn && semanticKeyInFieldGroup.semanticKeyHasPropertyInFieldGroup) {
        formatOptionsObj["objectStatusTextVisibility"] = compileExpression(getRowStatusVisibility(name, true));
        formatOptionsObj["fieldGroupDraftIndicatorPropertyPath"] = semanticKeyInFieldGroup.propertyPath;
      }
      return formatOptionsObj;
    } else if (!semanticKeyInFieldGroup.semanticKeyHasPropertyInFieldGroup) {
      return {};
    } else {
      // Semantic Key has a property in a FieldGroup
      return {
        fieldGroupDraftIndicatorPropertyPath: semanticKeyInFieldGroup.propertyPath,
        fieldGroupName: name,
        objectStatusTextVisibility: compileExpression(getRowStatusVisibility(name, true))
      };
    }
  }
  function _getImpNumber(dataField) {
    var _dataField$annotation17, _dataField$annotation18;
    const importance = dataField === null || dataField === void 0 ? void 0 : (_dataField$annotation17 = dataField.annotations) === null || _dataField$annotation17 === void 0 ? void 0 : (_dataField$annotation18 = _dataField$annotation17.UI) === null || _dataField$annotation18 === void 0 ? void 0 : _dataField$annotation18.Importance;
    if (importance && importance.includes("UI.ImportanceType/High")) {
      return 3;
    }
    if (importance && importance.includes("UI.ImportanceType/Medium")) {
      return 2;
    }
    if (importance && importance.includes("UI.ImportanceType/Low")) {
      return 1;
    }
    return 0;
  }
  function _getDataFieldImportance(dataField) {
    var _dataField$annotation19, _dataField$annotation20;
    const importance = dataField === null || dataField === void 0 ? void 0 : (_dataField$annotation19 = dataField.annotations) === null || _dataField$annotation19 === void 0 ? void 0 : (_dataField$annotation20 = _dataField$annotation19.UI) === null || _dataField$annotation20 === void 0 ? void 0 : _dataField$annotation20.Importance;
    return importance ? importance.split("/")[1] : Importance.None;
  }
  function _getMaxImportance(fields) {
    if (fields && fields.length > 0) {
      let maxImpNumber = -1;
      let impNumber = -1;
      let DataFieldWithMaxImportance;
      for (const field of fields) {
        impNumber = _getImpNumber(field);
        if (impNumber > maxImpNumber) {
          maxImpNumber = impNumber;
          DataFieldWithMaxImportance = field;
        }
      }
      return _getDataFieldImportance(DataFieldWithMaxImportance);
    }
    return Importance.None;
  }

  /**
   * Returns the importance value for a column.
   *
   * @param dataField
   * @param semanticKeys
   * @returns The importance value
   */
  function getImportance(dataField, semanticKeys) {
    var _Value6;
    //Evaluate default Importance is not set explicitly
    let fieldsWithImportance, mapSemanticKeys;
    //Check if semanticKeys are defined at the EntitySet level
    if (semanticKeys && semanticKeys.length > 0) {
      mapSemanticKeys = semanticKeys.map(function (key) {
        return key.value;
      });
    }
    if (!dataField) {
      return undefined;
    }
    if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation") {
      const fieldGroupData = dataField.Target["$target"]["Data"],
        fieldGroupHasSemanticKey = fieldGroupData && fieldGroupData.some(function (fieldGroupDataField) {
          var _Value4, _Value5;
          return (fieldGroupDataField === null || fieldGroupDataField === void 0 ? void 0 : (_Value4 = fieldGroupDataField.Value) === null || _Value4 === void 0 ? void 0 : _Value4.path) && fieldGroupDataField.$Type !== "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && mapSemanticKeys && mapSemanticKeys.includes(fieldGroupDataField === null || fieldGroupDataField === void 0 ? void 0 : (_Value5 = fieldGroupDataField.Value) === null || _Value5 === void 0 ? void 0 : _Value5.path);
        });
      //If a FieldGroup contains a semanticKey, importance set to High
      if (fieldGroupHasSemanticKey) {
        return Importance.High;
      } else {
        var _dataField$annotation21, _dataField$annotation22;
        //If the DataFieldForAnnotation has an Importance we take it
        if (dataField !== null && dataField !== void 0 && (_dataField$annotation21 = dataField.annotations) !== null && _dataField$annotation21 !== void 0 && (_dataField$annotation22 = _dataField$annotation21.UI) !== null && _dataField$annotation22 !== void 0 && _dataField$annotation22.Importance) {
          return _getDataFieldImportance(dataField);
        }
        // else the highest importance (if any) is returned
        fieldsWithImportance = fieldGroupData && fieldGroupData.filter(function (item) {
          var _item$annotations, _item$annotations$UI;
          return item === null || item === void 0 ? void 0 : (_item$annotations = item.annotations) === null || _item$annotations === void 0 ? void 0 : (_item$annotations$UI = _item$annotations.UI) === null || _item$annotations$UI === void 0 ? void 0 : _item$annotations$UI.Importance;
        });
        return _getMaxImportance(fieldsWithImportance);
      }
      //If the current field is a semanticKey, importance set to High
    }

    return dataField.Value && dataField !== null && dataField !== void 0 && (_Value6 = dataField.Value) !== null && _Value6 !== void 0 && _Value6.path && mapSemanticKeys && mapSemanticKeys.includes(dataField.Value.path) ? Importance.High : _getDataFieldImportance(dataField);
  }

  /**
   * Returns line items from metadata annotations.
   *
   * @param lineItemAnnotation Collection of data fields with their annotations
   * @param visualizationPath The visualization path
   * @param converterContext The converter context
   * @returns The columns from the annotations
   */
  _exports.getImportance = getImportance;
  const getColumnsFromAnnotations = function (lineItemAnnotation, visualizationPath, converterContext) {
    var _tableManifestSetting2;
    const entityType = converterContext.getAnnotationEntityType(lineItemAnnotation),
      annotationColumns = [],
      columnsToBeCreated = {},
      nonSortableColumns = getNonSortablePropertiesRestrictions(converterContext.getEntitySet()),
      tableManifestSettings = converterContext.getManifestControlConfiguration(visualizationPath),
      tableType = (tableManifestSettings === null || tableManifestSettings === void 0 ? void 0 : (_tableManifestSetting2 = tableManifestSettings.tableSettings) === null || _tableManifestSetting2 === void 0 ? void 0 : _tableManifestSetting2.type) || "ResponsiveTable";
    const textOnlyColumnsFromTextAnnotation = [];
    const semanticKeys = converterContext.getAnnotationsByTerm("Common", "com.sap.vocabularies.Common.v1.SemanticKey", [converterContext.getEntityType()])[0];
    if (lineItemAnnotation) {
      const tableConverterContext = converterContext.getConverterContextFor(getTargetObjectPath(converterContext.getDataModelObjectPath()));
      lineItemAnnotation.forEach(lineItem => {
        var _lineItem$Value, _lineItem$Value$$targ, _lineItem$Target, _lineItem$Target$$tar, _lineItem$annotations, _lineItem$annotations2, _lineItem$annotations3, _lineItem$annotations4, _exportSettings;
        if (!_isValidColumn(lineItem)) {
          return;
        }
        let exportSettings = null;
        const semanticObjectAnnotationPath = isDataFieldTypes(lineItem) && (_lineItem$Value = lineItem.Value) !== null && _lineItem$Value !== void 0 && (_lineItem$Value$$targ = _lineItem$Value.$target) !== null && _lineItem$Value$$targ !== void 0 && _lineItem$Value$$targ.fullyQualifiedName ? getSemanticObjectPath(converterContext, lineItem) : undefined;
        const relativePath = _getRelativePath(lineItem);

        // Determine properties which are consumed by this LineItem.
        const relatedPropertiesInfo = collectRelatedPropertiesRecursively(lineItem, converterContext, tableType);
        const relatedPropertyNames = Object.keys(relatedPropertiesInfo.properties);
        const additionalPropertyNames = Object.keys(relatedPropertiesInfo.additionalProperties);
        const groupPath = _sliceAtSlash(relativePath, true, false);
        const isGroup = groupPath != relativePath;
        const sLabel = getLabel(lineItem, isGroup);
        const name = _getAnnotationColumnName(lineItem);
        const isFieldGroupColumn = groupPath.indexOf(`@${"com.sap.vocabularies.UI.v1.FieldGroup"}`) > -1;
        const showDataFieldsLabel = isFieldGroupColumn ? _getShowDataFieldsLabel(name, visualizationPath, converterContext) : false;
        const dataType = getDataFieldDataType(lineItem);
        const sDateInputFormat = dataType === "Edm.Date" ? "YYYY-MM-DD" : undefined;
        const formatOptions = _getDefaultFormatOptionsForTable(getDefaultDraftIndicatorForColumn(name, semanticKeys, isFieldGroupColumn, lineItem));
        let fieldGroupHiddenExpressions;
        if (lineItem.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && ((_lineItem$Target = lineItem.Target) === null || _lineItem$Target === void 0 ? void 0 : (_lineItem$Target$$tar = _lineItem$Target.$target) === null || _lineItem$Target$$tar === void 0 ? void 0 : _lineItem$Target$$tar.$Type) === "com.sap.vocabularies.UI.v1.FieldGroupType") {
          fieldGroupHiddenExpressions = _getFieldGroupHiddenExpressions(lineItem, formatOptions);
        }
        if (_isExportableColumn(lineItem)) {
          //exclude the types listed above for the Export (generates error on Export as PDF)
          exportSettings = {
            template: relatedPropertiesInfo.exportSettingsTemplate,
            wrap: relatedPropertiesInfo.exportSettingsWrapping,
            type: dataType ? _getExportDataType(dataType, relatedPropertyNames.length > 1) : undefined,
            inputFormat: sDateInputFormat,
            delimiter: dataType === "Edm.Int64"
          };
          if (relatedPropertiesInfo.exportUnitName) {
            exportSettings.unitProperty = relatedPropertiesInfo.exportUnitName;
            exportSettings.type = "Currency"; // Force to a currency because there's a unitProperty (otherwise the value isn't properly formatted when exported)
          } else if (relatedPropertiesInfo.exportUnitString) {
            exportSettings.unit = relatedPropertiesInfo.exportUnitString;
          }
          if (relatedPropertiesInfo.exportTimezoneName) {
            exportSettings.timezoneProperty = relatedPropertiesInfo.exportTimezoneName;
          } else if (relatedPropertiesInfo.exportTimezoneString) {
            exportSettings.timezone = relatedPropertiesInfo.exportTimezoneString;
          }
        }
        const propertyTypeConfig = dataType && getTypeConfig(lineItem, dataType);
        const typeConfig = {
          className: dataType,
          formatOptions: {
            ...formatOptions,
            ...(propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : propertyTypeConfig.formatOptions)
          },
          constraints: propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : propertyTypeConfig.constraints
        };
        const visualSettings = {};
        if (!dataType || !typeConfig) {
          // for charts
          visualSettings.widthCalculation = null;
        }
        const isMultiValue = _isColumnMultiValued(lineItem, tableConverterContext);
        const sortable = !isMultiValue && _isColumnSortable(lineItem, relativePath, nonSortableColumns);
        const column = {
          key: KeyHelper.generateKeyFromDataField(lineItem),
          type: ColumnType.Annotation,
          label: sLabel,
          groupLabel: isGroup ? getLabel(lineItem) : undefined,
          group: isGroup ? groupPath : undefined,
          FieldGroupHiddenExpressions: fieldGroupHiddenExpressions,
          annotationPath: converterContext.getEntitySetBasedAnnotationPath(lineItem.fullyQualifiedName),
          semanticObjectPath: semanticObjectAnnotationPath,
          availability: isReferencePropertyStaticallyHidden(lineItem) ? AvailabilityType.Hidden : AvailabilityType.Default,
          name: name,
          showDataFieldsLabel: showDataFieldsLabel,
          relativePath: relativePath,
          sortable: sortable,
          propertyInfos: relatedPropertyNames.length ? relatedPropertyNames : undefined,
          additionalPropertyInfos: additionalPropertyNames.length > 0 ? additionalPropertyNames : undefined,
          exportSettings: exportSettings,
          width: ((_lineItem$annotations = lineItem.annotations) === null || _lineItem$annotations === void 0 ? void 0 : (_lineItem$annotations2 = _lineItem$annotations.HTML5) === null || _lineItem$annotations2 === void 0 ? void 0 : (_lineItem$annotations3 = _lineItem$annotations2.CssDefaults) === null || _lineItem$annotations3 === void 0 ? void 0 : (_lineItem$annotations4 = _lineItem$annotations3.width) === null || _lineItem$annotations4 === void 0 ? void 0 : _lineItem$annotations4.valueOf()) || undefined,
          importance: getImportance(lineItem, semanticKeys),
          isNavigable: true,
          formatOptions: formatOptions,
          caseSensitive: isFilteringCaseSensitive(converterContext),
          typeConfig: typeConfig,
          visualSettings: visualSettings,
          timezoneText: (_exportSettings = exportSettings) === null || _exportSettings === void 0 ? void 0 : _exportSettings.timezone,
          isPartOfLineItem: true
        };
        const sTooltip = _getTooltip(lineItem);
        if (sTooltip) {
          column.tooltip = sTooltip;
        }
        if (relatedPropertiesInfo.textOnlyPropertiesFromTextAnnotation.length > 0) {
          textOnlyColumnsFromTextAnnotation.push(...relatedPropertiesInfo.textOnlyPropertiesFromTextAnnotation);
        }
        if (relatedPropertiesInfo.exportDataPointTargetValue && column.exportSettings) {
          column.exportDataPointTargetValue = relatedPropertiesInfo.exportDataPointTargetValue;
          column.exportSettings.type = "String";
        }
        annotationColumns.push(column);

        // Collect information of related columns to be created.
        relatedPropertyNames.forEach(relatedPropertyName => {
          columnsToBeCreated[relatedPropertyName] = relatedPropertiesInfo.properties[relatedPropertyName];

          // In case of a multi-value, related properties cannot be sorted as we go through a 1-n relation
          if (isMultiValue) {
            nonSortableColumns.push(relatedPropertyName);
          }
        });

        // Create columns for additional properties identified for ALP use case.
        additionalPropertyNames.forEach(additionalPropertyName => {
          // Intentional overwrite as we require only one new PropertyInfo for a related Property.
          columnsToBeCreated[additionalPropertyName] = relatedPropertiesInfo.additionalProperties[additionalPropertyName];
        });
      });
    }

    // Get columns from the Properties of EntityType
    return getColumnsFromEntityType(columnsToBeCreated, entityType, annotationColumns, nonSortableColumns, converterContext, tableType, textOnlyColumnsFromTextAnnotation);
  };

  /**
   * Gets the property names from the manifest and checks against existing properties already added by annotations.
   * If a not yet stored property is found it adds it for sorting and filtering only to the annotationColumns.
   *
   * @param properties
   * @param annotationColumns
   * @param converterContext
   * @param entityType
   * @returns The columns from the annotations
   */
  const _getPropertyNames = function (properties, annotationColumns, converterContext, entityType) {
    let matchedProperties;
    if (properties) {
      matchedProperties = properties.map(function (propertyPath) {
        const annotationColumn = annotationColumns.find(function (annotationColumn) {
          return annotationColumn.relativePath === propertyPath && annotationColumn.propertyInfos === undefined;
        });
        if (annotationColumn) {
          return annotationColumn.name;
        } else {
          const relatedColumns = _createRelatedColumns({
            [propertyPath]: entityType.resolvePath(propertyPath)
          }, annotationColumns, [], converterContext, entityType, []);
          annotationColumns.push(relatedColumns[0]);
          return relatedColumns[0].name;
        }
      });
    }
    return matchedProperties;
  };
  const _appendCustomTemplate = function (properties) {
    return properties.map(property => {
      return `{${properties.indexOf(property)}}`;
    }).join(`${"\n"}`);
  };

  /**
   * Returns table column definitions from manifest.
   *
   * These may be custom columns defined in the manifest, slot columns coming through
   * a building block, or annotation columns to overwrite annotation-based columns.
   *
   * @param columns
   * @param annotationColumns
   * @param converterContext
   * @param entityType
   * @param navigationSettings
   * @returns The columns from the manifest
   */
  const getColumnsFromManifest = function (columns, annotationColumns, converterContext, entityType, navigationSettings) {
    const internalColumns = {};
    function isAnnotationColumn(column, key) {
      return annotationColumns.some(annotationColumn => annotationColumn.key === key);
    }
    function isSlotColumn(manifestColumn) {
      return manifestColumn.type === ColumnType.Slot;
    }
    function isCustomColumn(manifestColumn) {
      return manifestColumn.type === undefined && !!manifestColumn.template;
    }
    function _updateLinkedPropertiesOnCustomColumns(propertyInfos, annotationTableColumns) {
      const nonSortableColumns = getNonSortablePropertiesRestrictions(converterContext.getEntitySet());
      propertyInfos.forEach(property => {
        annotationTableColumns.forEach(prop => {
          if (prop.name === property) {
            prop.sortable = nonSortableColumns.indexOf(property.replace("Property::", "")) === -1;
            prop.isGroupable = prop.sortable;
          }
        });
      });
    }
    for (const key in columns) {
      var _manifestColumn$posit;
      const manifestColumn = columns[key];
      KeyHelper.validateKey(key);

      // BaseTableColumn
      const baseTableColumn = {
        key: key,
        width: manifestColumn.width || undefined,
        position: {
          anchor: (_manifestColumn$posit = manifestColumn.position) === null || _manifestColumn$posit === void 0 ? void 0 : _manifestColumn$posit.anchor,
          placement: manifestColumn.position === undefined ? Placement.After : manifestColumn.position.placement
        },
        caseSensitive: isFilteringCaseSensitive(converterContext)
      };
      if (isAnnotationColumn(manifestColumn, key)) {
        const propertiesToOverwriteAnnotationColumn = {
          ...baseTableColumn,
          importance: manifestColumn === null || manifestColumn === void 0 ? void 0 : manifestColumn.importance,
          horizontalAlign: manifestColumn === null || manifestColumn === void 0 ? void 0 : manifestColumn.horizontalAlign,
          availability: manifestColumn === null || manifestColumn === void 0 ? void 0 : manifestColumn.availability,
          type: ColumnType.Annotation,
          isNavigable: isAnnotationColumn(manifestColumn, key) ? undefined : isActionNavigable(manifestColumn, navigationSettings, true),
          settings: manifestColumn.settings,
          formatOptions: _getDefaultFormatOptionsForTable(manifestColumn.formatOptions)
        };
        internalColumns[key] = propertiesToOverwriteAnnotationColumn;
      } else {
        const propertyInfos = _getPropertyNames(manifestColumn.properties, annotationColumns, converterContext, entityType);
        const baseManifestColumn = {
          ...baseTableColumn,
          header: manifestColumn.header,
          importance: (manifestColumn === null || manifestColumn === void 0 ? void 0 : manifestColumn.importance) || Importance.None,
          horizontalAlign: (manifestColumn === null || manifestColumn === void 0 ? void 0 : manifestColumn.horizontalAlign) || HorizontalAlign.Begin,
          availability: (manifestColumn === null || manifestColumn === void 0 ? void 0 : manifestColumn.availability) || AvailabilityType.Default,
          template: manifestColumn.template,
          propertyInfos: propertyInfos,
          exportSettings: propertyInfos ? {
            template: _appendCustomTemplate(propertyInfos),
            wrap: !!(propertyInfos.length > 1)
          } : null,
          id: `CustomColumn::${key}`,
          name: `CustomColumn::${key}`,
          //Needed for MDC:
          formatOptions: {
            textLinesEdit: 4
          },
          isGroupable: false,
          isNavigable: false,
          sortable: false,
          visualSettings: {
            widthCalculation: null
          },
          properties: manifestColumn.properties
        };
        if (propertyInfos) {
          _updateLinkedPropertiesOnCustomColumns(propertyInfos, annotationColumns);
        }
        if (isSlotColumn(manifestColumn)) {
          const customTableColumn = {
            ...baseManifestColumn,
            type: ColumnType.Slot
          };
          internalColumns[key] = customTableColumn;
        } else if (isCustomColumn(manifestColumn)) {
          const customTableColumn = {
            ...baseManifestColumn,
            type: ColumnType.Default
          };
          internalColumns[key] = customTableColumn;
        } else {
          var _IssueCategoryType$An;
          const message = `The annotation column '${key}' referenced in the manifest is not found`;
          converterContext.getDiagnostics().addIssue(IssueCategory.Manifest, IssueSeverity.Low, message, IssueCategoryType, IssueCategoryType === null || IssueCategoryType === void 0 ? void 0 : (_IssueCategoryType$An = IssueCategoryType.AnnotationColumns) === null || _IssueCategoryType$An === void 0 ? void 0 : _IssueCategoryType$An.InvalidKey);
        }
      }
    }
    return internalColumns;
  };
  function getP13nMode(visualizationPath, converterContext, tableManifestConfiguration) {
    var _tableManifestSetting3;
    const manifestWrapper = converterContext.getManifestWrapper();
    const tableManifestSettings = converterContext.getManifestControlConfiguration(visualizationPath);
    const variantManagement = manifestWrapper.getVariantManagement();
    const aPersonalization = [];
    const isAnalyticalTable = tableManifestConfiguration.type === "AnalyticalTable";
    const isResponsiveTable = tableManifestConfiguration.type === "ResponsiveTable";
    if ((tableManifestSettings === null || tableManifestSettings === void 0 ? void 0 : (_tableManifestSetting3 = tableManifestSettings.tableSettings) === null || _tableManifestSetting3 === void 0 ? void 0 : _tableManifestSetting3.personalization) !== undefined) {
      // Personalization configured in manifest.
      const personalization = tableManifestSettings.tableSettings.personalization;
      if (personalization === true) {
        // Table personalization fully enabled.
        switch (tableManifestConfiguration.type) {
          case "AnalyticalTable":
            return "Sort,Column,Filter,Group,Aggregate";
          case "ResponsiveTable":
            return "Sort,Column,Filter,Group";
          default:
            return "Sort,Column,Filter";
        }
      } else if (typeof personalization === "object") {
        // Specific personalization options enabled in manifest. Use them as is.
        if (personalization.sort) {
          aPersonalization.push("Sort");
        }
        if (personalization.column) {
          aPersonalization.push("Column");
        }
        if (personalization.filter) {
          aPersonalization.push("Filter");
        }
        if (personalization.group && (isAnalyticalTable || isResponsiveTable)) {
          aPersonalization.push("Group");
        }
        if (personalization.aggregate && isAnalyticalTable) {
          aPersonalization.push("Aggregate");
        }
        return aPersonalization.length > 0 ? aPersonalization.join(",") : undefined;
      }
    } else {
      // No personalization configured in manifest.
      aPersonalization.push("Sort");
      aPersonalization.push("Column");
      if (converterContext.getTemplateType() === TemplateType.ListReport) {
        if (variantManagement === VariantManagementType.Control || _isFilterBarHidden(manifestWrapper, converterContext)) {
          // Feature parity with V2.
          // Enable table filtering by default only in case of Control level variant management.
          // Or when the LR filter bar is hidden via manifest setting
          aPersonalization.push("Filter");
        }
      } else {
        aPersonalization.push("Filter");
      }
      if (isAnalyticalTable) {
        aPersonalization.push("Group");
        aPersonalization.push("Aggregate");
      }
      if (isResponsiveTable) {
        aPersonalization.push("Group");
      }
      return aPersonalization.join(",");
    }
    return undefined;
  }

  /**
   * Returns a Boolean value suggesting if a filter bar is being used on the page.
   *
   * Chart has a dependency to filter bar (issue with loading data). Once resolved, the check for chart should be removed here.
   * Until then, hiding filter bar is now allowed if a chart is being used on LR.
   *
   * @param manifestWrapper Manifest settings getter for the page
   * @param converterContext The instance of the converter context
   * @returns Boolean suggesting if a filter bar is being used on the page.
   */
  _exports.getP13nMode = getP13nMode;
  function _isFilterBarHidden(manifestWrapper, converterContext) {
    return manifestWrapper.isFilterBarHidden() && !converterContext.getManifestWrapper().hasMultipleVisualizations() && converterContext.getTemplateType() !== TemplateType.AnalyticalListPage;
  }

  /**
   * Returns a JSON string containing the sort conditions for the presentation variant.
   *
   * @param converterContext The instance of the converter context
   * @param presentationVariantAnnotation Presentation variant annotation
   * @param columns Table columns processed by the converter
   * @returns Sort conditions for a presentation variant.
   */
  function getSortConditions(converterContext, presentationVariantAnnotation, columns) {
    // Currently navigation property is not supported as sorter
    const nonSortableProperties = getNonSortablePropertiesRestrictions(converterContext.getEntitySet());
    let sortConditions;
    if (presentationVariantAnnotation !== null && presentationVariantAnnotation !== void 0 && presentationVariantAnnotation.SortOrder) {
      const sorters = [];
      const conditions = {
        sorters: sorters
      };
      presentationVariantAnnotation.SortOrder.forEach(condition => {
        var _conditionProperty$$t;
        const conditionProperty = condition.Property;
        if (conditionProperty && nonSortableProperties.indexOf((_conditionProperty$$t = conditionProperty.$target) === null || _conditionProperty$$t === void 0 ? void 0 : _conditionProperty$$t.name) === -1) {
          const infoName = convertPropertyPathsToInfoNames([conditionProperty], columns)[0];
          if (infoName) {
            conditions.sorters.push({
              name: infoName,
              descending: !!condition.Descending
            });
          }
        }
      });
      sortConditions = conditions.sorters.length ? JSON.stringify(conditions) : undefined;
    }
    return sortConditions;
  }
  function getInitialExpansionLevel(presentationVariantAnnotation) {
    var _presentationVariantA;
    if (!presentationVariantAnnotation) {
      return undefined;
    }
    const level = (_presentationVariantA = presentationVariantAnnotation.InitialExpansionLevel) === null || _presentationVariantA === void 0 ? void 0 : _presentationVariantA.valueOf();
    return typeof level === "number" ? level : undefined;
  }
  /**
   * Converts an array of propertyPath to an array of propertyInfo names.
   *
   * @param paths the array to be converted
   * @param columns the array of propertyInfos
   * @returns an array of propertyInfo names
   */

  function convertPropertyPathsToInfoNames(paths, columns) {
    const infoNames = [];
    let propertyInfo, annotationColumn;
    paths.forEach(currentPath => {
      if (currentPath !== null && currentPath !== void 0 && currentPath.value) {
        propertyInfo = columns.find(column => {
          annotationColumn = column;
          return !annotationColumn.propertyInfos && annotationColumn.relativePath === (currentPath === null || currentPath === void 0 ? void 0 : currentPath.value);
        });
        if (propertyInfo) {
          infoNames.push(propertyInfo.name);
        }
      }
    });
    return infoNames;
  }

  /**
   * Returns a JSON string containing Presentation Variant group conditions.
   *
   * @param presentationVariantAnnotation Presentation variant annotation
   * @param columns Converter processed table columns
   * @param tableType The table type.
   * @returns Group conditions for a Presentation variant.
   */
  function getGroupConditions(presentationVariantAnnotation, columns, tableType) {
    let groupConditions;
    if (presentationVariantAnnotation !== null && presentationVariantAnnotation !== void 0 && presentationVariantAnnotation.GroupBy) {
      let aGroupBy = presentationVariantAnnotation.GroupBy;
      if (tableType === "ResponsiveTable") {
        aGroupBy = aGroupBy.slice(0, 1);
      }
      const aGroupLevels = convertPropertyPathsToInfoNames(aGroupBy, columns).map(infoName => {
        return {
          name: infoName
        };
      });
      groupConditions = aGroupLevels.length ? JSON.stringify({
        groupLevels: aGroupLevels
      }) : undefined;
    }
    return groupConditions;
  }
  /**
   * Updates the column's propertyInfos of a analytical table integrating all extensions and binding-relevant property info part.
   *
   * @param tableVisualization The visualization to be updated
   */

  function _updatePropertyInfosWithAggregatesDefinitions(tableVisualization) {
    const relatedAdditionalPropertyNameMap = {};
    tableVisualization.columns.forEach(column => {
      var _column$additionalPro2;
      column = column;
      const aggregatablePropertyName = Object.keys(tableVisualization.aggregates).find(aggregate => aggregate === column.name);
      if (aggregatablePropertyName) {
        const aggregatablePropertyDefinition = tableVisualization.aggregates[aggregatablePropertyName];
        column.aggregatable = true;
        column.extension = {
          customAggregate: aggregatablePropertyDefinition.defaultAggregate ?? {}
        };
      }
      if ((_column$additionalPro2 = column.additionalPropertyInfos) !== null && _column$additionalPro2 !== void 0 && _column$additionalPro2.length) {
        column.additionalPropertyInfos.forEach(additionalPropertyInfo => {
          // Create propertyInfo for each additional property.
          // The new property 'name' has been prefixed with 'Property_Technical::' for uniqueness and it has been named technical property as it requires dedicated MDC attributes (technicallyGroupable and technicallyAggregatable).
          createTechnicalProperty(additionalPropertyInfo, tableVisualization.columns, relatedAdditionalPropertyNameMap);
        });
      }
    });
    tableVisualization.columns.forEach(column => {
      column = column;
      if (column.additionalPropertyInfos) {
        var _column$propertyInfos3;
        column.additionalPropertyInfos = column.additionalPropertyInfos.map(propertyInfo => relatedAdditionalPropertyNameMap[propertyInfo] ?? propertyInfo);
        // Add additional properties to the complex property using the hidden annotation.
        column.propertyInfos = (_column$propertyInfos3 = column.propertyInfos) === null || _column$propertyInfos3 === void 0 ? void 0 : _column$propertyInfos3.concat(column.additionalPropertyInfos);
      }
    });
  }

  /**
   * Returns a JSON string containing Presentation Variant aggregate conditions.
   *
   * @param presentationVariantAnnotation Presentation variant annotation
   * @param columns Converter processed table columns
   * @returns Group conditions for a Presentation variant.
   */
  function getAggregateConditions(presentationVariantAnnotation, columns) {
    let aggregateConditions;
    if (presentationVariantAnnotation !== null && presentationVariantAnnotation !== void 0 && presentationVariantAnnotation.Total) {
      const aTotals = presentationVariantAnnotation.Total;
      const aggregates = {};
      convertPropertyPathsToInfoNames(aTotals, columns).forEach(infoName => {
        aggregates[infoName] = {};
      });
      aggregateConditions = JSON.stringify(aggregates);
    }
    return aggregateConditions;
  }
  function getTableAnnotationConfiguration(lineItemAnnotation, visualizationPath, converterContext, tableManifestConfiguration, columns, presentationVariantAnnotation, viewConfiguration) {
    var _converterContext$get16, _converterContext$get17, _converterContext$get18;
    // Need to get the target
    const {
      navigationPropertyPath
    } = splitPath(visualizationPath);
    const title = (_converterContext$get16 = converterContext.getDataModelObjectPath().targetEntityType.annotations) === null || _converterContext$get16 === void 0 ? void 0 : (_converterContext$get17 = _converterContext$get16.UI) === null || _converterContext$get17 === void 0 ? void 0 : (_converterContext$get18 = _converterContext$get17.HeaderInfo) === null || _converterContext$get18 === void 0 ? void 0 : _converterContext$get18.TypeNamePlural;
    const entitySet = converterContext.getDataModelObjectPath().targetEntitySet;
    const pageManifestSettings = converterContext.getManifestWrapper();
    const hasAbsolutePath = navigationPropertyPath.length === 0,
      p13nMode = getP13nMode(visualizationPath, converterContext, tableManifestConfiguration),
      id = navigationPropertyPath ? getTableID(visualizationPath) : getTableID(converterContext.getContextPath(), "LineItem");
    const targetCapabilities = getCapabilityRestriction(converterContext);
    const navigationTargetPath = getNavigationTargetPath(converterContext, navigationPropertyPath);
    const navigationSettings = pageManifestSettings.getNavigationConfiguration(navigationTargetPath);
    const creationBehaviour = _getCreationBehaviour(lineItemAnnotation, tableManifestConfiguration, converterContext, navigationSettings, visualizationPath);
    const standardActionsContext = generateStandardActionsContext(converterContext, creationBehaviour.mode, tableManifestConfiguration, viewConfiguration);
    const deleteButtonVisibilityExpression = getDeleteVisibility(converterContext, standardActionsContext);
    const createButtonVisibilityExpression = getCreateVisibility(converterContext, standardActionsContext);
    const massEditButtonVisibilityExpression = getMassEditVisibility(converterContext, standardActionsContext);
    const isInsertUpdateTemplated = getInsertUpdateActionsTemplating(standardActionsContext, isDraftOrStickySupported(converterContext), compileExpression(createButtonVisibilityExpression) === "false");
    const selectionMode = getSelectionMode(lineItemAnnotation, visualizationPath, converterContext, hasAbsolutePath, targetCapabilities, deleteButtonVisibilityExpression, massEditButtonVisibilityExpression);
    let threshold = navigationPropertyPath ? 10 : 30;
    if (presentationVariantAnnotation !== null && presentationVariantAnnotation !== void 0 && presentationVariantAnnotation.MaxItems) {
      threshold = presentationVariantAnnotation.MaxItems.valueOf();
    }
    const variantManagement = pageManifestSettings.getVariantManagement();
    const isSearchable = isPathSearchable(converterContext.getDataModelObjectPath());
    const standardActions = {
      create: getStandardActionCreate(converterContext, standardActionsContext),
      delete: getStandardActionDelete(converterContext, standardActionsContext),
      paste: getStandardActionPaste(converterContext, standardActionsContext, isInsertUpdateTemplated),
      massEdit: getStandardActionMassEdit(converterContext, standardActionsContext),
      creationRow: getCreationRow(converterContext, standardActionsContext)
    };
    return {
      id: id,
      entityName: entitySet ? entitySet.name : "",
      collection: getTargetObjectPath(converterContext.getDataModelObjectPath()),
      navigationPath: navigationPropertyPath,
      row: _getRowConfigurationProperty(lineItemAnnotation, converterContext, navigationSettings, navigationTargetPath, tableManifestConfiguration.type),
      p13nMode: p13nMode,
      standardActions: {
        actions: standardActions,
        isInsertUpdateTemplated: isInsertUpdateTemplated,
        updatablePropertyPath: getCurrentEntitySetUpdatablePath(converterContext)
      },
      displayMode: isInDisplayMode(converterContext, viewConfiguration),
      create: creationBehaviour,
      selectionMode: selectionMode,
      autoBindOnInit: _isFilterBarHidden(pageManifestSettings, converterContext) || converterContext.getTemplateType() !== TemplateType.ListReport && converterContext.getTemplateType() !== TemplateType.AnalyticalListPage && !(viewConfiguration && pageManifestSettings.hasMultipleVisualizations(viewConfiguration)),
      variantManagement: variantManagement === "Control" && !p13nMode ? VariantManagementType.None : variantManagement,
      threshold: threshold,
      sortConditions: getSortConditions(converterContext, presentationVariantAnnotation, columns),
      title: title,
      searchable: tableManifestConfiguration.type !== "AnalyticalTable" && !(isConstant(isSearchable) && isSearchable.value === false),
      initialExpansionLevel: getInitialExpansionLevel(presentationVariantAnnotation)
    };
  }
  _exports.getTableAnnotationConfiguration = getTableAnnotationConfiguration;
  function _getExportDataType(dataType) {
    let isComplexProperty = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let exportDataType = "String";
    if (isComplexProperty) {
      if (dataType === "Edm.DateTimeOffset") {
        exportDataType = "DateTime";
      }
      return exportDataType;
    } else {
      switch (dataType) {
        case "Edm.Decimal":
        case "Edm.Int32":
        case "Edm.Int64":
        case "Edm.Double":
        case "Edm.Byte":
          exportDataType = "Number";
          break;
        case "Edm.DateOfTime":
        case "Edm.Date":
          exportDataType = "Date";
          break;
        case "Edm.DateTimeOffset":
          exportDataType = "DateTime";
          break;
        case "Edm.TimeOfDay":
          exportDataType = "Time";
          break;
        case "Edm.Boolean":
          exportDataType = "Boolean";
          break;
        default:
          exportDataType = "String";
      }
    }
    return exportDataType;
  }

  /**
   * Split the visualization path into the navigation property path and annotation.
   *
   * @param visualizationPath
   * @returns The split path
   */
  function splitPath(visualizationPath) {
    let [navigationPropertyPath, annotationPath] = visualizationPath.split("@");
    if (navigationPropertyPath.lastIndexOf("/") === navigationPropertyPath.length - 1) {
      // Drop trailing slash
      navigationPropertyPath = navigationPropertyPath.substr(0, navigationPropertyPath.length - 1);
    }
    return {
      navigationPropertyPath,
      annotationPath
    };
  }
  _exports.splitPath = splitPath;
  function getSelectionVariantConfiguration(selectionVariantPath, converterContext) {
    const resolvedTarget = converterContext.getEntityTypeAnnotation(selectionVariantPath);
    const selection = resolvedTarget.annotation;
    if (selection) {
      var _selection$SelectOpti, _selection$Text;
      const propertyNames = [];
      (_selection$SelectOpti = selection.SelectOptions) === null || _selection$SelectOpti === void 0 ? void 0 : _selection$SelectOpti.forEach(selectOption => {
        const propertyName = selectOption.PropertyName;
        const propertyPath = propertyName.value;
        if (propertyNames.indexOf(propertyPath) === -1) {
          propertyNames.push(propertyPath);
        }
      });
      return {
        text: selection === null || selection === void 0 ? void 0 : (_selection$Text = selection.Text) === null || _selection$Text === void 0 ? void 0 : _selection$Text.toString(),
        propertyNames: propertyNames
      };
    }
    return undefined;
  }
  _exports.getSelectionVariantConfiguration = getSelectionVariantConfiguration;
  function _getFullScreenBasedOnDevice(tableSettings, converterContext, isIphone) {
    // If enableFullScreen is not set, use as default true on phone and false otherwise
    let enableFullScreen = tableSettings.enableFullScreen ?? isIphone;
    // Make sure that enableFullScreen is not set on ListReport for desktop or tablet
    if (!isIphone && enableFullScreen && converterContext.getTemplateType() === TemplateType.ListReport) {
      enableFullScreen = false;
      converterContext.getDiagnostics().addIssue(IssueCategory.Manifest, IssueSeverity.Low, IssueType.FULLSCREENMODE_NOT_ON_LISTREPORT);
    }
    return enableFullScreen;
  }
  function _getMultiSelectMode(tableSettings, tableType, converterContext) {
    let multiSelectMode;
    if (tableType !== "ResponsiveTable") {
      return undefined;
    }
    switch (converterContext.getTemplateType()) {
      case TemplateType.ListReport:
      case TemplateType.AnalyticalListPage:
        multiSelectMode = !tableSettings.selectAll ? "ClearAll" : "Default";
        break;
      case TemplateType.ObjectPage:
        multiSelectMode = tableSettings.selectAll === false ? "ClearAll" : "Default";
        if (converterContext.getManifestWrapper().useIconTabBar()) {
          multiSelectMode = !tableSettings.selectAll ? "ClearAll" : "Default";
        }
        break;
      default:
    }
    return multiSelectMode;
  }
  function _getTableType(tableSettings, aggregationHelper, converterContext) {
    let tableType = (tableSettings === null || tableSettings === void 0 ? void 0 : tableSettings.type) || "ResponsiveTable";
    /*  Now, we keep the configuration in the manifest, even if it leads to errors.
    	We only change if we're not on desktop from Analytical/Tree to Responsive.
     */
    if ((tableType === "AnalyticalTable" || tableType === "TreeTable") && !converterContext.getManifestWrapper().isDesktop()) {
      tableType = "ResponsiveTable";
    }
    return tableType;
  }
  function _getGridTableMode(tableType, tableSettings, isTemplateListReport) {
    if (tableType === "GridTable") {
      if (isTemplateListReport) {
        return {
          rowCountMode: "Auto",
          rowCount: "3"
        };
      } else {
        return {
          rowCountMode: tableSettings.rowCountMode ? tableSettings.rowCountMode : "Fixed",
          rowCount: tableSettings.rowCount ? tableSettings.rowCount : 5
        };
      }
    } else {
      return {};
    }
  }
  function _getCondensedTableLayout(_tableType, _tableSettings) {
    return _tableSettings.condensedTableLayout !== undefined && _tableType !== "ResponsiveTable" ? _tableSettings.condensedTableLayout : false;
  }
  function _getTableSelectionLimit(_tableSettings) {
    return _tableSettings.selectAll === true || _tableSettings.selectionLimit === 0 ? 0 : _tableSettings.selectionLimit || 200;
  }
  function _getTableInlineCreationRowCount(_tableSettings) {
    var _tableSettings$creati, _tableSettings$creati2;
    return (_tableSettings$creati = _tableSettings.creationMode) !== null && _tableSettings$creati !== void 0 && _tableSettings$creati.inlineCreationRowCount ? (_tableSettings$creati2 = _tableSettings.creationMode) === null || _tableSettings$creati2 === void 0 ? void 0 : _tableSettings$creati2.inlineCreationRowCount : 2;
  }
  function _getFilters(tableSettings, quickFilterPaths, quickSelectionVariant, path, converterContext) {
    var _tableSettings$quickV;
    if (quickSelectionVariant) {
      quickFilterPaths.push({
        annotationPath: path.annotationPath
      });
    }
    return {
      quickFilters: {
        enabled: converterContext.getTemplateType() !== TemplateType.ListReport,
        showCounts: tableSettings === null || tableSettings === void 0 ? void 0 : (_tableSettings$quickV = tableSettings.quickVariantSelection) === null || _tableSettings$quickV === void 0 ? void 0 : _tableSettings$quickV.showCounts,
        paths: quickFilterPaths
      }
    };
  }
  function _getEnableExport(tableSettings, converterContext, enablePaste) {
    return tableSettings.enableExport !== undefined ? tableSettings.enableExport : converterContext.getTemplateType() !== "ObjectPage" || enablePaste;
  }
  function _getFilterConfiguration(tableSettings, lineItemAnnotation, converterContext) {
    var _tableSettings$quickV2, _tableSettings$quickV3, _tableSettings$quickV4;
    if (!lineItemAnnotation) {
      return {};
    }
    const quickFilterPaths = [];
    const targetEntityType = converterContext.getAnnotationEntityType(lineItemAnnotation);
    let quickSelectionVariant;
    let filters;
    tableSettings === null || tableSettings === void 0 ? void 0 : (_tableSettings$quickV2 = tableSettings.quickVariantSelection) === null || _tableSettings$quickV2 === void 0 ? void 0 : (_tableSettings$quickV3 = _tableSettings$quickV2.paths) === null || _tableSettings$quickV3 === void 0 ? void 0 : _tableSettings$quickV3.forEach(path => {
      quickSelectionVariant = targetEntityType.resolvePath(path.annotationPath);
      filters = _getFilters(tableSettings, quickFilterPaths, quickSelectionVariant, path, converterContext);
    });
    let hideTableTitle = false;
    hideTableTitle = !!((_tableSettings$quickV4 = tableSettings.quickVariantSelection) !== null && _tableSettings$quickV4 !== void 0 && _tableSettings$quickV4.hideTableTitle);
    return {
      filters: filters,
      headerVisible: !(quickSelectionVariant && hideTableTitle)
    };
  }
  function _getCollectedNavigationPropertyLabels(relativePath, converterContext) {
    const navigationProperties = enhanceDataModelPath(converterContext.getDataModelObjectPath(), relativePath).navigationProperties;
    if ((navigationProperties === null || navigationProperties === void 0 ? void 0 : navigationProperties.length) > 0) {
      const collectedNavigationPropertyLabels = [];
      navigationProperties.forEach(navProperty => {
        collectedNavigationPropertyLabels.push(getLabel(navProperty) || navProperty.name);
      });
      return collectedNavigationPropertyLabels;
    }
  }
  function getTableManifestConfiguration(lineItemAnnotation, visualizationPath, converterContext) {
    var _tableSettings$creati3, _tableSettings$creati4, _tableSettings$creati5, _tableSettings$creati6, _tableSettings$creati7, _tableSettings$creati8, _tableSettings$quickV5, _manifestWrapper$getV;
    let checkCondensedLayout = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    const _manifestWrapper = converterContext.getManifestWrapper();
    const tableManifestSettings = converterContext.getManifestControlConfiguration(visualizationPath);
    const tableSettings = tableManifestSettings && tableManifestSettings.tableSettings || {};
    const creationMode = ((_tableSettings$creati3 = tableSettings.creationMode) === null || _tableSettings$creati3 === void 0 ? void 0 : _tableSettings$creati3.name) || CreationMode.NewPage;
    const enableAutoColumnWidth = !_manifestWrapper.isPhone();
    const enablePaste = tableSettings.enablePaste !== undefined ? tableSettings.enablePaste : converterContext.getTemplateType() === "ObjectPage"; // Paste is disabled by default excepted for OP
    const templateType = converterContext.getTemplateType();
    const dataStateIndicatorFilter = templateType === TemplateType.ListReport ? "API.dataStateIndicatorFilter" : undefined;
    const isCondensedTableLayoutCompliant = checkCondensedLayout && _manifestWrapper.isCondensedLayoutCompliant();
    const oFilterConfiguration = _getFilterConfiguration(tableSettings, lineItemAnnotation, converterContext);
    const customValidationFunction = (_tableSettings$creati4 = tableSettings.creationMode) === null || _tableSettings$creati4 === void 0 ? void 0 : _tableSettings$creati4.customValidationFunction;
    const entityType = converterContext.getEntityType();
    const aggregationHelper = new AggregationHelper(entityType, converterContext);
    const tableType = _getTableType(tableSettings, aggregationHelper, converterContext);
    const gridTableRowMode = _getGridTableMode(tableType, tableSettings, templateType === TemplateType.ListReport);
    const condensedTableLayout = _getCondensedTableLayout(tableType, tableSettings);
    const oConfiguration = {
      // If no createAtEnd is specified it will be false for Inline create and true otherwise
      createAtEnd: ((_tableSettings$creati5 = tableSettings.creationMode) === null || _tableSettings$creati5 === void 0 ? void 0 : _tableSettings$creati5.createAtEnd) !== undefined ? (_tableSettings$creati6 = tableSettings.creationMode) === null || _tableSettings$creati6 === void 0 ? void 0 : _tableSettings$creati6.createAtEnd : creationMode !== CreationMode.Inline,
      creationMode: creationMode,
      customValidationFunction: customValidationFunction,
      dataStateIndicatorFilter: dataStateIndicatorFilter,
      // if a custom validation function is provided, disableAddRowButtonForEmptyData should not be considered, i.e. set to false
      disableAddRowButtonForEmptyData: !customValidationFunction ? !!((_tableSettings$creati7 = tableSettings.creationMode) !== null && _tableSettings$creati7 !== void 0 && _tableSettings$creati7.disableAddRowButtonForEmptyData) : false,
      enableAutoColumnWidth: enableAutoColumnWidth,
      enableExport: _getEnableExport(tableSettings, converterContext, enablePaste),
      enableFullScreen: _getFullScreenBasedOnDevice(tableSettings, converterContext, _manifestWrapper.isPhone()),
      enableMassEdit: tableSettings === null || tableSettings === void 0 ? void 0 : tableSettings.enableMassEdit,
      enablePaste: enablePaste,
      headerVisible: true,
      multiSelectMode: _getMultiSelectMode(tableSettings, tableType, converterContext),
      selectionLimit: _getTableSelectionLimit(tableSettings),
      inlineCreationRowCount: _getTableInlineCreationRowCount(tableSettings),
      inlineCreationRowsHiddenInEditMode: (tableSettings === null || tableSettings === void 0 ? void 0 : (_tableSettings$creati8 = tableSettings.creationMode) === null || _tableSettings$creati8 === void 0 ? void 0 : _tableSettings$creati8.inlineCreationRowsHiddenInEditMode) ?? false,
      showRowCount: !(tableSettings !== null && tableSettings !== void 0 && (_tableSettings$quickV5 = tableSettings.quickVariantSelection) !== null && _tableSettings$quickV5 !== void 0 && _tableSettings$quickV5.showCounts) && !((_manifestWrapper$getV = _manifestWrapper.getViewConfiguration()) !== null && _manifestWrapper$getV !== void 0 && _manifestWrapper$getV.showCounts),
      type: tableType,
      useCondensedTableLayout: condensedTableLayout && isCondensedTableLayoutCompliant,
      isCompactType: _manifestWrapper.isCompactType()
    };
    const tableConfiguration = {
      ...oConfiguration,
      ...gridTableRowMode,
      ...oFilterConfiguration
    };
    if (tableType === "TreeTable") {
      tableConfiguration.hierarchyQualifier = tableSettings.hierarchyQualifier;
    }
    return tableConfiguration;
  }
  _exports.getTableManifestConfiguration = getTableManifestConfiguration;
  function getTypeConfig(oProperty, dataType) {
    var _targetType, _oTargetMapping, _propertyTypeConfig$t, _propertyTypeConfig$t2, _propertyTypeConfig$t3, _propertyTypeConfig$t4;
    let oTargetMapping = EDM_TYPE_MAPPING[oProperty === null || oProperty === void 0 ? void 0 : oProperty.type] || (dataType ? EDM_TYPE_MAPPING[dataType] : undefined);
    if (!oTargetMapping && oProperty !== null && oProperty !== void 0 && oProperty.targetType && ((_targetType = oProperty.targetType) === null || _targetType === void 0 ? void 0 : _targetType._type) === "TypeDefinition") {
      oTargetMapping = EDM_TYPE_MAPPING[oProperty.targetType.underlyingType];
    }
    const propertyTypeConfig = {
      type: (_oTargetMapping = oTargetMapping) === null || _oTargetMapping === void 0 ? void 0 : _oTargetMapping.type,
      constraints: {},
      formatOptions: {}
    };
    if (isProperty(oProperty)) {
      var _oTargetMapping$const, _oTargetMapping$const2, _oTargetMapping$const3, _oTargetMapping$const4, _oTargetMapping$const5, _oProperty$annotation8, _oProperty$annotation9, _oProperty$annotation10, _oProperty$annotation11, _oTargetMapping$const6, _oProperty$annotation12, _oProperty$annotation13, _oProperty$annotation14, _oProperty$annotation15, _oTargetMapping$const7, _oProperty$annotation16, _oProperty$annotation17;
      propertyTypeConfig.constraints = {
        scale: (_oTargetMapping$const = oTargetMapping.constraints) !== null && _oTargetMapping$const !== void 0 && _oTargetMapping$const.$Scale ? oProperty.scale : undefined,
        precision: (_oTargetMapping$const2 = oTargetMapping.constraints) !== null && _oTargetMapping$const2 !== void 0 && _oTargetMapping$const2.$Precision ? oProperty.precision : undefined,
        maxLength: (_oTargetMapping$const3 = oTargetMapping.constraints) !== null && _oTargetMapping$const3 !== void 0 && _oTargetMapping$const3.$MaxLength ? oProperty.maxLength : undefined,
        nullable: (_oTargetMapping$const4 = oTargetMapping.constraints) !== null && _oTargetMapping$const4 !== void 0 && _oTargetMapping$const4.$Nullable ? oProperty.nullable : undefined,
        minimum: (_oTargetMapping$const5 = oTargetMapping.constraints) !== null && _oTargetMapping$const5 !== void 0 && _oTargetMapping$const5["@Org.OData.Validation.V1.Minimum/$Decimal"] && !isNaN((_oProperty$annotation8 = oProperty.annotations) === null || _oProperty$annotation8 === void 0 ? void 0 : (_oProperty$annotation9 = _oProperty$annotation8.Validation) === null || _oProperty$annotation9 === void 0 ? void 0 : _oProperty$annotation9.Minimum) ? `${(_oProperty$annotation10 = oProperty.annotations) === null || _oProperty$annotation10 === void 0 ? void 0 : (_oProperty$annotation11 = _oProperty$annotation10.Validation) === null || _oProperty$annotation11 === void 0 ? void 0 : _oProperty$annotation11.Minimum}` : undefined,
        maximum: (_oTargetMapping$const6 = oTargetMapping.constraints) !== null && _oTargetMapping$const6 !== void 0 && _oTargetMapping$const6["@Org.OData.Validation.V1.Maximum/$Decimal"] && !isNaN((_oProperty$annotation12 = oProperty.annotations) === null || _oProperty$annotation12 === void 0 ? void 0 : (_oProperty$annotation13 = _oProperty$annotation12.Validation) === null || _oProperty$annotation13 === void 0 ? void 0 : _oProperty$annotation13.Maximum) ? `${(_oProperty$annotation14 = oProperty.annotations) === null || _oProperty$annotation14 === void 0 ? void 0 : (_oProperty$annotation15 = _oProperty$annotation14.Validation) === null || _oProperty$annotation15 === void 0 ? void 0 : _oProperty$annotation15.Maximum}` : undefined,
        isDigitSequence: propertyTypeConfig.type === "sap.ui.model.odata.type.String" && (_oTargetMapping$const7 = oTargetMapping.constraints) !== null && _oTargetMapping$const7 !== void 0 && _oTargetMapping$const7[`@${"com.sap.vocabularies.Common.v1.IsDigitSequence"}`] && (_oProperty$annotation16 = oProperty.annotations) !== null && _oProperty$annotation16 !== void 0 && (_oProperty$annotation17 = _oProperty$annotation16.Common) !== null && _oProperty$annotation17 !== void 0 && _oProperty$annotation17.IsDigitSequence ? true : undefined
      };
    }
    propertyTypeConfig.formatOptions = {
      parseAsString: (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t = propertyTypeConfig.type) === null || _propertyTypeConfig$t === void 0 ? void 0 : _propertyTypeConfig$t.indexOf("sap.ui.model.odata.type.Int")) === 0 || (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t2 = propertyTypeConfig.type) === null || _propertyTypeConfig$t2 === void 0 ? void 0 : _propertyTypeConfig$t2.indexOf("sap.ui.model.odata.type.Double")) === 0 ? false : undefined,
      emptyString: (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t3 = propertyTypeConfig.type) === null || _propertyTypeConfig$t3 === void 0 ? void 0 : _propertyTypeConfig$t3.indexOf("sap.ui.model.odata.type.Int")) === 0 || (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t4 = propertyTypeConfig.type) === null || _propertyTypeConfig$t4 === void 0 ? void 0 : _propertyTypeConfig$t4.indexOf("sap.ui.model.odata.type.Double")) === 0 ? "" : undefined,
      parseKeepsEmptyString: propertyTypeConfig.type === "sap.ui.model.odata.type.String" ? true : undefined
    };
    return propertyTypeConfig;
  }
  _exports.getTypeConfig = getTypeConfig;
  return {
    getTableActions,
    getTableColumns,
    getColumnsFromEntityType,
    updateLinkedProperties,
    createTableVisualization,
    createDefaultTableVisualization,
    getCapabilityRestriction,
    getSelectionMode,
    getRowStatusVisibility,
    getImportance,
    getP13nMode,
    getTableAnnotationConfiguration,
    isFilteringCaseSensitive,
    splitPath,
    getSelectionVariantConfiguration,
    getTableManifestConfiguration,
    getTypeConfig,
    updateTableVisualizationForType
  };
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/Table", ["sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/helpers/Key","sap/fe/core/formatters/TableFormatter","sap/fe/core/formatters/TableFormatterTypes","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/EntitySetHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/internal/helpers/ActionHelper","sap/ui/core/Core","../../helpers/Aggregation","../../helpers/DataFieldHelper","../../helpers/ID","../../ManifestSettings","./Criticality","./table/StandardActions"],function(e,t,n,i,o,a,l,r,s,d,u,v,c,p,f,g,m,y,b,h,T,I,P,D){"use strict";var F={};var A=D.isInDisplayMode;var C=D.isDraftOrStickySupported;var S=D.getStandardActionPaste;var E=D.getStandardActionMassEdit;var O=D.getStandardActionDelete;var x=D.getStandardActionCreate;var M=D.getRestrictions;var U=D.getMassEditVisibility;var $=D.getInsertUpdateActionsTemplating;var N=D.getDeleteVisibility;var w=D.getCreationRow;var V=D.getCreateVisibility;var k=D.generateStandardActionsContext;var R=P.getMessageTypeFromCriticalityType;var L=I.VisualizationType;var j=I.VariantManagementType;var H=I.TemplateType;var B=I.SelectionMode;var z=I.Importance;var K=I.HorizontalAlign;var G=I.CreationMode;var W=I.AvailabilityType;var q=I.ActionType;var Q=T.getTableID;var _=h.isReferencePropertyStaticallyHidden;var Y=b.AggregationHelper;var J=g.isMultiValueField;var X=f.isProperty;var Z=f.isPathExpression;var ee=f.isNavigationProperty;var te=f.getAssociatedUnitProperty;var ne=f.getAssociatedTimezoneProperty;var ie=f.getAssociatedCurrencyProperty;var oe=p.getNonSortablePropertiesRestrictions;var ae=c.getDisplayMode;var le=v.isPathUpdatable;var re=v.isPathSearchable;var se=v.isPathDeletable;var de=v.getTargetObjectPath;var ue=v.enhanceDataModelPath;var ve=u.replaceSpecialChars;var ce=u.generate;var pe=s.resolveBindingString;var fe=s.pathInModel;var ge=s.or;var me=s.not;var ye=s.isConstant;var be=s.ifElse;var he=s.getExpressionFromAnnotation;var Te=s.formatResult;var Ie=s.equal;var Pe=s.EDM_TYPE_MAPPING;var De=s.constant;var Fe=s.compileExpression;var Ae=s.and;var Ce=r.MessageType;var Se=a.KeyHelper;var Ee=o.IssueType;var Oe=o.IssueSeverity;var xe=o.IssueCategoryType;var Me=o.IssueCategory;var Ue=i.Placement;var $e=i.OverrideType;var Ne=i.insertCustomElements;var we=n.UI;var Ve=n.Entity;var ke=t.removeDuplicateActions;var Re=t.isActionNavigable;var Le=t.getCopyAction;var je=t.getActionsFromManifest;var He=t.dataFieldIsCopyAction;var Be=e.isDataPointFromDataFieldDefault;var ze=e.isDataFieldTypes;var Ke=e.isDataFieldForActionAbstract;var Ge=e.getTargetValueOnDataPoint;var We=e.getSemanticObjectPath;var qe=e.getDataFieldDataType;var Qe=e.collectRelatedPropertiesRecursively;var _e=e.collectRelatedProperties;var Ye;(function(e){e["Default"]="Default";e["Annotation"]="Annotation";e["Slot"]="Slot"})(Ye||(Ye={}));function Je(e,t,n,i){const o=yt(e,t,n);const a=o.tableActions;const l=o.hiddenTableActions;const r=je(n.getManifestControlConfiguration(t).actions,n,a,i,true,l);const s={isNavigable:$e.overwrite,enableOnSelect:$e.overwrite,enableAutoScroll:$e.overwrite,enabled:$e.overwrite,visible:$e.overwrite,defaultValuesExtensionFunction:$e.overwrite,command:$e.overwrite};const d=Ne(a,r.actions,s);return{actions:d,commandActions:r.commandActions}}F.getTableActions=Je;function Xe(e,t,n,i){const o=_t(e,t,n);const a=Xt(n.getManifestControlConfiguration(t).columns,o,n,n.getAnnotationEntityType(e),i);return Ne(o,a,{width:$e.overwrite,importance:$e.overwrite,horizontalAlign:$e.overwrite,availability:$e.overwrite,isNavigable:$e.overwrite,settings:$e.overwrite,formatOptions:$e.overwrite})}F.getTableColumns=Xe;const Ze=function(e,t,n){const i=new Y(e,n);function o(e){return t.find(t=>{const n=t;return n.propertyInfos===undefined&&n.relativePath===e})}if(!i.isAnalyticsSupported()){return undefined}const a=new Set;t.forEach(e=>{const t=e;if(t.unit){a.add(t.unit)}});const l=i.getCustomAggregateDefinitions();const r={};l.forEach(e=>{const t=i._entityType.entityProperties.find(t=>t.name===e.qualifier);if(t){var n,o;const i=(n=e.annotations)===null||n===void 0?void 0:(o=n.Aggregation)===null||o===void 0?void 0:o.ContextDefiningProperties;r[t.name]=i?i.map(e=>e.value):[]}});const s={};t.forEach(e=>{const t=e;if(t.propertyInfos===undefined&&t.relativePath){const e=r[t.relativePath];if(e&&!a.has(t.name)){s[t.name]={defaultAggregate:{},relativePath:t.relativePath};const n=[];e.forEach(e=>{const t=o(e);if(t){n.push(t.name)}});if(n.length){s[t.name].defaultAggregate.contextDefiningProperties=n}}}});return s};F.getAggregateDefinitionsFromEntityType=Ze;function et(e,t,n,i){if(e.control.type==="AnalyticalTable"){const o=Ze(t,e.columns,n),a=new Y(t,n);if(o){e.enableAnalytics=true;e.enable$select=false;e.enable$$getKeepAliveContext=false;e.aggregates=o;ln(e);const t=a.getAllowedTransformations();e.enableAnalyticsSearch=t?t.indexOf("search")>=0:true;e.annotation.groupConditions=an(i,e.columns,e.control.type);e.annotation.aggregateConditions=rn(i,e.columns)}e.control.type="GridTable"}else if(e.control.type==="ResponsiveTable"){e.annotation.groupConditions=an(i,e.columns,e.control.type)}else if(e.control.type==="TreeTable"){e.enable$$getKeepAliveContext=false}}F.updateTableVisualizationForType=et;function tt(e,t){const n=e.getManifestWrapper();if(t&&n.getNavigationConfiguration(t)){const e=n.getNavigationConfiguration(t);if(Object.keys(e).length>0){return t}}const i=e.getDataModelObjectPath();const o=e.getContextPath();const a=n.getNavigationConfiguration(o);if(a&&Object.keys(a).length>0){return o}return i.targetEntitySet?i.targetEntitySet.name:i.startingEntitySet.name}function nt(e,t){function n(e){return t.find(t=>{const n=t;return n.propertyInfos===undefined&&n.relativePath===e})}t.forEach(t=>{const i=t;if(i.propertyInfos===undefined&&i.relativePath){const t=e.entityProperties.find(e=>e.name===i.relativePath);if(t){var o,a,l;const e=ie(t)||te(t);const v=ne(t);const c=t===null||t===void 0?void 0:(o=t.annotations)===null||o===void 0?void 0:(a=o.Common)===null||a===void 0?void 0:a.Timezone;if(e){const t=n(e.name);i.unit=t===null||t===void 0?void 0:t.name}else{var r,s,d,u;const e=(t===null||t===void 0?void 0:(r=t.annotations)===null||r===void 0?void 0:(s=r.Measures)===null||s===void 0?void 0:s.ISOCurrency)||(t===null||t===void 0?void 0:(d=t.annotations)===null||d===void 0?void 0:(u=d.Measures)===null||u===void 0?void 0:u.Unit);if(e){i.unitText=`${e}`}}if(v){const e=n(v.name);i.timezone=e===null||e===void 0?void 0:e.name}else if(c){i.timezoneText=c.toString()}const p=ae(t),f=(l=t.annotations.Common)===null||l===void 0?void 0:l.Text;if(Z(f)&&p!=="Value"){const e=n(f.path);if(e&&e.name!==i.name){i.textArrangement={textProperty:e.name,mode:p}}}}}})}F.updateLinkedProperties=nt;function it(e){var t,n,i,o,a,l,r,s,d,u,v,c,p;const f=(t=e.getAnnotationEntityType())===null||t===void 0?void 0:(n=t.annotations)===null||n===void 0?void 0:(i=n.UI)===null||i===void 0?void 0:(o=i.HeaderInfo)===null||o===void 0?void 0:(a=o.Title)===null||a===void 0?void 0:(l=a.Value)===null||l===void 0?void 0:l.path;const g=(r=e.getAnnotationEntityType())===null||r===void 0?void 0:(s=r.annotations)===null||s===void 0?void 0:(d=s.Common)===null||d===void 0?void 0:d.SemanticKey;const m=e===null||e===void 0?void 0:(u=e.getAnnotationEntityType())===null||u===void 0?void 0:(v=u.annotations)===null||v===void 0?void 0:(c=v.UI)===null||c===void 0?void 0:(p=c.HeaderInfo)===null||p===void 0?void 0:p.TypeName;const y=[];if(g){g.forEach(function(e){y.push(e.value)})}return{headerInfoTitlePath:f,semanticKeyColumns:y,headerInfoTypeName:m}}function ot(e,t,n,i,o,a){const l=Dn(e,t,n,o);const{navigationPropertyPath:r}=un(t);const s=tt(n,r);const d=n.getManifestWrapper().getNavigationConfiguration(s);const u=Xe(e,t,n,d);const v=lt(e,n);const c=it(n);const p=Je(e,t,n,d);const f={type:L.Table,annotation:sn(e,t,n,l,u,i,a),control:l,actions:ke(p.actions),commandActions:p.commandActions,columns:u,operationAvailableMap:JSON.stringify(v),operationAvailableProperties:st(v,n),headerInfoTitle:c.headerInfoTitlePath,semanticKeys:c.semanticKeyColumns,headerInfoTypeName:c.headerInfoTypeName,enable$select:true,enable$$getKeepAliveContext:true};nt(n.getAnnotationEntityType(e),u);et(f,n.getAnnotationEntityType(e),n,i);return f}F.createTableVisualization=ot;function at(e,t){const n=Dn(undefined,"",e,false);const i=It({},e.getEntityType(),[],[],e,n.type,[]);const o=lt(undefined,e);const a=it(e);const l={type:L.Table,annotation:sn(undefined,"",e,n,t?[]:i),control:n,actions:[],columns:i,operationAvailableMap:JSON.stringify(o),operationAvailableProperties:st(o,e),headerInfoTitle:a.headerInfoTitlePath,semanticKeys:a.semanticKeyColumns,headerInfoTypeName:a.headerInfoTypeName,enable$select:true,enable$$getKeepAliveContext:true};nt(e.getEntityType(),i);et(l,e.getEntityType(),e);return l}F.createDefaultTableVisualization=at;function lt(e,t){return m.getOperationAvailableMap(e,"table",t)}function rt(e){var t,n,i;const o=M(e);const a=e.getEntitySet();const l=o.isUpdatable;const r=!ye(l.expression)&&l.navigationExpression._type==="Unresolvable";const s=a===null||a===void 0?void 0:(t=a.annotations.Capabilities)===null||t===void 0?void 0:(n=t.UpdateRestrictions)===null||n===void 0?void 0:(i=n.Updatable)===null||i===void 0?void 0:i.path;return r?s:""}function st(e,t){const n=new Set;for(const t in e){const i=e[t];if(i===null){n.add(t)}else if(typeof i==="string"){n.add(i)}}if(n.size){var i,o,a,l,r;const e=t.getEntityType();const s=(i=e.annotations)===null||i===void 0?void 0:(o=i.UI)===null||o===void 0?void 0:(a=o.HeaderInfo)===null||a===void 0?void 0:(l=a.Title)===null||l===void 0?void 0:(r=l.Value)===null||r===void 0?void 0:r.path;if(s){n.add(s)}}return Array.from(n).join(",")}function dt(e,t,n,i){const o=[];e.forEach(e=>{var a,l;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e!==null&&e!==void 0&&(a=e.ActionTarget)!==null&&a!==void 0&&a.isBound&&t===(e===null||e===void 0?void 0:e.ActionTarget.sourceEntityType)||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&e.RequiresContext&&(e===null||e===void 0?void 0:(l=e.Inline)===null||l===void 0?void 0:l.valueOf())!==true){var r,s,d;if(typeof((r=e.annotations)===null||r===void 0?void 0:(s=r.UI)===null||s===void 0?void 0:(d=s.Hidden)===null||d===void 0?void 0:d.valueOf())==="object"){o.push(Ie(ut(e,n,i),false))}}});return o}function ut(e,t,n){var i;let o;if((e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForAction"||(e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){var a,l;o=e===null||e===void 0?void 0:(a=e.annotations)===null||a===void 0?void 0:(l=a.UI)===null||l===void 0?void 0:l.Hidden}else{o=e===null||e===void 0?void 0:e.visible}let r;if((i=o)!==null&&i!==void 0&&i.path){r=o.path}else{r=o}if(r){if(e!==null&&e!==void 0&&e.visible){r=r.substring(1,r.length-1)}if(r.indexOf("/")>0){var s;const e=r.split("/");const n=e[0];if((t===null||t===void 0?void 0:(s=t.targetObject)===null||s===void 0?void 0:s._type)==="NavigationProperty"&&t.targetObject.partner===n){return fe(e.slice(1).join("/"))}else{return De(true)}}else if(n){return fe(r)}else{return De(true)}}return De(true)}function vt(e,t,n){return Object.keys(n).some(i=>{if(i===e){var o;if(t!==null&&t!==void 0&&(o=t.ActionTarget)!==null&&o!==void 0&&o.isBound||t!==null&&t!==void 0&&t.RequiresContext){n[e].requiresSelection=true}return true}return false})}function ct(e,t,n){return e.some(e=>{var i,o,a,l,r,s,d;if((e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&(e===null||e===void 0?void 0:(i=e.Inline)===null||i===void 0?void 0:i.valueOf())!==true&&(((o=e.annotations)===null||o===void 0?void 0:(a=o.UI)===null||a===void 0?void 0:(l=a.Hidden)===null||l===void 0?void 0:l.valueOf())===false||((r=e.annotations)===null||r===void 0?void 0:(s=r.UI)===null||s===void 0?void 0:(d=s.Hidden)===null||d===void 0?void 0:d.valueOf())===undefined)){if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"){var u;const i=ce(["DataFieldForAction",e.Action]);if(vt(i,e,t)){return false}return(e===null||e===void 0?void 0:(u=e.ActionTarget)===null||u===void 0?void 0:u.isBound)&&n===(e===null||e===void 0?void 0:e.ActionTarget.sourceEntityType)}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(vt(`DataFieldForIntentBasedNavigation::${e.SemanticObject}::${e.Action}`,e,t)){return false}return e.RequiresContext}}return false})}function pt(e){return Object.keys(e).some(t=>{var n;const i=e[t];if(i.requiresSelection&&((n=i.visible)===null||n===void 0?void 0:n.toString())==="true"){return true}return false})}function ft(e){const t=[];if(e){Object.keys(e).forEach(n=>{const i=e[n];if(i.requiresSelection===true&&i.visible!==undefined){if(typeof i.visible==="string"){var o;t.push(pe(i===null||i===void 0?void 0:(o=i.visible)===null||o===void 0?void 0:o.valueOf()))}}})}return t}function gt(e){const t=se(e.getDataModelObjectPath());const n=le(e.getDataModelObjectPath());return{isDeletable:!(ye(t)&&t.value===false),isUpdatable:!(ye(n)&&n.value===false)}}F.getCapabilityRestriction=gt;function mt(e,t,n,i,o,a){var l;let r=arguments.length>6&&arguments[6]!==undefined?arguments[6]:De(false);if(!e){return B.None}const s=n.getManifestControlConfiguration(t);let d=(l=s.tableSettings)===null||l===void 0?void 0:l.selectionMode;let u=[],v=[];const c=je(n.getManifestControlConfiguration(t).actions,n,[],undefined,false);let p,f;if(n.getTemplateType()===H.ObjectPage){p=se(n.getDataModelObjectPath());f=p?Fe(p,true):p}const g=!ye(r)||r.value!==false;if(d&&d===B.None&&a){if(n.getTemplateType()===H.ObjectPage&&g){return Fe(be(Ae(we.IsEditable,r),De("Multi"),be(a,De("Multi"),De("None"))))}else if(g){return B.Multi}return Fe(be(a,De("Multi"),De("None")))}if(!d||d===B.Auto){d=B.Multi}if(g){d=d===B.Single?B.Single:B.Multi}if(ct(e,c.actions,n.getEntityType())||pt(c.actions)){return d}u=dt(e,n.getEntityType(),n.getDataModelObjectPath(),i);v=ft(c.actions);if(u.length===0&&v.length===0&&(a||g)){if(!i){if(o.isDeletable||f!=="false"||g){const e=ge(a||true,r);return Fe(be(Ae(we.IsEditable,e),De(d),De(B.None)))}else{return B.None}}else if(g){return d}else if(o.isDeletable&&a){return Fe(be(a,De(d),De("None")))}else{return B.None}}else if(!i){if(o.isDeletable||f!=="false"||g){const e=be(g&&!o.isDeletable,r,De(true));return Fe(be(Ae(we.IsEditable,e),De(d),be(ge(...u.concat(v)),De(d),De(B.None))))}else{return Fe(be(ge(...u.concat(v)),De(d),De(B.None)))}}else if(o.isDeletable||g){return d}else{return Fe(be(ge(...u.concat(v),r),De(d),De(B.None)))}}F.getSelectionMode=mt;function yt(e,t,n){const i=[];const o=[];const a=Le(e.filter(e=>He(e)));if(a){var l,r,s;i.push({type:q.Copy,annotationPath:n.getEntitySetBasedAnnotationPath(a.fullyQualifiedName),key:Se.generateKeyFromDataField(a),enabled:Fe(Ie(fe("numberOfSelectedContexts","internal"),1)),visible:Fe(me(Ie(he((l=a.annotations)===null||l===void 0?void 0:(r=l.UI)===null||r===void 0?void 0:r.Hidden,[],undefined,n.getRelativeModelPathFunction()),true))),text:((s=a.Label)===null||s===void 0?void 0:s.toString())??y.getLibraryResourceBundle("sap.fe.core").getText("C_COMMON_COPY"),isNavigable:true})}e.filter(e=>!He(e)).forEach(e=>{var t,a,l,r,s,d,u,v,c;if(((t=e.annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(l=a.Hidden)===null||l===void 0?void 0:l.valueOf())===true){o.push({type:q.Default,key:Se.generateKeyFromDataField(e)})}else if(Ke(e)&&((r=e.Inline)===null||r===void 0?void 0:r.valueOf())!==true&&((s=e.Determining)===null||s===void 0?void 0:s.valueOf())!==true){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":i.push({type:q.DataFieldForAction,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:Se.generateKeyFromDataField(e),visible:Fe(me(Ie(he((d=e.annotations)===null||d===void 0?void 0:(u=d.UI)===null||u===void 0?void 0:u.Hidden,[],undefined,n.getRelativeModelPathFunction()),true))),isNavigable:true});break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":i.push({type:q.DataFieldForIntentBasedNavigation,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:Se.generateKeyFromDataField(e),visible:Fe(me(Ie(he((v=e.annotations)===null||v===void 0?void 0:(c=v.UI)===null||c===void 0?void 0:c.Hidden,[],undefined,n.getRelativeModelPathFunction()),true)))});break;default:break}}});return{tableActions:i,hiddenTableActions:o}}function bt(e,t,n){let i=Ce.None;if(e){if(typeof e==="object"){i=he(e)}else{i=R(e)}}const o=[];n===null||n===void 0?void 0:n.keys.forEach(e=>{if(e.name!=="IsActiveEntity"){o.push(fe(e.name,undefined))}});return Te([i,fe(`filteredMessages`,"internal"),t&&Ve.HasActive,t&&Ve.IsActive,`${t}`,...o],l.rowHighlighting,n)}function ht(e,t,n,i,o){var a;const l=(i===null||i===void 0?void 0:i.create)||(i===null||i===void 0?void 0:i.detail);const r=n.getManifestControlConfiguration(o);const s=r&&r.tableSettings||{};if(l!==null&&l!==void 0&&l.outbound&&l.outboundDetail&&i!==null&&i!==void 0&&i.create){return{mode:"External",outbound:l.outbound,outboundDetail:l.outboundDetail,navigationSettings:i}}let d;if(e){var u,v,c;const e=(u=n.getEntitySet())===null||u===void 0?void 0:u.annotations;const i=e===null||e===void 0?void 0:e.Common,o=e===null||e===void 0?void 0:e.Session;d=(i===null||i===void 0?void 0:(v=i.DraftRoot)===null||v===void 0?void 0:v.NewAction)||(o===null||o===void 0?void 0:(c=o.StickySessionSupported)===null||c===void 0?void 0:c.NewAction);if(t.creationMode===G.CreationRow&&d){throw Error(`Creation mode '${G.CreationRow}' can not be used with a custom 'new' action (${d})`)}if(l!==null&&l!==void 0&&l.route){var p;return{mode:t.creationMode,append:t.createAtEnd,newAction:(p=d)===null||p===void 0?void 0:p.toString(),navigateToTarget:t.creationMode===G.NewPage?l.route:undefined}}}if(t.creationMode===G.NewPage){var f;t.creationMode=G.Inline;if(((f=s.creationMode)===null||f===void 0?void 0:f.createAtEnd)===undefined){t.createAtEnd=false}}return{mode:t.creationMode,append:t.createAtEnd,newAction:(a=d)===null||a===void 0?void 0:a.toString()}}const Tt=function(e,t,n,i,o){let a,r;let s=De(Ce.None);const u=t.getEntityType();if(n&&e){var v,c;r=((v=n.display)===null||v===void 0?void 0:v.target)||((c=n.detail)===null||c===void 0?void 0:c.outbound);if(r){a=".handlers.onChevronPressNavigateOutBound( $controller ,'"+r+"', ${$parameters>bindingContext})"}else if(u){var p;const l=t.getEntitySet();r=(p=n.detail)===null||p===void 0?void 0:p.route;if(r&&!d.isSingleton(l)){var f,g;s=bt((f=e.annotations)===null||f===void 0?void 0:(g=f.UI)===null||g===void 0?void 0:g.Criticality,!!d.getDraftRoot(l)||!!d.getDraftNode(l),u);a="API.onTableRowPress($event, $controller, ${$parameters>bindingContext}, { callExtension: true, targetPath: '"+i+"', editable : "+(d.getDraftRoot(l)||d.getDraftNode(l)?"!${$parameters>bindingContext}.getProperty('IsActiveEntity')":"undefined")+(o==="AnalyticalTable"||o==="TreeTable"?", bRecreateContext: true":"")+"})"}else{var m,y;s=bt((m=e.annotations)===null||m===void 0?void 0:(y=m.UI)===null||y===void 0?void 0:y.Criticality,false,u)}}}const b=Te([fe("/deepestPath","internal")],l.navigatedRow,u);return{press:a,action:a?"Navigation":undefined,rowHighlighting:Fe(s),rowNavigated:Fe(b),visible:Fe(me(we.IsInactive))}};const It=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];let i=arguments.length>3?arguments[3]:undefined;let o=arguments.length>4?arguments[4]:undefined;let a=arguments.length>5?arguments[5]:undefined;let l=arguments.length>6?arguments[6]:undefined;const r=n;const s=new Y(t,o);t.entityProperties.forEach(t=>{const d=n.some(e=>e.name===t.name);if(!t.targetType&&!d){const n=_e(t.name,t,o,true,a);const d=Object.keys(n.properties);const u=Object.keys(n.additionalProperties);if(n.textOnlyPropertiesFromTextAnnotation.length>0){l.push(...n.textOnlyPropertiesFromTextAnnotation)}const v=Pt(t,o.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),t.name,true,true,i,s,o,l);const c=o.getAnnotationsByTerm("Common","com.sap.vocabularies.Common.v1.SemanticKey",[o.getEntityType()])[0];const p=Kt(v.name,c,false,null);if(Object.keys(p).length>0){v.formatOptions={...p}}if(d.length>0){v.propertyInfos=d;v.exportSettings={...v.exportSettings,template:n.exportSettingsTemplate,wrap:n.exportSettingsWrapping};v.exportSettings.type=dn(t.type,d.length>1);if(n.exportUnitName){v.exportSettings.unitProperty=n.exportUnitName;v.exportSettings.type="Currency"}else if(n.exportUnitString){v.exportSettings.unit=n.exportUnitString}if(n.exportTimezoneName){v.exportSettings.timezoneProperty=n.exportTimezoneName;v.exportSettings.utc=false}else if(n.exportTimezoneString){v.exportSettings.timezone=n.exportTimezoneString}if(n.exportDataPointTargetValue){v.exportDataPointTargetValue=n.exportDataPointTargetValue;v.exportSettings.type="String"}d.forEach(t=>{e[t]=n.properties[t]})}if(u.length>0){v.additionalPropertyInfos=u;u.forEach(t=>{e[t]=n.additionalProperties[t]})}r.push(v)}if(ae(t)==="Description"){i=i.concat(t.name);r.push(Pt(t,o.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),t.name,false,false,i,s,o,[]))}});const d=xt(e,r,i,o,t,l);return r.concat(d)};F.getColumnsFromEntityType=It;const Pt=function(e,t,n,i,o,a,l,r,s){var d,u,v,c,p;const f=i?n:`Property::${n}`;const g=(i?"DataField::":"Property::")+ve(n);const m=We(r,e);const y=((d=e.annotations)===null||d===void 0?void 0:(u=d.UI)===null||u===void 0?void 0:(v=u.Hidden)===null||v===void 0?void 0:v.valueOf())===true;const b=e.name?wt(e.name,true,false):undefined;const h=b!=e.name;const T=dn(e.type);const I=e.type==="Edm.Date"?"YYYY-MM-DD":undefined;const P=qe(e);const D=Fn(e,P);const F=r.getAnnotationsByTerm("Common","com.sap.vocabularies.Common.v1.SemanticKey",[r.getEntityType()])[0];const A=s&&s.indexOf(n)>=0;const C=(!y||A)&&a.indexOf(n)===-1;const S={className:e.type||P,formatOptions:D.formatOptions,constraints:D.constraints};let E=null;if(Dt(e)){var O,x,M,U,$,N;const t=ie(e)||te(e);const n=ne(e);const i=((O=e.annotations)===null||O===void 0?void 0:(x=O.Measures)===null||x===void 0?void 0:x.ISOCurrency)||((M=e.annotations)===null||M===void 0?void 0:(U=M.Measures)===null||U===void 0?void 0:U.Unit);const o=($=e.annotations)===null||$===void 0?void 0:(N=$.Common)===null||N===void 0?void 0:N.Timezone;E={type:T,inputFormat:I,scale:e.scale,delimiter:e.type==="Edm.Int64"};if(t){E.unitProperty=t.name;E.type="Currency"}else if(i){E.unit=`${i}`}if(n){E.timezoneProperty=n.name;E.utc=false}else if(o){E.timezone=o.toString()}}const w=Pn(n,r);const V={key:g,type:Ye.Annotation,label:St(e,h),groupLabel:h?St(e):undefined,group:h?b:undefined,annotationPath:t,semanticObjectPath:m,availability:!o||y?W.Hidden:W.Adaptation,name:f,relativePath:n,sortable:C,isGroupable:l.isAnalyticsSupported()?!!l.isPropertyGroupable(e):C,isKey:e.isKey,exportSettings:E,caseSensitive:Rt(r),typeConfig:S,importance:Qt((c=e.annotations)===null||c===void 0?void 0:(p=c.UI)===null||p===void 0?void 0:p.DataFieldDefault,F),additionalLabels:w};const k=Et(e);if(k){V.tooltip=k}const R=Ge(e);if(Be(e)&&typeof R==="string"&&V.exportSettings){V.exportDataPointTargetValue=R;V.exportSettings.template="{0}/"+R}return V};function Dt(e){var t;let n,i;const o=(t=e.annotations.UI)===null||t===void 0?void 0:t.DataFieldDefault;if(X(e)&&o!==null&&o!==void 0&&o.$Type){if(_(o)===true){return false}n=o===null||o===void 0?void 0:o.$Type}else if(_(e)===true){return false}else{var a,l,r,s,d,u,v,c,p,f,g;i=e;n=i.$Type;if(n==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&(a=i.Target)!==null&&a!==void 0&&(l=a.$target)!==null&&l!==void 0&&l.$Type){var m,y;n=(m=i.Target)===null||m===void 0?void 0:(y=m.$target)===null||y===void 0?void 0:y.$Type;return"com.sap.vocabularies.UI.v1.ChartDefinitionType".indexOf(n)===-1}else if(((r=i.Value)===null||r===void 0?void 0:(s=r.$target)===null||s===void 0?void 0:(d=s.annotations)===null||d===void 0?void 0:(u=d.Core)===null||u===void 0?void 0:(v=u.MediaType)===null||v===void 0?void 0:v.term)==="Org.OData.Core.V1.MediaType"&&((c=i.Value)===null||c===void 0?void 0:(p=c.$target)===null||p===void 0?void 0:(f=p.annotations)===null||f===void 0?void 0:(g=f.Core)===null||g===void 0?void 0:g.isURL)!==true){return false}}return n?["com.sap.vocabularies.UI.v1.DataFieldForAction","com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation","com.sap.vocabularies.UI.v1.DataFieldForActionGroup"].indexOf(n)===-1:true}const Ft=function(e){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":return!!e.Inline;case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":return true;default:}};const At=function(e,t){var n,i,o,a,l,r;const s=e.targetObject;let d;if(s){switch(s.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataPointType":d=s.Value.$target;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if((s===null||s===void 0?void 0:(n=s.Target)===null||n===void 0?void 0:(i=n.$target)===null||i===void 0?void 0:i.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){var u;d=(u=s.Target.$target)===null||u===void 0?void 0:u.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForAction":default:d=undefined}}const v=t!==null&&t!==void 0&&t.isAnalytics?we.IsExpanded:De(false);const c=t!==null&&t!==void 0&&t.isAnalytics?Ie(we.NodeLevel,0):De(false);return Ae(...[me(Ie(he(s===null||s===void 0?void 0:(o=s.annotations)===null||o===void 0?void 0:(a=o.UI)===null||a===void 0?void 0:a.Hidden),true)),be(!!d,d&&me(Ie(he((l=d.annotations)===null||l===void 0?void 0:(r=l.UI)===null||r===void 0?void 0:r.Hidden),true)),true),ge(me(v),c)])};F._getVisibleExpression=At;const Ct=function(e,t){var n,i;const o=[];if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&((n=e.Target)===null||n===void 0?void 0:(i=n.$target)===null||i===void 0?void 0:i.$Type)==="com.sap.vocabularies.UI.v1.FieldGroupType"){var a,l;if(e!==null&&e!==void 0&&(a=e.annotations)!==null&&a!==void 0&&(l=a.UI)!==null&&l!==void 0&&l.Hidden){return Fe(me(Ie(he(e.annotations.UI.Hidden),true)))}else{var r;(r=e.Target.$target.Data)===null||r===void 0?void 0:r.forEach(e=>{o.push(At({targetObject:e},t))});return Fe(be(ge(...o),De(true),De(false)))}}else{return undefined}};const St=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!e){return undefined}if(X(e)||ee(e)){var n,i,o,a,l;const t=(n=e.annotations)===null||n===void 0?void 0:(i=n.UI)===null||i===void 0?void 0:i.DataFieldDefault;if(t&&!t.qualifier&&(o=t.Label)!==null&&o!==void 0&&o.valueOf()){var r;return Fe(he((r=t.Label)===null||r===void 0?void 0:r.valueOf()))}return Fe(he(((a=e.annotations.Common)===null||a===void 0?void 0:(l=a.Label)===null||l===void 0?void 0:l.valueOf())||e.name))}else if(ze(e)){var s,d,u,v,c,p,f,g;if(!!t&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"){var m;return Fe(he((m=e.Label)===null||m===void 0?void 0:m.valueOf()))}return Fe(he(((s=e.Label)===null||s===void 0?void 0:s.valueOf())||((d=e.Value)===null||d===void 0?void 0:(u=d.$target)===null||u===void 0?void 0:(v=u.annotations)===null||v===void 0?void 0:(c=v.Common)===null||c===void 0?void 0:(p=c.Label)===null||p===void 0?void 0:p.valueOf())||((f=e.Value)===null||f===void 0?void 0:(g=f.$target)===null||g===void 0?void 0:g.name)))}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var y,b,h,T,I,P,D,F;return Fe(he(((y=e.Label)===null||y===void 0?void 0:y.valueOf())||((b=e.Target)===null||b===void 0?void 0:(h=b.$target)===null||h===void 0?void 0:(T=h.Value)===null||T===void 0?void 0:(I=T.$target)===null||I===void 0?void 0:(P=I.annotations)===null||P===void 0?void 0:(D=P.Common)===null||D===void 0?void 0:(F=D.Label)===null||F===void 0?void 0:F.valueOf())))}else{var A;return Fe(he((A=e.Label)===null||A===void 0?void 0:A.valueOf()))}};const Et=function(e){var t,n;if(!e){return undefined}if(X(e)||(t=e.annotations)!==null&&t!==void 0&&(n=t.Common)!==null&&n!==void 0&&n.QuickInfo){var i,o;return(i=e.annotations)!==null&&i!==void 0&&(o=i.Common)!==null&&o!==void 0&&o.QuickInfo?Fe(he(e.annotations.Common.QuickInfo.valueOf())):undefined}else if(ze(e)){var a,l,r,s;return(a=e.Value)!==null&&a!==void 0&&(l=a.$target)!==null&&l!==void 0&&(r=l.annotations)!==null&&r!==void 0&&(s=r.Common)!==null&&s!==void 0&&s.QuickInfo?Fe(he(e.Value.$target.annotations.Common.QuickInfo.valueOf())):undefined}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var d,u,v,c,p;const t=(d=e.Target)===null||d===void 0?void 0:d.$target;return t!==null&&t!==void 0&&(u=t.Value)!==null&&u!==void 0&&(v=u.$target)!==null&&v!==void 0&&(c=v.annotations)!==null&&c!==void 0&&(p=c.Common)!==null&&p!==void 0&&p.QuickInfo?Fe(he(t.Value.$target.annotations.Common.QuickInfo.valueOf())):undefined}else{return undefined}};function Ot(e,t){return Te([fe(`semanticKeyHasDraftIndicator`,"internal"),fe(`filteredMessages`,"internal"),e,t],l.getErrorStatusTextVisibilityFormatter)}F.getRowStatusVisibility=Ot;const xt=function(e,t,n,i,o,a){const l=[];const r={};const s=new Y(o,i);Object.keys(e).forEach(o=>{const d=e[o],u=i.getAbsoluteAnnotationPath(o),v=t.find(e=>e.name===o);if(v===undefined){l.push(Pt(d,u,o,true,false,n,s,i,a))}else if(v.annotationPath!==u||v.propertyInfos){const e=`Property::${o}`;if(!t.some(t=>t.name===e)){const t=Pt(d,u,o,false,false,n,s,i,a);t.isPartOfLineItem=v.isPartOfLineItem;l.push(t);r[o]=e}else if(t.some(t=>t.name===e)&&t.some(e=>{var t;return(t=e.propertyInfos)===null||t===void 0?void 0:t.includes(o)})){r[o]=e}}});t.forEach(e=>{var t,n;e.propertyInfos=(t=e.propertyInfos)===null||t===void 0?void 0:t.map(e=>r[e]??e);e.additionalPropertyInfos=(n=e.additionalPropertyInfos)===null||n===void 0?void 0:n.map(e=>r[e]??e)});return l};const Mt=function(e){var t,n,i;if(ze(e)){var o;return(o=e.Value)===null||o===void 0?void 0:o.path}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&(t=e.Target)!==null&&t!==void 0&&(n=t.$target)!==null&&n!==void 0&&(i=n.Value)!==null&&i!==void 0&&i.path){var a,l;return(a=e.Target)===null||a===void 0?void 0:(l=a.$target)===null||l===void 0?void 0:l.Value.path}else{return Se.generateKeyFromDataField(e)}};const Ut=function(e,t,n){const i=`Property_Technical::${e}`;const o=t.find(e=>e.key===i);const a=!o&&t.find(t=>t.name===e&&!t.propertyInfos);if(a){const o={key:i,type:Ye.Annotation,label:a.label,annotationPath:a.annotationPath,availability:W.Hidden,name:i,relativePath:a.relativePath,sortable:false,isGroupable:false,isKey:false,exportSettings:null,caseSensitive:false,aggregatable:false,extension:{technicallyGroupable:true,technicallyAggregatable:true}};t.push(o);n[e]=o.name}};const $t=function(e,t,n){var i;const o=(i=n.getManifestControlConfiguration(t))===null||i===void 0?void 0:i.columns;const a=o&&Object.keys(o);return a&&!!a.find(function(t){return t===e&&o[t].showDataFieldsLabel})};const Nt=function(e){var t,n;let i="";switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":i=e===null||e===void 0?void 0:(t=e.Value)===null||t===void 0?void 0:t.path;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":i=e===null||e===void 0?void 0:(n=e.Target)===null||n===void 0?void 0:n.value;break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForActionGroup":case"com.sap.vocabularies.UI.v1.DataFieldWithActionGroup":i=Se.generateKeyFromDataField(e);break}return i};const wt=function(e,t,n){const i=t?e.lastIndexOf("/"):e.indexOf("/");if(i===-1){return e}return n?e.substring(i+1,e.length):e.substring(0,i)};const Vt=function(e,t){if(ze(e)&&Z(e.Value)){const n=ue(t.getDataModelObjectPath(),e.Value.path);return J(n)}else{return false}};const kt=function(e,t,n){return n.indexOf(t)===-1&&(e.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")};const Rt=function(e){const t=Lt(e);return Array.isArray(t)?t.indexOf("tolower")===-1:true};F.isFilteringCaseSensitive=Rt;function Lt(e){var t,n,i,o,a;if(d.isSingleton(e.getEntitySet())){return undefined}const l=(t=e.getEntitySet())===null||t===void 0?void 0:(n=t.annotations)===null||n===void 0?void 0:n.Capabilities;return(l===null||l===void 0?void 0:l.FilterFunctions)||((i=e.getEntityContainer())===null||i===void 0?void 0:(o=i.annotations)===null||o===void 0?void 0:(a=o.Capabilities)===null||a===void 0?void 0:a.FilterFunctions)}function jt(e){return e===undefined?undefined:{textLinesEdit:4,...e}}function Ht(e,t){const n=[];let i=false;for(let o=0;o<e.length;o++){n.push(e[o].value);if(e[o].value===t){i=true}}return{values:n,semanticKeyFound:i}}function Bt(e,t){let n=false;let i;if(e&&e.length>=1&&t&&t.length>=1){for(let o=0;o<e.length;o++){if([e[o]].some(e=>t.indexOf(e)>=0)){n=true;i=e[o];break}}}return{semanticKeyHasPropertyInFieldGroup:n,fieldGroupPropertyPath:i}}function zt(e,t){var n,i;const o=[];let a={semanticKeyHasPropertyInFieldGroup:false,fieldGroupPropertyPath:undefined};if(e&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&((n=e.Target)===null||n===void 0?void 0:(i=n.$target)===null||i===void 0?void 0:i.$Type)==="com.sap.vocabularies.UI.v1.FieldGroupType"){var l;(l=e.Target.$target.Data)===null||l===void 0?void 0:l.forEach(e=>{if((e.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&e.Value){o.push(e.Value.path)}a=Bt(t,o)})}return{semanticKeyHasPropertyInFieldGroup:a.semanticKeyHasPropertyInFieldGroup,propertyPath:a.fieldGroupPropertyPath}}function Kt(e,t,n,i){if(!t){return{}}const o=Ht(t,e);const a=zt(i,o.values);if(o.semanticKeyFound){const t={hasDraftIndicator:true,semantickeys:o.values,objectStatusTextVisibility:Fe(Ot(e,false))};if(n&&a.semanticKeyHasPropertyInFieldGroup){t["objectStatusTextVisibility"]=Fe(Ot(e,true));t["fieldGroupDraftIndicatorPropertyPath"]=a.propertyPath}return t}else if(!a.semanticKeyHasPropertyInFieldGroup){return{}}else{return{fieldGroupDraftIndicatorPropertyPath:a.propertyPath,fieldGroupName:e,objectStatusTextVisibility:Fe(Ot(e,true))}}}function Gt(e){var t,n;const i=e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Importance;if(i&&i.includes("UI.ImportanceType/High")){return 3}if(i&&i.includes("UI.ImportanceType/Medium")){return 2}if(i&&i.includes("UI.ImportanceType/Low")){return 1}return 0}function Wt(e){var t,n;const i=e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Importance;return i?i.split("/")[1]:z.None}function qt(e){if(e&&e.length>0){let t=-1;let n=-1;let i;for(const o of e){n=Gt(o);if(n>t){t=n;i=o}}return Wt(i)}return z.None}function Qt(e,t){var n;let i,o;if(t&&t.length>0){o=t.map(function(e){return e.value})}if(!e){return undefined}if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){const t=e.Target["$target"]["Data"],n=t&&t.some(function(e){var t,n;return(e===null||e===void 0?void 0:(t=e.Value)===null||t===void 0?void 0:t.path)&&e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&o&&o.includes(e===null||e===void 0?void 0:(n=e.Value)===null||n===void 0?void 0:n.path)});if(n){return z.High}else{var a,l;if(e!==null&&e!==void 0&&(a=e.annotations)!==null&&a!==void 0&&(l=a.UI)!==null&&l!==void 0&&l.Importance){return Wt(e)}i=t&&t.filter(function(e){var t,n;return e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.Importance});return qt(i)}}return e.Value&&e!==null&&e!==void 0&&(n=e.Value)!==null&&n!==void 0&&n.path&&o&&o.includes(e.Value.path)?z.High:Wt(e)}F.getImportance=Qt;const _t=function(e,t,n){var i;const o=n.getAnnotationEntityType(e),a=[],l={},r=oe(n.getEntitySet()),s=n.getManifestControlConfiguration(t),d=(s===null||s===void 0?void 0:(i=s.tableSettings)===null||i===void 0?void 0:i.type)||"ResponsiveTable";const u=[];const v=n.getAnnotationsByTerm("Common","com.sap.vocabularies.Common.v1.SemanticKey",[n.getEntityType()])[0];if(e){const i=n.getConverterContextFor(de(n.getDataModelObjectPath()));e.forEach(e=>{var o,s,c,p,f,g,m,y,b;if(!Ft(e)){return}let h=null;const T=ze(e)&&(o=e.Value)!==null&&o!==void 0&&(s=o.$target)!==null&&s!==void 0&&s.fullyQualifiedName?We(n,e):undefined;const I=Nt(e);const P=Qe(e,n,d);const D=Object.keys(P.properties);const F=Object.keys(P.additionalProperties);const A=wt(I,true,false);const C=A!=I;const S=St(e,C);const E=Mt(e);const O=A.indexOf(`@${"com.sap.vocabularies.UI.v1.FieldGroup"}`)>-1;const x=O?$t(E,t,n):false;const M=qe(e);const U=M==="Edm.Date"?"YYYY-MM-DD":undefined;const $=jt(Kt(E,v,O,e));let N;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&((c=e.Target)===null||c===void 0?void 0:(p=c.$target)===null||p===void 0?void 0:p.$Type)==="com.sap.vocabularies.UI.v1.FieldGroupType"){N=Ct(e,$)}if(Dt(e)){h={template:P.exportSettingsTemplate,wrap:P.exportSettingsWrapping,type:M?dn(M,D.length>1):undefined,inputFormat:U,delimiter:M==="Edm.Int64"};if(P.exportUnitName){h.unitProperty=P.exportUnitName;h.type="Currency"}else if(P.exportUnitString){h.unit=P.exportUnitString}if(P.exportTimezoneName){h.timezoneProperty=P.exportTimezoneName}else if(P.exportTimezoneString){h.timezone=P.exportTimezoneString}}const w=M&&Fn(e,M);const V={className:M,formatOptions:{...$,...w===null||w===void 0?void 0:w.formatOptions},constraints:w===null||w===void 0?void 0:w.constraints};const k={};if(!M||!V){k.widthCalculation=null}const R=Vt(e,i);const L=!R&&kt(e,I,r);const j={key:Se.generateKeyFromDataField(e),type:Ye.Annotation,label:S,groupLabel:C?St(e):undefined,group:C?A:undefined,FieldGroupHiddenExpressions:N,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),semanticObjectPath:T,availability:_(e)?W.Hidden:W.Default,name:E,showDataFieldsLabel:x,relativePath:I,sortable:L,propertyInfos:D.length?D:undefined,additionalPropertyInfos:F.length>0?F:undefined,exportSettings:h,width:((f=e.annotations)===null||f===void 0?void 0:(g=f.HTML5)===null||g===void 0?void 0:(m=g.CssDefaults)===null||m===void 0?void 0:(y=m.width)===null||y===void 0?void 0:y.valueOf())||undefined,importance:Qt(e,v),isNavigable:true,formatOptions:$,caseSensitive:Rt(n),typeConfig:V,visualSettings:k,timezoneText:(b=h)===null||b===void 0?void 0:b.timezone,isPartOfLineItem:true};const H=Et(e);if(H){j.tooltip=H}if(P.textOnlyPropertiesFromTextAnnotation.length>0){u.push(...P.textOnlyPropertiesFromTextAnnotation)}if(P.exportDataPointTargetValue&&j.exportSettings){j.exportDataPointTargetValue=P.exportDataPointTargetValue;j.exportSettings.type="String"}a.push(j);D.forEach(e=>{l[e]=P.properties[e];if(R){r.push(e)}});F.forEach(e=>{l[e]=P.additionalProperties[e]})})}return It(l,o,a,r,n,d,u)};const Yt=function(e,t,n,i){let o;if(e){o=e.map(function(e){const o=t.find(function(t){return t.relativePath===e&&t.propertyInfos===undefined});if(o){return o.name}else{const o=xt({[e]:i.resolvePath(e)},t,[],n,i,[]);t.push(o[0]);return o[0].name}})}return o};const Jt=function(e){return e.map(t=>`{${e.indexOf(t)}}`).join(`${"\n"}`)};const Xt=function(e,t,n,i,o){const a={};function l(e,n){return t.some(e=>e.key===n)}function r(e){return e.type===Ye.Slot}function s(e){return e.type===undefined&&!!e.template}function d(e,t){const i=oe(n.getEntitySet());e.forEach(e=>{t.forEach(t=>{if(t.name===e){t.sortable=i.indexOf(e.replace("Property::",""))===-1;t.isGroupable=t.sortable}})})}for(const c in e){var u;const p=e[c];Se.validateKey(c);const f={key:c,width:p.width||undefined,position:{anchor:(u=p.position)===null||u===void 0?void 0:u.anchor,placement:p.position===undefined?Ue.After:p.position.placement},caseSensitive:Rt(n)};if(l(p,c)){const e={...f,importance:p===null||p===void 0?void 0:p.importance,horizontalAlign:p===null||p===void 0?void 0:p.horizontalAlign,availability:p===null||p===void 0?void 0:p.availability,type:Ye.Annotation,isNavigable:l(p,c)?undefined:Re(p,o,true),settings:p.settings,formatOptions:jt(p.formatOptions)};a[c]=e}else{const e=Yt(p.properties,t,n,i);const o={...f,header:p.header,importance:(p===null||p===void 0?void 0:p.importance)||z.None,horizontalAlign:(p===null||p===void 0?void 0:p.horizontalAlign)||K.Begin,availability:(p===null||p===void 0?void 0:p.availability)||W.Default,template:p.template,propertyInfos:e,exportSettings:e?{template:Jt(e),wrap:!!(e.length>1)}:null,id:`CustomColumn::${c}`,name:`CustomColumn::${c}`,formatOptions:{textLinesEdit:4},isGroupable:false,isNavigable:false,sortable:false,visualSettings:{widthCalculation:null},properties:p.properties};if(e){d(e,t)}if(r(p)){const e={...o,type:Ye.Slot};a[c]=e}else if(s(p)){const e={...o,type:Ye.Default};a[c]=e}else{var v;const e=`The annotation column '${c}' referenced in the manifest is not found`;n.getDiagnostics().addIssue(Me.Manifest,Oe.Low,e,xe,xe===null||xe===void 0?void 0:(v=xe.AnnotationColumns)===null||v===void 0?void 0:v.InvalidKey)}}}return a};function Zt(e,t,n){var i;const o=t.getManifestWrapper();const a=t.getManifestControlConfiguration(e);const l=o.getVariantManagement();const r=[];const s=n.type==="AnalyticalTable";const d=n.type==="ResponsiveTable";if((a===null||a===void 0?void 0:(i=a.tableSettings)===null||i===void 0?void 0:i.personalization)!==undefined){const e=a.tableSettings.personalization;if(e===true){switch(n.type){case"AnalyticalTable":return"Sort,Column,Filter,Group,Aggregate";case"ResponsiveTable":return"Sort,Column,Filter,Group";default:return"Sort,Column,Filter"}}else if(typeof e==="object"){if(e.sort){r.push("Sort")}if(e.column){r.push("Column")}if(e.filter){r.push("Filter")}if(e.group&&(s||d)){r.push("Group")}if(e.aggregate&&s){r.push("Aggregate")}return r.length>0?r.join(","):undefined}}else{r.push("Sort");r.push("Column");if(t.getTemplateType()===H.ListReport){if(l===j.Control||en(o,t)){r.push("Filter")}}else{r.push("Filter")}if(s){r.push("Group");r.push("Aggregate")}if(d){r.push("Group")}return r.join(",")}return undefined}F.getP13nMode=Zt;function en(e,t){return e.isFilterBarHidden()&&!t.getManifestWrapper().hasMultipleVisualizations()&&t.getTemplateType()!==H.AnalyticalListPage}function tn(e,t,n){const i=oe(e.getEntitySet());let o;if(t!==null&&t!==void 0&&t.SortOrder){const e=[];const a={sorters:e};t.SortOrder.forEach(e=>{var t;const o=e.Property;if(o&&i.indexOf((t=o.$target)===null||t===void 0?void 0:t.name)===-1){const t=on([o],n)[0];if(t){a.sorters.push({name:t,descending:!!e.Descending})}}});o=a.sorters.length?JSON.stringify(a):undefined}return o}function nn(e){var t;if(!e){return undefined}const n=(t=e.InitialExpansionLevel)===null||t===void 0?void 0:t.valueOf();return typeof n==="number"?n:undefined}function on(e,t){const n=[];let i,o;e.forEach(e=>{if(e!==null&&e!==void 0&&e.value){i=t.find(t=>{o=t;return!o.propertyInfos&&o.relativePath===(e===null||e===void 0?void 0:e.value)});if(i){n.push(i.name)}}});return n}function an(e,t,n){let i;if(e!==null&&e!==void 0&&e.GroupBy){let o=e.GroupBy;if(n==="ResponsiveTable"){o=o.slice(0,1)}const a=on(o,t).map(e=>({name:e}));i=a.length?JSON.stringify({groupLevels:a}):undefined}return i}function ln(e){const t={};e.columns.forEach(n=>{var i;n=n;const o=Object.keys(e.aggregates).find(e=>e===n.name);if(o){const t=e.aggregates[o];n.aggregatable=true;n.extension={customAggregate:t.defaultAggregate??{}}}if((i=n.additionalPropertyInfos)!==null&&i!==void 0&&i.length){n.additionalPropertyInfos.forEach(n=>{Ut(n,e.columns,t)})}});e.columns.forEach(e=>{e=e;if(e.additionalPropertyInfos){var n;e.additionalPropertyInfos=e.additionalPropertyInfos.map(e=>t[e]??e);e.propertyInfos=(n=e.propertyInfos)===null||n===void 0?void 0:n.concat(e.additionalPropertyInfos)}})}function rn(e,t){let n;if(e!==null&&e!==void 0&&e.Total){const i=e.Total;const o={};on(i,t).forEach(e=>{o[e]={}});n=JSON.stringify(o)}return n}function sn(e,t,n,i,o,a,l){var r,s,d;const{navigationPropertyPath:u}=un(t);const v=(r=n.getDataModelObjectPath().targetEntityType.annotations)===null||r===void 0?void 0:(s=r.UI)===null||s===void 0?void 0:(d=s.HeaderInfo)===null||d===void 0?void 0:d.TypeNamePlural;const c=n.getDataModelObjectPath().targetEntitySet;const p=n.getManifestWrapper();const f=u.length===0,g=Zt(t,n,i),m=u?Q(t):Q(n.getContextPath(),"LineItem");const y=gt(n);const b=tt(n,u);const h=p.getNavigationConfiguration(b);const T=ht(e,i,n,h,t);const I=k(n,T.mode,i,l);const P=N(n,I);const D=V(n,I);const F=U(n,I);const M=$(I,C(n),Fe(D)==="false");const R=mt(e,t,n,f,y,P,F);let L=u?10:30;if(a!==null&&a!==void 0&&a.MaxItems){L=a.MaxItems.valueOf()}const B=p.getVariantManagement();const z=re(n.getDataModelObjectPath());const K={create:x(n,I),delete:O(n,I),paste:S(n,I,M),massEdit:E(n,I),creationRow:w(n,I)};return{id:m,entityName:c?c.name:"",collection:de(n.getDataModelObjectPath()),navigationPath:u,row:Tt(e,n,h,b,i.type),p13nMode:g,standardActions:{actions:K,isInsertUpdateTemplated:M,updatablePropertyPath:rt(n)},displayMode:A(n,l),create:T,selectionMode:R,autoBindOnInit:en(p,n)||n.getTemplateType()!==H.ListReport&&n.getTemplateType()!==H.AnalyticalListPage&&!(l&&p.hasMultipleVisualizations(l)),variantManagement:B==="Control"&&!g?j.None:B,threshold:L,sortConditions:tn(n,a,o),title:v,searchable:i.type!=="AnalyticalTable"&&!(ye(z)&&z.value===false),initialExpansionLevel:nn(a)}}F.getTableAnnotationConfiguration=sn;function dn(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n="String";if(t){if(e==="Edm.DateTimeOffset"){n="DateTime"}return n}else{switch(e){case"Edm.Decimal":case"Edm.Int32":case"Edm.Int64":case"Edm.Double":case"Edm.Byte":n="Number";break;case"Edm.DateOfTime":case"Edm.Date":n="Date";break;case"Edm.DateTimeOffset":n="DateTime";break;case"Edm.TimeOfDay":n="Time";break;case"Edm.Boolean":n="Boolean";break;default:n="String"}}return n}function un(e){let[t,n]=e.split("@");if(t.lastIndexOf("/")===t.length-1){t=t.substr(0,t.length-1)}return{navigationPropertyPath:t,annotationPath:n}}F.splitPath=un;function vn(e,t){const n=t.getEntityTypeAnnotation(e);const i=n.annotation;if(i){var o,a;const e=[];(o=i.SelectOptions)===null||o===void 0?void 0:o.forEach(t=>{const n=t.PropertyName;const i=n.value;if(e.indexOf(i)===-1){e.push(i)}});return{text:i===null||i===void 0?void 0:(a=i.Text)===null||a===void 0?void 0:a.toString(),propertyNames:e}}return undefined}F.getSelectionVariantConfiguration=vn;function cn(e,t,n){let i=e.enableFullScreen??n;if(!n&&i&&t.getTemplateType()===H.ListReport){i=false;t.getDiagnostics().addIssue(Me.Manifest,Oe.Low,Ee.FULLSCREENMODE_NOT_ON_LISTREPORT)}return i}function pn(e,t,n){let i;if(t!=="ResponsiveTable"){return undefined}switch(n.getTemplateType()){case H.ListReport:case H.AnalyticalListPage:i=!e.selectAll?"ClearAll":"Default";break;case H.ObjectPage:i=e.selectAll===false?"ClearAll":"Default";if(n.getManifestWrapper().useIconTabBar()){i=!e.selectAll?"ClearAll":"Default"}break;default:}return i}function fn(e,t,n){let i=(e===null||e===void 0?void 0:e.type)||"ResponsiveTable";if((i==="AnalyticalTable"||i==="TreeTable")&&!n.getManifestWrapper().isDesktop()){i="ResponsiveTable"}return i}function gn(e,t,n){if(e==="GridTable"){if(n){return{rowCountMode:"Auto",rowCount:"3"}}else{return{rowCountMode:t.rowCountMode?t.rowCountMode:"Fixed",rowCount:t.rowCount?t.rowCount:5}}}else{return{}}}function mn(e,t){return t.condensedTableLayout!==undefined&&e!=="ResponsiveTable"?t.condensedTableLayout:false}function yn(e){return e.selectAll===true||e.selectionLimit===0?0:e.selectionLimit||200}function bn(e){var t,n;return(t=e.creationMode)!==null&&t!==void 0&&t.inlineCreationRowCount?(n=e.creationMode)===null||n===void 0?void 0:n.inlineCreationRowCount:2}function hn(e,t,n,i,o){var a;if(n){t.push({annotationPath:i.annotationPath})}return{quickFilters:{enabled:o.getTemplateType()!==H.ListReport,showCounts:e===null||e===void 0?void 0:(a=e.quickVariantSelection)===null||a===void 0?void 0:a.showCounts,paths:t}}}function Tn(e,t,n){return e.enableExport!==undefined?e.enableExport:t.getTemplateType()!=="ObjectPage"||n}function In(e,t,n){var i,o,a;if(!t){return{}}const l=[];const r=n.getAnnotationEntityType(t);let s;let d;e===null||e===void 0?void 0:(i=e.quickVariantSelection)===null||i===void 0?void 0:(o=i.paths)===null||o===void 0?void 0:o.forEach(t=>{s=r.resolvePath(t.annotationPath);d=hn(e,l,s,t,n)});let u=false;u=!!((a=e.quickVariantSelection)!==null&&a!==void 0&&a.hideTableTitle);return{filters:d,headerVisible:!(s&&u)}}function Pn(e,t){const n=ue(t.getDataModelObjectPath(),e).navigationProperties;if((n===null||n===void 0?void 0:n.length)>0){const e=[];n.forEach(t=>{e.push(St(t)||t.name)});return e}}function Dn(e,t,n){var i,o,a,l,r,s,d,u;let v=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const c=n.getManifestWrapper();const p=n.getManifestControlConfiguration(t);const f=p&&p.tableSettings||{};const g=((i=f.creationMode)===null||i===void 0?void 0:i.name)||G.NewPage;const m=!c.isPhone();const y=f.enablePaste!==undefined?f.enablePaste:n.getTemplateType()==="ObjectPage";const b=n.getTemplateType();const h=b===H.ListReport?"API.dataStateIndicatorFilter":undefined;const T=v&&c.isCondensedLayoutCompliant();const I=In(f,e,n);const P=(o=f.creationMode)===null||o===void 0?void 0:o.customValidationFunction;const D=n.getEntityType();const F=new Y(D,n);const A=fn(f,F,n);const C=gn(A,f,b===H.ListReport);const S=mn(A,f);const E={createAtEnd:((a=f.creationMode)===null||a===void 0?void 0:a.createAtEnd)!==undefined?(l=f.creationMode)===null||l===void 0?void 0:l.createAtEnd:g!==G.Inline,creationMode:g,customValidationFunction:P,dataStateIndicatorFilter:h,disableAddRowButtonForEmptyData:!P?!!((r=f.creationMode)!==null&&r!==void 0&&r.disableAddRowButtonForEmptyData):false,enableAutoColumnWidth:m,enableExport:Tn(f,n,y),enableFullScreen:cn(f,n,c.isPhone()),enableMassEdit:f===null||f===void 0?void 0:f.enableMassEdit,enablePaste:y,headerVisible:true,multiSelectMode:pn(f,A,n),selectionLimit:yn(f),inlineCreationRowCount:bn(f),inlineCreationRowsHiddenInEditMode:(f===null||f===void 0?void 0:(s=f.creationMode)===null||s===void 0?void 0:s.inlineCreationRowsHiddenInEditMode)??false,showRowCount:!(f!==null&&f!==void 0&&(d=f.quickVariantSelection)!==null&&d!==void 0&&d.showCounts)&&!((u=c.getViewConfiguration())!==null&&u!==void 0&&u.showCounts),type:A,useCondensedTableLayout:S&&T,isCompactType:c.isCompactType()};const O={...E,...C,...I};if(A==="TreeTable"){O.hierarchyQualifier=f.hierarchyQualifier}return O}F.getTableManifestConfiguration=Dn;function Fn(e,t){var n,i,o,a,l,r;let s=Pe[e===null||e===void 0?void 0:e.type]||(t?Pe[t]:undefined);if(!s&&e!==null&&e!==void 0&&e.targetType&&((n=e.targetType)===null||n===void 0?void 0:n._type)==="TypeDefinition"){s=Pe[e.targetType.underlyingType]}const d={type:(i=s)===null||i===void 0?void 0:i.type,constraints:{},formatOptions:{}};if(X(e)){var u,v,c,p,f,g,m,y,b,h,T,I,P,D,F,A,C;d.constraints={scale:(u=s.constraints)!==null&&u!==void 0&&u.$Scale?e.scale:undefined,precision:(v=s.constraints)!==null&&v!==void 0&&v.$Precision?e.precision:undefined,maxLength:(c=s.constraints)!==null&&c!==void 0&&c.$MaxLength?e.maxLength:undefined,nullable:(p=s.constraints)!==null&&p!==void 0&&p.$Nullable?e.nullable:undefined,minimum:(f=s.constraints)!==null&&f!==void 0&&f["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN((g=e.annotations)===null||g===void 0?void 0:(m=g.Validation)===null||m===void 0?void 0:m.Minimum)?`${(y=e.annotations)===null||y===void 0?void 0:(b=y.Validation)===null||b===void 0?void 0:b.Minimum}`:undefined,maximum:(h=s.constraints)!==null&&h!==void 0&&h["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN((T=e.annotations)===null||T===void 0?void 0:(I=T.Validation)===null||I===void 0?void 0:I.Maximum)?`${(P=e.annotations)===null||P===void 0?void 0:(D=P.Validation)===null||D===void 0?void 0:D.Maximum}`:undefined,isDigitSequence:d.type==="sap.ui.model.odata.type.String"&&(F=s.constraints)!==null&&F!==void 0&&F[`@${"com.sap.vocabularies.Common.v1.IsDigitSequence"}`]&&(A=e.annotations)!==null&&A!==void 0&&(C=A.Common)!==null&&C!==void 0&&C.IsDigitSequence?true:undefined}}d.formatOptions={parseAsString:(d===null||d===void 0?void 0:(o=d.type)===null||o===void 0?void 0:o.indexOf("sap.ui.model.odata.type.Int"))===0||(d===null||d===void 0?void 0:(a=d.type)===null||a===void 0?void 0:a.indexOf("sap.ui.model.odata.type.Double"))===0?false:undefined,emptyString:(d===null||d===void 0?void 0:(l=d.type)===null||l===void 0?void 0:l.indexOf("sap.ui.model.odata.type.Int"))===0||(d===null||d===void 0?void 0:(r=d.type)===null||r===void 0?void 0:r.indexOf("sap.ui.model.odata.type.Double"))===0?"":undefined,parseKeepsEmptyString:d.type==="sap.ui.model.odata.type.String"?true:undefined};return d}F.getTypeConfig=Fn;return{getTableActions:Je,getTableColumns:Xe,getColumnsFromEntityType:It,updateLinkedProperties:nt,createTableVisualization:ot,createDefaultTableVisualization:at,getCapabilityRestriction:gt,getSelectionMode:mt,getRowStatusVisibility:Ot,getImportance:Qt,getP13nMode:Zt,getTableAnnotationConfiguration:sn,isFilteringCaseSensitive:Rt,splitPath:un,getSelectionVariantConfiguration:vn,getTableManifestConfiguration:Dn,getTypeConfig:Fn,updateTableVisualizationForType:et}},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/table/StandardActions-dbg", ["sap/fe/core/formatters/TableFormatter", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/templating/DataModelPathHelper", "../../../helpers/BindingHelper", "../../../ManifestSettings"], function (tableFormatters, BindingToolkit, ModelHelper, DataModelPathHelper, BindingHelper, ManifestSettings) {
  "use strict";

  var _exports = {};
  var TemplateType = ManifestSettings.TemplateType;
  var CreationMode = ManifestSettings.CreationMode;
  var UI = BindingHelper.UI;
  var singletonPathVisitor = BindingHelper.singletonPathVisitor;
  var isPathUpdatable = DataModelPathHelper.isPathUpdatable;
  var isPathInsertable = DataModelPathHelper.isPathInsertable;
  var isPathDeletable = DataModelPathHelper.isPathDeletable;
  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var notEqual = BindingToolkit.notEqual;
  var not = BindingToolkit.not;
  var length = BindingToolkit.length;
  var isPathInModelExpression = BindingToolkit.isPathInModelExpression;
  var isConstant = BindingToolkit.isConstant;
  var ifElse = BindingToolkit.ifElse;
  var greaterThan = BindingToolkit.greaterThan;
  var greaterOrEqual = BindingToolkit.greaterOrEqual;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var formatResult = BindingToolkit.formatResult;
  var equal = BindingToolkit.equal;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  var and = BindingToolkit.and;
  var AnnotationHiddenProperty;
  (function (AnnotationHiddenProperty) {
    AnnotationHiddenProperty["CreateHidden"] = "CreateHidden";
    AnnotationHiddenProperty["DeleteHidden"] = "DeleteHidden";
    AnnotationHiddenProperty["UpdateHidden"] = "UpdateHidden";
  })(AnnotationHiddenProperty || (AnnotationHiddenProperty = {}));
  /**
   * Generates the context for the standard actions.
   *
   * @param converterContext
   * @param creationMode
   * @param tableManifestConfiguration
   * @param viewConfiguration
   * @returns  The context for table actions
   */
  function generateStandardActionsContext(converterContext, creationMode, tableManifestConfiguration, viewConfiguration) {
    return {
      collectionPath: getTargetObjectPath(converterContext.getDataModelObjectPath()),
      hiddenAnnotation: {
        create: isActionAnnotatedHidden(converterContext, AnnotationHiddenProperty.CreateHidden),
        delete: isActionAnnotatedHidden(converterContext, AnnotationHiddenProperty.DeleteHidden),
        update: isActionAnnotatedHidden(converterContext, AnnotationHiddenProperty.UpdateHidden)
      },
      creationMode: creationMode,
      isDraftOrStickySupported: isDraftOrStickySupported(converterContext),
      isViewWithMultipleVisualizations: viewConfiguration ? converterContext.getManifestWrapper().hasMultipleVisualizations(viewConfiguration) : false,
      newAction: getNewAction(converterContext),
      tableManifestConfiguration: tableManifestConfiguration,
      restrictions: getRestrictions(converterContext)
    };
  }

  /**
   * Checks if sticky or draft is supported.
   *
   * @param converterContext
   * @returns `true` if it is supported
   */
  _exports.generateStandardActionsContext = generateStandardActionsContext;
  function isDraftOrStickySupported(converterContext) {
    var _dataModelObjectPath$, _dataModelObjectPath$2, _dataModelObjectPath$3;
    const dataModelObjectPath = converterContext.getDataModelObjectPath();
    const bIsDraftSupported = ModelHelper.isObjectPathDraftSupported(dataModelObjectPath);
    const bIsStickySessionSupported = (_dataModelObjectPath$ = dataModelObjectPath.startingEntitySet) !== null && _dataModelObjectPath$ !== void 0 && (_dataModelObjectPath$2 = _dataModelObjectPath$.annotations) !== null && _dataModelObjectPath$2 !== void 0 && (_dataModelObjectPath$3 = _dataModelObjectPath$2.Session) !== null && _dataModelObjectPath$3 !== void 0 && _dataModelObjectPath$3.StickySessionSupported ? true : false;
    return bIsDraftSupported || bIsStickySessionSupported;
  }

  /**
   * Gets the configured newAction into annotation.
   *
   * @param converterContext
   * @returns The new action info
   */
  _exports.isDraftOrStickySupported = isDraftOrStickySupported;
  function getNewAction(converterContext) {
    var _annotations, _annotations$Common, _annotations$Common$D, _annotations2, _annotations2$Session, _annotations2$Session2;
    const currentEntitySet = converterContext.getEntitySet();
    const newAction = !ModelHelper.isSingleton(currentEntitySet) ? (currentEntitySet === null || currentEntitySet === void 0 ? void 0 : (_annotations = currentEntitySet.annotations) === null || _annotations === void 0 ? void 0 : (_annotations$Common = _annotations.Common) === null || _annotations$Common === void 0 ? void 0 : (_annotations$Common$D = _annotations$Common.DraftRoot) === null || _annotations$Common$D === void 0 ? void 0 : _annotations$Common$D.NewAction) || (currentEntitySet === null || currentEntitySet === void 0 ? void 0 : (_annotations2 = currentEntitySet.annotations) === null || _annotations2 === void 0 ? void 0 : (_annotations2$Session = _annotations2.Session) === null || _annotations2$Session === void 0 ? void 0 : (_annotations2$Session2 = _annotations2$Session.StickySessionSupported) === null || _annotations2$Session2 === void 0 ? void 0 : _annotations2$Session2.NewAction) : undefined;
    const newActionName = newAction === null || newAction === void 0 ? void 0 : newAction.toString();
    if (newActionName) {
      var _converterContext$get, _converterContext$get2, _converterContext$get3;
      let availableProperty = converterContext === null || converterContext === void 0 ? void 0 : (_converterContext$get = converterContext.getEntityType().actions[newActionName]) === null || _converterContext$get === void 0 ? void 0 : (_converterContext$get2 = _converterContext$get.annotations) === null || _converterContext$get2 === void 0 ? void 0 : (_converterContext$get3 = _converterContext$get2.Core) === null || _converterContext$get3 === void 0 ? void 0 : _converterContext$get3.OperationAvailable;
      availableProperty = availableProperty !== undefined ? availableProperty : true;
      return {
        name: newActionName,
        available: getExpressionFromAnnotation(availableProperty)
      };
    }
    return undefined;
  }

  /**
   * Gets the binding expression for the action visibility configured into annotation.
   *
   * @param converterContext
   * @param sAnnotationTerm
   * @param bWithNavigationPath
   * @returns The binding expression for the action visibility
   */
  _exports.getNewAction = getNewAction;
  function isActionAnnotatedHidden(converterContext, sAnnotationTerm) {
    var _currentEntitySet$ann;
    let bWithNavigationPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
    const currentEntitySet = converterContext.getEntitySet();
    const dataModelObjectPath = converterContext.getDataModelObjectPath();
    // Consider only the last level of navigation. The others are already considered in the element binding of the page.
    const visitedNavigationPaths = dataModelObjectPath.navigationProperties.length > 0 && bWithNavigationPath ? [dataModelObjectPath.navigationProperties[dataModelObjectPath.navigationProperties.length - 1].name] : [];
    const actionAnnotationValue = (currentEntitySet === null || currentEntitySet === void 0 ? void 0 : (_currentEntitySet$ann = currentEntitySet.annotations.UI) === null || _currentEntitySet$ann === void 0 ? void 0 : _currentEntitySet$ann[sAnnotationTerm]) || false;
    return currentEntitySet ? getExpressionFromAnnotation(actionAnnotationValue, visitedNavigationPaths, undefined, path => singletonPathVisitor(path, converterContext.getConvertedTypes(), visitedNavigationPaths)) : constant(false);
  }

  /**
   * Gets the annotated restrictions for the actions.
   *
   * @param converterContext
   * @returns The restriction information
   */
  _exports.isActionAnnotatedHidden = isActionAnnotatedHidden;
  function getRestrictions(converterContext) {
    const dataModelObjectPath = converterContext.getDataModelObjectPath();
    const restrictionsDef = [{
      key: "isInsertable",
      function: isPathInsertable
    }, {
      key: "isUpdatable",
      function: isPathUpdatable
    }, {
      key: "isDeletable",
      function: isPathDeletable
    }];
    const result = {};
    restrictionsDef.forEach(function (def) {
      const defFunction = def["function"];
      result[def.key] = {
        expression: defFunction.apply(null, [dataModelObjectPath, {
          pathVisitor: (path, navigationPaths) => singletonPathVisitor(path, converterContext.getConvertedTypes(), navigationPaths)
        }]),
        navigationExpression: defFunction.apply(null, [dataModelObjectPath, {
          ignoreTargetCollection: true,
          authorizeUnresolvable: true,
          pathVisitor: (path, navigationPaths) => singletonPathVisitor(path, converterContext.getConvertedTypes(), navigationPaths)
        }])
      };
    });
    return result;
  }

  /**
   * Checks if templating for insert/update actions is mandatory.
   *
   * @param standardActionsContext
   * @param isDraftOrSticky
   * @param isCreateAlwaysHidden
   * @returns The
   */
  _exports.getRestrictions = getRestrictions;
  function getInsertUpdateActionsTemplating(standardActionsContext, isDraftOrSticky, isCreateAlwaysHidden) {
    return (isDraftOrSticky || standardActionsContext.creationMode === CreationMode.External) && !isCreateAlwaysHidden;
  }

  /**
   * Gets the binding expressions for the properties of the 'Create' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @returns The standard action info
   */
  _exports.getInsertUpdateActionsTemplating = getInsertUpdateActionsTemplating;
  function getStandardActionCreate(converterContext, standardActionsContext) {
    const createVisibility = getCreateVisibility(converterContext, standardActionsContext);
    return {
      isTemplated: compileExpression(getCreateTemplating(standardActionsContext, createVisibility)),
      visible: compileExpression(createVisibility),
      enabled: compileExpression(getCreateEnablement(converterContext, standardActionsContext, createVisibility))
    };
  }

  /**
   * Gets the binding expressions for the properties of the 'Delete' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @returns The binding expressions for the properties of the 'Delete' action.
   */
  _exports.getStandardActionCreate = getStandardActionCreate;
  function getStandardActionDelete(converterContext, standardActionsContext) {
    const deleteVisibility = getDeleteVisibility(converterContext, standardActionsContext);
    return {
      isTemplated: compileExpression(getDefaultTemplating(deleteVisibility)),
      visible: compileExpression(deleteVisibility),
      enabled: compileExpression(getDeleteEnablement(converterContext, standardActionsContext, deleteVisibility))
    };
  }

  /**
   * @param converterContext
   * @param standardActionsContext
   * @returns StandardActionConfigType
   */
  _exports.getStandardActionDelete = getStandardActionDelete;
  function getCreationRow(converterContext, standardActionsContext) {
    const creationRowVisibility = getCreateVisibility(converterContext, standardActionsContext, true);
    return {
      isTemplated: compileExpression(getCreateTemplating(standardActionsContext, creationRowVisibility, true)),
      visible: compileExpression(creationRowVisibility),
      enabled: compileExpression(getCreationRowEnablement(converterContext, standardActionsContext, creationRowVisibility))
    };
  }

  /**
   * Gets the binding expressions for the properties of the 'Paste' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @param isInsertUpdateActionsTemplated
   * @returns The binding expressions for the properties of the 'Paste' action.
   */
  _exports.getCreationRow = getCreationRow;
  function getStandardActionPaste(converterContext, standardActionsContext, isInsertUpdateActionsTemplated) {
    const createVisibility = getCreateVisibility(converterContext, standardActionsContext);
    const createEnablement = getCreateEnablement(converterContext, standardActionsContext, createVisibility);
    const pasteVisibility = getPasteVisibility(converterContext, standardActionsContext, createVisibility, isInsertUpdateActionsTemplated);
    return {
      visible: compileExpression(pasteVisibility),
      enabled: compileExpression(getPasteEnablement(pasteVisibility, createEnablement))
    };
  }

  /**
   * Gets the binding expressions for the properties of the 'MassEdit' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @returns The binding expressions for the properties of the 'MassEdit' action.
   */
  _exports.getStandardActionPaste = getStandardActionPaste;
  function getStandardActionMassEdit(converterContext, standardActionsContext) {
    const massEditVisibility = getMassEditVisibility(converterContext, standardActionsContext);
    return {
      isTemplated: compileExpression(getDefaultTemplating(massEditVisibility)),
      visible: compileExpression(massEditVisibility),
      enabled: compileExpression(getMassEditEnablement(converterContext, standardActionsContext, massEditVisibility))
    };
  }

  /**
   * Gets the binding expression for the templating of the 'Create' action.
   *
   * @param standardActionsContext
   * @param createVisibility
   * @param isForCreationRow
   * @returns The create binding expression
   */
  _exports.getStandardActionMassEdit = getStandardActionMassEdit;
  function getCreateTemplating(standardActionsContext, createVisibility) {
    let isForCreationRow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    //Templating of Create Button is not done:
    // 	 - If Button is never visible(covered the External create button, new Action)
    //	 - or CreationMode is on CreationRow for Create Button
    //	 - or CreationMode is not on CreationRow for CreationRow Button

    return and(
    //XNOR gate
    or(and(isForCreationRow, standardActionsContext.creationMode === CreationMode.CreationRow), and(!isForCreationRow, standardActionsContext.creationMode !== CreationMode.CreationRow)), or(not(isConstant(createVisibility)), createVisibility));
  }

  /**
   * Gets the binding expression for the templating of the non-Create actions.
   *
   * @param actionVisibility
   * @returns The binding expression for the templating of the non-Create actions.
   */
  _exports.getCreateTemplating = getCreateTemplating;
  function getDefaultTemplating(actionVisibility) {
    return or(not(isConstant(actionVisibility)), actionVisibility);
  }

  /**
   * Gets the binding expression for the 'visible' property of the 'Create' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @param isForCreationRow
   * @returns The binding expression for the 'visible' property of the 'Create' action.
   */
  _exports.getDefaultTemplating = getDefaultTemplating;
  function getCreateVisibility(converterContext, standardActionsContext) {
    var _standardActionsConte, _standardActionsConte2;
    let isForCreationRow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    const isInsertable = standardActionsContext.restrictions.isInsertable.expression;
    const isCreateHidden = isForCreationRow ? isActionAnnotatedHidden(converterContext, AnnotationHiddenProperty.CreateHidden, false) : standardActionsContext.hiddenAnnotation.create;
    const newAction = standardActionsContext.newAction;
    //Create Button is visible:
    // 	 - If the creation mode is external
    //      - If we're on the list report and create is not hidden
    //		- Otherwise this depends on the value of the UI.IsEditable
    //	 - Otherwise
    //		- If any of the following conditions is valid then create button isn't visible
    //			- no newAction available
    //			- It's not insertable and there is not a new action
    //			- create is hidden
    //			- There are multiple visualizations
    //			- It's an Analytical List Page
    //			- Uses InlineCreationRows mode and a Responsive table type, with the parameter inlineCreationRowsHiddenInEditMode to true while not in create mode
    //   - Otherwise
    // 	 	- If we're on the list report ->
    // 	 		- If UI.CreateHidden points to a property path -> provide a negated binding to this path
    // 	 		- Otherwise, create is visible
    // 	 	- Otherwise
    // 	  	 - This depends on the value of the UI.IsEditable
    return ifElse(standardActionsContext.creationMode === CreationMode.External, and(not(isCreateHidden), or(converterContext.getTemplateType() === TemplateType.ListReport, UI.IsEditable)), ifElse(or(and(isConstant(newAction === null || newAction === void 0 ? void 0 : newAction.available), equal(newAction === null || newAction === void 0 ? void 0 : newAction.available, false)), and(isConstant(isInsertable), equal(isInsertable, false), !newAction), and(isConstant(isCreateHidden), equal(isCreateHidden, true)), and(standardActionsContext.creationMode === CreationMode.InlineCreationRows, ((_standardActionsConte = standardActionsContext.tableManifestConfiguration) === null || _standardActionsConte === void 0 ? void 0 : _standardActionsConte.type) === "ResponsiveTable", ifElse((standardActionsContext === null || standardActionsContext === void 0 ? void 0 : (_standardActionsConte2 = standardActionsContext.tableManifestConfiguration) === null || _standardActionsConte2 === void 0 ? void 0 : _standardActionsConte2.inlineCreationRowsHiddenInEditMode) === false, true, UI.IsCreateMode))), false, ifElse(converterContext.getTemplateType() === TemplateType.ListReport, or(not(isPathInModelExpression(isCreateHidden)), not(isCreateHidden)), and(not(isCreateHidden), UI.IsEditable))));
  }

  /**
   * Gets the binding expression for the 'visible' property of the 'Delete' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @returns The binding expression for the 'visible' property of the 'Delete' action.
   */
  _exports.getCreateVisibility = getCreateVisibility;
  function getDeleteVisibility(converterContext, standardActionsContext) {
    const isDeleteHidden = standardActionsContext.hiddenAnnotation.delete;
    const pathDeletableExpression = standardActionsContext.restrictions.isDeletable.expression;

    //Delete Button is visible:
    // 	 Prerequisites:
    //	 - If we're not on ALP
    //   - If restrictions on deletable set to false -> not visible
    //   - Otherwise
    //			- If UI.DeleteHidden is true -> not visible
    //			- Otherwise
    // 	 			- If we're on OP -> depending if UI is editable and restrictions on deletable
    //				- Otherwise
    //				 	- If UI.DeleteHidden points to a property path -> provide a negated binding to this path
    //	 	 		 	- Otherwise, delete is visible

    return ifElse(converterContext.getTemplateType() === TemplateType.AnalyticalListPage, false, ifElse(and(isConstant(pathDeletableExpression), equal(pathDeletableExpression, false)), false, ifElse(and(isConstant(isDeleteHidden), equal(isDeleteHidden, constant(true))), false, ifElse(converterContext.getTemplateType() !== TemplateType.ListReport, and(not(isDeleteHidden), UI.IsEditable), not(and(isPathInModelExpression(isDeleteHidden), isDeleteHidden))))));
  }

  /**
   * Gets the binding expression for the 'visible' property of the 'Paste' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @param createVisibility
   * @param isInsertUpdateActionsTemplated
   * @returns The binding expression for the 'visible' property of the 'Paste' action.
   */
  _exports.getDeleteVisibility = getDeleteVisibility;
  function getPasteVisibility(converterContext, standardActionsContext, createVisibility, isInsertUpdateActionsTemplated) {
    // If Create is visible, enablePaste is not disabled into manifest and we are on OP/blocks outside Fiori elements templates
    // Then button will be visible according to insertable restrictions and create visibility
    // Otherwise it's not visible
    return and(notEqual(standardActionsContext.tableManifestConfiguration.enablePaste, false), createVisibility, isInsertUpdateActionsTemplated, [TemplateType.ListReport, TemplateType.AnalyticalListPage].indexOf(converterContext.getTemplateType()) === -1, standardActionsContext.restrictions.isInsertable.expression);
  }

  /**
   * Gets the binding expression for the 'visible' property of the 'MassEdit' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @returns The binding expression for the 'visible' property of the 'MassEdit' action.
   */
  _exports.getPasteVisibility = getPasteVisibility;
  function getMassEditVisibility(converterContext, standardActionsContext) {
    var _standardActionsConte3;
    const isUpdateHidden = standardActionsContext.hiddenAnnotation.update,
      pathUpdatableExpression = standardActionsContext.restrictions.isUpdatable.expression,
      bMassEditEnabledInManifest = ((_standardActionsConte3 = standardActionsContext.tableManifestConfiguration) === null || _standardActionsConte3 === void 0 ? void 0 : _standardActionsConte3.enableMassEdit) || false;
    const templateBindingExpression = converterContext.getTemplateType() === TemplateType.ObjectPage ? UI.IsEditable : converterContext.getTemplateType() === TemplateType.ListReport;
    //MassEdit is visible
    // If
    //		- there is no static restrictions set to false
    //		- and enableMassEdit is not set to false into the manifest
    //		- and the selectionMode is relevant
    //	Then MassEdit is always visible in LR or dynamically visible in OP according to ui>Editable and hiddenAnnotation
    //  Button is hidden for all other cases
    return and(not(and(isConstant(pathUpdatableExpression), equal(pathUpdatableExpression, false))), bMassEditEnabledInManifest, templateBindingExpression, not(isUpdateHidden));
  }

  /**
   * Gets the binding expression for the 'enabled' property of the creationRow.
   *
   * @param converterContext
   * @param standardActionsContext
   * @param creationRowVisibility
   * @returns The binding expression for the 'enabled' property of the creationRow.
   */
  _exports.getMassEditVisibility = getMassEditVisibility;
  function getCreationRowEnablement(converterContext, standardActionsContext, creationRowVisibility) {
    const restrictionsInsertable = isPathInsertable(converterContext.getDataModelObjectPath(), {
      ignoreTargetCollection: true,
      authorizeUnresolvable: true,
      pathVisitor: (path, navigationPaths) => {
        if (path.indexOf("/") === 0) {
          path = singletonPathVisitor(path, converterContext.getConvertedTypes(), navigationPaths);
          return path;
        }
        const navigationProperties = converterContext.getDataModelObjectPath().navigationProperties;
        if (navigationProperties) {
          const lastNav = navigationProperties[navigationProperties.length - 1];
          const partner = lastNav._type === "NavigationProperty" && lastNav.partner;
          if (partner) {
            path = `${partner}/${path}`;
          }
        }
        return path;
      }
    });
    const isInsertable = restrictionsInsertable._type === "Unresolvable" ? isPathInsertable(converterContext.getDataModelObjectPath(), {
      pathVisitor: path => singletonPathVisitor(path, converterContext.getConvertedTypes(), [])
    }) : restrictionsInsertable;
    return and(creationRowVisibility, isInsertable, or(!standardActionsContext.tableManifestConfiguration.disableAddRowButtonForEmptyData, formatResult([pathInModel("creationRowFieldValidity", "internal")], tableFormatters.validateCreationRowFields)));
  }

  /**
   * Gets the binding expression for the 'enabled' property of the 'Create' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @param createVisibility
   * @returns The binding expression for the 'enabled' property of the 'Create' action.
   */
  _exports.getCreationRowEnablement = getCreationRowEnablement;
  function getCreateEnablement(converterContext, standardActionsContext, createVisibility) {
    var _converterContext$res;
    const isInsertable = standardActionsContext.restrictions.isInsertable.expression;
    const CollectionType = (_converterContext$res = converterContext.resolveAbsolutePath(standardActionsContext.collectionPath).target) === null || _converterContext$res === void 0 ? void 0 : _converterContext$res._type;
    return and(createVisibility, or(CollectionType === "EntitySet", and(isInsertable, or(converterContext.getTemplateType() !== TemplateType.ObjectPage, UI.IsEditable))));
  }

  /**
   * Gets the binding expression for the 'enabled' property of the 'Delete' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @param deleteVisibility
   * @returns The binding expression for the 'enabled' property of the 'Delete' action.
   */
  _exports.getCreateEnablement = getCreateEnablement;
  function getDeleteEnablement(converterContext, standardActionsContext, deleteVisibility) {
    const deletableContexts = pathInModel("deletableContexts", "internal");
    const unSavedContexts = pathInModel("unSavedContexts", "internal");
    const draftsWithDeletableActive = pathInModel("draftsWithDeletableActive", "internal");
    const draftsWithNonDeletableActive = pathInModel("draftsWithNonDeletableActive", "internal");
    return and(deleteVisibility, ifElse(converterContext.getTemplateType() === TemplateType.ObjectPage, or(and(notEqual(deletableContexts, undefined), greaterThan(length(deletableContexts), 0)), and(notEqual(draftsWithDeletableActive, undefined), greaterThan(length(draftsWithDeletableActive), 0))), or(and(notEqual(deletableContexts, undefined), greaterThan(length(deletableContexts), 0)), and(notEqual(draftsWithDeletableActive, undefined), greaterThan(length(draftsWithDeletableActive), 0)),
    // on LR, also enable delete button to cancel drafts
    and(notEqual(draftsWithNonDeletableActive, undefined), greaterThan(length(draftsWithNonDeletableActive), 0)),
    // deletable contexts with unsaved changes are counted separately (LR only)
    and(notEqual(unSavedContexts, undefined), greaterThan(length(unSavedContexts), 0)))));
  }

  /**
   * Gets the binding expression for the 'enabled' property of the 'Paste' action.
   *
   * @param pasteVisibility
   * @param createEnablement
   * @returns The binding expression for the 'enabled' property of the 'Paste' action.
   */
  _exports.getDeleteEnablement = getDeleteEnablement;
  function getPasteEnablement(pasteVisibility, createEnablement) {
    return and(pasteVisibility, createEnablement);
  }

  /**
   * Gets the binding expression for the 'enabled' property of the 'MassEdit' action.
   *
   * @param converterContext
   * @param standardActionsContext
   * @param massEditVisibility
   * @returns The binding expression for the 'enabled' property of the 'MassEdit' action.
   */
  _exports.getPasteEnablement = getPasteEnablement;
  function getMassEditEnablement(converterContext, standardActionsContext, massEditVisibility) {
    const pathUpdatableExpression = standardActionsContext.restrictions.isUpdatable.expression;
    const isOnlyDynamicOnCurrentEntity = !isConstant(pathUpdatableExpression) && standardActionsContext.restrictions.isUpdatable.navigationExpression._type === "Unresolvable";
    const numberOfSelectedContexts = greaterOrEqual(pathInModel("numberOfSelectedContexts", "internal"), 1);
    const numberOfUpdatableContexts = greaterOrEqual(length(pathInModel("updatableContexts", "internal")), 1);
    const bIsDraftSupported = ModelHelper.isObjectPathDraftSupported(converterContext.getDataModelObjectPath());
    const bDisplayMode = isInDisplayMode(converterContext);

    // numberOfUpdatableContexts needs to be added to the binding in case
    // 1. Update is dependent on current entity property (isOnlyDynamicOnCurrentEntity is true).
    // 2. The table is read only and draft enabled(like LR), in this case only active contexts can be mass edited.
    //    So, update depends on 'IsActiveEntity' value which needs to be checked runtime.
    const runtimeBinding = ifElse(or(and(bDisplayMode, bIsDraftSupported), isOnlyDynamicOnCurrentEntity), and(numberOfSelectedContexts, numberOfUpdatableContexts), and(numberOfSelectedContexts));
    return and(massEditVisibility, ifElse(isOnlyDynamicOnCurrentEntity, runtimeBinding, and(runtimeBinding, pathUpdatableExpression)));
  }

  /**
   * Tells if the table in template is in display mode.
   *
   * @param converterContext
   * @param viewConfiguration
   * @returns `true` if the table is in display mode
   */
  _exports.getMassEditEnablement = getMassEditEnablement;
  function isInDisplayMode(converterContext, viewConfiguration) {
    const templateType = converterContext.getTemplateType();
    if (templateType === TemplateType.ListReport || templateType === TemplateType.AnalyticalListPage || viewConfiguration && converterContext.getManifestWrapper().hasMultipleVisualizations(viewConfiguration)) {
      return true;
    }
    // updatable will be handled at the property level
    return false;
  }
  _exports.isInDisplayMode = isInDisplayMode;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/Common/table/StandardActions", ["sap/fe/core/formatters/TableFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","../../../helpers/BindingHelper","../../../ManifestSettings"],function(e,t,n,i,a,o){"use strict";var r={};var s=o.TemplateType;var l=o.CreationMode;var d=a.UI;var c=a.singletonPathVisitor;var u=i.isPathUpdatable;var p=i.isPathInsertable;var v=i.isPathDeletable;var f=i.getTargetObjectPath;var g=t.pathInModel;var b=t.or;var h=t.notEqual;var y=t.not;var T=t.length;var C=t.isPathInModelExpression;var M=t.isConstant;var m=t.ifElse;var P=t.greaterThan;var E=t.greaterOrEqual;var D=t.getExpressionFromAnnotation;var S=t.formatResult;var A=t.equal;var x=t.constant;var O=t.compileExpression;var I=t.and;var R;(function(e){e["CreateHidden"]="CreateHidden";e["DeleteHidden"]="DeleteHidden";e["UpdateHidden"]="UpdateHidden"})(R||(R={}));function w(e,t,n,i){return{collectionPath:f(e.getDataModelObjectPath()),hiddenAnnotation:{create:j(e,R.CreateHidden),delete:j(e,R.DeleteHidden),update:j(e,R.UpdateHidden)},creationMode:t,isDraftOrStickySupported:H(e),isViewWithMultipleVisualizations:i?e.getManifestWrapper().hasMultipleVisualizations(i):false,newAction:U(e),tableManifestConfiguration:n,restrictions:V(e)}}r.generateStandardActionsContext=w;function H(e){var t,i,a;const o=e.getDataModelObjectPath();const r=n.isObjectPathDraftSupported(o);const s=(t=o.startingEntitySet)!==null&&t!==void 0&&(i=t.annotations)!==null&&i!==void 0&&(a=i.Session)!==null&&a!==void 0&&a.StickySessionSupported?true:false;return r||s}r.isDraftOrStickySupported=H;function U(e){var t,i,a,o,r,s;const l=e.getEntitySet();const d=!n.isSingleton(l)?(l===null||l===void 0?void 0:(t=l.annotations)===null||t===void 0?void 0:(i=t.Common)===null||i===void 0?void 0:(a=i.DraftRoot)===null||a===void 0?void 0:a.NewAction)||(l===null||l===void 0?void 0:(o=l.annotations)===null||o===void 0?void 0:(r=o.Session)===null||r===void 0?void 0:(s=r.StickySessionSupported)===null||s===void 0?void 0:s.NewAction):undefined;const c=d===null||d===void 0?void 0:d.toString();if(c){var u,p,v;let t=e===null||e===void 0?void 0:(u=e.getEntityType().actions[c])===null||u===void 0?void 0:(p=u.annotations)===null||p===void 0?void 0:(v=p.Core)===null||v===void 0?void 0:v.OperationAvailable;t=t!==undefined?t:true;return{name:c,available:D(t)}}return undefined}r.getNewAction=U;function j(e,t){var n;let i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const a=e.getEntitySet();const o=e.getDataModelObjectPath();const r=o.navigationProperties.length>0&&i?[o.navigationProperties[o.navigationProperties.length-1].name]:[];const s=(a===null||a===void 0?void 0:(n=a.annotations.UI)===null||n===void 0?void 0:n[t])||false;return a?D(s,r,undefined,t=>c(t,e.getConvertedTypes(),r)):x(false)}r.isActionAnnotatedHidden=j;function V(e){const t=e.getDataModelObjectPath();const n=[{key:"isInsertable",function:p},{key:"isUpdatable",function:u},{key:"isDeletable",function:v}];const i={};n.forEach(function(n){const a=n["function"];i[n.key]={expression:a.apply(null,[t,{pathVisitor:(t,n)=>c(t,e.getConvertedTypes(),n)}]),navigationExpression:a.apply(null,[t,{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(t,n)=>c(t,e.getConvertedTypes(),n)}])}});return i}r.getRestrictions=V;function k(e,t,n){return(t||e.creationMode===l.External)&&!n}r.getInsertUpdateActionsTemplating=k;function L(e,t){const n=B(e,t);return{isTemplated:O(_(t,n)),visible:O(n),enabled:O(Q(e,t,n))}}r.getStandardActionCreate=L;function z(e,t){const n=$(e,t);return{isTemplated:O(q(n)),visible:O(n),enabled:O(X(e,t,n))}}r.getStandardActionDelete=z;function F(e,t){const n=B(e,t,true);return{isTemplated:O(_(t,n,true)),visible:O(n),enabled:O(K(e,t,n))}}r.getCreationRow=F;function N(e,t,n){const i=B(e,t);const a=Q(e,t,i);const o=G(e,t,i,n);return{visible:O(o),enabled:O(Y(o,a))}}r.getStandardActionPaste=N;function W(e,t){const n=J(e,t);return{isTemplated:O(q(n)),visible:O(n),enabled:O(Z(e,t,n))}}r.getStandardActionMassEdit=W;function _(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return I(b(I(n,e.creationMode===l.CreationRow),I(!n,e.creationMode!==l.CreationRow)),b(y(M(t)),t))}r.getCreateTemplating=_;function q(e){return b(y(M(e)),e)}r.getDefaultTemplating=q;function B(e,t){var n,i;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const o=t.restrictions.isInsertable.expression;const r=a?j(e,R.CreateHidden,false):t.hiddenAnnotation.create;const c=t.newAction;return m(t.creationMode===l.External,I(y(r),b(e.getTemplateType()===s.ListReport,d.IsEditable)),m(b(I(M(c===null||c===void 0?void 0:c.available),A(c===null||c===void 0?void 0:c.available,false)),I(M(o),A(o,false),!c),I(M(r),A(r,true)),I(t.creationMode===l.InlineCreationRows,((n=t.tableManifestConfiguration)===null||n===void 0?void 0:n.type)==="ResponsiveTable",m((t===null||t===void 0?void 0:(i=t.tableManifestConfiguration)===null||i===void 0?void 0:i.inlineCreationRowsHiddenInEditMode)===false,true,d.IsCreateMode))),false,m(e.getTemplateType()===s.ListReport,b(y(C(r)),y(r)),I(y(r),d.IsEditable))))}r.getCreateVisibility=B;function $(e,t){const n=t.hiddenAnnotation.delete;const i=t.restrictions.isDeletable.expression;return m(e.getTemplateType()===s.AnalyticalListPage,false,m(I(M(i),A(i,false)),false,m(I(M(n),A(n,x(true))),false,m(e.getTemplateType()!==s.ListReport,I(y(n),d.IsEditable),y(I(C(n),n))))))}r.getDeleteVisibility=$;function G(e,t,n,i){return I(h(t.tableManifestConfiguration.enablePaste,false),n,i,[s.ListReport,s.AnalyticalListPage].indexOf(e.getTemplateType())===-1,t.restrictions.isInsertable.expression)}r.getPasteVisibility=G;function J(e,t){var n;const i=t.hiddenAnnotation.update,a=t.restrictions.isUpdatable.expression,o=((n=t.tableManifestConfiguration)===null||n===void 0?void 0:n.enableMassEdit)||false;const r=e.getTemplateType()===s.ObjectPage?d.IsEditable:e.getTemplateType()===s.ListReport;return I(y(I(M(a),A(a,false))),o,r,y(i))}r.getMassEditVisibility=J;function K(t,n,i){const a=p(t.getDataModelObjectPath(),{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(e,n)=>{if(e.indexOf("/")===0){e=c(e,t.getConvertedTypes(),n);return e}const i=t.getDataModelObjectPath().navigationProperties;if(i){const t=i[i.length-1];const n=t._type==="NavigationProperty"&&t.partner;if(n){e=`${n}/${e}`}}return e}});const o=a._type==="Unresolvable"?p(t.getDataModelObjectPath(),{pathVisitor:e=>c(e,t.getConvertedTypes(),[])}):a;return I(i,o,b(!n.tableManifestConfiguration.disableAddRowButtonForEmptyData,S([g("creationRowFieldValidity","internal")],e.validateCreationRowFields)))}r.getCreationRowEnablement=K;function Q(e,t,n){var i;const a=t.restrictions.isInsertable.expression;const o=(i=e.resolveAbsolutePath(t.collectionPath).target)===null||i===void 0?void 0:i._type;return I(n,b(o==="EntitySet",I(a,b(e.getTemplateType()!==s.ObjectPage,d.IsEditable))))}r.getCreateEnablement=Q;function X(e,t,n){const i=g("deletableContexts","internal");const a=g("unSavedContexts","internal");const o=g("draftsWithDeletableActive","internal");const r=g("draftsWithNonDeletableActive","internal");return I(n,m(e.getTemplateType()===s.ObjectPage,b(I(h(i,undefined),P(T(i),0)),I(h(o,undefined),P(T(o),0))),b(I(h(i,undefined),P(T(i),0)),I(h(o,undefined),P(T(o),0)),I(h(r,undefined),P(T(r),0)),I(h(a,undefined),P(T(a),0)))))}r.getDeleteEnablement=X;function Y(e,t){return I(e,t)}r.getPasteEnablement=Y;function Z(e,t,i){const a=t.restrictions.isUpdatable.expression;const o=!M(a)&&t.restrictions.isUpdatable.navigationExpression._type==="Unresolvable";const r=E(g("numberOfSelectedContexts","internal"),1);const s=E(T(g("updatableContexts","internal")),1);const l=n.isObjectPathDraftSupported(e.getDataModelObjectPath());const d=ee(e);const c=m(b(I(d,l),o),I(r,s),I(r));return I(i,m(o,c,I(c,a)))}r.getMassEditEnablement=Z;function ee(e,t){const n=e.getTemplateType();if(n===s.ListReport||n===s.AnalyticalListPage||t&&e.getManifestWrapper().hasMultipleVisualizations(t)){return true}return false}r.isInDisplayMode=ee;return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ListReport/FilterBar-dbg", ["sap/fe/core/converters/controls/Common/Table", "sap/fe/core/converters/controls/ListReport/VisualFilters", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/converters/helpers/IssueManager", "sap/fe/core/converters/helpers/Key", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "../../ManifestSettings", "../Common/DataVisualization"], function (Table, VisualFilters, ConfigurableObject, IssueManager, Key, BindingToolkit, ModelHelper, ManifestSettings, DataVisualization) {
  "use strict";

  var _exports = {};
  var getSelectionVariant = DataVisualization.getSelectionVariant;
  var AvailabilityType = ManifestSettings.AvailabilityType;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var compileExpression = BindingToolkit.compileExpression;
  var KeyHelper = Key.KeyHelper;
  var IssueType = IssueManager.IssueType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategory = IssueManager.IssueCategory;
  var Placement = ConfigurableObject.Placement;
  var OverrideType = ConfigurableObject.OverrideType;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var getVisualFilters = VisualFilters.getVisualFilters;
  var isFilteringCaseSensitive = Table.isFilteringCaseSensitive;
  var getTypeConfig = Table.getTypeConfig;
  var getSelectionVariantConfiguration = Table.getSelectionVariantConfiguration;
  var filterFieldType;
  (function (filterFieldType) {
    filterFieldType["Default"] = "Default";
    filterFieldType["Slot"] = "Slot";
  })(filterFieldType || (filterFieldType = {}));
  const sEdmString = "Edm.String";
  const sStringDataType = "sap.ui.model.odata.type.String";
  /**
   * Enter all DataFields of a given FieldGroup into the filterFacetMap.
   *
   * @param fieldGroup
   * @returns The map of facets for the given FieldGroup
   */
  function getFieldGroupFilterGroups(fieldGroup) {
    const filterFacetMap = {};
    fieldGroup.Data.forEach(dataField => {
      if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataField") {
        var _fieldGroup$annotatio, _fieldGroup$annotatio2;
        filterFacetMap[dataField.Value.path] = {
          group: fieldGroup.fullyQualifiedName,
          groupLabel: compileExpression(getExpressionFromAnnotation(fieldGroup.Label || ((_fieldGroup$annotatio = fieldGroup.annotations) === null || _fieldGroup$annotatio === void 0 ? void 0 : (_fieldGroup$annotatio2 = _fieldGroup$annotatio.Common) === null || _fieldGroup$annotatio2 === void 0 ? void 0 : _fieldGroup$annotatio2.Label) || fieldGroup.qualifier)) || fieldGroup.qualifier
        };
      }
    });
    return filterFacetMap;
  }
  function getExcludedFilterProperties(selectionVariants) {
    return selectionVariants.reduce((previousValue, selectionVariant) => {
      selectionVariant.propertyNames.forEach(propertyName => {
        previousValue[propertyName] = true;
      });
      return previousValue;
    }, {});
  }

  /**
   * Check that all the tables for a dedicated entity set are configured as analytical tables.
   *
   * @param listReportTables List report tables
   * @param contextPath
   * @returns Is FilterBar search field hidden or not
   */
  function checkAllTableForEntitySetAreAnalytical(listReportTables, contextPath) {
    if (contextPath && listReportTables.length > 0) {
      return listReportTables.every(visualization => {
        return visualization.enableAnalytics && contextPath === visualization.annotation.collection;
      });
    }
    return false;
  }
  function getSelectionVariants(lrTableVisualizations, converterContext) {
    const selectionVariantPaths = [];
    return lrTableVisualizations.map(visualization => {
      const tableFilters = visualization.control.filters;
      const tableSVConfigs = [];
      for (const key in tableFilters) {
        if (Array.isArray(tableFilters[key].paths)) {
          const paths = tableFilters[key].paths;
          paths.forEach(path => {
            if (path && path.annotationPath && selectionVariantPaths.indexOf(path.annotationPath) === -1) {
              selectionVariantPaths.push(path.annotationPath);
              const selectionVariantConfig = getSelectionVariantConfiguration(path.annotationPath, converterContext);
              if (selectionVariantConfig) {
                tableSVConfigs.push(selectionVariantConfig);
              }
            }
          });
        }
      }
      return tableSVConfigs;
    }).reduce((svConfigs, selectionVariant) => svConfigs.concat(selectionVariant), []);
  }

  /**
   * Returns the condition path required for the condition model. It looks as follows:
   * <1:N-PropertyName>*\/<1:1-PropertyName>/<PropertyName>.
   *
   * @param entityType The root EntityType
   * @param propertyPath The full path to the target property
   * @returns The formatted condition path
   */
  const _getConditionPath = function (entityType, propertyPath) {
    const parts = propertyPath.split("/");
    let partialPath;
    let key = "";
    while (parts.length) {
      let part = parts.shift();
      partialPath = partialPath ? `${partialPath}/${part}` : part;
      const property = entityType.resolvePath(partialPath);
      if (property._type === "NavigationProperty" && property.isCollection) {
        part += "*";
      }
      key = key ? `${key}/${part}` : part;
    }
    return key;
  };
  const _createFilterSelectionField = function (entityType, property, fullPropertyPath, includeHidden, converterContext) {
    var _property$annotations, _property$annotations2, _property$annotations3;
    // ignore complex property types and hidden annotated ones
    if (property !== undefined && property.targetType === undefined && (includeHidden || ((_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : (_property$annotations2 = _property$annotations.UI) === null || _property$annotations2 === void 0 ? void 0 : (_property$annotations3 = _property$annotations2.Hidden) === null || _property$annotations3 === void 0 ? void 0 : _property$annotations3.valueOf()) !== true)) {
      var _property$annotations4, _property$annotations5, _property$annotations6, _property$annotations7, _property$annotations8, _targetEntityType$ann, _targetEntityType$ann2, _targetEntityType$ann3;
      const targetEntityType = converterContext.getAnnotationEntityType(property);
      return {
        key: KeyHelper.getSelectionFieldKeyFromPath(fullPropertyPath),
        annotationPath: converterContext.getAbsoluteAnnotationPath(fullPropertyPath),
        conditionPath: _getConditionPath(entityType, fullPropertyPath),
        availability: ((_property$annotations4 = property.annotations) === null || _property$annotations4 === void 0 ? void 0 : (_property$annotations5 = _property$annotations4.UI) === null || _property$annotations5 === void 0 ? void 0 : (_property$annotations6 = _property$annotations5.HiddenFilter) === null || _property$annotations6 === void 0 ? void 0 : _property$annotations6.valueOf()) === true ? AvailabilityType.Hidden : AvailabilityType.Adaptation,
        label: compileExpression(getExpressionFromAnnotation(((_property$annotations7 = property.annotations.Common) === null || _property$annotations7 === void 0 ? void 0 : (_property$annotations8 = _property$annotations7.Label) === null || _property$annotations8 === void 0 ? void 0 : _property$annotations8.valueOf()) || property.name)),
        group: targetEntityType.name,
        groupLabel: compileExpression(getExpressionFromAnnotation((targetEntityType === null || targetEntityType === void 0 ? void 0 : (_targetEntityType$ann = targetEntityType.annotations) === null || _targetEntityType$ann === void 0 ? void 0 : (_targetEntityType$ann2 = _targetEntityType$ann.Common) === null || _targetEntityType$ann2 === void 0 ? void 0 : (_targetEntityType$ann3 = _targetEntityType$ann2.Label) === null || _targetEntityType$ann3 === void 0 ? void 0 : _targetEntityType$ann3.valueOf()) || targetEntityType.name))
      };
    }
    return undefined;
  };
  const _getSelectionFields = function (entityType, navigationPath, properties, includeHidden, converterContext) {
    const selectionFieldMap = {};
    if (properties) {
      properties.forEach(property => {
        const propertyPath = property.name;
        const fullPath = (navigationPath ? `${navigationPath}/` : "") + propertyPath;
        const selectionField = _createFilterSelectionField(entityType, property, fullPath, includeHidden, converterContext);
        if (selectionField) {
          selectionFieldMap[fullPath] = selectionField;
        }
      });
    }
    return selectionFieldMap;
  };
  const _getSelectionFieldsByPath = function (entityType, propertyPaths, includeHidden, converterContext) {
    let selectionFields = {};
    if (propertyPaths) {
      propertyPaths.forEach(propertyPath => {
        let localSelectionFields;
        const property = entityType.resolvePath(propertyPath);
        if (property === undefined) {
          return;
        }
        if (property._type === "NavigationProperty") {
          // handle navigation properties
          localSelectionFields = _getSelectionFields(entityType, propertyPath, property.targetType.entityProperties, includeHidden, converterContext);
        } else if (property.targetType !== undefined && property.targetType._type === "ComplexType") {
          // handle ComplexType properties
          localSelectionFields = _getSelectionFields(entityType, propertyPath, property.targetType.properties, includeHidden, converterContext);
        } else {
          const navigationPath = propertyPath.includes("/") ? propertyPath.split("/").splice(0, 1).join("/") : "";
          localSelectionFields = _getSelectionFields(entityType, navigationPath, [property], includeHidden, converterContext);
        }
        selectionFields = {
          ...selectionFields,
          ...localSelectionFields
        };
      });
    }
    return selectionFields;
  };
  const _getFilterField = function (filterFields, propertyPath, converterContext, entityType) {
    let filterField = filterFields[propertyPath];
    if (filterField) {
      delete filterFields[propertyPath];
    } else {
      filterField = _createFilterSelectionField(entityType, entityType.resolvePath(propertyPath), propertyPath, true, converterContext);
    }
    if (!filterField) {
      var _converterContext$get;
      (_converterContext$get = converterContext.getDiagnostics()) === null || _converterContext$get === void 0 ? void 0 : _converterContext$get.addIssue(IssueCategory.Annotation, IssueSeverity.High, IssueType.MISSING_SELECTIONFIELD);
    }
    // defined SelectionFields are available by default
    if (filterField) {
      var _entityType$annotatio, _entityType$annotatio2;
      filterField.availability = filterField.availability === AvailabilityType.Hidden ? AvailabilityType.Hidden : AvailabilityType.Default;
      filterField.isParameter = !!((_entityType$annotatio = entityType.annotations) !== null && _entityType$annotatio !== void 0 && (_entityType$annotatio2 = _entityType$annotatio.Common) !== null && _entityType$annotatio2 !== void 0 && _entityType$annotatio2.ResultContext);
    }
    return filterField;
  };
  const _getDefaultFilterFields = function (aSelectOptions, entityType, converterContext, excludedFilterProperties, annotatedSelectionFields) {
    const selectionFields = [];
    const UISelectionFields = {};
    const properties = entityType.entityProperties;
    // Using entityType instead of entitySet
    annotatedSelectionFields === null || annotatedSelectionFields === void 0 ? void 0 : annotatedSelectionFields.forEach(SelectionField => {
      UISelectionFields[SelectionField.value] = true;
    });
    if (aSelectOptions && aSelectOptions.length > 0) {
      aSelectOptions === null || aSelectOptions === void 0 ? void 0 : aSelectOptions.forEach(selectOption => {
        const propertyName = selectOption.PropertyName;
        const sPropertyPath = propertyName.value;
        const currentSelectionFields = {};
        annotatedSelectionFields === null || annotatedSelectionFields === void 0 ? void 0 : annotatedSelectionFields.forEach(SelectionField => {
          currentSelectionFields[SelectionField.value] = true;
        });
        if (!(sPropertyPath in excludedFilterProperties)) {
          if (!(sPropertyPath in currentSelectionFields)) {
            const FilterField = getFilterField(sPropertyPath, converterContext, entityType);
            if (FilterField) {
              selectionFields.push(FilterField);
            }
          }
        }
      });
    } else if (properties) {
      properties.forEach(property => {
        var _property$annotations9, _property$annotations10;
        const defaultFilterValue = (_property$annotations9 = property.annotations) === null || _property$annotations9 === void 0 ? void 0 : (_property$annotations10 = _property$annotations9.Common) === null || _property$annotations10 === void 0 ? void 0 : _property$annotations10.FilterDefaultValue;
        const propertyPath = property.name;
        if (!(propertyPath in excludedFilterProperties)) {
          if (defaultFilterValue && !(propertyPath in UISelectionFields)) {
            const FilterField = getFilterField(propertyPath, converterContext, entityType);
            if (FilterField) {
              selectionFields.push(FilterField);
            }
          }
        }
      });
    }
    return selectionFields;
  };

  /**
   * Get all parameter filter fields in case of a parameterized service.
   *
   * @param converterContext
   * @returns An array of parameter FilterFields
   */
  function _getParameterFields(converterContext) {
    var _parameterEntityType$, _parameterEntityType$2;
    const dataModelObjectPath = converterContext.getDataModelObjectPath();
    const parameterEntityType = dataModelObjectPath.startingEntitySet.entityType;
    const isParameterized = !!((_parameterEntityType$ = parameterEntityType.annotations) !== null && _parameterEntityType$ !== void 0 && (_parameterEntityType$2 = _parameterEntityType$.Common) !== null && _parameterEntityType$2 !== void 0 && _parameterEntityType$2.ResultContext) && !dataModelObjectPath.targetEntitySet;
    const parameterConverterContext = isParameterized && converterContext.getConverterContextFor(`/${dataModelObjectPath.startingEntitySet.name}`);
    return parameterConverterContext ? parameterEntityType.entityProperties.map(function (property) {
      return _getFilterField({}, property.name, parameterConverterContext, parameterEntityType);
    }) : [];
  }

  /**
   * Determines if the FilterBar search field is hidden or not.
   *
   * @param listReportTables The list report tables
   * @param charts The ALP charts
   * @param converterContext The converter context
   * @returns The information if the FilterBar search field is hidden or not
   */
  const getFilterBarhideBasicSearch = function (listReportTables, charts, converterContext) {
    // Check if charts allow search
    const noSearchInCharts = charts.length === 0 || charts.every(chart => !chart.applySupported.enableSearch);

    // Check if all tables are analytical and none of them allow for search
    const noSearchInTables = listReportTables.length === 0 || listReportTables.every(table => table.enableAnalytics && !table.enableAnalyticsSearch);
    const contextPath = converterContext.getContextPath();
    if (contextPath && noSearchInCharts && noSearchInTables) {
      return true;
    } else {
      return false;
    }
  };

  /**
   * Retrieves filter fields from the manifest.
   *
   * @param entityType The current entityType
   * @param converterContext The converter context
   * @returns The filter fields defined in the manifest
   */
  _exports.getFilterBarhideBasicSearch = getFilterBarhideBasicSearch;
  const getManifestFilterFields = function (entityType, converterContext) {
    const fbConfig = converterContext.getManifestWrapper().getFilterConfiguration();
    const definedFilterFields = (fbConfig === null || fbConfig === void 0 ? void 0 : fbConfig.filterFields) || {};
    const selectionFields = _getSelectionFieldsByPath(entityType, Object.keys(definedFilterFields).map(key => KeyHelper.getPathFromSelectionFieldKey(key)), true, converterContext);
    const filterFields = {};
    for (const sKey in definedFilterFields) {
      const filterField = definedFilterFields[sKey];
      const propertyName = KeyHelper.getPathFromSelectionFieldKey(sKey);
      const selectionField = selectionFields[propertyName];
      const type = filterField.type === "Slot" ? filterFieldType.Slot : filterFieldType.Default;
      const visualFilter = filterField && filterField !== null && filterField !== void 0 && filterField.visualFilter ? getVisualFilters(entityType, converterContext, sKey, definedFilterFields) : undefined;
      filterFields[sKey] = {
        key: sKey,
        type: type,
        slotName: (filterField === null || filterField === void 0 ? void 0 : filterField.slotName) || sKey,
        annotationPath: selectionField === null || selectionField === void 0 ? void 0 : selectionField.annotationPath,
        conditionPath: (selectionField === null || selectionField === void 0 ? void 0 : selectionField.conditionPath) || propertyName,
        template: filterField.template,
        label: filterField.label,
        position: filterField.position || {
          placement: Placement.After
        },
        availability: filterField.availability || AvailabilityType.Default,
        settings: filterField.settings,
        visualFilter: visualFilter,
        required: filterField.required
      };
    }
    return filterFields;
  };
  _exports.getManifestFilterFields = getManifestFilterFields;
  const getFilterField = function (propertyPath, converterContext, entityType) {
    return _getFilterField({}, propertyPath, converterContext, entityType);
  };
  _exports.getFilterField = getFilterField;
  const getFilterRestrictions = function (oFilterRestrictionsAnnotation, sRestriction) {
    if (sRestriction === "RequiredProperties" || sRestriction === "NonFilterableProperties") {
      let aProps = [];
      if (oFilterRestrictionsAnnotation && oFilterRestrictionsAnnotation[sRestriction]) {
        aProps = oFilterRestrictionsAnnotation[sRestriction].map(function (oProperty) {
          return oProperty.$PropertyPath || oProperty.value;
        });
      }
      return aProps;
    } else if (sRestriction === "FilterAllowedExpressions") {
      const mAllowedExpressions = {};
      if (oFilterRestrictionsAnnotation && oFilterRestrictionsAnnotation.FilterExpressionRestrictions) {
        oFilterRestrictionsAnnotation.FilterExpressionRestrictions.forEach(function (oProperty) {
          //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
          if (mAllowedExpressions[oProperty.Property.value]) {
            mAllowedExpressions[oProperty.Property.value].push(oProperty.AllowedExpressions);
          } else {
            mAllowedExpressions[oProperty.Property.value] = [oProperty.AllowedExpressions];
          }
        });
      }
      return mAllowedExpressions;
    }
    return oFilterRestrictionsAnnotation;
  };
  _exports.getFilterRestrictions = getFilterRestrictions;
  const getSearchFilterPropertyInfo = function () {
    return {
      name: "$search",
      path: "$search",
      dataType: sStringDataType,
      maxConditions: 1
    };
  };
  const getEditStateFilterPropertyInfo = function () {
    return {
      name: "$editState",
      path: "$editState",
      groupLabel: "",
      group: "",
      dataType: sStringDataType,
      hiddenFilter: false
    };
  };
  const getSearchRestrictions = function (converterContext) {
    let searchRestrictions;
    if (!ModelHelper.isSingleton(converterContext.getEntitySet())) {
      var _converterContext$get2, _converterContext$get3;
      const capabilites = (_converterContext$get2 = converterContext.getEntitySet()) === null || _converterContext$get2 === void 0 ? void 0 : (_converterContext$get3 = _converterContext$get2.annotations) === null || _converterContext$get3 === void 0 ? void 0 : _converterContext$get3.Capabilities;
      searchRestrictions = capabilites === null || capabilites === void 0 ? void 0 : capabilites.SearchRestrictions;
    }
    return searchRestrictions;
  };
  const getNavigationRestrictions = function (converterContext, sNavigationPath) {
    var _converterContext$get4, _converterContext$get5, _converterContext$get6;
    const oNavigationRestrictions = (_converterContext$get4 = converterContext.getEntitySet()) === null || _converterContext$get4 === void 0 ? void 0 : (_converterContext$get5 = _converterContext$get4.annotations) === null || _converterContext$get5 === void 0 ? void 0 : (_converterContext$get6 = _converterContext$get5.Capabilities) === null || _converterContext$get6 === void 0 ? void 0 : _converterContext$get6.NavigationRestrictions;
    const aRestrictedProperties = oNavigationRestrictions && oNavigationRestrictions.RestrictedProperties;
    return aRestrictedProperties && aRestrictedProperties.find(function (oRestrictedProperty) {
      return oRestrictedProperty && oRestrictedProperty.NavigationProperty && (oRestrictedProperty.NavigationProperty.$NavigationPropertyPath === sNavigationPath || oRestrictedProperty.NavigationProperty.value === sNavigationPath);
    });
  };
  _exports.getNavigationRestrictions = getNavigationRestrictions;
  const _fetchBasicPropertyInfo = function (oFilterFieldInfo) {
    return {
      key: oFilterFieldInfo.key,
      annotationPath: oFilterFieldInfo.annotationPath,
      conditionPath: oFilterFieldInfo.conditionPath,
      name: oFilterFieldInfo.conditionPath,
      label: oFilterFieldInfo.label,
      hiddenFilter: oFilterFieldInfo.availability === "Hidden",
      display: "Value",
      isParameter: oFilterFieldInfo.isParameter,
      caseSensitive: oFilterFieldInfo.caseSensitive,
      availability: oFilterFieldInfo.availability,
      position: oFilterFieldInfo.position,
      type: oFilterFieldInfo.type,
      template: oFilterFieldInfo.template,
      menu: oFilterFieldInfo.menu,
      required: oFilterFieldInfo.required
    };
  };
  const getSpecificAllowedExpression = function (aExpressions) {
    const aAllowedExpressionsPriority = ["SingleValue", "MultiValue", "SingleRange", "MultiRange", "SearchExpression", "MultiRangeOrSearchExpression"];
    aExpressions.sort(function (a, b) {
      return aAllowedExpressionsPriority.indexOf(a) - aAllowedExpressionsPriority.indexOf(b);
    });
    return aExpressions[0];
  };
  _exports.getSpecificAllowedExpression = getSpecificAllowedExpression;
  const displayMode = function (oPropertyAnnotations, oCollectionAnnotations) {
    var _oPropertyAnnotations, _oPropertyAnnotations2, _oPropertyAnnotations3, _oPropertyAnnotations4, _oPropertyAnnotations5, _oCollectionAnnotatio;
    const oTextAnnotation = oPropertyAnnotations === null || oPropertyAnnotations === void 0 ? void 0 : (_oPropertyAnnotations = oPropertyAnnotations.Common) === null || _oPropertyAnnotations === void 0 ? void 0 : _oPropertyAnnotations.Text,
      oTextArrangmentAnnotation = oTextAnnotation && (oPropertyAnnotations && (oPropertyAnnotations === null || oPropertyAnnotations === void 0 ? void 0 : (_oPropertyAnnotations2 = oPropertyAnnotations.Common) === null || _oPropertyAnnotations2 === void 0 ? void 0 : (_oPropertyAnnotations3 = _oPropertyAnnotations2.Text) === null || _oPropertyAnnotations3 === void 0 ? void 0 : (_oPropertyAnnotations4 = _oPropertyAnnotations3.annotations) === null || _oPropertyAnnotations4 === void 0 ? void 0 : (_oPropertyAnnotations5 = _oPropertyAnnotations4.UI) === null || _oPropertyAnnotations5 === void 0 ? void 0 : _oPropertyAnnotations5.TextArrangement) || oCollectionAnnotations && (oCollectionAnnotations === null || oCollectionAnnotations === void 0 ? void 0 : (_oCollectionAnnotatio = oCollectionAnnotations.UI) === null || _oCollectionAnnotatio === void 0 ? void 0 : _oCollectionAnnotatio.TextArrangement));
    if (oTextArrangmentAnnotation) {
      if (oTextArrangmentAnnotation.valueOf() === "UI.TextArrangementType/TextOnly") {
        return "Description";
      } else if (oTextArrangmentAnnotation.valueOf() === "UI.TextArrangementType/TextLast") {
        return "ValueDescription";
      }
      return "DescriptionValue"; //TextFirst
    }

    return oTextAnnotation ? "DescriptionValue" : "Value";
  };
  _exports.displayMode = displayMode;
  const fetchPropertyInfo = function (converterContext, oFilterFieldInfo, oTypeConfig) {
    var _converterContext$get7;
    let oPropertyInfo = _fetchBasicPropertyInfo(oFilterFieldInfo);
    const sAnnotationPath = oFilterFieldInfo.annotationPath;
    if (!sAnnotationPath) {
      return oPropertyInfo;
    }
    const targetPropertyObject = converterContext.getConverterContextFor(sAnnotationPath).getDataModelObjectPath().targetObject;
    const oPropertyAnnotations = targetPropertyObject === null || targetPropertyObject === void 0 ? void 0 : targetPropertyObject.annotations;
    const oCollectionAnnotations = converterContext === null || converterContext === void 0 ? void 0 : (_converterContext$get7 = converterContext.getDataModelObjectPath().targetObject) === null || _converterContext$get7 === void 0 ? void 0 : _converterContext$get7.annotations;
    const oFormatOptions = oTypeConfig.formatOptions;
    const oConstraints = oTypeConfig.constraints;
    oPropertyInfo = Object.assign(oPropertyInfo, {
      formatOptions: oFormatOptions,
      constraints: oConstraints,
      display: displayMode(oPropertyAnnotations, oCollectionAnnotations)
    });
    return oPropertyInfo;
  };
  _exports.fetchPropertyInfo = fetchPropertyInfo;
  const isMultiValue = function (oProperty) {
    let bIsMultiValue = true;
    //SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression
    switch (oProperty.filterExpression) {
      case "SearchExpression":
      case "SingleRange":
      case "SingleValue":
        bIsMultiValue = false;
        break;
      default:
        break;
    }
    if (oProperty.type && oProperty.type.indexOf("Boolean") > 0) {
      bIsMultiValue = false;
    }
    return bIsMultiValue;
  };
  _exports.isMultiValue = isMultiValue;
  const _isFilterableNavigationProperty = function (entry) {
    return (entry.$Type === "com.sap.vocabularies.UI.v1.DataField" || entry.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithUrl" || entry.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath") && entry.Value.path.includes("/");
  };
  const getAnnotatedSelectionFieldData = function (converterContext) {
    var _converterContext$get8, _entityType$annotatio3, _entityType$annotatio4;
    let lrTables = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let annotationPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : "";
    let includeHidden = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    let lineItemTerm = arguments.length > 4 ? arguments[4] : undefined;
    // Fetch all selectionVariants defined in the different visualizations and different views (multi table mode)
    const selectionVariants = getSelectionVariants(lrTables, converterContext);

    // create a map of properties to be used in selection variants
    const excludedFilterProperties = getExcludedFilterProperties(selectionVariants);
    const entityType = converterContext.getEntityType();
    //Filters which has to be added which is part of SV/Default annotations but not present in the SelectionFields
    const annotatedSelectionFields = annotationPath && ((_converterContext$get8 = converterContext.getEntityTypeAnnotation(annotationPath)) === null || _converterContext$get8 === void 0 ? void 0 : _converterContext$get8.annotation) || ((_entityType$annotatio3 = entityType.annotations) === null || _entityType$annotatio3 === void 0 ? void 0 : (_entityType$annotatio4 = _entityType$annotatio3.UI) === null || _entityType$annotatio4 === void 0 ? void 0 : _entityType$annotatio4.SelectionFields) || [];
    const navProperties = [];
    if (lrTables.length === 0 && !!lineItemTerm) {
      var _converterContext$get9;
      (_converterContext$get9 = converterContext.getEntityTypeAnnotation(lineItemTerm).annotation) === null || _converterContext$get9 === void 0 ? void 0 : _converterContext$get9.forEach(entry => {
        if (_isFilterableNavigationProperty(entry)) {
          const entityPath = entry.Value.path.slice(0, entry.Value.path.lastIndexOf("/"));
          if (!navProperties.includes(entityPath)) {
            navProperties.push(entityPath);
          }
        }
      });
    }

    // create a map of all potential filter fields based on...
    const filterFields = {
      // ...non hidden properties of the entity
      ..._getSelectionFields(entityType, "", entityType.entityProperties, includeHidden, converterContext),
      // ... non hidden properties of navigation properties
      ..._getSelectionFieldsByPath(entityType, navProperties, false, converterContext),
      // ...additional manifest defined navigation properties
      ..._getSelectionFieldsByPath(entityType, converterContext.getManifestWrapper().getFilterConfiguration().navigationProperties, includeHidden, converterContext)
    };
    let aSelectOptions = [];
    const selectionVariant = getSelectionVariant(entityType, converterContext);
    if (selectionVariant) {
      aSelectOptions = selectionVariant.SelectOptions;
    }
    const propertyInfoFields = (annotatedSelectionFields === null || annotatedSelectionFields === void 0 ? void 0 : annotatedSelectionFields.reduce((selectionFields, selectionField) => {
      const propertyPath = selectionField.value;
      if (!(propertyPath in excludedFilterProperties)) {
        let navigationPath;
        if (annotationPath.startsWith("@com.sap.vocabularies.UI.v1.SelectionFields")) {
          navigationPath = "";
        } else {
          navigationPath = annotationPath.split("/@com.sap.vocabularies.UI.v1.SelectionFields")[0];
        }
        const filterPropertyPath = navigationPath ? navigationPath + "/" + propertyPath : propertyPath;
        const filterField = _getFilterField(filterFields, filterPropertyPath, converterContext, entityType);
        if (filterField) {
          filterField.group = "";
          filterField.groupLabel = "";
          selectionFields.push(filterField);
        }
      }
      return selectionFields;
    }, [])) || [];
    const defaultFilterFields = _getDefaultFilterFields(aSelectOptions, entityType, converterContext, excludedFilterProperties, annotatedSelectionFields);
    return {
      excludedFilterProperties: excludedFilterProperties,
      entityType: entityType,
      annotatedSelectionFields: annotatedSelectionFields,
      filterFields: filterFields,
      propertyInfoFields: propertyInfoFields,
      defaultFilterFields: defaultFilterFields
    };
  };
  const fetchTypeConfig = function (property) {
    const oTypeConfig = getTypeConfig(property, property === null || property === void 0 ? void 0 : property.type);
    if ((property === null || property === void 0 ? void 0 : property.type) === sEdmString && (oTypeConfig.constraints.nullable === undefined || oTypeConfig.constraints.nullable === true)) {
      oTypeConfig.formatOptions.parseKeepsEmptyString = false;
    }
    return oTypeConfig;
  };
  _exports.fetchTypeConfig = fetchTypeConfig;
  const assignDataTypeToPropertyInfo = function (propertyInfoField, converterContext, aRequiredProps, aTypeConfig) {
    let oPropertyInfo = fetchPropertyInfo(converterContext, propertyInfoField, aTypeConfig[propertyInfoField.key]),
      sPropertyPath = "";
    if (propertyInfoField.conditionPath) {
      sPropertyPath = propertyInfoField.conditionPath.replace(/\+|\*/g, "");
    }
    if (oPropertyInfo) {
      oPropertyInfo = Object.assign(oPropertyInfo, {
        maxConditions: !oPropertyInfo.isParameter && isMultiValue(oPropertyInfo) ? -1 : 1,
        required: propertyInfoField.required ?? (oPropertyInfo.isParameter || aRequiredProps.indexOf(sPropertyPath) >= 0),
        caseSensitive: isFilteringCaseSensitive(converterContext),
        dataType: aTypeConfig[propertyInfoField.key].type
      });
    }
    return oPropertyInfo;
  };
  _exports.assignDataTypeToPropertyInfo = assignDataTypeToPropertyInfo;
  const processSelectionFields = function (propertyInfoFields, converterContext, defaultValuePropertyFields) {
    //get TypeConfig function
    const selectionFieldTypes = [];
    const aTypeConfig = {};
    if (defaultValuePropertyFields) {
      propertyInfoFields = propertyInfoFields.concat(defaultValuePropertyFields);
    }
    //add typeConfig
    propertyInfoFields.forEach(function (parameterField) {
      if (parameterField.annotationPath) {
        const propertyConvertyContext = converterContext.getConverterContextFor(parameterField.annotationPath);
        const propertyTargetObject = propertyConvertyContext.getDataModelObjectPath().targetObject;
        selectionFieldTypes.push(propertyTargetObject === null || propertyTargetObject === void 0 ? void 0 : propertyTargetObject.type);
        const oTypeConfig = fetchTypeConfig(propertyTargetObject);
        aTypeConfig[parameterField.key] = oTypeConfig;
      } else {
        selectionFieldTypes.push(sEdmString);
        aTypeConfig[parameterField.key] = {
          type: sStringDataType
        };
      }
    });

    // filterRestrictions
    let _oFilterrestrictions;
    if (!ModelHelper.isSingleton(converterContext.getEntitySet())) {
      var _converterContext$get10, _converterContext$get11, _converterContext$get12;
      _oFilterrestrictions = (_converterContext$get10 = converterContext.getEntitySet()) === null || _converterContext$get10 === void 0 ? void 0 : (_converterContext$get11 = _converterContext$get10.annotations) === null || _converterContext$get11 === void 0 ? void 0 : (_converterContext$get12 = _converterContext$get11.Capabilities) === null || _converterContext$get12 === void 0 ? void 0 : _converterContext$get12.FilterRestrictions;
    }
    const oFilterRestrictions = _oFilterrestrictions;
    const oRet = {};
    oRet["RequiredProperties"] = getFilterRestrictions(oFilterRestrictions, "RequiredProperties") || [];
    oRet["NonFilterableProperties"] = getFilterRestrictions(oFilterRestrictions, "NonFilterableProperties") || [];
    oRet["FilterAllowedExpressions"] = getFilterRestrictions(oFilterRestrictions, "FilterAllowedExpressions") || {};
    const sEntitySetPath = converterContext.getContextPath();
    const aPathParts = sEntitySetPath.split("/");
    if (aPathParts.length > 2) {
      const sNavigationPath = aPathParts[aPathParts.length - 1];
      aPathParts.splice(-1, 1);
      const oNavigationRestrictions = getNavigationRestrictions(converterContext, sNavigationPath);
      const oNavigationFilterRestrictions = oNavigationRestrictions && oNavigationRestrictions.FilterRestrictions;
      oRet.RequiredProperties.concat(getFilterRestrictions(oNavigationFilterRestrictions, "RequiredProperties") || []);
      oRet.NonFilterableProperties.concat(getFilterRestrictions(oNavigationFilterRestrictions, "NonFilterableProperties") || []);
      oRet.FilterAllowedExpressions = {
        ...(getFilterRestrictions(oNavigationFilterRestrictions, "FilterAllowedExpressions") || {}),
        ...oRet.FilterAllowedExpressions
      };
    }
    const aRequiredProps = oRet.RequiredProperties;
    const aNonFilterableProps = oRet.NonFilterableProperties;
    const aFetchedProperties = [];

    // process the fields to add necessary properties
    propertyInfoFields.forEach(function (propertyInfoField) {
      let sPropertyPath;
      if (aNonFilterableProps.indexOf(sPropertyPath) === -1) {
        const oPropertyInfo = assignDataTypeToPropertyInfo(propertyInfoField, converterContext, aRequiredProps, aTypeConfig);
        aFetchedProperties.push(oPropertyInfo);
      }
    });

    //add edit
    const dataModelObjectPath = converterContext.getDataModelObjectPath();
    if (ModelHelper.isObjectPathDraftSupported(dataModelObjectPath)) {
      aFetchedProperties.push(getEditStateFilterPropertyInfo());
    }
    // add search
    const searchRestrictions = getSearchRestrictions(converterContext);
    const hideBasicSearch = Boolean(searchRestrictions && !searchRestrictions.Searchable);
    if (sEntitySetPath && hideBasicSearch !== true) {
      if (!searchRestrictions || searchRestrictions !== null && searchRestrictions !== void 0 && searchRestrictions.Searchable) {
        aFetchedProperties.push(getSearchFilterPropertyInfo());
      }
    }
    return aFetchedProperties;
  };
  _exports.processSelectionFields = processSelectionFields;
  const insertCustomManifestElements = function (filterFields, entityType, converterContext) {
    return insertCustomElements(filterFields, getManifestFilterFields(entityType, converterContext), {
      availability: OverrideType.overwrite,
      label: OverrideType.overwrite,
      type: OverrideType.overwrite,
      position: OverrideType.overwrite,
      slotName: OverrideType.overwrite,
      template: OverrideType.overwrite,
      settings: OverrideType.overwrite,
      visualFilter: OverrideType.overwrite,
      required: OverrideType.overwrite
    });
  };

  /**
   * Retrieve the configuration for the selection fields that will be used within the filter bar
   * This configuration takes into account the annotation and the selection variants.
   *
   * @param converterContext
   * @param lrTables
   * @param annotationPath
   * @param [includeHidden]
   * @param [lineItemTerm]
   * @returns An array of selection fields
   */
  _exports.insertCustomManifestElements = insertCustomManifestElements;
  const getSelectionFields = function (converterContext) {
    var _entityType$annotatio5, _entityType$annotatio6;
    let lrTables = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let annotationPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : "";
    let includeHidden = arguments.length > 3 ? arguments[3] : undefined;
    let lineItemTerm = arguments.length > 4 ? arguments[4] : undefined;
    const oAnnotatedSelectionFieldData = getAnnotatedSelectionFieldData(converterContext, lrTables, annotationPath, includeHidden, lineItemTerm);
    const parameterFields = _getParameterFields(converterContext);
    let propertyInfoFields = JSON.parse(JSON.stringify(oAnnotatedSelectionFieldData.propertyInfoFields));
    const entityType = oAnnotatedSelectionFieldData.entityType;
    propertyInfoFields = parameterFields.concat(propertyInfoFields);
    propertyInfoFields = insertCustomManifestElements(propertyInfoFields, entityType, converterContext);
    const aFetchedProperties = processSelectionFields(propertyInfoFields, converterContext, oAnnotatedSelectionFieldData.defaultFilterFields);
    aFetchedProperties.sort(function (a, b) {
      if (a.groupLabel === undefined || a.groupLabel === null) {
        return -1;
      }
      if (b.groupLabel === undefined || b.groupLabel === null) {
        return 1;
      }
      return a.groupLabel.localeCompare(b.groupLabel);
    });
    let sFetchProperties = JSON.stringify(aFetchedProperties);
    sFetchProperties = sFetchProperties.replace(/\{/g, "\\{");
    sFetchProperties = sFetchProperties.replace(/\}/g, "\\}");
    const sPropertyInfo = sFetchProperties;
    // end of propertyFields processing

    // to populate selection fields
    let propSelectionFields = JSON.parse(JSON.stringify(oAnnotatedSelectionFieldData.propertyInfoFields));
    propSelectionFields = parameterFields.concat(propSelectionFields);
    // create a map of properties to be used in selection variants
    const excludedFilterProperties = oAnnotatedSelectionFieldData.excludedFilterProperties;
    const filterFacets = entityType === null || entityType === void 0 ? void 0 : (_entityType$annotatio5 = entityType.annotations) === null || _entityType$annotatio5 === void 0 ? void 0 : (_entityType$annotatio6 = _entityType$annotatio5.UI) === null || _entityType$annotatio6 === void 0 ? void 0 : _entityType$annotatio6.FilterFacets;
    let filterFacetMap = {};
    const aFieldGroups = converterContext.getAnnotationsByTerm("UI", "com.sap.vocabularies.UI.v1.FieldGroup");
    if (filterFacets === undefined || filterFacets.length < 0) {
      for (const i in aFieldGroups) {
        filterFacetMap = {
          ...filterFacetMap,
          ...getFieldGroupFilterGroups(aFieldGroups[i])
        };
      }
    } else {
      filterFacetMap = filterFacets.reduce((previousValue, filterFacet) => {
        for (let i = 0; i < (filterFacet === null || filterFacet === void 0 ? void 0 : (_filterFacet$Target = filterFacet.Target) === null || _filterFacet$Target === void 0 ? void 0 : (_filterFacet$Target$$ = _filterFacet$Target.$target) === null || _filterFacet$Target$$ === void 0 ? void 0 : (_filterFacet$Target$$2 = _filterFacet$Target$$.Data) === null || _filterFacet$Target$$2 === void 0 ? void 0 : _filterFacet$Target$$2.length); i++) {
          var _filterFacet$Target, _filterFacet$Target$$, _filterFacet$Target$$2, _filterFacet$Target2, _filterFacet$Target2$, _filterFacet$Target2$2, _filterFacet$Target2$3, _filterFacet$ID, _filterFacet$Label;
          previousValue[filterFacet === null || filterFacet === void 0 ? void 0 : (_filterFacet$Target2 = filterFacet.Target) === null || _filterFacet$Target2 === void 0 ? void 0 : (_filterFacet$Target2$ = _filterFacet$Target2.$target) === null || _filterFacet$Target2$ === void 0 ? void 0 : (_filterFacet$Target2$2 = _filterFacet$Target2$.Data[i]) === null || _filterFacet$Target2$2 === void 0 ? void 0 : (_filterFacet$Target2$3 = _filterFacet$Target2$2.Value) === null || _filterFacet$Target2$3 === void 0 ? void 0 : _filterFacet$Target2$3.path] = {
            group: filterFacet === null || filterFacet === void 0 ? void 0 : (_filterFacet$ID = filterFacet.ID) === null || _filterFacet$ID === void 0 ? void 0 : _filterFacet$ID.toString(),
            groupLabel: filterFacet === null || filterFacet === void 0 ? void 0 : (_filterFacet$Label = filterFacet.Label) === null || _filterFacet$Label === void 0 ? void 0 : _filterFacet$Label.toString()
          };
        }
        return previousValue;
      }, {});
    }

    // create a map of all potential filter fields based on...
    const filterFields = oAnnotatedSelectionFieldData.filterFields;

    // finally create final list of filter fields by adding the SelectionFields first (order matters)...
    let allFilters = propSelectionFields

    // ...and adding remaining filter fields, that are not used in a SelectionVariant (order doesn't matter)
    .concat(Object.keys(filterFields).filter(propertyPath => !(propertyPath in excludedFilterProperties)).map(propertyPath => {
      return Object.assign(filterFields[propertyPath], filterFacetMap[propertyPath]);
    }));
    const sContextPath = converterContext.getContextPath();

    //if all tables are analytical tables "aggregatable" properties must be excluded
    if (checkAllTableForEntitySetAreAnalytical(lrTables, sContextPath)) {
      // Currently all agregates are root entity properties (no properties coming from navigation) and all
      // tables with same entitySet gets same aggreagte configuration that's why we can use first table into
      // LR to get aggregates (without currency/unit properties since we expect to be able to filter them).
      const aggregates = lrTables[0].aggregates;
      if (aggregates) {
        const aggregatableProperties = Object.keys(aggregates).map(aggregateKey => aggregates[aggregateKey].relativePath);
        allFilters = allFilters.filter(filterField => {
          return aggregatableProperties.indexOf(filterField.key) === -1;
        });
      }
    }
    const selectionFields = insertCustomManifestElements(allFilters, entityType, converterContext);

    // Add caseSensitive property to all selection fields.
    const isCaseSensitive = isFilteringCaseSensitive(converterContext);
    selectionFields.forEach(filterField => {
      filterField.caseSensitive = isCaseSensitive;
    });
    return {
      selectionFields,
      sPropertyInfo
    };
  };

  /**
   * Determines whether the filter bar inside a value help dialog should be expanded. This is true if one of the following conditions hold:
   * (1) a filter property is mandatory,
   * (2) no search field exists (entity isn't search enabled),
   * (3) when the data isn't loaded by default (annotation FetchValues = 2).
   *
   * @param converterContext The converter context
   * @param filterRestrictionsAnnotation The FilterRestriction annotation
   * @param valueListAnnotation The ValueList annotation
   * @returns The value for expandFilterFields
   */
  _exports.getSelectionFields = getSelectionFields;
  const getExpandFilterFields = function (converterContext, filterRestrictionsAnnotation, valueListAnnotation) {
    const requiredProperties = getFilterRestrictions(filterRestrictionsAnnotation, "RequiredProperties");
    const searchRestrictions = getSearchRestrictions(converterContext);
    const hideBasicSearch = Boolean(searchRestrictions && !searchRestrictions.Searchable);
    const valueList = valueListAnnotation.getObject();
    if (requiredProperties.length > 0 || hideBasicSearch || (valueList === null || valueList === void 0 ? void 0 : valueList.FetchValues) === 2) {
      return true;
    }
    return false;
  };
  _exports.getExpandFilterFields = getExpandFilterFields;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ListReport/FilterBar", ["sap/fe/core/converters/controls/Common/Table","sap/fe/core/converters/controls/ListReport/VisualFilters","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","../../ManifestSettings","../Common/DataVisualization"],function(e,t,n,i,o,r,l,a,s){"use strict";var c={};var u=s.getSelectionVariant;var d=a.AvailabilityType;var v=r.getExpressionFromAnnotation;var p=r.compileExpression;var f=o.KeyHelper;var g=i.IssueType;var y=i.IssueSeverity;var h=i.IssueCategory;var m=n.Placement;var P=n.OverrideType;var b=n.insertCustomElements;var F=t.getVisualFilters;var S=e.isFilteringCaseSensitive;var E=e.getTypeConfig;var x=e.getSelectionVariantConfiguration;var O;(function(e){e["Default"]="Default";e["Slot"]="Slot"})(O||(O={}));const T="Edm.String";const C="sap.ui.model.odata.type.String";function I(e){const t={};e.Data.forEach(n=>{if(n.$Type==="com.sap.vocabularies.UI.v1.DataField"){var i,o;t[n.Value.path]={group:e.fullyQualifiedName,groupLabel:p(v(e.Label||((i=e.annotations)===null||i===void 0?void 0:(o=i.Common)===null||o===void 0?void 0:o.Label)||e.qualifier))||e.qualifier}}});return t}function A(e){return e.reduce((e,t)=>{t.propertyNames.forEach(t=>{e[t]=true});return e},{})}function D(e,t){if(t&&e.length>0){return e.every(e=>e.enableAnalytics&&t===e.annotation.collection)}return false}function N(e,t){const n=[];return e.map(e=>{const i=e.control.filters;const o=[];for(const e in i){if(Array.isArray(i[e].paths)){const r=i[e].paths;r.forEach(e=>{if(e&&e.annotationPath&&n.indexOf(e.annotationPath)===-1){n.push(e.annotationPath);const i=x(e.annotationPath,t);if(i){o.push(i)}}})}}return o}).reduce((e,t)=>e.concat(t),[])}const R=function(e,t){const n=t.split("/");let i;let o="";while(n.length){let t=n.shift();i=i?`${i}/${t}`:t;const r=e.resolvePath(i);if(r._type==="NavigationProperty"&&r.isCollection){t+="*"}o=o?`${o}/${t}`:t}return o};const V=function(e,t,n,i,o){var r,l,a;if(t!==undefined&&t.targetType===undefined&&(i||((r=t.annotations)===null||r===void 0?void 0:(l=r.UI)===null||l===void 0?void 0:(a=l.Hidden)===null||a===void 0?void 0:a.valueOf())!==true)){var s,c,u,g,y,h,m,P;const i=o.getAnnotationEntityType(t);return{key:f.getSelectionFieldKeyFromPath(n),annotationPath:o.getAbsoluteAnnotationPath(n),conditionPath:R(e,n),availability:((s=t.annotations)===null||s===void 0?void 0:(c=s.UI)===null||c===void 0?void 0:(u=c.HiddenFilter)===null||u===void 0?void 0:u.valueOf())===true?d.Hidden:d.Adaptation,label:p(v(((g=t.annotations.Common)===null||g===void 0?void 0:(y=g.Label)===null||y===void 0?void 0:y.valueOf())||t.name)),group:i.name,groupLabel:p(v((i===null||i===void 0?void 0:(h=i.annotations)===null||h===void 0?void 0:(m=h.Common)===null||m===void 0?void 0:(P=m.Label)===null||P===void 0?void 0:P.valueOf())||i.name))}}return undefined};const w=function(e,t,n,i,o){const r={};if(n){n.forEach(n=>{const l=n.name;const a=(t?`${t}/`:"")+l;const s=V(e,n,a,i,o);if(s){r[a]=s}})}return r};const L=function(e,t,n,i){let o={};if(t){t.forEach(t=>{let r;const l=e.resolvePath(t);if(l===undefined){return}if(l._type==="NavigationProperty"){r=w(e,t,l.targetType.entityProperties,n,i)}else if(l.targetType!==undefined&&l.targetType._type==="ComplexType"){r=w(e,t,l.targetType.properties,n,i)}else{const o=t.includes("/")?t.split("/").splice(0,1).join("/"):"";r=w(e,o,[l],n,i)}o={...o,...r}})}return o};const j=function(e,t,n,i){let o=e[t];if(o){delete e[t]}else{o=V(i,i.resolvePath(t),t,true,n)}if(!o){var r;(r=n.getDiagnostics())===null||r===void 0?void 0:r.addIssue(h.Annotation,y.High,g.MISSING_SELECTIONFIELD)}if(o){var l,a;o.availability=o.availability===d.Hidden?d.Hidden:d.Default;o.isParameter=!!((l=i.annotations)!==null&&l!==void 0&&(a=l.Common)!==null&&a!==void 0&&a.ResultContext)}return o};const M=function(e,t,n,i,o){const r=[];const l={};const a=t.entityProperties;o===null||o===void 0?void 0:o.forEach(e=>{l[e.value]=true});if(e&&e.length>0){e===null||e===void 0?void 0:e.forEach(e=>{const l=e.PropertyName;const a=l.value;const s={};o===null||o===void 0?void 0:o.forEach(e=>{s[e.value]=true});if(!(a in i)){if(!(a in s)){const e=k(a,n,t);if(e){r.push(e)}}}})}else if(a){a.forEach(e=>{var o,a;const s=(o=e.annotations)===null||o===void 0?void 0:(a=o.Common)===null||a===void 0?void 0:a.FilterDefaultValue;const c=e.name;if(!(c in i)){if(s&&!(c in l)){const e=k(c,n,t);if(e){r.push(e)}}}})}return r};function $(e){var t,n;const i=e.getDataModelObjectPath();const o=i.startingEntitySet.entityType;const r=!!((t=o.annotations)!==null&&t!==void 0&&(n=t.Common)!==null&&n!==void 0&&n.ResultContext)&&!i.targetEntitySet;const l=r&&e.getConverterContextFor(`/${i.startingEntitySet.name}`);return l?o.entityProperties.map(function(e){return j({},e.name,l,o)}):[]}const U=function(e,t,n){const i=t.length===0||t.every(e=>!e.applySupported.enableSearch);const o=e.length===0||e.every(e=>e.enableAnalytics&&!e.enableAnalyticsSearch);const r=n.getContextPath();if(r&&i&&o){return true}else{return false}};c.getFilterBarhideBasicSearch=U;const q=function(e,t){const n=t.getManifestWrapper().getFilterConfiguration();const i=(n===null||n===void 0?void 0:n.filterFields)||{};const o=L(e,Object.keys(i).map(e=>f.getPathFromSelectionFieldKey(e)),true,t);const r={};for(const n in i){const l=i[n];const a=f.getPathFromSelectionFieldKey(n);const s=o[a];const c=l.type==="Slot"?O.Slot:O.Default;const u=l&&l!==null&&l!==void 0&&l.visualFilter?F(e,t,n,i):undefined;r[n]={key:n,type:c,slotName:(l===null||l===void 0?void 0:l.slotName)||n,annotationPath:s===null||s===void 0?void 0:s.annotationPath,conditionPath:(s===null||s===void 0?void 0:s.conditionPath)||a,template:l.template,label:l.label,position:l.position||{placement:m.After},availability:l.availability||d.Default,settings:l.settings,visualFilter:u,required:l.required}}return r};c.getManifestFilterFields=q;const k=function(e,t,n){return j({},e,t,n)};c.getFilterField=k;const H=function(e,t){if(t==="RequiredProperties"||t==="NonFilterableProperties"){let n=[];if(e&&e[t]){n=e[t].map(function(e){return e.$PropertyPath||e.value})}return n}else if(t==="FilterAllowedExpressions"){const t={};if(e&&e.FilterExpressionRestrictions){e.FilterExpressionRestrictions.forEach(function(e){if(t[e.Property.value]){t[e.Property.value].push(e.AllowedExpressions)}else{t[e.Property.value]=[e.AllowedExpressions]}})}return t}return e};c.getFilterRestrictions=H;const B=function(){return{name:"$search",path:"$search",dataType:C,maxConditions:1}};const K=function(){return{name:"$editState",path:"$editState",groupLabel:"",group:"",dataType:C,hiddenFilter:false}};const J=function(e){let t;if(!l.isSingleton(e.getEntitySet())){var n,i;const o=(n=e.getEntitySet())===null||n===void 0?void 0:(i=n.annotations)===null||i===void 0?void 0:i.Capabilities;t=o===null||o===void 0?void 0:o.SearchRestrictions}return t};const W=function(e,t){var n,i,o;const r=(n=e.getEntitySet())===null||n===void 0?void 0:(i=n.annotations)===null||i===void 0?void 0:(o=i.Capabilities)===null||o===void 0?void 0:o.NavigationRestrictions;const l=r&&r.RestrictedProperties;return l&&l.find(function(e){return e&&e.NavigationProperty&&(e.NavigationProperty.$NavigationPropertyPath===t||e.NavigationProperty.value===t)})};c.getNavigationRestrictions=W;const _=function(e){return{key:e.key,annotationPath:e.annotationPath,conditionPath:e.conditionPath,name:e.conditionPath,label:e.label,hiddenFilter:e.availability==="Hidden",display:"Value",isParameter:e.isParameter,caseSensitive:e.caseSensitive,availability:e.availability,position:e.position,type:e.type,template:e.template,menu:e.menu,required:e.required}};const G=function(e){const t=["SingleValue","MultiValue","SingleRange","MultiRange","SearchExpression","MultiRangeOrSearchExpression"];e.sort(function(e,n){return t.indexOf(e)-t.indexOf(n)});return e[0]};c.getSpecificAllowedExpression=G;const z=function(e,t){var n,i,o,r,l,a;const s=e===null||e===void 0?void 0:(n=e.Common)===null||n===void 0?void 0:n.Text,c=s&&(e&&(e===null||e===void 0?void 0:(i=e.Common)===null||i===void 0?void 0:(o=i.Text)===null||o===void 0?void 0:(r=o.annotations)===null||r===void 0?void 0:(l=r.UI)===null||l===void 0?void 0:l.TextArrangement)||t&&(t===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:a.TextArrangement));if(c){if(c.valueOf()==="UI.TextArrangementType/TextOnly"){return"Description"}else if(c.valueOf()==="UI.TextArrangementType/TextLast"){return"ValueDescription"}return"DescriptionValue"}return s?"DescriptionValue":"Value"};c.displayMode=z;const Q=function(e,t,n){var i;let o=_(t);const r=t.annotationPath;if(!r){return o}const l=e.getConverterContextFor(r).getDataModelObjectPath().targetObject;const a=l===null||l===void 0?void 0:l.annotations;const s=e===null||e===void 0?void 0:(i=e.getDataModelObjectPath().targetObject)===null||i===void 0?void 0:i.annotations;const c=n.formatOptions;const u=n.constraints;o=Object.assign(o,{formatOptions:c,constraints:u,display:z(a,s)});return o};c.fetchPropertyInfo=Q;const X=function(e){let t=true;switch(e.filterExpression){case"SearchExpression":case"SingleRange":case"SingleValue":t=false;break;default:break}if(e.type&&e.type.indexOf("Boolean")>0){t=false}return t};c.isMultiValue=X;const Y=function(e){return(e.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath")&&e.Value.path.includes("/")};const Z=function(e){var t,n,i;let o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";let l=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let a=arguments.length>4?arguments[4]:undefined;const s=N(o,e);const c=A(s);const d=e.getEntityType();const v=r&&((t=e.getEntityTypeAnnotation(r))===null||t===void 0?void 0:t.annotation)||((n=d.annotations)===null||n===void 0?void 0:(i=n.UI)===null||i===void 0?void 0:i.SelectionFields)||[];const p=[];if(o.length===0&&!!a){var f;(f=e.getEntityTypeAnnotation(a).annotation)===null||f===void 0?void 0:f.forEach(e=>{if(Y(e)){const t=e.Value.path.slice(0,e.Value.path.lastIndexOf("/"));if(!p.includes(t)){p.push(t)}}})}const g={...w(d,"",d.entityProperties,l,e),...L(d,p,false,e),...L(d,e.getManifestWrapper().getFilterConfiguration().navigationProperties,l,e)};let y=[];const h=u(d,e);if(h){y=h.SelectOptions}const m=(v===null||v===void 0?void 0:v.reduce((t,n)=>{const i=n.value;if(!(i in c)){let n;if(r.startsWith("@com.sap.vocabularies.UI.v1.SelectionFields")){n=""}else{n=r.split("/@com.sap.vocabularies.UI.v1.SelectionFields")[0]}const o=n?n+"/"+i:i;const l=j(g,o,e,d);if(l){l.group="";l.groupLabel="";t.push(l)}}return t},[]))||[];const P=M(y,d,e,c,v);return{excludedFilterProperties:c,entityType:d,annotatedSelectionFields:v,filterFields:g,propertyInfoFields:m,defaultFilterFields:P}};const ee=function(e){const t=E(e,e===null||e===void 0?void 0:e.type);if((e===null||e===void 0?void 0:e.type)===T&&(t.constraints.nullable===undefined||t.constraints.nullable===true)){t.formatOptions.parseKeepsEmptyString=false}return t};c.fetchTypeConfig=ee;const te=function(e,t,n,i){let o=Q(t,e,i[e.key]),r="";if(e.conditionPath){r=e.conditionPath.replace(/\+|\*/g,"")}if(o){o=Object.assign(o,{maxConditions:!o.isParameter&&X(o)?-1:1,required:e.required??(o.isParameter||n.indexOf(r)>=0),caseSensitive:S(t),dataType:i[e.key].type})}return o};c.assignDataTypeToPropertyInfo=te;const ne=function(e,t,n){const i=[];const o={};if(n){e=e.concat(n)}e.forEach(function(e){if(e.annotationPath){const n=t.getConverterContextFor(e.annotationPath);const r=n.getDataModelObjectPath().targetObject;i.push(r===null||r===void 0?void 0:r.type);const l=ee(r);o[e.key]=l}else{i.push(T);o[e.key]={type:C}}});let r;if(!l.isSingleton(t.getEntitySet())){var a,s,c;r=(a=t.getEntitySet())===null||a===void 0?void 0:(s=a.annotations)===null||s===void 0?void 0:(c=s.Capabilities)===null||c===void 0?void 0:c.FilterRestrictions}const u=r;const d={};d["RequiredProperties"]=H(u,"RequiredProperties")||[];d["NonFilterableProperties"]=H(u,"NonFilterableProperties")||[];d["FilterAllowedExpressions"]=H(u,"FilterAllowedExpressions")||{};const v=t.getContextPath();const p=v.split("/");if(p.length>2){const e=p[p.length-1];p.splice(-1,1);const n=W(t,e);const i=n&&n.FilterRestrictions;d.RequiredProperties.concat(H(i,"RequiredProperties")||[]);d.NonFilterableProperties.concat(H(i,"NonFilterableProperties")||[]);d.FilterAllowedExpressions={...H(i,"FilterAllowedExpressions")||{},...d.FilterAllowedExpressions}}const f=d.RequiredProperties;const g=d.NonFilterableProperties;const y=[];e.forEach(function(e){let n;if(g.indexOf(n)===-1){const n=te(e,t,f,o);y.push(n)}});const h=t.getDataModelObjectPath();if(l.isObjectPathDraftSupported(h)){y.push(K())}const m=J(t);const P=Boolean(m&&!m.Searchable);if(v&&P!==true){if(!m||m!==null&&m!==void 0&&m.Searchable){y.push(B())}}return y};c.processSelectionFields=ne;const ie=function(e,t,n){return b(e,q(t,n),{availability:P.overwrite,label:P.overwrite,type:P.overwrite,position:P.overwrite,slotName:P.overwrite,template:P.overwrite,settings:P.overwrite,visualFilter:P.overwrite,required:P.overwrite})};c.insertCustomManifestElements=ie;const oe=function(e){var t,n;let i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";let r=arguments.length>3?arguments[3]:undefined;let l=arguments.length>4?arguments[4]:undefined;const a=Z(e,i,o,r,l);const s=$(e);let c=JSON.parse(JSON.stringify(a.propertyInfoFields));const u=a.entityType;c=s.concat(c);c=ie(c,u,e);const d=ne(c,e,a.defaultFilterFields);d.sort(function(e,t){if(e.groupLabel===undefined||e.groupLabel===null){return-1}if(t.groupLabel===undefined||t.groupLabel===null){return 1}return e.groupLabel.localeCompare(t.groupLabel)});let v=JSON.stringify(d);v=v.replace(/\{/g,"\\{");v=v.replace(/\}/g,"\\}");const p=v;let f=JSON.parse(JSON.stringify(a.propertyInfoFields));f=s.concat(f);const g=a.excludedFilterProperties;const y=u===null||u===void 0?void 0:(t=u.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.FilterFacets;let h={};const m=e.getAnnotationsByTerm("UI","com.sap.vocabularies.UI.v1.FieldGroup");if(y===undefined||y.length<0){for(const e in m){h={...h,...I(m[e])}}}else{h=y.reduce((e,t)=>{for(let d=0;d<(t===null||t===void 0?void 0:(n=t.Target)===null||n===void 0?void 0:(i=n.$target)===null||i===void 0?void 0:(o=i.Data)===null||o===void 0?void 0:o.length);d++){var n,i,o,r,l,a,s,c,u;e[t===null||t===void 0?void 0:(r=t.Target)===null||r===void 0?void 0:(l=r.$target)===null||l===void 0?void 0:(a=l.Data[d])===null||a===void 0?void 0:(s=a.Value)===null||s===void 0?void 0:s.path]={group:t===null||t===void 0?void 0:(c=t.ID)===null||c===void 0?void 0:c.toString(),groupLabel:t===null||t===void 0?void 0:(u=t.Label)===null||u===void 0?void 0:u.toString()}}return e},{})}const P=a.filterFields;let b=f.concat(Object.keys(P).filter(e=>!(e in g)).map(e=>Object.assign(P[e],h[e])));const F=e.getContextPath();if(D(i,F)){const e=i[0].aggregates;if(e){const t=Object.keys(e).map(t=>e[t].relativePath);b=b.filter(e=>t.indexOf(e.key)===-1)}}const E=ie(b,u,e);const x=S(e);E.forEach(e=>{e.caseSensitive=x});return{selectionFields:E,sPropertyInfo:p}};c.getSelectionFields=oe;const re=function(e,t,n){const i=H(t,"RequiredProperties");const o=J(e);const r=Boolean(o&&!o.Searchable);const l=n.getObject();if(i.length>0||r||(l===null||l===void 0?void 0:l.FetchValues)===2){return true}return false};c.getExpandFilterFields=re;return c},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ListReport/VisualFilters-dbg", ["sap/fe/core/converters/helpers/Aggregation", "sap/fe/core/converters/helpers/IssueManager", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/templating/DataModelPathHelper", "sap/fe/core/templating/FilterTemplating"], function (Aggregation, IssueManager, BindingToolkit, ModelHelper, DataModelPathHelper, FilterTemplating) {
  "use strict";

  var _exports = {};
  var isPropertyFilterable = FilterTemplating.isPropertyFilterable;
  var getIsRequired = FilterTemplating.getIsRequired;
  var checkFilterExpressionRestrictions = DataModelPathHelper.checkFilterExpressionRestrictions;
  var compileExpression = BindingToolkit.compileExpression;
  var IssueType = IssueManager.IssueType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategory = IssueManager.IssueCategory;
  var AggregationHelper = Aggregation.AggregationHelper;
  /**
   * Checks that measures and dimensions of the visual filter chart can be aggregated and grouped.
   *
   * @param converterContext The converter context
   * @param chartAnnotation The chart annotation
   * @param aggregationHelper The aggregation helper
   * @returns `true` if the measure can be grouped and aggregated
   */
  const _checkVFAggregation = function (converterContext, chartAnnotation, aggregationHelper) {
    var _chartAnnotation$$tar, _chartAnnotation$$tar8, _chartAnnotation$$tar11, _chartAnnotation$$tar12;
    let sMeasurePath, bGroupable, bAggregatable;
    let sMeasure;
    const customAggregates = aggregationHelper.getCustomAggregateDefinitions();
    let aTransAggregations = aggregationHelper.getTransAggregations();
    let aCustAggMeasure = [];
    // if the chart definition has custom aggregates, then consider them, else fall back to the measures with transformation aggregates
    if (chartAnnotation !== null && chartAnnotation !== void 0 && (_chartAnnotation$$tar = chartAnnotation.$target) !== null && _chartAnnotation$$tar !== void 0 && _chartAnnotation$$tar.Measures) {
      var _chartAnnotation$$tar5, _chartAnnotation$$tar6, _chartAnnotation$$tar7;
      aCustAggMeasure = customAggregates.filter(function (custAgg) {
        var _chartAnnotation$$tar2, _chartAnnotation$$tar3, _chartAnnotation$$tar4;
        return custAgg.qualifier === (chartAnnotation === null || chartAnnotation === void 0 ? void 0 : (_chartAnnotation$$tar2 = chartAnnotation.$target) === null || _chartAnnotation$$tar2 === void 0 ? void 0 : (_chartAnnotation$$tar3 = _chartAnnotation$$tar2.Measures) === null || _chartAnnotation$$tar3 === void 0 ? void 0 : (_chartAnnotation$$tar4 = _chartAnnotation$$tar3[0]) === null || _chartAnnotation$$tar4 === void 0 ? void 0 : _chartAnnotation$$tar4.value);
      });
      sMeasure = aCustAggMeasure.length > 0 ? aCustAggMeasure[0].qualifier : chartAnnotation === null || chartAnnotation === void 0 ? void 0 : (_chartAnnotation$$tar5 = chartAnnotation.$target) === null || _chartAnnotation$$tar5 === void 0 ? void 0 : (_chartAnnotation$$tar6 = _chartAnnotation$$tar5.Measures) === null || _chartAnnotation$$tar6 === void 0 ? void 0 : (_chartAnnotation$$tar7 = _chartAnnotation$$tar6[0]) === null || _chartAnnotation$$tar7 === void 0 ? void 0 : _chartAnnotation$$tar7.value;
    }
    // consider dynamic measures only if there are no measures with custom aggregates
    if (!aCustAggMeasure[0] && chartAnnotation !== null && chartAnnotation !== void 0 && (_chartAnnotation$$tar8 = chartAnnotation.$target) !== null && _chartAnnotation$$tar8 !== void 0 && _chartAnnotation$$tar8.DynamicMeasures) {
      var _chartAnnotation$$tar9, _chartAnnotation$$tar10;
      sMeasure = converterContext.getConverterContextFor(converterContext.getAbsoluteAnnotationPath((_chartAnnotation$$tar9 = chartAnnotation.$target.DynamicMeasures) === null || _chartAnnotation$$tar9 === void 0 ? void 0 : (_chartAnnotation$$tar10 = _chartAnnotation$$tar9[0]) === null || _chartAnnotation$$tar10 === void 0 ? void 0 : _chartAnnotation$$tar10.value)).getDataModelObjectPath().targetObject.Name;
      aTransAggregations = aggregationHelper.getAggregatedProperties("AggregatedProperty");
    } else {
      aTransAggregations = aggregationHelper.getAggregatedProperties("AggregatedProperties")[0];
    }
    const sDimension = chartAnnotation === null || chartAnnotation === void 0 ? void 0 : (_chartAnnotation$$tar11 = chartAnnotation.$target) === null || _chartAnnotation$$tar11 === void 0 ? void 0 : (_chartAnnotation$$tar12 = _chartAnnotation$$tar11.Dimensions[0]) === null || _chartAnnotation$$tar12 === void 0 ? void 0 : _chartAnnotation$$tar12.value;
    if (customAggregates.some(function (custAgg) {
      return custAgg.qualifier === sMeasure;
    })) {
      sMeasurePath = sMeasure;
    } else if (aTransAggregations && aTransAggregations[0]) {
      aTransAggregations.some(function (oAggregate) {
        if (oAggregate.Name === sMeasure) {
          sMeasurePath = oAggregate === null || oAggregate === void 0 ? void 0 : oAggregate.AggregatableProperty.value;
        }
      });
    }
    const aAggregatablePropsFromContainer = aggregationHelper.getAggregatableProperties();
    const aGroupablePropsFromContainer = aggregationHelper.getGroupableProperties();
    if (aAggregatablePropsFromContainer && aAggregatablePropsFromContainer.length) {
      for (const aggregatableProp of aAggregatablePropsFromContainer) {
        var _aggregatableProp$Pro;
        if ((aggregatableProp === null || aggregatableProp === void 0 ? void 0 : (_aggregatableProp$Pro = aggregatableProp.Property) === null || _aggregatableProp$Pro === void 0 ? void 0 : _aggregatableProp$Pro.value) === sMeasurePath) {
          bAggregatable = true;
        }
      }
    }
    if (aGroupablePropsFromContainer && aGroupablePropsFromContainer.length) {
      for (const groupableProp of aGroupablePropsFromContainer) {
        if ((groupableProp === null || groupableProp === void 0 ? void 0 : groupableProp.value) === sDimension) {
          bGroupable = true;
        }
      }
    }
    return bAggregatable && bGroupable;
  };

  /**
   * Method to get the visual filters object for a property.
   *
   * @param entityType The converter context
   * @param converterContext The chart annotation
   * @param sPropertyPath The aggregation helper
   * @param FilterFields The aggregation helper
   * @returns { VisualFilters | undefined} The visual filters
   */
  function getVisualFilters(entityType, converterContext, sPropertyPath, FilterFields) {
    var _oVisualFilter$visual;
    let visualFilter;
    const oVisualFilter = FilterFields[sPropertyPath];
    if (oVisualFilter !== null && oVisualFilter !== void 0 && (_oVisualFilter$visual = oVisualFilter.visualFilter) !== null && _oVisualFilter$visual !== void 0 && _oVisualFilter$visual.valueList) {
      var _oVisualFilter$visual2, _property$annotations;
      const oVFPath = oVisualFilter === null || oVisualFilter === void 0 ? void 0 : (_oVisualFilter$visual2 = oVisualFilter.visualFilter) === null || _oVisualFilter$visual2 === void 0 ? void 0 : _oVisualFilter$visual2.valueList;
      const annotationQualifierSplit = oVFPath.split("#");
      const qualifierVL = annotationQualifierSplit.length > 1 ? `ValueList#${annotationQualifierSplit[1]}` : annotationQualifierSplit[0];
      const property = entityType.resolvePath(sPropertyPath);
      const valueList = property === null || property === void 0 ? void 0 : (_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : _property$annotations.Common[qualifierVL];
      if (valueList) {
        var _converterContext$get, _collectionPathConver;
        const collectionPath = valueList === null || valueList === void 0 ? void 0 : valueList.CollectionPath;
        const collectionPathConverterContext = converterContext.getConverterContextFor(`/${collectionPath || ((_converterContext$get = converterContext.getEntitySet()) === null || _converterContext$get === void 0 ? void 0 : _converterContext$get.name)}`);
        const valueListParams = valueList === null || valueList === void 0 ? void 0 : valueList.Parameters;
        let outParameter;
        const inParameters = [];
        let aParameters = [];
        const parameterEntityType = collectionPathConverterContext.getParameterEntityType();
        aParameters = parameterEntityType ? parameterEntityType.keys.map(function (key) {
          return key.name;
        }) : [];
        if (converterContext.getContextPath() === collectionPathConverterContext.getContextPath()) {
          aParameters.forEach(function (parameter) {
            inParameters.push({
              localDataProperty: parameter,
              valueListProperty: parameter
            });
          });
        }
        if (valueListParams) {
          for (const valueListParam of valueListParams) {
            var _valueListParam$Local;
            const localDataProperty = (_valueListParam$Local = valueListParam.LocalDataProperty) === null || _valueListParam$Local === void 0 ? void 0 : _valueListParam$Local.value;
            const valueListProperty = valueListParam.ValueListProperty;
            if (((valueListParam === null || valueListParam === void 0 ? void 0 : valueListParam.$Type) === "com.sap.vocabularies.Common.v1.ValueListParameterInOut" || (valueListParam === null || valueListParam === void 0 ? void 0 : valueListParam.$Type) === "com.sap.vocabularies.Common.v1.ValueListParameterOut") && sPropertyPath === localDataProperty) {
              outParameter = valueListParam;
            }
            if (((valueListParam === null || valueListParam === void 0 ? void 0 : valueListParam.$Type) === "com.sap.vocabularies.Common.v1.ValueListParameterInOut" || (valueListParam === null || valueListParam === void 0 ? void 0 : valueListParam.$Type) === "com.sap.vocabularies.Common.v1.ValueListParameterIn") && sPropertyPath !== localDataProperty) {
              const bNotFilterable = isPropertyFilterable(collectionPathConverterContext, valueListProperty);
              if (!bNotFilterable) {
                inParameters.push({
                  localDataProperty: localDataProperty,
                  valueListProperty: valueListProperty
                });
              }
            }
          }
        }
        if (inParameters && inParameters.length) {
          inParameters.forEach(function (oInParameter) {
            const mainEntitySetInMappingAllowedExpression = compileExpression(checkFilterExpressionRestrictions(converterContext.getConverterContextFor(converterContext.getAbsoluteAnnotationPath(oInParameter === null || oInParameter === void 0 ? void 0 : oInParameter.localDataProperty)).getDataModelObjectPath(), ["SingleValue"]));
            const valueListEntitySetInMappingAllowedExpression = compileExpression(checkFilterExpressionRestrictions(collectionPathConverterContext.getConverterContextFor(collectionPathConverterContext.getAbsoluteAnnotationPath(oInParameter === null || oInParameter === void 0 ? void 0 : oInParameter.valueListProperty)).getDataModelObjectPath(), ["SingleValue"]));
            if (valueListEntitySetInMappingAllowedExpression === "true" && mainEntitySetInMappingAllowedExpression === "false") {
              throw new Error(`FilterRestrictions of ${sPropertyPath} in MainEntitySet and ValueListEntitySet are different`);
            }
          });
        }
        const pvQualifier = valueList === null || valueList === void 0 ? void 0 : valueList.PresentationVariantQualifier;
        const svQualifier = valueList === null || valueList === void 0 ? void 0 : valueList.SelectionVariantQualifier;
        const pvAnnotation = collectionPathConverterContext === null || collectionPathConverterContext === void 0 ? void 0 : (_collectionPathConver = collectionPathConverterContext.getEntityTypeAnnotation(`@UI.PresentationVariant#${pvQualifier}`)) === null || _collectionPathConver === void 0 ? void 0 : _collectionPathConver.annotation;
        const aggregationHelper = new AggregationHelper(collectionPathConverterContext.getEntityType(), collectionPathConverterContext);
        if (!aggregationHelper.isAnalyticsSupported()) {
          return undefined;
        }
        if (pvAnnotation) {
          var _collectionPathConver2;
          const aVisualizations = pvAnnotation === null || pvAnnotation === void 0 ? void 0 : pvAnnotation.Visualizations;
          const contextPath = `/${valueList === null || valueList === void 0 ? void 0 : valueList.CollectionPath}` || `/${collectionPathConverterContext === null || collectionPathConverterContext === void 0 ? void 0 : (_collectionPathConver2 = collectionPathConverterContext.getEntitySet()) === null || _collectionPathConver2 === void 0 ? void 0 : _collectionPathConver2.name}`;
          visualFilter = {};
          visualFilter.contextPath = contextPath;
          let chartAnnotation;
          for (const visualization of aVisualizations) {
            var _visualization$$targe;
            if (((_visualization$$targe = visualization.$target) === null || _visualization$$targe === void 0 ? void 0 : _visualization$$targe.term) === "com.sap.vocabularies.UI.v1.Chart") {
              chartAnnotation = visualization;
              break;
            }
          }
          if (chartAnnotation) {
            var _chartAnnotation, _chartAnnotation$$tar13, _chartAnnotation$$tar14, _chartAnnotation$$tar15, _chartAnnotation$$tar16, _chartAnnotation$$tar17, _chartAnnotation$$tar18, _chartAnnotation2, _chartAnnotation2$$ta, _chartAnnotation2$$ta2, _chartAnnotation2$$ta3, _chartAnnotation2$$ta4, _chartAnnotation2$$ta5, _chartAnnotation2$$ta6;
            const _bgetVFAggregation = _checkVFAggregation(collectionPathConverterContext, chartAnnotation, aggregationHelper);
            if (!_bgetVFAggregation) {
              return;
            }
            const bDimensionHidden = (_chartAnnotation = chartAnnotation) === null || _chartAnnotation === void 0 ? void 0 : (_chartAnnotation$$tar13 = _chartAnnotation.$target) === null || _chartAnnotation$$tar13 === void 0 ? void 0 : (_chartAnnotation$$tar14 = _chartAnnotation$$tar13.Dimensions[0]) === null || _chartAnnotation$$tar14 === void 0 ? void 0 : (_chartAnnotation$$tar15 = _chartAnnotation$$tar14.$target) === null || _chartAnnotation$$tar15 === void 0 ? void 0 : (_chartAnnotation$$tar16 = _chartAnnotation$$tar15.annotations) === null || _chartAnnotation$$tar16 === void 0 ? void 0 : (_chartAnnotation$$tar17 = _chartAnnotation$$tar16.UI) === null || _chartAnnotation$$tar17 === void 0 ? void 0 : (_chartAnnotation$$tar18 = _chartAnnotation$$tar17.Hidden) === null || _chartAnnotation$$tar18 === void 0 ? void 0 : _chartAnnotation$$tar18.valueOf();
            const bDimensionHiddenFilter = (_chartAnnotation2 = chartAnnotation) === null || _chartAnnotation2 === void 0 ? void 0 : (_chartAnnotation2$$ta = _chartAnnotation2.$target) === null || _chartAnnotation2$$ta === void 0 ? void 0 : (_chartAnnotation2$$ta2 = _chartAnnotation2$$ta.Dimensions[0]) === null || _chartAnnotation2$$ta2 === void 0 ? void 0 : (_chartAnnotation2$$ta3 = _chartAnnotation2$$ta2.$target) === null || _chartAnnotation2$$ta3 === void 0 ? void 0 : (_chartAnnotation2$$ta4 = _chartAnnotation2$$ta3.annotations) === null || _chartAnnotation2$$ta4 === void 0 ? void 0 : (_chartAnnotation2$$ta5 = _chartAnnotation2$$ta4.UI) === null || _chartAnnotation2$$ta5 === void 0 ? void 0 : (_chartAnnotation2$$ta6 = _chartAnnotation2$$ta5.HiddenFilter) === null || _chartAnnotation2$$ta6 === void 0 ? void 0 : _chartAnnotation2$$ta6.valueOf();
            if (bDimensionHidden === true || bDimensionHiddenFilter === true) {
              return;
            } else if (aVisualizations && aVisualizations.length) {
              var _outParameter, _outParameter$LocalDa, _outParameter2, _requiredProperties, _visualFilter$require, _chartAnnotation3, _chartAnnotation3$$ta, _chartAnnotation3$$ta2, _chartAnnotation3$$ta3;
              visualFilter.chartAnnotation = chartAnnotation ? collectionPathConverterContext === null || collectionPathConverterContext === void 0 ? void 0 : collectionPathConverterContext.getAbsoluteAnnotationPath(`${chartAnnotation.fullyQualifiedName}/$AnnotationPath/`) : undefined;
              // This needs to be done to avoid repetitive entity type in case of non-parameterized entity set e.g /SalesOrderManage/com.c_salesordermanage_sd_aggregate.SalesOrderManage
              const entityTypeName = collectionPathConverterContext.getEntityType().name;
              let presentationAnnotation;
              const relativeAnnotationPath = collectionPathConverterContext === null || collectionPathConverterContext === void 0 ? void 0 : collectionPathConverterContext.getRelativeAnnotationPath(`${pvAnnotation.fullyQualifiedName}/`, collectionPathConverterContext.getEntityType());
              if (parameterEntityType) {
                presentationAnnotation = collectionPathConverterContext.getContextPath() + "/" + relativeAnnotationPath;
              } else {
                presentationAnnotation = "/" + entityTypeName + "/" + relativeAnnotationPath;
              }
              visualFilter.presentationAnnotation = pvAnnotation ? presentationAnnotation : undefined;
              visualFilter.outParameter = (_outParameter = outParameter) === null || _outParameter === void 0 ? void 0 : (_outParameter$LocalDa = _outParameter.LocalDataProperty) === null || _outParameter$LocalDa === void 0 ? void 0 : _outParameter$LocalDa.value;
              visualFilter.inParameters = inParameters;
              visualFilter.valuelistProperty = (_outParameter2 = outParameter) === null || _outParameter2 === void 0 ? void 0 : _outParameter2.ValueListProperty;
              const bIsRange = checkFilterExpressionRestrictions(converterContext.getConverterContextFor(converterContext.getAbsoluteAnnotationPath(sPropertyPath)).getDataModelObjectPath(), ["SingleRange", "MultiRange"]);
              if (compileExpression(bIsRange) === "true") {
                throw new Error("Range AllowedExpression is not supported for visual filters");
              }
              const bIsMainEntitySetSingleSelection = checkFilterExpressionRestrictions(converterContext.getConverterContextFor(converterContext.getAbsoluteAnnotationPath(sPropertyPath)).getDataModelObjectPath(), ["SingleValue"]);
              visualFilter.multipleSelectionAllowed = compileExpression(!bIsMainEntitySetSingleSelection.value);
              visualFilter.required = getIsRequired(converterContext, sPropertyPath);
              let svAnnotation;
              if (svQualifier) {
                var _collectionPathConver3;
                svAnnotation = collectionPathConverterContext === null || collectionPathConverterContext === void 0 ? void 0 : (_collectionPathConver3 = collectionPathConverterContext.getEntityTypeAnnotation(`@UI.SelectionVariant#${svQualifier}`)) === null || _collectionPathConver3 === void 0 ? void 0 : _collectionPathConver3.annotation;
                let selectionVariantAnnotation;
                const relativeSelectionVariantPath = collectionPathConverterContext === null || collectionPathConverterContext === void 0 ? void 0 : collectionPathConverterContext.getRelativeAnnotationPath(`${svAnnotation.fullyQualifiedName}/`, collectionPathConverterContext.getEntityType());
                if (parameterEntityType) {
                  selectionVariantAnnotation = collectionPathConverterContext.getContextPath() + "/" + relativeSelectionVariantPath;
                } else {
                  selectionVariantAnnotation = "/" + entityTypeName + "/" + relativeSelectionVariantPath;
                }
                visualFilter.selectionVariantAnnotation = svAnnotation ? selectionVariantAnnotation : undefined;
              }
              let requiredProperties = [];
              if (parameterEntityType) {
                var _oEntitySetConverterC, _oEntitySetConverterC2, _oEntitySetConverterC3, _oEntitySetConverterC4, _oRestrictedProperty$;
                const sEntitySet = collectionPath.split("/")[0];
                const sNavigationProperty = collectionPath.split("/")[1];
                const oEntitySetConverterContext = converterContext.getConverterContextFor(`/${sEntitySet}`);
                const aRestrictedProperties = oEntitySetConverterContext === null || oEntitySetConverterContext === void 0 ? void 0 : (_oEntitySetConverterC = oEntitySetConverterContext.getDataModelObjectPath().startingEntitySet) === null || _oEntitySetConverterC === void 0 ? void 0 : (_oEntitySetConverterC2 = _oEntitySetConverterC.annotations) === null || _oEntitySetConverterC2 === void 0 ? void 0 : (_oEntitySetConverterC3 = _oEntitySetConverterC2.Capabilities) === null || _oEntitySetConverterC3 === void 0 ? void 0 : (_oEntitySetConverterC4 = _oEntitySetConverterC3.NavigationRestrictions) === null || _oEntitySetConverterC4 === void 0 ? void 0 : _oEntitySetConverterC4.RestrictedProperties;
                const oRestrictedProperty = aRestrictedProperties === null || aRestrictedProperties === void 0 ? void 0 : aRestrictedProperties.find(restrictedNavProp => {
                  var _restrictedNavProp$Na;
                  if (((_restrictedNavProp$Na = restrictedNavProp.NavigationProperty) === null || _restrictedNavProp$Na === void 0 ? void 0 : _restrictedNavProp$Na.type) === "NavigationPropertyPath") {
                    return restrictedNavProp.NavigationProperty.value === sNavigationProperty;
                  }
                });
                requiredProperties = oRestrictedProperty === null || oRestrictedProperty === void 0 ? void 0 : (_oRestrictedProperty$ = oRestrictedProperty.FilterRestrictions) === null || _oRestrictedProperty$ === void 0 ? void 0 : _oRestrictedProperty$.RequiredProperties;
              } else {
                var _collectionPathConver4;
                const entitySetAnnotations = (_collectionPathConver4 = collectionPathConverterContext.getEntitySet()) === null || _collectionPathConver4 === void 0 ? void 0 : _collectionPathConver4.annotations;
                if (!ModelHelper.isSingleton(collectionPathConverterContext.getEntitySet())) {
                  var _entitySetAnnotations, _entitySetAnnotations2;
                  requiredProperties = entitySetAnnotations === null || entitySetAnnotations === void 0 ? void 0 : (_entitySetAnnotations = entitySetAnnotations.Capabilities) === null || _entitySetAnnotations === void 0 ? void 0 : (_entitySetAnnotations2 = _entitySetAnnotations.FilterRestrictions) === null || _entitySetAnnotations2 === void 0 ? void 0 : _entitySetAnnotations2.RequiredProperties;
                }
              }
              let requiredPropertyPaths = [];
              if ((_requiredProperties = requiredProperties) !== null && _requiredProperties !== void 0 && _requiredProperties.length) {
                requiredProperties.forEach(function (oRequireProperty) {
                  requiredPropertyPaths.push(oRequireProperty.value);
                });
              }
              requiredPropertyPaths = requiredPropertyPaths.concat(aParameters);
              visualFilter.requiredProperties = requiredPropertyPaths;
              if ((_visualFilter$require = visualFilter.requiredProperties) !== null && _visualFilter$require !== void 0 && _visualFilter$require.length) {
                if (!visualFilter.inParameters || !visualFilter.inParameters.length) {
                  if (!visualFilter.selectionVariantAnnotation) {
                    visualFilter.showOverlayInitially = true;
                  } else {
                    var _svAnnotation, _svAnnotation$SelectO, _svAnnotation2, _svAnnotation2$Parame;
                    let selectOptions = ((_svAnnotation = svAnnotation) === null || _svAnnotation === void 0 ? void 0 : (_svAnnotation$SelectO = _svAnnotation.SelectOptions) === null || _svAnnotation$SelectO === void 0 ? void 0 : _svAnnotation$SelectO.map(oSelectOption => oSelectOption.PropertyName.value)) || [];
                    const parameterOptions = ((_svAnnotation2 = svAnnotation) === null || _svAnnotation2 === void 0 ? void 0 : (_svAnnotation2$Parame = _svAnnotation2.Parameters) === null || _svAnnotation2$Parame === void 0 ? void 0 : _svAnnotation2$Parame.map(oParameterOption => oParameterOption.PropertyName.value)) || [];
                    selectOptions = selectOptions.concat(parameterOptions);
                    requiredPropertyPaths = requiredPropertyPaths.sort();
                    selectOptions = selectOptions.sort();
                    visualFilter.showOverlayInitially = requiredPropertyPaths.some(function (sPath) {
                      return selectOptions.indexOf(sPath) === -1;
                    });
                  }
                } else {
                  visualFilter.showOverlayInitially = false;
                }
              } else {
                visualFilter.showOverlayInitially = false;
              }
              const sDimensionType = (_chartAnnotation3 = chartAnnotation) === null || _chartAnnotation3 === void 0 ? void 0 : (_chartAnnotation3$$ta = _chartAnnotation3.$target) === null || _chartAnnotation3$$ta === void 0 ? void 0 : (_chartAnnotation3$$ta2 = _chartAnnotation3$$ta.Dimensions[0]) === null || _chartAnnotation3$$ta2 === void 0 ? void 0 : (_chartAnnotation3$$ta3 = _chartAnnotation3$$ta2.$target) === null || _chartAnnotation3$$ta3 === void 0 ? void 0 : _chartAnnotation3$$ta3.type;
              if (!(sDimensionType === "Edm.DateTimeOffset" || sDimensionType === "Edm.Date" || sDimensionType === "Edm.TimeOfDay") && chartAnnotation.$target.ChartType === "UI.ChartType/Line") {
                visualFilter.renderLineChart = false;
              } else {
                visualFilter.renderLineChart = true;
              }
            }
          } else {
            converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.High, IssueType.MALFORMED_VISUALFILTERS.CHART);
          }
        } else {
          converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.High, IssueType.MALFORMED_VISUALFILTERS.PRESENTATIONVARIANT);
        }
      } else {
        converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.High, IssueType.MALFORMED_VISUALFILTERS.VALUELIST);
      }
    } else {
      converterContext.getDiagnostics().addIssue(IssueCategory.Manifest, IssueSeverity.High, IssueType.MALFORMED_VISUALFILTERS.VALUELIST);
    }
    return visualFilter;
  }
  _exports.getVisualFilters = getVisualFilters;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ListReport/VisualFilters", ["sap/fe/core/converters/helpers/Aggregation","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/FilterTemplating"],function(e,t,o,i,n,l){"use strict";var a={};var r=l.isPropertyFilterable;var v=l.getIsRequired;var s=n.checkFilterExpressionRestrictions;var d=o.compileExpression;var u=t.IssueType;var g=t.IssueSeverity;var c=t.IssueCategory;var f=e.AggregationHelper;const p=function(e,t,o){var i,n,l,a;let r,v,s;let d;const u=o.getCustomAggregateDefinitions();let g=o.getTransAggregations();let c=[];if(t!==null&&t!==void 0&&(i=t.$target)!==null&&i!==void 0&&i.Measures){var f,p,P;c=u.filter(function(e){var o,i,n;return e.qualifier===(t===null||t===void 0?void 0:(o=t.$target)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:(n=i[0])===null||n===void 0?void 0:n.value)});d=c.length>0?c[0].qualifier:t===null||t===void 0?void 0:(f=t.$target)===null||f===void 0?void 0:(p=f.Measures)===null||p===void 0?void 0:(P=p[0])===null||P===void 0?void 0:P.value}if(!c[0]&&t!==null&&t!==void 0&&(n=t.$target)!==null&&n!==void 0&&n.DynamicMeasures){var y,h;d=e.getConverterContextFor(e.getAbsoluteAnnotationPath((y=t.$target.DynamicMeasures)===null||y===void 0?void 0:(h=y[0])===null||h===void 0?void 0:h.value)).getDataModelObjectPath().targetObject.Name;g=o.getAggregatedProperties("AggregatedProperty")}else{g=o.getAggregatedProperties("AggregatedProperties")[0]}const m=t===null||t===void 0?void 0:(l=t.$target)===null||l===void 0?void 0:(a=l.Dimensions[0])===null||a===void 0?void 0:a.value;if(u.some(function(e){return e.qualifier===d})){r=d}else if(g&&g[0]){g.some(function(e){if(e.Name===d){r=e===null||e===void 0?void 0:e.AggregatableProperty.value}})}const A=o.getAggregatableProperties();const E=o.getGroupableProperties();if(A&&A.length){for(const e of A){var C;if((e===null||e===void 0?void 0:(C=e.Property)===null||C===void 0?void 0:C.value)===r){s=true}}}if(E&&E.length){for(const e of E){if((e===null||e===void 0?void 0:e.value)===m){v=true}}}return s&&v};function P(e,t,o,n){var l;let a;const P=n[o];if(P!==null&&P!==void 0&&(l=P.visualFilter)!==null&&l!==void 0&&l.valueList){var y,h;const n=P===null||P===void 0?void 0:(y=P.visualFilter)===null||y===void 0?void 0:y.valueList;const l=n.split("#");const ae=l.length>1?`ValueList#${l[1]}`:l[0];const re=e.resolvePath(o);const ve=re===null||re===void 0?void 0:(h=re.annotations)===null||h===void 0?void 0:h.Common[ae];if(ve){var m,A;const e=ve===null||ve===void 0?void 0:ve.CollectionPath;const n=t.getConverterContextFor(`/${e||((m=t.getEntitySet())===null||m===void 0?void 0:m.name)}`);const l=ve===null||ve===void 0?void 0:ve.Parameters;let P;const y=[];let h=[];const ae=n.getParameterEntityType();h=ae?ae.keys.map(function(e){return e.name}):[];if(t.getContextPath()===n.getContextPath()){h.forEach(function(e){y.push({localDataProperty:e,valueListProperty:e})})}if(l){for(const e of l){var E;const t=(E=e.LocalDataProperty)===null||E===void 0?void 0:E.value;const i=e.ValueListProperty;if(((e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||(e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.Common.v1.ValueListParameterOut")&&o===t){P=e}if(((e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||(e===null||e===void 0?void 0:e.$Type)==="com.sap.vocabularies.Common.v1.ValueListParameterIn")&&o!==t){const e=r(n,i);if(!e){y.push({localDataProperty:t,valueListProperty:i})}}}}if(y&&y.length){y.forEach(function(e){const i=d(s(t.getConverterContextFor(t.getAbsoluteAnnotationPath(e===null||e===void 0?void 0:e.localDataProperty)).getDataModelObjectPath(),["SingleValue"]));const l=d(s(n.getConverterContextFor(n.getAbsoluteAnnotationPath(e===null||e===void 0?void 0:e.valueListProperty)).getDataModelObjectPath(),["SingleValue"]));if(l==="true"&&i==="false"){throw new Error(`FilterRestrictions of ${o} in MainEntitySet and ValueListEntitySet are different`)}})}const re=ve===null||ve===void 0?void 0:ve.PresentationVariantQualifier;const se=ve===null||ve===void 0?void 0:ve.SelectionVariantQualifier;const de=n===null||n===void 0?void 0:(A=n.getEntityTypeAnnotation(`@UI.PresentationVariant#${re}`))===null||A===void 0?void 0:A.annotation;const ue=new f(n.getEntityType(),n);if(!ue.isAnalyticsSupported()){return undefined}if(de){var C;const l=de===null||de===void 0?void 0:de.Visualizations;const r=`/${ve===null||ve===void 0?void 0:ve.CollectionPath}`||`/${n===null||n===void 0?void 0:(C=n.getEntitySet())===null||C===void 0?void 0:C.name}`;a={};a.contextPath=r;let f;for(const e of l){var I;if(((I=e.$target)===null||I===void 0?void 0:I.term)==="com.sap.vocabularies.UI.v1.Chart"){f=e;break}}if(f){var L,D,$,S,T,V,b,F,M,O,R,x,N,U;const r=p(n,f,ue);if(!r){return}const u=(L=f)===null||L===void 0?void 0:(D=L.$target)===null||D===void 0?void 0:($=D.Dimensions[0])===null||$===void 0?void 0:(S=$.$target)===null||S===void 0?void 0:(T=S.annotations)===null||T===void 0?void 0:(V=T.UI)===null||V===void 0?void 0:(b=V.Hidden)===null||b===void 0?void 0:b.valueOf();const g=(F=f)===null||F===void 0?void 0:(M=F.$target)===null||M===void 0?void 0:(O=M.Dimensions[0])===null||O===void 0?void 0:(R=O.$target)===null||R===void 0?void 0:(x=R.annotations)===null||x===void 0?void 0:(N=x.UI)===null||N===void 0?void 0:(U=N.HiddenFilter)===null||U===void 0?void 0:U.valueOf();if(u===true||g===true){return}else if(l&&l.length){var w,H,q,j,Q,k,_,z,B;a.chartAnnotation=f?n===null||n===void 0?void 0:n.getAbsoluteAnnotationPath(`${f.fullyQualifiedName}/$AnnotationPath/`):undefined;const l=n.getEntityType().name;let r;const u=n===null||n===void 0?void 0:n.getRelativeAnnotationPath(`${de.fullyQualifiedName}/`,n.getEntityType());if(ae){r=n.getContextPath()+"/"+u}else{r="/"+l+"/"+u}a.presentationAnnotation=de?r:undefined;a.outParameter=(w=P)===null||w===void 0?void 0:(H=w.LocalDataProperty)===null||H===void 0?void 0:H.value;a.inParameters=y;a.valuelistProperty=(q=P)===null||q===void 0?void 0:q.ValueListProperty;const g=s(t.getConverterContextFor(t.getAbsoluteAnnotationPath(o)).getDataModelObjectPath(),["SingleRange","MultiRange"]);if(d(g)==="true"){throw new Error("Range AllowedExpression is not supported for visual filters")}const c=s(t.getConverterContextFor(t.getAbsoluteAnnotationPath(o)).getDataModelObjectPath(),["SingleValue"]);a.multipleSelectionAllowed=d(!c.value);a.required=v(t,o);let p;if(se){var G;p=n===null||n===void 0?void 0:(G=n.getEntityTypeAnnotation(`@UI.SelectionVariant#${se}`))===null||G===void 0?void 0:G.annotation;let e;const t=n===null||n===void 0?void 0:n.getRelativeAnnotationPath(`${p.fullyQualifiedName}/`,n.getEntityType());if(ae){e=n.getContextPath()+"/"+t}else{e="/"+l+"/"+t}a.selectionVariantAnnotation=p?e:undefined}let m=[];if(ae){var J,K,W,X,Y;const o=e.split("/")[0];const i=e.split("/")[1];const n=t.getConverterContextFor(`/${o}`);const l=n===null||n===void 0?void 0:(J=n.getDataModelObjectPath().startingEntitySet)===null||J===void 0?void 0:(K=J.annotations)===null||K===void 0?void 0:(W=K.Capabilities)===null||W===void 0?void 0:(X=W.NavigationRestrictions)===null||X===void 0?void 0:X.RestrictedProperties;const a=l===null||l===void 0?void 0:l.find(e=>{var t;if(((t=e.NavigationProperty)===null||t===void 0?void 0:t.type)==="NavigationPropertyPath"){return e.NavigationProperty.value===i}});m=a===null||a===void 0?void 0:(Y=a.FilterRestrictions)===null||Y===void 0?void 0:Y.RequiredProperties}else{var Z;const e=(Z=n.getEntitySet())===null||Z===void 0?void 0:Z.annotations;if(!i.isSingleton(n.getEntitySet())){var ee,te;m=e===null||e===void 0?void 0:(ee=e.Capabilities)===null||ee===void 0?void 0:(te=ee.FilterRestrictions)===null||te===void 0?void 0:te.RequiredProperties}}let A=[];if((j=m)!==null&&j!==void 0&&j.length){m.forEach(function(e){A.push(e.value)})}A=A.concat(h);a.requiredProperties=A;if((Q=a.requiredProperties)!==null&&Q!==void 0&&Q.length){if(!a.inParameters||!a.inParameters.length){if(!a.selectionVariantAnnotation){a.showOverlayInitially=true}else{var oe,ie,ne,le;let e=((oe=p)===null||oe===void 0?void 0:(ie=oe.SelectOptions)===null||ie===void 0?void 0:ie.map(e=>e.PropertyName.value))||[];const t=((ne=p)===null||ne===void 0?void 0:(le=ne.Parameters)===null||le===void 0?void 0:le.map(e=>e.PropertyName.value))||[];e=e.concat(t);A=A.sort();e=e.sort();a.showOverlayInitially=A.some(function(t){return e.indexOf(t)===-1})}}else{a.showOverlayInitially=false}}else{a.showOverlayInitially=false}const E=(k=f)===null||k===void 0?void 0:(_=k.$target)===null||_===void 0?void 0:(z=_.Dimensions[0])===null||z===void 0?void 0:(B=z.$target)===null||B===void 0?void 0:B.type;if(!(E==="Edm.DateTimeOffset"||E==="Edm.Date"||E==="Edm.TimeOfDay")&&f.$target.ChartType==="UI.ChartType/Line"){a.renderLineChart=false}else{a.renderLineChart=true}}}else{t.getDiagnostics().addIssue(c.Annotation,g.High,u.MALFORMED_VISUALFILTERS.CHART)}}else{t.getDiagnostics().addIssue(c.Annotation,g.High,u.MALFORMED_VISUALFILTERS.PRESENTATIONVARIANT)}}else{t.getDiagnostics().addIssue(c.Annotation,g.High,u.MALFORMED_VISUALFILTERS.VALUELIST)}}else{t.getDiagnostics().addIssue(c.Manifest,g.High,u.MALFORMED_VISUALFILTERS.VALUELIST)}return a}a.getVisualFilters=P;return a},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ObjectPage/Avatar-dbg", ["sap/fe/core/helpers/BindingToolkit"], function (BindingToolkit) {
  "use strict";

  var _exports = {};
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var compileExpression = BindingToolkit.compileExpression;
  var AvatarShape;
  (function (AvatarShape) {
    AvatarShape["Circle"] = "Circle";
    AvatarShape["Square"] = "Square";
  })(AvatarShape || (AvatarShape = {}));
  const isNaturalPerson = converterContext => {
    var _converterContext$get, _converterContext$get2;
    return ((_converterContext$get = converterContext.getEntityType().annotations.Common) === null || _converterContext$get === void 0 ? void 0 : (_converterContext$get2 = _converterContext$get.IsNaturalPerson) === null || _converterContext$get2 === void 0 ? void 0 : _converterContext$get2.valueOf()) === true;
  };
  const getFallBackIcon = converterContext => {
    var _converterContext$get3, _converterContext$get4;
    const headerInfo = (_converterContext$get3 = converterContext.getEntityType().annotations) === null || _converterContext$get3 === void 0 ? void 0 : (_converterContext$get4 = _converterContext$get3.UI) === null || _converterContext$get4 === void 0 ? void 0 : _converterContext$get4.HeaderInfo;
    if (!headerInfo || headerInfo && !headerInfo.ImageUrl && !headerInfo.TypeImageUrl) {
      return undefined;
    }
    if (headerInfo.ImageUrl && headerInfo.TypeImageUrl) {
      return compileExpression(getExpressionFromAnnotation(headerInfo.TypeImageUrl));
    }
    return compileExpression(isNaturalPerson(converterContext) ? "sap-icon://person-placeholder" : "sap-icon://product");
  };
  const getSource = converterContext => {
    var _converterContext$get5, _converterContext$get6;
    const headerInfo = (_converterContext$get5 = converterContext.getEntityType().annotations) === null || _converterContext$get5 === void 0 ? void 0 : (_converterContext$get6 = _converterContext$get5.UI) === null || _converterContext$get6 === void 0 ? void 0 : _converterContext$get6.HeaderInfo;
    if (!headerInfo || !(headerInfo.ImageUrl || headerInfo.TypeImageUrl)) {
      return undefined;
    }
    return compileExpression(getExpressionFromAnnotation(headerInfo.ImageUrl || headerInfo.TypeImageUrl));
  };
  const getAvatar = converterContext => {
    var _converterContext$get7, _converterContext$get8;
    const headerInfo = (_converterContext$get7 = converterContext.getEntityType().annotations) === null || _converterContext$get7 === void 0 ? void 0 : (_converterContext$get8 = _converterContext$get7.UI) === null || _converterContext$get8 === void 0 ? void 0 : _converterContext$get8.HeaderInfo;
    const oSource = headerInfo && (headerInfo.ImageUrl || headerInfo.TypeImageUrl || headerInfo.Initials);
    if (!oSource) {
      return undefined;
    }
    return {
      src: getSource(converterContext),
      initials: compileExpression(getExpressionFromAnnotation((headerInfo === null || headerInfo === void 0 ? void 0 : headerInfo.Initials) || "")),
      fallbackIcon: getFallBackIcon(converterContext),
      displayShape: compileExpression(isNaturalPerson(converterContext) ? AvatarShape.Circle : AvatarShape.Square)
    };
  };
  _exports.getAvatar = getAvatar;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ObjectPage/Avatar", ["sap/fe/core/helpers/BindingToolkit"],function(e){"use strict";var n={};var r=e.getExpressionFromAnnotation;var i=e.compileExpression;var o;(function(e){e["Circle"]="Circle";e["Square"]="Square"})(o||(o={}));const t=e=>{var n,r;return((n=e.getEntityType().annotations.Common)===null||n===void 0?void 0:(r=n.IsNaturalPerson)===null||r===void 0?void 0:r.valueOf())===true};const a=e=>{var n,o;const a=(n=e.getEntityType().annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:o.HeaderInfo;if(!a||a&&!a.ImageUrl&&!a.TypeImageUrl){return undefined}if(a.ImageUrl&&a.TypeImageUrl){return i(r(a.TypeImageUrl))}return i(t(e)?"sap-icon://person-placeholder":"sap-icon://product")};const l=e=>{var n,o;const t=(n=e.getEntityType().annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:o.HeaderInfo;if(!t||!(t.ImageUrl||t.TypeImageUrl)){return undefined}return i(r(t.ImageUrl||t.TypeImageUrl))};const d=e=>{var n,d;const s=(n=e.getEntityType().annotations)===null||n===void 0?void 0:(d=n.UI)===null||d===void 0?void 0:d.HeaderInfo;const u=s&&(s.ImageUrl||s.TypeImageUrl||s.Initials);if(!u){return undefined}return{src:l(e),initials:i(r((s===null||s===void 0?void 0:s.Initials)||"")),fallbackIcon:a(e),displayShape:i(t(e)?o.Circle:o.Square)}};n.getAvatar=d;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ObjectPage/HeaderFacet-dbg", ["sap/fe/core/converters/annotations/DataField", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/converters/helpers/ID", "sap/fe/core/converters/helpers/Key", "sap/fe/core/helpers/BindingToolkit", "../../../helpers/StableIdHelper", "../../helpers/DataFieldHelper", "../Common/Form"], function (DataField, ConfigurableObject, ID, Key, BindingToolkit, StableIdHelper, DataFieldHelper, Form) {
  "use strict";

  var _exports = {};
  var getFormElementsFromManifest = Form.getFormElementsFromManifest;
  var FormElementType = Form.FormElementType;
  var isReferencePropertyStaticallyHidden = DataFieldHelper.isReferencePropertyStaticallyHidden;
  var isAnnotationFieldStaticallyHidden = DataFieldHelper.isAnnotationFieldStaticallyHidden;
  var createIdForAnnotation = StableIdHelper.createIdForAnnotation;
  var not = BindingToolkit.not;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var equal = BindingToolkit.equal;
  var compileExpression = BindingToolkit.compileExpression;
  var KeyHelper = Key.KeyHelper;
  var getHeaderFacetID = ID.getHeaderFacetID;
  var getHeaderFacetFormID = ID.getHeaderFacetFormID;
  var getHeaderFacetContainerID = ID.getHeaderFacetContainerID;
  var getCustomHeaderFacetID = ID.getCustomHeaderFacetID;
  var Placement = ConfigurableObject.Placement;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var getSemanticObjectPath = DataField.getSemanticObjectPath;
  // region definitions
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Definitions: Header Facet Types, Generic OP Header Facet, Manifest Properties for Custom Header Facet
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  let HeaderFacetType;
  (function (HeaderFacetType) {
    HeaderFacetType["Annotation"] = "Annotation";
    HeaderFacetType["XMLFragment"] = "XMLFragment";
  })(HeaderFacetType || (HeaderFacetType = {}));
  _exports.HeaderFacetType = HeaderFacetType;
  let FacetType;
  (function (FacetType) {
    FacetType["Reference"] = "Reference";
    FacetType["Collection"] = "Collection";
  })(FacetType || (FacetType = {}));
  _exports.FacetType = FacetType;
  let FlexDesignTimeType;
  (function (FlexDesignTimeType) {
    FlexDesignTimeType["Default"] = "Default";
    FlexDesignTimeType["NotAdaptable"] = "not-adaptable";
    FlexDesignTimeType["NotAdaptableTree"] = "not-adaptable-tree";
    FlexDesignTimeType["NotAdaptableVisibility"] = "not-adaptable-visibility";
  })(FlexDesignTimeType || (FlexDesignTimeType = {}));
  _exports.FlexDesignTimeType = FlexDesignTimeType;
  var HeaderDataPointType;
  (function (HeaderDataPointType) {
    HeaderDataPointType["ProgressIndicator"] = "ProgressIndicator";
    HeaderDataPointType["RatingIndicator"] = "RatingIndicator";
    HeaderDataPointType["Content"] = "Content";
  })(HeaderDataPointType || (HeaderDataPointType = {}));
  var TargetAnnotationType;
  (function (TargetAnnotationType) {
    TargetAnnotationType["None"] = "None";
    TargetAnnotationType["DataPoint"] = "DataPoint";
    TargetAnnotationType["Chart"] = "Chart";
    TargetAnnotationType["Identification"] = "Identification";
    TargetAnnotationType["Contact"] = "Contact";
    TargetAnnotationType["Address"] = "Address";
    TargetAnnotationType["FieldGroup"] = "FieldGroup";
  })(TargetAnnotationType || (TargetAnnotationType = {}));
  // endregion definitions

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Collect All Header Facets: Custom (via Manifest) and Annotation Based (via Metamodel)
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  /**
   * Retrieve header facets from annotations.
   *
   * @param converterContext
   * @returns Header facets from annotations
   */
  function getHeaderFacetsFromAnnotations(converterContext) {
    var _converterContext$get, _converterContext$get2, _converterContext$get3;
    const headerFacets = [];
    (_converterContext$get = converterContext.getEntityType().annotations) === null || _converterContext$get === void 0 ? void 0 : (_converterContext$get2 = _converterContext$get.UI) === null || _converterContext$get2 === void 0 ? void 0 : (_converterContext$get3 = _converterContext$get2.HeaderFacets) === null || _converterContext$get3 === void 0 ? void 0 : _converterContext$get3.forEach(facet => {
      const headerFacet = createHeaderFacet(facet, converterContext);
      if (headerFacet) {
        headerFacets.push(headerFacet);
      }
    });
    return headerFacets;
  }

  /**
   * Retrieve custom header facets from manifest.
   *
   * @param manifestCustomHeaderFacets
   * @returns HeaderFacets from manifest
   */
  _exports.getHeaderFacetsFromAnnotations = getHeaderFacetsFromAnnotations;
  function getHeaderFacetsFromManifest(manifestCustomHeaderFacets) {
    const customHeaderFacets = {};
    Object.keys(manifestCustomHeaderFacets).forEach(manifestHeaderFacetKey => {
      const customHeaderFacet = manifestCustomHeaderFacets[manifestHeaderFacetKey];
      customHeaderFacets[manifestHeaderFacetKey] = createCustomHeaderFacet(customHeaderFacet, manifestHeaderFacetKey);
    });
    return customHeaderFacets;
  }

  /**
   * Retrieve stashed settings for header facets from manifest.
   *
   * @param facetDefinition
   * @param collectionFacetDefinition
   * @param converterContext
   * @returns Stashed setting for header facet or false
   */
  _exports.getHeaderFacetsFromManifest = getHeaderFacetsFromManifest;
  function getStashedSettingsForHeaderFacet(facetDefinition, collectionFacetDefinition, converterContext) {
    var _headerFacetsControlC;
    // When a HeaderFacet is nested inside a CollectionFacet, stashing is not supported
    if (facetDefinition.$Type === "com.sap.vocabularies.UI.v1.ReferenceFacet" && collectionFacetDefinition.$Type === "com.sap.vocabularies.UI.v1.CollectionFacet") {
      return false;
    }
    const headerFacetID = createIdForAnnotation(facetDefinition) ?? "";
    const headerFacetsControlConfig = converterContext.getManifestWrapper().getHeaderFacets();
    const stashedSetting = (_headerFacetsControlC = headerFacetsControlConfig[headerFacetID]) === null || _headerFacetsControlC === void 0 ? void 0 : _headerFacetsControlC.stashed;
    return stashedSetting === true;
  }

  /**
   * Retrieve flexibility designtime settings from manifest.
   *
   * @param facetDefinition
   * @param collectionFacetDefinition
   * @param converterContext
   * @returns Designtime setting or default
   */
  _exports.getStashedSettingsForHeaderFacet = getStashedSettingsForHeaderFacet;
  function getDesignTimeMetadataSettingsForHeaderFacet(facetDefinition, collectionFacetDefinition, converterContext) {
    let designTimeMetadata = FlexDesignTimeType.Default;
    const headerFacetID = createIdForAnnotation(facetDefinition);

    // For HeaderFacets nested inside CollectionFacet RTA should be disabled, therefore set to "not-adaptable-tree"
    if (facetDefinition.$Type === "com.sap.vocabularies.UI.v1.ReferenceFacet" && collectionFacetDefinition.$Type === "com.sap.vocabularies.UI.v1.CollectionFacet") {
      designTimeMetadata = FlexDesignTimeType.NotAdaptableTree;
    } else {
      const headerFacetsControlConfig = converterContext.getManifestWrapper().getHeaderFacets();
      if (headerFacetID) {
        var _headerFacetsControlC2, _headerFacetsControlC3;
        const designTime = (_headerFacetsControlC2 = headerFacetsControlConfig[headerFacetID]) === null || _headerFacetsControlC2 === void 0 ? void 0 : (_headerFacetsControlC3 = _headerFacetsControlC2.flexSettings) === null || _headerFacetsControlC3 === void 0 ? void 0 : _headerFacetsControlC3.designtime;
        switch (designTime) {
          case FlexDesignTimeType.NotAdaptable:
          case FlexDesignTimeType.NotAdaptableTree:
          case FlexDesignTimeType.NotAdaptableVisibility:
            designTimeMetadata = designTime;
            break;
          default:
            break;
        }
      }
    }
    return designTimeMetadata;
  }

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Convert & Build Annotation Based Header Facets
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  _exports.getDesignTimeMetadataSettingsForHeaderFacet = getDesignTimeMetadataSettingsForHeaderFacet;
  function createReferenceHeaderFacet(facetDefinition, collectionFacetDefinition, converterContext) {
    var _facetDefinition$anno, _facetDefinition$anno2, _facetDefinition$anno3;
    if (facetDefinition.$Type === "com.sap.vocabularies.UI.v1.ReferenceFacet" && !(((_facetDefinition$anno = facetDefinition.annotations) === null || _facetDefinition$anno === void 0 ? void 0 : (_facetDefinition$anno2 = _facetDefinition$anno.UI) === null || _facetDefinition$anno2 === void 0 ? void 0 : (_facetDefinition$anno3 = _facetDefinition$anno2.Hidden) === null || _facetDefinition$anno3 === void 0 ? void 0 : _facetDefinition$anno3.valueOf()) === true)) {
      var _facetDefinition$Targ, _facetDefinition$Targ2;
      const headerFacetID = getHeaderFacetID(facetDefinition),
        getHeaderFacetKey = (facetDefinitionToCheck, fallback) => {
          var _facetDefinitionToChe, _facetDefinitionToChe2;
          return ((_facetDefinitionToChe = facetDefinitionToCheck.ID) === null || _facetDefinitionToChe === void 0 ? void 0 : _facetDefinitionToChe.toString()) || ((_facetDefinitionToChe2 = facetDefinitionToCheck.Label) === null || _facetDefinitionToChe2 === void 0 ? void 0 : _facetDefinitionToChe2.toString()) || fallback;
        },
        targetAnnotationValue = facetDefinition.Target.value,
        targetAnnotationType = getTargetAnnotationType(facetDefinition);
      let headerFormData;
      let headerDataPointData;
      switch (targetAnnotationType) {
        case TargetAnnotationType.FieldGroup:
          headerFormData = getFieldGroupFormData(facetDefinition, converterContext);
          break;
        case TargetAnnotationType.DataPoint:
          headerDataPointData = getDataPointData(facetDefinition, converterContext);
          break;
        // ToDo: Handle other cases
        default:
          break;
      }
      const {
        annotations
      } = facetDefinition;
      if (((_facetDefinition$Targ = facetDefinition.Target) === null || _facetDefinition$Targ === void 0 ? void 0 : (_facetDefinition$Targ2 = _facetDefinition$Targ.$target) === null || _facetDefinition$Targ2 === void 0 ? void 0 : _facetDefinition$Targ2.term) === "com.sap.vocabularies.UI.v1.Chart" && isAnnotationFieldStaticallyHidden(facetDefinition)) {
        return undefined;
      } else {
        var _annotations$UI, _annotations$UI$Hidde;
        return {
          type: HeaderFacetType.Annotation,
          facetType: FacetType.Reference,
          id: headerFacetID,
          containerId: getHeaderFacetContainerID(facetDefinition),
          key: getHeaderFacetKey(facetDefinition, headerFacetID),
          flexSettings: {
            designtime: getDesignTimeMetadataSettingsForHeaderFacet(facetDefinition, collectionFacetDefinition, converterContext)
          },
          stashed: getStashedSettingsForHeaderFacet(facetDefinition, collectionFacetDefinition, converterContext),
          visible: compileExpression(not(equal(getExpressionFromAnnotation(annotations === null || annotations === void 0 ? void 0 : (_annotations$UI = annotations.UI) === null || _annotations$UI === void 0 ? void 0 : (_annotations$UI$Hidde = _annotations$UI.Hidden) === null || _annotations$UI$Hidde === void 0 ? void 0 : _annotations$UI$Hidde.valueOf()), true))),
          annotationPath: `${converterContext.getEntitySetBasedAnnotationPath(facetDefinition.fullyQualifiedName)}/`,
          targetAnnotationValue,
          targetAnnotationType,
          headerFormData,
          headerDataPointData
        };
      }
    }
    return undefined;
  }
  function createCollectionHeaderFacet(collectionFacetDefinition, converterContext) {
    if (collectionFacetDefinition.$Type === "com.sap.vocabularies.UI.v1.CollectionFacet") {
      var _collectionFacetDefin, _collectionFacetDefin2, _collectionFacetDefin3;
      const facets = [],
        headerFacetID = getHeaderFacetID(collectionFacetDefinition),
        getHeaderFacetKey = (facetDefinition, fallback) => {
          var _facetDefinition$ID, _facetDefinition$Labe;
          return ((_facetDefinition$ID = facetDefinition.ID) === null || _facetDefinition$ID === void 0 ? void 0 : _facetDefinition$ID.toString()) || ((_facetDefinition$Labe = facetDefinition.Label) === null || _facetDefinition$Labe === void 0 ? void 0 : _facetDefinition$Labe.toString()) || fallback;
        };
      collectionFacetDefinition.Facets.forEach(facetDefinition => {
        const facet = createReferenceHeaderFacet(facetDefinition, collectionFacetDefinition, converterContext);
        if (facet) {
          facets.push(facet);
        }
      });
      return {
        type: HeaderFacetType.Annotation,
        facetType: FacetType.Collection,
        id: headerFacetID,
        containerId: getHeaderFacetContainerID(collectionFacetDefinition),
        key: getHeaderFacetKey(collectionFacetDefinition, headerFacetID),
        flexSettings: {
          designtime: getDesignTimeMetadataSettingsForHeaderFacet(collectionFacetDefinition, collectionFacetDefinition, converterContext)
        },
        stashed: getStashedSettingsForHeaderFacet(collectionFacetDefinition, collectionFacetDefinition, converterContext),
        visible: compileExpression(not(equal(getExpressionFromAnnotation((_collectionFacetDefin = collectionFacetDefinition.annotations) === null || _collectionFacetDefin === void 0 ? void 0 : (_collectionFacetDefin2 = _collectionFacetDefin.UI) === null || _collectionFacetDefin2 === void 0 ? void 0 : (_collectionFacetDefin3 = _collectionFacetDefin2.Hidden) === null || _collectionFacetDefin3 === void 0 ? void 0 : _collectionFacetDefin3.valueOf()), true))),
        annotationPath: `${converterContext.getEntitySetBasedAnnotationPath(collectionFacetDefinition.fullyQualifiedName)}/`,
        facets
      };
    }
    return undefined;
  }
  function getTargetAnnotationType(facetDefinition) {
    let annotationType = TargetAnnotationType.None;
    const annotationTypeMap = {
      "com.sap.vocabularies.UI.v1.DataPoint": TargetAnnotationType.DataPoint,
      "com.sap.vocabularies.UI.v1.Chart": TargetAnnotationType.Chart,
      "com.sap.vocabularies.UI.v1.Identification": TargetAnnotationType.Identification,
      "com.sap.vocabularies.Communication.v1.Contact": TargetAnnotationType.Contact,
      "com.sap.vocabularies.Communication.v1.Address": TargetAnnotationType.Address,
      "com.sap.vocabularies.UI.v1.FieldGroup": TargetAnnotationType.FieldGroup
    };
    // ReferenceURLFacet and CollectionFacet do not have Target property.
    if (facetDefinition.$Type !== "com.sap.vocabularies.UI.v1.ReferenceURLFacet" && facetDefinition.$Type !== "com.sap.vocabularies.UI.v1.CollectionFacet") {
      var _facetDefinition$Targ3, _facetDefinition$Targ4;
      annotationType = annotationTypeMap[(_facetDefinition$Targ3 = facetDefinition.Target) === null || _facetDefinition$Targ3 === void 0 ? void 0 : (_facetDefinition$Targ4 = _facetDefinition$Targ3.$target) === null || _facetDefinition$Targ4 === void 0 ? void 0 : _facetDefinition$Targ4.term] || TargetAnnotationType.None;
    }
    return annotationType;
  }
  function getFieldGroupFormData(facetDefinition, converterContext) {
    var _facetDefinition$Labe2;
    // split in this from annotation + getFieldGroupFromDefault
    if (!facetDefinition) {
      throw new Error("Cannot get FieldGroup form data without facet definition");
    }
    const formElements = insertCustomElements(getFormElementsFromAnnotations(facetDefinition, converterContext), getFormElementsFromManifest(facetDefinition, converterContext));
    return {
      id: getHeaderFacetFormID(facetDefinition),
      label: (_facetDefinition$Labe2 = facetDefinition.Label) === null || _facetDefinition$Labe2 === void 0 ? void 0 : _facetDefinition$Labe2.toString(),
      formElements
    };
  }

  /**
   * Creates an array of manifest-based FormElements.
   *
   * @param facetDefinition The definition of the facet
   * @param converterContext The converter context for the facet
   * @returns Annotation-based FormElements
   */
  function getFormElementsFromAnnotations(facetDefinition, converterContext) {
    const annotationBasedFormElements = [];

    // ReferenceURLFacet and CollectionFacet do not have Target property.
    if (facetDefinition.$Type !== "com.sap.vocabularies.UI.v1.ReferenceURLFacet" && facetDefinition.$Type !== "com.sap.vocabularies.UI.v1.CollectionFacet") {
      var _facetDefinition$Targ5, _facetDefinition$Targ6;
      (_facetDefinition$Targ5 = facetDefinition.Target) === null || _facetDefinition$Targ5 === void 0 ? void 0 : (_facetDefinition$Targ6 = _facetDefinition$Targ5.$target) === null || _facetDefinition$Targ6 === void 0 ? void 0 : _facetDefinition$Targ6.Data.forEach(dataField => {
        var _dataField$annotation, _dataField$annotation2, _dataField$annotation3;
        if (!(((_dataField$annotation = dataField.annotations) === null || _dataField$annotation === void 0 ? void 0 : (_dataField$annotation2 = _dataField$annotation.UI) === null || _dataField$annotation2 === void 0 ? void 0 : (_dataField$annotation3 = _dataField$annotation2.Hidden) === null || _dataField$annotation3 === void 0 ? void 0 : _dataField$annotation3.valueOf()) === true)) {
          const semanticObjectAnnotationPath = getSemanticObjectPath(converterContext, dataField);
          if ((dataField.$Type === "com.sap.vocabularies.UI.v1.DataField" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithUrl" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation" || dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldWithAction") && !isReferencePropertyStaticallyHidden(dataField)) {
            var _dataField$Value, _dataField$Value$$tar, _dataField$Value$$tar2, _dataField$Value$$tar3, _dataField$Value$$tar4, _annotations$UI2, _annotations$UI2$Hidd, _dataField$Value2, _dataField$Value2$$ta, _dataField$Value2$$ta2, _dataField$Value2$$ta3;
            const {
              annotations
            } = dataField;
            annotationBasedFormElements.push({
              isValueMultilineText: ((_dataField$Value = dataField.Value) === null || _dataField$Value === void 0 ? void 0 : (_dataField$Value$$tar = _dataField$Value.$target) === null || _dataField$Value$$tar === void 0 ? void 0 : (_dataField$Value$$tar2 = _dataField$Value$$tar.annotations) === null || _dataField$Value$$tar2 === void 0 ? void 0 : (_dataField$Value$$tar3 = _dataField$Value$$tar2.UI) === null || _dataField$Value$$tar3 === void 0 ? void 0 : (_dataField$Value$$tar4 = _dataField$Value$$tar3.MultiLineText) === null || _dataField$Value$$tar4 === void 0 ? void 0 : _dataField$Value$$tar4.valueOf()) === true,
              type: FormElementType.Annotation,
              key: KeyHelper.generateKeyFromDataField(dataField),
              visible: compileExpression(not(equal(getExpressionFromAnnotation(annotations === null || annotations === void 0 ? void 0 : (_annotations$UI2 = annotations.UI) === null || _annotations$UI2 === void 0 ? void 0 : (_annotations$UI2$Hidd = _annotations$UI2.Hidden) === null || _annotations$UI2$Hidd === void 0 ? void 0 : _annotations$UI2$Hidd.valueOf()), true))),
              label: ((_dataField$Value2 = dataField.Value) === null || _dataField$Value2 === void 0 ? void 0 : (_dataField$Value2$$ta = _dataField$Value2.$target) === null || _dataField$Value2$$ta === void 0 ? void 0 : (_dataField$Value2$$ta2 = _dataField$Value2$$ta.annotations) === null || _dataField$Value2$$ta2 === void 0 ? void 0 : (_dataField$Value2$$ta3 = _dataField$Value2$$ta2.Common) === null || _dataField$Value2$$ta3 === void 0 ? void 0 : _dataField$Value2$$ta3.Label) || dataField.Label,
              idPrefix: getHeaderFacetFormID(facetDefinition, dataField),
              annotationPath: `${converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName)}/`,
              semanticObjectPath: semanticObjectAnnotationPath
            });
          } else if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && !isReferencePropertyStaticallyHidden(dataField)) {
            var _dataField$Target, _dataField$Target$$ta, _dataField$Target$$ta2, _dataField$Target$$ta3, _dataField$Target$$ta4, _annotations$UI3, _annotations$UI3$Hidd, _dataField$Target2, _dataField$Target2$$t, _dataField$Target2$$t2, _dataField$Target2$$t3, _dataField$Target2$$t4, _dataField$Label;
            const {
              annotations
            } = dataField;
            annotationBasedFormElements.push({
              // FIXME this is wrong, the annotation should exist, so the target is not properly identified
              isValueMultilineText: ((_dataField$Target = dataField.Target) === null || _dataField$Target === void 0 ? void 0 : (_dataField$Target$$ta = _dataField$Target.$target) === null || _dataField$Target$$ta === void 0 ? void 0 : (_dataField$Target$$ta2 = _dataField$Target$$ta.annotations) === null || _dataField$Target$$ta2 === void 0 ? void 0 : (_dataField$Target$$ta3 = _dataField$Target$$ta2.UI) === null || _dataField$Target$$ta3 === void 0 ? void 0 : (_dataField$Target$$ta4 = _dataField$Target$$ta3.MultiLineText) === null || _dataField$Target$$ta4 === void 0 ? void 0 : _dataField$Target$$ta4.valueOf()) === true,
              type: FormElementType.Annotation,
              key: KeyHelper.generateKeyFromDataField(dataField),
              visible: compileExpression(not(equal(getExpressionFromAnnotation(annotations === null || annotations === void 0 ? void 0 : (_annotations$UI3 = annotations.UI) === null || _annotations$UI3 === void 0 ? void 0 : (_annotations$UI3$Hidd = _annotations$UI3.Hidden) === null || _annotations$UI3$Hidd === void 0 ? void 0 : _annotations$UI3$Hidd.valueOf()), true))),
              label: ((_dataField$Target2 = dataField.Target) === null || _dataField$Target2 === void 0 ? void 0 : (_dataField$Target2$$t = _dataField$Target2.$target) === null || _dataField$Target2$$t === void 0 ? void 0 : (_dataField$Target2$$t2 = _dataField$Target2$$t.annotations) === null || _dataField$Target2$$t2 === void 0 ? void 0 : (_dataField$Target2$$t3 = _dataField$Target2$$t2.Common) === null || _dataField$Target2$$t3 === void 0 ? void 0 : (_dataField$Target2$$t4 = _dataField$Target2$$t3.Label) === null || _dataField$Target2$$t4 === void 0 ? void 0 : _dataField$Target2$$t4.toString()) || ((_dataField$Label = dataField.Label) === null || _dataField$Label === void 0 ? void 0 : _dataField$Label.toString()),
              idPrefix: getHeaderFacetFormID(facetDefinition, dataField),
              annotationPath: `${converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName)}/`,
              semanticObjectPath: semanticObjectAnnotationPath
            });
          }
        }
      });
    }
    return annotationBasedFormElements;
  }
  function getDataPointData(facetDefinition, converterContext) {
    let type = HeaderDataPointType.Content;
    let semanticObjectPath;
    if (facetDefinition.$Type === "com.sap.vocabularies.UI.v1.ReferenceFacet" && !isAnnotationFieldStaticallyHidden(facetDefinition)) {
      var _facetDefinition$Targ7, _facetDefinition$Targ8, _facetDefinition$Targ9, _facetDefinition$Targ10, _facetDefinition$Targ11;
      if (((_facetDefinition$Targ7 = facetDefinition.Target) === null || _facetDefinition$Targ7 === void 0 ? void 0 : (_facetDefinition$Targ8 = _facetDefinition$Targ7.$target) === null || _facetDefinition$Targ8 === void 0 ? void 0 : _facetDefinition$Targ8.Visualization) === "UI.VisualizationType/Progress") {
        type = HeaderDataPointType.ProgressIndicator;
      } else if (((_facetDefinition$Targ9 = facetDefinition.Target) === null || _facetDefinition$Targ9 === void 0 ? void 0 : (_facetDefinition$Targ10 = _facetDefinition$Targ9.$target) === null || _facetDefinition$Targ10 === void 0 ? void 0 : _facetDefinition$Targ10.Visualization) === "UI.VisualizationType/Rating") {
        type = HeaderDataPointType.RatingIndicator;
      }
      const dataPoint = (_facetDefinition$Targ11 = facetDefinition.Target) === null || _facetDefinition$Targ11 === void 0 ? void 0 : _facetDefinition$Targ11.$target;
      if (typeof dataPoint === "object") {
        var _dataPoint$Value;
        if (dataPoint !== null && dataPoint !== void 0 && (_dataPoint$Value = dataPoint.Value) !== null && _dataPoint$Value !== void 0 && _dataPoint$Value.$target) {
          var _property$annotations, _property$annotations2;
          const property = dataPoint.Value.$target;
          if ((property === null || property === void 0 ? void 0 : (_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : (_property$annotations2 = _property$annotations.Common) === null || _property$annotations2 === void 0 ? void 0 : _property$annotations2.SemanticObject) !== undefined) {
            semanticObjectPath = converterContext.getEntitySetBasedAnnotationPath(property === null || property === void 0 ? void 0 : property.fullyQualifiedName);
          }
        }
      }
    }
    return {
      type,
      semanticObjectPath
    };
  }

  /**
   * Creates an annotation-based header facet.
   *
   * @param facetDefinition The definition of the facet
   * @param converterContext The converter context
   * @returns The created annotation-based header facet
   */
  function createHeaderFacet(facetDefinition, converterContext) {
    let headerFacet;
    switch (facetDefinition.$Type) {
      case "com.sap.vocabularies.UI.v1.ReferenceFacet":
        headerFacet = createReferenceHeaderFacet(facetDefinition, facetDefinition, converterContext);
        break;
      case "com.sap.vocabularies.UI.v1.CollectionFacet":
        headerFacet = createCollectionHeaderFacet(facetDefinition, converterContext);
        break;
      default:
        break;
    }
    return headerFacet;
  }

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Convert & Build Manifest Based Header Facets
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  function generateBinding(requestGroupId) {
    if (!requestGroupId) {
      return undefined;
    }
    const groupId = ["Heroes", "Decoration", "Workers", "LongRunners"].indexOf(requestGroupId) !== -1 ? `$auto.${requestGroupId}` : requestGroupId;
    return `{ path : '', parameters : { $$groupId : '${groupId}' } }`;
  }

  /**
   * Create a manifest based custom header facet.
   *
   * @param customHeaderFacetDefinition
   * @param headerFacetKey
   * @returns The manifest based custom header facet created
   */
  function createCustomHeaderFacet(customHeaderFacetDefinition, headerFacetKey) {
    const customHeaderFacetID = getCustomHeaderFacetID(headerFacetKey);
    let position = customHeaderFacetDefinition.position;
    if (!position) {
      position = {
        placement: Placement.After
      };
    }
    // TODO for an non annotation fragment the name is mandatory -> Not checked
    return {
      facetType: FacetType.Reference,
      facets: [],
      type: customHeaderFacetDefinition.type,
      id: customHeaderFacetID,
      containerId: customHeaderFacetID,
      key: headerFacetKey,
      position: position,
      visible: customHeaderFacetDefinition.visible,
      fragmentName: customHeaderFacetDefinition.template || customHeaderFacetDefinition.name,
      title: customHeaderFacetDefinition.title,
      subTitle: customHeaderFacetDefinition.subTitle,
      stashed: customHeaderFacetDefinition.stashed || false,
      flexSettings: {
        ...{
          designtime: FlexDesignTimeType.Default
        },
        ...customHeaderFacetDefinition.flexSettings
      },
      binding: generateBinding(customHeaderFacetDefinition.requestGroupId),
      templateEdit: customHeaderFacetDefinition.templateEdit
    };
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ObjectPage/HeaderFacet", ["sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","../../../helpers/StableIdHelper","../../helpers/DataFieldHelper","../Common/Form"],function(e,t,a,i,o,n,l,r){"use strict";var d={};var v=r.getFormElementsFromManifest;var s=r.FormElementType;var c=l.isReferencePropertyStaticallyHidden;var u=l.isAnnotationFieldStaticallyHidden;var f=n.createIdForAnnotation;var p=o.not;var m=o.getExpressionFromAnnotation;var g=o.equal;var b=o.compileExpression;var y=i.KeyHelper;var F=a.getHeaderFacetID;var I=a.getHeaderFacetFormID;var h=a.getHeaderFacetContainerID;var T=a.getCustomHeaderFacetID;var $=t.Placement;var U=t.insertCustomElements;var D=e.getSemanticObjectPath;let C;(function(e){e["Annotation"]="Annotation";e["XMLFragment"]="XMLFragment"})(C||(C={}));d.HeaderFacetType=C;let A;(function(e){e["Reference"]="Reference";e["Collection"]="Collection"})(A||(A={}));d.FacetType=A;let P;(function(e){e["Default"]="Default";e["NotAdaptable"]="not-adaptable";e["NotAdaptableTree"]="not-adaptable-tree";e["NotAdaptableVisibility"]="not-adaptable-visibility"})(P||(P={}));d.FlexDesignTimeType=P;var S;(function(e){e["ProgressIndicator"]="ProgressIndicator";e["RatingIndicator"]="RatingIndicator";e["Content"]="Content"})(S||(S={}));var H;(function(e){e["None"]="None";e["DataPoint"]="DataPoint";e["Chart"]="Chart";e["Identification"]="Identification";e["Contact"]="Contact";e["Address"]="Address";e["FieldGroup"]="FieldGroup"})(H||(H={}));function E(e){var t,a,i;const o=[];(t=e.getEntityType().annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(i=a.HeaderFacets)===null||i===void 0?void 0:i.forEach(t=>{const a=B(t,e);if(a){o.push(a)}});return o}d.getHeaderFacetsFromAnnotations=E;function N(e){const t={};Object.keys(e).forEach(a=>{const i=e[a];t[a]=W(i,a)});return t}d.getHeaderFacetsFromManifest=N;function R(e,t,a){var i;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return false}const o=f(e)??"";const n=a.getManifestWrapper().getHeaderFacets();const l=(i=n[o])===null||i===void 0?void 0:i.stashed;return l===true}d.getStashedSettingsForHeaderFacet=R;function k(e,t,a){let i=P.Default;const o=f(e);if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){i=P.NotAdaptableTree}else{const e=a.getManifestWrapper().getHeaderFacets();if(o){var n,l;const t=(n=e[o])===null||n===void 0?void 0:(l=n.flexSettings)===null||l===void 0?void 0:l.designtime;switch(t){case P.NotAdaptable:case P.NotAdaptableTree:case P.NotAdaptableVisibility:i=t;break;default:break}}}return i}d.getDesignTimeMetadataSettingsForHeaderFacet=k;function O(e,t,a){var i,o,n;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!(((i=e.annotations)===null||i===void 0?void 0:(o=i.UI)===null||o===void 0?void 0:(n=o.Hidden)===null||n===void 0?void 0:n.valueOf())===true)){var l,r;const i=F(e),o=(e,t)=>{var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t},n=e.Target.value,s=L(e);let c;let f;switch(s){case H.FieldGroup:c=V(e,a);break;case H.DataPoint:f=j(e,a);break;default:break}const{annotations:y}=e;if(((l=e.Target)===null||l===void 0?void 0:(r=l.$target)===null||r===void 0?void 0:r.term)==="com.sap.vocabularies.UI.v1.Chart"&&u(e)){return undefined}else{var d,v;return{type:C.Annotation,facetType:A.Reference,id:i,containerId:h(e),key:o(e,i),flexSettings:{designtime:k(e,t,a)},stashed:R(e,t,a),visible:b(p(g(m(y===null||y===void 0?void 0:(d=y.UI)===null||d===void 0?void 0:(v=d.Hidden)===null||v===void 0?void 0:v.valueOf()),true))),annotationPath:`${a.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,targetAnnotationValue:n,targetAnnotationType:s,headerFormData:c,headerDataPointData:f}}}return undefined}function x(e,t){if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){var a,i,o;const n=[],l=F(e),r=(e,t)=>{var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t};e.Facets.forEach(a=>{const i=O(a,e,t);if(i){n.push(i)}});return{type:C.Annotation,facetType:A.Collection,id:l,containerId:h(e),key:r(e,l),flexSettings:{designtime:k(e,e,t)},stashed:R(e,e,t),visible:b(p(g(m((a=e.annotations)===null||a===void 0?void 0:(i=a.UI)===null||i===void 0?void 0:(o=i.Hidden)===null||o===void 0?void 0:o.valueOf()),true))),annotationPath:`${t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,facets:n}}return undefined}function L(e){let t=H.None;const a={"com.sap.vocabularies.UI.v1.DataPoint":H.DataPoint,"com.sap.vocabularies.UI.v1.Chart":H.Chart,"com.sap.vocabularies.UI.v1.Identification":H.Identification,"com.sap.vocabularies.Communication.v1.Contact":H.Contact,"com.sap.vocabularies.Communication.v1.Address":H.Address,"com.sap.vocabularies.UI.v1.FieldGroup":H.FieldGroup};if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){var i,o;t=a[(i=e.Target)===null||i===void 0?void 0:(o=i.$target)===null||o===void 0?void 0:o.term]||H.None}return t}function V(e,t){var a;if(!e){throw new Error("Cannot get FieldGroup form data without facet definition")}const i=U(M(e,t),v(e,t));return{id:I(e),label:(a=e.Label)===null||a===void 0?void 0:a.toString(),formElements:i}}function M(e,t){const a=[];if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){var i,o;(i=e.Target)===null||i===void 0?void 0:(o=i.$target)===null||o===void 0?void 0:o.Data.forEach(i=>{var o,n,l;if(!(((o=i.annotations)===null||o===void 0?void 0:(n=o.UI)===null||n===void 0?void 0:(l=n.Hidden)===null||l===void 0?void 0:l.valueOf())===true)){const o=D(t,i);if((i.$Type==="com.sap.vocabularies.UI.v1.DataField"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")&&!c(i)){var r,d,v,u,f,F,h,T,$,U,C;const{annotations:n}=i;a.push({isValueMultilineText:((r=i.Value)===null||r===void 0?void 0:(d=r.$target)===null||d===void 0?void 0:(v=d.annotations)===null||v===void 0?void 0:(u=v.UI)===null||u===void 0?void 0:(f=u.MultiLineText)===null||f===void 0?void 0:f.valueOf())===true,type:s.Annotation,key:y.generateKeyFromDataField(i),visible:b(p(g(m(n===null||n===void 0?void 0:(F=n.UI)===null||F===void 0?void 0:(h=F.Hidden)===null||h===void 0?void 0:h.valueOf()),true))),label:((T=i.Value)===null||T===void 0?void 0:($=T.$target)===null||$===void 0?void 0:(U=$.annotations)===null||U===void 0?void 0:(C=U.Common)===null||C===void 0?void 0:C.Label)||i.Label,idPrefix:I(e,i),annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`,semanticObjectPath:o})}else if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&!c(i)){var A,P,S,H,E,N,R,k,O,x,L,V,M;const{annotations:n}=i;a.push({isValueMultilineText:((A=i.Target)===null||A===void 0?void 0:(P=A.$target)===null||P===void 0?void 0:(S=P.annotations)===null||S===void 0?void 0:(H=S.UI)===null||H===void 0?void 0:(E=H.MultiLineText)===null||E===void 0?void 0:E.valueOf())===true,type:s.Annotation,key:y.generateKeyFromDataField(i),visible:b(p(g(m(n===null||n===void 0?void 0:(N=n.UI)===null||N===void 0?void 0:(R=N.Hidden)===null||R===void 0?void 0:R.valueOf()),true))),label:((k=i.Target)===null||k===void 0?void 0:(O=k.$target)===null||O===void 0?void 0:(x=O.annotations)===null||x===void 0?void 0:(L=x.Common)===null||L===void 0?void 0:(V=L.Label)===null||V===void 0?void 0:V.toString())||((M=i.Label)===null||M===void 0?void 0:M.toString()),idPrefix:I(e,i),annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`,semanticObjectPath:o})}}})}return a}function j(e,t){let a=S.Content;let i;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!u(e)){var o,n,l,r,d;if(((o=e.Target)===null||o===void 0?void 0:(n=o.$target)===null||n===void 0?void 0:n.Visualization)==="UI.VisualizationType/Progress"){a=S.ProgressIndicator}else if(((l=e.Target)===null||l===void 0?void 0:(r=l.$target)===null||r===void 0?void 0:r.Visualization)==="UI.VisualizationType/Rating"){a=S.RatingIndicator}const u=(d=e.Target)===null||d===void 0?void 0:d.$target;if(typeof u==="object"){var v;if(u!==null&&u!==void 0&&(v=u.Value)!==null&&v!==void 0&&v.$target){var s,c;const e=u.Value.$target;if((e===null||e===void 0?void 0:(s=e.annotations)===null||s===void 0?void 0:(c=s.Common)===null||c===void 0?void 0:c.SemanticObject)!==undefined){i=t.getEntitySetBasedAnnotationPath(e===null||e===void 0?void 0:e.fullyQualifiedName)}}}}return{type:a,semanticObjectPath:i}}function B(e,t){let a;switch(e.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":a=O(e,e,t);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":a=x(e,t);break;default:break}return a}function G(e){if(!e){return undefined}const t=["Heroes","Decoration","Workers","LongRunners"].indexOf(e)!==-1?`$auto.${e}`:e;return`{ path : '', parameters : { $$groupId : '${t}' } }`}function W(e,t){const a=T(t);let i=e.position;if(!i){i={placement:$.After}}return{facetType:A.Reference,facets:[],type:e.type,id:a,containerId:a,key:t,position:i,visible:e.visible,fragmentName:e.template||e.name,title:e.title,subTitle:e.subTitle,stashed:e.stashed||false,flexSettings:{...{designtime:P.Default},...e.flexSettings},binding:G(e.requestGroupId),templateEdit:e.templateEdit}}return d},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ObjectPage/SubSection-dbg", ["sap/base/Log", "sap/fe/core/converters/controls/Common/Action", "sap/fe/core/converters/controls/ObjectPage/HeaderFacet", "sap/fe/core/converters/helpers/IssueManager", "sap/fe/core/converters/helpers/Key", "sap/fe/core/helpers/BindingToolkit", "../../helpers/ConfigurableObject", "../../helpers/ID", "../../ManifestSettings", "../../objectPage/FormMenuActions", "../Common/DataVisualization", "../Common/Form"], function (Log, Action, HeaderFacet, IssueManager, Key, BindingToolkit, ConfigurableObject, ID, ManifestSettings, FormMenuActions, DataVisualization, Form) {
  "use strict";

  var _exports = {};
  var isReferenceFacet = Form.isReferenceFacet;
  var createFormDefinition = Form.createFormDefinition;
  var getDataVisualizationConfiguration = DataVisualization.getDataVisualizationConfiguration;
  var getVisibilityEnablementFormMenuActions = FormMenuActions.getVisibilityEnablementFormMenuActions;
  var getFormHiddenActions = FormMenuActions.getFormHiddenActions;
  var getFormActions = FormMenuActions.getFormActions;
  var ActionType = ManifestSettings.ActionType;
  var getSubSectionID = ID.getSubSectionID;
  var getSideContentID = ID.getSideContentID;
  var getFormID = ID.getFormID;
  var getCustomSubSectionID = ID.getCustomSubSectionID;
  var Placement = ConfigurableObject.Placement;
  var OverrideType = ConfigurableObject.OverrideType;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var resolveBindingString = BindingToolkit.resolveBindingString;
  var ref = BindingToolkit.ref;
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var notEqual = BindingToolkit.notEqual;
  var not = BindingToolkit.not;
  var ifElse = BindingToolkit.ifElse;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var fn = BindingToolkit.fn;
  var equal = BindingToolkit.equal;
  var compileExpression = BindingToolkit.compileExpression;
  var KeyHelper = Key.KeyHelper;
  var IssueType = IssueManager.IssueType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategory = IssueManager.IssueCategory;
  var getStashedSettingsForHeaderFacet = HeaderFacet.getStashedSettingsForHeaderFacet;
  var getHeaderFacetsFromManifest = HeaderFacet.getHeaderFacetsFromManifest;
  var getDesignTimeMetadataSettingsForHeaderFacet = HeaderFacet.getDesignTimeMetadataSettingsForHeaderFacet;
  var removeDuplicateActions = Action.removeDuplicateActions;
  var isActionNavigable = Action.isActionNavigable;
  var getSemanticObjectMapping = Action.getSemanticObjectMapping;
  var getEnabledForAnnotationAction = Action.getEnabledForAnnotationAction;
  var getActionsFromManifest = Action.getActionsFromManifest;
  var ButtonType = Action.ButtonType;
  let SubSectionType;
  (function (SubSectionType) {
    SubSectionType["Unknown"] = "Unknown";
    SubSectionType["Form"] = "Form";
    SubSectionType["DataVisualization"] = "DataVisualization";
    SubSectionType["XMLFragment"] = "XMLFragment";
    SubSectionType["Placeholder"] = "Placeholder";
    SubSectionType["Mixed"] = "Mixed";
  })(SubSectionType || (SubSectionType = {}));
  _exports.SubSectionType = SubSectionType;
  const visualizationTerms = ["com.sap.vocabularies.UI.v1.LineItem", "com.sap.vocabularies.UI.v1.Chart", "com.sap.vocabularies.UI.v1.PresentationVariant", "com.sap.vocabularies.UI.v1.SelectionPresentationVariant"];

  /**
   * Create subsections based on facet definition.
   *
   * @param facetCollection Collection of facets
   * @param converterContext The converter context
   * @param isHeaderSection True if header section is generated in this iteration
   * @returns The current subsections
   */
  function createSubSections(facetCollection, converterContext, isHeaderSection) {
    // First we determine which sub section we need to create
    const facetsToCreate = facetCollection.reduce((facetsToCreate, facetDefinition) => {
      switch (facetDefinition.$Type) {
        case "com.sap.vocabularies.UI.v1.ReferenceFacet":
          facetsToCreate.push(facetDefinition);
          break;
        case "com.sap.vocabularies.UI.v1.CollectionFacet":
          // TODO If the Collection Facet has a child of type Collection Facet we bring them up one level (Form + Table use case) ?
          // first case facet Collection is combination of collection and reference facet or not all facets are reference facets.
          if (facetDefinition.Facets.find(facetType => facetType.$Type === "com.sap.vocabularies.UI.v1.CollectionFacet")) {
            facetsToCreate.splice(facetsToCreate.length, 0, ...facetDefinition.Facets);
          } else {
            facetsToCreate.push(facetDefinition);
          }
          break;
        case "com.sap.vocabularies.UI.v1.ReferenceURLFacet":
          // Not supported
          break;
      }
      return facetsToCreate;
    }, []);

    // Then we create the actual subsections
    return facetsToCreate.map(facet => {
      var _Facets;
      return createSubSection(facet, facetsToCreate, converterContext, 0, !(facet !== null && facet !== void 0 && (_Facets = facet.Facets) !== null && _Facets !== void 0 && _Facets.length), isHeaderSection);
    });
  }

  /**
   * Creates subsections based on the definition of the custom header facet.
   *
   * @param converterContext The converter context
   * @returns The current subsections
   */
  _exports.createSubSections = createSubSections;
  function createCustomHeaderFacetSubSections(converterContext) {
    const customHeaderFacets = getHeaderFacetsFromManifest(converterContext.getManifestWrapper().getHeaderFacets());
    const aCustomHeaderFacets = [];
    Object.keys(customHeaderFacets).forEach(function (key) {
      aCustomHeaderFacets.push(customHeaderFacets[key]);
      return aCustomHeaderFacets;
    });
    const facetsToCreate = aCustomHeaderFacets.reduce((facetsToCreate, customHeaderFacet) => {
      if (customHeaderFacet.templateEdit) {
        facetsToCreate.push(customHeaderFacet);
      }
      return facetsToCreate;
    }, []);
    return facetsToCreate.map(customHeaderFacet => createCustomHeaderFacetSubSection(customHeaderFacet));
  }

  /**
   * Creates a subsection based on a custom header facet.
   *
   * @param customHeaderFacet A custom header facet
   * @returns A definition for a subsection
   */
  _exports.createCustomHeaderFacetSubSections = createCustomHeaderFacetSubSections;
  function createCustomHeaderFacetSubSection(customHeaderFacet) {
    const subSectionID = getCustomSubSectionID(customHeaderFacet.key);
    const subSection = {
      id: subSectionID,
      key: customHeaderFacet.key,
      title: customHeaderFacet.title,
      type: SubSectionType.XMLFragment,
      template: customHeaderFacet.templateEdit || "",
      visible: customHeaderFacet.visible,
      level: 1,
      sideContent: undefined,
      stashed: customHeaderFacet.stashed,
      flexSettings: customHeaderFacet.flexSettings,
      actions: {}
    };
    return subSection;
  }

  // function isTargetForCompliant(annotationPath: AnnotationPath) {
  // 	return /.*com\.sap\.vocabularies\.UI\.v1\.(FieldGroup|Identification|DataPoint|StatusInfo).*/.test(annotationPath.value);
  // }
  const getSubSectionKey = (facetDefinition, fallback) => {
    var _facetDefinition$ID, _facetDefinition$Labe;
    return ((_facetDefinition$ID = facetDefinition.ID) === null || _facetDefinition$ID === void 0 ? void 0 : _facetDefinition$ID.toString()) || ((_facetDefinition$Labe = facetDefinition.Label) === null || _facetDefinition$Labe === void 0 ? void 0 : _facetDefinition$Labe.toString()) || fallback;
  };
  /**
   * Adds Form menu action to all form actions, removes duplicate actions and hidden actions.
   *
   * @param actions The actions involved
   * @param facetDefinition The definition for the facet
   * @param converterContext The converter context
   * @returns The form menu actions
   */
  function addFormMenuActions(actions, facetDefinition, converterContext) {
    const hiddenActions = getFormHiddenActions(facetDefinition, converterContext) || [],
      formActions = getFormActions(facetDefinition, converterContext),
      manifestActions = getActionsFromManifest(formActions, converterContext, actions, undefined, undefined, hiddenActions),
      actionOverwriteConfig = {
        enabled: OverrideType.overwrite,
        visible: OverrideType.overwrite,
        command: OverrideType.overwrite
      },
      formAllActions = insertCustomElements(actions, manifestActions.actions, actionOverwriteConfig);
    return {
      actions: formAllActions ? getVisibilityEnablementFormMenuActions(removeDuplicateActions(formAllActions)) : actions,
      commandActions: manifestActions.commandActions
    };
  }

  /**
   * Retrieves the action form a facet.
   *
   * @param facetDefinition
   * @param converterContext
   * @returns The current facet actions
   */
  function getFacetActions(facetDefinition, converterContext) {
    let actions = [];
    switch (facetDefinition.$Type) {
      case "com.sap.vocabularies.UI.v1.CollectionFacet":
        actions = facetDefinition.Facets.filter(subFacetDefinition => isReferenceFacet(subFacetDefinition)).reduce((actionReducer, referenceFacet) => createFormActionReducer(actionReducer, referenceFacet, converterContext), []);
        break;
      case "com.sap.vocabularies.UI.v1.ReferenceFacet":
        actions = createFormActionReducer([], facetDefinition, converterContext);
        break;
      default:
        break;
    }
    return addFormMenuActions(actions, facetDefinition, converterContext);
  }
  /**
   * Returns the button type based on @UI.Emphasized annotation.
   *
   * @param emphasized Emphasized annotation value.
   * @returns The button type or path based expression.
   */
  function getButtonType(emphasized) {
    // Emphasized is a boolean so if it's equal to true we show the button as Ghost, otherwise as Transparent
    const buttonTypeCondition = equal(getExpressionFromAnnotation(emphasized), true);
    return compileExpression(ifElse(buttonTypeCondition, ButtonType.Ghost, ButtonType.Transparent));
  }

  /**
   * Create a subsection based on FacetTypes.
   *
   * @param facetDefinition
   * @param facetsToCreate
   * @param converterContext
   * @param level
   * @param hasSingleContent
   * @param isHeaderSection
   * @returns A subsection definition
   */
  function createSubSection(facetDefinition, facetsToCreate, converterContext, level, hasSingleContent, isHeaderSection) {
    var _facetDefinition$anno, _facetDefinition$anno2, _presentation$visuali, _presentation$visuali2, _presentation$visuali3;
    const subSectionID = getSubSectionID(facetDefinition);
    const oHiddenAnnotation = (_facetDefinition$anno = facetDefinition.annotations) === null || _facetDefinition$anno === void 0 ? void 0 : (_facetDefinition$anno2 = _facetDefinition$anno.UI) === null || _facetDefinition$anno2 === void 0 ? void 0 : _facetDefinition$anno2.Hidden;
    const isVisible = compileExpression(not(equal(true, getExpressionFromAnnotation(oHiddenAnnotation))));
    const isDynamicExpression = isVisible && typeof isVisible === "string" && isVisible.indexOf("{=") === 0 && (oHiddenAnnotation === null || oHiddenAnnotation === void 0 ? void 0 : oHiddenAnnotation.type) !== "Path";
    const isVisibleDynamicExpression = isVisible && isDynamicExpression ? isVisible.substring(isVisible.indexOf("{=") + 2, isVisible.lastIndexOf("}")) : false;
    const title = compileExpression(getExpressionFromAnnotation(facetDefinition.Label));
    const subSection = {
      id: subSectionID,
      key: getSubSectionKey(facetDefinition, subSectionID),
      title: title,
      type: SubSectionType.Unknown,
      annotationPath: converterContext.getEntitySetBasedAnnotationPath(facetDefinition.fullyQualifiedName),
      visible: isVisible,
      isVisibilityDynamic: isDynamicExpression,
      level: level,
      sideContent: undefined
    };
    if (isHeaderSection) {
      subSection.stashed = getStashedSettingsForHeaderFacet(facetDefinition, facetDefinition, converterContext);
      subSection.flexSettings = {
        designtime: getDesignTimeMetadataSettingsForHeaderFacet(facetDefinition, facetDefinition, converterContext)
      };
    }
    let unsupportedText = "";
    level++;
    switch (facetDefinition.$Type) {
      case "com.sap.vocabularies.UI.v1.CollectionFacet":
        const facets = facetDefinition.Facets;

        // Filter for all facets of this subsection that are referring to an annotation describing a visualization (e.g. table or chart)
        const visualizationFacets = facets.map((facet, index) => ({
          index,
          facet
        })) // Remember the index assigned to each facet
        .filter(_ref => {
          var _Target, _Target$$target;
          let {
            facet
          } = _ref;
          return visualizationTerms.includes((_Target = facet.Target) === null || _Target === void 0 ? void 0 : (_Target$$target = _Target.$target) === null || _Target$$target === void 0 ? void 0 : _Target$$target.term);
        });

        // Filter out all visualization facets; "visualizationFacets" and "nonVisualizationFacets" are disjoint
        const nonVisualizationFacets = facets.filter(facet => !visualizationFacets.find(visualization => visualization.facet === facet));
        if (visualizationFacets.length > 0) {
          // CollectionFacets with visualizations must be handled separately as they cannot be included in forms
          const visualizationContent = [];
          const formContent = [];
          const mixedContent = [];

          // Create each visualization facet as if it was its own subsection (via recursion), and keep their relative ordering
          for (const {
            facet
          } of visualizationFacets) {
            visualizationContent.push(createSubSection(facet, [], converterContext, level, facets.length === 1, isHeaderSection));
          }
          if (nonVisualizationFacets.length > 0) {
            // This subsection includes visualizations and other content, so it is a "Mixed" subsection
            Log.warning(`Warning: CollectionFacet '${facetDefinition.ID}' includes a combination of either a chart or a table and other content. This can lead to rendering issues. Consider moving the chart or table into a separate CollectionFacet.`);
            facetDefinition.Facets = nonVisualizationFacets;
            // Create a joined form of all facets that are not referring to visualizations
            formContent.push(createSubSection(facetDefinition, [], converterContext, level, hasSingleContent, isHeaderSection));
          }

          // Merge the visualization content with the form content
          if (visualizationFacets.find(_ref2 => {
            let {
              index
            } = _ref2;
            return index === 0;
          })) {
            // If the first facet is a visualization, display the visualizations first
            mixedContent.push(...visualizationContent);
            mixedContent.push(...formContent);
          } else {
            // Otherwise, display the form first
            mixedContent.push(...formContent);
            mixedContent.push(...visualizationContent);
          }
          const mixedSubSection = {
            ...subSection,
            type: SubSectionType.Mixed,
            level: level,
            content: mixedContent
          };
          return mixedSubSection;
        } else {
          // This CollectionFacet only includes content that can be rendered in a merged form
          const facetActions = getFacetActions(facetDefinition, converterContext),
            formCollectionSubSection = {
              ...subSection,
              type: SubSectionType.Form,
              formDefinition: createFormDefinition(facetDefinition, isVisible, converterContext, facetActions.actions),
              level: level,
              actions: facetActions.actions.filter(action => action.facetName === undefined),
              commandActions: facetActions.commandActions
            };
          return formCollectionSubSection;
        }
      case "com.sap.vocabularies.UI.v1.ReferenceFacet":
        if (!facetDefinition.Target.$target) {
          unsupportedText = `Unable to find annotationPath ${facetDefinition.Target.value}`;
        } else {
          switch (facetDefinition.Target.$target.term) {
            case "com.sap.vocabularies.UI.v1.LineItem":
            case "com.sap.vocabularies.UI.v1.Chart":
            case "com.sap.vocabularies.UI.v1.PresentationVariant":
            case "com.sap.vocabularies.UI.v1.SelectionPresentationVariant":
              const presentation = getDataVisualizationConfiguration(facetDefinition.Target.value, getCondensedTableLayoutCompliance(facetDefinition, facetsToCreate, converterContext), converterContext, undefined, isHeaderSection);
              const subSectionTitle = subSection.title ? subSection.title : "";
              const controlTitle = ((_presentation$visuali = presentation.visualizations[0]) === null || _presentation$visuali === void 0 ? void 0 : (_presentation$visuali2 = _presentation$visuali.annotation) === null || _presentation$visuali2 === void 0 ? void 0 : _presentation$visuali2.title) || ((_presentation$visuali3 = presentation.visualizations[0]) === null || _presentation$visuali3 === void 0 ? void 0 : _presentation$visuali3.title);
              const showTitle = getTitleVisibility(controlTitle, subSectionTitle, hasSingleContent);
              const titleVisibleExpression = isVisible && title !== "undefined" && (title ? isVisible : false);
              const dataVisualizationSubSection = {
                ...subSection,
                type: SubSectionType.DataVisualization,
                level: level,
                presentation: presentation,
                showTitle: showTitle,
                titleVisible: isDynamicExpression ? `{= (${isVisibleDynamicExpression}) && ('${title}' !=='undefined') && (${showTitle} ? true : false) }` : titleVisibleExpression
              };
              return dataVisualizationSubSection;
            case "com.sap.vocabularies.UI.v1.FieldGroup":
            case "com.sap.vocabularies.UI.v1.Identification":
            case "com.sap.vocabularies.UI.v1.DataPoint":
            case "com.sap.vocabularies.UI.v1.StatusInfo":
            case "com.sap.vocabularies.Communication.v1.Contact":
              // All those element belong to a from facet
              const facetActions = getFacetActions(facetDefinition, converterContext),
                formElementSubSection = {
                  ...subSection,
                  type: SubSectionType.Form,
                  level: level,
                  formDefinition: createFormDefinition(facetDefinition, isVisible, converterContext, facetActions.actions),
                  actions: facetActions.actions.filter(action => action.facetName === undefined),
                  commandActions: facetActions.commandActions
                };
              return formElementSubSection;
            default:
              unsupportedText = `For ${facetDefinition.Target.$target.term} Fragment`;
              break;
          }
        }
        break;
      case "com.sap.vocabularies.UI.v1.ReferenceURLFacet":
        unsupportedText = "For Reference URL Facet";
        break;
      default:
        break;
    }
    // If we reach here we ended up with an unsupported SubSection type
    const unsupportedSubSection = {
      ...subSection,
      text: unsupportedText
    };
    return unsupportedSubSection;
  }
  /**
   * Checks whether to hide or show subsection title
   *
   * @param controlTitle
   * @param sectionTitle
   * @param hasSingleContent
   * @returns Boolean value  or expression for showTitle
   */
  _exports.createSubSection = createSubSection;
  function getTitleVisibility(controlTitle, subSectionTitle, hasSingleContent) {
    // visible shall be true if there are multiple content or if the control and subsection title are different
    return compileExpression(or(not(hasSingleContent), notEqual(resolveBindingString(controlTitle), resolveBindingString(subSectionTitle))));
  }
  _exports.getTitleVisibility = getTitleVisibility;
  function createFormActionReducer(actions, facetDefinition, converterContext) {
    const referenceTarget = facetDefinition.Target.$target;
    const targetValue = facetDefinition.Target.value;
    let manifestActions = {};
    let dataFieldCollection = [];
    let [navigationPropertyPath] = targetValue.split("@");
    if (navigationPropertyPath.length > 0) {
      if (navigationPropertyPath.lastIndexOf("/") === navigationPropertyPath.length - 1) {
        navigationPropertyPath = navigationPropertyPath.substr(0, navigationPropertyPath.length - 1);
      }
    } else {
      navigationPropertyPath = undefined;
    }
    if (referenceTarget) {
      switch (referenceTarget.term) {
        case "com.sap.vocabularies.UI.v1.FieldGroup":
          dataFieldCollection = referenceTarget.Data;
          manifestActions = getActionsFromManifest(converterContext.getManifestControlConfiguration(referenceTarget).actions, converterContext, undefined, undefined, undefined, undefined, facetDefinition.fullyQualifiedName).actions;
          break;
        case "com.sap.vocabularies.UI.v1.Identification":
        case "com.sap.vocabularies.UI.v1.StatusInfo":
          if (referenceTarget.qualifier) {
            dataFieldCollection = referenceTarget;
          }
          break;
        default:
          break;
      }
    }
    actions = dataFieldCollection.reduce((actionReducer, dataField) => {
      var _dataField$RequiresCo, _dataField$Inline, _dataField$Determinin, _dataField$Label, _dataField$Navigation, _dataField$annotation, _dataField$annotation2, _dataField$annotation3, _dataField$annotation4, _dataField$annotation5, _dataField$Label2, _dataField$annotation6, _dataField$annotation7, _dataField$annotation8, _dataField$annotation9, _dataField$annotation10;
      switch (dataField.$Type) {
        case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
          if (((_dataField$RequiresCo = dataField.RequiresContext) === null || _dataField$RequiresCo === void 0 ? void 0 : _dataField$RequiresCo.valueOf()) === true) {
            converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Low, IssueType.MALFORMED_DATAFIELD_FOR_IBN.REQUIRESCONTEXT);
          }
          if (((_dataField$Inline = dataField.Inline) === null || _dataField$Inline === void 0 ? void 0 : _dataField$Inline.valueOf()) === true) {
            converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Low, IssueType.MALFORMED_DATAFIELD_FOR_IBN.INLINE);
          }
          if (((_dataField$Determinin = dataField.Determining) === null || _dataField$Determinin === void 0 ? void 0 : _dataField$Determinin.valueOf()) === true) {
            converterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Low, IssueType.MALFORMED_DATAFIELD_FOR_IBN.DETERMINING);
          }
          const mNavigationParameters = {};
          if (dataField.Mapping) {
            mNavigationParameters.semanticObjectMapping = getSemanticObjectMapping(dataField.Mapping);
          }
          actionReducer.push({
            type: ActionType.DataFieldForIntentBasedNavigation,
            id: getFormID(facetDefinition, dataField),
            key: KeyHelper.generateKeyFromDataField(dataField),
            text: (_dataField$Label = dataField.Label) === null || _dataField$Label === void 0 ? void 0 : _dataField$Label.toString(),
            annotationPath: "",
            enabled: dataField.NavigationAvailable !== undefined ? compileExpression(equal(getExpressionFromAnnotation((_dataField$Navigation = dataField.NavigationAvailable) === null || _dataField$Navigation === void 0 ? void 0 : _dataField$Navigation.valueOf()), true)) : "true",
            visible: compileExpression(not(equal(getExpressionFromAnnotation((_dataField$annotation = dataField.annotations) === null || _dataField$annotation === void 0 ? void 0 : (_dataField$annotation2 = _dataField$annotation.UI) === null || _dataField$annotation2 === void 0 ? void 0 : (_dataField$annotation3 = _dataField$annotation2.Hidden) === null || _dataField$annotation3 === void 0 ? void 0 : _dataField$annotation3.valueOf()), true))),
            buttonType: getButtonType((_dataField$annotation4 = dataField.annotations) === null || _dataField$annotation4 === void 0 ? void 0 : (_dataField$annotation5 = _dataField$annotation4.UI) === null || _dataField$annotation5 === void 0 ? void 0 : _dataField$annotation5.Emphasized),
            press: compileExpression(fn("._intentBasedNavigation.navigate", [getExpressionFromAnnotation(dataField.SemanticObject), getExpressionFromAnnotation(dataField.Action), mNavigationParameters])),
            customData: compileExpression({
              semanticObject: getExpressionFromAnnotation(dataField.SemanticObject),
              action: getExpressionFromAnnotation(dataField.Action)
            })
          });
          break;
        case "com.sap.vocabularies.UI.v1.DataFieldForAction":
          const formManifestActionsConfiguration = converterContext.getManifestControlConfiguration(referenceTarget).actions;
          const key = KeyHelper.generateKeyFromDataField(dataField);
          actionReducer.push({
            type: ActionType.DataFieldForAction,
            id: getFormID(facetDefinition, dataField),
            key: key,
            text: (_dataField$Label2 = dataField.Label) === null || _dataField$Label2 === void 0 ? void 0 : _dataField$Label2.toString(),
            annotationPath: "",
            enabled: getEnabledForAnnotationAction(converterContext, dataField.ActionTarget),
            binding: navigationPropertyPath ? `{ 'path' : '${navigationPropertyPath}'}` : undefined,
            visible: compileExpression(not(equal(getExpressionFromAnnotation((_dataField$annotation6 = dataField.annotations) === null || _dataField$annotation6 === void 0 ? void 0 : (_dataField$annotation7 = _dataField$annotation6.UI) === null || _dataField$annotation7 === void 0 ? void 0 : (_dataField$annotation8 = _dataField$annotation7.Hidden) === null || _dataField$annotation8 === void 0 ? void 0 : _dataField$annotation8.valueOf()), true))),
            requiresDialog: isDialog(dataField.ActionTarget),
            buttonType: getButtonType((_dataField$annotation9 = dataField.annotations) === null || _dataField$annotation9 === void 0 ? void 0 : (_dataField$annotation10 = _dataField$annotation9.UI) === null || _dataField$annotation10 === void 0 ? void 0 : _dataField$annotation10.Emphasized),
            press: compileExpression(fn("invokeAction", [dataField.Action, {
              contexts: fn("getBindingContext", [], pathInModel("", "$source")),
              invocationGrouping: dataField.InvocationGrouping === "UI.OperationGroupingType/ChangeSet" ? "ChangeSet" : "Isolated",
              label: getExpressionFromAnnotation(dataField.Label),
              model: fn("getModel", [], pathInModel("/", "$source")),
              isNavigable: isActionNavigable(formManifestActionsConfiguration && formManifestActionsConfiguration[key])
            }], ref(".editFlow"))),
            facetName: dataField.Inline ? facetDefinition.fullyQualifiedName : undefined
          });
          break;
        default:
          break;
      }
      return actionReducer;
    }, actions);
    // Overwriting of actions happens in addFormMenuActions
    return insertCustomElements(actions, manifestActions);
  }
  function isDialog(actionDefinition) {
    if (actionDefinition) {
      var _actionDefinition$ann, _actionDefinition$ann2;
      const bCritical = (_actionDefinition$ann = actionDefinition.annotations) === null || _actionDefinition$ann === void 0 ? void 0 : (_actionDefinition$ann2 = _actionDefinition$ann.Common) === null || _actionDefinition$ann2 === void 0 ? void 0 : _actionDefinition$ann2.IsActionCritical;
      if (actionDefinition.parameters.length > 1 || bCritical) {
        return "Dialog";
      } else {
        return "None";
      }
    } else {
      return "None";
    }
  }
  _exports.isDialog = isDialog;
  function createCustomSubSections(manifestSubSections, converterContext) {
    const subSections = {};
    Object.keys(manifestSubSections).forEach(subSectionKey => subSections[subSectionKey] = createCustomSubSection(manifestSubSections[subSectionKey], subSectionKey, converterContext));
    return subSections;
  }
  _exports.createCustomSubSections = createCustomSubSections;
  function createCustomSubSection(manifestSubSection, subSectionKey, converterContext) {
    const sideContent = manifestSubSection.sideContent ? {
      template: manifestSubSection.sideContent.template,
      id: getSideContentID(subSectionKey),
      visible: false,
      equalSplit: manifestSubSection.sideContent.equalSplit
    } : undefined;
    let position = manifestSubSection.position;
    if (!position) {
      position = {
        placement: Placement.After
      };
    }
    const isVisible = manifestSubSection.visible !== undefined ? manifestSubSection.visible : true;
    const isDynamicExpression = isVisible && typeof isVisible === "string" && isVisible.indexOf("{=") === 0;
    const manifestActions = getActionsFromManifest(manifestSubSection.actions, converterContext);
    const subSectionDefinition = {
      type: SubSectionType.Unknown,
      id: manifestSubSection.id || getCustomSubSectionID(subSectionKey),
      actions: manifestActions.actions,
      key: subSectionKey,
      title: manifestSubSection.title,
      level: 1,
      position: position,
      visible: manifestSubSection.visible !== undefined ? manifestSubSection.visible : true,
      sideContent: sideContent,
      isVisibilityDynamic: isDynamicExpression
    };
    if (manifestSubSection.template || manifestSubSection.name) {
      subSectionDefinition.type = SubSectionType.XMLFragment;
      subSectionDefinition.template = manifestSubSection.template || manifestSubSection.name || "";
    } else {
      subSectionDefinition.type = SubSectionType.Placeholder;
    }
    return subSectionDefinition;
  }

  /**
   * Evaluate if the condensed mode can be appli3ed on the table.
   *
   * @param currentFacet
   * @param facetsToCreateInSection
   * @param converterContext
   * @returns `true` for compliant, false otherwise
   */
  _exports.createCustomSubSection = createCustomSubSection;
  function getCondensedTableLayoutCompliance(currentFacet, facetsToCreateInSection, converterContext) {
    const manifestWrapper = converterContext.getManifestWrapper();
    if (manifestWrapper.useIconTabBar()) {
      // If the OP use the tab based we check if the facets that will be created for this section are all non visible
      return hasNoOtherVisibleTableInTargets(currentFacet, facetsToCreateInSection);
    } else {
      var _entityType$annotatio, _entityType$annotatio2, _entityType$annotatio3, _entityType$annotatio4, _entityType$annotatio5, _entityType$annotatio6;
      const entityType = converterContext.getEntityType();
      if ((_entityType$annotatio = entityType.annotations) !== null && _entityType$annotatio !== void 0 && (_entityType$annotatio2 = _entityType$annotatio.UI) !== null && _entityType$annotatio2 !== void 0 && (_entityType$annotatio3 = _entityType$annotatio2.Facets) !== null && _entityType$annotatio3 !== void 0 && _entityType$annotatio3.length && ((_entityType$annotatio4 = entityType.annotations) === null || _entityType$annotatio4 === void 0 ? void 0 : (_entityType$annotatio5 = _entityType$annotatio4.UI) === null || _entityType$annotatio5 === void 0 ? void 0 : (_entityType$annotatio6 = _entityType$annotatio5.Facets) === null || _entityType$annotatio6 === void 0 ? void 0 : _entityType$annotatio6.length) > 1) {
        return hasNoOtherVisibleTableInTargets(currentFacet, facetsToCreateInSection);
      } else {
        return true;
      }
    }
  }
  function hasNoOtherVisibleTableInTargets(currentFacet, facetsToCreateInSection) {
    return facetsToCreateInSection.every(function (subFacet) {
      if (subFacet !== currentFacet) {
        if (subFacet.$Type === "com.sap.vocabularies.UI.v1.ReferenceFacet") {
          var _refFacet$Target, _refFacet$Target$$tar, _refFacet$Target2, _refFacet$Target2$$ta, _refFacet$Target$$tar2;
          const refFacet = subFacet;
          if (((_refFacet$Target = refFacet.Target) === null || _refFacet$Target === void 0 ? void 0 : (_refFacet$Target$$tar = _refFacet$Target.$target) === null || _refFacet$Target$$tar === void 0 ? void 0 : _refFacet$Target$$tar.term) === "com.sap.vocabularies.UI.v1.LineItem" || ((_refFacet$Target2 = refFacet.Target) === null || _refFacet$Target2 === void 0 ? void 0 : (_refFacet$Target2$$ta = _refFacet$Target2.$target) === null || _refFacet$Target2$$ta === void 0 ? void 0 : _refFacet$Target2$$ta.term) === "com.sap.vocabularies.UI.v1.PresentationVariant" || ((_refFacet$Target$$tar2 = refFacet.Target.$target) === null || _refFacet$Target$$tar2 === void 0 ? void 0 : _refFacet$Target$$tar2.term) === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant") {
            var _refFacet$annotations, _refFacet$annotations2, _refFacet$annotations3, _refFacet$annotations4;
            return ((_refFacet$annotations = refFacet.annotations) === null || _refFacet$annotations === void 0 ? void 0 : (_refFacet$annotations2 = _refFacet$annotations.UI) === null || _refFacet$annotations2 === void 0 ? void 0 : _refFacet$annotations2.Hidden) !== undefined ? (_refFacet$annotations3 = refFacet.annotations) === null || _refFacet$annotations3 === void 0 ? void 0 : (_refFacet$annotations4 = _refFacet$annotations3.UI) === null || _refFacet$annotations4 === void 0 ? void 0 : _refFacet$annotations4.Hidden : false;
          }
          return true;
        } else {
          const subCollectionFacet = subFacet;
          return subCollectionFacet.Facets.every(function (facet) {
            var _subRefFacet$Target, _subRefFacet$Target$$, _subRefFacet$Target2, _subRefFacet$Target2$, _subRefFacet$Target3, _subRefFacet$Target3$;
            const subRefFacet = facet;
            if (((_subRefFacet$Target = subRefFacet.Target) === null || _subRefFacet$Target === void 0 ? void 0 : (_subRefFacet$Target$$ = _subRefFacet$Target.$target) === null || _subRefFacet$Target$$ === void 0 ? void 0 : _subRefFacet$Target$$.term) === "com.sap.vocabularies.UI.v1.LineItem" || ((_subRefFacet$Target2 = subRefFacet.Target) === null || _subRefFacet$Target2 === void 0 ? void 0 : (_subRefFacet$Target2$ = _subRefFacet$Target2.$target) === null || _subRefFacet$Target2$ === void 0 ? void 0 : _subRefFacet$Target2$.term) === "com.sap.vocabularies.UI.v1.PresentationVariant" || ((_subRefFacet$Target3 = subRefFacet.Target) === null || _subRefFacet$Target3 === void 0 ? void 0 : (_subRefFacet$Target3$ = _subRefFacet$Target3.$target) === null || _subRefFacet$Target3$ === void 0 ? void 0 : _subRefFacet$Target3$.term) === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant") {
              var _subRefFacet$annotati, _subRefFacet$annotati2, _subRefFacet$annotati3, _subRefFacet$annotati4;
              return ((_subRefFacet$annotati = subRefFacet.annotations) === null || _subRefFacet$annotati === void 0 ? void 0 : (_subRefFacet$annotati2 = _subRefFacet$annotati.UI) === null || _subRefFacet$annotati2 === void 0 ? void 0 : _subRefFacet$annotati2.Hidden) !== undefined ? (_subRefFacet$annotati3 = subRefFacet.annotations) === null || _subRefFacet$annotati3 === void 0 ? void 0 : (_subRefFacet$annotati4 = _subRefFacet$annotati3.UI) === null || _subRefFacet$annotati4 === void 0 ? void 0 : _subRefFacet$annotati4.Hidden : false;
            }
            return true;
          });
        }
      }
      return true;
    });
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/controls/ObjectPage/SubSection", ["sap/base/Log","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/controls/ObjectPage/HeaderFacet","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","../../helpers/ConfigurableObject","../../helpers/ID","../../ManifestSettings","../../objectPage/FormMenuActions","../Common/DataVisualization","../Common/Form"],function(e,t,n,i,a,o,r,s,l,c,u,v){"use strict";var d={};var f=v.isReferenceFacet;var m=v.createFormDefinition;var p=u.getDataVisualizationConfiguration;var g=c.getVisibilityEnablementFormMenuActions;var b=c.getFormHiddenActions;var I=c.getFormActions;var F=l.ActionType;var h=s.getSubSectionID;var y=s.getSideContentID;var U=s.getFormID;var D=s.getCustomSubSectionID;var S=r.Placement;var T=r.OverrideType;var A=r.insertCustomElements;var C=o.resolveBindingString;var k=o.ref;var M=o.pathInModel;var O=o.or;var E=o.notEqual;var L=o.not;var $=o.ifElse;var N=o.getExpressionFromAnnotation;var x=o.fn;var P=o.equal;var R=o.compileExpression;var w=a.KeyHelper;var V=i.IssueType;var H=i.IssueSeverity;var B=i.IssueCategory;var j=n.getStashedSettingsForHeaderFacet;var _=n.getHeaderFacetsFromManifest;var z=n.getDesignTimeMetadataSettingsForHeaderFacet;var q=t.removeDuplicateActions;var G=t.isActionNavigable;var X=t.getSemanticObjectMapping;var K=t.getEnabledForAnnotationAction;var Q=t.getActionsFromManifest;var W=t.ButtonType;let J;(function(e){e["Unknown"]="Unknown";e["Form"]="Form";e["DataVisualization"]="DataVisualization";e["XMLFragment"]="XMLFragment";e["Placeholder"]="Placeholder";e["Mixed"]="Mixed"})(J||(J={}));d.SubSectionType=J;const Y=["com.sap.vocabularies.UI.v1.LineItem","com.sap.vocabularies.UI.v1.Chart","com.sap.vocabularies.UI.v1.PresentationVariant","com.sap.vocabularies.UI.v1.SelectionPresentationVariant"];function Z(e,t,n){const i=e.reduce((e,t)=>{switch(t.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":e.push(t);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":if(t.Facets.find(e=>e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet")){e.splice(e.length,0,...t.Facets)}else{e.push(t)}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":break}return e},[]);return i.map(e=>{var a;return re(e,i,t,0,!(e!==null&&e!==void 0&&(a=e.Facets)!==null&&a!==void 0&&a.length),n)})}d.createSubSections=Z;function ee(e){const t=_(e.getManifestWrapper().getHeaderFacets());const n=[];Object.keys(t).forEach(function(e){n.push(t[e]);return n});const i=n.reduce((e,t)=>{if(t.templateEdit){e.push(t)}return e},[]);return i.map(e=>te(e))}d.createCustomHeaderFacetSubSections=ee;function te(e){const t=D(e.key);const n={id:t,key:e.key,title:e.title,type:J.XMLFragment,template:e.templateEdit||"",visible:e.visible,level:1,sideContent:undefined,stashed:e.stashed,flexSettings:e.flexSettings,actions:{}};return n}const ne=(e,t)=>{var n,i;return((n=e.ID)===null||n===void 0?void 0:n.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t};function ie(e,t,n){const i=b(t,n)||[],a=I(t,n),o=Q(a,n,e,undefined,undefined,i),r={enabled:T.overwrite,visible:T.overwrite,command:T.overwrite},s=A(e,o.actions,r);return{actions:s?g(q(s)):e,commandActions:o.commandActions}}function ae(e,t){let n=[];switch(e.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":n=e.Facets.filter(e=>f(e)).reduce((e,n)=>le(e,n,t),[]);break;case"com.sap.vocabularies.UI.v1.ReferenceFacet":n=le([],e,t);break;default:break}return ie(n,e,t)}function oe(e){const t=P(N(e),true);return R($(t,W.Ghost,W.Transparent))}function re(t,n,i,a,o,r){var s,l,c,u,v;const d=h(t);const f=(s=t.annotations)===null||s===void 0?void 0:(l=s.UI)===null||l===void 0?void 0:l.Hidden;const g=R(L(P(true,N(f))));const b=g&&typeof g==="string"&&g.indexOf("{=")===0&&(f===null||f===void 0?void 0:f.type)!=="Path";const I=g&&b?g.substring(g.indexOf("{=")+2,g.lastIndexOf("}")):false;const F=R(N(t.Label));const y={id:d,key:ne(t,d),title:F,type:J.Unknown,annotationPath:i.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),visible:g,isVisibilityDynamic:b,level:a,sideContent:undefined};if(r){y.stashed=j(t,t,i);y.flexSettings={designtime:z(t,t,i)}}let U="";a++;switch(t.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":const s=t.Facets;const l=s.map((e,t)=>({index:t,facet:e})).filter(e=>{var t,n;let{facet:i}=e;return Y.includes((t=i.Target)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.term)});const d=s.filter(e=>!l.find(t=>t.facet===e));if(l.length>0){const n=[];const c=[];const u=[];for(const{facet:e}of l){n.push(re(e,[],i,a,s.length===1,r))}if(d.length>0){e.warning(`Warning: CollectionFacet '${t.ID}' includes a combination of either a chart or a table and other content. This can lead to rendering issues. Consider moving the chart or table into a separate CollectionFacet.`);t.Facets=d;c.push(re(t,[],i,a,o,r))}if(l.find(e=>{let{index:t}=e;return t===0})){u.push(...n);u.push(...c)}else{u.push(...c);u.push(...n)}const v={...y,type:J.Mixed,level:a,content:u};return v}else{const e=ae(t,i),n={...y,type:J.Form,formDefinition:m(t,g,i,e.actions),level:a,actions:e.actions.filter(e=>e.facetName===undefined),commandActions:e.commandActions};return n}case"com.sap.vocabularies.UI.v1.ReferenceFacet":if(!t.Target.$target){U=`Unable to find annotationPath ${t.Target.value}`}else{switch(t.Target.$target.term){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":case"com.sap.vocabularies.UI.v1.PresentationVariant":case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":const e=p(t.Target.value,de(t,n,i),i,undefined,r);const s=y.title?y.title:"";const l=((c=e.visualizations[0])===null||c===void 0?void 0:(u=c.annotation)===null||u===void 0?void 0:u.title)||((v=e.visualizations[0])===null||v===void 0?void 0:v.title);const d=se(l,s,o);const f=g&&F!=="undefined"&&(F?g:false);const h={...y,type:J.DataVisualization,level:a,presentation:e,showTitle:d,titleVisible:b?`{= (${I}) && ('${F}' !=='undefined') && (${d} ? true : false) }`:f};return h;case"com.sap.vocabularies.UI.v1.FieldGroup":case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.DataPoint":case"com.sap.vocabularies.UI.v1.StatusInfo":case"com.sap.vocabularies.Communication.v1.Contact":const D=ae(t,i),S={...y,type:J.Form,level:a,formDefinition:m(t,g,i,D.actions),actions:D.actions.filter(e=>e.facetName===undefined),commandActions:D.commandActions};return S;default:U=`For ${t.Target.$target.term} Fragment`;break}}break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":U="For Reference URL Facet";break;default:break}const D={...y,text:U};return D}d.createSubSection=re;function se(e,t,n){return R(O(L(n),E(C(e),C(t))))}d.getTitleVisibility=se;function le(e,t,n){const i=t.Target.$target;const a=t.Target.value;let o={};let r=[];let[s]=a.split("@");if(s.length>0){if(s.lastIndexOf("/")===s.length-1){s=s.substr(0,s.length-1)}}else{s=undefined}if(i){switch(i.term){case"com.sap.vocabularies.UI.v1.FieldGroup":r=i.Data;o=Q(n.getManifestControlConfiguration(i).actions,n,undefined,undefined,undefined,undefined,t.fullyQualifiedName).actions;break;case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.StatusInfo":if(i.qualifier){r=i}break;default:break}}e=r.reduce((e,a)=>{var o,r,l,c,u,v,d,f,m,p,g,b,I,h,y,D;switch(a.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":if(((o=a.RequiresContext)===null||o===void 0?void 0:o.valueOf())===true){n.getDiagnostics().addIssue(B.Annotation,H.Low,V.MALFORMED_DATAFIELD_FOR_IBN.REQUIRESCONTEXT)}if(((r=a.Inline)===null||r===void 0?void 0:r.valueOf())===true){n.getDiagnostics().addIssue(B.Annotation,H.Low,V.MALFORMED_DATAFIELD_FOR_IBN.INLINE)}if(((l=a.Determining)===null||l===void 0?void 0:l.valueOf())===true){n.getDiagnostics().addIssue(B.Annotation,H.Low,V.MALFORMED_DATAFIELD_FOR_IBN.DETERMINING)}const S={};if(a.Mapping){S.semanticObjectMapping=X(a.Mapping)}e.push({type:F.DataFieldForIntentBasedNavigation,id:U(t,a),key:w.generateKeyFromDataField(a),text:(c=a.Label)===null||c===void 0?void 0:c.toString(),annotationPath:"",enabled:a.NavigationAvailable!==undefined?R(P(N((u=a.NavigationAvailable)===null||u===void 0?void 0:u.valueOf()),true)):"true",visible:R(L(P(N((v=a.annotations)===null||v===void 0?void 0:(d=v.UI)===null||d===void 0?void 0:(f=d.Hidden)===null||f===void 0?void 0:f.valueOf()),true))),buttonType:oe((m=a.annotations)===null||m===void 0?void 0:(p=m.UI)===null||p===void 0?void 0:p.Emphasized),press:R(x("._intentBasedNavigation.navigate",[N(a.SemanticObject),N(a.Action),S])),customData:R({semanticObject:N(a.SemanticObject),action:N(a.Action)})});break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":const T=n.getManifestControlConfiguration(i).actions;const A=w.generateKeyFromDataField(a);e.push({type:F.DataFieldForAction,id:U(t,a),key:A,text:(g=a.Label)===null||g===void 0?void 0:g.toString(),annotationPath:"",enabled:K(n,a.ActionTarget),binding:s?`{ 'path' : '${s}'}`:undefined,visible:R(L(P(N((b=a.annotations)===null||b===void 0?void 0:(I=b.UI)===null||I===void 0?void 0:(h=I.Hidden)===null||h===void 0?void 0:h.valueOf()),true))),requiresDialog:ce(a.ActionTarget),buttonType:oe((y=a.annotations)===null||y===void 0?void 0:(D=y.UI)===null||D===void 0?void 0:D.Emphasized),press:R(x("invokeAction",[a.Action,{contexts:x("getBindingContext",[],M("","$source")),invocationGrouping:a.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated",label:N(a.Label),model:x("getModel",[],M("/","$source")),isNavigable:G(T&&T[A])}],k(".editFlow"))),facetName:a.Inline?t.fullyQualifiedName:undefined});break;default:break}return e},e);return A(e,o)}function ce(e){if(e){var t,n;const i=(t=e.annotations)===null||t===void 0?void 0:(n=t.Common)===null||n===void 0?void 0:n.IsActionCritical;if(e.parameters.length>1||i){return"Dialog"}else{return"None"}}else{return"None"}}d.isDialog=ce;function ue(e,t){const n={};Object.keys(e).forEach(i=>n[i]=ve(e[i],i,t));return n}d.createCustomSubSections=ue;function ve(e,t,n){const i=e.sideContent?{template:e.sideContent.template,id:y(t),visible:false,equalSplit:e.sideContent.equalSplit}:undefined;let a=e.position;if(!a){a={placement:S.After}}const o=e.visible!==undefined?e.visible:true;const r=o&&typeof o==="string"&&o.indexOf("{=")===0;const s=Q(e.actions,n);const l={type:J.Unknown,id:e.id||D(t),actions:s.actions,key:t,title:e.title,level:1,position:a,visible:e.visible!==undefined?e.visible:true,sideContent:i,isVisibilityDynamic:r};if(e.template||e.name){l.type=J.XMLFragment;l.template=e.template||e.name||""}else{l.type=J.Placeholder}return l}d.createCustomSubSection=ve;function de(e,t,n){const i=n.getManifestWrapper();if(i.useIconTabBar()){return fe(e,t)}else{var a,o,r,s,l,c;const i=n.getEntityType();if((a=i.annotations)!==null&&a!==void 0&&(o=a.UI)!==null&&o!==void 0&&(r=o.Facets)!==null&&r!==void 0&&r.length&&((s=i.annotations)===null||s===void 0?void 0:(l=s.UI)===null||l===void 0?void 0:(c=l.Facets)===null||c===void 0?void 0:c.length)>1){return fe(e,t)}else{return true}}}function fe(e,t){return t.every(function(t){if(t!==e){if(t.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"){var n,i,a,o,r;const e=t;if(((n=e.Target)===null||n===void 0?void 0:(i=n.$target)===null||i===void 0?void 0:i.term)==="com.sap.vocabularies.UI.v1.LineItem"||((a=e.Target)===null||a===void 0?void 0:(o=a.$target)===null||o===void 0?void 0:o.term)==="com.sap.vocabularies.UI.v1.PresentationVariant"||((r=e.Target.$target)===null||r===void 0?void 0:r.term)==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){var s,l,c,u;return((s=e.annotations)===null||s===void 0?void 0:(l=s.UI)===null||l===void 0?void 0:l.Hidden)!==undefined?(c=e.annotations)===null||c===void 0?void 0:(u=c.UI)===null||u===void 0?void 0:u.Hidden:false}return true}else{const e=t;return e.Facets.every(function(e){var t,n,i,a,o,r;const s=e;if(((t=s.Target)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.term)==="com.sap.vocabularies.UI.v1.LineItem"||((i=s.Target)===null||i===void 0?void 0:(a=i.$target)===null||a===void 0?void 0:a.term)==="com.sap.vocabularies.UI.v1.PresentationVariant"||((o=s.Target)===null||o===void 0?void 0:(r=o.$target)===null||r===void 0?void 0:r.term)==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){var l,c,u,v;return((l=s.annotations)===null||l===void 0?void 0:(c=l.UI)===null||c===void 0?void 0:c.Hidden)!==undefined?(u=s.annotations)===null||u===void 0?void 0:(v=u.UI)===null||v===void 0?void 0:v.Hidden:false}return true})}}return true})}return d},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/Aggregation-dbg", ["sap/fe/core/helpers/ModelHelper"], function (ModelHelper) {
  "use strict";

  var _exports = {};
  /**
   * helper class for Aggregation annotations.
   */
  let AggregationHelper = /*#__PURE__*/function () {
    /**
     * Creates a helper for a specific entity type and a converter context.
     *
     * @param entityType The EntityType
     * @param converterContext The ConverterContext
     */
    function AggregationHelper(entityType, converterContext) {
      var _this$_oAggregationAn, _this$_oAggregationAn4, _this$_oAggregationAn7, _this$oTargetAggregat;
      this._entityType = entityType;
      this._converterContext = converterContext;
      this._oAggregationAnnotationTarget = this._determineAggregationAnnotationTarget();
      if (((_this$_oAggregationAn = this._oAggregationAnnotationTarget) === null || _this$_oAggregationAn === void 0 ? void 0 : _this$_oAggregationAn._type) === "NavigationProperty") {
        var _this$_oAggregationAn2, _this$_oAggregationAn3;
        this.oTargetAggregationAnnotations = (_this$_oAggregationAn2 = this._oAggregationAnnotationTarget) === null || _this$_oAggregationAn2 === void 0 ? void 0 : (_this$_oAggregationAn3 = _this$_oAggregationAn2.annotations) === null || _this$_oAggregationAn3 === void 0 ? void 0 : _this$_oAggregationAn3.Aggregation;
      } else if (((_this$_oAggregationAn4 = this._oAggregationAnnotationTarget) === null || _this$_oAggregationAn4 === void 0 ? void 0 : _this$_oAggregationAn4._type) === "EntityType") {
        var _this$_oAggregationAn5, _this$_oAggregationAn6;
        this.oTargetAggregationAnnotations = (_this$_oAggregationAn5 = this._oAggregationAnnotationTarget) === null || _this$_oAggregationAn5 === void 0 ? void 0 : (_this$_oAggregationAn6 = _this$_oAggregationAn5.annotations) === null || _this$_oAggregationAn6 === void 0 ? void 0 : _this$_oAggregationAn6.Aggregation;
      } else if (((_this$_oAggregationAn7 = this._oAggregationAnnotationTarget) === null || _this$_oAggregationAn7 === void 0 ? void 0 : _this$_oAggregationAn7._type) === "EntitySet") {
        var _this$_oAggregationAn8, _this$_oAggregationAn9;
        this.oTargetAggregationAnnotations = (_this$_oAggregationAn8 = this._oAggregationAnnotationTarget) === null || _this$_oAggregationAn8 === void 0 ? void 0 : (_this$_oAggregationAn9 = _this$_oAggregationAn8.annotations) === null || _this$_oAggregationAn9 === void 0 ? void 0 : _this$_oAggregationAn9.Aggregation;
      }
      this._bApplySupported = (_this$oTargetAggregat = this.oTargetAggregationAnnotations) !== null && _this$oTargetAggregat !== void 0 && _this$oTargetAggregat.ApplySupported ? true : false;
      if (this._bApplySupported) {
        var _this$oTargetAggregat2, _this$oTargetAggregat3, _this$oTargetAggregat4, _this$oTargetAggregat5;
        this._aGroupableProperties = (_this$oTargetAggregat2 = this.oTargetAggregationAnnotations) === null || _this$oTargetAggregat2 === void 0 ? void 0 : (_this$oTargetAggregat3 = _this$oTargetAggregat2.ApplySupported) === null || _this$oTargetAggregat3 === void 0 ? void 0 : _this$oTargetAggregat3.GroupableProperties;
        this._aAggregatableProperties = (_this$oTargetAggregat4 = this.oTargetAggregationAnnotations) === null || _this$oTargetAggregat4 === void 0 ? void 0 : (_this$oTargetAggregat5 = _this$oTargetAggregat4.ApplySupported) === null || _this$oTargetAggregat5 === void 0 ? void 0 : _this$oTargetAggregat5.AggregatableProperties;
        this.oContainerAggregationAnnotation = converterContext.getEntityContainer().annotations.Aggregation;
      }
    }
    /**
     * Determines the most appropriate target for the aggregation annotations.
     *
     * @returns  EntityType, EntitySet or NavigationProperty where aggregation annotations should be read from.
     */
    _exports.AggregationHelper = AggregationHelper;
    var _proto = AggregationHelper.prototype;
    _proto._determineAggregationAnnotationTarget = function _determineAggregationAnnotationTarget() {
      var _this$_converterConte, _this$_converterConte2, _this$_converterConte3, _this$_converterConte4, _this$_converterConte5;
      const bIsParameterized = (_this$_converterConte = this._converterContext.getDataModelObjectPath()) !== null && _this$_converterConte !== void 0 && (_this$_converterConte2 = _this$_converterConte.targetEntitySet) !== null && _this$_converterConte2 !== void 0 && (_this$_converterConte3 = _this$_converterConte2.entityType) !== null && _this$_converterConte3 !== void 0 && (_this$_converterConte4 = _this$_converterConte3.annotations) !== null && _this$_converterConte4 !== void 0 && (_this$_converterConte5 = _this$_converterConte4.Common) !== null && _this$_converterConte5 !== void 0 && _this$_converterConte5.ResultContext ? true : false;
      let oAggregationAnnotationSource;

      // find ApplySupported
      if (bIsParameterized) {
        var _oNavigationPropertyO, _oNavigationPropertyO2, _oEntityTypeObject$an, _oEntityTypeObject$an2;
        // if this is a parameterized view then applysupported can be found at either the navProp pointing to the result set or entityType.
        // If applySupported is present at both the navProp and the entityType then navProp is more specific so take annotations from there
        // targetObject in the converter context for a parameterized view is the navigation property pointing to th result set
        const oDataModelObjectPath = this._converterContext.getDataModelObjectPath();
        const oNavigationPropertyObject = oDataModelObjectPath === null || oDataModelObjectPath === void 0 ? void 0 : oDataModelObjectPath.targetObject;
        const oEntityTypeObject = oDataModelObjectPath === null || oDataModelObjectPath === void 0 ? void 0 : oDataModelObjectPath.targetEntityType;
        if (oNavigationPropertyObject !== null && oNavigationPropertyObject !== void 0 && (_oNavigationPropertyO = oNavigationPropertyObject.annotations) !== null && _oNavigationPropertyO !== void 0 && (_oNavigationPropertyO2 = _oNavigationPropertyO.Aggregation) !== null && _oNavigationPropertyO2 !== void 0 && _oNavigationPropertyO2.ApplySupported) {
          oAggregationAnnotationSource = oNavigationPropertyObject;
        } else if (oEntityTypeObject !== null && oEntityTypeObject !== void 0 && (_oEntityTypeObject$an = oEntityTypeObject.annotations) !== null && _oEntityTypeObject$an !== void 0 && (_oEntityTypeObject$an2 = _oEntityTypeObject$an.Aggregation) !== null && _oEntityTypeObject$an2 !== void 0 && _oEntityTypeObject$an2.ApplySupported) {
          oAggregationAnnotationSource = oEntityTypeObject;
        }
      } else {
        var _annotations, _annotations$Aggregat;
        // For the time being, we ignore annotations at the container level, until the vocabulary is stabilized
        const oEntitySetObject = this._converterContext.getEntitySet();
        if (!ModelHelper.isSingleton(oEntitySetObject) && oEntitySetObject !== null && oEntitySetObject !== void 0 && (_annotations = oEntitySetObject.annotations) !== null && _annotations !== void 0 && (_annotations$Aggregat = _annotations.Aggregation) !== null && _annotations$Aggregat !== void 0 && _annotations$Aggregat.ApplySupported) {
          oAggregationAnnotationSource = oEntitySetObject;
        } else {
          oAggregationAnnotationSource = this._converterContext.getEntityType();
        }
      }
      return oAggregationAnnotationSource;
    }

    /**
     * Checks if the entity supports analytical queries.
     *
     * @returns `true` if analytical queries are supported, false otherwise.
     */;
    _proto.isAnalyticsSupported = function isAnalyticsSupported() {
      return this._bApplySupported;
    }

    /**
     * Checks if a property is groupable.
     *
     * @param property The property to check
     * @returns `undefined` if the entity doesn't support analytical queries, true or false otherwise
     */;
    _proto.isPropertyGroupable = function isPropertyGroupable(property) {
      if (!this._bApplySupported) {
        return undefined;
      } else if (!this._aGroupableProperties || this._aGroupableProperties.length === 0) {
        // No groupableProperties --> all properties are groupable
        return true;
      } else {
        return this._aGroupableProperties.findIndex(path => path.$target.fullyQualifiedName === property.fullyQualifiedName) >= 0;
      }
    }

    /**
     * Checks if a property is aggregatable.
     *
     * @param property The property to check
     * @returns `undefined` if the entity doesn't support analytical queries, true or false otherwise
     */;
    _proto.isPropertyAggregatable = function isPropertyAggregatable(property) {
      if (!this._bApplySupported) {
        return undefined;
      } else {
        // Get the custom aggregates
        const aCustomAggregateAnnotations = this._converterContext.getAnnotationsByTerm("Aggregation", "Org.OData.Aggregation.V1.CustomAggregate", [this._oAggregationAnnotationTarget]);

        // Check if a custom aggregate has a qualifier that corresponds to the property name
        return aCustomAggregateAnnotations.some(annotation => {
          return property.name === annotation.qualifier;
        });
      }
    };
    _proto.getGroupableProperties = function getGroupableProperties() {
      return this._aGroupableProperties;
    };
    _proto.getAggregatableProperties = function getAggregatableProperties() {
      return this._aAggregatableProperties;
    };
    _proto.getEntityType = function getEntityType() {
      return this._entityType;
    }

    /**
     * Returns AggregatedProperties or AggregatedProperty based on param Term.
     * The Term here indicates if the AggregatedProperty should be retrieved or the deprecated AggregatedProperties.
     *
     * @param Term The Annotation Term
     * @returns Annotations The appropriate annotations based on the given Term.
     */;
    _proto.getAggregatedProperties = function getAggregatedProperties(Term) {
      if (Term === "AggregatedProperties") {
        return this._converterContext.getAnnotationsByTerm("Analytics", "com.sap.vocabularies.Analytics.v1.AggregatedProperties", [this._converterContext.getEntityContainer(), this._converterContext.getEntityType()]);
      }
      return this._converterContext.getAnnotationsByTerm("Analytics", "com.sap.vocabularies.Analytics.v1.AggregatedProperty", [this._converterContext.getEntityContainer(), this._converterContext.getEntityType()]);
    }
    // retirve all transformation aggregates by prioritizing AggregatedProperty over AggregatedProperties objects
    ;
    _proto.getTransAggregations = function getTransAggregations() {
      var _aAggregatedPropertyO;
      let aAggregatedPropertyObjects = this.getAggregatedProperties("AggregatedProperty");
      if (!aAggregatedPropertyObjects || aAggregatedPropertyObjects.length === 0) {
        aAggregatedPropertyObjects = this.getAggregatedProperties("AggregatedProperties")[0];
      }
      return (_aAggregatedPropertyO = aAggregatedPropertyObjects) === null || _aAggregatedPropertyO === void 0 ? void 0 : _aAggregatedPropertyO.filter(aggregatedProperty => {
        if (this._getAggregatableAggregates(aggregatedProperty.AggregatableProperty)) {
          return aggregatedProperty;
        }
      });
    }

    /**
     * Check if each transformation is aggregatable.
     *
     * @param property The property to check
     * @returns 'aggregatedProperty'
     */;
    _proto._getAggregatableAggregates = function _getAggregatableAggregates(property) {
      const aAggregatableProperties = this.getAggregatableProperties() || [];
      return aAggregatableProperties.find(function (obj) {
        return obj.Property.value === (property.qualifier ? property.qualifier : property.$target.name);
      });
    }

    /**
     * Returns the list of custom aggregate definitions for the entity type.
     *
     * @returns A map (propertyName --> array of context-defining property names) for each custom aggregate corresponding to a property. The array of
     * context-defining property names is empty if the custom aggregate doesn't have any context-defining property.
     */;
    _proto.getCustomAggregateDefinitions = function getCustomAggregateDefinitions() {
      // Get the custom aggregates
      const aCustomAggregateAnnotations = this._converterContext.getAnnotationsByTerm("Aggregation", "Org.OData.Aggregation.V1.CustomAggregate", [this._oAggregationAnnotationTarget]);
      return aCustomAggregateAnnotations;
    }

    /**
     * Returns the list of allowed transformations in the $apply.
     * First look at the current EntitySet, then look at the default values provided at the container level.
     *
     * @returns The list of transformations, or undefined if no list is found
     */;
    _proto.getAllowedTransformations = function getAllowedTransformations() {
      var _this$oTargetAggregat6, _this$oTargetAggregat7, _this$oContainerAggre, _this$oContainerAggre2;
      return ((_this$oTargetAggregat6 = this.oTargetAggregationAnnotations) === null || _this$oTargetAggregat6 === void 0 ? void 0 : (_this$oTargetAggregat7 = _this$oTargetAggregat6.ApplySupported) === null || _this$oTargetAggregat7 === void 0 ? void 0 : _this$oTargetAggregat7.Transformations) || ((_this$oContainerAggre = this.oContainerAggregationAnnotation) === null || _this$oContainerAggre === void 0 ? void 0 : (_this$oContainerAggre2 = _this$oContainerAggre.ApplySupportedDefaults) === null || _this$oContainerAggre2 === void 0 ? void 0 : _this$oContainerAggre2.Transformations);
    };
    return AggregationHelper;
  }();
  _exports.AggregationHelper = AggregationHelper;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/Aggregation", ["sap/fe/core/helpers/ModelHelper"],function(t){"use strict";var e={};let n=function(){function n(t,e){var n,o,i,r;this._entityType=t;this._converterContext=e;this._oAggregationAnnotationTarget=this._determineAggregationAnnotationTarget();if(((n=this._oAggregationAnnotationTarget)===null||n===void 0?void 0:n._type)==="NavigationProperty"){var g,a;this.oTargetAggregationAnnotations=(g=this._oAggregationAnnotationTarget)===null||g===void 0?void 0:(a=g.annotations)===null||a===void 0?void 0:a.Aggregation}else if(((o=this._oAggregationAnnotationTarget)===null||o===void 0?void 0:o._type)==="EntityType"){var l,s;this.oTargetAggregationAnnotations=(l=this._oAggregationAnnotationTarget)===null||l===void 0?void 0:(s=l.annotations)===null||s===void 0?void 0:s.Aggregation}else if(((i=this._oAggregationAnnotationTarget)===null||i===void 0?void 0:i._type)==="EntitySet"){var u,p;this.oTargetAggregationAnnotations=(u=this._oAggregationAnnotationTarget)===null||u===void 0?void 0:(p=u.annotations)===null||p===void 0?void 0:p.Aggregation}this._bApplySupported=(r=this.oTargetAggregationAnnotations)!==null&&r!==void 0&&r.ApplySupported?true:false;if(this._bApplySupported){var A,d,v,y;this._aGroupableProperties=(A=this.oTargetAggregationAnnotations)===null||A===void 0?void 0:(d=A.ApplySupported)===null||d===void 0?void 0:d.GroupableProperties;this._aAggregatableProperties=(v=this.oTargetAggregationAnnotations)===null||v===void 0?void 0:(y=v.ApplySupported)===null||y===void 0?void 0:y.AggregatableProperties;this.oContainerAggregationAnnotation=e.getEntityContainer().annotations.Aggregation}}e.AggregationHelper=n;var o=n.prototype;o._determineAggregationAnnotationTarget=function e(){var n,o,i,r,g;const a=(n=this._converterContext.getDataModelObjectPath())!==null&&n!==void 0&&(o=n.targetEntitySet)!==null&&o!==void 0&&(i=o.entityType)!==null&&i!==void 0&&(r=i.annotations)!==null&&r!==void 0&&(g=r.Common)!==null&&g!==void 0&&g.ResultContext?true:false;let l;if(a){var s,u,p,A;const t=this._converterContext.getDataModelObjectPath();const e=t===null||t===void 0?void 0:t.targetObject;const n=t===null||t===void 0?void 0:t.targetEntityType;if(e!==null&&e!==void 0&&(s=e.annotations)!==null&&s!==void 0&&(u=s.Aggregation)!==null&&u!==void 0&&u.ApplySupported){l=e}else if(n!==null&&n!==void 0&&(p=n.annotations)!==null&&p!==void 0&&(A=p.Aggregation)!==null&&A!==void 0&&A.ApplySupported){l=n}}else{var d,v;const e=this._converterContext.getEntitySet();if(!t.isSingleton(e)&&e!==null&&e!==void 0&&(d=e.annotations)!==null&&d!==void 0&&(v=d.Aggregation)!==null&&v!==void 0&&v.ApplySupported){l=e}else{l=this._converterContext.getEntityType()}}return l};o.isAnalyticsSupported=function t(){return this._bApplySupported};o.isPropertyGroupable=function t(e){if(!this._bApplySupported){return undefined}else if(!this._aGroupableProperties||this._aGroupableProperties.length===0){return true}else{return this._aGroupableProperties.findIndex(t=>t.$target.fullyQualifiedName===e.fullyQualifiedName)>=0}};o.isPropertyAggregatable=function t(e){if(!this._bApplySupported){return undefined}else{const t=this._converterContext.getAnnotationsByTerm("Aggregation","Org.OData.Aggregation.V1.CustomAggregate",[this._oAggregationAnnotationTarget]);return t.some(t=>e.name===t.qualifier)}};o.getGroupableProperties=function t(){return this._aGroupableProperties};o.getAggregatableProperties=function t(){return this._aAggregatableProperties};o.getEntityType=function t(){return this._entityType};o.getAggregatedProperties=function t(e){if(e==="AggregatedProperties"){return this._converterContext.getAnnotationsByTerm("Analytics","com.sap.vocabularies.Analytics.v1.AggregatedProperties",[this._converterContext.getEntityContainer(),this._converterContext.getEntityType()])}return this._converterContext.getAnnotationsByTerm("Analytics","com.sap.vocabularies.Analytics.v1.AggregatedProperty",[this._converterContext.getEntityContainer(),this._converterContext.getEntityType()])};o.getTransAggregations=function t(){var e;let n=this.getAggregatedProperties("AggregatedProperty");if(!n||n.length===0){n=this.getAggregatedProperties("AggregatedProperties")[0]}return(e=n)===null||e===void 0?void 0:e.filter(t=>{if(this._getAggregatableAggregates(t.AggregatableProperty)){return t}})};o._getAggregatableAggregates=function t(e){const n=this.getAggregatableProperties()||[];return n.find(function(t){return t.Property.value===(e.qualifier?e.qualifier:e.$target.name)})};o.getCustomAggregateDefinitions=function t(){const e=this._converterContext.getAnnotationsByTerm("Aggregation","Org.OData.Aggregation.V1.CustomAggregate",[this._oAggregationAnnotationTarget]);return e};o.getAllowedTransformations=function t(){var e,n,o,i;return((e=this.oTargetAggregationAnnotations)===null||e===void 0?void 0:(n=e.ApplySupported)===null||n===void 0?void 0:n.Transformations)||((o=this.oContainerAggregationAnnotation)===null||o===void 0?void 0:(i=o.ApplySupportedDefaults)===null||i===void 0?void 0:i.Transformations)};return n}();e.AggregationHelper=n;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/BindingHelper-dbg", ["sap/fe/core/helpers/BindingToolkit"], function (BindingToolkit) {
  "use strict";

  var _exports = {};
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var not = BindingToolkit.not;
  var equal = BindingToolkit.equal;
  var and = BindingToolkit.and;
  const UI = {
    IsCreateMode: pathInModel("createMode", "ui"),
    IsEditable: pathInModel("/isEditable", "ui"),
    IsTransientBinding: equal(pathInModel("@$ui5.context.isTransient"), true),
    IsTotal: equal(pathInModel("@$ui5.node.isTotal"), true),
    IsExpanded: equal(pathInModel("@$ui5.node.isExpanded"), true),
    NodeLevel: pathInModel("@$ui5.node.level"),
    IsInactive: pathInModel("@$ui5.context.isInactive")
  };
  _exports.UI = UI;
  const Entity = {
    HasDraft: pathInModel("HasDraftEntity"),
    HasActive: pathInModel("HasActiveEntity"),
    IsActive: pathInModel("IsActiveEntity")
  };
  _exports.Entity = Entity;
  const Draft = {
    IsNewObject: and(not(Entity.HasActive), not(Entity.IsActive)),
    HasNoDraftForCurrentUser: or(not(Entity.HasDraft), and(Entity.HasDraft, not(pathInModel("DraftAdministrativeData/DraftIsCreatedByMe"))))
  };

  /**
   * Gets a singleton based on the fully qualified name.
   *
   * @param convertedTypes The converted types
   * @param fullyQualifiedName The fully qualified name of the singleton
   * @returns The singleton instance.
   */
  _exports.Draft = Draft;
  function getSingleton(convertedTypes, fullyQualifiedName) {
    return convertedTypes.singletons.find(singleton => singleton.fullyQualifiedName === fullyQualifiedName);
  }

  /**
   * Function to adjust singleton paths in the annotation.
   * The absolute path via EntityContainer needs to be shortened to /SingletonName/PropertyName.
   *
   * @param path The path configured in the annotation
   * @param convertedTypes The instance of the converter context
   * @param visitedNavigationPaths The array of visited navigation paths
   * @returns The adjusted path for the reference of the singleton property, otherwise the input path itself.
   */
  const singletonPathVisitor = function (path, convertedTypes, visitedNavigationPaths) {
    // Determine whether the path is absolute and whether it points to a singleton.
    if (path.indexOf("/") === 0) {
      const parts = path.split("/").filter(Boolean),
        propertyName = parts.pop(),
        entitySetName = parts.join("/"),
        singleton = getSingleton(convertedTypes, entitySetName);
      if (singleton) {
        // Set the absolute binding path to access the singleton property
        path = `/${singleton.name}/${propertyName}`;
      }
    } else {
      // Not a singleton reference.
      // Prefix the navigation path to the property path
      const localPath = visitedNavigationPaths.concat();
      localPath.push(path);
      path = localPath.join("/");
    }
    return path;
  };

  /**
   * Function to adjust property paths defined in the binding of an action.
   *
   * The binding parameter name needs to be removed. Singleton paths need to be resolved.
   *
   * @param path The path configured in the annotation
   * @param converterContext The instance of the converter context
   * @param bindingParameterFullName The fully qualified name of the binding parameter
   * @returns The adjusted property path
   */
  _exports.singletonPathVisitor = singletonPathVisitor;
  function bindingContextPathVisitor(path, converterContext, bindingParameterFullName) {
    const bindingParameterPrefix = `${bindingParameterFullName === null || bindingParameterFullName === void 0 ? void 0 : bindingParameterFullName.substring(bindingParameterFullName.lastIndexOf("/") + 1)}/`;
    // Strip the binding parameter name from OperationAvailable path
    // For e.g. _it/property1 --> property1
    if (path.startsWith(bindingParameterPrefix)) {
      return path.substring(bindingParameterPrefix.length);
    }
    return singletonPathVisitor(path, converterContext.getConvertedTypes(), []);
  }
  _exports.bindingContextPathVisitor = bindingContextPathVisitor;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/BindingHelper", ["sap/fe/core/helpers/BindingToolkit"],function(t){"use strict";var e={};var i=t.pathInModel;var n=t.or;var s=t.not;var a=t.equal;var r=t.and;const o={IsCreateMode:i("createMode","ui"),IsEditable:i("/isEditable","ui"),IsTransientBinding:a(i("@$ui5.context.isTransient"),true),IsTotal:a(i("@$ui5.node.isTotal"),true),IsExpanded:a(i("@$ui5.node.isExpanded"),true),NodeLevel:i("@$ui5.node.level"),IsInactive:i("@$ui5.context.isInactive")};e.UI=o;const u={HasDraft:i("HasDraftEntity"),HasActive:i("HasActiveEntity"),IsActive:i("IsActiveEntity")};e.Entity=u;const c={IsNewObject:r(s(u.HasActive),s(u.IsActive)),HasNoDraftForCurrentUser:n(s(u.HasDraft),r(u.HasDraft,s(i("DraftAdministrativeData/DraftIsCreatedByMe"))))};e.Draft=c;function d(t,e){return t.singletons.find(t=>t.fullyQualifiedName===e)}const l=function(t,e,i){if(t.indexOf("/")===0){const i=t.split("/").filter(Boolean),n=i.pop(),s=i.join("/"),a=d(e,s);if(a){t=`/${a.name}/${n}`}}else{const e=i.concat();e.push(t);t=e.join("/")}return t};e.singletonPathVisitor=l;function f(t,e,i){const n=`${i===null||i===void 0?void 0:i.substring(i.lastIndexOf("/")+1)}/`;if(t.startsWith(n)){return t.substring(n.length)}return l(t,e.getConvertedTypes(),[])}e.bindingContextPathVisitor=f;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/ConfigurableObject-dbg", ["sap/base/Log"], function (Log) {
  "use strict";

  var _exports = {};
  let Placement;
  (function (Placement) {
    Placement["After"] = "After";
    Placement["Before"] = "Before";
    Placement["End"] = "End";
  })(Placement || (Placement = {}));
  _exports.Placement = Placement;
  /**
   * Recursive method that order the keys based on a position information.
   *
   * @param positioningItems
   * @param anchor
   * @param sorted
   * @param visited
   * @returns The order of the current item
   */
  const orderPositioningItemRecursively = (positioningItems, anchor, sorted, visited) => {
    let insertIndex = sorted.indexOf(anchor);
    if (insertIndex !== -1) {
      return insertIndex;
    }
    const anchorItem = positioningItems[anchor];
    if (anchorItem === undefined) {
      const anchorText = anchor.split("::"),
        manifestItem = Object.keys(visited)[0];
      Log.warning(`Position anchor '${anchorText[anchorText.length - 1]}' not found for item '${manifestItem}'. Please check manifest settings.`);
      return sorted.length;
      // throw new Error(`position anchor not found: ${anchor}`);
    }

    visited[anchor] = anchorItem;
    if (anchorItem && !(anchorItem.anchor in visited)) {
      insertIndex = orderPositioningItemRecursively(positioningItems, anchorItem.anchor, sorted, visited);
      if (anchorItem.placement !== Placement.Before) {
        ++insertIndex;
      }
    } else {
      insertIndex = sorted.length;
    }
    sorted.splice(insertIndex, 0, anchor);
    return insertIndex;
  };
  let OverrideType;
  (function (OverrideType) {
    OverrideType["merge"] = "merge";
    OverrideType["overwrite"] = "overwrite";
    OverrideType["ignore"] = "ignore";
  })(OverrideType || (OverrideType = {}));
  _exports.OverrideType = OverrideType;
  function isArrayConfig(config) {
    return typeof config === "object";
  }
  function applyOverride(overwritableKeys, sourceItem, customElement) {
    const outItem = sourceItem || customElement;
    for (const overwritableKey in overwritableKeys) {
      if (Object.hasOwnProperty.call(overwritableKeys, overwritableKey)) {
        const overrideConfig = overwritableKeys[overwritableKey];
        if (sourceItem !== null) {
          switch (overrideConfig) {
            case "overwrite":
              if (customElement.hasOwnProperty(overwritableKey) && customElement[overwritableKey] !== undefined) {
                sourceItem[overwritableKey] = customElement[overwritableKey];
              }
              break;
            case "merge":
            default:
              const subItem = sourceItem[overwritableKey] || [];
              let subConfig = {};
              if (isArrayConfig(overrideConfig)) {
                subConfig = overrideConfig;
              }
              if (Array.isArray(subItem)) {
                sourceItem[overwritableKey] = insertCustomElements(subItem, customElement && customElement[overwritableKey] || {}, subConfig);
              }
              break;
          }
        } else {
          switch (overrideConfig) {
            case "overwrite":
              if (customElement.hasOwnProperty(overwritableKey) && customElement[overwritableKey] !== undefined) {
                outItem[overwritableKey] = customElement[overwritableKey];
              }
              break;
            case "merge":
            default:
              let subConfig = {};
              if (isArrayConfig(overrideConfig)) {
                subConfig = overrideConfig;
              }
              outItem[overwritableKey] = insertCustomElements([], customElement && customElement[overwritableKey] || {}, subConfig);
              break;
          }
        }
      }
    }
    return outItem;
  }

  /**
   * Insert a set of custom elements in the right position in an original collection.
   *
   * Parameters for overwritableKeys and their implications:
   * "overwrite": The whole object gets overwritten - if the customElements include a default, this will overrule the whole rootElements configuration.
   * "merge": This is similar to calling insertCustomElements itself. You must include the
   * full CustomElement syntax within the customElements, including anchors, for example.
   * "ignore": There are no additions and no combinations. Only the rootElements object is used.
   *
   * Note - Proceed as follows in case you have defined customElements and do not want to overwrite their values with defaults:
   * Hand the rootElements into the creation function of the customElement.
   * Depending on the existence of both rootElement-configuration and customElement-configuration,
   * you must set the customElements property, for which the "overwrite"-property is set, explicitly to undefined.
   *
   * @template T
   * @param rootElements A list of "ConfigurableObject" which means object that have a unique "key"
   * @param customElements An object containing extra object to add, they are indexed by a key and have a "position" object
   * @param overwritableKeys The list of keys from the original object that can be overwritten in case a custom element has the same "key"
   * @returns An ordered array of elements including the custom ones
   */
  function insertCustomElements(rootElements, customElements) {
    let overwritableKeys = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    const firstAnchor = rootElements.length ? rootElements[0].key : null;
    const rootElementsWithoutLast = rootElements.filter(rootElement => {
      var _rootElement$position;
      return ((_rootElement$position = rootElement.position) === null || _rootElement$position === void 0 ? void 0 : _rootElement$position.placement) !== Placement.End;
    });
    const lastAnchor = rootElements.length ? rootElements[rootElementsWithoutLast.length - 1].key : null;
    let endElement;
    const positioningItems = {};
    const itemsPerKey = {};
    rootElements.forEach(rootElement => {
      var _rootElement$position2;
      if (((_rootElement$position2 = rootElement.position) === null || _rootElement$position2 === void 0 ? void 0 : _rootElement$position2.placement) === Placement.End && !endElement) {
        endElement = rootElement;
      } else {
        var _rootElement$position3, _rootElement$position4;
        positioningItems[rootElement.key] = {
          anchor: ((_rootElement$position3 = rootElement.position) === null || _rootElement$position3 === void 0 ? void 0 : _rootElement$position3.anchor) || rootElement.key,
          placement: ((_rootElement$position4 = rootElement.position) === null || _rootElement$position4 === void 0 ? void 0 : _rootElement$position4.placement) || Placement.After
        };
      }
      itemsPerKey[rootElement.key] = rootElement;
    });
    Object.keys(customElements).forEach(customElementKey => {
      var _customElement$menu;
      const customElement = customElements[customElementKey];
      const anchor = customElement.position.anchor;
      // If no placement defined we are After
      if (!customElement.position.placement) {
        customElement.position.placement = Placement.After;
      }
      // If no anchor we're either After the last anchor or Before the first
      if (!anchor) {
        const potentialAnchor = customElement.position.placement === Placement.After ? lastAnchor : firstAnchor;
        customElement.position.anchor = potentialAnchor ? potentialAnchor : customElementKey;
      }

      // Adding bound/unbound actions to menu
      customElement.menu = customElement === null || customElement === void 0 ? void 0 : (_customElement$menu = customElement.menu) === null || _customElement$menu === void 0 ? void 0 : _customElement$menu.map(menu => {
        return itemsPerKey[menu.key] ?? menu;
      });
      if (itemsPerKey[customElement.key]) {
        itemsPerKey[customElement.key] = applyOverride(overwritableKeys, itemsPerKey[customElement.key], customElement);

        //Position is overwritten for filter fields if there is a change in manifest
        if (anchor && customElement.position && overwritableKeys.position && overwritableKeys.position === "overwrite") {
          positioningItems[customElement.key] = itemsPerKey[customElement.key].position;
        }
        /**
         * anchor check is added to make sure change in properties in the manifest does not affect the position of the field.
         * Otherwise, when no position is mentioned in manifest for an altered field, the position is changed as
         * per the potential anchor
         */
      } else {
        itemsPerKey[customElement.key] = applyOverride(overwritableKeys, null, customElement);
        positioningItems[customElement.key] = customElement.position;
      }
    });
    const sortedKeys = [];
    Object.keys(positioningItems).forEach(positionItemKey => {
      orderPositioningItemRecursively(positioningItems, positionItemKey, sortedKeys, {});
    });
    const outElements = sortedKeys.map(key => itemsPerKey[key]);
    if (endElement) {
      outElements.push(endElement);
    }
    return outElements;
  }
  _exports.insertCustomElements = insertCustomElements;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/ConfigurableObject", ["sap/base/Log"],function(e){"use strict";var n={};let t;(function(e){e["After"]="After";e["Before"]="Before";e["End"]="End"})(t||(t={}));n.Placement=t;const o=(n,i,r,s)=>{let c=r.indexOf(i);if(c!==-1){return c}const l=n[i];if(l===undefined){const n=i.split("::"),t=Object.keys(s)[0];e.warning(`Position anchor '${n[n.length-1]}' not found for item '${t}'. Please check manifest settings.`);return r.length}s[i]=l;if(l&&!(l.anchor in s)){c=o(n,l.anchor,r,s);if(l.placement!==t.Before){++c}}else{c=r.length}r.splice(c,0,i);return c};let i;(function(e){e["merge"]="merge";e["overwrite"]="overwrite";e["ignore"]="ignore"})(i||(i={}));n.OverrideType=i;function r(e){return typeof e==="object"}function s(e,n,t){const o=n||t;for(const i in e){if(Object.hasOwnProperty.call(e,i)){const s=e[i];if(n!==null){switch(s){case"overwrite":if(t.hasOwnProperty(i)&&t[i]!==undefined){n[i]=t[i]}break;case"merge":default:const e=n[i]||[];let o={};if(r(s)){o=s}if(Array.isArray(e)){n[i]=c(e,t&&t[i]||{},o)}break}}else{switch(s){case"overwrite":if(t.hasOwnProperty(i)&&t[i]!==undefined){o[i]=t[i]}break;case"merge":default:let e={};if(r(s)){e=s}o[i]=c([],t&&t[i]||{},e);break}}}}return o}function c(e,n){let i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const r=e.length?e[0].key:null;const c=e.filter(e=>{var n;return((n=e.position)===null||n===void 0?void 0:n.placement)!==t.End});const l=e.length?e[c.length-1].key:null;let a;const f={};const u={};e.forEach(e=>{var n;if(((n=e.position)===null||n===void 0?void 0:n.placement)===t.End&&!a){a=e}else{var o,i;f[e.key]={anchor:((o=e.position)===null||o===void 0?void 0:o.anchor)||e.key,placement:((i=e.position)===null||i===void 0?void 0:i.placement)||t.After}}u[e.key]=e});Object.keys(n).forEach(e=>{var o;const c=n[e];const a=c.position.anchor;if(!c.position.placement){c.position.placement=t.After}if(!a){const n=c.position.placement===t.After?l:r;c.position.anchor=n?n:e}c.menu=c===null||c===void 0?void 0:(o=c.menu)===null||o===void 0?void 0:o.map(e=>u[e.key]??e);if(u[c.key]){u[c.key]=s(i,u[c.key],c);if(a&&c.position&&i.position&&i.position==="overwrite"){f[c.key]=u[c.key].position}}else{u[c.key]=s(i,null,c);f[c.key]=c.position}});const p=[];Object.keys(f).forEach(e=>{o(f,e,p,{})});const d=p.map(e=>u[e]);if(a){d.push(a)}return d}n.insertCustomElements=c;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/DataFieldHelper-dbg", ["sap/base/Log"], function (Log) {
  "use strict";

  var _exports = {};
  //function to check for statically hidden reference properties
  function isReferencePropertyStaticallyHidden(property) {
    var _property$annotations, _property$annotations2, _property$annotations3, _property$Value, _property$Value$$targ, _property$Value$$targ2, _property$Value$$targ3, _property$Value$$targ4, _property$Value3, _property$Value3$$tar, _propertyValueAnnotat, _propertyValueAnnotat2, _property$annotations4, _property$annotations5, _property$annotations6;
    if (property) {
      switch (property.$Type) {
        case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
          return isAnnotationFieldStaticallyHidden(property);
        case "com.sap.vocabularies.UI.v1.DataField":
          if (((_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : (_property$annotations2 = _property$annotations.UI) === null || _property$annotations2 === void 0 ? void 0 : (_property$annotations3 = _property$annotations2.Hidden) === null || _property$annotations3 === void 0 ? void 0 : _property$annotations3.valueOf()) === true) {
            var _UI, _UI$HiddenFilter;
            if (property.annotations && ((_UI = property.annotations.UI) === null || _UI === void 0 ? void 0 : (_UI$HiddenFilter = _UI.HiddenFilter) === null || _UI$HiddenFilter === void 0 ? void 0 : _UI$HiddenFilter.valueOf()) === true) {
              Log.warning("Warning: Property " + property.Value.path + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
            }
            return true;
          } else if (((_property$Value = property.Value) === null || _property$Value === void 0 ? void 0 : (_property$Value$$targ = _property$Value.$target) === null || _property$Value$$targ === void 0 ? void 0 : (_property$Value$$targ2 = _property$Value$$targ.annotations) === null || _property$Value$$targ2 === void 0 ? void 0 : (_property$Value$$targ3 = _property$Value$$targ2.UI) === null || _property$Value$$targ3 === void 0 ? void 0 : (_property$Value$$targ4 = _property$Value$$targ3.Hidden) === null || _property$Value$$targ4 === void 0 ? void 0 : _property$Value$$targ4.valueOf()) === true) {
            var _property$Value2, _property$Value2$$tar, _property$Value2$$tar2, _property$Value2$$tar3, _property$Value2$$tar4;
            if (((_property$Value2 = property.Value) === null || _property$Value2 === void 0 ? void 0 : (_property$Value2$$tar = _property$Value2.$target) === null || _property$Value2$$tar === void 0 ? void 0 : (_property$Value2$$tar2 = _property$Value2$$tar.annotations) === null || _property$Value2$$tar2 === void 0 ? void 0 : (_property$Value2$$tar3 = _property$Value2$$tar2.UI) === null || _property$Value2$$tar3 === void 0 ? void 0 : (_property$Value2$$tar4 = _property$Value2$$tar3.HiddenFilter) === null || _property$Value2$$tar4 === void 0 ? void 0 : _property$Value2$$tar4.valueOf()) === true) {
              Log.warning("Warning: Property " + property.Value.path + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
            }
            return true;
          } else {
            return false;
          }
        case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
          const propertyValueAnnotation = (_property$Value3 = property.Value) === null || _property$Value3 === void 0 ? void 0 : (_property$Value3$$tar = _property$Value3.$target) === null || _property$Value3$$tar === void 0 ? void 0 : _property$Value3$$tar.annotations;
          if ((propertyValueAnnotation === null || propertyValueAnnotation === void 0 ? void 0 : (_propertyValueAnnotat = propertyValueAnnotation.UI) === null || _propertyValueAnnotat === void 0 ? void 0 : (_propertyValueAnnotat2 = _propertyValueAnnotat.Hidden) === null || _propertyValueAnnotat2 === void 0 ? void 0 : _propertyValueAnnotat2.valueOf()) === true) {
            var _propertyValueAnnotat3, _propertyValueAnnotat4;
            if ((propertyValueAnnotation === null || propertyValueAnnotation === void 0 ? void 0 : (_propertyValueAnnotat3 = propertyValueAnnotation.UI) === null || _propertyValueAnnotat3 === void 0 ? void 0 : (_propertyValueAnnotat4 = _propertyValueAnnotat3.HiddenFilter) === null || _propertyValueAnnotat4 === void 0 ? void 0 : _propertyValueAnnotat4.valueOf()) === true) {
              Log.warning("Warning: Property " + property.Value.path + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
            }
            return true;
          } else {
            return false;
          }
        case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
          if (((_property$annotations4 = property.annotations) === null || _property$annotations4 === void 0 ? void 0 : (_property$annotations5 = _property$annotations4.UI) === null || _property$annotations5 === void 0 ? void 0 : (_property$annotations6 = _property$annotations5.Hidden) === null || _property$annotations6 === void 0 ? void 0 : _property$annotations6.valueOf()) === true) {
            var _UI2, _UI2$HiddenFilter;
            if (property.annotations && ((_UI2 = property.annotations.UI) === null || _UI2 === void 0 ? void 0 : (_UI2$HiddenFilter = _UI2.HiddenFilter) === null || _UI2$HiddenFilter === void 0 ? void 0 : _UI2$HiddenFilter.valueOf()) === true) {
              Log.warning("Warning: Property " + property.Value.path + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
            }
            return true;
          } else {
            return false;
          }
        default:
      }
    }
  }
  _exports.isReferencePropertyStaticallyHidden = isReferencePropertyStaticallyHidden;
  function isAnnotationFieldStaticallyHidden(annotationProperty) {
    var _propertyValueAnnotat5, _propertyValueAnnotat6, _propertyValueAnnotat7;
    const target = annotationProperty.Target.$target.term;
    // let ChartAnnotation: Chart, ConnectedFieldsAnnotation: ConnectedFields, FieldGroupAnnotation: FieldGroup, DataPointAnnotation: DataPoint;
    switch (target) {
      case "com.sap.vocabularies.UI.v1.Chart":
        let ischartMeasureHidden;
        annotationProperty.Target.$target.Measures.forEach(chartMeasure => {
          var _chartMeasure$$target, _chartMeasure$$target2, _chartMeasure$$target3;
          if (((_chartMeasure$$target = chartMeasure.$target.annotations) === null || _chartMeasure$$target === void 0 ? void 0 : (_chartMeasure$$target2 = _chartMeasure$$target.UI) === null || _chartMeasure$$target2 === void 0 ? void 0 : (_chartMeasure$$target3 = _chartMeasure$$target2.Hidden) === null || _chartMeasure$$target3 === void 0 ? void 0 : _chartMeasure$$target3.valueOf()) === true) {
            var _UI3, _UI3$HiddenFilter;
            Log.warning("Warning: Measure attribute for Chart " + chartMeasure.$target.name + " is statically hidden hence chart can't be rendered");
            if (chartMeasure.$target.annotations && ((_UI3 = chartMeasure.$target.annotations.UI) === null || _UI3 === void 0 ? void 0 : (_UI3$HiddenFilter = _UI3.HiddenFilter) === null || _UI3$HiddenFilter === void 0 ? void 0 : _UI3$HiddenFilter.valueOf()) === true) {
              Log.warning("Warning: Property " + chartMeasure.$target.name + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
            }
            ischartMeasureHidden = true;
          }
        });
        if (ischartMeasureHidden === true) {
          return true;
        } else {
          return false;
        }
      case "com.sap.vocabularies.UI.v1.ConnectedFields":
        if (annotationProperty) {
          var _annotationProperty$a, _annotationProperty$a2, _annotationProperty$a3;
          if (((_annotationProperty$a = annotationProperty.annotations) === null || _annotationProperty$a === void 0 ? void 0 : (_annotationProperty$a2 = _annotationProperty$a.UI) === null || _annotationProperty$a2 === void 0 ? void 0 : (_annotationProperty$a3 = _annotationProperty$a2.Hidden) === null || _annotationProperty$a3 === void 0 ? void 0 : _annotationProperty$a3.valueOf()) === true) {
            var _UI4, _UI4$HiddenFilter;
            if (annotationProperty.annotations && ((_UI4 = annotationProperty.annotations.UI) === null || _UI4 === void 0 ? void 0 : (_UI4$HiddenFilter = _UI4.HiddenFilter) === null || _UI4$HiddenFilter === void 0 ? void 0 : _UI4$HiddenFilter.valueOf()) === true) {
              Log.warning("Warning: Property " + annotationProperty.Target.$target.qualifier + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
            }
            return true;
          } else {
            return false;
          }
        }
        break;
      case "com.sap.vocabularies.UI.v1.FieldGroup":
        if (annotationProperty) {
          if (annotationProperty.Target.$target.Data.every(field => isReferencePropertyStaticallyHidden(field) === true)) {
            return true;
          } else {
            return false;
          }
        }
        break;
      case "com.sap.vocabularies.UI.v1.DataPoint":
        const propertyValueAnnotation = annotationProperty.Target.$target.Value.$target;
        if (((_propertyValueAnnotat5 = propertyValueAnnotation.annotations) === null || _propertyValueAnnotat5 === void 0 ? void 0 : (_propertyValueAnnotat6 = _propertyValueAnnotat5.UI) === null || _propertyValueAnnotat6 === void 0 ? void 0 : (_propertyValueAnnotat7 = _propertyValueAnnotat6.Hidden) === null || _propertyValueAnnotat7 === void 0 ? void 0 : _propertyValueAnnotat7.valueOf()) === true) {
          var _propertyValueAnnotat8, _propertyValueAnnotat9, _propertyValueAnnotat10;
          if (((_propertyValueAnnotat8 = propertyValueAnnotation.annotations) === null || _propertyValueAnnotat8 === void 0 ? void 0 : (_propertyValueAnnotat9 = _propertyValueAnnotat8.UI) === null || _propertyValueAnnotat9 === void 0 ? void 0 : (_propertyValueAnnotat10 = _propertyValueAnnotat9.HiddenFilter) === null || _propertyValueAnnotat10 === void 0 ? void 0 : _propertyValueAnnotat10.valueOf()) === true) {
            Log.warning("Warning: Property " + annotationProperty.Target.$target.Value.path + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
          }
          return true;
        } else {
          return false;
        }
      default:
    }
  }
  _exports.isAnnotationFieldStaticallyHidden = isAnnotationFieldStaticallyHidden;
  function isHeaderStaticallyHidden(property) {
    if (property.targetObject) {
      var _headerInfoAnnotation, _headerInfoAnnotation2, _headerInfoAnnotation3, _headerInfoAnnotation9, _headerInfoAnnotation10, _headerInfoAnnotation11, _headerInfoAnnotation12, _headerInfoAnnotation13, _headerInfoAnnotation14;
      const headerInfoAnnotation = property.targetObject;
      if (headerInfoAnnotation.annotations && ((_headerInfoAnnotation = headerInfoAnnotation.annotations) === null || _headerInfoAnnotation === void 0 ? void 0 : (_headerInfoAnnotation2 = _headerInfoAnnotation.UI) === null || _headerInfoAnnotation2 === void 0 ? void 0 : (_headerInfoAnnotation3 = _headerInfoAnnotation2.Hidden) === null || _headerInfoAnnotation3 === void 0 ? void 0 : _headerInfoAnnotation3.valueOf()) === true) {
        var _headerInfoAnnotation4, _headerInfoAnnotation5, _headerInfoAnnotation6, _headerInfoAnnotation7, _headerInfoAnnotation8;
        if (((_headerInfoAnnotation4 = headerInfoAnnotation.Value) === null || _headerInfoAnnotation4 === void 0 ? void 0 : (_headerInfoAnnotation5 = _headerInfoAnnotation4.$target) === null || _headerInfoAnnotation5 === void 0 ? void 0 : (_headerInfoAnnotation6 = _headerInfoAnnotation5.annotations) === null || _headerInfoAnnotation6 === void 0 ? void 0 : (_headerInfoAnnotation7 = _headerInfoAnnotation6.UI) === null || _headerInfoAnnotation7 === void 0 ? void 0 : (_headerInfoAnnotation8 = _headerInfoAnnotation7.HiddenFilter) === null || _headerInfoAnnotation8 === void 0 ? void 0 : _headerInfoAnnotation8.valueOf()) === true) {
          Log.warning("Warning: Property " + headerInfoAnnotation.Value.path + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
        }
        return true;
      } else if (headerInfoAnnotation !== null && headerInfoAnnotation !== void 0 && (_headerInfoAnnotation9 = headerInfoAnnotation.Value) !== null && _headerInfoAnnotation9 !== void 0 && _headerInfoAnnotation9.$target && (headerInfoAnnotation === null || headerInfoAnnotation === void 0 ? void 0 : (_headerInfoAnnotation10 = headerInfoAnnotation.Value) === null || _headerInfoAnnotation10 === void 0 ? void 0 : (_headerInfoAnnotation11 = _headerInfoAnnotation10.$target) === null || _headerInfoAnnotation11 === void 0 ? void 0 : (_headerInfoAnnotation12 = _headerInfoAnnotation11.annotations) === null || _headerInfoAnnotation12 === void 0 ? void 0 : (_headerInfoAnnotation13 = _headerInfoAnnotation12.UI) === null || _headerInfoAnnotation13 === void 0 ? void 0 : (_headerInfoAnnotation14 = _headerInfoAnnotation13.Hidden) === null || _headerInfoAnnotation14 === void 0 ? void 0 : _headerInfoAnnotation14.valueOf()) === true) {
        var _headerInfoAnnotation15, _headerInfoAnnotation16, _headerInfoAnnotation17, _headerInfoAnnotation18, _headerInfoAnnotation19;
        if ((headerInfoAnnotation === null || headerInfoAnnotation === void 0 ? void 0 : (_headerInfoAnnotation15 = headerInfoAnnotation.Value) === null || _headerInfoAnnotation15 === void 0 ? void 0 : (_headerInfoAnnotation16 = _headerInfoAnnotation15.$target) === null || _headerInfoAnnotation16 === void 0 ? void 0 : (_headerInfoAnnotation17 = _headerInfoAnnotation16.annotations) === null || _headerInfoAnnotation17 === void 0 ? void 0 : (_headerInfoAnnotation18 = _headerInfoAnnotation17.UI) === null || _headerInfoAnnotation18 === void 0 ? void 0 : (_headerInfoAnnotation19 = _headerInfoAnnotation18.HiddenFilter) === null || _headerInfoAnnotation19 === void 0 ? void 0 : _headerInfoAnnotation19.valueOf()) === true) {
          Log.warning("Warning: Property " + headerInfoAnnotation.Value.path + " is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!");
        }
        return true;
      } else {
        return false;
      }
    }
  }
  _exports.isHeaderStaticallyHidden = isHeaderStaticallyHidden;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/DataFieldHelper", ["sap/base/Log"],function(e){"use strict";var i={};function n(i){var n,l,o,d,a,r,v,u,s,f,g,c,U,I,H;if(i){switch(i.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":return t(i);case"com.sap.vocabularies.UI.v1.DataField":if(((n=i.annotations)===null||n===void 0?void 0:(l=n.UI)===null||l===void 0?void 0:(o=l.Hidden)===null||o===void 0?void 0:o.valueOf())===true){var h,p;if(i.annotations&&((h=i.annotations.UI)===null||h===void 0?void 0:(p=h.HiddenFilter)===null||p===void 0?void 0:p.valueOf())===true){e.warning("Warning: Property "+i.Value.path+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else if(((d=i.Value)===null||d===void 0?void 0:(a=d.$target)===null||a===void 0?void 0:(r=a.annotations)===null||r===void 0?void 0:(v=r.UI)===null||v===void 0?void 0:(u=v.Hidden)===null||u===void 0?void 0:u.valueOf())===true){var F,y,b,w,O;if(((F=i.Value)===null||F===void 0?void 0:(y=F.$target)===null||y===void 0?void 0:(b=y.annotations)===null||b===void 0?void 0:(w=b.UI)===null||w===void 0?void 0:(O=w.HiddenFilter)===null||O===void 0?void 0:O.valueOf())===true){e.warning("Warning: Property "+i.Value.path+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else{return false}case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":const m=(s=i.Value)===null||s===void 0?void 0:(f=s.$target)===null||f===void 0?void 0:f.annotations;if((m===null||m===void 0?void 0:(g=m.UI)===null||g===void 0?void 0:(c=g.Hidden)===null||c===void 0?void 0:c.valueOf())===true){var $,V;if((m===null||m===void 0?void 0:($=m.UI)===null||$===void 0?void 0:(V=$.HiddenFilter)===null||V===void 0?void 0:V.valueOf())===true){e.warning("Warning: Property "+i.Value.path+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else{return false}case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":if(((U=i.annotations)===null||U===void 0?void 0:(I=U.UI)===null||I===void 0?void 0:(H=I.Hidden)===null||H===void 0?void 0:H.valueOf())===true){var P,W;if(i.annotations&&((P=i.annotations.UI)===null||P===void 0?void 0:(W=P.HiddenFilter)===null||W===void 0?void 0:W.valueOf())===true){e.warning("Warning: Property "+i.Value.path+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else{return false}default:}}}i.isReferencePropertyStaticallyHidden=n;function t(i){var t,l,o;const d=i.Target.$target.term;switch(d){case"com.sap.vocabularies.UI.v1.Chart":let d;i.Target.$target.Measures.forEach(i=>{var n,t,l;if(((n=i.$target.annotations)===null||n===void 0?void 0:(t=n.UI)===null||t===void 0?void 0:(l=t.Hidden)===null||l===void 0?void 0:l.valueOf())===true){var o,a;e.warning("Warning: Measure attribute for Chart "+i.$target.name+" is statically hidden hence chart can't be rendered");if(i.$target.annotations&&((o=i.$target.annotations.UI)===null||o===void 0?void 0:(a=o.HiddenFilter)===null||a===void 0?void 0:a.valueOf())===true){e.warning("Warning: Property "+i.$target.name+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}d=true}});if(d===true){return true}else{return false}case"com.sap.vocabularies.UI.v1.ConnectedFields":if(i){var a,r,v;if(((a=i.annotations)===null||a===void 0?void 0:(r=a.UI)===null||r===void 0?void 0:(v=r.Hidden)===null||v===void 0?void 0:v.valueOf())===true){var u,s;if(i.annotations&&((u=i.annotations.UI)===null||u===void 0?void 0:(s=u.HiddenFilter)===null||s===void 0?void 0:s.valueOf())===true){e.warning("Warning: Property "+i.Target.$target.qualifier+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else{return false}}break;case"com.sap.vocabularies.UI.v1.FieldGroup":if(i){if(i.Target.$target.Data.every(e=>n(e)===true)){return true}else{return false}}break;case"com.sap.vocabularies.UI.v1.DataPoint":const U=i.Target.$target.Value.$target;if(((t=U.annotations)===null||t===void 0?void 0:(l=t.UI)===null||l===void 0?void 0:(o=l.Hidden)===null||o===void 0?void 0:o.valueOf())===true){var f,g,c;if(((f=U.annotations)===null||f===void 0?void 0:(g=f.UI)===null||g===void 0?void 0:(c=g.HiddenFilter)===null||c===void 0?void 0:c.valueOf())===true){e.warning("Warning: Property "+i.Target.$target.Value.path+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else{return false}default:}}i.isAnnotationFieldStaticallyHidden=t;function l(i){if(i.targetObject){var n,t,l,o,d,a,r,v,u;const y=i.targetObject;if(y.annotations&&((n=y.annotations)===null||n===void 0?void 0:(t=n.UI)===null||t===void 0?void 0:(l=t.Hidden)===null||l===void 0?void 0:l.valueOf())===true){var s,f,g,c,U;if(((s=y.Value)===null||s===void 0?void 0:(f=s.$target)===null||f===void 0?void 0:(g=f.annotations)===null||g===void 0?void 0:(c=g.UI)===null||c===void 0?void 0:(U=c.HiddenFilter)===null||U===void 0?void 0:U.valueOf())===true){e.warning("Warning: Property "+y.Value.path+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else if(y!==null&&y!==void 0&&(o=y.Value)!==null&&o!==void 0&&o.$target&&(y===null||y===void 0?void 0:(d=y.Value)===null||d===void 0?void 0:(a=d.$target)===null||a===void 0?void 0:(r=a.annotations)===null||r===void 0?void 0:(v=r.UI)===null||v===void 0?void 0:(u=v.Hidden)===null||u===void 0?void 0:u.valueOf())===true){var I,H,h,p,F;if((y===null||y===void 0?void 0:(I=y.Value)===null||I===void 0?void 0:(H=I.$target)===null||H===void 0?void 0:(h=H.annotations)===null||h===void 0?void 0:(p=h.UI)===null||p===void 0?void 0:(F=p.HiddenFilter)===null||F===void 0?void 0:F.valueOf())===true){e.warning("Warning: Property "+y.Value.path+" is set with both UI.Hidden and UI.HiddenFilter - please set only one of these! UI.HiddenFilter is ignored currently!")}return true}else{return false}}}i.isHeaderStaticallyHidden=l;return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/ID-dbg", ["../../helpers/StableIdHelper"], function (StableIdHelper) {
  "use strict";

  var _exports = {};
  var generate = StableIdHelper.generate;
  const BASE_ID = ["fe"];

  /**
   * Shortcut to the stableIdHelper providing a "curry" like method where the last parameter is missing.
   *
   * @param sFixedPart
   * @returns A shortcut function with the fixed ID part
   */
  function createIDGenerator() {
    for (var _len = arguments.length, sFixedPart = new Array(_len), _key = 0; _key < _len; _key++) {
      sFixedPart[_key] = arguments[_key];
    }
    return function () {
      for (var _len2 = arguments.length, sIDPart = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        sIDPart[_key2] = arguments[_key2];
      }
      return generate(BASE_ID.concat(...sFixedPart, ...sIDPart));
    };
  }

  /**
   * Those are all helpers to centralize ID generation in the code for different elements
   */
  _exports.createIDGenerator = createIDGenerator;
  const getHeaderFacetID = createIDGenerator("HeaderFacet");
  _exports.getHeaderFacetID = getHeaderFacetID;
  const getHeaderFacetContainerID = createIDGenerator("HeaderFacetContainer");
  _exports.getHeaderFacetContainerID = getHeaderFacetContainerID;
  const getHeaderFacetFormID = createIDGenerator("HeaderFacet", "Form");
  _exports.getHeaderFacetFormID = getHeaderFacetFormID;
  const getCustomHeaderFacetID = createIDGenerator("HeaderFacetCustomContainer");
  _exports.getCustomHeaderFacetID = getCustomHeaderFacetID;
  const getEditableHeaderSectionID = createIDGenerator("EditableHeaderSection");
  _exports.getEditableHeaderSectionID = getEditableHeaderSectionID;
  const getSectionID = createIDGenerator("FacetSection");
  _exports.getSectionID = getSectionID;
  const getCustomSectionID = createIDGenerator("CustomSection");
  _exports.getCustomSectionID = getCustomSectionID;
  const getSubSectionID = createIDGenerator("FacetSubSection");
  _exports.getSubSectionID = getSubSectionID;
  const getCustomSubSectionID = createIDGenerator("CustomSubSection");
  _exports.getCustomSubSectionID = getCustomSubSectionID;
  const getSideContentID = createIDGenerator("SideContent");
  _exports.getSideContentID = getSideContentID;
  const getSideContentLayoutID = function (sSectionID) {
    return generate(["fe", sSectionID, "SideContentLayout"]);
  };
  _exports.getSideContentLayoutID = getSideContentLayoutID;
  const getFormID = createIDGenerator("Form");
  _exports.getFormID = getFormID;
  const getFormContainerID = createIDGenerator("FormContainer");
  _exports.getFormContainerID = getFormContainerID;
  const getFormStandardActionButtonID = function (sFormContainerId, sActionName) {
    return generate(["fe", "FormContainer", sFormContainerId, "StandardAction", sActionName]);
  };
  _exports.getFormStandardActionButtonID = getFormStandardActionButtonID;
  const getTableID = createIDGenerator("table");
  _exports.getTableID = getTableID;
  const getCustomTabID = createIDGenerator("CustomTab");
  _exports.getCustomTabID = getCustomTabID;
  const getFilterBarID = createIDGenerator("FilterBar");
  _exports.getFilterBarID = getFilterBarID;
  const getDynamicListReportID = function () {
    return "fe::ListReport";
  };
  _exports.getDynamicListReportID = getDynamicListReportID;
  const getIconTabBarID = createIDGenerator("TabMultipleMode");
  _exports.getIconTabBarID = getIconTabBarID;
  const getFilterVariantManagementID = function (sFilterID) {
    return generate([sFilterID, "VariantManagement"]);
  };
  _exports.getFilterVariantManagementID = getFilterVariantManagementID;
  const getChartID = createIDGenerator("Chart");
  _exports.getChartID = getChartID;
  const getCustomActionID = function (sActionID) {
    return generate(["CustomAction", sActionID]);
  };
  _exports.getCustomActionID = getCustomActionID;
  const getKPIID = createIDGenerator("KPI");
  _exports.getKPIID = getKPIID;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/ID", ["../../helpers/StableIdHelper"],function(t){"use strict";var e={};var n=t.generate;const o=["fe"];function r(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++){e[r]=arguments[r]}return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++){r[a]=arguments[a]}return n(o.concat(...e,...r))}}e.createIDGenerator=r;const a=r("HeaderFacet");e.getHeaderFacetID=a;const c=r("HeaderFacetContainer");e.getHeaderFacetContainerID=c;const i=r("HeaderFacet","Form");e.getHeaderFacetFormID=i;const s=r("HeaderFacetCustomContainer");e.getCustomHeaderFacetID=s;const u=r("EditableHeaderSection");e.getEditableHeaderSectionID=u;const g=r("FacetSection");e.getSectionID=g;const I=r("CustomSection");e.getCustomSectionID=I;const D=r("FacetSubSection");e.getSubSectionID=D;const d=r("CustomSubSection");e.getCustomSubSectionID=d;const C=r("SideContent");e.getSideContentID=C;const m=function(t){return n(["fe",t,"SideContentLayout"])};e.getSideContentLayoutID=m;const F=r("Form");e.getFormID=F;const S=r("FormContainer");e.getFormContainerID=S;const f=function(t,e){return n(["fe","FormContainer",t,"StandardAction",e])};e.getFormStandardActionButtonID=f;const l=r("table");e.getTableID=l;const b=r("CustomTab");e.getCustomTabID=b;const H=r("FilterBar");e.getFilterBarID=H;const p=function(){return"fe::ListReport"};e.getDynamicListReportID=p;const A=r("TabMultipleMode");e.getIconTabBarID=A;const h=function(t){return n([t,"VariantManagement"])};e.getFilterVariantManagementID=h;const y=r("Chart");e.getChartID=y;const T=function(t){return n(["CustomAction",t])};e.getCustomActionID=T;const v=r("KPI");e.getKPIID=v;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/IssueManager-dbg", [], function () {
  "use strict";

  var _exports = {};
  let IssueSeverity;
  (function (IssueSeverity) {
    IssueSeverity[IssueSeverity["High"] = 0] = "High";
    IssueSeverity[IssueSeverity["Low"] = 1] = "Low";
    IssueSeverity[IssueSeverity["Medium"] = 2] = "Medium";
  })(IssueSeverity || (IssueSeverity = {}));
  _exports.IssueSeverity = IssueSeverity;
  const IssueCategoryType = {
    Facets: {
      MissingID: "MissingID",
      UnSupportedLevel: "UnsupportedLevel"
    },
    AnnotationColumns: {
      InvalidKey: "InvalidKey"
    },
    Annotations: {
      IgnoredAnnotation: "IgnoredAnnotation"
    }
  };
  _exports.IssueCategoryType = IssueCategoryType;
  let IssueCategory;
  (function (IssueCategory) {
    IssueCategory["Annotation"] = "Annotation";
    IssueCategory["Template"] = "Template";
    IssueCategory["Manifest"] = "Manifest";
    IssueCategory["Facets"] = "Facets";
  })(IssueCategory || (IssueCategory = {}));
  _exports.IssueCategory = IssueCategory;
  const IssueType = {
    MISSING_LINEITEM: "We couldn't find a line item annotation for the current entitySet, you should consider adding one.",
    MISSING_SELECTIONFIELD: "Defined Selection Field is not found",
    MALFORMED_DATAFIELD_FOR_IBN: {
      REQUIRESCONTEXT: "DataFieldForIntentBasedNavigation cannot use requires context in form/header.",
      INLINE: "DataFieldForIntentBasedNavigation cannot use Inline in form/header.",
      DETERMINING: "DataFieldForIntentBasedNavigation cannot use Determining in form/header."
    },
    MALFORMED_VISUALFILTERS: {
      VALUELIST: "ValueList Path mentioned in the manifest is not found",
      PRESENTATIONVARIANT: "Presentation Variant Annotation is missing for the VisualFilters",
      CHART: "Chart Annotation is missing from the PV configured for the VisualFilters",
      VALUELISTCONFIG: "ValueList is not been configured inside the Visual Filter Settings"
    },
    FULLSCREENMODE_NOT_ON_LISTREPORT: "enableFullScreenMode is not supported on list report pages.",
    KPI_ISSUES: {
      KPI_NOT_FOUND: "Couldn't find KPI or SPV with qualifier ",
      KPI_DETAIL_NOT_FOUND: "Can't find proper datapoint or chart definition for KPI ",
      NO_ANALYTICS: "The following entitySet used in a KPI definition doesn't support $apply queries:",
      MAIN_PROPERTY_NOT_AGGREGATABLE: "Main property used in KPI cannot be aggregated "
    }
  };
  _exports.IssueType = IssueType;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/IssueManager", [],function(){"use strict";var e={};let n;(function(e){e[e["High"]=0]="High";e[e["Low"]=1]="Low";e[e["Medium"]=2]="Medium"})(n||(n={}));e.IssueSeverity=n;const t={Facets:{MissingID:"MissingID",UnSupportedLevel:"UnsupportedLevel"},AnnotationColumns:{InvalidKey:"InvalidKey"},Annotations:{IgnoredAnnotation:"IgnoredAnnotation"}};e.IssueCategoryType=t;let i;(function(e){e["Annotation"]="Annotation";e["Template"]="Template";e["Manifest"]="Manifest";e["Facets"]="Facets"})(i||(i={}));e.IssueCategory=i;const o={MISSING_LINEITEM:"We couldn't find a line item annotation for the current entitySet, you should consider adding one.",MISSING_SELECTIONFIELD:"Defined Selection Field is not found",MALFORMED_DATAFIELD_FOR_IBN:{REQUIRESCONTEXT:"DataFieldForIntentBasedNavigation cannot use requires context in form/header.",INLINE:"DataFieldForIntentBasedNavigation cannot use Inline in form/header.",DETERMINING:"DataFieldForIntentBasedNavigation cannot use Determining in form/header."},MALFORMED_VISUALFILTERS:{VALUELIST:"ValueList Path mentioned in the manifest is not found",PRESENTATIONVARIANT:"Presentation Variant Annotation is missing for the VisualFilters",CHART:"Chart Annotation is missing from the PV configured for the VisualFilters",VALUELISTCONFIG:"ValueList is not been configured inside the Visual Filter Settings"},FULLSCREENMODE_NOT_ON_LISTREPORT:"enableFullScreenMode is not supported on list report pages.",KPI_ISSUES:{KPI_NOT_FOUND:"Couldn't find KPI or SPV with qualifier ",KPI_DETAIL_NOT_FOUND:"Can't find proper datapoint or chart definition for KPI ",NO_ANALYTICS:"The following entitySet used in a KPI definition doesn't support $apply queries:",MAIN_PROPERTY_NOT_AGGREGATABLE:"Main property used in KPI cannot be aggregated "}};e.IssueType=o;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/Key-dbg", ["../../helpers/StableIdHelper"], function (StableIdHelper) {
  "use strict";

  var _exports = {};
  var getStableIdPartFromDataField = StableIdHelper.getStableIdPartFromDataField;
  /**
   * The KeyHelper is used for dealing with Key in the concern of the flexible programming model
   */
  let KeyHelper = /*#__PURE__*/function () {
    function KeyHelper() {}
    _exports.KeyHelper = KeyHelper;
    /**
     * Returns a generated key for DataFields to be used in the flexible programming model.
     *
     * @param dataField DataField to generate the key for
     * @returns Returns a through StableIdHelper generated key
     */
    KeyHelper.generateKeyFromDataField = function generateKeyFromDataField(dataField) {
      return getStableIdPartFromDataField(dataField, true);
    }

    /**
     * Throws a Error if any other character then aA-zZ, 0-9, ':', '_' or '-' is used.
     *
     * @param key String to check validity on
     */;
    KeyHelper.validateKey = function validateKey(key) {
      const pattern = /[^A-Za-z0-9_\-:]/;
      if (pattern.exec(key)) {
        throw new Error(`Invalid key: ${key} - only 'A-Za-z0-9_-:' are allowed`);
      }
    }

    /**
     * Returns the key for a selection field required for adaption.
     *
     * @param fullPropertyPath The full property path (without entityType)
     * @returns The key of the selection field
     */;
    KeyHelper.getSelectionFieldKeyFromPath = function getSelectionFieldKeyFromPath(fullPropertyPath) {
      return fullPropertyPath.replace(/([*+])?\//g, "::");
    }

    /**
     * Returns the path for a selection field required for adaption.
     *
     * @param selectionFieldKey The key of the selection field
     * @returns The full property path
     */;
    KeyHelper.getPathFromSelectionFieldKey = function getPathFromSelectionFieldKey(selectionFieldKey) {
      return selectionFieldKey.replace(/::/g, "/");
    };
    return KeyHelper;
  }();
  _exports.KeyHelper = KeyHelper;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/Key", ["../../helpers/StableIdHelper"],function(e){"use strict";var t={};var r=e.getStableIdPartFromDataField;let n=function(){function e(){}t.KeyHelper=e;e.generateKeyFromDataField=function e(t){return r(t,true)};e.validateKey=function e(t){const r=/[^A-Za-z0-9_\-:]/;if(r.exec(t)){throw new Error(`Invalid key: ${t} - only 'A-Za-z0-9_-:' are allowed`)}};e.getSelectionFieldKeyFromPath=function e(t){return t.replace(/([*+])?\//g,"::")};e.getPathFromSelectionFieldKey=function e(t){return t.replace(/::/g,"/")};return e}();t.KeyHelper=n;return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/SelectionVariantHelper-dbg", [], function () {
  "use strict";

  var _exports = {};
  function getRangeDefinition(range, propertyType) {
    let operator;
    const bInclude = range.Sign === "UI.SelectionRangeSignType/I" ? true : false;
    switch (range.Option) {
      case "UI.SelectionRangeOptionType/BT":
        operator = bInclude ? "BT" : "NB";
        break;
      case "UI.SelectionRangeOptionType/CP":
        operator = bInclude ? "Contains" : "NotContains";
        break;
      case "UI.SelectionRangeOptionType/EQ":
        operator = bInclude ? "EQ" : "NE";
        break;
      case "UI.SelectionRangeOptionType/GE":
        operator = bInclude ? "GE" : "LT";
        break;
      case "UI.SelectionRangeOptionType/GT":
        operator = bInclude ? "GT" : "LE";
        break;
      case "UI.SelectionRangeOptionType/LE":
        operator = bInclude ? "LE" : "GT";
        break;
      case "UI.SelectionRangeOptionType/LT":
        operator = bInclude ? "LT" : "GE";
        break;
      case "UI.SelectionRangeOptionType/NB":
        operator = bInclude ? "NB" : "BT";
        break;
      case "UI.SelectionRangeOptionType/NE":
        operator = bInclude ? "NE" : "EQ";
        break;
      case "UI.SelectionRangeOptionType/NP":
        operator = bInclude ? "NotContains" : "Contains";
        break;
      default:
        operator = "EQ";
    }
    return {
      operator: operator,
      rangeLow: propertyType && propertyType.indexOf("Edm.Date") === 0 ? new Date(range.Low) : range.Low,
      rangeHigh: range.High && propertyType && propertyType.indexOf("Edm.Date") === 0 ? new Date(range.High) : range.High
    };
  }

  /**
   * Parses a SelectionVariant annotations and creates the corresponding filter definitions.
   *
   * @param selectionVariant SelectionVariant annotation
   * @returns Returns an array of filter definitions corresponding to the SelectionVariant.
   */
  function getFilterDefinitionsFromSelectionVariant(selectionVariant) {
    const aFilterDefs = [];
    if (selectionVariant.SelectOptions) {
      selectionVariant.SelectOptions.forEach(selectOption => {
        if (selectOption.PropertyName && selectOption.Ranges.length > 0) {
          aFilterDefs.push({
            propertyPath: selectOption.PropertyName.value,
            propertyType: selectOption.PropertyName.$target.type,
            ranges: selectOption.Ranges.map(range => {
              var _selectOption$Propert;
              return getRangeDefinition(range, (_selectOption$Propert = selectOption.PropertyName) === null || _selectOption$Propert === void 0 ? void 0 : _selectOption$Propert.$target.type);
            })
          });
        }
      });
    }
    return aFilterDefs;
  }
  _exports.getFilterDefinitionsFromSelectionVariant = getFilterDefinitionsFromSelectionVariant;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/helpers/SelectionVariantHelper", [],function(){"use strict";var e={};function n(e,n){let t;const a=e.Sign==="UI.SelectionRangeSignType/I"?true:false;switch(e.Option){case"UI.SelectionRangeOptionType/BT":t=a?"BT":"NB";break;case"UI.SelectionRangeOptionType/CP":t=a?"Contains":"NotContains";break;case"UI.SelectionRangeOptionType/EQ":t=a?"EQ":"NE";break;case"UI.SelectionRangeOptionType/GE":t=a?"GE":"LT";break;case"UI.SelectionRangeOptionType/GT":t=a?"GT":"LE";break;case"UI.SelectionRangeOptionType/LE":t=a?"LE":"GT";break;case"UI.SelectionRangeOptionType/LT":t=a?"LT":"GE";break;case"UI.SelectionRangeOptionType/NB":t=a?"NB":"BT";break;case"UI.SelectionRangeOptionType/NE":t=a?"NE":"EQ";break;case"UI.SelectionRangeOptionType/NP":t=a?"NotContains":"Contains";break;default:t="EQ"}return{operator:t,rangeLow:n&&n.indexOf("Edm.Date")===0?new Date(e.Low):e.Low,rangeHigh:e.High&&n&&n.indexOf("Edm.Date")===0?new Date(e.High):e.High}}function t(e){const t=[];if(e.SelectOptions){e.SelectOptions.forEach(e=>{if(e.PropertyName&&e.Ranges.length>0){t.push({propertyPath:e.PropertyName.value,propertyType:e.PropertyName.$target.type,ranges:e.Ranges.map(t=>{var a;return n(t,(a=e.PropertyName)===null||a===void 0?void 0:a.$target.type)})})}})}return t}e.getFilterDefinitionsFromSelectionVariant=t;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/objectPage/FormMenuActions-dbg", ["sap/fe/core/converters/helpers/Key"], function (Key) {
  "use strict";

  var _exports = {};
  var KeyHelper = Key.KeyHelper;
  var ActionType;
  (function (ActionType) {
    ActionType["Default"] = "Default";
  })(ActionType || (ActionType = {}));
  const getVisibilityEnablementFormMenuActions = actions => {
    let menuActionVisible, menuActionVisiblePaths;
    actions.forEach(menuActions => {
      var _menuActions$menu;
      menuActionVisible = false;
      menuActionVisiblePaths = [];
      if (menuActions !== null && menuActions !== void 0 && (_menuActions$menu = menuActions.menu) !== null && _menuActions$menu !== void 0 && _menuActions$menu.length) {
        var _menuActions$menu2;
        menuActions === null || menuActions === void 0 ? void 0 : (_menuActions$menu2 = menuActions.menu) === null || _menuActions$menu2 === void 0 ? void 0 : _menuActions$menu2.forEach(menuItem => {
          const menuItemVisible = menuItem.visible;
          if (!menuActionVisible) {
            if (menuItemVisible && typeof menuItemVisible === "boolean" || menuItemVisible.valueOf() === "true") {
              menuActionVisible = true;
            } else if (menuItemVisible && menuItemVisible.valueOf() !== "false") {
              menuActionVisiblePaths.push(menuItemVisible.valueOf());
            }
          }
        });
        if (menuActionVisiblePaths.length) {
          menuActions.visible = menuActionVisiblePaths;
        } else {
          menuActions.visible = menuActionVisible.toString();
        }
      }
    });
    return actions;
  };
  _exports.getVisibilityEnablementFormMenuActions = getVisibilityEnablementFormMenuActions;
  const mergeFormActions = (source, target) => {
    for (const key in source) {
      if (source.hasOwnProperty(key)) {
        target[key] = source[key];
      }
    }
    return source;
  };
  _exports.mergeFormActions = mergeFormActions;
  const getFormHiddenActions = (facetDefinition, converterContext) => {
    var _converterContext$get, _converterContext$get2;
    const formActions = getFormActions(facetDefinition, converterContext) || [],
      annotations = converterContext === null || converterContext === void 0 ? void 0 : (_converterContext$get = converterContext.getEntityType()) === null || _converterContext$get === void 0 ? void 0 : (_converterContext$get2 = _converterContext$get.annotations) === null || _converterContext$get2 === void 0 ? void 0 : _converterContext$get2.UI;
    const hiddenFormActions = [];
    for (const property in annotations) {
      var _annotations$property, _annotations$property3, _annotations$property4;
      if (((_annotations$property = annotations[property]) === null || _annotations$property === void 0 ? void 0 : _annotations$property.$Type) === "com.sap.vocabularies.UI.v1.FieldGroupType") {
        var _annotations$property2;
        (_annotations$property2 = annotations[property]) === null || _annotations$property2 === void 0 ? void 0 : _annotations$property2.Data.forEach(dataField => {
          if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction" && formActions.hasOwnProperty(`DataFieldForAction::${dataField.Action}`)) {
            var _dataField$annotation, _dataField$annotation2, _dataField$annotation3;
            if ((dataField === null || dataField === void 0 ? void 0 : (_dataField$annotation = dataField.annotations) === null || _dataField$annotation === void 0 ? void 0 : (_dataField$annotation2 = _dataField$annotation.UI) === null || _dataField$annotation2 === void 0 ? void 0 : (_dataField$annotation3 = _dataField$annotation2.Hidden) === null || _dataField$annotation3 === void 0 ? void 0 : _dataField$annotation3.valueOf()) === true) {
              hiddenFormActions.push({
                type: ActionType.Default,
                key: KeyHelper.generateKeyFromDataField(dataField)
              });
            }
          } else if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation" && formActions.hasOwnProperty(`DataFieldForIntentBasedNavigation::${dataField.Action}`)) {
            var _dataField$annotation4, _dataField$annotation5, _dataField$annotation6;
            if ((dataField === null || dataField === void 0 ? void 0 : (_dataField$annotation4 = dataField.annotations) === null || _dataField$annotation4 === void 0 ? void 0 : (_dataField$annotation5 = _dataField$annotation4.UI) === null || _dataField$annotation5 === void 0 ? void 0 : (_dataField$annotation6 = _dataField$annotation5.Hidden) === null || _dataField$annotation6 === void 0 ? void 0 : _dataField$annotation6.valueOf()) === true) {
              hiddenFormActions.push({
                type: ActionType.Default,
                key: KeyHelper.generateKeyFromDataField(dataField)
              });
            }
          }
        });
      } else if (((_annotations$property3 = annotations[property]) === null || _annotations$property3 === void 0 ? void 0 : _annotations$property3.term) === "com.sap.vocabularies.UI.v1.Identification" || ((_annotations$property4 = annotations[property]) === null || _annotations$property4 === void 0 ? void 0 : _annotations$property4.term) === "@com.sap.vocabularies.UI.v1.StatusInfo") {
        var _annotations$property5;
        (_annotations$property5 = annotations[property]) === null || _annotations$property5 === void 0 ? void 0 : _annotations$property5.forEach(dataField => {
          if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction" && formActions.hasOwnProperty(`DataFieldForAction::${dataField.Action}`)) {
            var _dataField$annotation7, _dataField$annotation8, _dataField$annotation9;
            if ((dataField === null || dataField === void 0 ? void 0 : (_dataField$annotation7 = dataField.annotations) === null || _dataField$annotation7 === void 0 ? void 0 : (_dataField$annotation8 = _dataField$annotation7.UI) === null || _dataField$annotation8 === void 0 ? void 0 : (_dataField$annotation9 = _dataField$annotation8.Hidden) === null || _dataField$annotation9 === void 0 ? void 0 : _dataField$annotation9.valueOf()) === true) {
              hiddenFormActions.push({
                type: ActionType.Default,
                key: KeyHelper.generateKeyFromDataField(dataField)
              });
            }
          } else if (dataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation" && formActions.hasOwnProperty(`DataFieldForIntentBasedNavigation::${dataField.Action}`)) {
            var _dataField$annotation10, _dataField$annotation11, _dataField$annotation12;
            if ((dataField === null || dataField === void 0 ? void 0 : (_dataField$annotation10 = dataField.annotations) === null || _dataField$annotation10 === void 0 ? void 0 : (_dataField$annotation11 = _dataField$annotation10.UI) === null || _dataField$annotation11 === void 0 ? void 0 : (_dataField$annotation12 = _dataField$annotation11.Hidden) === null || _dataField$annotation12 === void 0 ? void 0 : _dataField$annotation12.valueOf()) === true) {
              hiddenFormActions.push({
                type: ActionType.Default,
                key: KeyHelper.generateKeyFromDataField(dataField)
              });
            }
          }
        });
      }
    }
    return hiddenFormActions;
  };
  _exports.getFormHiddenActions = getFormHiddenActions;
  const getFormActions = (facetDefinition, converterContext) => {
    const manifestWrapper = converterContext.getManifestWrapper();
    let targetValue, manifestFormContainer;
    let actions = {};
    if ((facetDefinition === null || facetDefinition === void 0 ? void 0 : facetDefinition.$Type) === "com.sap.vocabularies.UI.v1.CollectionFacet") {
      if (facetDefinition !== null && facetDefinition !== void 0 && facetDefinition.Facets) {
        facetDefinition === null || facetDefinition === void 0 ? void 0 : facetDefinition.Facets.forEach(facet => {
          var _facet$Target, _manifestFormContaine;
          targetValue = facet === null || facet === void 0 ? void 0 : (_facet$Target = facet.Target) === null || _facet$Target === void 0 ? void 0 : _facet$Target.value;
          manifestFormContainer = manifestWrapper.getFormContainer(targetValue);
          if ((_manifestFormContaine = manifestFormContainer) !== null && _manifestFormContaine !== void 0 && _manifestFormContaine.actions) {
            var _manifestFormContaine2;
            for (const actionKey in manifestFormContainer.actions) {
              // store the correct facet an action is belonging to for the case it's an inline form action
              manifestFormContainer.actions[actionKey].facetName = facet.fullyQualifiedName;
            }
            actions = mergeFormActions((_manifestFormContaine2 = manifestFormContainer) === null || _manifestFormContaine2 === void 0 ? void 0 : _manifestFormContaine2.actions, actions);
          }
        });
      }
    } else if ((facetDefinition === null || facetDefinition === void 0 ? void 0 : facetDefinition.$Type) === "com.sap.vocabularies.UI.v1.ReferenceFacet") {
      var _facetDefinition$Targ, _manifestFormContaine3;
      targetValue = facetDefinition === null || facetDefinition === void 0 ? void 0 : (_facetDefinition$Targ = facetDefinition.Target) === null || _facetDefinition$Targ === void 0 ? void 0 : _facetDefinition$Targ.value;
      manifestFormContainer = manifestWrapper.getFormContainer(targetValue);
      if ((_manifestFormContaine3 = manifestFormContainer) !== null && _manifestFormContaine3 !== void 0 && _manifestFormContaine3.actions) {
        for (const actionKey in manifestFormContainer.actions) {
          // store the correct facet an action is belonging to for the case it's an inline form action
          manifestFormContainer.actions[actionKey].facetName = facetDefinition.fullyQualifiedName;
        }
        actions = manifestFormContainer.actions;
      }
    }
    return actions;
  };
  _exports.getFormActions = getFormActions;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/objectPage/FormMenuActions", ["sap/fe/core/converters/helpers/Key"],function(i){"use strict";var o={};var e=i.KeyHelper;var a;(function(i){i["Default"]="Default"})(a||(a={}));const n=i=>{let o,e;i.forEach(i=>{var a;o=false;e=[];if(i!==null&&i!==void 0&&(a=i.menu)!==null&&a!==void 0&&a.length){var n;i===null||i===void 0?void 0:(n=i.menu)===null||n===void 0?void 0:n.forEach(i=>{const a=i.visible;if(!o){if(a&&typeof a==="boolean"||a.valueOf()==="true"){o=true}else if(a&&a.valueOf()!=="false"){e.push(a.valueOf())}}});if(e.length){i.visible=e}else{i.visible=o.toString()}}});return i};o.getVisibilityEnablementFormMenuActions=n;const l=(i,o)=>{for(const e in i){if(i.hasOwnProperty(e)){o[e]=i[e]}}return i};o.mergeFormActions=l;const t=(i,o)=>{var n,l;const t=v(i,o)||[],d=o===null||o===void 0?void 0:(n=o.getEntityType())===null||n===void 0?void 0:(l=n.annotations)===null||l===void 0?void 0:l.UI;const r=[];for(const i in d){var u,s,c;if(((u=d[i])===null||u===void 0?void 0:u.$Type)==="com.sap.vocabularies.UI.v1.FieldGroupType"){var f;(f=d[i])===null||f===void 0?void 0:f.Data.forEach(i=>{if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&t.hasOwnProperty(`DataFieldForAction::${i.Action}`)){var o,n,l;if((i===null||i===void 0?void 0:(o=i.annotations)===null||o===void 0?void 0:(n=o.UI)===null||n===void 0?void 0:(l=n.Hidden)===null||l===void 0?void 0:l.valueOf())===true){r.push({type:a.Default,key:e.generateKeyFromDataField(i)})}}else if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&t.hasOwnProperty(`DataFieldForIntentBasedNavigation::${i.Action}`)){var v,d,u;if((i===null||i===void 0?void 0:(v=i.annotations)===null||v===void 0?void 0:(d=v.UI)===null||d===void 0?void 0:(u=d.Hidden)===null||u===void 0?void 0:u.valueOf())===true){r.push({type:a.Default,key:e.generateKeyFromDataField(i)})}}})}else if(((s=d[i])===null||s===void 0?void 0:s.term)==="com.sap.vocabularies.UI.v1.Identification"||((c=d[i])===null||c===void 0?void 0:c.term)==="@com.sap.vocabularies.UI.v1.StatusInfo"){var p;(p=d[i])===null||p===void 0?void 0:p.forEach(i=>{if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&t.hasOwnProperty(`DataFieldForAction::${i.Action}`)){var o,n,l;if((i===null||i===void 0?void 0:(o=i.annotations)===null||o===void 0?void 0:(n=o.UI)===null||n===void 0?void 0:(l=n.Hidden)===null||l===void 0?void 0:l.valueOf())===true){r.push({type:a.Default,key:e.generateKeyFromDataField(i)})}}else if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&t.hasOwnProperty(`DataFieldForIntentBasedNavigation::${i.Action}`)){var v,d,u;if((i===null||i===void 0?void 0:(v=i.annotations)===null||v===void 0?void 0:(d=v.UI)===null||d===void 0?void 0:(u=d.Hidden)===null||u===void 0?void 0:u.valueOf())===true){r.push({type:a.Default,key:e.generateKeyFromDataField(i)})}}})}}return r};o.getFormHiddenActions=t;const v=(i,o)=>{const e=o.getManifestWrapper();let a,n;let t={};if((i===null||i===void 0?void 0:i.$Type)==="com.sap.vocabularies.UI.v1.CollectionFacet"){if(i!==null&&i!==void 0&&i.Facets){i===null||i===void 0?void 0:i.Facets.forEach(i=>{var o,v;a=i===null||i===void 0?void 0:(o=i.Target)===null||o===void 0?void 0:o.value;n=e.getFormContainer(a);if((v=n)!==null&&v!==void 0&&v.actions){var d;for(const o in n.actions){n.actions[o].facetName=i.fullyQualifiedName}t=l((d=n)===null||d===void 0?void 0:d.actions,t)}})}}else if((i===null||i===void 0?void 0:i.$Type)==="com.sap.vocabularies.UI.v1.ReferenceFacet"){var v,d;a=i===null||i===void 0?void 0:(v=i.Target)===null||v===void 0?void 0:v.value;n=e.getFormContainer(a);if((d=n)!==null&&d!==void 0&&d.actions){for(const o in n.actions){n.actions[o].facetName=i.fullyQualifiedName}t=n.actions}}return t};o.getFormActions=v;return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/objectPage/HeaderAndFooterAction-dbg", ["sap/fe/core/converters/controls/Common/Action", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/converters/helpers/Key", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/templating/DataModelPathHelper", "sap/ui/core/Core", "../helpers/BindingHelper", "../ManifestSettings"], function (Action, ConfigurableObject, Key, BindingToolkit, ModelHelper, DataModelPathHelper, Core, BindingHelper, ManifestSettings) {
  "use strict";

  var _exports = {};
  var ActionType = ManifestSettings.ActionType;
  var UI = BindingHelper.UI;
  var singletonPathVisitor = BindingHelper.singletonPathVisitor;
  var Draft = BindingHelper.Draft;
  var isPathDeletable = DataModelPathHelper.isPathDeletable;
  var pathInModel = BindingToolkit.pathInModel;
  var not = BindingToolkit.not;
  var ifElse = BindingToolkit.ifElse;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var fn = BindingToolkit.fn;
  var equal = BindingToolkit.equal;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  var and = BindingToolkit.and;
  var KeyHelper = Key.KeyHelper;
  var Placement = ConfigurableObject.Placement;
  var getSemanticObjectMapping = Action.getSemanticObjectMapping;
  var getEnabledForAnnotationAction = Action.getEnabledForAnnotationAction;
  var getCopyAction = Action.getCopyAction;
  var dataFieldIsCopyAction = Action.dataFieldIsCopyAction;
  var ButtonType = Action.ButtonType;
  /**
   * Retrieves all the data field for actions for the identification annotation
   * They must be
   * - Not statically hidden
   * - Either linked to an Unbound action or to an action which has an OperationAvailable that is not set to false statically.
   *
   * @param entityType The current entity type
   * @param isDeterminingAction The flag which denotes whether or not the action is a determining action
   * @returns An array of DataField for action respecting the input parameter 'isDeterminingAction'
   */
  function getIdentificationDataFieldForActions(entityType, isDeterminingAction) {
    var _entityType$annotatio, _entityType$annotatio2, _entityType$annotatio3;
    return ((_entityType$annotatio = entityType.annotations) === null || _entityType$annotatio === void 0 ? void 0 : (_entityType$annotatio2 = _entityType$annotatio.UI) === null || _entityType$annotatio2 === void 0 ? void 0 : (_entityType$annotatio3 = _entityType$annotatio2.Identification) === null || _entityType$annotatio3 === void 0 ? void 0 : _entityType$annotatio3.filter(identificationDataField => {
      var _identificationDataFi, _identificationDataFi2, _identificationDataFi3, _identificationDataFi4, _identificationDataFi5, _identificationDataFi6, _identificationDataFi7, _identificationDataFi8, _identificationDataFi9, _identificationDataFi10;
      return ((_identificationDataFi = identificationDataField.annotations) === null || _identificationDataFi === void 0 ? void 0 : (_identificationDataFi2 = _identificationDataFi.UI) === null || _identificationDataFi2 === void 0 ? void 0 : (_identificationDataFi3 = _identificationDataFi2.Hidden) === null || _identificationDataFi3 === void 0 ? void 0 : _identificationDataFi3.valueOf()) !== true && identificationDataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction" && Boolean((_identificationDataFi4 = identificationDataField.Determining) === null || _identificationDataFi4 === void 0 ? void 0 : _identificationDataFi4.valueOf()) === isDeterminingAction && (((_identificationDataFi5 = identificationDataField.ActionTarget) === null || _identificationDataFi5 === void 0 ? void 0 : (_identificationDataFi6 = _identificationDataFi5.isBound) === null || _identificationDataFi6 === void 0 ? void 0 : _identificationDataFi6.valueOf()) !== true || (identificationDataField === null || identificationDataField === void 0 ? void 0 : (_identificationDataFi7 = identificationDataField.ActionTarget) === null || _identificationDataFi7 === void 0 ? void 0 : (_identificationDataFi8 = _identificationDataFi7.annotations) === null || _identificationDataFi8 === void 0 ? void 0 : (_identificationDataFi9 = _identificationDataFi8.Core) === null || _identificationDataFi9 === void 0 ? void 0 : (_identificationDataFi10 = _identificationDataFi9.OperationAvailable) === null || _identificationDataFi10 === void 0 ? void 0 : _identificationDataFi10.valueOf()) !== false) ? true : false;
    })) || [];
  }

  /**
   * Retrieve all the IBN actions for the identification annotation.
   * They must be
   * - Not statically hidden.
   *
   * @param entityType The current entitytype
   * @param isDeterminingAction Whether or not the action should be determining
   * @returns An array of data field for action respecting the isDeterminingAction property.
   */
  _exports.getIdentificationDataFieldForActions = getIdentificationDataFieldForActions;
  function getIdentificationDataFieldForIBNActions(entityType, isDeterminingAction) {
    var _entityType$annotatio4, _entityType$annotatio5, _entityType$annotatio6;
    return ((_entityType$annotatio4 = entityType.annotations) === null || _entityType$annotatio4 === void 0 ? void 0 : (_entityType$annotatio5 = _entityType$annotatio4.UI) === null || _entityType$annotatio5 === void 0 ? void 0 : (_entityType$annotatio6 = _entityType$annotatio5.Identification) === null || _entityType$annotatio6 === void 0 ? void 0 : _entityType$annotatio6.filter(identificationDataField => {
      var _identificationDataFi11, _identificationDataFi12, _identificationDataFi13, _identificationDataFi14;
      return ((_identificationDataFi11 = identificationDataField.annotations) === null || _identificationDataFi11 === void 0 ? void 0 : (_identificationDataFi12 = _identificationDataFi11.UI) === null || _identificationDataFi12 === void 0 ? void 0 : (_identificationDataFi13 = _identificationDataFi12.Hidden) === null || _identificationDataFi13 === void 0 ? void 0 : _identificationDataFi13.valueOf()) !== true && identificationDataField.$Type === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation" && Boolean((_identificationDataFi14 = identificationDataField.Determining) === null || _identificationDataFi14 === void 0 ? void 0 : _identificationDataFi14.valueOf()) === isDeterminingAction ? true : false;
    })) || [];
  }
  const IMPORTANT_CRITICALITIES = ["UI.CriticalityType/VeryPositive", "UI.CriticalityType/Positive", "UI.CriticalityType/Negative", "UI.CriticalityType/VeryNegative"];

  /**
   * Method to determine the 'visible' property binding for the Delete button on an object page.
   *
   * @param converterContext Instance of the converter context.
   * @param deleteHidden The value of the UI.DeleteHidden annotation on the entity set / type.
   * @returns The binding expression for the 'visible' property of the Delete button.
   */
  function getDeleteButtonVisibility(converterContext, deleteHidden) {
    const dataModelObjectPath = converterContext.getDataModelObjectPath(),
      visitedNavigationPaths = dataModelObjectPath.navigationProperties.map(navProp => navProp.name),
      // Set absolute binding path for Singleton references, otherwise the configured annotation path itself.
      // For e.g. /com.sap.namespace.EntityContainer/Singleton/Property to /Singleton/Property
      deleteHiddenExpression = getExpressionFromAnnotation(deleteHidden, visitedNavigationPaths, undefined, path => singletonPathVisitor(path, converterContext.getConvertedTypes(), [])),
      manifestWrapper = converterContext.getManifestWrapper(),
      viewLevel = manifestWrapper.getViewLevel(),
      // Delete button is visible
      // In OP 		-->  when not in edit mode
      // In sub-OP 	-->  when in edit mode
      editableExpression = viewLevel > 1 ? UI.IsEditable : not(UI.IsEditable);

    // If UI.DeleteHidden annotation on entity set or type is either not defined or explicitly set to false,
    // Delete button is visible based on editableExpression.
    // else,
    // Delete button is visible based on both annotation path and editableExpression.
    return ifElse(deleteHidden === undefined || deleteHidden.valueOf() === false, editableExpression, and(editableExpression, equal(deleteHiddenExpression, false)));
  }

  /**
   * Method to determine the 'enabled' property binding for the Delete button on an object page.
   *
   * @param isDeletable The delete restriction configured
   * @param isParentDeletable The delete restriction configured on the parent entity
   * @param converterContext
   * @returns The binding expression for the 'enabled' property of the Delete button
   */
  _exports.getDeleteButtonVisibility = getDeleteButtonVisibility;
  function getDeleteButtonEnabled(isDeletable, isParentDeletable, converterContext) {
    const entitySet = converterContext.getEntitySet(),
      isDraftRoot = ModelHelper.isDraftRoot(entitySet);
    let ret = ifElse(isParentDeletable !== undefined, isParentDeletable, ifElse(isDeletable !== undefined, equal(isDeletable, true), constant(true)));

    // delete should be disabled for Locked objects
    ret = isDraftRoot ? and(ret, not(pathInModel("DraftAdministrativeData/InProcessByUser"))) : ret;
    return ret;
  }

  /**
   * Method to determine the 'visible' property binding for the Edit button on an object page.
   *
   * @param converterContext Instance of the converter context.
   * @param rootUpdateHidden The value of the UI.UpdateHidden annotation on the entity set / type.
   * @param rootConverterContext
   * @param updateHidden
   * @param viewLevel
   * @returns The binding expression for the 'visible' property of the Edit button.
   */
  _exports.getDeleteButtonEnabled = getDeleteButtonEnabled;
  function getEditButtonVisibility(converterContext, rootUpdateHidden, rootConverterContext, updateHidden, viewLevel) {
    const rootEntitySet = rootConverterContext === null || rootConverterContext === void 0 ? void 0 : rootConverterContext.getEntitySet(),
      entitySet = converterContext.getEntitySet(),
      isFCLEnabled = converterContext.getManifestWrapper().isFclEnabled();
    let isDraftEnabled;
    const rootUpdateHiddenExpression = getHiddenExpression(rootConverterContext, rootUpdateHidden);
    if (viewLevel && viewLevel > 1) {
      // if viewlevel > 1 check if node is draft enabled
      isDraftEnabled = ModelHelper.isDraftNode(entitySet);
    } else {
      isDraftEnabled = ModelHelper.isDraftRoot(rootEntitySet);
    }
    const updateHiddenExpression = getHiddenExpression(rootConverterContext, updateHidden);
    const notEditableExpression = not(UI.IsEditable);

    // If UI.UpdateHidden annotation on entity set or type is either not defined or explicitly set to false,
    // Edit button is visible in display mode.
    // else,
    // Edit button is visible based on both annotation path and in display mode.
    const resultantExpression = ifElse(viewLevel > 1, ifElse(updateHidden === undefined || updateHidden.valueOf() === false, and(notEditableExpression, equal(pathInModel("rootEditVisible", "internal"), true), ifElse(isFCLEnabled, equal(pathInModel("/showEditButton", "fclhelper"), true), true)), and(notEditableExpression, equal(updateHiddenExpression, false), equal(pathInModel("rootEditVisible", "internal"), true), ifElse(isFCLEnabled, equal(pathInModel("/showEditButton", "fclhelper"), true), true))), ifElse(rootUpdateHidden === undefined || rootUpdateHidden.valueOf() === false, notEditableExpression, and(notEditableExpression, equal(rootUpdateHiddenExpression, false))));
    return ifElse(isDraftEnabled, and(resultantExpression, Draft.HasNoDraftForCurrentUser), resultantExpression);
  }
  _exports.getEditButtonVisibility = getEditButtonVisibility;
  function getHiddenExpression(converterContext, updateHidden) {
    const dataModelObjectPath = converterContext.getDataModelObjectPath(),
      visitedNavigationPaths = dataModelObjectPath.navigationProperties.map(navProp => navProp.name),
      // Set absolute binding path for Singleton references, otherwise the configured annotation path itself.
      // For e.g. /com.sap.namespace.EntityContainer/Singleton/Property to /Singleton/Property
      updateHiddenExpression = getExpressionFromAnnotation(updateHidden, visitedNavigationPaths, undefined, path => singletonPathVisitor(path, converterContext.getConvertedTypes(), visitedNavigationPaths));
    return updateHiddenExpression;
  }
  /**
   * Method to determine the 'enabled' property binding for the Edit button on an object page.
   *
   * @param converterContext Instance of the converter context.
   * @param updateRestrictions
   * @param viewLevel
   * @returns The binding expression for the 'enabled' property of the Edit button.
   */
  _exports.getHiddenExpression = getHiddenExpression;
  function getEditButtonEnabled(converterContext, updateRestrictions, viewLevel) {
    const entitySet = converterContext.getEntitySet(),
      isDraftRoot = ModelHelper.isDraftRoot(entitySet),
      isSticky = ModelHelper.isSticky(entitySet);
    let editActionName;
    if (isDraftRoot && !ModelHelper.isSingleton(entitySet)) {
      var _annotations$Common, _annotations$Common$D;
      editActionName = entitySet === null || entitySet === void 0 ? void 0 : (_annotations$Common = entitySet.annotations.Common) === null || _annotations$Common === void 0 ? void 0 : (_annotations$Common$D = _annotations$Common.DraftRoot) === null || _annotations$Common$D === void 0 ? void 0 : _annotations$Common$D.EditAction;
    } else if (isSticky && !ModelHelper.isSingleton(entitySet)) {
      var _annotations$Session, _annotations$Session$;
      editActionName = entitySet === null || entitySet === void 0 ? void 0 : (_annotations$Session = entitySet.annotations.Session) === null || _annotations$Session === void 0 ? void 0 : (_annotations$Session$ = _annotations$Session.StickySessionSupported) === null || _annotations$Session$ === void 0 ? void 0 : _annotations$Session$.EditAction;
    }
    if (editActionName) {
      var _editAction$annotatio, _editAction$annotatio2;
      const editActionAnnotationPath = converterContext.getAbsoluteAnnotationPath(editActionName);
      const editAction = converterContext.resolveAbsolutePath(editActionAnnotationPath).target;
      if ((editAction === null || editAction === void 0 ? void 0 : (_editAction$annotatio = editAction.annotations) === null || _editAction$annotatio === void 0 ? void 0 : (_editAction$annotatio2 = _editAction$annotatio.Core) === null || _editAction$annotatio2 === void 0 ? void 0 : _editAction$annotatio2.OperationAvailable) === null) {
        // We disabled action advertisement but kept it in the code for the time being
        //return "{= ${#" + editActionName + "} ? true : false }";
      } else if (viewLevel > 1) {
        // Edit button is enabled based on the update restrictions of the sub-OP
        if (updateRestrictions !== undefined) {
          return compileExpression(and(equal(getExpressionFromAnnotation(updateRestrictions), true), equal(pathInModel("rootEditEnabled", "internal"), true)));
        } else {
          return compileExpression(equal(pathInModel("rootEditEnabled", "internal"), true));
        }
      } else {
        return getEnabledForAnnotationAction(converterContext, editAction ?? undefined);
      }
    }
    return "true";
  }
  _exports.getEditButtonEnabled = getEditButtonEnabled;
  function getHeaderDefaultActions(converterContext) {
    var _entitySet$annotation, _entitySet$annotation2, _entitySet$annotation3, _entitySet$annotation4, _entityDeleteRestrict;
    const sContextPath = converterContext.getContextPath();
    const rootEntitySetPath = ModelHelper.getRootEntitySetPath(sContextPath);
    const rootConverterContext = converterContext.getConverterContextFor("/" + rootEntitySetPath);
    const entitySet = converterContext.getEntitySet(),
      entityType = converterContext.getEntityType(),
      rootEntitySet = rootConverterContext.getEntitySet(),
      rootEntityType = rootConverterContext.getEntityType(),
      stickySessionSupported = ModelHelper.getStickySession(rootEntitySet),
      //for sticky app
      draftRoot = ModelHelper.getDraftRoot(rootEntitySet),
      //entitySet && entitySet.annotations.Common?.DraftRoot,
      draftNode = ModelHelper.getDraftNode(rootEntitySet),
      entityDeleteRestrictions = entitySet && ((_entitySet$annotation = entitySet.annotations) === null || _entitySet$annotation === void 0 ? void 0 : (_entitySet$annotation2 = _entitySet$annotation.Capabilities) === null || _entitySet$annotation2 === void 0 ? void 0 : _entitySet$annotation2.DeleteRestrictions),
      rootUpdateHidden = ModelHelper.isUpdateHidden(rootEntitySet, rootEntityType),
      updateHidden = rootEntitySet && !ModelHelper.isSingleton(rootEntitySet) && (rootUpdateHidden === null || rootUpdateHidden === void 0 ? void 0 : rootUpdateHidden.valueOf()),
      dataModelObjectPath = converterContext.getDataModelObjectPath(),
      isParentDeletable = isPathDeletable(dataModelObjectPath, {
        pathVisitor: (path, navigationPaths) => singletonPathVisitor(path, converterContext.getConvertedTypes(), navigationPaths)
      }),
      parentEntitySetDeletable = isParentDeletable ? compileExpression(isParentDeletable) : isParentDeletable,
      identificationFieldForActions = getIdentificationDataFieldForActions(converterContext.getEntityType(), false);
    const copyDataField = converterContext.getManifestWrapper().getViewLevel() === 1 ? getCopyAction(identificationFieldForActions.filter(dataField => {
      return dataFieldIsCopyAction(dataField);
    })) : undefined;
    const headerDataFieldForActions = identificationFieldForActions.filter(dataField => {
      return !dataFieldIsCopyAction(dataField);
    });

    // Initialize actions and start with draft actions if available since they should appear in the first
    // leftmost position in the actions area of the OP header
    // This is more like a placeholder than a single action, since this controls not only the templating of
    // the button for switching between draft and active document versions but also the controls for
    // the collaborative draft fragment.
    const headerActions = [];
    if (!ModelHelper.isSingleton(entitySet) && draftRoot !== null && draftRoot !== void 0 && draftRoot.EditAction && updateHidden !== true) {
      headerActions.push({
        type: ActionType.DraftActions,
        key: "DraftActions"
      });
    }
    const viewLevel = converterContext.getManifestWrapper().getViewLevel();
    const updatablePropertyPath = viewLevel > 1 ? entitySet === null || entitySet === void 0 ? void 0 : (_entitySet$annotation3 = entitySet.annotations.Capabilities) === null || _entitySet$annotation3 === void 0 ? void 0 : (_entitySet$annotation4 = _entitySet$annotation3.UpdateRestrictions) === null || _entitySet$annotation4 === void 0 ? void 0 : _entitySet$annotation4.Updatable : undefined;
    if (draftRoot || draftNode) {
      headerActions.push({
        type: ActionType.CollaborationAvatars,
        key: "CollaborationAvatars"
      });
    }
    // Then add the "Critical" DataFieldForActions
    headerDataFieldForActions.filter(dataField => {
      return IMPORTANT_CRITICALITIES.indexOf(dataField === null || dataField === void 0 ? void 0 : dataField.Criticality) > -1;
    }).forEach(dataField => {
      headerActions.push(getDataFieldAnnotationAction(dataField, converterContext));
    });

    // Then the edit action if it exists
    if ((draftRoot !== null && draftRoot !== void 0 && draftRoot.EditAction || stickySessionSupported !== null && stickySessionSupported !== void 0 && stickySessionSupported.EditAction) && updateHidden !== true) {
      headerActions.push({
        type: ActionType.Primary,
        key: "EditAction",
        visible: compileExpression(getEditButtonVisibility(converterContext, rootUpdateHidden, rootConverterContext, ModelHelper.isUpdateHidden(entitySet, entityType), viewLevel)),
        enabled: getEditButtonEnabled(rootConverterContext, updatablePropertyPath, viewLevel)
      });
    }
    // Then the delete action if we're not statically not deletable
    if (parentEntitySetDeletable && parentEntitySetDeletable !== "false" || (entityDeleteRestrictions === null || entityDeleteRestrictions === void 0 ? void 0 : (_entityDeleteRestrict = entityDeleteRestrictions.Deletable) === null || _entityDeleteRestrict === void 0 ? void 0 : _entityDeleteRestrict.valueOf()) !== false && parentEntitySetDeletable !== "false") {
      const deleteHidden = ModelHelper.getDeleteHidden(entitySet, entityType);
      headerActions.push({
        type: ActionType.Secondary,
        key: "DeleteAction",
        visible: compileExpression(getDeleteButtonVisibility(converterContext, deleteHidden)),
        enabled: compileExpression(getDeleteButtonEnabled(entityDeleteRestrictions === null || entityDeleteRestrictions === void 0 ? void 0 : entityDeleteRestrictions.Deletable, isParentDeletable, converterContext)),
        parentEntityDeleteEnabled: parentEntitySetDeletable
      });
    }
    if (copyDataField) {
      var _copyDataField$Label;
      headerActions.push({
        ...getDataFieldAnnotationAction(copyDataField, converterContext),
        type: ActionType.Copy,
        text: ((_copyDataField$Label = copyDataField.Label) === null || _copyDataField$Label === void 0 ? void 0 : _copyDataField$Label.toString()) ?? Core.getLibraryResourceBundle("sap.fe.core").getText("C_COMMON_COPY")
      });
    }
    const headerDataFieldForIBNActions = getIdentificationDataFieldForIBNActions(converterContext.getEntityType(), false);
    headerDataFieldForIBNActions.filter(dataField => {
      return IMPORTANT_CRITICALITIES.indexOf(dataField === null || dataField === void 0 ? void 0 : dataField.Criticality) === -1;
    }).forEach(dataField => {
      var _dataField$RequiresCo, _dataField$Inline, _dataField$Label, _dataField$annotation, _dataField$annotation2, _dataField$annotation3, _dataField$Navigation;
      if (((_dataField$RequiresCo = dataField.RequiresContext) === null || _dataField$RequiresCo === void 0 ? void 0 : _dataField$RequiresCo.valueOf()) === true) {
        throw new Error(`RequiresContext property should not be true for header IBN action : ${dataField.Label}`);
      }
      if (((_dataField$Inline = dataField.Inline) === null || _dataField$Inline === void 0 ? void 0 : _dataField$Inline.valueOf()) === true) {
        throw new Error(`Inline property should not be true for header IBN action : ${dataField.Label}`);
      }
      const oNavigationParams = {
        semanticObjectMapping: getSemanticObjectMapping(dataField.Mapping)
      };
      headerActions.push({
        type: ActionType.DataFieldForIntentBasedNavigation,
        text: (_dataField$Label = dataField.Label) === null || _dataField$Label === void 0 ? void 0 : _dataField$Label.toString(),
        annotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),
        buttonType: ButtonType.Ghost,
        visible: compileExpression(not(equal(getExpressionFromAnnotation((_dataField$annotation = dataField.annotations) === null || _dataField$annotation === void 0 ? void 0 : (_dataField$annotation2 = _dataField$annotation.UI) === null || _dataField$annotation2 === void 0 ? void 0 : (_dataField$annotation3 = _dataField$annotation2.Hidden) === null || _dataField$annotation3 === void 0 ? void 0 : _dataField$annotation3.valueOf()), true))),
        enabled: dataField.NavigationAvailable !== undefined ? compileExpression(equal(getExpressionFromAnnotation((_dataField$Navigation = dataField.NavigationAvailable) === null || _dataField$Navigation === void 0 ? void 0 : _dataField$Navigation.valueOf()), true)) : true,
        key: KeyHelper.generateKeyFromDataField(dataField),
        isNavigable: true,
        press: compileExpression(fn("._intentBasedNavigation.navigate", [getExpressionFromAnnotation(dataField.SemanticObject), getExpressionFromAnnotation(dataField.Action), oNavigationParams])),
        customData: compileExpression({
          semanticObject: getExpressionFromAnnotation(dataField.SemanticObject),
          action: getExpressionFromAnnotation(dataField.Action)
        })
      });
    });
    // Finally the non critical DataFieldForActions
    headerDataFieldForActions.filter(dataField => {
      return IMPORTANT_CRITICALITIES.indexOf(dataField === null || dataField === void 0 ? void 0 : dataField.Criticality) === -1;
    }).forEach(dataField => {
      headerActions.push(getDataFieldAnnotationAction(dataField, converterContext));
    });
    return headerActions;
  }
  _exports.getHeaderDefaultActions = getHeaderDefaultActions;
  function getHiddenHeaderActions(converterContext) {
    var _entityType$annotatio7, _entityType$annotatio8, _entityType$annotatio9;
    const entityType = converterContext.getEntityType();
    const hiddenActions = ((_entityType$annotatio7 = entityType.annotations) === null || _entityType$annotatio7 === void 0 ? void 0 : (_entityType$annotatio8 = _entityType$annotatio7.UI) === null || _entityType$annotatio8 === void 0 ? void 0 : (_entityType$annotatio9 = _entityType$annotatio8.Identification) === null || _entityType$annotatio9 === void 0 ? void 0 : _entityType$annotatio9.filter(identificationDataField => {
      var _identificationDataFi15, _identificationDataFi16, _identificationDataFi17;
      return (identificationDataField === null || identificationDataField === void 0 ? void 0 : (_identificationDataFi15 = identificationDataField.annotations) === null || _identificationDataFi15 === void 0 ? void 0 : (_identificationDataFi16 = _identificationDataFi15.UI) === null || _identificationDataFi16 === void 0 ? void 0 : (_identificationDataFi17 = _identificationDataFi16.Hidden) === null || _identificationDataFi17 === void 0 ? void 0 : _identificationDataFi17.valueOf()) === true;
    })) || [];
    return hiddenActions.map(dataField => {
      return {
        type: ActionType.Default,
        key: KeyHelper.generateKeyFromDataField(dataField)
      };
    });
  }
  _exports.getHiddenHeaderActions = getHiddenHeaderActions;
  function getFooterDefaultActions(viewLevel, converterContext) {
    var _annotations$Common2, _annotations$Common2$, _annotations, _annotations$Session2, _annotations$Session3;
    const entitySet = converterContext.getEntitySet();
    const entityType = converterContext.getEntityType();
    const stickySessionSupported = ModelHelper.getStickySession(entitySet),
      //for sticky app
      entitySetDraftRoot = !ModelHelper.isSingleton(entitySet) && entitySet && (((_annotations$Common2 = entitySet.annotations.Common) === null || _annotations$Common2 === void 0 ? void 0 : (_annotations$Common2$ = _annotations$Common2.DraftRoot) === null || _annotations$Common2$ === void 0 ? void 0 : _annotations$Common2$.term) || ((_annotations = entitySet.annotations) === null || _annotations === void 0 ? void 0 : (_annotations$Session2 = _annotations.Session) === null || _annotations$Session2 === void 0 ? void 0 : (_annotations$Session3 = _annotations$Session2.StickySessionSupported) === null || _annotations$Session3 === void 0 ? void 0 : _annotations$Session3.term)),
      conditionSave = Boolean(entitySetDraftRoot === "com.sap.vocabularies.Common.v1.DraftRoot" || stickySessionSupported && (stickySessionSupported === null || stickySessionSupported === void 0 ? void 0 : stickySessionSupported.SaveAction)),
      conditionApply = viewLevel > 1,
      conditionCancel = Boolean(entitySetDraftRoot === "com.sap.vocabularies.Common.v1.DraftRoot" || stickySessionSupported && (stickySessionSupported === null || stickySessionSupported === void 0 ? void 0 : stickySessionSupported.DiscardAction));

    // Retrieve all determining actions
    const footerDataFieldForActions = getIdentificationDataFieldForActions(converterContext.getEntityType(), true);

    // First add the "Critical" DataFieldForActions
    const footerActions = footerDataFieldForActions.filter(dataField => {
      return IMPORTANT_CRITICALITIES.indexOf(dataField === null || dataField === void 0 ? void 0 : dataField.Criticality) > -1;
    }).map(dataField => {
      return getDataFieldAnnotationAction(dataField, converterContext);
    });

    // Then the save action if it exists
    if ((entitySet === null || entitySet === void 0 ? void 0 : entitySet.entityTypeName) === (entityType === null || entityType === void 0 ? void 0 : entityType.fullyQualifiedName) && conditionSave) {
      footerActions.push({
        type: ActionType.Primary,
        key: "SaveAction"
      });
    }

    // Then the apply action if it exists
    if (conditionApply) {
      footerActions.push({
        type: ActionType.DefaultApply,
        key: "ApplyAction"
      });
    }

    // Then the non critical DataFieldForActions
    footerDataFieldForActions.filter(dataField => {
      return IMPORTANT_CRITICALITIES.indexOf(dataField === null || dataField === void 0 ? void 0 : dataField.Criticality) === -1;
    }).forEach(dataField => {
      footerActions.push(getDataFieldAnnotationAction(dataField, converterContext));
    });

    // Then the cancel action if it exists
    if (conditionCancel) {
      footerActions.push({
        type: ActionType.Secondary,
        key: "CancelAction",
        position: {
          placement: Placement.End
        }
      });
    }
    return footerActions;
  }
  _exports.getFooterDefaultActions = getFooterDefaultActions;
  function getDataFieldAnnotationAction(dataField, converterContext) {
    var _dataField$annotation4, _dataField$annotation5;
    return {
      type: ActionType.DataFieldForAction,
      annotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),
      key: KeyHelper.generateKeyFromDataField(dataField),
      visible: compileExpression(not(equal(getExpressionFromAnnotation((_dataField$annotation4 = dataField.annotations) === null || _dataField$annotation4 === void 0 ? void 0 : (_dataField$annotation5 = _dataField$annotation4.UI) === null || _dataField$annotation5 === void 0 ? void 0 : _dataField$annotation5.Hidden), true))),
      enabled: getEnabledForAnnotationAction(converterContext, dataField.ActionTarget),
      isNavigable: true
    };
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/objectPage/HeaderAndFooterAction", ["sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","sap/ui/core/Core","../helpers/BindingHelper","../ManifestSettings"],function(e,t,i,n,o,a,l,r,d){"use strict";var v={};var u=d.ActionType;var s=r.UI;var c=r.singletonPathVisitor;var f=r.Draft;var p=a.isPathDeletable;var y=n.pathInModel;var g=n.not;var b=n.ifElse;var E=n.getExpressionFromAnnotation;var h=n.fn;var A=n.equal;var m=n.constant;var D=n.compileExpression;var C=n.and;var S=i.KeyHelper;var O=t.Placement;var I=e.getSemanticObjectMapping;var T=e.getEnabledForAnnotationAction;var B=e.getCopyAction;var F=e.dataFieldIsCopyAction;var P=e.ButtonType;function U(e,t){var i,n,o;return((i=e.annotations)===null||i===void 0?void 0:(n=i.UI)===null||n===void 0?void 0:(o=n.Identification)===null||o===void 0?void 0:o.filter(e=>{var i,n,o,a,l,r,d,v,u,s;return((i=e.annotations)===null||i===void 0?void 0:(n=i.UI)===null||n===void 0?void 0:(o=n.Hidden)===null||o===void 0?void 0:o.valueOf())!==true&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&Boolean((a=e.Determining)===null||a===void 0?void 0:a.valueOf())===t&&(((l=e.ActionTarget)===null||l===void 0?void 0:(r=l.isBound)===null||r===void 0?void 0:r.valueOf())!==true||(e===null||e===void 0?void 0:(d=e.ActionTarget)===null||d===void 0?void 0:(v=d.annotations)===null||v===void 0?void 0:(u=v.Core)===null||u===void 0?void 0:(s=u.OperationAvailable)===null||s===void 0?void 0:s.valueOf())!==false)?true:false}))||[]}v.getIdentificationDataFieldForActions=U;function N(e,t){var i,n,o;return((i=e.annotations)===null||i===void 0?void 0:(n=i.UI)===null||n===void 0?void 0:(o=n.Identification)===null||o===void 0?void 0:o.filter(e=>{var i,n,o,a;return((i=e.annotations)===null||i===void 0?void 0:(n=i.UI)===null||n===void 0?void 0:(o=n.Hidden)===null||o===void 0?void 0:o.valueOf())!==true&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&Boolean((a=e.Determining)===null||a===void 0?void 0:a.valueOf())===t?true:false}))||[]}const H=["UI.CriticalityType/VeryPositive","UI.CriticalityType/Positive","UI.CriticalityType/Negative","UI.CriticalityType/VeryNegative"];function k(e,t){const i=e.getDataModelObjectPath(),n=i.navigationProperties.map(e=>e.name),o=E(t,n,undefined,t=>c(t,e.getConvertedTypes(),[])),a=e.getManifestWrapper(),l=a.getViewLevel(),r=l>1?s.IsEditable:g(s.IsEditable);return b(t===undefined||t.valueOf()===false,r,C(r,A(o,false)))}v.getDeleteButtonVisibility=k;function M(e,t,i){const n=i.getEntitySet(),a=o.isDraftRoot(n);let l=b(t!==undefined,t,b(e!==undefined,A(e,true),m(true)));l=a?C(l,g(y("DraftAdministrativeData/InProcessByUser"))):l;return l}v.getDeleteButtonEnabled=M;function x(e,t,i,n,a){const l=i===null||i===void 0?void 0:i.getEntitySet(),r=e.getEntitySet(),d=e.getManifestWrapper().isFclEnabled();let v;const u=R(i,t);if(a&&a>1){v=o.isDraftNode(r)}else{v=o.isDraftRoot(l)}const c=R(i,n);const p=g(s.IsEditable);const E=b(a>1,b(n===undefined||n.valueOf()===false,C(p,A(y("rootEditVisible","internal"),true),b(d,A(y("/showEditButton","fclhelper"),true),true)),C(p,A(c,false),A(y("rootEditVisible","internal"),true),b(d,A(y("/showEditButton","fclhelper"),true),true))),b(t===undefined||t.valueOf()===false,p,C(p,A(u,false))));return b(v,C(E,f.HasNoDraftForCurrentUser),E)}v.getEditButtonVisibility=x;function R(e,t){const i=e.getDataModelObjectPath(),n=i.navigationProperties.map(e=>e.name),o=E(t,n,undefined,t=>c(t,e.getConvertedTypes(),n));return o}v.getHiddenExpression=R;function V(e,t,i){const n=e.getEntitySet(),a=o.isDraftRoot(n),l=o.isSticky(n);let r;if(a&&!o.isSingleton(n)){var d,v;r=n===null||n===void 0?void 0:(d=n.annotations.Common)===null||d===void 0?void 0:(v=d.DraftRoot)===null||v===void 0?void 0:v.EditAction}else if(l&&!o.isSingleton(n)){var u,s;r=n===null||n===void 0?void 0:(u=n.annotations.Session)===null||u===void 0?void 0:(s=u.StickySessionSupported)===null||s===void 0?void 0:s.EditAction}if(r){var c,f;const n=e.getAbsoluteAnnotationPath(r);const o=e.resolveAbsolutePath(n).target;if((o===null||o===void 0?void 0:(c=o.annotations)===null||c===void 0?void 0:(f=c.Core)===null||f===void 0?void 0:f.OperationAvailable)===null){}else if(i>1){if(t!==undefined){return D(C(A(E(t),true),A(y("rootEditEnabled","internal"),true)))}else{return D(A(y("rootEditEnabled","internal"),true))}}else{return T(e,o??undefined)}}return"true"}v.getEditButtonEnabled=V;function j(e){var t,i,n,a,r;const d=e.getContextPath();const v=o.getRootEntitySetPath(d);const s=e.getConverterContextFor("/"+v);const f=e.getEntitySet(),y=e.getEntityType(),b=s.getEntitySet(),m=s.getEntityType(),C=o.getStickySession(b),O=o.getDraftRoot(b),T=o.getDraftNode(b),R=f&&((t=f.annotations)===null||t===void 0?void 0:(i=t.Capabilities)===null||i===void 0?void 0:i.DeleteRestrictions),j=o.isUpdateHidden(b,m),w=b&&!o.isSingleton(b)&&(j===null||j===void 0?void 0:j.valueOf()),L=e.getDataModelObjectPath(),W=p(L,{pathVisitor:(t,i)=>c(t,e.getConvertedTypes(),i)}),$=W?D(W):W,q=U(e.getEntityType(),false);const Q=e.getManifestWrapper().getViewLevel()===1?B(q.filter(e=>F(e))):undefined;const _=q.filter(e=>!F(e));const G=[];if(!o.isSingleton(f)&&O!==null&&O!==void 0&&O.EditAction&&w!==true){G.push({type:u.DraftActions,key:"DraftActions"})}const Y=e.getManifestWrapper().getViewLevel();const z=Y>1?f===null||f===void 0?void 0:(n=f.annotations.Capabilities)===null||n===void 0?void 0:(a=n.UpdateRestrictions)===null||a===void 0?void 0:a.Updatable:undefined;if(O||T){G.push({type:u.CollaborationAvatars,key:"CollaborationAvatars"})}_.filter(e=>H.indexOf(e===null||e===void 0?void 0:e.Criticality)>-1).forEach(t=>{G.push(K(t,e))});if((O!==null&&O!==void 0&&O.EditAction||C!==null&&C!==void 0&&C.EditAction)&&w!==true){G.push({type:u.Primary,key:"EditAction",visible:D(x(e,j,s,o.isUpdateHidden(f,y),Y)),enabled:V(s,z,Y)})}if($&&$!=="false"||(R===null||R===void 0?void 0:(r=R.Deletable)===null||r===void 0?void 0:r.valueOf())!==false&&$!=="false"){const t=o.getDeleteHidden(f,y);G.push({type:u.Secondary,key:"DeleteAction",visible:D(k(e,t)),enabled:D(M(R===null||R===void 0?void 0:R.Deletable,W,e)),parentEntityDeleteEnabled:$})}if(Q){var J;G.push({...K(Q,e),type:u.Copy,text:((J=Q.Label)===null||J===void 0?void 0:J.toString())??l.getLibraryResourceBundle("sap.fe.core").getText("C_COMMON_COPY")})}const X=N(e.getEntityType(),false);X.filter(e=>H.indexOf(e===null||e===void 0?void 0:e.Criticality)===-1).forEach(t=>{var i,n,o,a,l,r,d;if(((i=t.RequiresContext)===null||i===void 0?void 0:i.valueOf())===true){throw new Error(`RequiresContext property should not be true for header IBN action : ${t.Label}`)}if(((n=t.Inline)===null||n===void 0?void 0:n.valueOf())===true){throw new Error(`Inline property should not be true for header IBN action : ${t.Label}`)}const v={semanticObjectMapping:I(t.Mapping)};G.push({type:u.DataFieldForIntentBasedNavigation,text:(o=t.Label)===null||o===void 0?void 0:o.toString(),annotationPath:e.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),buttonType:P.Ghost,visible:D(g(A(E((a=t.annotations)===null||a===void 0?void 0:(l=a.UI)===null||l===void 0?void 0:(r=l.Hidden)===null||r===void 0?void 0:r.valueOf()),true))),enabled:t.NavigationAvailable!==undefined?D(A(E((d=t.NavigationAvailable)===null||d===void 0?void 0:d.valueOf()),true)):true,key:S.generateKeyFromDataField(t),isNavigable:true,press:D(h("._intentBasedNavigation.navigate",[E(t.SemanticObject),E(t.Action),v])),customData:D({semanticObject:E(t.SemanticObject),action:E(t.Action)})})});_.filter(e=>H.indexOf(e===null||e===void 0?void 0:e.Criticality)===-1).forEach(t=>{G.push(K(t,e))});return G}v.getHeaderDefaultActions=j;function w(e){var t,i,n;const o=e.getEntityType();const a=((t=o.annotations)===null||t===void 0?void 0:(i=t.UI)===null||i===void 0?void 0:(n=i.Identification)===null||n===void 0?void 0:n.filter(e=>{var t,i,n;return(e===null||e===void 0?void 0:(t=e.annotations)===null||t===void 0?void 0:(i=t.UI)===null||i===void 0?void 0:(n=i.Hidden)===null||n===void 0?void 0:n.valueOf())===true}))||[];return a.map(e=>({type:u.Default,key:S.generateKeyFromDataField(e)}))}v.getHiddenHeaderActions=w;function L(e,t){var i,n,a,l,r;const d=t.getEntitySet();const v=t.getEntityType();const s=o.getStickySession(d),c=!o.isSingleton(d)&&d&&(((i=d.annotations.Common)===null||i===void 0?void 0:(n=i.DraftRoot)===null||n===void 0?void 0:n.term)||((a=d.annotations)===null||a===void 0?void 0:(l=a.Session)===null||l===void 0?void 0:(r=l.StickySessionSupported)===null||r===void 0?void 0:r.term)),f=Boolean(c==="com.sap.vocabularies.Common.v1.DraftRoot"||s&&(s===null||s===void 0?void 0:s.SaveAction)),p=e>1,y=Boolean(c==="com.sap.vocabularies.Common.v1.DraftRoot"||s&&(s===null||s===void 0?void 0:s.DiscardAction));const g=U(t.getEntityType(),true);const b=g.filter(e=>H.indexOf(e===null||e===void 0?void 0:e.Criticality)>-1).map(e=>K(e,t));if((d===null||d===void 0?void 0:d.entityTypeName)===(v===null||v===void 0?void 0:v.fullyQualifiedName)&&f){b.push({type:u.Primary,key:"SaveAction"})}if(p){b.push({type:u.DefaultApply,key:"ApplyAction"})}g.filter(e=>H.indexOf(e===null||e===void 0?void 0:e.Criticality)===-1).forEach(e=>{b.push(K(e,t))});if(y){b.push({type:u.Secondary,key:"CancelAction",position:{placement:O.End}})}return b}v.getFooterDefaultActions=L;function K(e,t){var i,n;return{type:u.DataFieldForAction,annotationPath:t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),key:S.generateKeyFromDataField(e),visible:D(g(A(E((i=e.annotations)===null||i===void 0?void 0:(n=i.UI)===null||n===void 0?void 0:n.Hidden),true))),enabled:T(t,e.ActionTarget),isNavigable:true}}return v},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/templates/ListReportConverter-dbg", ["sap/fe/core/converters/controls/Common/Action", "sap/fe/core/converters/controls/ListReport/FilterBar", "sap/fe/core/converters/helpers/ConfigurableObject", "sap/fe/core/helpers/BindingToolkit", "../controls/Common/DataVisualization", "../controls/Common/KPI", "../helpers/ID", "../ManifestSettings"], function (Action, FilterBar, ConfigurableObject, BindingToolkit, DataVisualization, KPI, ID, ManifestSettings) {
  "use strict";

  var _exports = {};
  var VisualizationType = ManifestSettings.VisualizationType;
  var VariantManagementType = ManifestSettings.VariantManagementType;
  var TemplateType = ManifestSettings.TemplateType;
  var getTableID = ID.getTableID;
  var getIconTabBarID = ID.getIconTabBarID;
  var getFilterVariantManagementID = ID.getFilterVariantManagementID;
  var getFilterBarID = ID.getFilterBarID;
  var getDynamicListReportID = ID.getDynamicListReportID;
  var getCustomTabID = ID.getCustomTabID;
  var getChartID = ID.getChartID;
  var getKPIDefinitions = KPI.getKPIDefinitions;
  var isSelectionPresentationCompliant = DataVisualization.isSelectionPresentationCompliant;
  var isPresentationCompliant = DataVisualization.isPresentationCompliant;
  var getSelectionVariant = DataVisualization.getSelectionVariant;
  var getSelectionPresentationVariant = DataVisualization.getSelectionPresentationVariant;
  var getDefaultPresentationVariant = DataVisualization.getDefaultPresentationVariant;
  var getDefaultLineItem = DataVisualization.getDefaultLineItem;
  var getDefaultChart = DataVisualization.getDefaultChart;
  var getDataVisualizationConfiguration = DataVisualization.getDataVisualizationConfiguration;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var compileExpression = BindingToolkit.compileExpression;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var getSelectionFields = FilterBar.getSelectionFields;
  var getManifestFilterFields = FilterBar.getManifestFilterFields;
  var getFilterBarhideBasicSearch = FilterBar.getFilterBarhideBasicSearch;
  var getActionsFromManifest = Action.getActionsFromManifest;
  /**
   * Retrieves all list report tables.
   *
   * @param views The list report views configured in the manifest
   * @returns The list report table
   */
  function getTableVisualizations(views) {
    const tables = [];
    views.forEach(function (view) {
      if (!view.type) {
        const visualizations = view.secondaryVisualization ? view.secondaryVisualization.visualizations : view.presentation.visualizations;
        visualizations.forEach(function (visualization) {
          if (visualization.type === VisualizationType.Table) {
            tables.push(visualization);
          }
        });
      }
    });
    return tables;
  }
  function getChartVisualizations(views) {
    const charts = [];
    views.forEach(function (view) {
      if (!view.type) {
        const visualizations = view.primaryVisualization ? view.primaryVisualization.visualizations : view.presentation.visualizations;
        visualizations.forEach(function (visualization) {
          if (visualization.type === VisualizationType.Chart) {
            charts.push(visualization);
          }
        });
      }
    });
    return charts;
  }
  const getDefaultSemanticDates = function (filterFields) {
    const defaultSemanticDates = {};
    for (const filterField in filterFields) {
      var _filterFields$filterF, _filterFields$filterF2, _filterFields$filterF3;
      if ((_filterFields$filterF = filterFields[filterField]) !== null && _filterFields$filterF !== void 0 && (_filterFields$filterF2 = _filterFields$filterF.settings) !== null && _filterFields$filterF2 !== void 0 && (_filterFields$filterF3 = _filterFields$filterF2.defaultValues) !== null && _filterFields$filterF3 !== void 0 && _filterFields$filterF3.length) {
        var _filterFields$filterF4, _filterFields$filterF5;
        defaultSemanticDates[filterField] = (_filterFields$filterF4 = filterFields[filterField]) === null || _filterFields$filterF4 === void 0 ? void 0 : (_filterFields$filterF5 = _filterFields$filterF4.settings) === null || _filterFields$filterF5 === void 0 ? void 0 : _filterFields$filterF5.defaultValues;
      }
    }
    return defaultSemanticDates;
  };

  /**
   * Find a visualization annotation that can be used for rendering the list report.
   *
   * @param entityType The current EntityType
   * @param converterContext
   * @param bIsALP
   * @returns A compliant annotation for rendering the list report
   */
  function getCompliantVisualizationAnnotation(entityType, converterContext, bIsALP) {
    const annotationPath = converterContext.getManifestWrapper().getDefaultTemplateAnnotationPath();
    const selectionPresentationVariant = getSelectionPresentationVariant(entityType, annotationPath, converterContext);
    const sErrorForALP = "ALP flavor needs both chart and table to load the application";
    if (annotationPath && selectionPresentationVariant) {
      const presentationVariant = selectionPresentationVariant.PresentationVariant;
      if (!presentationVariant) {
        throw new Error("Presentation Variant is not configured in the SPV mentioned in the manifest");
      }
      const bPVComplaint = isPresentationCompliant(presentationVariant, bIsALP);
      if (!bPVComplaint) {
        if (bIsALP) {
          throw new Error(sErrorForALP);
        } else {
          return undefined;
        }
      }
      if (isSelectionPresentationCompliant(selectionPresentationVariant, bIsALP)) {
        return selectionPresentationVariant;
      }
    }
    if (selectionPresentationVariant) {
      if (isSelectionPresentationCompliant(selectionPresentationVariant, bIsALP)) {
        return selectionPresentationVariant;
      } else if (bIsALP) {
        throw new Error(sErrorForALP);
      }
    }
    const presentationVariant = getDefaultPresentationVariant(entityType);
    if (presentationVariant) {
      if (isPresentationCompliant(presentationVariant, bIsALP)) {
        return presentationVariant;
      } else if (bIsALP) {
        throw new Error(sErrorForALP);
      }
    }
    if (!bIsALP) {
      const defaultLineItem = getDefaultLineItem(entityType);
      if (defaultLineItem) {
        return defaultLineItem;
      }
    }
    return undefined;
  }
  const getView = function (viewConverterConfiguration) {
    let config = viewConverterConfiguration;
    if (config.converterContext) {
      var _presentation, _presentation$visuali;
      let converterContext = config.converterContext;
      config = config;
      const isMultipleViewConfiguration = function (currentConfig) {
        return currentConfig.key !== undefined;
      };
      let presentation = getDataVisualizationConfiguration(config.annotation ? converterContext.getRelativeAnnotationPath(config.annotation.fullyQualifiedName, converterContext.getEntityType()) : "", true, converterContext, config, undefined, undefined, isMultipleViewConfiguration(config));
      let tableControlId = "";
      let chartControlId = "";
      let title = "";
      let selectionVariantPath = "";
      const createVisualization = function (currentPresentation, isPrimary) {
        let defaultVisualization;
        for (const visualization of currentPresentation.visualizations) {
          if (isPrimary && visualization.type === VisualizationType.Chart) {
            defaultVisualization = visualization;
            break;
          }
          if (!isPrimary && visualization.type === VisualizationType.Table) {
            defaultVisualization = visualization;
            break;
          }
        }
        const presentationCreated = Object.assign({}, currentPresentation);
        if (defaultVisualization) {
          presentationCreated.visualizations = [defaultVisualization];
        } else {
          throw new Error((isPrimary ? "Primary" : "Secondary") + " visualisation needs valid " + (isPrimary ? "chart" : "table"));
        }
        return presentationCreated;
      };
      const getPresentation = function (item, isPrimary) {
        const resolvedTarget = converterContext.getEntityTypeAnnotation(item.annotationPath);
        const targetAnnotation = resolvedTarget.annotation;
        converterContext = resolvedTarget.converterContext;
        const annotation = targetAnnotation;
        if (annotation || converterContext.getTemplateType() === TemplateType.AnalyticalListPage) {
          presentation = getDataVisualizationConfiguration(annotation ? converterContext.getRelativeAnnotationPath(annotation.fullyQualifiedName, converterContext.getEntityType()) : "", true, converterContext, config);
          return presentation;
        } else {
          const sError = "Annotation Path for the " + (isPrimary ? "primary" : "secondary") + " visualisation mentioned in the manifest is not found";
          throw new Error(sError);
        }
      };
      const createAlpView = function (presentations, defaultPath) {
        var _primaryVisualization, _secondaryVisualizati, _secondaryVisualizati2;
        const primaryVisualization = createVisualization(presentations[0], true);
        chartControlId = primaryVisualization === null || primaryVisualization === void 0 ? void 0 : (_primaryVisualization = primaryVisualization.visualizations[0]) === null || _primaryVisualization === void 0 ? void 0 : _primaryVisualization.id;
        const secondaryVisualization = createVisualization(presentations[1] ? presentations[1] : presentations[0], false);
        tableControlId = secondaryVisualization === null || secondaryVisualization === void 0 ? void 0 : (_secondaryVisualizati = secondaryVisualization.visualizations[0]) === null || _secondaryVisualizati === void 0 ? void 0 : (_secondaryVisualizati2 = _secondaryVisualizati.annotation) === null || _secondaryVisualizati2 === void 0 ? void 0 : _secondaryVisualizati2.id;
        if (primaryVisualization && secondaryVisualization) {
          config = config;
          const visible = config.visible;
          const view = {
            primaryVisualization,
            secondaryVisualization,
            tableControlId,
            chartControlId,
            defaultPath,
            visible
          };
          return view;
        }
      };
      if (((_presentation = presentation) === null || _presentation === void 0 ? void 0 : (_presentation$visuali = _presentation.visualizations) === null || _presentation$visuali === void 0 ? void 0 : _presentation$visuali.length) === 2 && converterContext.getTemplateType() === TemplateType.AnalyticalListPage) {
        const view = createAlpView([presentation], "both");
        if (view) {
          return view;
        }
      } else if (converterContext.getManifestWrapper().hasMultipleVisualizations(config) || converterContext.getTemplateType() === TemplateType.AnalyticalListPage) {
        const {
          primary,
          secondary
        } = config;
        if (primary && primary.length && secondary && secondary.length) {
          const view = createAlpView([getPresentation(primary[0], true), getPresentation(secondary[0], false)], config.defaultPath);
          if (view) {
            return view;
          }
        } else {
          throw new Error("SecondaryItems in the Views is not present");
        }
      } else if (isMultipleViewConfiguration(config)) {
        // key exists only on multi tables mode
        const resolvedTarget = converterContext.getEntityTypeAnnotation(config.annotationPath);
        const viewAnnotation = resolvedTarget.annotation;
        converterContext = resolvedTarget.converterContext;
        title = compileExpression(getExpressionFromAnnotation(viewAnnotation.Text));
        // Need to loop on table into views since multi table mode get specific configuration (hidden filters or Table Id)
        presentation.visualizations.forEach((visualizationDefinition, index) => {
          switch (visualizationDefinition.type) {
            case VisualizationType.Table:
              const tableVisualization = presentation.visualizations[index];
              const filters = tableVisualization.control.filters || {};
              filters.hiddenFilters = filters.hiddenFilters || {
                paths: []
              };
              if (!config.keepPreviousPersonalization) {
                // Need to override Table Id to match with Tab Key (currently only table is managed in multiple view mode)
                tableVisualization.annotation.id = getTableID(config.key || "", "LineItem");
              }
              config = config;
              if (config && config.annotation && config.annotation.term === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant") {
                selectionVariantPath = `@${config.annotation.SelectionVariant.fullyQualifiedName.split("@")[1]}`;
              } else {
                selectionVariantPath = config.annotationPath;
              }
              //Provide Selection Variant to hiddenFilters in order to set the SV filters to the table.
              //MDC Table overrides binding Filter and from SAP FE the only method where we are able to add
              //additional filter is 'rebindTable' into Table delegate.
              //To avoid implementing specific LR feature to SAP FE Macro Table, the filter(s) related to the Tab (multi table mode)
              //can be passed to macro table via parameter/context named filters and key hiddenFilters.
              filters.hiddenFilters.paths.push({
                annotationPath: selectionVariantPath
              });
              tableVisualization.control.filters = filters;
              break;
            case VisualizationType.Chart:
              const chartVisualization = presentation.visualizations[index];
              chartVisualization.id = getChartID(config.key || "", "Chart");
              chartVisualization.multiViews = true;
              break;
            default:
              break;
          }
        });
      }
      presentation.visualizations.forEach(visualizationDefinition => {
        if (visualizationDefinition.type === VisualizationType.Table) {
          tableControlId = visualizationDefinition.annotation.id;
        } else if (visualizationDefinition.type === VisualizationType.Chart) {
          chartControlId = visualizationDefinition.id;
        }
      });
      config = config;
      const visible = config.visible;
      return {
        presentation,
        tableControlId,
        chartControlId,
        title,
        selectionVariantPath,
        visible
      };
    } else {
      config = config;
      const title = config.label,
        fragment = config.template,
        type = config.type,
        customTabId = getCustomTabID(config.key || ""),
        visible = config.visible;
      return {
        title,
        fragment,
        type,
        customTabId,
        visible
      };
    }
  };
  const getViews = function (converterContext, settingsViews) {
    let viewConverterConfigs = [];
    if (settingsViews) {
      settingsViews.paths.forEach(path => {
        if (converterContext.getManifestWrapper().hasMultipleVisualizations(path)) {
          if (settingsViews.paths.length > 1) {
            throw new Error("ALP flavor cannot have multiple views");
          } else {
            path = path;
            viewConverterConfigs.push({
              converterContext: converterContext,
              primary: path.primary,
              secondary: path.secondary,
              defaultPath: path.defaultPath
            });
          }
        } else if (path.template) {
          path = path;
          viewConverterConfigs.push({
            key: path.key,
            label: path.label,
            template: path.template,
            type: "Custom",
            visible: path.visible
          });
        } else {
          path = path;
          const viewConverterContext = converterContext.getConverterContextFor(path.contextPath || path.entitySet && `/${path.entitySet}` || converterContext.getContextPath()),
            entityType = viewConverterContext.getEntityType();
          if (entityType && viewConverterContext) {
            let annotation;
            const resolvedTarget = viewConverterContext.getEntityTypeAnnotation(path.annotationPath);
            const targetAnnotation = resolvedTarget.annotation;
            if (targetAnnotation) {
              annotation = targetAnnotation.term === "com.sap.vocabularies.UI.v1.SelectionVariant" ? getCompliantVisualizationAnnotation(entityType, viewConverterContext, false) : targetAnnotation;
              viewConverterConfigs.push({
                converterContext: viewConverterContext,
                annotation,
                annotationPath: path.annotationPath,
                keepPreviousPersonalization: path.keepPreviousPersonalization,
                key: path.key,
                visible: path.visible
              });
            }
          } else {
            // TODO Diagnostics message
          }
        }
      });
    } else {
      const entityType = converterContext.getEntityType();
      if (converterContext.getTemplateType() === TemplateType.AnalyticalListPage) {
        viewConverterConfigs = getAlpViewConfig(converterContext, viewConverterConfigs);
      } else {
        viewConverterConfigs.push({
          annotation: getCompliantVisualizationAnnotation(entityType, converterContext, false),
          converterContext: converterContext
        });
      }
    }
    return viewConverterConfigs.map(viewConverterConfig => {
      return getView(viewConverterConfig);
    });
  };
  const getMultiViewsControl = function (converterContext, views) {
    const manifestWrapper = converterContext.getManifestWrapper();
    const viewsDefinition = manifestWrapper.getViewConfiguration();
    if (views.length > 1 && !hasMultiVisualizations(converterContext)) {
      return {
        showTabCounts: viewsDefinition ? (viewsDefinition === null || viewsDefinition === void 0 ? void 0 : viewsDefinition.showCounts) || manifestWrapper.hasMultipleEntitySets() : undefined,
        // with multi EntitySets, tab counts are displayed by default
        id: getIconTabBarID()
      };
    }
    return undefined;
  };
  function getAlpViewConfig(converterContext, viewConfigs) {
    const entityType = converterContext.getEntityType();
    const annotation = getCompliantVisualizationAnnotation(entityType, converterContext, true);
    let chart, table;
    if (annotation) {
      viewConfigs.push({
        annotation: annotation,
        converterContext
      });
    } else {
      chart = getDefaultChart(entityType);
      table = getDefaultLineItem(entityType);
      if (chart && table) {
        const primary = [{
          annotationPath: "@" + chart.term
        }];
        const secondary = [{
          annotationPath: "@" + table.term
        }];
        viewConfigs.push({
          converterContext: converterContext,
          primary: primary,
          secondary: secondary,
          defaultPath: "both"
        });
      } else {
        throw new Error("ALP flavor needs both chart and table to load the application");
      }
    }
    return viewConfigs;
  }
  function hasMultiVisualizations(converterContext) {
    return converterContext.getManifestWrapper().hasMultipleVisualizations() || converterContext.getTemplateType() === TemplateType.AnalyticalListPage;
  }
  const getHeaderActions = function (converterContext) {
    const manifestWrapper = converterContext.getManifestWrapper();
    return insertCustomElements([], getActionsFromManifest(manifestWrapper.getHeaderActions(), converterContext).actions);
  };
  _exports.getHeaderActions = getHeaderActions;
  const checkChartFilterBarId = function (views, filterBarId) {
    views.forEach(view => {
      if (!view.type) {
        const presentation = view.presentation;
        presentation.visualizations.forEach(visualizationDefinition => {
          if (visualizationDefinition.type === VisualizationType.Chart && visualizationDefinition.filterId !== filterBarId) {
            visualizationDefinition.filterId = filterBarId;
          }
        });
      }
    });
  };

  /**
   * Creates the ListReportDefinition for multiple entity sets (multiple table mode).
   *
   * @param converterContext The converter context
   * @returns The list report definition based on annotation + manifest
   */
  _exports.checkChartFilterBarId = checkChartFilterBarId;
  const convertPage = function (converterContext) {
    const entityType = converterContext.getEntityType();
    const sContextPath = converterContext.getContextPath();
    if (!sContextPath) {
      // If we don't have an entitySet at this point we have an issue I'd say
      throw new Error("An EntitySet is required to be able to display a ListReport, please adjust your `entitySet` property to point to one.");
    }
    const manifestWrapper = converterContext.getManifestWrapper();
    const viewsDefinition = manifestWrapper.getViewConfiguration();
    const hasMultipleEntitySets = manifestWrapper.hasMultipleEntitySets();
    const views = getViews(converterContext, viewsDefinition);
    const lrTableVisualizations = getTableVisualizations(views);
    const lrChartVisualizations = getChartVisualizations(views);
    const showPinnableToggle = lrTableVisualizations.some(table => table.control.type === "ResponsiveTable");
    let singleTableId = "";
    let singleChartId = "";
    const dynamicListReportId = getDynamicListReportID();
    const filterBarId = getFilterBarID(sContextPath);
    const filterVariantManagementID = getFilterVariantManagementID(filterBarId);
    const fbConfig = manifestWrapper.getFilterConfiguration();
    const filterInitialLayout = (fbConfig === null || fbConfig === void 0 ? void 0 : fbConfig.initialLayout) !== undefined ? fbConfig === null || fbConfig === void 0 ? void 0 : fbConfig.initialLayout.toLowerCase() : "compact";
    const filterLayout = (fbConfig === null || fbConfig === void 0 ? void 0 : fbConfig.layout) !== undefined ? fbConfig === null || fbConfig === void 0 ? void 0 : fbConfig.layout.toLowerCase() : "compact";
    const useSemanticDateRange = fbConfig.useSemanticDateRange !== undefined ? fbConfig.useSemanticDateRange : true;
    const showClearButton = fbConfig.showClearButton !== undefined ? fbConfig.showClearButton : false;
    const oConfig = getContentAreaId(converterContext, views);
    if (oConfig) {
      singleChartId = oConfig.chartId;
      singleTableId = oConfig.tableId;
    }
    const useHiddenFilterBar = manifestWrapper.useHiddenFilterBar();
    // Chart has a dependency to filter bar (issue with loading data). Once resolved, the check for chart should be removed here.
    // Until then, hiding filter bar is now allowed if a chart is being used on LR.
    const hideFilterBar = (manifestWrapper.isFilterBarHidden() || useHiddenFilterBar) && singleChartId === "";
    const lrFilterProperties = getSelectionFields(converterContext, lrTableVisualizations);
    const selectionFields = lrFilterProperties.selectionFields;
    const propertyInfoFields = lrFilterProperties.sPropertyInfo;
    const hideBasicSearch = getFilterBarhideBasicSearch(lrTableVisualizations, lrChartVisualizations, converterContext);
    const multiViewControl = getMultiViewsControl(converterContext, views);
    const selectionVariant = multiViewControl ? undefined : getSelectionVariant(entityType, converterContext);
    const defaultSemanticDates = useSemanticDateRange ? getDefaultSemanticDates(getManifestFilterFields(entityType, converterContext)) : {};

    // Sort header actions according to position attributes in manifest
    const headerActions = getHeaderActions(converterContext);
    if (hasMultipleEntitySets) {
      checkChartFilterBarId(views, filterBarId);
    }
    const visualizationIds = lrTableVisualizations.map(visualization => {
      return visualization.annotation.id;
    }).concat(lrChartVisualizations.map(visualization => {
      return visualization.id;
    }));
    const targetControlIds = [...(hideFilterBar && !useHiddenFilterBar ? [] : [filterBarId]), ...(manifestWrapper.getVariantManagement() !== VariantManagementType.Control ? visualizationIds : []), ...(multiViewControl ? [multiViewControl.id] : [])];
    const stickySubheaderProvider = multiViewControl && manifestWrapper.getStickyMultiTabHeaderConfiguration() ? multiViewControl.id : undefined;
    return {
      mainEntitySet: sContextPath,
      mainEntityType: `${sContextPath}/`,
      multiViewsControl: multiViewControl,
      stickySubheaderProvider,
      singleTableId,
      singleChartId,
      dynamicListReportId,
      headerActions,
      showPinnableToggle: showPinnableToggle,
      filterBar: {
        propertyInfo: propertyInfoFields,
        selectionFields,
        hideBasicSearch,
        showClearButton
      },
      views: views,
      filterBarId: hideFilterBar && !useHiddenFilterBar ? "" : filterBarId,
      filterConditions: {
        selectionVariant: selectionVariant,
        defaultSemanticDates: defaultSemanticDates
      },
      variantManagement: {
        id: filterVariantManagementID,
        targetControlIds: targetControlIds.join(",")
      },
      hasMultiVisualizations: hasMultiVisualizations(converterContext),
      templateType: manifestWrapper.getTemplateType(),
      useSemanticDateRange,
      filterInitialLayout,
      filterLayout,
      kpiDefinitions: getKPIDefinitions(converterContext),
      hideFilterBar,
      useHiddenFilterBar
    };
  };
  _exports.convertPage = convertPage;
  function getContentAreaId(converterContext, views) {
    let singleTableId = "",
      singleChartId = "";
    if (converterContext.getManifestWrapper().hasMultipleVisualizations() || converterContext.getTemplateType() === TemplateType.AnalyticalListPage) {
      for (let view of views) {
        view = view;
        if (view.chartControlId && view.tableControlId) {
          singleChartId = view.chartControlId;
          singleTableId = view.tableControlId;
          break;
        }
      }
    } else {
      for (let view of views) {
        view = view;
        if (!singleTableId && view.tableControlId) {
          singleTableId = view.tableControlId || "";
        }
        if (!singleChartId && view.chartControlId) {
          singleChartId = view.chartControlId || "";
        }
        if (singleChartId && singleTableId) {
          break;
        }
      }
    }
    if (singleTableId || singleChartId) {
      return {
        chartId: singleChartId,
        tableId: singleTableId
      };
    }
    return undefined;
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/templates/ListReportConverter", ["sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/controls/ListReport/FilterBar","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/helpers/BindingToolkit","../controls/Common/DataVisualization","../controls/Common/KPI","../helpers/ID","../ManifestSettings"],function(t,e,n,i,a,o,r,s){"use strict";var l={};var c=s.VisualizationType;var u=s.VariantManagementType;var f=s.TemplateType;var d=r.getTableID;var p=r.getIconTabBarID;var h=r.getFilterVariantManagementID;var v=r.getFilterBarID;var y=r.getDynamicListReportID;var g=r.getCustomTabID;var m=r.getChartID;var C=o.getKPIDefinitions;var b=a.isSelectionPresentationCompliant;var P=a.isPresentationCompliant;var T=a.getSelectionVariant;var I=a.getSelectionPresentationVariant;var w=a.getDefaultPresentationVariant;var E=a.getDefaultLineItem;var V=a.getDefaultChart;var z=a.getDataVisualizationConfiguration;var S=i.getExpressionFromAnnotation;var k=i.compileExpression;var A=n.insertCustomElements;var M=e.getSelectionFields;var D=e.getManifestFilterFields;var F=e.getFilterBarhideBasicSearch;var L=t.getActionsFromManifest;function B(t){const e=[];t.forEach(function(t){if(!t.type){const n=t.secondaryVisualization?t.secondaryVisualization.visualizations:t.presentation.visualizations;n.forEach(function(t){if(t.type===c.Table){e.push(t)}})}});return e}function x(t){const e=[];t.forEach(function(t){if(!t.type){const n=t.primaryVisualization?t.primaryVisualization.visualizations:t.presentation.visualizations;n.forEach(function(t){if(t.type===c.Chart){e.push(t)}})}});return e}const R=function(t){const e={};for(const s in t){var n,i,a;if((n=t[s])!==null&&n!==void 0&&(i=n.settings)!==null&&i!==void 0&&(a=i.defaultValues)!==null&&a!==void 0&&a.length){var o,r;e[s]=(o=t[s])===null||o===void 0?void 0:(r=o.settings)===null||r===void 0?void 0:r.defaultValues}}return e};function W(t,e,n){const i=e.getManifestWrapper().getDefaultTemplateAnnotationPath();const a=I(t,i,e);const o="ALP flavor needs both chart and table to load the application";if(i&&a){const t=a.PresentationVariant;if(!t){throw new Error("Presentation Variant is not configured in the SPV mentioned in the manifest")}const e=P(t,n);if(!e){if(n){throw new Error(o)}else{return undefined}}if(b(a,n)){return a}}if(a){if(b(a,n)){return a}else if(n){throw new Error(o)}}const r=w(t);if(r){if(P(r,n)){return r}else if(n){throw new Error(o)}}if(!n){const e=E(t);if(e){return e}}return undefined}const H=function(t){let e=t;if(e.converterContext){var n,i;let t=e.converterContext;e=e;const a=function(t){return t.key!==undefined};let o=z(e.annotation?t.getRelativeAnnotationPath(e.annotation.fullyQualifiedName,t.getEntityType()):"",true,t,e,undefined,undefined,a(e));let r="";let s="";let l="";let u="";const p=function(t,e){let n;for(const i of t.visualizations){if(e&&i.type===c.Chart){n=i;break}if(!e&&i.type===c.Table){n=i;break}}const i=Object.assign({},t);if(n){i.visualizations=[n]}else{throw new Error((e?"Primary":"Secondary")+" visualisation needs valid "+(e?"chart":"table"))}return i};const h=function(n,i){const a=t.getEntityTypeAnnotation(n.annotationPath);const r=a.annotation;t=a.converterContext;const s=r;if(s||t.getTemplateType()===f.AnalyticalListPage){o=z(s?t.getRelativeAnnotationPath(s.fullyQualifiedName,t.getEntityType()):"",true,t,e);return o}else{const t="Annotation Path for the "+(i?"primary":"secondary")+" visualisation mentioned in the manifest is not found";throw new Error(t)}};const v=function(t,n){var i,a,o;const l=p(t[0],true);s=l===null||l===void 0?void 0:(i=l.visualizations[0])===null||i===void 0?void 0:i.id;const c=p(t[1]?t[1]:t[0],false);r=c===null||c===void 0?void 0:(a=c.visualizations[0])===null||a===void 0?void 0:(o=a.annotation)===null||o===void 0?void 0:o.id;if(l&&c){e=e;const t=e.visible;const i={primaryVisualization:l,secondaryVisualization:c,tableControlId:r,chartControlId:s,defaultPath:n,visible:t};return i}};if(((n=o)===null||n===void 0?void 0:(i=n.visualizations)===null||i===void 0?void 0:i.length)===2&&t.getTemplateType()===f.AnalyticalListPage){const t=v([o],"both");if(t){return t}}else if(t.getManifestWrapper().hasMultipleVisualizations(e)||t.getTemplateType()===f.AnalyticalListPage){const{primary:t,secondary:n}=e;if(t&&t.length&&n&&n.length){const i=v([h(t[0],true),h(n[0],false)],e.defaultPath);if(i){return i}}else{throw new Error("SecondaryItems in the Views is not present")}}else if(a(e)){const n=t.getEntityTypeAnnotation(e.annotationPath);const i=n.annotation;t=n.converterContext;l=k(S(i.Text));o.visualizations.forEach((t,n)=>{switch(t.type){case c.Table:const t=o.visualizations[n];const i=t.control.filters||{};i.hiddenFilters=i.hiddenFilters||{paths:[]};if(!e.keepPreviousPersonalization){t.annotation.id=d(e.key||"","LineItem")}e=e;if(e&&e.annotation&&e.annotation.term==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){u=`@${e.annotation.SelectionVariant.fullyQualifiedName.split("@")[1]}`}else{u=e.annotationPath}i.hiddenFilters.paths.push({annotationPath:u});t.control.filters=i;break;case c.Chart:const a=o.visualizations[n];a.id=m(e.key||"","Chart");a.multiViews=true;break;default:break}})}o.visualizations.forEach(t=>{if(t.type===c.Table){r=t.annotation.id}else if(t.type===c.Chart){s=t.id}});e=e;const y=e.visible;return{presentation:o,tableControlId:r,chartControlId:s,title:l,selectionVariantPath:u,visible:y}}else{e=e;const t=e.label,n=e.template,i=e.type,a=g(e.key||""),o=e.visible;return{title:t,fragment:n,type:i,customTabId:a,visible:o}}};const j=function(t,e){let n=[];if(e){e.paths.forEach(i=>{if(t.getManifestWrapper().hasMultipleVisualizations(i)){if(e.paths.length>1){throw new Error("ALP flavor cannot have multiple views")}else{i=i;n.push({converterContext:t,primary:i.primary,secondary:i.secondary,defaultPath:i.defaultPath})}}else if(i.template){i=i;n.push({key:i.key,label:i.label,template:i.template,type:"Custom",visible:i.visible})}else{i=i;const e=t.getConverterContextFor(i.contextPath||i.entitySet&&`/${i.entitySet}`||t.getContextPath()),a=e.getEntityType();if(a&&e){let t;const o=e.getEntityTypeAnnotation(i.annotationPath);const r=o.annotation;if(r){t=r.term==="com.sap.vocabularies.UI.v1.SelectionVariant"?W(a,e,false):r;n.push({converterContext:e,annotation:t,annotationPath:i.annotationPath,keepPreviousPersonalization:i.keepPreviousPersonalization,key:i.key,visible:i.visible})}}else{}}})}else{const e=t.getEntityType();if(t.getTemplateType()===f.AnalyticalListPage){n=Q(t,n)}else{n.push({annotation:W(e,t,false),converterContext:t})}}return n.map(t=>H(t))};const N=function(t,e){const n=t.getManifestWrapper();const i=n.getViewConfiguration();if(e.length>1&&!$(t)){return{showTabCounts:i?(i===null||i===void 0?void 0:i.showCounts)||n.hasMultipleEntitySets():undefined,id:p()}}return undefined};function Q(t,e){const n=t.getEntityType();const i=W(n,t,true);let a,o;if(i){e.push({annotation:i,converterContext:t})}else{a=V(n);o=E(n);if(a&&o){const n=[{annotationPath:"@"+a.term}];const i=[{annotationPath:"@"+o.term}];e.push({converterContext:t,primary:n,secondary:i,defaultPath:"both"})}else{throw new Error("ALP flavor needs both chart and table to load the application")}}return e}function $(t){return t.getManifestWrapper().hasMultipleVisualizations()||t.getTemplateType()===f.AnalyticalListPage}const K=function(t){const e=t.getManifestWrapper();return A([],L(e.getHeaderActions(),t).actions)};l.getHeaderActions=K;const O=function(t,e){t.forEach(t=>{if(!t.type){const n=t.presentation;n.visualizations.forEach(t=>{if(t.type===c.Chart&&t.filterId!==e){t.filterId=e}})}})};l.checkChartFilterBarId=O;const U=function(t){const e=t.getEntityType();const n=t.getContextPath();if(!n){throw new Error("An EntitySet is required to be able to display a ListReport, please adjust your `entitySet` property to point to one.")}const i=t.getManifestWrapper();const a=i.getViewConfiguration();const o=i.hasMultipleEntitySets();const r=j(t,a);const s=B(r);const l=x(r);const c=s.some(t=>t.control.type==="ResponsiveTable");let f="";let d="";const p=y();const g=v(n);const m=h(g);const b=i.getFilterConfiguration();const P=(b===null||b===void 0?void 0:b.initialLayout)!==undefined?b===null||b===void 0?void 0:b.initialLayout.toLowerCase():"compact";const I=(b===null||b===void 0?void 0:b.layout)!==undefined?b===null||b===void 0?void 0:b.layout.toLowerCase():"compact";const w=b.useSemanticDateRange!==undefined?b.useSemanticDateRange:true;const E=b.showClearButton!==undefined?b.showClearButton:false;const V=q(t,r);if(V){d=V.chartId;f=V.tableId}const z=i.useHiddenFilterBar();const S=(i.isFilterBarHidden()||z)&&d==="";const k=M(t,s);const A=k.selectionFields;const L=k.sPropertyInfo;const W=F(s,l,t);const H=N(t,r);const Q=H?undefined:T(e,t);const U=w?R(D(e,t)):{};const G=K(t);if(o){O(r,g)}const J=s.map(t=>t.annotation.id).concat(l.map(t=>t.id));const X=[...S&&!z?[]:[g],...i.getVariantManagement()!==u.Control?J:[],...H?[H.id]:[]];const Y=H&&i.getStickyMultiTabHeaderConfiguration()?H.id:undefined;return{mainEntitySet:n,mainEntityType:`${n}/`,multiViewsControl:H,stickySubheaderProvider:Y,singleTableId:f,singleChartId:d,dynamicListReportId:p,headerActions:G,showPinnableToggle:c,filterBar:{propertyInfo:L,selectionFields:A,hideBasicSearch:W,showClearButton:E},views:r,filterBarId:S&&!z?"":g,filterConditions:{selectionVariant:Q,defaultSemanticDates:U},variantManagement:{id:m,targetControlIds:X.join(",")},hasMultiVisualizations:$(t),templateType:i.getTemplateType(),useSemanticDateRange:w,filterInitialLayout:P,filterLayout:I,kpiDefinitions:C(t),hideFilterBar:S,useHiddenFilterBar:z}};l.convertPage=U;function q(t,e){let n="",i="";if(t.getManifestWrapper().hasMultipleVisualizations()||t.getTemplateType()===f.AnalyticalListPage){for(let t of e){t=t;if(t.chartControlId&&t.tableControlId){i=t.chartControlId;n=t.tableControlId;break}}}else{for(let t of e){t=t;if(!n&&t.tableControlId){n=t.tableControlId||""}if(!i&&t.chartControlId){i=t.chartControlId||""}if(i&&n){break}}}if(n||i){return{chartId:i,tableId:n}}return undefined}return l},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/templates/ObjectPageConverter-dbg", ["sap/fe/core/converters/controls/Common/Action", "sap/fe/core/converters/objectPage/HeaderAndFooterAction", "sap/fe/core/helpers/BindingToolkit", "../controls/ObjectPage/Avatar", "../controls/ObjectPage/HeaderFacet", "../controls/ObjectPage/SubSection", "../helpers/BindingHelper", "../helpers/ConfigurableObject", "../helpers/ID", "../ManifestSettings"], function (Action, HeaderAndFooterAction, BindingToolkit, Avatar, HeaderFacet, SubSection, BindingHelper, ConfigurableObject, ID, ManifestSettings) {
  "use strict";

  var _exports = {};
  var VisualizationType = ManifestSettings.VisualizationType;
  var TemplateType = ManifestSettings.TemplateType;
  var getSectionID = ID.getSectionID;
  var getEditableHeaderSectionID = ID.getEditableHeaderSectionID;
  var getCustomSectionID = ID.getCustomSectionID;
  var Placement = ConfigurableObject.Placement;
  var OverrideType = ConfigurableObject.OverrideType;
  var insertCustomElements = ConfigurableObject.insertCustomElements;
  var UI = BindingHelper.UI;
  var SubSectionType = SubSection.SubSectionType;
  var createSubSections = SubSection.createSubSections;
  var createCustomSubSections = SubSection.createCustomSubSections;
  var createCustomHeaderFacetSubSections = SubSection.createCustomHeaderFacetSubSections;
  var getHeaderFacetsFromManifest = HeaderFacet.getHeaderFacetsFromManifest;
  var getHeaderFacetsFromAnnotations = HeaderFacet.getHeaderFacetsFromAnnotations;
  var getAvatar = Avatar.getAvatar;
  var not = BindingToolkit.not;
  var ifElse = BindingToolkit.ifElse;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var equal = BindingToolkit.equal;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  var getHiddenHeaderActions = HeaderAndFooterAction.getHiddenHeaderActions;
  var getHeaderDefaultActions = HeaderAndFooterAction.getHeaderDefaultActions;
  var getFooterDefaultActions = HeaderAndFooterAction.getFooterDefaultActions;
  var removeDuplicateActions = Action.removeDuplicateActions;
  var getActionsFromManifest = Action.getActionsFromManifest;
  const getSectionKey = (facetDefinition, fallback) => {
    var _facetDefinition$ID, _facetDefinition$Labe;
    return ((_facetDefinition$ID = facetDefinition.ID) === null || _facetDefinition$ID === void 0 ? void 0 : _facetDefinition$ID.toString()) || ((_facetDefinition$Labe = facetDefinition.Label) === null || _facetDefinition$Labe === void 0 ? void 0 : _facetDefinition$Labe.toString()) || fallback;
  };

  /**
   * Creates a section that represents the editable header part; it is only visible in edit mode.
   *
   * @param converterContext The converter context
   * @param allHeaderFacets The converter context
   * @returns The section representing the editable header parts
   */
  function createEditableHeaderSection(converterContext, allHeaderFacets) {
    var _converterContext$get, _converterContext$get2;
    const editableHeaderSectionID = getEditableHeaderSectionID();
    const headerFacets = (_converterContext$get = converterContext.getEntityType().annotations) === null || _converterContext$get === void 0 ? void 0 : (_converterContext$get2 = _converterContext$get.UI) === null || _converterContext$get2 === void 0 ? void 0 : _converterContext$get2.HeaderFacets;
    const headerfacetSubSections = headerFacets ? createSubSections(headerFacets, converterContext, true) : [];
    const customHeaderFacetSubSections = createCustomHeaderFacetSubSections(converterContext);
    let allHeaderFacetsSubSections = [];
    if (customHeaderFacetSubSections.length > 0) {
      // merge annotation based header facets and custom header facets in the right order
      let i = 0;
      allHeaderFacets.forEach(function (item) {
        // hidden header facets are not included in allHeaderFacets array => add them anyway
        while (headerfacetSubSections.length > i && headerfacetSubSections[i].visible === "false") {
          allHeaderFacetsSubSections.push(headerfacetSubSections[i]);
          i++;
        }
        if (headerfacetSubSections.length > i && (item.key === headerfacetSubSections[i].key ||
        // for header facets with no id the keys of header facet and subsection are different => check only the last part
        item.key.slice(item.key.lastIndexOf("::") + 2) === headerfacetSubSections[i].key.slice(headerfacetSubSections[i].key.lastIndexOf("::") + 2))) {
          allHeaderFacetsSubSections.push(headerfacetSubSections[i]);
          i++;
        } else {
          customHeaderFacetSubSections.forEach(function (customItem) {
            if (item.key === customItem.key) {
              allHeaderFacetsSubSections.push(customItem);
            }
          });
        }
      });
    } else {
      allHeaderFacetsSubSections = headerfacetSubSections;
    }
    const headerSection = {
      id: editableHeaderSectionID,
      key: "EditableHeaderContent",
      title: "{sap.fe.i18n>T_COMMON_OBJECT_PAGE_HEADER_SECTION}",
      visible: compileExpression(UI.IsEditable),
      subSections: allHeaderFacetsSubSections
    };
    return headerSection;
  }

  /**
   * Creates a definition for a section based on the Facet annotation.
   *
   * @param converterContext The converter context
   * @returns All sections
   */
  _exports.createEditableHeaderSection = createEditableHeaderSection;
  function getSectionsFromAnnotation(converterContext) {
    var _entityType$annotatio, _entityType$annotatio2, _entityType$annotatio3;
    const entityType = converterContext.getEntityType();
    const objectPageSections = ((_entityType$annotatio = entityType.annotations) === null || _entityType$annotatio === void 0 ? void 0 : (_entityType$annotatio2 = _entityType$annotatio.UI) === null || _entityType$annotatio2 === void 0 ? void 0 : (_entityType$annotatio3 = _entityType$annotatio2.Facets) === null || _entityType$annotatio3 === void 0 ? void 0 : _entityType$annotatio3.map(facetDefinition => getSectionFromAnnotation(facetDefinition, converterContext))) || [];
    return objectPageSections;
  }

  /**
   * Create an annotation based section.
   *
   * @param facet
   * @param converterContext
   * @returns The current section
   */
  function getSectionFromAnnotation(facet, converterContext) {
    var _facet$annotations, _facet$annotations$UI, _facet$annotations$UI2;
    const sectionID = getSectionID(facet);
    const section = {
      id: sectionID,
      key: getSectionKey(facet, sectionID),
      title: compileExpression(getExpressionFromAnnotation(facet.Label)),
      showTitle: !!facet.Label,
      visible: compileExpression(not(equal(getExpressionFromAnnotation((_facet$annotations = facet.annotations) === null || _facet$annotations === void 0 ? void 0 : (_facet$annotations$UI = _facet$annotations.UI) === null || _facet$annotations$UI === void 0 ? void 0 : (_facet$annotations$UI2 = _facet$annotations$UI.Hidden) === null || _facet$annotations$UI2 === void 0 ? void 0 : _facet$annotations$UI2.valueOf()), true))),
      subSections: createSubSections([facet], converterContext)
    };
    return section;
  }

  /**
   * Creates section definitions based on the manifest definitions.
   *
   * @param manifestSections The sections defined in the manifest
   * @param converterContext
   * @returns The sections defined in the manifest
   */
  function getSectionsFromManifest(manifestSections, converterContext) {
    const sections = {};
    Object.keys(manifestSections).forEach(manifestSectionKey => {
      sections[manifestSectionKey] = getSectionFromManifest(manifestSections[manifestSectionKey], manifestSectionKey, converterContext);
    });
    return sections;
  }

  /**
   * Create a manifest-based custom section.
   *
   * @param customSectionDefinition
   * @param sectionKey
   * @param converterContext
   * @returns The current custom section
   */
  function getSectionFromManifest(customSectionDefinition, sectionKey, converterContext) {
    const customSectionID = customSectionDefinition.id || getCustomSectionID(sectionKey);
    let position = customSectionDefinition.position;
    if (!position) {
      position = {
        placement: Placement.After
      };
    }
    let manifestSubSections;
    if (!customSectionDefinition.subSections) {
      // If there is no subSection defined, we add the content of the custom section as subsections
      // and make sure to set the visibility to 'true', as the actual visibility is handled by the section itself
      manifestSubSections = {
        [sectionKey]: {
          ...customSectionDefinition,
          position: undefined,
          visible: "true"
        }
      };
    } else {
      manifestSubSections = customSectionDefinition.subSections;
    }
    const subSections = createCustomSubSections(manifestSubSections, converterContext);
    const customSection = {
      id: customSectionID,
      key: sectionKey,
      title: customSectionDefinition.title,
      showTitle: !!customSectionDefinition.title,
      visible: customSectionDefinition.visible !== undefined ? customSectionDefinition.visible : "true",
      position: position,
      subSections: subSections
    };
    return customSection;
  }

  /**
   * Retrieves the ObjectPage header actions (both the default ones and the custom ones defined in the manifest).
   *
   * @param converterContext The converter context
   * @returns An array containing all the actions for this ObjectPage header
   */
  const getHeaderActions = function (converterContext) {
    const aAnnotationHeaderActions = getHeaderDefaultActions(converterContext);
    const manifestWrapper = converterContext.getManifestWrapper();
    const manifestActions = getActionsFromManifest(manifestWrapper.getHeaderActions(), converterContext, aAnnotationHeaderActions, undefined, undefined, getHiddenHeaderActions(converterContext));
    const actionOverwriteConfig = {
      isNavigable: OverrideType.overwrite,
      enabled: OverrideType.overwrite,
      visible: OverrideType.overwrite,
      defaultValuesExtensionFunction: OverrideType.overwrite,
      command: OverrideType.overwrite
    };
    const headerActions = insertCustomElements(aAnnotationHeaderActions, manifestActions.actions, actionOverwriteConfig);
    return {
      actions: removeDuplicateActions(headerActions),
      commandActions: manifestActions.commandActions
    };
  };

  /**
   * Retrieves the ObjectPage footer actions (both the default ones and the custom ones defined in the manifest).
   *
   * @param converterContext The converter context
   * @returns An array containing all the actions for this ObjectPage footer
   */
  _exports.getHeaderActions = getHeaderActions;
  const getFooterActions = function (converterContext) {
    const manifestWrapper = converterContext.getManifestWrapper();
    const aAnnotationFooterActions = getFooterDefaultActions(manifestWrapper.getViewLevel(), converterContext);
    const manifestActions = getActionsFromManifest(manifestWrapper.getFooterActions(), converterContext, aAnnotationFooterActions);
    const actionOverwriteConfig = {
      isNavigable: OverrideType.overwrite,
      enabled: OverrideType.overwrite,
      visible: OverrideType.overwrite,
      defaultValuesExtensionFunction: OverrideType.overwrite,
      command: OverrideType.overwrite
    };
    const footerActions = insertCustomElements(aAnnotationFooterActions, manifestActions.actions, actionOverwriteConfig);
    return {
      actions: footerActions,
      commandActions: manifestActions.commandActions
    };
  };
  _exports.getFooterActions = getFooterActions;
  function _getSubSectionVisualization(subSection) {
    var _subSection$presentat;
    return subSection !== null && subSection !== void 0 && (_subSection$presentat = subSection.presentation) !== null && _subSection$presentat !== void 0 && _subSection$presentat.visualizations[0] ? subSection.presentation.visualizations[0] : undefined;
  }
  function _isFacetHasGridTableVisible(dataVisualizationSubSection, subSectionVisualization) {
    var _dataVisualizationSub, _subSectionVisualizat;
    return dataVisualizationSubSection.visible === "true" && (dataVisualizationSubSection === null || dataVisualizationSubSection === void 0 ? void 0 : (_dataVisualizationSub = dataVisualizationSubSection.presentation) === null || _dataVisualizationSub === void 0 ? void 0 : _dataVisualizationSub.visualizations) && (subSectionVisualization === null || subSectionVisualization === void 0 ? void 0 : subSectionVisualization.type) === "Table" && (subSectionVisualization === null || subSectionVisualization === void 0 ? void 0 : (_subSectionVisualizat = subSectionVisualization.control) === null || _subSectionVisualizat === void 0 ? void 0 : _subSectionVisualizat.type) === "GridTable";
  }
  function _setGridTableVisualizationInformation(sections, dataVisualizationSubSection, subSectionVisualization, sectionLayout) {
    if (_isFacetHasGridTableVisible(dataVisualizationSubSection, subSectionVisualization)) {
      const tableControlConfiguration = subSectionVisualization.control;
      if (!(sectionLayout === "Page" && sections.length > 1)) {
        tableControlConfiguration.rowCountMode = "Auto";
      }
      if (sectionLayout !== "Tabs") {
        tableControlConfiguration.useCondensedTableLayout = false;
      }
    }
  }
  function _setGridTableWithMixFacetsInformation(subSection, sectionLayout) {
    var _subSection$content;
    if ((subSection === null || subSection === void 0 ? void 0 : (_subSection$content = subSection.content) === null || _subSection$content === void 0 ? void 0 : _subSection$content.length) === 1) {
      var _presentation;
      const tableControl = ((_presentation = subSection.content[0].presentation) === null || _presentation === void 0 ? void 0 : _presentation.visualizations[0]).control;
      if (tableControl.type === "GridTable") {
        tableControl.rowCountMode = "Auto";
        if (sectionLayout !== "Tabs") {
          tableControl.useCondensedTableLayout = false;
        }
      }
    }
  }

  /**
   * Set the GridTable display information.
   *
   * @param sections The ObjectPage sections
   * @param section The current ObjectPage section processed
   * @param sectionLayout
   */
  function _setGridTableSubSectionControlConfiguration(sections, section, sectionLayout) {
    let dataVisualizationSubSection;
    let subSectionVisualization;
    const subSections = section.subSections;
    if (subSections.length === 1) {
      dataVisualizationSubSection = subSections[0];
      switch (subSections[0].type) {
        case "DataVisualization":
          subSectionVisualization = _getSubSectionVisualization(dataVisualizationSubSection);
          _setGridTableVisualizationInformation(sections, dataVisualizationSubSection, subSectionVisualization, sectionLayout);
          break;
        case "Mixed":
          _setGridTableWithMixFacetsInformation(dataVisualizationSubSection, sectionLayout);
          break;
        default:
          break;
      }
      return;
    }
    _removeCondensedFromSubSections(subSections);
  }

  /**
   * Remove the condense layout mode from the subsections.
   *
   * @param subSections The subSections where we need to remove the condensed layout
   */
  function _removeCondensedFromSubSections(subSections) {
    let dataVisualizationSubSection;
    // We check in each subsection if there is visualizations
    subSections.forEach(subSection => {
      var _dataVisualizationSub2, _dataVisualizationSub3, _dataVisualizationSub6;
      dataVisualizationSubSection = subSection;
      if ((_dataVisualizationSub2 = dataVisualizationSubSection) !== null && _dataVisualizationSub2 !== void 0 && (_dataVisualizationSub3 = _dataVisualizationSub2.presentation) !== null && _dataVisualizationSub3 !== void 0 && _dataVisualizationSub3.visualizations) {
        var _dataVisualizationSub4, _dataVisualizationSub5;
        (_dataVisualizationSub4 = dataVisualizationSubSection) === null || _dataVisualizationSub4 === void 0 ? void 0 : (_dataVisualizationSub5 = _dataVisualizationSub4.presentation) === null || _dataVisualizationSub5 === void 0 ? void 0 : _dataVisualizationSub5.visualizations.forEach(singleVisualization => {
          if (singleVisualization.type === VisualizationType.Table) {
            singleVisualization.control.useCondensedTableLayout = false;
          }
        });
      }
      // Then we check the content of the subsection, and in each content we check if there is a table to set its condensed layout to false
      if ((_dataVisualizationSub6 = dataVisualizationSubSection) !== null && _dataVisualizationSub6 !== void 0 && _dataVisualizationSub6.content) {
        dataVisualizationSubSection.content.forEach(singleContent => {
          var _presentation2;
          (_presentation2 = singleContent.presentation) === null || _presentation2 === void 0 ? void 0 : _presentation2.visualizations.forEach(singleVisualization => {
            if (singleVisualization.type === VisualizationType.Table) {
              singleVisualization.control.useCondensedTableLayout = false;
            }
          });
        });
      }
    });
  }
  /**
   * Retrieves and merges the ObjectPage sections defined in the annotation and in the manifest.
   *
   * @param converterContext The converter context
   * @returns An array of sections.
   */

  const getSections = function (converterContext) {
    const manifestWrapper = converterContext.getManifestWrapper();
    const sections = insertCustomElements(getSectionsFromAnnotation(converterContext), getSectionsFromManifest(manifestWrapper.getSections(), converterContext), {
      title: OverrideType.overwrite,
      visible: OverrideType.overwrite,
      subSections: {
        actions: OverrideType.merge,
        title: OverrideType.overwrite,
        sideContent: OverrideType.overwrite
      }
    });
    // Level Adjustment for "Mixed" Collection Facets:
    // ==============================================
    // The manifest definition of custom side contents and actions still needs to be aligned for "Mixed" collection facets:
    // Collection facets containing tables gain an extra reference facet as a table wrapper to ensure, that the table is always
    // placed in an own individual Object Page Block; this additional hierarchy level is unknown to app developers, which are
    // defining the side content and actions in the manifest at collection facet level; now, since the sideContent always needs
    // to be assigned to a block, and actions always need to be assigned to a form,
    // we need to move the sideContent and actions from a mixed collection facet to its content.
    // ==============================================
    sections.forEach(function (section) {
      var _section$subSections;
      _setGridTableSubSectionControlConfiguration(sections, section, manifestWrapper.getSectionLayout());
      (_section$subSections = section.subSections) === null || _section$subSections === void 0 ? void 0 : _section$subSections.forEach(function (subSection) {
        var _subSection$content2;
        subSection.title = subSection.title === "undefined" ? undefined : subSection.title;
        if (subSection.type === "Mixed" && (_subSection$content2 = subSection.content) !== null && _subSection$content2 !== void 0 && _subSection$content2.length) {
          var _actions;
          const firstForm = subSection.content.find(element => element.type === SubSectionType.Form);

          // 1. Copy sideContent to the SubSection's first form; or -- if unavailable -- to its first content
          // 2. Copy actions to the first form of the SubSection's content
          // 3. Delete sideContent / actions at the (invalid) manifest level

          if (subSection.sideContent) {
            if (firstForm) {
              // If there is a form, it always needs to be attached to the form, as the form inherits the ID of the SubSection
              firstForm.sideContent = subSection.sideContent;
            } else {
              subSection.content[0].sideContent = subSection.sideContent;
            }
            subSection.sideContent = undefined;
          }
          if (firstForm && (_actions = subSection.actions) !== null && _actions !== void 0 && _actions.length) {
            firstForm.actions = subSection.actions;
            subSection.actions = [];
          }
        }
      });
    });
    return sections;
  };

  /**
   * Determines if the ObjectPage has header content.
   *
   * @param converterContext The instance of the converter context
   * @returns `true` if there is at least on header facet
   */
  _exports.getSections = getSections;
  function hasHeaderContent(converterContext) {
    var _converterContext$get3, _converterContext$get4;
    const manifestWrapper = converterContext.getManifestWrapper();
    return (((_converterContext$get3 = converterContext.getEntityType().annotations) === null || _converterContext$get3 === void 0 ? void 0 : (_converterContext$get4 = _converterContext$get3.UI) === null || _converterContext$get4 === void 0 ? void 0 : _converterContext$get4.HeaderFacets) || []).length > 0 || Object.keys(manifestWrapper.getHeaderFacets()).length > 0;
  }

  /**
   * Gets the expression to evaluate the visibility of the header content.
   *
   * @param converterContext The instance of the converter context
   * @returns The binding expression for the Delete button
   */
  function getShowHeaderContentExpression(converterContext) {
    const manifestWrapper = converterContext.getManifestWrapper();
    return ifElse(!hasHeaderContent(converterContext), constant(false), ifElse(equal(manifestWrapper.isHeaderEditable(), false), constant(true), not(UI.IsEditable)));
  }

  /**
   * Gets the binding expression to evaluate the visibility of the header content.
   *
   * @param converterContext The instance of the converter context
   * @returns The binding expression for the Delete button
   */
  const getShowHeaderContent = function (converterContext) {
    return compileExpression(getShowHeaderContentExpression(converterContext));
  };

  /**
   * Gets the binding expression to evaluate the visibility of the avatar when the header is in expanded state.
   *
   * @param converterContext The instance of the converter context
   * @returns The binding expression for the Delete button
   */
  _exports.getShowHeaderContent = getShowHeaderContent;
  const getExpandedImageVisible = function (converterContext) {
    return compileExpression(not(getShowHeaderContentExpression(converterContext)));
  };
  _exports.getExpandedImageVisible = getExpandedImageVisible;
  const convertPage = function (converterContext) {
    var _entityType$annotatio4, _entityType$annotatio5;
    const manifestWrapper = converterContext.getManifestWrapper();
    let headerSection;
    const entityType = converterContext.getEntityType();

    // Retrieve all header facets (from annotations & custom)
    const headerFacets = insertCustomElements(getHeaderFacetsFromAnnotations(converterContext), getHeaderFacetsFromManifest(manifestWrapper.getHeaderFacets()));

    // Retrieve the page header actions
    const headerActions = getHeaderActions(converterContext);

    // Retrieve the page footer actions
    const footerActions = getFooterActions(converterContext);
    if (manifestWrapper.isHeaderEditable() && ((_entityType$annotatio4 = entityType.annotations.UI) !== null && _entityType$annotatio4 !== void 0 && _entityType$annotatio4.HeaderFacets || (_entityType$annotatio5 = entityType.annotations.UI) !== null && _entityType$annotatio5 !== void 0 && _entityType$annotatio5.HeaderInfo)) {
      headerSection = createEditableHeaderSection(converterContext, headerFacets);
    }
    const sections = getSections(converterContext);
    return {
      template: TemplateType.ObjectPage,
      header: {
        visible: manifestWrapper.getShowObjectPageHeader(),
        section: headerSection,
        facets: headerFacets,
        actions: headerActions.actions,
        showContent: getShowHeaderContent(converterContext),
        hasContent: hasHeaderContent(converterContext),
        avatar: getAvatar(converterContext),
        title: {
          expandedImageVisible: getExpandedImageVisible(converterContext)
        }
      },
      sections: sections,
      footerActions: footerActions.actions,
      headerCommandActions: headerActions.commandActions,
      footerCommandActions: footerActions.commandActions,
      showAnchorBar: manifestWrapper.getShowAnchorBar(),
      useIconTabBar: manifestWrapper.useIconTabBar()
    };
  };
  _exports.convertPage = convertPage;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/converters/templates/ObjectPageConverter", ["sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/objectPage/HeaderAndFooterAction","sap/fe/core/helpers/BindingToolkit","../controls/ObjectPage/Avatar","../controls/ObjectPage/HeaderFacet","../controls/ObjectPage/SubSection","../helpers/BindingHelper","../helpers/ConfigurableObject","../helpers/ID","../ManifestSettings"],function(e,t,n,o,i,a,s,r,c,l){"use strict";var d={};var u=l.VisualizationType;var v=l.TemplateType;var f=c.getSectionID;var b=c.getEditableHeaderSectionID;var g=c.getCustomSectionID;var p=r.Placement;var m=r.OverrideType;var h=r.insertCustomElements;var y=s.UI;var A=a.SubSectionType;var E=a.createSubSections;var S=a.createCustomSubSections;var C=a.createCustomHeaderFacetSubSections;var T=i.getHeaderFacetsFromManifest;var w=i.getHeaderFacetsFromAnnotations;var H=o.getAvatar;var I=n.not;var F=n.ifElse;var k=n.getExpressionFromAnnotation;var O=n.equal;var M=n.constant;var x=n.compileExpression;var D=t.getHiddenHeaderActions;var P=t.getHeaderDefaultActions;var j=t.getFooterDefaultActions;var z=e.removeDuplicateActions;var L=e.getActionsFromManifest;const B=(e,t)=>{var n,o;return((n=e.ID)===null||n===void 0?void 0:n.toString())||((o=e.Label)===null||o===void 0?void 0:o.toString())||t};function U(e,t){var n,o;const i=b();const a=(n=e.getEntityType().annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:o.HeaderFacets;const s=a?E(a,e,true):[];const r=C(e);let c=[];if(r.length>0){let e=0;t.forEach(function(t){while(s.length>e&&s[e].visible==="false"){c.push(s[e]);e++}if(s.length>e&&(t.key===s[e].key||t.key.slice(t.key.lastIndexOf("::")+2)===s[e].key.slice(s[e].key.lastIndexOf("::")+2))){c.push(s[e]);e++}else{r.forEach(function(e){if(t.key===e.key){c.push(e)}})}})}else{c=s}const l={id:i,key:"EditableHeaderContent",title:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_HEADER_SECTION}",visible:x(y.IsEditable),subSections:c};return l}d.createEditableHeaderSection=U;function V(e){var t,n,o;const i=e.getEntityType();const a=((t=i.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:(o=n.Facets)===null||o===void 0?void 0:o.map(t=>W(t,e)))||[];return a}function W(e,t){var n,o,i;const a=f(e);const s={id:a,key:B(e,a),title:x(k(e.Label)),showTitle:!!e.Label,visible:x(I(O(k((n=e.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:(i=o.Hidden)===null||i===void 0?void 0:i.valueOf()),true))),subSections:E([e],t)};return s}function _(e,t){const n={};Object.keys(e).forEach(o=>{n[o]=N(e[o],o,t)});return n}function N(e,t,n){const o=e.id||g(t);let i=e.position;if(!i){i={placement:p.After}}let a;if(!e.subSections){a={[t]:{...e,position:undefined,visible:"true"}}}else{a=e.subSections}const s=S(a,n);const r={id:o,key:t,title:e.title,showTitle:!!e.title,visible:e.visible!==undefined?e.visible:"true",position:i,subSections:s};return r}const G=function(e){const t=P(e);const n=e.getManifestWrapper();const o=L(n.getHeaderActions(),e,t,undefined,undefined,D(e));const i={isNavigable:m.overwrite,enabled:m.overwrite,visible:m.overwrite,defaultValuesExtensionFunction:m.overwrite,command:m.overwrite};const a=h(t,o.actions,i);return{actions:z(a),commandActions:o.commandActions}};d.getHeaderActions=G;const q=function(e){const t=e.getManifestWrapper();const n=j(t.getViewLevel(),e);const o=L(t.getFooterActions(),e,n);const i={isNavigable:m.overwrite,enabled:m.overwrite,visible:m.overwrite,defaultValuesExtensionFunction:m.overwrite,command:m.overwrite};const a=h(n,o.actions,i);return{actions:a,commandActions:o.commandActions}};d.getFooterActions=q;function J(e){var t;return e!==null&&e!==void 0&&(t=e.presentation)!==null&&t!==void 0&&t.visualizations[0]?e.presentation.visualizations[0]:undefined}function R(e,t){var n,o;return e.visible==="true"&&(e===null||e===void 0?void 0:(n=e.presentation)===null||n===void 0?void 0:n.visualizations)&&(t===null||t===void 0?void 0:t.type)==="Table"&&(t===null||t===void 0?void 0:(o=t.control)===null||o===void 0?void 0:o.type)==="GridTable"}function K(e,t,n,o){if(R(t,n)){const t=n.control;if(!(o==="Page"&&e.length>1)){t.rowCountMode="Auto"}if(o!=="Tabs"){t.useCondensedTableLayout=false}}}function Q(e,t){var n;if((e===null||e===void 0?void 0:(n=e.content)===null||n===void 0?void 0:n.length)===1){var o;const n=((o=e.content[0].presentation)===null||o===void 0?void 0:o.visualizations[0]).control;if(n.type==="GridTable"){n.rowCountMode="Auto";if(t!=="Tabs"){n.useCondensedTableLayout=false}}}}function X(e,t,n){let o;let i;const a=t.subSections;if(a.length===1){o=a[0];switch(a[0].type){case"DataVisualization":i=J(o);K(e,o,i,n);break;case"Mixed":Q(o,n);break;default:break}return}Y(a)}function Y(e){let t;e.forEach(e=>{var n,o,i;t=e;if((n=t)!==null&&n!==void 0&&(o=n.presentation)!==null&&o!==void 0&&o.visualizations){var a,s;(a=t)===null||a===void 0?void 0:(s=a.presentation)===null||s===void 0?void 0:s.visualizations.forEach(e=>{if(e.type===u.Table){e.control.useCondensedTableLayout=false}})}if((i=t)!==null&&i!==void 0&&i.content){t.content.forEach(e=>{var t;(t=e.presentation)===null||t===void 0?void 0:t.visualizations.forEach(e=>{if(e.type===u.Table){e.control.useCondensedTableLayout=false}})})}})}const Z=function(e){const t=e.getManifestWrapper();const n=h(V(e),_(t.getSections(),e),{title:m.overwrite,visible:m.overwrite,subSections:{actions:m.merge,title:m.overwrite,sideContent:m.overwrite}});n.forEach(function(e){var o;X(n,e,t.getSectionLayout());(o=e.subSections)===null||o===void 0?void 0:o.forEach(function(e){var t;e.title=e.title==="undefined"?undefined:e.title;if(e.type==="Mixed"&&(t=e.content)!==null&&t!==void 0&&t.length){var n;const t=e.content.find(e=>e.type===A.Form);if(e.sideContent){if(t){t.sideContent=e.sideContent}else{e.content[0].sideContent=e.sideContent}e.sideContent=undefined}if(t&&(n=e.actions)!==null&&n!==void 0&&n.length){t.actions=e.actions;e.actions=[]}}})});return n};d.getSections=Z;function $(e){var t,n;const o=e.getManifestWrapper();return(((t=e.getEntityType().annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:n.HeaderFacets)||[]).length>0||Object.keys(o.getHeaderFacets()).length>0}function ee(e){const t=e.getManifestWrapper();return F(!$(e),M(false),F(O(t.isHeaderEditable(),false),M(true),I(y.IsEditable)))}const te=function(e){return x(ee(e))};d.getShowHeaderContent=te;const ne=function(e){return x(I(ee(e)))};d.getExpandedImageVisible=ne;const oe=function(e){var t,n;const o=e.getManifestWrapper();let i;const a=e.getEntityType();const s=h(w(e),T(o.getHeaderFacets()));const r=G(e);const c=q(e);if(o.isHeaderEditable()&&((t=a.annotations.UI)!==null&&t!==void 0&&t.HeaderFacets||(n=a.annotations.UI)!==null&&n!==void 0&&n.HeaderInfo)){i=U(e,s)}const l=Z(e);return{template:v.ObjectPage,header:{visible:o.getShowObjectPageHeader(),section:i,facets:s,actions:r.actions,showContent:te(e),hasContent:$(e),avatar:H(e),title:{expandedImageVisible:ne(e)}},sections:l,footerActions:c.actions,headerCommandActions:r.commandActions,footerCommandActions:c.commandActions,showAnchorBar:o.getShowAnchorBar(),useIconTabBar:o.useIconTabBar()}};d.convertPage=oe;return d},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/CollaborationFormatter-dbg", ["sap/ui/core/Core"], function (Core) {
  "use strict";

  var _exports = {};
  const collaborationFormatters = function (sName) {
    if (collaborationFormatters.hasOwnProperty(sName)) {
      for (var _len = arguments.length, oArgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        oArgs[_key - 1] = arguments[_key];
      }
      return collaborationFormatters[sName].apply(this, oArgs);
    } else {
      return "";
    }
  };
  const hasCollaborationActivity = function (activities) {
    for (var _len2 = arguments.length, keys = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
      keys[_key2 - 1] = arguments[_key2];
    }
    return !!getCollaborationActivity(activities, ...keys);
  };
  hasCollaborationActivity.__functionName = "sap.fe.core.formatters.CollaborationFormatter#hasCollaborationActivity";
  _exports.hasCollaborationActivity = hasCollaborationActivity;
  const getCollaborationActivityInitials = function (activities) {
    for (var _len3 = arguments.length, keys = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
      keys[_key3 - 1] = arguments[_key3];
    }
    const activity = getCollaborationActivity(activities, ...keys);
    return (activity === null || activity === void 0 ? void 0 : activity.initials) || undefined;
  };
  getCollaborationActivityInitials.__functionName = "sap.fe.core.formatters.CollaborationFormatter#getCollaborationActivityInitials";
  _exports.getCollaborationActivityInitials = getCollaborationActivityInitials;
  const getCollaborationActivityColor = function (activities) {
    for (var _len4 = arguments.length, keys = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
      keys[_key4 - 1] = arguments[_key4];
    }
    const activity = getCollaborationActivity(activities, ...keys);
    return activity !== null && activity !== void 0 && activity.color ? `Accent${activity.color}` : undefined;
  };
  getCollaborationActivityColor.__functionName = "sap.fe.core.formatters.CollaborationFormatter#getCollaborationActivityColor";
  _exports.getCollaborationActivityColor = getCollaborationActivityColor;
  function getCollaborationActivity(activities) {
    for (var _len5 = arguments.length, keys = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {
      keys[_key5 - 1] = arguments[_key5];
    }
    if (activities && activities.length > 0) {
      return activities.find(function (activity) {
        var _activity$key;
        const activityKeys = (activity === null || activity === void 0 ? void 0 : (_activity$key = activity.key) === null || _activity$key === void 0 ? void 0 : _activity$key.split(",")) || [];
        let compareKey = "";
        let splitKeys;
        for (let i = 0; i < activityKeys.length; i++) {
          var _keys$i;
          // take care on short and full notation
          splitKeys = activityKeys[i].split("=");
          compareKey = (splitKeys[1] || splitKeys[0]).split("'").join("");
          if (compareKey !== ((_keys$i = keys[i]) === null || _keys$i === void 0 ? void 0 : _keys$i.toString())) {
            return false;
          }
        }
        return true;
      });
    }
  }

  /**
   * Compute the Invitation dialog title based on the underlying resource bundle.
   *
   * @param args The inner function parameters
   * @returns The dialog title
   */
  const getFormattedText = function () {
    const textId = arguments.length <= 0 ? undefined : arguments[0];
    const resourceModel = Core.getLibraryResourceBundle("sap.fe.core");
    const params = [];
    for (let i = 1; i < arguments.length; i++) {
      params.push(i < 0 || arguments.length <= i ? undefined : arguments[i]);
    }
    return resourceModel.getText(textId, params);
  };
  getFormattedText.__functionName = "sap.fe.core.formatters.CollaborationFormatter#getFormattedText";
  _exports.getFormattedText = getFormattedText;
  collaborationFormatters.hasCollaborationActivity = hasCollaborationActivity;
  collaborationFormatters.getCollaborationActivityInitials = getCollaborationActivityInitials;
  collaborationFormatters.getCollaborationActivityColor = getCollaborationActivityColor;
  collaborationFormatters.getFormattedText = getFormattedText;
  /**
   * @global
   */
  return collaborationFormatters;
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/CollaborationFormatter", ["sap/ui/core/Core"],function(t){"use strict";var o={};const r=function(t){if(r.hasOwnProperty(t)){for(var o=arguments.length,n=new Array(o>1?o-1:0),e=1;e<o;e++){n[e-1]=arguments[e]}return r[t].apply(this,n)}else{return""}};const n=function(t){for(var o=arguments.length,r=new Array(o>1?o-1:0),n=1;n<o;n++){r[n-1]=arguments[n]}return!!a(t,...r)};n.__functionName="sap.fe.core.formatters.CollaborationFormatter#hasCollaborationActivity";o.hasCollaborationActivity=n;const e=function(t){for(var o=arguments.length,r=new Array(o>1?o-1:0),n=1;n<o;n++){r[n-1]=arguments[n]}const e=a(t,...r);return(e===null||e===void 0?void 0:e.initials)||undefined};e.__functionName="sap.fe.core.formatters.CollaborationFormatter#getCollaborationActivityInitials";o.getCollaborationActivityInitials=e;const i=function(t){for(var o=arguments.length,r=new Array(o>1?o-1:0),n=1;n<o;n++){r[n-1]=arguments[n]}const e=a(t,...r);return e!==null&&e!==void 0&&e.color?`Accent${e.color}`:undefined};i.__functionName="sap.fe.core.formatters.CollaborationFormatter#getCollaborationActivityColor";o.getCollaborationActivityColor=i;function a(t){for(var o=arguments.length,r=new Array(o>1?o-1:0),n=1;n<o;n++){r[n-1]=arguments[n]}if(t&&t.length>0){return t.find(function(t){var o;const n=(t===null||t===void 0?void 0:(o=t.key)===null||o===void 0?void 0:o.split(","))||[];let e="";let i;for(let t=0;t<n.length;t++){var a;i=n[t].split("=");e=(i[1]||i[0]).split("'").join("");if(e!==((a=r[t])===null||a===void 0?void 0:a.toString())){return false}}return true})}}const l=function(){const o=arguments.length<=0?undefined:arguments[0];const r=t.getLibraryResourceBundle("sap.fe.core");const n=[];for(let t=1;t<arguments.length;t++){n.push(t<0||arguments.length<=t?undefined:arguments[t])}return r.getText(o,n)};l.__functionName="sap.fe.core.formatters.CollaborationFormatter#getFormattedText";o.getFormattedText=l;r.hasCollaborationActivity=n;r.getCollaborationActivityInitials=e;r.getCollaborationActivityColor=i;r.getFormattedText=l;return r},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/FPMFormatter-dbg", [], function () {
  "use strict";

  const customBooleanPropertyCheck = function (oView, modulePath, aSelectedContexts) {
    const oExtensionAPI = oView.getController().getExtensionAPI();
    const parts = modulePath.split(".");
    const methodName = parts.pop();
    const moduleName = parts.join("/");
    return new Promise(resolve => {
      sap.ui.require([moduleName], module => {
        resolve(module[methodName].bind(oExtensionAPI)(this.getBindingContext(), aSelectedContexts || []));
      });
    });
  };
  customBooleanPropertyCheck.__functionName = "sap.fe.core.formatters.FPMFormatter#customBooleanPropertyCheck";

  /**
   * Collection of table formatters.
   *
   * @param this The context
   * @param sName The inner function name
   * @param oArgs The inner function parameters
   * @returns The value from the inner function
   */
  const fpmFormatter = function (sName) {
    if (fpmFormatter.hasOwnProperty(sName)) {
      for (var _len = arguments.length, oArgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        oArgs[_key - 1] = arguments[_key];
      }
      return fpmFormatter[sName].apply(this, oArgs);
    } else {
      return "";
    }
  };
  fpmFormatter.customBooleanPropertyCheck = customBooleanPropertyCheck;

  /**
   * @global
   */
  return fpmFormatter;
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/FPMFormatter", [],function(){"use strict";const t=function(t,e,n){const o=t.getController().getExtensionAPI();const r=e.split(".");const s=r.pop();const i=r.join("/");return new Promise(t=>{sap.ui.require([i],e=>{t(e[s].bind(o)(this.getBindingContext(),n||[]))})})};t.__functionName="sap.fe.core.formatters.FPMFormatter#customBooleanPropertyCheck";const e=function(t){if(e.hasOwnProperty(t)){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++){o[r-1]=arguments[r]}return e[t].apply(this,o)}else{return""}};e.customBooleanPropertyCheck=t;return e},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/FiscalFormat-dbg", ["sap/ui/core/Locale", "sap/ui/core/LocaleData"], function (Locale, LocaleData) {
  "use strict";

  var _exports = {};
  /**
   * Constructor for a new FiscalFormat
   *
   * @param formatOptions Object that defines format options
   * @param formatOptions.format String with fiscal format
   * @param formatOptions.calendarType String with calendar type
   * @class
   * <h3>Overview</h3>
   *
   * Formatting, Validating and Parsing Fiscal Dates
   * @author SAP SE
   * @version 1.111.1
   * @experimental This module is only for internal/experimental use!
   * @hideconstructor
   */
  let FiscalFormat = /*#__PURE__*/function () {
    function FiscalFormat(formatOptions) {
      const locale = new Locale(sap.ui.getCore().getConfiguration().getLanguage()),
        localeData = new LocaleData(locale);
      let format = formatOptions.format;
      if (formatOptions.format.length > 4) {
        format = "yM";
      } else if (formatOptions.format === "PPP") {
        format = "M";
      }
      let pattern = localeData.getCustomDateTimePattern(format, formatOptions.calendarType);
      pattern = pattern.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi, "");
      // Parsing the "yM" format pattern to the pattern that would match the passed format
      if (formatOptions.format.length > 4) {
        pattern = pattern.replace(/y+/i, formatOptions.format.slice(0, formatOptions.format.lastIndexOf("Y") + 1));
        pattern = pattern.replace(/m+/i, formatOptions.format.slice(formatOptions.format.lastIndexOf("Y") + 1));
      } else if (formatOptions.format === "PPP") {
        pattern = "PPP";
      }
      const formatArray = this.parseCalendarDatePattern(pattern);
      this.pattern = formatArray.length > 1 ? pattern : undefined;
      this._setFormatRegex(formatArray);
      this._setParseRegex(formatArray);
      this._setValidationRegex(formatArray);
    }

    /**
     * Get a date instance of the <code>FiscalFormat</code> class, which can be used for formatting.
     *
     * @param formatOptions Object that defines format options
     * @param formatOptions.format Fiscal format
     * @param formatOptions.calendarType Calendar type
     * @returns Instance of the FiscalFormat
     */
    _exports = FiscalFormat;
    FiscalFormat.getDateInstance = function getDateInstance(formatOptions) {
      return new FiscalFormat(formatOptions);
    };
    var _proto = FiscalFormat.prototype;
    _proto.getPattern = function getPattern() {
      return this.pattern;
    }

    /**
     * Format the raw fiscal data to a locale-dependent format.
     *
     * @param value The parameter containing a raw fiscal value
     * @returns The formatted value
     */;
    _proto.format = function format(value) {
      if (value == null) {
        return "";
      }
      if (typeof value !== "string") {
        return value;
      }
      return value.replace(this.formatRegExPattern, this.formatRegExGroups);
    }

    /**
     * Parse from a locale-dependent format to a raw value.
     *
     * @param value The string containing a parsed fiscal data value
     * @returns The raw value
     */;
    _proto.parse = function parse(value) {
      if (!value) {
        return "";
      }
      return value.replace(this.parseRegExPattern, this.parseRegExReplacer);
    }

    /**
     * Validates the data input.
     *
     * @param value The raw fiscal data
     * @returns If <code>true</code> the validation passes, otherwise <code>false</code>
     */;
    _proto.validate = function validate(value) {
      return this.validationRegExPattern.test(value);
    }

    /**
     * Parse the date pattern string and create a format array from it.
     * Array is used for data parsing and formatting.
     *
     * @param pattern The calendar date pattern string
     * @returns Format array
     */;
    _proto.parseCalendarDatePattern = function parseCalendarDatePattern(pattern) {
      const formatArray = [];
      let char,
        currentObject = {
          digits: 0,
          value: "",
          symbol: ""
        };
      for (const curChar of pattern) {
        if (char !== curChar) {
          currentObject = {
            digits: 0,
            value: "",
            symbol: ""
          };
        } else {
          currentObject.digits += 1;
          continue;
        }
        if (typeof FiscalFormat.symbols[curChar] === "undefined") {
          currentObject.value = curChar;
        } else {
          currentObject.symbol = curChar;
          currentObject.digits = 1;
        }
        char = curChar;
        formatArray.push(currentObject);
      }
      return formatArray;
    }

    /**
     * Creates the formatting regular expression based on the locale-dependent format.
     *
     * @param formatArray An array with the locale-dependent format
     */;
    _proto._setFormatRegex = function _setFormatRegex(formatArray) {
      const regExPattern = [],
        regExGroups = [];
      let part, symbol, regex, year;
      for (let i = 0; i < formatArray.length; i++) {
        part = formatArray[i];
        symbol = part.symbol;
        regex = FiscalFormat.symbols[symbol].format;
        if (symbol === "") {
          regExGroups[i] = part.value;
        } else if (symbol.toLocaleLowerCase() === "y") {
          regExPattern.unshift("(" + regex.source + ")");
          regExGroups[i] = "$" + 1;
        } else {
          regExPattern.push("(" + regex.source + ")");
          year = formatArray.some(function (partEntry) {
            return partEntry.symbol.toLowerCase() === "y";
          });
          regExGroups[i] = year ? "$" + 2 : "$" + 1;
        }
      }
      this.formatRegExPattern = new RegExp(regExPattern.join(""));
      this.formatRegExGroups = regExGroups.join("");
    }

    /**
     * Creates the parsing regular expression based on the locale-dependent format.
     *
     * @param formatArray An array with the locale-dependent format
     */;
    _proto._setParseRegex = function _setParseRegex(formatArray) {
      const regExPattern = [],
        filteredFormat = {};
      let symbol,
        regex,
        currGroup,
        group = 0;
      for (const part of formatArray) {
        symbol = part.symbol;
        if (symbol === "") {
          regExPattern.push("\\D+?");
        } else {
          regex = FiscalFormat.symbols[symbol].parse;
          regExPattern.push("(" + regex.source + ")");
          currGroup = ++group;
          filteredFormat[currGroup] = part;
        }
      }
      this.parseRegExPattern = new RegExp("^" + regExPattern.join("") + "$");
      this.parseRegExReplacer = this.getRegExReplacer(filteredFormat);
    }

    /**
     * Creates a function that is used to replace strings and then performs raw string parsing.
     *
     * @param filteredFormat An array with the locale-dependent format
     * @returns Function that can be passed into the string.replace function
     */;
    _proto.getRegExReplacer = function getRegExReplacer(filteredFormat) {
      return function () {
        const result = [];
        let valuePart, stringGroup;
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }
        for (const key in filteredFormat) {
          valuePart = filteredFormat[key];
          stringGroup = args[parseInt(key, 10)];
          if (stringGroup.length < valuePart.digits) {
            if (valuePart.symbol.toLowerCase() === "y") {
              stringGroup = parseYear(stringGroup);
            } else {
              stringGroup = stringGroup.padStart(valuePart.digits, "0");
            }
          }
          if (valuePart.symbol.toLowerCase() === "y") {
            result.unshift(stringGroup);
          } else {
            result.push(stringGroup);
          }
        }
        return result.join("");
      };
    }

    /**
     * Creates the validation regular expression based on the format.
     *
     * @param formatArray An array with the locale-dependent format
     */;
    _proto._setValidationRegex = function _setValidationRegex(formatArray) {
      const regExPattern = [];
      let symbol, regex;
      for (const part of formatArray) {
        symbol = part.symbol;
        regex = FiscalFormat.symbols[symbol].format;
        if (symbol === "") {
          continue;
        } else if (symbol.toLowerCase() === "y") {
          regExPattern.unshift(regex.source);
        } else {
          regExPattern.push(regex.source);
        }
      }
      this.validationRegExPattern = new RegExp("^(" + regExPattern.join(")(") + ")$");
    }

    /**
     * Regular expression patterns used to format fiscal date strings
     */;
    return FiscalFormat;
  }();
  /**
   * Parses the Year format. This is how the DateFormat parses years, except those years consisting of 3 digits, since currency fiscal dates support only years consisting of 4 digits.
   *
   * @param year Year string
   * @returns Year number
   */
  FiscalFormat.regexFormatPatterns = {
    year: /[1-9]\d{3}/,
    period: /\d{3}/,
    quarter: /[1-4]/,
    week: /0[1-9]|[1-4]\d|5[0-3]/,
    day: /371|370|3[0-6]\d|[1-2]\d{2}|[1-9]\d|[1-9]/
  };
  _exports = FiscalFormat;
  FiscalFormat.regexParsePatterns = {
    year: /\d{1,4}/,
    period: /\d{1,3}/,
    quarter: /[1-4]/,
    week: /\d{1,2}/,
    day: /[1-9]/
  };
  FiscalFormat.symbols = {
    "": {
      format: / /,
      parse: / /
    },
    // "text"
    y: {
      format: FiscalFormat.regexFormatPatterns.year,
      parse: FiscalFormat.regexParsePatterns.year
    },
    // "year"
    Y: {
      format: FiscalFormat.regexFormatPatterns.year,
      parse: FiscalFormat.regexParsePatterns.year
    },
    // "weekYear"
    P: {
      format: FiscalFormat.regexFormatPatterns.period,
      parse: FiscalFormat.regexParsePatterns.period
    },
    // "period"
    W: {
      format: FiscalFormat.regexFormatPatterns.week,
      parse: FiscalFormat.regexParsePatterns.week
    },
    // "weekInYear"
    d: {
      format: FiscalFormat.regexFormatPatterns.day,
      parse: FiscalFormat.regexParsePatterns.day
    },
    // "dayInYear"
    Q: {
      format: FiscalFormat.regexFormatPatterns.quarter,
      parse: FiscalFormat.regexParsePatterns.quarter
    },
    // "quarter"
    q: {
      format: FiscalFormat.regexFormatPatterns.quarter,
      parse: FiscalFormat.regexParsePatterns.quarter
    } //"quarterStandalone"
  };

  function parseYear(year) {
    let parsedYear = Number.parseInt(year, 10);
    const currentYear = new Date().getUTCFullYear(),
      currentCentury = Math.floor(currentYear / 100),
      yearDiff = currentCentury * 100 + parsedYear - currentYear;
    if (year.length === 3) {
      parsedYear += Math.floor((currentCentury - 1) / 10) * 1000;
    } else if (yearDiff < -70) {
      parsedYear += (currentCentury + 1) * 100; // Take next century if "year" is 30 years in the future. Current year 1999 and we enter 28 it will we 2028
    } else if (yearDiff < 30) {
      parsedYear += currentCentury * 100; // Take next century if "year" is 30 years in the future. Current year 2000 and we enter 29 it will we 2029
    } else {
      parsedYear += (currentCentury - 1) * 100; // Any entered "year" that is more than 30 years in the future will be treated as from previous century
    }

    return parsedYear;
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/FiscalFormat", ["sap/ui/core/Locale","sap/ui/core/LocaleData"],function(e,t){"use strict";var r={};let a=function(){function a(r){const a=new e(sap.ui.getCore().getConfiguration().getLanguage()),s=new t(a);let n=r.format;if(r.format.length>4){n="yM"}else if(r.format==="PPP"){n="M"}let o=s.getCustomDateTimePattern(n,r.calendarType);o=o.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi,"");if(r.format.length>4){o=o.replace(/y+/i,r.format.slice(0,r.format.lastIndexOf("Y")+1));o=o.replace(/m+/i,r.format.slice(r.format.lastIndexOf("Y")+1))}else if(r.format==="PPP"){o="PPP"}const i=this.parseCalendarDatePattern(o);this.pattern=i.length>1?o:undefined;this._setFormatRegex(i);this._setParseRegex(i);this._setValidationRegex(i)}r=a;a.getDateInstance=function e(t){return new a(t)};var n=a.prototype;n.getPattern=function e(){return this.pattern};n.format=function e(t){if(t==null){return""}if(typeof t!=="string"){return t}return t.replace(this.formatRegExPattern,this.formatRegExGroups)};n.parse=function e(t){if(!t){return""}return t.replace(this.parseRegExPattern,this.parseRegExReplacer)};n.validate=function e(t){return this.validationRegExPattern.test(t)};n.parseCalendarDatePattern=function e(t){const r=[];let s,n={digits:0,value:"",symbol:""};for(const e of t){if(s!==e){n={digits:0,value:"",symbol:""}}else{n.digits+=1;continue}if(typeof a.symbols[e]==="undefined"){n.value=e}else{n.symbol=e;n.digits=1}s=e;r.push(n)}return r};n._setFormatRegex=function e(t){const r=[],s=[];let n,o,i,f;for(let e=0;e<t.length;e++){n=t[e];o=n.symbol;i=a.symbols[o].format;if(o===""){s[e]=n.value}else if(o.toLocaleLowerCase()==="y"){r.unshift("("+i.source+")");s[e]="$"+1}else{r.push("("+i.source+")");f=t.some(function(e){return e.symbol.toLowerCase()==="y"});s[e]=f?"$"+2:"$"+1}}this.formatRegExPattern=new RegExp(r.join(""));this.formatRegExGroups=s.join("")};n._setParseRegex=function e(t){const r=[],s={};let n,o,i,f=0;for(const e of t){n=e.symbol;if(n===""){r.push("\\D+?")}else{o=a.symbols[n].parse;r.push("("+o.source+")");i=++f;s[i]=e}}this.parseRegExPattern=new RegExp("^"+r.join("")+"$");this.parseRegExReplacer=this.getRegExReplacer(s)};n.getRegExReplacer=function e(t){return function(){const e=[];let r,a;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++){o[i]=arguments[i]}for(const n in t){r=t[n];a=o[parseInt(n,10)];if(a.length<r.digits){if(r.symbol.toLowerCase()==="y"){a=s(a)}else{a=a.padStart(r.digits,"0")}}if(r.symbol.toLowerCase()==="y"){e.unshift(a)}else{e.push(a)}}return e.join("")}};n._setValidationRegex=function e(t){const r=[];let s,n;for(const e of t){s=e.symbol;n=a.symbols[s].format;if(s===""){continue}else if(s.toLowerCase()==="y"){r.unshift(n.source)}else{r.push(n.source)}}this.validationRegExPattern=new RegExp("^("+r.join(")(")+")$")};return a}();a.regexFormatPatterns={year:/[1-9]\d{3}/,period:/\d{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4]\d|5[0-3]/,day:/371|370|3[0-6]\d|[1-2]\d{2}|[1-9]\d|[1-9]/};r=a;a.regexParsePatterns={year:/\d{1,4}/,period:/\d{1,3}/,quarter:/[1-4]/,week:/\d{1,2}/,day:/[1-9]/};a.symbols={"":{format:/ /,parse:/ /},y:{format:a.regexFormatPatterns.year,parse:a.regexParsePatterns.year},Y:{format:a.regexFormatPatterns.year,parse:a.regexParsePatterns.year},P:{format:a.regexFormatPatterns.period,parse:a.regexParsePatterns.period},W:{format:a.regexFormatPatterns.week,parse:a.regexParsePatterns.week},d:{format:a.regexFormatPatterns.day,parse:a.regexParsePatterns.day},Q:{format:a.regexFormatPatterns.quarter,parse:a.regexParsePatterns.quarter},q:{format:a.regexFormatPatterns.quarter,parse:a.regexParsePatterns.quarter}};function s(e){let t=Number.parseInt(e,10);const r=(new Date).getUTCFullYear(),a=Math.floor(r/100),s=a*100+t-r;if(e.length===3){t+=Math.floor((a-1)/10)*1e3}else if(s<-70){t+=(a+1)*100}else if(s<30){t+=a*100}else{t+=(a-1)*100}return t}return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/KPIFormatter-dbg", ["sap/ui/core/Core"], function (Core) {
  "use strict";

  const labelFormat = function (kpiTitle) {
    if (kpiTitle) {
      // Split the title in words
      const titleParts = kpiTitle.split(" ");
      let kpiLabel;
      if (titleParts.length === 1) {
        // Only 1 word --> first 3 capitalized letters of the word
        kpiLabel = titleParts[0].substring(0, 3).toUpperCase();
      } else if (titleParts.length === 2) {
        // 2 words --> first capitalized letters of these two words
        kpiLabel = (titleParts[0].substring(0, 1) + titleParts[1].substring(0, 1)).toUpperCase();
      } else {
        // 3 words or more --> first capitalized letters of the first 3 words
        kpiLabel = (titleParts[0].substring(0, 1) + titleParts[1].substring(0, 1) + titleParts[2].substring(0, 1)).toUpperCase();
      }
      return kpiLabel;
    } else {
      // No KPI title --> no label
      return "";
    }
  };
  labelFormat.__functionName = "sap.fe.core.formatters.KPIFormatter#labelFormat";

  /**
   * KPI tooltip formatting.
   *
   * @param kpiTitle KPI title
   * @param kpiValue KPI value
   * @param kpiUnit KPI unit or currency (can be undefined)
   * @param kpiStatus KPI status
   * @param hasUnit Is "true" if the KPI value has a unit or a currency
   * @returns Returns the text for the KPI tooltip.
   */
  const tooltipFormat = function (kpiTitle, kpiValue, kpiUnit, kpiStatus, hasUnit) {
    const resBundle = Core.getLibraryResourceBundle("sap.fe.core");
    const msgKey = kpiStatus ? `C_KPI_TOOLTIP_${kpiStatus.toUpperCase()}` : "C_KPI_TOOLTIP_NONE";
    let amountWithUnit;
    if (hasUnit === "true") {
      if (!kpiUnit) {
        // No unit means multi-unit situation
        amountWithUnit = resBundle.getText("C_KPI_TOOLTIP_AMOUNT_MULTIUNIT");
      } else {
        amountWithUnit = `${kpiValue} ${kpiUnit}`;
      }
    } else {
      amountWithUnit = kpiValue;
    }
    return resBundle.getText(msgKey, [kpiTitle, amountWithUnit]);
  };
  tooltipFormat.__functionName = "sap.fe.core.formatters.KPIFormatter#tooltipFormat";

  // See https://www.typescriptlang.org/docs/handbook/functions.html#this-parameters for more detail on this weird syntax
  /**
   * Collection of table formatters.
   *
   * @param this The context
   * @param sName The inner function name
   * @param oArgs The inner function parameters
   * @returns The value from the inner function
   */
  const kpiFormatters = function (sName) {
    if (kpiFormatters.hasOwnProperty(sName)) {
      for (var _len = arguments.length, oArgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        oArgs[_key - 1] = arguments[_key];
      }
      return kpiFormatters[sName].apply(this, oArgs);
    } else {
      return "";
    }
  };
  kpiFormatters.labelFormat = labelFormat;
  kpiFormatters.tooltipFormat = tooltipFormat;

  /**
   * @global
   */
  return kpiFormatters;
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/KPIFormatter", ["sap/ui/core/Core"],function(e){"use strict";const t=function(e){if(e){const t=e.split(" ");let r;if(t.length===1){r=t[0].substring(0,3).toUpperCase()}else if(t.length===2){r=(t[0].substring(0,1)+t[1].substring(0,1)).toUpperCase()}else{r=(t[0].substring(0,1)+t[1].substring(0,1)+t[2].substring(0,1)).toUpperCase()}return r}else{return""}};t.__functionName="sap.fe.core.formatters.KPIFormatter#labelFormat";const r=function(t,r,s,n,o){const i=e.getLibraryResourceBundle("sap.fe.core");const a=n?`C_KPI_TOOLTIP_${n.toUpperCase()}`:"C_KPI_TOOLTIP_NONE";let u;if(o==="true"){if(!s){u=i.getText("C_KPI_TOOLTIP_AMOUNT_MULTIUNIT")}else{u=`${r} ${s}`}}else{u=r}return i.getText(a,[t,u])};r.__functionName="sap.fe.core.formatters.KPIFormatter#tooltipFormat";const s=function(e){if(s.hasOwnProperty(e)){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}return s[e].apply(this,r)}else{return""}};s.labelFormat=t;s.tooltipFormat=r;return s},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/StandardFormatter-dbg", ["sap/fe/core/controls/Any", "sap/fe/core/helpers/BindingToolkit"], function (Any, BindingToolkit) {
  "use strict";

  var transformRecursively = BindingToolkit.transformRecursively;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  const evaluateComplexExpression = function (expressionAsString) {
    for (var _len = arguments.length, partsToConcat = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      partsToConcat[_key - 1] = arguments[_key];
    }
    const myExpression = JSON.parse(expressionAsString);
    transformRecursively(myExpression, "PathInModel", pathInModelDef => {
      if (pathInModelDef.modelName === "$") {
        return constant(partsToConcat[parseInt(pathInModelDef.path.substring(1), 10)]);
      }
      return pathInModelDef;
    }, true);
    transformRecursively(myExpression, "ComplexType", complexTypeDef => {
      const compiledExpression = compileExpression(complexTypeDef);
      if (compiledExpression) {
        return constant(getValue(compiledExpression, this));
      }
      return constant(compiledExpression);
    });
    const myCompiledExpression = compileExpression(myExpression);
    return getValue(myCompiledExpression, this);
  };
  const getValue = function (myExpression, target) {
    const myAny = new Any({
      anyText: myExpression
    });
    myAny.setModel(target.getModel());
    myAny.setBindingContext(target.getBindingContext());
    return myAny.getAnyText();
  };
  evaluateComplexExpression.__functionName = "sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression";
  const concat = function () {
    for (var _len2 = arguments.length, partsToConcat = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      partsToConcat[_key2] = arguments[_key2];
    }
    return partsToConcat.join("");
  };
  concat.__functionName = "sap.fe.core.formatters.StandardFormatter#concat";
  const ifElse = function (condition, onTrue, onFalse) {
    return condition ? onTrue : onFalse;
  };
  ifElse.__functionName = "sap.fe.core.formatters.StandardFormatter#ifElse";

  /**
   * Collection of table formatters.
   *
   * @param this The context
   * @param sName The inner function name
   * @param oArgs The inner function parameters
   * @returns The value from the inner function
   */
  const standardFormatter = function (sName) {
    if (standardFormatter.hasOwnProperty(sName)) {
      for (var _len3 = arguments.length, oArgs = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
        oArgs[_key3 - 1] = arguments[_key3];
      }
      return standardFormatter[sName].apply(this, oArgs);
    } else {
      return "";
    }
  };
  standardFormatter.evaluateComplexExpression = evaluateComplexExpression;
  standardFormatter.concat = concat;
  standardFormatter.ifElse = ifElse;

  /**
   * @global
   */
  return standardFormatter;
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/StandardFormatter", ["sap/fe/core/controls/Any","sap/fe/core/helpers/BindingToolkit"],function(e,t){"use strict";var n=t.transformRecursively;var r=t.constant;var o=t.compileExpression;const a=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),i=1;i<t;i++){a[i-1]=arguments[i]}const c=JSON.parse(e);n(c,"PathInModel",e=>{if(e.modelName==="$"){return r(a[parseInt(e.path.substring(1),10)])}return e},true);n(c,"ComplexType",e=>{const t=o(e);if(t){return r(s(t,this))}return r(t)});const u=o(c);return s(u,this)};const s=function(t,n){const r=new e({anyText:t});r.setModel(n.getModel());r.setBindingContext(n.getBindingContext());return r.getAnyText()};a.__functionName="sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression";const i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}return t.join("")};i.__functionName="sap.fe.core.formatters.StandardFormatter#concat";const c=function(e,t,n){return e?t:n};c.__functionName="sap.fe.core.formatters.StandardFormatter#ifElse";const u=function(e){if(u.hasOwnProperty(e)){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++){n[r-1]=arguments[r]}return u[e].apply(this,n)}else{return""}};u.evaluateComplexExpression=a;u.concat=i;u.ifElse=c;return u},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/TableFormatter-dbg", ["sap/fe/core/formatters/TableFormatterTypes", "sap/fe/macros/DelegateUtil", "sap/fe/macros/table/TableSizeHelper", "sap/ui/mdc/enum/EditMode", "../CommonUtils"], function (TableFormatterTypes, DelegateUtil, TableSizeHelper, EditMode, CommonUtils) {
  "use strict";

  var MessageType = TableFormatterTypes.MessageType;
  const getMessagetypeOrder = function (messageType) {
    switch (messageType) {
      case "Error":
        return 4;
      case "Warning":
        return 3;
      case "Information":
        return 2;
      case "None":
        return 1;
      default:
        return -1;
    }
  };

  /**
   * Gets the validity of creation row fields.
   *
   * @function
   * @name validateCreationRowFields
   * @param fieldValidityObject Object holding the fields
   * @returns `true` if all the fields in the creation row are valid, `false` otherwise
   */
  const validateCreationRowFields = function (fieldValidityObject) {
    if (!fieldValidityObject) {
      return false;
    }
    const fieldKeys = Object.keys(fieldValidityObject);
    return fieldKeys.length > 0 && fieldKeys.every(function (key) {
      return fieldValidityObject[key]["validity"];
    });
  };
  validateCreationRowFields.__functionName = "sap.fe.core.formatters.TableFormatter#validateCreationRowFields";

  /**
   * @param this The object status control.
   * @param semanticKeyHasDraftIndicator The property name of the draft indicator.
   * @param aFilteredMessages Array of messages.
   * @param columnName
   * @param isSemanticKeyInFieldGroup Flag which says if semantic key is a part of field group.
   * @returns The value for the visibility property of the object status
   */
  const getErrorStatusTextVisibilityFormatter = function (semanticKeyHasDraftIndicator, aFilteredMessages, columnName, isSemanticKeyInFieldGroup) {
    let bStatusVisibility = false;
    if (aFilteredMessages && aFilteredMessages.length > 0 && (isSemanticKeyInFieldGroup || columnName === semanticKeyHasDraftIndicator)) {
      const sCurrentContextPath = this.getBindingContext() ? this.getBindingContext().getPath() : undefined;
      aFilteredMessages.forEach(oMessage => {
        if (oMessage.type === "Error" && oMessage.aTargets[0].indexOf(sCurrentContextPath) === 0) {
          bStatusVisibility = true;
          return bStatusVisibility;
        }
      });
    }
    return bStatusVisibility;
  };
  getErrorStatusTextVisibilityFormatter.__functionName = "sap.fe.core.formatters.TableFormatter#getErrorStatusTextVisibilityFormatter";

  /**
   * rowHighlighting
   *
   * @param {object} this The context
   * @param {string|number} CriticalityValue The criticality value
   * @param {number} messageLastUpdate Timestamp of the last message that was created. It's defined as an input value, but not used in the body of the function
   * It is used to refresh the formatting of the table each time a new message is updated
   * @returns {object} The value from the inner function
   */

  const rowHighlighting = function (criticalityValue, aFilteredMessages, hasActiveEntity, isActiveEntity, isDraftMode) {
    var _this$getBindingConte2;
    let iHighestCriticalityValue = -1;
    if (aFilteredMessages && aFilteredMessages.length > 0) {
      var _this$getBindingConte;
      const sCurrentContextPath = (_this$getBindingConte = this.getBindingContext()) === null || _this$getBindingConte === void 0 ? void 0 : _this$getBindingConte.getPath();
      aFilteredMessages.forEach(oMessage => {
        if (oMessage.aTargets[0].indexOf(sCurrentContextPath) === 0 && iHighestCriticalityValue < getMessagetypeOrder(oMessage.type)) {
          iHighestCriticalityValue = getMessagetypeOrder(oMessage.type);
          criticalityValue = oMessage.type;
        }
      });
    }
    if (typeof criticalityValue !== "string") {
      switch (criticalityValue) {
        case 1:
          criticalityValue = MessageType.Error;
          break;
        case 2:
          criticalityValue = MessageType.Warning;
          break;
        case 3:
          criticalityValue = MessageType.Success;
          break;
        case 5:
          criticalityValue = MessageType.Information;
          break;
        default:
          criticalityValue = MessageType.None;
      }
    }

    // If we have calculated a criticality <> None, return it
    if (criticalityValue !== MessageType.None) {
      return criticalityValue;
    }

    // If not, we set criticality to 'Information' for newly created rows in Draft mode, and keep 'None' otherwise
    const isInactive = ((_this$getBindingConte2 = this.getBindingContext()) === null || _this$getBindingConte2 === void 0 ? void 0 : _this$getBindingConte2.isInactive()) ?? false;
    const isNewObject = !hasActiveEntity && !isActiveEntity && !isInactive;
    return isDraftMode === "true" && isNewObject ? MessageType.Information : MessageType.None;
  };
  rowHighlighting.__functionName = "sap.fe.core.formatters.TableFormatter#rowHighlighting";
  const navigatedRow = function (sDeepestPath) {
    var _this$getBindingConte3;
    const sPath = (_this$getBindingConte3 = this.getBindingContext()) === null || _this$getBindingConte3 === void 0 ? void 0 : _this$getBindingConte3.getPath();
    if (sPath && sDeepestPath) {
      return sDeepestPath.indexOf(sPath) === 0;
    } else {
      return false;
    }
  };
  navigatedRow.__functionName = "sap.fe.core.formatters.TableFormatter#navigatedRow";

  /**
   * Method to calculate the width of an MDCColumn based on the property definition.
   *
   * @function
   * @name getColumnWidth
   * @param this The MDCColumn object
   * @param editMode The EditMode of the table
   * @param isPropertiesCacheAvailable Indicates if the properties cache is available
   * @param propertyName The name of the property we want to calculate le width
   * @param useRemUnit Indicates if the rem unit must be concatenated with the column width result
   * @returns The width of the column
   * @private
   */
  const getColumnWidth = function (editMode, isPropertiesCacheAvailable, propertyName) {
    let useRemUnit = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
    if (!isPropertiesCacheAvailable) {
      return null;
    }
    const table = this.getParent();
    const properties = DelegateUtil.getCachedProperties(table);
    const property = properties === null || properties === void 0 ? void 0 : properties.find(prop => prop.name === propertyName);
    if (property) {
      let columnWidth = properties ? TableSizeHelper.getMDCColumnWidthFromProperty(property, properties, true) : null;
      if (columnWidth && editMode === EditMode.Editable) {
        var _property$typeConfig;
        switch ((_property$typeConfig = property.typeConfig) === null || _property$typeConfig === void 0 ? void 0 : _property$typeConfig.baseType) {
          case "Date":
            columnWidth += 2;
            break;
          case "Time":
            columnWidth += 2.8;
            break;
          case "DateTime":
            columnWidth += 2;
            break;
          default:
        }
      }
      if (useRemUnit) {
        return columnWidth + "rem";
      }
      return columnWidth;
    }
    return null;
  };
  getColumnWidth.__functionName = "sap.fe.core.formatters.TableFormatter#getColumnWidth";

  /**
   * Method to calculate the width of an MDCColumn for valueHelp the table.
   *
   * @function
   * @name getColumnWidthForValueHelpTable
   * @param this The MDCColumn object
   * @param isPropertiesCacheAvailable Indicates if the properties cache is available
   * @param propertyName The name of the property we want to calculate le width
   * @param isTargetSmallDevice Indicates the current device has a small device
   * @returns The width of the column
   * @private
   */
  const getColumnWidthForValueHelpTable = function (isPropertiesCacheAvailable, propertyName, isTargetSmallDevice) {
    const isSmallDevice = CommonUtils.isSmallDevice();
    const withUnit = !isSmallDevice;
    return isSmallDevice && isTargetSmallDevice || !isSmallDevice && !isTargetSmallDevice ? tableFormatter.getColumnWidth.call(this, EditMode.Display, isPropertiesCacheAvailable, propertyName, withUnit) : null;
  };
  getColumnWidthForValueHelpTable.__functionName = "sap.fe.core.formatters.TableFormatter#getColumnWidthForValueHelpTable";
  function isRatingIndicator(oControl) {
    if (oControl.isA("sap.fe.core.controls.FieldWrapper")) {
      const vContentDisplay = Array.isArray(oControl.getContentDisplay()) ? oControl.getContentDisplay()[0] : oControl.getContentDisplay();
      if (vContentDisplay && vContentDisplay.isA("sap.m.RatingIndicator")) {
        return true;
      }
    }
    return false;
  }
  function _updateStyleClassForRatingIndicator(oFieldWrapper, bLast) {
    const vContentDisplay = Array.isArray(oFieldWrapper.getContentDisplay()) ? oFieldWrapper.getContentDisplay()[0] : oFieldWrapper.getContentDisplay();
    const vContentEdit = Array.isArray(oFieldWrapper.getContentEdit()) ? oFieldWrapper.getContentEdit()[0] : oFieldWrapper.getContentEdit();
    if (bLast) {
      vContentDisplay.addStyleClass("sapUiNoMarginBottom");
      vContentDisplay.addStyleClass("sapUiNoMarginTop");
      vContentEdit.removeStyleClass("sapUiTinyMarginBottom");
    } else {
      vContentDisplay.addStyleClass("sapUiNoMarginBottom");
      vContentDisplay.removeStyleClass("sapUiNoMarginTop");
      vContentEdit.addStyleClass("sapUiTinyMarginBottom");
    }
  }
  function getVBoxVisibility() {
    const aItems = this.getItems();
    let bLastElementFound = false;
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }
    for (let index = aItems.length - 1; index >= 0; index--) {
      if (!bLastElementFound) {
        if (args[index] !== true) {
          bLastElementFound = true;
          if (isRatingIndicator(aItems[index])) {
            _updateStyleClassForRatingIndicator(aItems[index], true);
          } else {
            aItems[index].removeStyleClass("sapUiTinyMarginBottom");
          }
        }
      } else if (isRatingIndicator(aItems[index])) {
        _updateStyleClassForRatingIndicator(aItems[index], false);
      } else {
        aItems[index].addStyleClass("sapUiTinyMarginBottom");
      }
    }
    return true;
  }
  getVBoxVisibility.__functionName = "sap.fe.core.formatters.TableFormatter#getVBoxVisibility";

  // See https://www.typescriptlang.org/docs/handbook/functions.html#this-parameters for more detail on this weird syntax
  /**
   * Collection of table formatters.
   *
   * @param this The context
   * @param sName The inner function name
   * @param oArgs The inner function parameters
   * @returns The value from the inner function
   */
  const tableFormatter = function (sName) {
    if (tableFormatter.hasOwnProperty(sName)) {
      for (var _len2 = arguments.length, oArgs = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
        oArgs[_key2 - 1] = arguments[_key2];
      }
      return tableFormatter[sName].apply(this, oArgs);
    } else {
      return "";
    }
  };
  tableFormatter.validateCreationRowFields = validateCreationRowFields;
  tableFormatter.rowHighlighting = rowHighlighting;
  tableFormatter.navigatedRow = navigatedRow;
  tableFormatter.getErrorStatusTextVisibilityFormatter = getErrorStatusTextVisibilityFormatter;
  tableFormatter.getVBoxVisibility = getVBoxVisibility;
  tableFormatter.isRatingIndicator = isRatingIndicator; // for unit tests
  tableFormatter.getColumnWidth = getColumnWidth;
  tableFormatter.getColumnWidthForValueHelpTable = getColumnWidthForValueHelpTable;

  /**
   * @global
   */
  return tableFormatter;
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/TableFormatter", ["sap/fe/core/formatters/TableFormatterTypes","sap/fe/macros/DelegateUtil","sap/fe/macros/table/TableSizeHelper","sap/ui/mdc/enum/EditMode","../CommonUtils"],function(t,e,n,r,a){"use strict";var i=t.MessageType;const o=function(t){switch(t){case"Error":return 4;case"Warning":return 3;case"Information":return 2;case"None":return 1;default:return-1}};const s=function(t){if(!t){return false}const e=Object.keys(t);return e.length>0&&e.every(function(e){return t[e]["validity"]})};s.__functionName="sap.fe.core.formatters.TableFormatter#validateCreationRowFields";const l=function(t,e,n,r){let a=false;if(e&&e.length>0&&(r||n===t)){const t=this.getBindingContext()?this.getBindingContext().getPath():undefined;e.forEach(e=>{if(e.type==="Error"&&e.aTargets[0].indexOf(t)===0){a=true;return a}})}return a};l.__functionName="sap.fe.core.formatters.TableFormatter#getErrorStatusTextVisibilityFormatter";const f=function(t,e,n,r,a){var s;let l=-1;if(e&&e.length>0){var f;const n=(f=this.getBindingContext())===null||f===void 0?void 0:f.getPath();e.forEach(e=>{if(e.aTargets[0].indexOf(n)===0&&l<o(e.type)){l=o(e.type);t=e.type}})}if(typeof t!=="string"){switch(t){case 1:t=i.Error;break;case 2:t=i.Warning;break;case 3:t=i.Success;break;case 5:t=i.Information;break;default:t=i.None}}if(t!==i.None){return t}const u=((s=this.getBindingContext())===null||s===void 0?void 0:s.isInactive())??false;const c=!n&&!r&&!u;return a==="true"&&c?i.Information:i.None};f.__functionName="sap.fe.core.formatters.TableFormatter#rowHighlighting";const u=function(t){var e;const n=(e=this.getBindingContext())===null||e===void 0?void 0:e.getPath();if(n&&t){return t.indexOf(n)===0}else{return false}};u.__functionName="sap.fe.core.formatters.TableFormatter#navigatedRow";const c=function(t,a,i){let o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(!a){return null}const s=this.getParent();const l=e.getCachedProperties(s);const f=l===null||l===void 0?void 0:l.find(t=>t.name===i);if(f){let e=l?n.getMDCColumnWidthFromProperty(f,l,true):null;if(e&&t===r.Editable){var u;switch((u=f.typeConfig)===null||u===void 0?void 0:u.baseType){case"Date":e+=2;break;case"Time":e+=2.8;break;case"DateTime":e+=2;break;default:}}if(o){return e+"rem"}return e}return null};c.__functionName="sap.fe.core.formatters.TableFormatter#getColumnWidth";const g=function(t,e,n){const i=a.isSmallDevice();const o=!i;return i&&n||!i&&!n?y.getColumnWidth.call(this,r.Display,t,e,o):null};g.__functionName="sap.fe.core.formatters.TableFormatter#getColumnWidthForValueHelpTable";function d(t){if(t.isA("sap.fe.core.controls.FieldWrapper")){const e=Array.isArray(t.getContentDisplay())?t.getContentDisplay()[0]:t.getContentDisplay();if(e&&e.isA("sap.m.RatingIndicator")){return true}}return false}function m(t,e){const n=Array.isArray(t.getContentDisplay())?t.getContentDisplay()[0]:t.getContentDisplay();const r=Array.isArray(t.getContentEdit())?t.getContentEdit()[0]:t.getContentEdit();if(e){n.addStyleClass("sapUiNoMarginBottom");n.addStyleClass("sapUiNoMarginTop");r.removeStyleClass("sapUiTinyMarginBottom")}else{n.addStyleClass("sapUiNoMarginBottom");n.removeStyleClass("sapUiNoMarginTop");r.addStyleClass("sapUiTinyMarginBottom")}}function p(){const t=this.getItems();let e=false;for(var n=arguments.length,r=new Array(n),a=0;a<n;a++){r[a]=arguments[a]}for(let n=t.length-1;n>=0;n--){if(!e){if(r[n]!==true){e=true;if(d(t[n])){m(t[n],true)}else{t[n].removeStyleClass("sapUiTinyMarginBottom")}}}else if(d(t[n])){m(t[n],false)}else{t[n].addStyleClass("sapUiTinyMarginBottom")}}return true}p.__functionName="sap.fe.core.formatters.TableFormatter#getVBoxVisibility";const y=function(t){if(y.hasOwnProperty(t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++){n[r-1]=arguments[r]}return y[t].apply(this,n)}else{return""}};y.validateCreationRowFields=s;y.rowHighlighting=f;y.navigatedRow=u;y.getErrorStatusTextVisibilityFormatter=l;y.getVBoxVisibility=p;y.isRatingIndicator=d;y.getColumnWidth=c;y.getColumnWidthForValueHelpTable=g;return y},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/TableFormatterTypes-dbg", [], function () {
  "use strict";

  var _exports = {};
  let MessageType;
  (function (MessageType) {
    MessageType["Error"] = "Error";
    MessageType["Information"] = "Information";
    MessageType["None"] = "None";
    MessageType["Success"] = "Success";
    MessageType["Warning"] = "Warning";
  })(MessageType || (MessageType = {}));
  _exports.MessageType = MessageType;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/TableFormatterTypes", [],function(){"use strict";var n={};let r;(function(n){n["Error"]="Error";n["Information"]="Information";n["None"]="None";n["Success"]="Success";n["Warning"]="Warning"})(r||(r={}));n.MessageType=r;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/ValueFormatter-dbg", ["sap/base/strings/whitespaceReplacer", "sap/ui/core/Core", "sap/ui/core/format/DateFormat"], function (whitespaceReplacer, Core, DateFormat) {
  "use strict";

  var _exports = {};
  /**
   * Collection of table formatters.
   *
   * @param this The context
   * @param sName The inner function name
   * @param oArgs The inner function parameters
   * @returns The value from the inner function
   */
  const valueFormatters = function (sName) {
    if (valueFormatters.hasOwnProperty(sName)) {
      for (var _len = arguments.length, oArgs = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        oArgs[_key - 1] = arguments[_key];
      }
      return valueFormatters[sName].apply(this, oArgs);
    } else {
      return "";
    }
  };
  const formatWithBrackets = (firstPart, secondPart) => {
    if (firstPart && secondPart) {
      return Core.getLibraryResourceBundle("sap.fe.core").getText("C_FORMAT_FOR_TEXT_ARRANGEMENT", [firstPart, secondPart]);
    } else {
      return firstPart || secondPart || "";
    }
  };
  formatWithBrackets.__functionName = "sap.fe.core.formatters.ValueFormatter#formatWithBrackets";
  const formatOPTitle = (resource_NEW_OBJECT, resource_NO_HEADER_INFO, hasActiveEntity, isActiveEntity, firstPart, secondPart) => {
    let result = secondPart ? formatWithBrackets(firstPart, secondPart) : whitespaceReplacer(firstPart);
    if (!result) {
      const newObjectResource = resource_NEW_OBJECT ? resource_NEW_OBJECT : Core.getLibraryResourceBundle("sap.fe.templates").getText("T_NEW_OBJECT");
      const noHeaderInfoResource = resource_NO_HEADER_INFO ? resource_NO_HEADER_INFO : Core.getLibraryResourceBundle("sap.fe.templates").getText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE_NO_HEADER_INFO");
      result = !isActiveEntity && !hasActiveEntity ? newObjectResource : noHeaderInfoResource;
    }
    return result;
  };
  formatOPTitle.__functionName = "sap.fe.core.formatters.ValueFormatter#formatOPTitle";
  const formatWithPercentage = sValue => {
    return sValue !== null && sValue !== undefined ? `${sValue} %` : "";
  };
  formatWithPercentage.__functionName = "sap.fe.core.formatters.ValueFormatter#formatWithPercentage";
  const computePercentage = (value, target, sUnit) => {
    let sPercentString;
    const iValue = typeof value === "string" ? parseFloat(value) : value;
    const iTarget = typeof target === "string" ? parseFloat(target) : target;
    if (sUnit === "%") {
      if (iValue > 100) {
        sPercentString = "100";
      } else if (iValue <= 0) {
        sPercentString = "0";
      } else {
        sPercentString = typeof value === "string" ? value : value === null || value === void 0 ? void 0 : value.toString();
      }
    } else if (iValue > iTarget) {
      sPercentString = "100";
    } else if (iValue <= 0) {
      sPercentString = "0";
    } else {
      sPercentString = iValue && iTarget ? (iValue / iTarget * 100).toString() : "0";
    }
    return sPercentString;
  };
  computePercentage.__functionName = "sap.fe.core.formatters.ValueFormatter#computePercentage";
  const formatCriticalityIcon = val => {
    let sIcon;
    if (val === "UI.CriticalityType/Negative" || val === "1" || val === 1) {
      sIcon = "sap-icon://message-error";
    } else if (val === "UI.CriticalityType/Critical" || val === "2" || val === 2) {
      sIcon = "sap-icon://message-warning";
    } else if (val === "UI.CriticalityType/Positive" || val === "3" || val === 3) {
      sIcon = "sap-icon://message-success";
    } else if (val === "UI.CriticalityType/Information" || val === "5" || val === 5) {
      sIcon = "sap-icon://message-information";
    } else {
      sIcon = "";
    }
    return sIcon;
  };
  formatCriticalityIcon.__functionName = "sap.fe.core.formatters.ValueFormatter#formatCriticalityIcon";
  _exports.formatCriticalityIcon = formatCriticalityIcon;
  const formatCriticalityValueState = val => {
    let sValueState;
    if (val === "UI.CriticalityType/Negative" || val === "1" || val === 1) {
      sValueState = "Error";
    } else if (val === "UI.CriticalityType/Critical" || val === "2" || val === 2) {
      sValueState = "Warning";
    } else if (val === "UI.CriticalityType/Positive" || val === "3" || val === 3) {
      sValueState = "Success";
    } else if (val === "UI.CriticalityType/Information" || val === "5" || val === 5) {
      sValueState = "Information";
    } else {
      sValueState = "None";
    }
    return sValueState;
  };
  formatCriticalityValueState.__functionName = "sap.fe.core.formatters.ValueFormatter#formatCriticalityValueState";
  _exports.formatCriticalityValueState = formatCriticalityValueState;
  const formatCriticalityButtonType = val => {
    let sType;
    if (val === "UI.CriticalityType/Negative" || val === "1" || val === 1) {
      sType = "Reject";
    } else if (val === "UI.CriticalityType/Positive" || val === "3" || val === 3) {
      sType = "Accept";
    } else {
      sType = "Default";
    }
    return sType;
  };
  formatCriticalityButtonType.__functionName = "sap.fe.core.formatters.ValueFormatter#formatCriticalityButtonType";
  _exports.formatCriticalityButtonType = formatCriticalityButtonType;
  const formatCriticalityColorMicroChart = val => {
    let sColor;
    if (val === "UI.CriticalityType/Negative" || val === "1" || val === 1) {
      sColor = "Error";
    } else if (val === "UI.CriticalityType/Critical" || val === "2" || val === 2) {
      sColor = "Critical";
    } else if (val === "UI.CriticalityType/Positive" || val === "3" || val === 3) {
      sColor = "Good";
    } else {
      sColor = "Neutral";
    }
    return sColor;
  };
  formatCriticalityColorMicroChart.__functionName = "sap.fe.core.formatters.ValueFormatter#formatCriticalityColorMicroChart";
  _exports.formatCriticalityColorMicroChart = formatCriticalityColorMicroChart;
  const formatProgressIndicatorText = (value, target, unit) => {
    if (value && target && unit) {
      var _localeData$dateField, _localeData$units, _localeData$units$sho;
      const unitSplit = unit.split("-");
      const searchUnit = `${unitSplit[1] === undefined ? unit : unitSplit[1]}-narrow`;
      const dateFormat = DateFormat.getDateInstance();
      const localeData = dateFormat.oLocaleData.mData;
      const oResourceModel = Core.getLibraryResourceBundle("sap.fe.macros");
      let unitDisplayed = unit;
      if (localeData !== null && localeData !== void 0 && (_localeData$dateField = localeData.dateFields[searchUnit]) !== null && _localeData$dateField !== void 0 && _localeData$dateField.displayName) {
        unitDisplayed = localeData.dateFields[searchUnit].displayName;
      } else if (localeData !== null && localeData !== void 0 && (_localeData$units = localeData.units) !== null && _localeData$units !== void 0 && (_localeData$units$sho = _localeData$units.short[unit]) !== null && _localeData$units$sho !== void 0 && _localeData$units$sho.displayName) {
        unitDisplayed = localeData.units.short[unit].displayName;
      }
      return oResourceModel.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_WITH_UOM", [value, target, unitDisplayed]);
    }
  };
  formatProgressIndicatorText.__functionName = "sap.fe.core.formatters.ValueFormatter#formatProgressIndicatorText";
  _exports.formatProgressIndicatorText = formatProgressIndicatorText;
  const formatToKeepWhitespace = value => {
    return value === null || value === undefined ? "" : whitespaceReplacer(value + "");
  };
  formatToKeepWhitespace.__functionName = "sap.fe.core.formatters.ValueFormatter#formatToKeepWhitespace";
  _exports.formatToKeepWhitespace = formatToKeepWhitespace;
  valueFormatters.formatWithBrackets = formatWithBrackets;
  valueFormatters.formatOPTitle = formatOPTitle;
  valueFormatters.formatWithPercentage = formatWithPercentage;
  valueFormatters.computePercentage = computePercentage;
  valueFormatters.formatCriticalityIcon = formatCriticalityIcon;
  valueFormatters.formatCriticalityValueState = formatCriticalityValueState;
  valueFormatters.formatCriticalityButtonType = formatCriticalityButtonType;
  valueFormatters.formatCriticalityColorMicroChart = formatCriticalityColorMicroChart;
  valueFormatters.formatProgressIndicatorText = formatProgressIndicatorText;
  valueFormatters.formatToKeepWhitespace = formatToKeepWhitespace;
  /**
   * @global
   */
  return valueFormatters;
}, true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/formatters/ValueFormatter", ["sap/base/strings/whitespaceReplacer","sap/ui/core/Core","sap/ui/core/format/DateFormat"],function(e,t,r){"use strict";var a={};const i=function(e){if(i.hasOwnProperty(e)){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++){r[a-1]=arguments[a]}return i[e].apply(this,r)}else{return""}};const o=(e,r)=>{if(e&&r){return t.getLibraryResourceBundle("sap.fe.core").getText("C_FORMAT_FOR_TEXT_ARRANGEMENT",[e,r])}else{return e||r||""}};o.__functionName="sap.fe.core.formatters.ValueFormatter#formatWithBrackets";const s=(r,a,i,s,n,c)=>{let l=c?o(n,c):e(n);if(!l){const e=r?r:t.getLibraryResourceBundle("sap.fe.templates").getText("T_NEW_OBJECT");const o=a?a:t.getLibraryResourceBundle("sap.fe.templates").getText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE_NO_HEADER_INFO");l=!s&&!i?e:o}return l};s.__functionName="sap.fe.core.formatters.ValueFormatter#formatOPTitle";const n=e=>e!==null&&e!==undefined?`${e} %`:"";n.__functionName="sap.fe.core.formatters.ValueFormatter#formatWithPercentage";const c=(e,t,r)=>{let a;const i=typeof e==="string"?parseFloat(e):e;const o=typeof t==="string"?parseFloat(t):t;if(r==="%"){if(i>100){a="100"}else if(i<=0){a="0"}else{a=typeof e==="string"?e:e===null||e===void 0?void 0:e.toString()}}else if(i>o){a="100"}else if(i<=0){a="0"}else{a=i&&o?(i/o*100).toString():"0"}return a};c.__functionName="sap.fe.core.formatters.ValueFormatter#computePercentage";const l=e=>{let t;if(e==="UI.CriticalityType/Negative"||e==="1"||e===1){t="sap-icon://message-error"}else if(e==="UI.CriticalityType/Critical"||e==="2"||e===2){t="sap-icon://message-warning"}else if(e==="UI.CriticalityType/Positive"||e==="3"||e===3){t="sap-icon://message-success"}else if(e==="UI.CriticalityType/Information"||e==="5"||e===5){t="sap-icon://message-information"}else{t=""}return t};l.__functionName="sap.fe.core.formatters.ValueFormatter#formatCriticalityIcon";a.formatCriticalityIcon=l;const f=e=>{let t;if(e==="UI.CriticalityType/Negative"||e==="1"||e===1){t="Error"}else if(e==="UI.CriticalityType/Critical"||e==="2"||e===2){t="Warning"}else if(e==="UI.CriticalityType/Positive"||e==="3"||e===3){t="Success"}else if(e==="UI.CriticalityType/Information"||e==="5"||e===5){t="Information"}else{t="None"}return t};f.__functionName="sap.fe.core.formatters.ValueFormatter#formatCriticalityValueState";a.formatCriticalityValueState=f;const m=e=>{let t;if(e==="UI.CriticalityType/Negative"||e==="1"||e===1){t="Reject"}else if(e==="UI.CriticalityType/Positive"||e==="3"||e===3){t="Accept"}else{t="Default"}return t};m.__functionName="sap.fe.core.formatters.ValueFormatter#formatCriticalityButtonType";a.formatCriticalityButtonType=m;const u=e=>{let t;if(e==="UI.CriticalityType/Negative"||e==="1"||e===1){t="Error"}else if(e==="UI.CriticalityType/Critical"||e==="2"||e===2){t="Critical"}else if(e==="UI.CriticalityType/Positive"||e==="3"||e===3){t="Good"}else{t="Neutral"}return t};u.__functionName="sap.fe.core.formatters.ValueFormatter#formatCriticalityColorMicroChart";a.formatCriticalityColorMicroChart=u;const p=(e,a,i)=>{if(e&&a&&i){var o,s,n;const c=i.split("-");const l=`${c[1]===undefined?i:c[1]}-narrow`;const f=r.getDateInstance();const m=f.oLocaleData.mData;const u=t.getLibraryResourceBundle("sap.fe.macros");let p=i;if(m!==null&&m!==void 0&&(o=m.dateFields[l])!==null&&o!==void 0&&o.displayName){p=m.dateFields[l].displayName}else if(m!==null&&m!==void 0&&(s=m.units)!==null&&s!==void 0&&(n=s.short[i])!==null&&n!==void 0&&n.displayName){p=m.units.short[i].displayName}return u.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_WITH_UOM",[e,a,p])}};p.__functionName="sap.fe.core.formatters.ValueFormatter#formatProgressIndicatorText";a.formatProgressIndicatorText=p;const y=t=>t===null||t===undefined?"":e(t+"");y.__functionName="sap.fe.core.formatters.ValueFormatter#formatToKeepWhitespace";a.formatToKeepWhitespace=y;i.formatWithBrackets=o;i.formatOPTitle=s;i.formatWithPercentage=n;i.computePercentage=c;i.formatCriticalityIcon=l;i.formatCriticalityValueState=f;i.formatCriticalityButtonType=m;i.formatCriticalityColorMicroChart=u;i.formatProgressIndicatorText=p;i.formatToKeepWhitespace=y;return i},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/fpm/Component-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/fe/core/TemplateComponent"], function (ClassSupport, TemplateComponent) {
  "use strict";

  var _dec, _dec2, _dec3, _dec4, _class, _class2, _descriptor, _descriptor2, _descriptor3;
  var property = ClassSupport.property;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  /**
   * Component that can be used as a wrapper component for custom pages.
   *
   * The component can be used in case you want to use SAP Fiori elements Building Blocks or XML template
   * constructions. You can either extend the component and set the viewName and contextPath within your code
   * or you can use it to wrap your custom XML view directly the manifest when you define your custom page
   * under sapui5/routing/targets:
   *
   * <pre>
   * "myCustomPage": {
   *	"type": "Component",
   *	"id": "myCustomPage",
   *	"name": "sap.fe.core.fpm",
   *	"title": "My Custom Page",
   *	"options": {
   *		"settings": {
   *			"viewName": "myNamespace.myView",
   *			"contextPath": "/MyEntitySet"
   *			}
   *		}
   *	}
   * </pre>
   *
   * @name sap.fe.core.fpm.Component
   * @public
   * @experimental As of version 1.92.0
   * @since 1.92.0
   */
  let FPMComponent = (_dec = defineUI5Class("sap.fe.core.fpm.Component", {
    manifest: "json"
  }), _dec2 = property({
    type: "string"
  }), _dec3 = property({
    type: "string"
  }), _dec4 = property({
    type: "string"
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_TemplateComponent) {
    _inheritsLoose(FPMComponent, _TemplateComponent);
    /**
     * Name of the XML view which is used for this page. The XML view can contain SAP Fiori elements Building Blocks and XML template constructions.
     *
     * @public
     */

    function FPMComponent(mSettings) {
      var _this;
      if (mSettings.viewType === "JSX") {
        mSettings._mdxViewName = mSettings.viewName;
        mSettings.viewName = "module:sap/fe/core/jsx-runtime/ViewLoader";
      }
      _this = _TemplateComponent.call(this, mSettings) || this;
      _initializerDefineProperty(_this, "viewName", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "controllerName", _descriptor2, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "_mdxViewName", _descriptor3, _assertThisInitialized(_this));
      return _this;
    }
    return FPMComponent;
  }(TemplateComponent), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "viewName", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "controllerName", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "_mdxViewName", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function () {
      return "";
    }
  })), _class2)) || _class);
  return FPMComponent;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/fpm/Component", ["sap/fe/core/helpers/ClassSupport","sap/fe/core/TemplateComponent"],function(e,r){"use strict";var i,t,n,a,o,l,u,c,f;var s=e.property;var p=e.defineUI5Class;function b(e,r,i,t){if(!i)return;Object.defineProperty(e,r,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(t):void 0})}function m(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function d(e,r){e.prototype=Object.create(r.prototype);e.prototype.constructor=e;v(e,r)}function v(e,r){v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(r,i){r.__proto__=i;return r};return v(e,r)}function w(e,r,i,t,n){var a={};Object.keys(t).forEach(function(e){a[e]=t[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=i.slice().reverse().reduce(function(i,t){return t(e,r,i)||i},a);if(n&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(n):void 0;a.initializer=undefined}if(a.initializer===void 0){Object.defineProperty(e,r,a);a=null}return a}function y(e,r){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let g=(i=p("sap.fe.core.fpm.Component",{manifest:"json"}),t=s({type:"string"}),n=s({type:"string"}),a=s({type:"string"}),i(o=(l=function(e){d(r,e);function r(r){var i;if(r.viewType==="JSX"){r._mdxViewName=r.viewName;r.viewName="module:sap/fe/core/jsx-runtime/ViewLoader"}i=e.call(this,r)||this;b(i,"viewName",u,m(i));b(i,"controllerName",c,m(i));b(i,"_mdxViewName",f,m(i));return i}return r}(r),u=w(l.prototype,"viewName",[t],{configurable:true,enumerable:true,writable:true,initializer:null}),c=w(l.prototype,"controllerName",[n],{configurable:true,enumerable:true,writable:true,initializer:null}),f=w(l.prototype,"_mdxViewName",[a],{configurable:true,enumerable:true,writable:true,initializer:function(){return""}}),l))||o);return g},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/AnnotationEnum-dbg", [], function () {
  "use strict";

  var _exports = {};
  // This list needs to come from AVT
  const ENUM_VALUES = {
    "com.sap.vocabularies.Common.v1.FieldControlType": {
      Mandatory: 7,
      Optional: 3,
      ReadOnly: 0,
      Inapplicable: 0,
      Disabled: 1
    }
  };
  const resolveEnumValue = function (enumName) {
    const [termName, value] = enumName.split("/");
    if (ENUM_VALUES.hasOwnProperty(termName)) {
      return ENUM_VALUES[termName][value];
    } else {
      return false;
    }
  };
  _exports.resolveEnumValue = resolveEnumValue;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/AnnotationEnum", [],function(){"use strict";var e={};const n={"com.sap.vocabularies.Common.v1.FieldControlType":{Mandatory:7,Optional:3,ReadOnly:0,Inapplicable:0,Disabled:1}};const a=function(e){const[a,o]=e.split("/");if(n.hasOwnProperty(a)){return n[a][o]}else{return false}};e.resolveEnumValue=a;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/AppStartupHelper-dbg", ["sap/ui/model/Filter", "sap/ui/model/FilterOperator", "./ModelHelper"], function (Filter, FilterOperator, ModelHelper) {
  "use strict";

  const AppStartupHelper = {
    /**
     * Retrieves a set of key values from startup parameters.
     *
     * @param aKeyNames The array of key names
     * @param oStartupParameters The startup parameters
     * @returns An array of pairs \{name, value\} if all key values could be found in the startup parameters, undefined otherwise
     */
    _getKeysFromStartupParams: function (aKeyNames, oStartupParameters) {
      let bAllFound = true;
      const aKeys = aKeyNames.map(name => {
        if (oStartupParameters[name] && oStartupParameters[name].length === 1) {
          return {
            name,
            value: oStartupParameters[name][0]
          };
        } else {
          // A unique key value couldn't be found in the startup parameters
          bAllFound = false;
          return {
            name,
            value: ""
          };
        }
      });
      return bAllFound ? aKeys : undefined;
    },
    /**
     * Creates a filter from a list of key values.
     *
     * @param aKeys Array of semantic keys or technical keys (with values)
     * @param bDraftMode True if the entity supports draft mode
     * @param oMetaModel The metamodel
     * @returns The filter
     */
    _createFilterFromKeys: function (aKeys, bDraftMode, oMetaModel) {
      const bFilterCaseSensitive = ModelHelper.isFilteringCaseSensitive(oMetaModel);
      let bFilterOnActiveEntity = false;
      const aFilters = aKeys.map(key => {
        if (key.name === "IsActiveEntity") {
          bFilterOnActiveEntity = true;
        }
        return new Filter({
          path: key.name,
          operator: FilterOperator.EQ,
          value1: key.value,
          caseSensitive: bFilterCaseSensitive
        });
      });
      if (bDraftMode && !bFilterOnActiveEntity) {
        const oDraftFilter = new Filter({
          filters: [new Filter("IsActiveEntity", "EQ", false), new Filter("SiblingEntity/IsActiveEntity", "EQ", null)],
          and: false
        });
        aFilters.push(oDraftFilter);
      }
      return new Filter(aFilters, true);
    },
    /**
     * Loads all contexts for a list of page infos.
     *
     * @param aStartupPages The list of page infos
     * @param oModel The model used to load the contexts
     * @returns A Promise for all contexts
     */
    _requestObjectsFromParameters: function (aStartupPages, oModel) {
      // Load the respective objects for all object pages found in aExternallyNavigablePages
      const aContextPromises = aStartupPages.map(pageInfo => {
        const aKeys = pageInfo.semanticKeys || pageInfo.technicalKeys || [];
        const oFilter = this._createFilterFromKeys(aKeys, pageInfo.draftMode, oModel.getMetaModel());

        // only request a minimum of fields to boost backend performance since this is only used to check if an object exists
        const oListBind = oModel.bindList(pageInfo.contextPath, undefined, undefined, oFilter, {
          $select: aKeys.map(key => {
            return key.name;
          }).join(",")
        });
        return oListBind.requestContexts(0, 2);
      });
      return Promise.all(aContextPromises);
    },
    /**
     * Creates a PageInfo from a route if it's reachable from the startup parameters.
     *
     * @param oRoute The route
     * @param oManifestRouting The app manifest routing section
     * @param oStartupParameters The startup parameters
     * @param oMetaModel The app metamodel
     * @returns A page info if the page is reachable, undefined otherwise
     */
    _getReachablePageInfoFromRoute: function (oRoute, oManifestRouting, oStartupParameters, oMetaModel) {
      var _oTarget$options, _oTarget$options$sett;
      // Remove trailing ':?query:' and '/'
      let sPattern = oRoute.pattern.replace(":?query:", "");
      sPattern = sPattern.replace(/\/$/, "");
      if (!sPattern || !sPattern.endsWith(")")) {
        // Ignore level-0 routes (ListReport) or routes corresponding to a 1-1 relation (no keys in the URL in this case)
        return undefined;
      }
      sPattern = sPattern.replace(/\(\{[^\}]*\}\)/g, "(#)"); // Replace keys with #

      // Get the rightmost target for this route
      const sTargetName = Array.isArray(oRoute.target) ? oRoute.target[oRoute.target.length - 1] : oRoute.target;
      const oTarget = oManifestRouting.targets[sTargetName];
      const aPatternSegments = sPattern.split("/");
      const pageLevel = aPatternSegments.length - 1;
      if (pageLevel !== 0 && (oTarget === null || oTarget === void 0 ? void 0 : (_oTarget$options = oTarget.options) === null || _oTarget$options === void 0 ? void 0 : (_oTarget$options$sett = _oTarget$options.settings) === null || _oTarget$options$sett === void 0 ? void 0 : _oTarget$options$sett.allowDeepLinking) !== true) {
        // The first level of object page allows deep linking by default.
        // Otherwise, the target must allow deep linking explicitely in the manifest
        return undefined;
      }
      const sContextPath = oTarget.options.settings.contextPath || oTarget.options.settings.entitySet && `/${oTarget.options.settings.entitySet}`;
      const oEntityType = sContextPath && oMetaModel.getObject(`/$EntityContainer${sContextPath}/`);
      if (!oEntityType) {
        return undefined;
      }

      // Get the semantic key values for the entity
      const aSemanticKeyNames = oMetaModel.getObject(`/$EntityContainer${sContextPath}/@com.sap.vocabularies.Common.v1.SemanticKey`);
      const aSemantickKeys = aSemanticKeyNames ? this._getKeysFromStartupParams(aSemanticKeyNames.map(semKey => {
        return semKey.$PropertyPath;
      }), oStartupParameters) : undefined;

      // Get the technical keys only if we couldn't find the semantic key values, and on first level OP
      const aTechnicalKeys = !aSemantickKeys && pageLevel === 0 ? this._getKeysFromStartupParams(oEntityType["$Key"], oStartupParameters) : undefined;
      if (aSemantickKeys === undefined && aTechnicalKeys === undefined) {
        // We couldn't find the semantic/technical keys in the startup parameters
        return undefined;
      }

      // The startup parameters contain values for all semantic keys (or technical keys) --> we can store the page info in the corresponding level
      const draftMode = oMetaModel.getObject(`/$EntityContainer${sContextPath}@com.sap.vocabularies.Common.v1.DraftRoot`) || oMetaModel.getObject(`/$EntityContainer${sContextPath}@com.sap.vocabularies.Common.v1.DraftNode`) ? true : false;
      return {
        pattern: sPattern,
        contextPath: sContextPath,
        draftMode,
        technicalKeys: aTechnicalKeys,
        semanticKeys: aSemantickKeys,
        target: sTargetName,
        pageLevel
      };
    },
    /**
     * Returns the list of all pages that allow deeplink and that can be reached using the startup parameters.
     *
     * @param oManifestRouting The routing information from the app manifest
     * @param oStartupParameters The startup parameters
     * @param oMetaModel The metamodel
     * @returns The reachable pages
     */
    _getReachablePages: function (oManifestRouting, oStartupParameters, oMetaModel) {
      const aRoutes = oManifestRouting.routes;
      const mPagesByLevel = {};
      aRoutes.forEach(oRoute => {
        const oPageInfo = this._getReachablePageInfoFromRoute(oRoute, oManifestRouting, oStartupParameters, oMetaModel);
        if (oPageInfo) {
          if (!mPagesByLevel[oPageInfo.pageLevel]) {
            mPagesByLevel[oPageInfo.pageLevel] = [];
          }
          mPagesByLevel[oPageInfo.pageLevel].push(oPageInfo);
        }
      });

      // A page is reachable only if all its parents are also reachable
      // So if we couldn't find any pages for a given level, all pages with a higher level won't be reachable anyway
      const aReachablePages = [];
      let level = 0;
      while (mPagesByLevel[level]) {
        aReachablePages.push(mPagesByLevel[level]);
        level++;
      }
      return aReachablePages;
    },
    /**
     * Get the list of startup pages.
     *
     * @param oManifestRouting The routing information from the app manifest
     * @param oStartupParameters The startup parameters
     * @param oMetaModel The metamodel
     * @returns An array of startup page infos
     */
    _getStartupPagesFromStartupParams: function (oManifestRouting, oStartupParameters, oMetaModel) {
      // Find all pages that can be reached with the startup parameters
      const aReachablePages = this._getReachablePages(oManifestRouting, oStartupParameters, oMetaModel);
      if (aReachablePages.length === 0) {
        return [];
      }

      // Find the longest sequence of pages that can be reached (recursively)
      let result = [];
      const current = [];
      function findRecursive(level) {
        const aCurrentLevelPages = aReachablePages[level];
        const lastPage = current.length ? current[current.length - 1] : undefined;
        if (aCurrentLevelPages) {
          aCurrentLevelPages.forEach(function (nextPage) {
            if (!lastPage || nextPage.pattern.indexOf(lastPage.pattern) === 0) {
              // We only consider pages that can be reached from the page at the previous level,
              // --> their pattern must be the pattern of the previous page with another segment appended
              current.push(nextPage);
              findRecursive(level + 1);
              current.pop();
            }
          });
        }
        if (current.length > result.length) {
          result = current.slice(); // We have found a sequence longer than our previous best --> store it as the new longest
        }
      }

      findRecursive(0);
      return result;
    },
    /**
     * Creates the startup object from the list of pages and contexts.
     *
     * @param aStartupPages The pages
     * @param aContexts The contexts
     * @returns An object containing either a hash or a context to navigate to, or an empty object if no deep link was found
     */
    _getDeepLinkObject: function (aStartupPages, aContexts) {
      if (aContexts.length === 1) {
        return {
          context: aContexts[0]
        };
      } else if (aContexts.length > 1) {
        // Navigation to a deeper level --> use the pattern of the deepest object page
        // and replace the parameters by the ID from the contexts
        let hash = aStartupPages[aStartupPages.length - 1].pattern;
        aContexts.forEach(function (oContext) {
          hash = hash.replace("(#)", `(${oContext.getPath().split("(")[1]}`);
        });
        return {
          hash
        };
      } else {
        return {};
      }
    },
    /**
     * Calculates startup parameters for a deeplink case, from startup parameters and routing infoirmation.
     *
     * @param oManifestRouting The routing information from the app manifest
     * @param oStartupParameters The startup parameters
     * @param oModel The OData model
     * @returns An object containing either a hash or a context to navigate to, or an empty object if no deep link was found
     */
    getDeepLinkStartupHash: function (oManifestRouting, oStartupParameters, oModel) {
      let aStartupPages;
      return oModel.getMetaModel().requestObject("/$EntityContainer/").then(() => {
        // Check if semantic keys are present in url parameters for every object page at each level
        aStartupPages = this._getStartupPagesFromStartupParams(oManifestRouting, oStartupParameters, oModel.getMetaModel());
        return this._requestObjectsFromParameters(aStartupPages, oModel);
      }).then(aValues => {
        if (aValues.length) {
          // Make sure we only get 1 context per promise, and flatten the array
          const aContexts = [];
          aValues.forEach(function (aFoundContexts) {
            if (aFoundContexts.length === 1) {
              aContexts.push(aFoundContexts[0]);
            }
          });
          return aContexts.length === aValues.length ? this._getDeepLinkObject(aStartupPages, aContexts) : {};
        } else {
          return {};
        }
      });
    },
    /**
     * Calculates the new hash based on the startup parameters.
     *
     * @param oStartupParameters The startup parameter values (map parameter name -> array of values)
     * @param sContextPath The context path for the startup of the app (generally the path to the main entity set)
     * @param oRouter The router instance
     * @param oMetaModel The meta model
     * @returns A promise containing the hash to navigate to, or an empty string if there's no need to navigate
     */
    getCreateStartupHash: function (oStartupParameters, sContextPath, oRouter, oMetaModel) {
      return oMetaModel.requestObject(`${sContextPath}@`).then(oEntitySetAnnotations => {
        let sMetaPath = "";
        let bCreatable = true;
        if (oEntitySetAnnotations["@com.sap.vocabularies.Common.v1.DraftRoot"] && oEntitySetAnnotations["@com.sap.vocabularies.Common.v1.DraftRoot"]["NewAction"]) {
          sMetaPath = `${sContextPath}@com.sap.vocabularies.Common.v1.DraftRoot/NewAction@Org.OData.Core.V1.OperationAvailable`;
        } else if (oEntitySetAnnotations["@com.sap.vocabularies.Session.v1.StickySessionSupported"] && oEntitySetAnnotations["@com.sap.vocabularies.Session.v1.StickySessionSupported"]["NewAction"]) {
          sMetaPath = `${sContextPath}@com.sap.vocabularies.Session.v1.StickySessionSupported/NewAction@Org.OData.Core.V1.OperationAvailable`;
        }
        if (sMetaPath) {
          const bNewActionOperationAvailable = oMetaModel.getObject(sMetaPath);
          if (bNewActionOperationAvailable === false) {
            bCreatable = false;
          }
        } else {
          const oInsertRestrictions = oEntitySetAnnotations["@Org.OData.Capabilities.V1.InsertRestrictions"];
          if (oInsertRestrictions && oInsertRestrictions.Insertable === false) {
            bCreatable = false;
          }
        }
        if (bCreatable) {
          return this.getDefaultCreateHash(oStartupParameters, sContextPath, oRouter);
        } else {
          return "";
        }
      });
    },
    /**
     * Calculates the hash to create a new object.
     *
     * @param oStartupParameters The startup parameter values (map parameter name -> array of values)
     * @param sContextPath The context path of the entity set to be used for the creation
     * @param oRouter The router instance
     * @returns The hash
     */
    getDefaultCreateHash: function (oStartupParameters, sContextPath, oRouter) {
      let sDefaultCreateHash = oStartupParameters && oStartupParameters.preferredMode ? oStartupParameters.preferredMode[0] : "create";
      let sHash = "";
      sDefaultCreateHash = sDefaultCreateHash.indexOf(":") !== -1 && sDefaultCreateHash.length > sDefaultCreateHash.indexOf(":") + 1 ? sDefaultCreateHash.substr(0, sDefaultCreateHash.indexOf(":")) : "create";
      sHash = `${sContextPath.substring(1)}(...)?i-action=${sDefaultCreateHash}`;
      if (oRouter.getRouteInfoByHash(sHash)) {
        return sHash;
      } else {
        throw new Error(`No route match for creating a new ${sContextPath.substring(1)}`);
      }
    }
  };
  return AppStartupHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/AppStartupHelper", ["sap/ui/model/Filter","sap/ui/model/FilterOperator","./ModelHelper"],function(e,t,n){"use strict";const r={_getKeysFromStartupParams:function(e,t){let n=true;const r=e.map(e=>{if(t[e]&&t[e].length===1){return{name:e,value:t[e][0]}}else{n=false;return{name:e,value:""}}});return n?r:undefined},_createFilterFromKeys:function(r,a,s){const i=n.isFilteringCaseSensitive(s);let o=false;const c=r.map(n=>{if(n.name==="IsActiveEntity"){o=true}return new e({path:n.name,operator:t.EQ,value1:n.value,caseSensitive:i})});if(a&&!o){const t=new e({filters:[new e("IsActiveEntity","EQ",false),new e("SiblingEntity/IsActiveEntity","EQ",null)],and:false});c.push(t)}return new e(c,true)},_requestObjectsFromParameters:function(e,t){const n=e.map(e=>{const n=e.semanticKeys||e.technicalKeys||[];const r=this._createFilterFromKeys(n,e.draftMode,t.getMetaModel());const a=t.bindList(e.contextPath,undefined,undefined,r,{$select:n.map(e=>e.name).join(",")});return a.requestContexts(0,2)});return Promise.all(n)},_getReachablePageInfoFromRoute:function(e,t,n,r){var a,s;let i=e.pattern.replace(":?query:","");i=i.replace(/\/$/,"");if(!i||!i.endsWith(")")){return undefined}i=i.replace(/\(\{[^\}]*\}\)/g,"(#)");const o=Array.isArray(e.target)?e.target[e.target.length-1]:e.target;const c=t.targets[o];const u=i.split("/");const l=u.length-1;if(l!==0&&(c===null||c===void 0?void 0:(a=c.options)===null||a===void 0?void 0:(s=a.settings)===null||s===void 0?void 0:s.allowDeepLinking)!==true){return undefined}const f=c.options.settings.contextPath||c.options.settings.entitySet&&`/${c.options.settings.entitySet}`;const p=f&&r.getObject(`/$EntityContainer${f}/`);if(!p){return undefined}const g=r.getObject(`/$EntityContainer${f}/@com.sap.vocabularies.Common.v1.SemanticKey`);const h=g?this._getKeysFromStartupParams(g.map(e=>e.$PropertyPath),n):undefined;const d=!h&&l===0?this._getKeysFromStartupParams(p["$Key"],n):undefined;if(h===undefined&&d===undefined){return undefined}const m=r.getObject(`/$EntityContainer${f}@com.sap.vocabularies.Common.v1.DraftRoot`)||r.getObject(`/$EntityContainer${f}@com.sap.vocabularies.Common.v1.DraftNode`)?true:false;return{pattern:i,contextPath:f,draftMode:m,technicalKeys:d,semanticKeys:h,target:o,pageLevel:l}},_getReachablePages:function(e,t,n){const r=e.routes;const a={};r.forEach(r=>{const s=this._getReachablePageInfoFromRoute(r,e,t,n);if(s){if(!a[s.pageLevel]){a[s.pageLevel]=[]}a[s.pageLevel].push(s)}});const s=[];let i=0;while(a[i]){s.push(a[i]);i++}return s},_getStartupPagesFromStartupParams:function(e,t,n){const r=this._getReachablePages(e,t,n);if(r.length===0){return[]}let a=[];const s=[];function i(e){const t=r[e];const n=s.length?s[s.length-1]:undefined;if(t){t.forEach(function(t){if(!n||t.pattern.indexOf(n.pattern)===0){s.push(t);i(e+1);s.pop()}})}if(s.length>a.length){a=s.slice()}}i(0);return a},_getDeepLinkObject:function(e,t){if(t.length===1){return{context:t[0]}}else if(t.length>1){let n=e[e.length-1].pattern;t.forEach(function(e){n=n.replace("(#)",`(${e.getPath().split("(")[1]}`)});return{hash:n}}else{return{}}},getDeepLinkStartupHash:function(e,t,n){let r;return n.getMetaModel().requestObject("/$EntityContainer/").then(()=>{r=this._getStartupPagesFromStartupParams(e,t,n.getMetaModel());return this._requestObjectsFromParameters(r,n)}).then(e=>{if(e.length){const t=[];e.forEach(function(e){if(e.length===1){t.push(e[0])}});return t.length===e.length?this._getDeepLinkObject(r,t):{}}else{return{}}})},getCreateStartupHash:function(e,t,n,r){return r.requestObject(`${t}@`).then(a=>{let s="";let i=true;if(a["@com.sap.vocabularies.Common.v1.DraftRoot"]&&a["@com.sap.vocabularies.Common.v1.DraftRoot"]["NewAction"]){s=`${t}@com.sap.vocabularies.Common.v1.DraftRoot/NewAction@Org.OData.Core.V1.OperationAvailable`}else if(a["@com.sap.vocabularies.Session.v1.StickySessionSupported"]&&a["@com.sap.vocabularies.Session.v1.StickySessionSupported"]["NewAction"]){s=`${t}@com.sap.vocabularies.Session.v1.StickySessionSupported/NewAction@Org.OData.Core.V1.OperationAvailable`}if(s){const e=r.getObject(s);if(e===false){i=false}}else{const e=a["@Org.OData.Capabilities.V1.InsertRestrictions"];if(e&&e.Insertable===false){i=false}}if(i){return this.getDefaultCreateHash(e,t,n)}else{return""}})},getDefaultCreateHash:function(e,t,n){let r=e&&e.preferredMode?e.preferredMode[0]:"create";let a="";r=r.indexOf(":")!==-1&&r.length>r.indexOf(":")+1?r.substr(0,r.indexOf(":")):"create";a=`${t.substring(1)}(...)?i-action=${r}`;if(n.getRouteInfoByHash(a)){return a}else{throw new Error(`No route match for creating a new ${t.substring(1)}`)}}};return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/BindingToolkit-dbg", ["./AnnotationEnum"], function (AnnotationEnum) {
  "use strict";

  var _exports = {};
  var resolveEnumValue = AnnotationEnum.resolveEnumValue;
  const EDM_TYPE_MAPPING = {
    "Edm.Boolean": {
      type: "sap.ui.model.odata.type.Boolean"
    },
    "Edm.Byte": {
      type: "sap.ui.model.odata.type.Byte"
    },
    "Edm.Date": {
      type: "sap.ui.model.odata.type.Date"
    },
    "Edm.DateTimeOffset": {
      constraints: {
        $Precision: "precision",
        $V4: "V4"
      },
      type: "sap.ui.model.odata.type.DateTimeOffset"
    },
    "Edm.Decimal": {
      constraints: {
        "@Org.OData.Validation.V1.Minimum/$Decimal": "minimum",
        "@Org.OData.Validation.V1.Minimum@Org.OData.Validation.V1.Exclusive": "minimumExclusive",
        "@Org.OData.Validation.V1.Maximum/$Decimal": "maximum",
        "@Org.OData.Validation.V1.Maximum@Org.OData.Validation.V1.Exclusive": "maximumExclusive",
        $Precision: "precision",
        $Scale: "scale"
      },
      type: "sap.ui.model.odata.type.Decimal"
    },
    "Edm.Double": {
      type: "sap.ui.model.odata.type.Double"
    },
    "Edm.Guid": {
      type: "sap.ui.model.odata.type.Guid"
    },
    "Edm.Int16": {
      type: "sap.ui.model.odata.type.Int16"
    },
    "Edm.Int32": {
      type: "sap.ui.model.odata.type.Int32"
    },
    "Edm.Int64": {
      type: "sap.ui.model.odata.type.Int64"
    },
    "Edm.SByte": {
      type: "sap.ui.model.odata.type.SByte"
    },
    "Edm.Single": {
      type: "sap.ui.model.odata.type.Single"
    },
    "Edm.Stream": {
      type: "sap.ui.model.odata.type.Stream"
    },
    "Edm.Binary": {
      type: "sap.ui.model.odata.type.Stream"
    },
    "Edm.String": {
      constraints: {
        "@com.sap.vocabularies.Common.v1.IsDigitSequence": "isDigitSequence",
        $MaxLength: "maxLength",
        $Nullable: "nullable"
      },
      type: "sap.ui.model.odata.type.String"
    },
    "Edm.TimeOfDay": {
      constraints: {
        $Precision: "precision"
      },
      type: "sap.ui.model.odata.type.TimeOfDay"
    }
  };

  /**
   * An expression that evaluates to type T, or a constant value of type T
   */
  _exports.EDM_TYPE_MAPPING = EDM_TYPE_MAPPING;
  const unresolvableExpression = {
    _type: "Unresolvable"
  };
  _exports.unresolvableExpression = unresolvableExpression;
  function escapeXmlAttribute(inputString) {
    return inputString.replace(/'/g, "\\'");
  }
  function hasUnresolvableExpression() {
    for (var _len = arguments.length, expressions = new Array(_len), _key = 0; _key < _len; _key++) {
      expressions[_key] = arguments[_key];
    }
    return expressions.find(expr => expr._type === "Unresolvable") !== undefined;
  }
  /**
   * Check two expressions for (deep) equality.
   *
   * @param a
   * @param b
   * @returns `true` if the two expressions are equal
   * @private
   */
  _exports.hasUnresolvableExpression = hasUnresolvableExpression;
  function _checkExpressionsAreEqual(a, b) {
    if (a._type !== b._type) {
      return false;
    }
    switch (a._type) {
      case "Unresolvable":
        return false;
      // Unresolvable is never equal to anything even itself
      case "Constant":
      case "EmbeddedBinding":
      case "EmbeddedExpressionBinding":
        return a.value === b.value;
      case "Not":
        return _checkExpressionsAreEqual(a.operand, b.operand);
      case "Truthy":
        return _checkExpressionsAreEqual(a.operand, b.operand);
      case "Set":
        return a.operator === b.operator && a.operands.length === b.operands.length && a.operands.every(expression => b.operands.some(otherExpression => _checkExpressionsAreEqual(expression, otherExpression)));
      case "IfElse":
        return _checkExpressionsAreEqual(a.condition, b.condition) && _checkExpressionsAreEqual(a.onTrue, b.onTrue) && _checkExpressionsAreEqual(a.onFalse, b.onFalse);
      case "Comparison":
        return a.operator === b.operator && _checkExpressionsAreEqual(a.operand1, b.operand1) && _checkExpressionsAreEqual(a.operand2, b.operand2);
      case "Concat":
        const aExpressions = a.expressions;
        const bExpressions = b.expressions;
        if (aExpressions.length !== bExpressions.length) {
          return false;
        }
        return aExpressions.every((expression, index) => {
          return _checkExpressionsAreEqual(expression, bExpressions[index]);
        });
      case "Length":
        return _checkExpressionsAreEqual(a.pathInModel, b.pathInModel);
      case "PathInModel":
        return a.modelName === b.modelName && a.path === b.path && a.targetEntitySet === b.targetEntitySet;
      case "Formatter":
        return a.fn === b.fn && a.parameters.length === b.parameters.length && a.parameters.every((value, index) => _checkExpressionsAreEqual(b.parameters[index], value));
      case "ComplexType":
        return a.type === b.type && a.bindingParameters.length === b.bindingParameters.length && a.bindingParameters.every((value, index) => _checkExpressionsAreEqual(b.bindingParameters[index], value));
      case "Function":
        const otherFunction = b;
        if (a.obj === undefined || otherFunction.obj === undefined) {
          return a.obj === otherFunction;
        }
        return a.fn === otherFunction.fn && _checkExpressionsAreEqual(a.obj, otherFunction.obj) && a.parameters.length === otherFunction.parameters.length && a.parameters.every((value, index) => _checkExpressionsAreEqual(otherFunction.parameters[index], value));
      case "Ref":
        return a.ref === b.ref;
    }
    return false;
  }

  /**
   * Converts a nested SetExpression by inlining operands of type SetExpression with the same operator.
   *
   * @param expression The expression to flatten
   * @returns A new SetExpression with the same operator
   */
  _exports._checkExpressionsAreEqual = _checkExpressionsAreEqual;
  function flattenSetExpression(expression) {
    return expression.operands.reduce((result, operand) => {
      const candidatesForFlattening = operand._type === "Set" && operand.operator === expression.operator ? operand.operands : [operand];
      candidatesForFlattening.forEach(candidate => {
        if (result.operands.every(e => !_checkExpressionsAreEqual(e, candidate))) {
          result.operands.push(candidate);
        }
      });
      return result;
    }, {
      _type: "Set",
      operator: expression.operator,
      operands: []
    });
  }

  /**
   * Detects whether an array of boolean expressions contains an expression and its negation.
   *
   * @param expressions Array of expressions
   * @returns `true` if the set of expressions contains an expression and its negation
   */
  function hasOppositeExpressions(expressions) {
    const negatedExpressions = expressions.map(not);
    return expressions.some((expression, index) => {
      for (let i = index + 1; i < negatedExpressions.length; i++) {
        if (_checkExpressionsAreEqual(expression, negatedExpressions[i])) {
          return true;
        }
      }
      return false;
    });
  }

  /**
   * Logical `and` expression.
   *
   * The expression is simplified to false if this can be decided statically (that is, if one operand is a constant
   * false or if the expression contains an operand and its negation).
   *
   * @param operands Expressions to connect by `and`
   * @returns Expression evaluating to boolean
   */
  function and() {
    for (var _len2 = arguments.length, operands = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      operands[_key2] = arguments[_key2];
    }
    const expressions = flattenSetExpression({
      _type: "Set",
      operator: "&&",
      operands: operands.map(wrapPrimitive)
    }).operands;
    if (hasUnresolvableExpression(...expressions)) {
      return unresolvableExpression;
    }
    let isStaticFalse = false;
    const nonTrivialExpression = expressions.filter(expression => {
      if (isFalse(expression)) {
        isStaticFalse = true;
      }
      return !isConstant(expression);
    });
    if (isStaticFalse) {
      return constant(false);
    } else if (nonTrivialExpression.length === 0) {
      // Resolve the constant then
      const isValid = expressions.reduce((result, expression) => result && isTrue(expression), true);
      return constant(isValid);
    } else if (nonTrivialExpression.length === 1) {
      return nonTrivialExpression[0];
    } else if (hasOppositeExpressions(nonTrivialExpression)) {
      return constant(false);
    } else {
      return {
        _type: "Set",
        operator: "&&",
        operands: nonTrivialExpression
      };
    }
  }

  /**
   * Logical `or` expression.
   *
   * The expression is simplified to true if this can be decided statically (that is, if one operand is a constant
   * true or if the expression contains an operand and its negation).
   *
   * @param operands Expressions to connect by `or`
   * @returns Expression evaluating to boolean
   */
  _exports.and = and;
  function or() {
    for (var _len3 = arguments.length, operands = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      operands[_key3] = arguments[_key3];
    }
    const expressions = flattenSetExpression({
      _type: "Set",
      operator: "||",
      operands: operands.map(wrapPrimitive)
    }).operands;
    if (hasUnresolvableExpression(...expressions)) {
      return unresolvableExpression;
    }
    let isStaticTrue = false;
    const nonTrivialExpression = expressions.filter(expression => {
      if (isTrue(expression)) {
        isStaticTrue = true;
      }
      return !isConstant(expression) || expression.value;
    });
    if (isStaticTrue) {
      return constant(true);
    } else if (nonTrivialExpression.length === 0) {
      // Resolve the constant then
      const isValid = expressions.reduce((result, expression) => result && isTrue(expression), true);
      return constant(isValid);
    } else if (nonTrivialExpression.length === 1) {
      return nonTrivialExpression[0];
    } else if (hasOppositeExpressions(nonTrivialExpression)) {
      return constant(true);
    } else {
      return {
        _type: "Set",
        operator: "||",
        operands: nonTrivialExpression
      };
    }
  }

  /**
   * Logical `not` operator.
   *
   * @param operand The expression to reverse
   * @returns The resulting expression that evaluates to boolean
   */
  _exports.or = or;
  function not(operand) {
    operand = wrapPrimitive(operand);
    if (hasUnresolvableExpression(operand)) {
      return unresolvableExpression;
    } else if (isConstant(operand)) {
      return constant(!operand.value);
    } else if (typeof operand === "object" && operand._type === "Set" && operand.operator === "||" && operand.operands.every(expression => isConstant(expression) || isComparison(expression))) {
      return and(...operand.operands.map(expression => not(expression)));
    } else if (typeof operand === "object" && operand._type === "Set" && operand.operator === "&&" && operand.operands.every(expression => isConstant(expression) || isComparison(expression))) {
      return or(...operand.operands.map(expression => not(expression)));
    } else if (isComparison(operand)) {
      // Create the reverse comparison
      switch (operand.operator) {
        case "!==":
          return {
            ...operand,
            operator: "==="
          };
        case "<":
          return {
            ...operand,
            operator: ">="
          };
        case "<=":
          return {
            ...operand,
            operator: ">"
          };
        case "===":
          return {
            ...operand,
            operator: "!=="
          };
        case ">":
          return {
            ...operand,
            operator: "<="
          };
        case ">=":
          return {
            ...operand,
            operator: "<"
          };
      }
    } else if (operand._type === "Not") {
      return operand.operand;
    }
    return {
      _type: "Not",
      operand: operand
    };
  }

  /**
   * Evaluates whether a binding expression is equal to true with a loose equality.
   *
   * @param operand The expression to check
   * @returns The resulting expression that evaluates to boolean
   */
  _exports.not = not;
  function isTruthy(operand) {
    if (isConstant(operand)) {
      return constant(!!operand.value);
    } else {
      return {
        _type: "Truthy",
        operand: operand
      };
    }
  }

  /**
   * Creates a binding expression that will be evaluated by the corresponding model.
   *
   * @param path
   * @param modelName
   * @param visitedNavigationPaths
   * @param pathVisitor
   * @returns An expression representating that path in the model
   * @deprecated use pathInModel instead
   */
  _exports.isTruthy = isTruthy;
  function bindingExpression(path, modelName) {
    let visitedNavigationPaths = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
    let pathVisitor = arguments.length > 3 ? arguments[3] : undefined;
    return pathInModel(path, modelName, visitedNavigationPaths, pathVisitor);
  }

  /**
   * Creates a binding expression that will be evaluated by the corresponding model.
   *
   * @template TargetType
   * @param path The path on the model
   * @param [modelName] The name of the model
   * @param [visitedNavigationPaths] The paths from the root entitySet
   * @param [pathVisitor] A function to modify the resulting path
   * @returns An expression representating that path in the model
   */
  _exports.bindingExpression = bindingExpression;
  function pathInModel(path, modelName) {
    let visitedNavigationPaths = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
    let pathVisitor = arguments.length > 3 ? arguments[3] : undefined;
    if (path === undefined) {
      return unresolvableExpression;
    }
    let targetPath;
    if (pathVisitor) {
      targetPath = pathVisitor(path);
      if (targetPath === undefined) {
        return unresolvableExpression;
      }
    } else {
      const localPath = visitedNavigationPaths.concat();
      localPath.push(path);
      targetPath = localPath.join("/");
    }
    return {
      _type: "PathInModel",
      modelName: modelName,
      path: targetPath
    };
  }
  _exports.pathInModel = pathInModel;
  /**
   * Creates a constant expression based on a primitive value.
   *
   * @template T
   * @param value The constant to wrap in an expression
   * @returns The constant expression
   */
  function constant(value) {
    let constantValue;
    if (typeof value === "object" && value !== null && value !== undefined) {
      if (Array.isArray(value)) {
        constantValue = value.map(wrapPrimitive);
      } else if (isPrimitiveObject(value)) {
        constantValue = value.valueOf();
      } else {
        constantValue = Object.entries(value).reduce((plainExpression, _ref) => {
          let [key, val] = _ref;
          const wrappedValue = wrapPrimitive(val);
          if (wrappedValue._type !== "Constant" || wrappedValue.value !== undefined) {
            plainExpression[key] = wrappedValue;
          }
          return plainExpression;
        }, {});
      }
    } else {
      constantValue = value;
    }
    return {
      _type: "Constant",
      value: constantValue
    };
  }
  _exports.constant = constant;
  function resolveBindingString(value, targetType) {
    if (value !== undefined && typeof value === "string" && value.startsWith("{")) {
      const pathInModelRegex = /^{(.*)>(.+)}$/; // Matches model paths like "model>path" or ">path" (default model)
      const pathInModelRegexMatch = pathInModelRegex.exec(value);
      if (value.startsWith("{=")) {
        // Expression binding, we can just remove the outer binding things
        return {
          _type: "EmbeddedExpressionBinding",
          value: value
        };
      } else if (pathInModelRegexMatch) {
        return pathInModel(pathInModelRegexMatch[2] || "", pathInModelRegexMatch[1] || undefined);
      } else {
        return {
          _type: "EmbeddedBinding",
          value: value
        };
      }
    } else if (targetType === "boolean" && typeof value === "string" && (value === "true" || value === "false")) {
      return constant(value === "true");
    } else if (targetType === "number" && typeof value === "string" && (!isNaN(Number(value)) || value === "NaN")) {
      return constant(Number(value));
    } else {
      return constant(value);
    }
  }

  /**
   * A named reference.
   *
   * @see fn
   * @param reference Reference
   * @returns The object reference binding part
   */
  _exports.resolveBindingString = resolveBindingString;
  function ref(reference) {
    return {
      _type: "Ref",
      ref: reference
    };
  }

  /**
   * Wrap a primitive into a constant expression if it is not already an expression.
   *
   * @template T
   * @param something The object to wrap in a Constant expression
   * @returns Either the original object or the wrapped one depending on the case
   */
  _exports.ref = ref;
  function wrapPrimitive(something) {
    if (isBindingToolkitExpression(something)) {
      return something;
    }
    return constant(something);
  }

  /**
   * Checks if the expression or value provided is a binding tooling expression or not.
   *
   * Every object having a property named `_type` of some value is considered an expression, even if there is actually
   * no such expression type supported.
   *
   * @param expression
   * @returns `true` if the expression is a binding toolkit expression
   */
  function isBindingToolkitExpression(expression) {
    return (expression === null || expression === void 0 ? void 0 : expression._type) !== undefined;
  }

  /**
   * Checks if the expression or value provided is constant or not.
   *
   * @template T The target type
   * @param  maybeConstant The expression or primitive value that is to be checked
   * @returns `true` if it is constant
   */
  _exports.isBindingToolkitExpression = isBindingToolkitExpression;
  function isConstant(maybeConstant) {
    return typeof maybeConstant !== "object" || maybeConstant._type === "Constant";
  }
  _exports.isConstant = isConstant;
  function isTrue(expression) {
    return isConstant(expression) && expression.value === true;
  }
  function isFalse(expression) {
    return isConstant(expression) && expression.value === false;
  }

  /**
   * Checks if the expression or value provided is a path in model expression or not.
   *
   * @template T The target type
   * @param  maybeBinding The expression or primitive value that is to be checked
   * @returns `true` if it is a path in model expression
   */
  function isPathInModelExpression(maybeBinding) {
    return (maybeBinding === null || maybeBinding === void 0 ? void 0 : maybeBinding._type) === "PathInModel";
  }

  /**
   * Checks if the expression or value provided is a complex type expression.
   *
   * @template T The target type
   * @param  maybeBinding The expression or primitive value that is to be checked
   * @returns `true` if it is a path in model expression
   */
  _exports.isPathInModelExpression = isPathInModelExpression;
  function isComplexTypeExpression(maybeBinding) {
    return (maybeBinding === null || maybeBinding === void 0 ? void 0 : maybeBinding._type) === "ComplexType";
  }

  /**
   * Checks if the expression or value provided is a concat expression or not.
   *
   * @param expression
   * @returns `true` if the expression is a ConcatExpression
   */
  _exports.isComplexTypeExpression = isComplexTypeExpression;
  function isConcatExpression(expression) {
    return (expression === null || expression === void 0 ? void 0 : expression._type) === "Concat";
  }

  /**
   * Checks if the expression provided is a comparison or not.
   *
   * @template T The target type
   * @param expression The expression
   * @returns `true` if the expression is a ComparisonExpression
   */
  function isComparison(expression) {
    return expression._type === "Comparison";
  }

  /**
   * Checks whether the input parameter is a constant expression of type undefined.
   *
   * @param expression The input expression or object in general
   * @returns `true` if the input is constant which has undefined for value
   */
  function isUndefinedExpression(expression) {
    const expressionAsExpression = expression;
    return (expressionAsExpression === null || expressionAsExpression === void 0 ? void 0 : expressionAsExpression._type) === "Constant" && (expressionAsExpression === null || expressionAsExpression === void 0 ? void 0 : expressionAsExpression.value) === undefined;
  }
  _exports.isUndefinedExpression = isUndefinedExpression;
  function isPrimitiveObject(objectType) {
    switch (objectType.constructor.name) {
      case "String":
      case "Number":
      case "Boolean":
        return true;
      default:
        return false;
    }
  }
  /**
   * Check if the passed annotation annotationValue is a ComplexAnnotationExpression.
   *
   * @template T The target type
   * @param  annotationValue The annotation annotationValue to evaluate
   * @returns `true` if the object is a {ComplexAnnotationExpression}
   */
  function isComplexAnnotationExpression(annotationValue) {
    return typeof annotationValue === "object" && !isPrimitiveObject(annotationValue);
  }

  /**
   * Generate the corresponding annotationValue for a given annotation annotationValue.
   *
   * @template T The target type
   * @param annotationValue The source annotation annotationValue
   * @param visitedNavigationPaths The path from the root entity set
   * @param defaultValue Default value if the annotationValue is undefined
   * @param pathVisitor A function to modify the resulting path
   * @returns The annotationValue equivalent to that annotation annotationValue
   * @deprecated use getExpressionFromAnnotation instead
   */
  function annotationExpression(annotationValue) {
    let visitedNavigationPaths = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let defaultValue = arguments.length > 2 ? arguments[2] : undefined;
    let pathVisitor = arguments.length > 3 ? arguments[3] : undefined;
    return getExpressionFromAnnotation(annotationValue, visitedNavigationPaths, defaultValue, pathVisitor);
  }
  /**
   * Generate the corresponding annotationValue for a given annotation annotationValue.
   *
   * @template T The target type
   * @param annotationValue The source annotation annotationValue
   * @param visitedNavigationPaths The path from the root entity set
   * @param defaultValue Default value if the annotationValue is undefined
   * @param pathVisitor A function to modify the resulting path
   * @returns The annotationValue equivalent to that annotation annotationValue
   */
  _exports.annotationExpression = annotationExpression;
  function getExpressionFromAnnotation(annotationValue) {
    var _annotationValue;
    let visitedNavigationPaths = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let defaultValue = arguments.length > 2 ? arguments[2] : undefined;
    let pathVisitor = arguments.length > 3 ? arguments[3] : undefined;
    if (annotationValue === undefined) {
      return wrapPrimitive(defaultValue);
    }
    annotationValue = (_annotationValue = annotationValue) === null || _annotationValue === void 0 ? void 0 : _annotationValue.valueOf();
    if (!isComplexAnnotationExpression(annotationValue)) {
      return constant(annotationValue);
    }
    switch (annotationValue.type) {
      case "Path":
        return pathInModel(annotationValue.path, undefined, visitedNavigationPaths, pathVisitor);
      case "If":
        return annotationIfExpression(annotationValue.If, visitedNavigationPaths, pathVisitor);
      case "Not":
        return not(parseAnnotationCondition(annotationValue.Not, visitedNavigationPaths, pathVisitor));
      case "Eq":
        return equal(parseAnnotationCondition(annotationValue.Eq[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.Eq[1], visitedNavigationPaths, pathVisitor));
      case "Ne":
        return notEqual(parseAnnotationCondition(annotationValue.Ne[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.Ne[1], visitedNavigationPaths, pathVisitor));
      case "Gt":
        return greaterThan(parseAnnotationCondition(annotationValue.Gt[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.Gt[1], visitedNavigationPaths, pathVisitor));
      case "Ge":
        return greaterOrEqual(parseAnnotationCondition(annotationValue.Ge[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.Ge[1], visitedNavigationPaths, pathVisitor));
      case "Lt":
        return lessThan(parseAnnotationCondition(annotationValue.Lt[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.Lt[1], visitedNavigationPaths, pathVisitor));
      case "Le":
        return lessOrEqual(parseAnnotationCondition(annotationValue.Le[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.Le[1], visitedNavigationPaths, pathVisitor));
      case "Or":
        return or(...annotationValue.Or.map(function (orCondition) {
          return parseAnnotationCondition(orCondition, visitedNavigationPaths, pathVisitor);
        }));
      case "And":
        return and(...annotationValue.And.map(function (andCondition) {
          return parseAnnotationCondition(andCondition, visitedNavigationPaths, pathVisitor);
        }));
      case "Apply":
        return annotationApplyExpression(annotationValue, visitedNavigationPaths, pathVisitor);
    }
    return unresolvableExpression;
  }

  /**
   * Parse the annotation condition into an expression.
   *
   * @template T The target type
   * @param annotationValue The condition or value from the annotation
   * @param visitedNavigationPaths The path from the root entity set
   * @param pathVisitor A function to modify the resulting path
   * @returns An equivalent expression
   */
  _exports.getExpressionFromAnnotation = getExpressionFromAnnotation;
  function parseAnnotationCondition(annotationValue) {
    let visitedNavigationPaths = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let pathVisitor = arguments.length > 2 ? arguments[2] : undefined;
    if (annotationValue === null || typeof annotationValue !== "object") {
      return constant(annotationValue);
    } else if (annotationValue.hasOwnProperty("$Or")) {
      return or(...annotationValue.$Or.map(function (orCondition) {
        return parseAnnotationCondition(orCondition, visitedNavigationPaths, pathVisitor);
      }));
    } else if (annotationValue.hasOwnProperty("$And")) {
      return and(...annotationValue.$And.map(function (andCondition) {
        return parseAnnotationCondition(andCondition, visitedNavigationPaths, pathVisitor);
      }));
    } else if (annotationValue.hasOwnProperty("$Not")) {
      return not(parseAnnotationCondition(annotationValue.$Not, visitedNavigationPaths, pathVisitor));
    } else if (annotationValue.hasOwnProperty("$Eq")) {
      return equal(parseAnnotationCondition(annotationValue.$Eq[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.$Eq[1], visitedNavigationPaths, pathVisitor));
    } else if (annotationValue.hasOwnProperty("$Ne")) {
      return notEqual(parseAnnotationCondition(annotationValue.$Ne[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.$Ne[1], visitedNavigationPaths, pathVisitor));
    } else if (annotationValue.hasOwnProperty("$Gt")) {
      return greaterThan(parseAnnotationCondition(annotationValue.$Gt[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.$Gt[1], visitedNavigationPaths, pathVisitor));
    } else if (annotationValue.hasOwnProperty("$Ge")) {
      return greaterOrEqual(parseAnnotationCondition(annotationValue.$Ge[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.$Ge[1], visitedNavigationPaths, pathVisitor));
    } else if (annotationValue.hasOwnProperty("$Lt")) {
      return lessThan(parseAnnotationCondition(annotationValue.$Lt[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.$Lt[1], visitedNavigationPaths, pathVisitor));
    } else if (annotationValue.hasOwnProperty("$Le")) {
      return lessOrEqual(parseAnnotationCondition(annotationValue.$Le[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue.$Le[1], visitedNavigationPaths, pathVisitor));
    } else if (annotationValue.hasOwnProperty("$Path")) {
      return pathInModel(annotationValue.$Path, undefined, visitedNavigationPaths, pathVisitor);
    } else if (annotationValue.hasOwnProperty("$Apply")) {
      return getExpressionFromAnnotation({
        type: "Apply",
        Function: annotationValue.$Function,
        Apply: annotationValue.$Apply
      }, visitedNavigationPaths, undefined, pathVisitor);
    } else if (annotationValue.hasOwnProperty("$If")) {
      return getExpressionFromAnnotation({
        type: "If",
        If: annotationValue.$If
      }, visitedNavigationPaths, undefined, pathVisitor);
    } else if (annotationValue.hasOwnProperty("$EnumMember")) {
      return constant(resolveEnumValue(annotationValue.$EnumMember));
    }
    return constant(false);
  }

  /**
   * Process the {IfAnnotationExpressionValue} into an expression.
   *
   * @template T The target type
   * @param annotationValue An If expression returning the type T
   * @param visitedNavigationPaths The path from the root entity set
   * @param pathVisitor A function to modify the resulting path
   * @returns The equivalent ifElse expression
   */
  function annotationIfExpression(annotationValue) {
    let visitedNavigationPaths = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let pathVisitor = arguments.length > 2 ? arguments[2] : undefined;
    return ifElse(parseAnnotationCondition(annotationValue[0], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue[1], visitedNavigationPaths, pathVisitor), parseAnnotationCondition(annotationValue[2], visitedNavigationPaths, pathVisitor));
  }
  _exports.annotationIfExpression = annotationIfExpression;
  function annotationApplyExpression(applyExpression) {
    let visitedNavigationPaths = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    let pathVisitor = arguments.length > 2 ? arguments[2] : undefined;
    switch (applyExpression.Function) {
      case "odata.concat":
        return concat(...applyExpression.Apply.map(applyParam => {
          let applyParamConverted = applyParam;
          if (applyParam.hasOwnProperty("$Path")) {
            applyParamConverted = {
              type: "Path",
              path: applyParam.$Path
            };
          } else if (applyParam.hasOwnProperty("$If")) {
            applyParamConverted = {
              type: "If",
              If: applyParam.$If
            };
          } else if (applyParam.hasOwnProperty("$Apply")) {
            applyParamConverted = {
              type: "Apply",
              Function: applyParam.$Function,
              Apply: applyParam.$Apply
            };
          }
          return getExpressionFromAnnotation(applyParamConverted, visitedNavigationPaths, undefined, pathVisitor);
        }));
    }
    return unresolvableExpression;
  }

  /**
   * Generic helper for the comparison operations (equal, notEqual, ...).
   *
   * @template T The target type
   * @param operator The operator to apply
   * @param leftOperand The operand on the left side of the operator
   * @param rightOperand The operand on the right side of the operator
   * @returns An expression representing the comparison
   */
  _exports.annotationApplyExpression = annotationApplyExpression;
  function comparison(operator, leftOperand, rightOperand) {
    const leftExpression = wrapPrimitive(leftOperand);
    const rightExpression = wrapPrimitive(rightOperand);
    if (hasUnresolvableExpression(leftExpression, rightExpression)) {
      return unresolvableExpression;
    }
    if (isConstant(leftExpression) && isConstant(rightExpression)) {
      switch (operator) {
        case "!==":
          return constant(leftExpression.value !== rightExpression.value);
        case "===":
          return constant(leftExpression.value === rightExpression.value);
        case "<":
          return constant(leftExpression.value < rightExpression.value);
        case "<=":
          return constant(leftExpression.value <= rightExpression.value);
        case ">":
          return constant(leftExpression.value > rightExpression.value);
        case ">=":
          return constant(leftExpression.value >= rightExpression.value);
      }
    } else {
      return {
        _type: "Comparison",
        operator: operator,
        operand1: leftExpression,
        operand2: rightExpression
      };
    }
  }
  function length(expression) {
    if (expression._type === "Unresolvable") {
      return expression;
    }
    return {
      _type: "Length",
      pathInModel: expression
    };
  }

  /**
   * Comparison: "equal" (===).
   *
   * @template T The target type
   * @param leftOperand The operand on the left side
   * @param rightOperand The operand on the right side of the comparison
   * @returns An expression representing the comparison
   */
  _exports.length = length;
  function equal(leftOperand, rightOperand) {
    const leftExpression = wrapPrimitive(leftOperand);
    const rightExpression = wrapPrimitive(rightOperand);
    if (hasUnresolvableExpression(leftExpression, rightExpression)) {
      return unresolvableExpression;
    }
    if (_checkExpressionsAreEqual(leftExpression, rightExpression)) {
      return constant(true);
    }
    function reduce(left, right) {
      if (left._type === "Comparison" && isTrue(right)) {
        // compare(a, b) === true ~~> compare(a, b)
        return left;
      } else if (left._type === "Comparison" && isFalse(right)) {
        // compare(a, b) === false ~~> !compare(a, b)
        return not(left);
      } else if (left._type === "IfElse" && _checkExpressionsAreEqual(left.onTrue, right)) {
        // (if (x) { a } else { b }) === a ~~> x || (b === a)
        return or(left.condition, equal(left.onFalse, right));
      } else if (left._type === "IfElse" && _checkExpressionsAreEqual(left.onFalse, right)) {
        // (if (x) { a } else { b }) === b ~~> !x || (a === b)
        return or(not(left.condition), equal(left.onTrue, right));
      } else if (left._type === "IfElse" && isConstant(left.onTrue) && isConstant(left.onFalse) && isConstant(right) && !_checkExpressionsAreEqual(left.onTrue, right) && !_checkExpressionsAreEqual(left.onFalse, right)) {
        return constant(false);
      }
      return undefined;
    }

    // exploit symmetry: a === b <~> b === a
    const reduced = reduce(leftExpression, rightExpression) ?? reduce(rightExpression, leftExpression);
    return reduced ?? comparison("===", leftExpression, rightExpression);
  }

  /**
   * Comparison: "not equal" (!==).
   *
   * @template T The target type
   * @param leftOperand The operand on the left side
   * @param rightOperand The operand on the right side of the comparison
   * @returns An expression representing the comparison
   */
  _exports.equal = equal;
  function notEqual(leftOperand, rightOperand) {
    return not(equal(leftOperand, rightOperand));
  }

  /**
   * Comparison: "greater or equal" (>=).
   *
   * @template T The target type
   * @param leftOperand The operand on the left side
   * @param rightOperand The operand on the right side of the comparison
   * @returns An expression representing the comparison
   */
  _exports.notEqual = notEqual;
  function greaterOrEqual(leftOperand, rightOperand) {
    return comparison(">=", leftOperand, rightOperand);
  }

  /**
   * Comparison: "greater than" (>).
   *
   * @template T The target type
   * @param leftOperand The operand on the left side
   * @param rightOperand The operand on the right side of the comparison
   * @returns An expression representing the comparison
   */
  _exports.greaterOrEqual = greaterOrEqual;
  function greaterThan(leftOperand, rightOperand) {
    return comparison(">", leftOperand, rightOperand);
  }

  /**
   * Comparison: "less or equal" (<=).
   *
   * @template T The target type
   * @param leftOperand The operand on the left side
   * @param rightOperand The operand on the right side of the comparison
   * @returns An expression representing the comparison
   */
  _exports.greaterThan = greaterThan;
  function lessOrEqual(leftOperand, rightOperand) {
    return comparison("<=", leftOperand, rightOperand);
  }

  /**
   * Comparison: "less than" (<).
   *
   * @template T The target type
   * @param leftOperand The operand on the left side
   * @param rightOperand The operand on the right side of the comparison
   * @returns An expression representing the comparison
   */
  _exports.lessOrEqual = lessOrEqual;
  function lessThan(leftOperand, rightOperand) {
    return comparison("<", leftOperand, rightOperand);
  }

  /**
   * If-then-else expression.
   *
   * Evaluates to onTrue if the condition evaluates to true, else evaluates to onFalse.
   *
   * @template T The target type
   * @param condition The condition to evaluate
   * @param onTrue Expression result if the condition evaluates to true
   * @param onFalse Expression result if the condition evaluates to false
   * @returns The expression that represents this conditional check
   */
  _exports.lessThan = lessThan;
  function ifElse(condition, onTrue, onFalse) {
    let conditionExpression = wrapPrimitive(condition);
    let onTrueExpression = wrapPrimitive(onTrue);
    let onFalseExpression = wrapPrimitive(onFalse);
    if (hasUnresolvableExpression(conditionExpression, onTrueExpression, onFalseExpression)) {
      return unresolvableExpression;
    }
    // swap branches if the condition is a negation
    if (conditionExpression._type === "Not") {
      // ifElse(not(X), a, b) --> ifElse(X, b, a)
      [onTrueExpression, onFalseExpression] = [onFalseExpression, onTrueExpression];
      conditionExpression = not(conditionExpression);
    }

    // inline nested if-else expressions: onTrue branch
    // ifElse(X, ifElse(X, a, b), c) ==> ifElse(X, a, c)
    if (onTrueExpression._type === "IfElse" && _checkExpressionsAreEqual(conditionExpression, onTrueExpression.condition)) {
      onTrueExpression = onTrueExpression.onTrue;
    }

    // inline nested if-else expressions: onFalse branch
    // ifElse(X, a, ifElse(X, b, c)) ==> ifElse(X, a, c)
    if (onFalseExpression._type === "IfElse" && _checkExpressionsAreEqual(conditionExpression, onFalseExpression.condition)) {
      onFalseExpression = onFalseExpression.onFalse;
    }

    // (if true then a else b)  ~~> a
    // (if false then a else b) ~~> b
    if (isConstant(conditionExpression)) {
      return conditionExpression.value ? onTrueExpression : onFalseExpression;
    }

    // if (isConstantBoolean(onTrueExpression) || isConstantBoolean(onFalseExpression)) {
    // 	return or(and(condition, onTrueExpression as Expression<boolean>), and(not(condition), onFalseExpression as Expression<boolean>)) as Expression<T>
    // }

    // (if X then a else a) ~~> a
    if (_checkExpressionsAreEqual(onTrueExpression, onFalseExpression)) {
      return onTrueExpression;
    }

    // if X then a else false ~~> X && a
    if (isFalse(onFalseExpression)) {
      return and(conditionExpression, onTrueExpression);
    }

    // if X then a else true ~~> !X || a
    if (isTrue(onFalseExpression)) {
      return or(not(conditionExpression), onTrueExpression);
    }

    // if X then false else a ~~> !X && a
    if (isFalse(onTrueExpression)) {
      return and(not(conditionExpression), onFalseExpression);
    }

    // if X then true else a ~~> X || a
    if (isTrue(onTrueExpression)) {
      return or(conditionExpression, onFalseExpression);
    }
    if (isComplexTypeExpression(condition) || isComplexTypeExpression(onTrue) || isComplexTypeExpression(onFalse)) {
      let pathIdx = 0;
      const myIfElseExpression = formatResult([condition, onTrue, onFalse], "sap.fe.core.formatters.StandardFormatter#ifElse");
      const allParts = [];
      transformRecursively(myIfElseExpression, "PathInModel", constantPath => {
        allParts.push(constantPath);
        return pathInModel(`\$${pathIdx++}`, "$");
      }, true);
      allParts.unshift(constant(JSON.stringify(myIfElseExpression)));
      return formatResult(allParts, "sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression", undefined, true);
    }
    return {
      _type: "IfElse",
      condition: conditionExpression,
      onTrue: onTrueExpression,
      onFalse: onFalseExpression
    };
  }

  /**
   * Checks whether the current expression has a reference to the default model (undefined).
   *
   * @param expression The expression to evaluate
   * @returns `true` if there is a reference to the default context
   */
  _exports.ifElse = ifElse;
  function hasReferenceToDefaultContext(expression) {
    switch (expression._type) {
      case "Constant":
      case "Formatter":
      case "ComplexType":
        return false;
      case "Set":
        return expression.operands.some(hasReferenceToDefaultContext);
      case "PathInModel":
        return expression.modelName === undefined;
      case "Comparison":
        return hasReferenceToDefaultContext(expression.operand1) || hasReferenceToDefaultContext(expression.operand2);
      case "IfElse":
        return hasReferenceToDefaultContext(expression.condition) || hasReferenceToDefaultContext(expression.onTrue) || hasReferenceToDefaultContext(expression.onFalse);
      case "Not":
      case "Truthy":
        return hasReferenceToDefaultContext(expression.operand);
      default:
        return false;
    }
  }
  /**
   * Calls a formatter function to process the parameters.
   * If requireContext is set to true and no context is passed a default context will be added automatically.
   *
   * @template T
   * @template U
   * @param parameters The list of parameter that should match the type and number of the formatter function
   * @param formatterFunction The function to call
   * @param [contextEntityType] If no parameter refers to the context then we use this information to add a reference to the keys from the entity type.
   * @param [ignoreComplexType] Whether to ignore the transgformation to the StandardFormatter or not
   * @returns The corresponding expression
   */
  function formatResult(parameters, formatterFunction, contextEntityType) {
    let ignoreComplexType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    const parameterExpressions = parameters.map(wrapPrimitive);
    if (hasUnresolvableExpression(...parameterExpressions)) {
      return unresolvableExpression;
    }
    if (contextEntityType) {
      // Otherwise, if the context is required and no context is provided make sure to add the default binding
      if (!parameterExpressions.some(hasReferenceToDefaultContext)) {
        contextEntityType.keys.forEach(key => parameterExpressions.push(pathInModel(key.name, "")));
      }
    }
    let functionName = "";
    if (typeof formatterFunction === "string") {
      functionName = formatterFunction;
    } else {
      functionName = formatterFunction.__functionName;
    }
    // FormatterName can be of format sap.fe.core.xxx#methodName to have multiple formatter in one class
    const [formatterClass, formatterName] = functionName.split("#");

    // In some case we also cannot call directly a function because of too complex input, in that case we need to convert to a simpler function call
    if (!ignoreComplexType && (parameterExpressions.some(isComplexTypeExpression) || parameterExpressions.some(isConcatExpression))) {
      let pathIdx = 0;
      const myFormatExpression = formatResult(parameterExpressions, functionName, undefined, true);
      const allParts = [];
      transformRecursively(myFormatExpression, "PathInModel", constantPath => {
        allParts.push(constantPath);
        return pathInModel(`\$${pathIdx++}`, "$");
      });
      allParts.unshift(constant(JSON.stringify(myFormatExpression)));
      return formatResult(allParts, "sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression", undefined, true);
    } else if (!!formatterName && formatterName.length > 0) {
      parameterExpressions.unshift(constant(formatterName));
    }
    return {
      _type: "Formatter",
      fn: formatterClass,
      parameters: parameterExpressions
    };
  }
  _exports.formatResult = formatResult;
  function setUpConstraints(targetMapping, property) {
    var _targetMapping$constr, _targetMapping$constr2, _targetMapping$constr3, _targetMapping$constr4, _property$annotations, _property$annotations2, _targetMapping$constr5, _property$annotations5, _property$annotations6, _property$annotations9, _property$annotations10, _targetMapping$constr6, _targetMapping$constr7;
    const constraints = {};
    if (targetMapping !== null && targetMapping !== void 0 && (_targetMapping$constr = targetMapping.constraints) !== null && _targetMapping$constr !== void 0 && _targetMapping$constr.$Scale && property.scale !== undefined) {
      constraints.scale = property.scale;
    }
    if (targetMapping !== null && targetMapping !== void 0 && (_targetMapping$constr2 = targetMapping.constraints) !== null && _targetMapping$constr2 !== void 0 && _targetMapping$constr2.$Precision && property.precision !== undefined) {
      constraints.precision = property.precision;
    }
    if (targetMapping !== null && targetMapping !== void 0 && (_targetMapping$constr3 = targetMapping.constraints) !== null && _targetMapping$constr3 !== void 0 && _targetMapping$constr3.$MaxLength && property.maxLength !== undefined) {
      constraints.maxLength = property.maxLength;
    }
    if (property.nullable === false) {
      constraints.nullable = false;
    }
    if (targetMapping !== null && targetMapping !== void 0 && (_targetMapping$constr4 = targetMapping.constraints) !== null && _targetMapping$constr4 !== void 0 && _targetMapping$constr4["@Org.OData.Validation.V1.Minimum/$Decimal"] && !isNaN((_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : (_property$annotations2 = _property$annotations.Validation) === null || _property$annotations2 === void 0 ? void 0 : _property$annotations2.Minimum)) {
      var _property$annotations3, _property$annotations4;
      constraints.minimum = `${(_property$annotations3 = property.annotations) === null || _property$annotations3 === void 0 ? void 0 : (_property$annotations4 = _property$annotations3.Validation) === null || _property$annotations4 === void 0 ? void 0 : _property$annotations4.Minimum}`;
    }
    if (targetMapping !== null && targetMapping !== void 0 && (_targetMapping$constr5 = targetMapping.constraints) !== null && _targetMapping$constr5 !== void 0 && _targetMapping$constr5["@Org.OData.Validation.V1.Maximum/$Decimal"] && !isNaN((_property$annotations5 = property.annotations) === null || _property$annotations5 === void 0 ? void 0 : (_property$annotations6 = _property$annotations5.Validation) === null || _property$annotations6 === void 0 ? void 0 : _property$annotations6.Maximum)) {
      var _property$annotations7, _property$annotations8;
      constraints.maximum = `${(_property$annotations7 = property.annotations) === null || _property$annotations7 === void 0 ? void 0 : (_property$annotations8 = _property$annotations7.Validation) === null || _property$annotations8 === void 0 ? void 0 : _property$annotations8.Maximum}`;
    }
    if ((_property$annotations9 = property.annotations) !== null && _property$annotations9 !== void 0 && (_property$annotations10 = _property$annotations9.Common) !== null && _property$annotations10 !== void 0 && _property$annotations10.IsDigitSequence && targetMapping.type === "sap.ui.model.odata.type.String" && targetMapping !== null && targetMapping !== void 0 && (_targetMapping$constr6 = targetMapping.constraints) !== null && _targetMapping$constr6 !== void 0 && _targetMapping$constr6["@com.sap.vocabularies.Common.v1.IsDigitSequence"]) {
      constraints.isDigitSequence = true;
    }
    if (targetMapping !== null && targetMapping !== void 0 && (_targetMapping$constr7 = targetMapping.constraints) !== null && _targetMapping$constr7 !== void 0 && _targetMapping$constr7.$V4) {
      constraints.V4 = true;
    }
    return constraints;
  }

  /**
   * Generates the binding expression for the property, and sets up the formatOptions and constraints.
   *
   * @param property The Property for which we are setting up the binding
   * @param propertyBindingExpression The BindingExpression of the property above. Serves as the basis to which information can be added
   * @param ignoreConstraints Ignore constraints of the property
   * @returns The binding expression for the property with formatOptions and constraints
   */
  _exports.setUpConstraints = setUpConstraints;
  function formatWithTypeInformation(property, propertyBindingExpression) {
    var _outExpression$type;
    let ignoreConstraints = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    const outExpression = propertyBindingExpression;
    if (property._type !== "Property") {
      return outExpression;
    }
    const targetMapping = EDM_TYPE_MAPPING[property.type];
    if (!targetMapping) {
      return outExpression;
    }
    if (!outExpression.formatOptions) {
      outExpression.formatOptions = {};
    }
    outExpression.constraints = {};
    outExpression.type = targetMapping.type;
    if (!ignoreConstraints) {
      outExpression.constraints = setUpConstraints(targetMapping, property);
    }
    if ((outExpression === null || outExpression === void 0 ? void 0 : (_outExpression$type = outExpression.type) === null || _outExpression$type === void 0 ? void 0 : _outExpression$type.indexOf("sap.ui.model.odata.type.Int")) === 0 && (outExpression === null || outExpression === void 0 ? void 0 : outExpression.type) !== "sap.ui.model.odata.type.Int64" || (outExpression === null || outExpression === void 0 ? void 0 : outExpression.type) === "sap.ui.model.odata.type.Double") {
      outExpression.formatOptions = Object.assign(outExpression.formatOptions, {
        parseAsString: false
      });
    }
    if (outExpression.type === "sap.ui.model.odata.type.String") {
      outExpression.formatOptions.parseKeepsEmptyString = true;
      const fiscalType = getFiscalType(property);
      if (fiscalType) {
        outExpression.formatOptions.fiscalType = fiscalType;
        outExpression.type = "sap.fe.core.type.FiscalDate";
      }
    }
    if (outExpression.type === "sap.ui.model.odata.type.Decimal" || (outExpression === null || outExpression === void 0 ? void 0 : outExpression.type) === "sap.ui.model.odata.type.Int64") {
      outExpression.formatOptions = Object.assign(outExpression.formatOptions, {
        emptyString: ""
      });
    }
    return outExpression;
  }
  _exports.formatWithTypeInformation = formatWithTypeInformation;
  const getFiscalType = function (property) {
    var _property$annotations11, _property$annotations12, _property$annotations13, _property$annotations14, _property$annotations15, _property$annotations16, _property$annotations17, _property$annotations18, _property$annotations19, _property$annotations20, _property$annotations21, _property$annotations22, _property$annotations23, _property$annotations24, _property$annotations25, _property$annotations26;
    if ((_property$annotations11 = property.annotations) !== null && _property$annotations11 !== void 0 && (_property$annotations12 = _property$annotations11.Common) !== null && _property$annotations12 !== void 0 && _property$annotations12.IsFiscalYear) {
      return "com.sap.vocabularies.Common.v1.IsFiscalYear";
    }
    if ((_property$annotations13 = property.annotations) !== null && _property$annotations13 !== void 0 && (_property$annotations14 = _property$annotations13.Common) !== null && _property$annotations14 !== void 0 && _property$annotations14.IsFiscalPeriod) {
      return "com.sap.vocabularies.Common.v1.IsFiscalPeriod";
    }
    if ((_property$annotations15 = property.annotations) !== null && _property$annotations15 !== void 0 && (_property$annotations16 = _property$annotations15.Common) !== null && _property$annotations16 !== void 0 && _property$annotations16.IsFiscalYearPeriod) {
      return "com.sap.vocabularies.Common.v1.IsFiscalYearPeriod";
    }
    if ((_property$annotations17 = property.annotations) !== null && _property$annotations17 !== void 0 && (_property$annotations18 = _property$annotations17.Common) !== null && _property$annotations18 !== void 0 && _property$annotations18.IsFiscalQuarter) {
      return "com.sap.vocabularies.Common.v1.IsFiscalQuarter";
    }
    if ((_property$annotations19 = property.annotations) !== null && _property$annotations19 !== void 0 && (_property$annotations20 = _property$annotations19.Common) !== null && _property$annotations20 !== void 0 && _property$annotations20.IsFiscalYearQuarter) {
      return "com.sap.vocabularies.Common.v1.IsFiscalYearQuarter";
    }
    if ((_property$annotations21 = property.annotations) !== null && _property$annotations21 !== void 0 && (_property$annotations22 = _property$annotations21.Common) !== null && _property$annotations22 !== void 0 && _property$annotations22.IsFiscalWeek) {
      return "com.sap.vocabularies.Common.v1.IsFiscalWeek";
    }
    if ((_property$annotations23 = property.annotations) !== null && _property$annotations23 !== void 0 && (_property$annotations24 = _property$annotations23.Common) !== null && _property$annotations24 !== void 0 && _property$annotations24.IsFiscalYearWeek) {
      return "com.sap.vocabularies.Common.v1.IsFiscalYearWeek";
    }
    if ((_property$annotations25 = property.annotations) !== null && _property$annotations25 !== void 0 && (_property$annotations26 = _property$annotations25.Common) !== null && _property$annotations26 !== void 0 && _property$annotations26.IsDayOfFiscalYear) {
      return "com.sap.vocabularies.Common.v1.IsDayOfFiscalYear";
    }
  };

  /**
   * Calls a complex type to process the parameters.
   * If requireContext is set to true and no context is passed, a default context will be added automatically.
   *
   * @template T
   * @template U
   * @param parameters The list of parameters that should match the type for the complex type=
   * @param type The complex type to use
   * @param [contextEntityType] The context entity type to consider
   * @param oFormatOptions
   * @returns The corresponding expression
   */
  _exports.getFiscalType = getFiscalType;
  function addTypeInformation(parameters, type, contextEntityType, oFormatOptions) {
    const parameterExpressions = parameters.map(wrapPrimitive);
    if (hasUnresolvableExpression(...parameterExpressions)) {
      return unresolvableExpression;
    }
    // If there is only one parameter and it is a constant and we don't expect the context then return the constant
    if (parameterExpressions.length === 1 && isConstant(parameterExpressions[0]) && !contextEntityType) {
      return parameterExpressions[0];
    } else if (contextEntityType) {
      // Otherwise, if the context is required and no context is provided make sure to add the default binding
      if (!parameterExpressions.some(hasReferenceToDefaultContext)) {
        contextEntityType.keys.forEach(key => parameterExpressions.push(pathInModel(key.name, "")));
      }
    }
    oFormatOptions = _getComplexTypeFormatOptionsFromFirstParam(parameters[0], oFormatOptions);
    if (type === "sap.ui.model.odata.type.Unit") {
      const uomPath = pathInModel("/##@@requestUnitsOfMeasure");
      uomPath.targetType = "any";
      uomPath.mode = "OneTime";
      parameterExpressions.push(uomPath);
    } else if (type === "sap.ui.model.odata.type.Currency") {
      const currencyPath = pathInModel("/##@@requestCurrencyCodes");
      currencyPath.targetType = "any";
      currencyPath.mode = "OneTime";
      parameterExpressions.push(currencyPath);
    }
    return {
      _type: "ComplexType",
      type: type,
      formatOptions: oFormatOptions || {},
      parameters: {},
      bindingParameters: parameterExpressions
    };
  }

  /**
   * Process the formatOptions for a complexType based on the first parameter.
   *
   * @param param The first parameter of the complex type
   * @param formatOptions Initial formatOptions
   * @returns The modified formatOptions
   */
  _exports.addTypeInformation = addTypeInformation;
  function _getComplexTypeFormatOptionsFromFirstParam(param, formatOptions) {
    var _param$type, _param$constraints;
    // if showMeasure is set to false we want to not parse as string to see the 0
    // we do that also for all bindings because otherwise the mdc Field isn't editable
    if (!(formatOptions && formatOptions.showNumber === false) && ((param === null || param === void 0 ? void 0 : (_param$type = param.type) === null || _param$type === void 0 ? void 0 : _param$type.indexOf("sap.ui.model.odata.type.Int")) === 0 || (param === null || param === void 0 ? void 0 : param.type) === "sap.ui.model.odata.type.Decimal" || (param === null || param === void 0 ? void 0 : param.type) === "sap.ui.model.odata.type.Double")) {
      if ((param === null || param === void 0 ? void 0 : param.type) === "sap.ui.model.odata.type.Int64" || (param === null || param === void 0 ? void 0 : param.type) === "sap.ui.model.odata.type.Decimal") {
        var _formatOptions;
        //sap.ui.model.odata.type.Int64 do not support parseAsString false
        formatOptions = ((_formatOptions = formatOptions) === null || _formatOptions === void 0 ? void 0 : _formatOptions.showMeasure) === false ? {
          emptyString: "",
          showMeasure: false
        } : {
          emptyString: ""
        };
      } else {
        var _formatOptions2;
        formatOptions = ((_formatOptions2 = formatOptions) === null || _formatOptions2 === void 0 ? void 0 : _formatOptions2.showMeasure) === false ? {
          parseAsString: false,
          showMeasure: false
        } : {
          parseAsString: false
        };
      }
    }
    if ((param === null || param === void 0 ? void 0 : (_param$constraints = param.constraints) === null || _param$constraints === void 0 ? void 0 : _param$constraints.nullable) !== false) {
      var _formatOptions3;
      (_formatOptions3 = formatOptions) === null || _formatOptions3 === void 0 ? true : delete _formatOptions3.emptyString;
    }
    return formatOptions;
  }
  /**
   * Function call, optionally with arguments.
   *
   * @param func Function name or reference to function
   * @param parameters Arguments
   * @param on Object to call the function on
   * @returns Expression representing the function call (not the result of the function call!)
   */
  function fn(func, parameters, on) {
    const functionName = typeof func === "string" ? func : func.__functionName;
    return {
      _type: "Function",
      obj: on !== undefined ? wrapPrimitive(on) : undefined,
      fn: functionName,
      parameters: parameters.map(wrapPrimitive)
    };
  }

  /**
   * Shortcut function to determine if a binding value is null, undefined or empty.
   *
   * @param expression
   * @returns A Boolean expression evaluating the fact that the current element is empty
   */
  _exports.fn = fn;
  function isEmpty(expression) {
    const aBindings = [];
    transformRecursively(expression, "PathInModel", expr => {
      aBindings.push(or(equal(expr, ""), equal(expr, undefined), equal(expr, null)));
      return expr;
    });
    return and(...aBindings);
  }
  _exports.isEmpty = isEmpty;
  function concat() {
    for (var _len4 = arguments.length, inExpressions = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
      inExpressions[_key4] = arguments[_key4];
    }
    const expressions = inExpressions.map(wrapPrimitive);
    if (hasUnresolvableExpression(...expressions)) {
      return unresolvableExpression;
    }
    if (expressions.every(isConstant)) {
      return constant(expressions.reduce((concatenated, value) => {
        if (value.value !== undefined) {
          return concatenated + value.value.toString();
        }
        return concatenated;
      }, ""));
    } else if (expressions.some(isComplexTypeExpression)) {
      let pathIdx = 0;
      const myConcatExpression = formatResult(expressions, "sap.fe.core.formatters.StandardFormatter#concat", undefined, true);
      const allParts = [];
      transformRecursively(myConcatExpression, "PathInModel", constantPath => {
        allParts.push(constantPath);
        return pathInModel(`\$${pathIdx++}`, "$");
      });
      allParts.unshift(constant(JSON.stringify(myConcatExpression)));
      return formatResult(allParts, "sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression", undefined, true);
    }
    return {
      _type: "Concat",
      expressions: expressions
    };
  }
  _exports.concat = concat;
  function transformRecursively(inExpression, expressionType, transformFunction) {
    let includeAllExpression = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    let expression = inExpression;
    switch (expression._type) {
      case "Function":
      case "Formatter":
        expression.parameters = expression.parameters.map(parameter => transformRecursively(parameter, expressionType, transformFunction, includeAllExpression));
        break;
      case "Concat":
        expression.expressions = expression.expressions.map(subExpression => transformRecursively(subExpression, expressionType, transformFunction, includeAllExpression));
        expression = concat(...expression.expressions);
        break;
      case "ComplexType":
        expression.bindingParameters = expression.bindingParameters.map(bindingParameter => transformRecursively(bindingParameter, expressionType, transformFunction, includeAllExpression));
        break;
      case "IfElse":
        const onTrue = transformRecursively(expression.onTrue, expressionType, transformFunction, includeAllExpression);
        const onFalse = transformRecursively(expression.onFalse, expressionType, transformFunction, includeAllExpression);
        let condition = expression.condition;
        if (includeAllExpression) {
          condition = transformRecursively(expression.condition, expressionType, transformFunction, includeAllExpression);
        }
        expression = ifElse(condition, onTrue, onFalse);
        break;
      case "Not":
        if (includeAllExpression) {
          const operand = transformRecursively(expression.operand, expressionType, transformFunction, includeAllExpression);
          expression = not(operand);
        }
        break;
      case "Truthy":
        break;
      case "Set":
        if (includeAllExpression) {
          const operands = expression.operands.map(operand => transformRecursively(operand, expressionType, transformFunction, includeAllExpression));
          expression = expression.operator === "||" ? or(...operands) : and(...operands);
        }
        break;
      case "Comparison":
        if (includeAllExpression) {
          const operand1 = transformRecursively(expression.operand1, expressionType, transformFunction, includeAllExpression);
          const operand2 = transformRecursively(expression.operand2, expressionType, transformFunction, includeAllExpression);
          expression = comparison(expression.operator, operand1, operand2);
        }
        break;
      case "Ref":
      case "Length":
      case "PathInModel":
      case "Constant":
      case "EmbeddedBinding":
      case "EmbeddedExpressionBinding":
      case "Unresolvable":
        // Do nothing
        break;
    }
    if (expressionType === expression._type) {
      expression = transformFunction(inExpression);
    }
    return expression;
  }
  _exports.transformRecursively = transformRecursively;
  const needParenthesis = function (expr) {
    return !isConstant(expr) && !isPathInModelExpression(expr) && isBindingToolkitExpression(expr) && expr._type !== "IfElse" && expr._type !== "Function";
  };

  /**
   * Compiles a constant object to a string.
   *
   * @param expr
   * @param isNullable
   * @returns The compiled string
   */
  function compileConstantObject(expr) {
    let isNullable = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    if (isNullable && Object.keys(expr.value).length === 0) {
      return "";
    }
    const objects = expr.value;
    const properties = [];
    Object.keys(objects).forEach(key => {
      const value = objects[key];
      const childResult = compileExpression(value, true, false, isNullable);
      if (childResult && childResult.length > 0) {
        properties.push(`${key}: ${childResult}`);
      }
    });
    return `{${properties.join(", ")}}`;
  }

  /**
   * Compiles a Constant Binding Expression.
   *
   * @param expr
   * @param embeddedInBinding
   * @param isNullable
   * @param doNotStringify
   * @returns The compiled string
   */

  function compileConstant(expr, embeddedInBinding) {
    let isNullable = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    let doNotStringify = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    if (expr.value === null) {
      return doNotStringify ? null : "null";
    }
    if (expr.value === undefined) {
      return doNotStringify ? undefined : "undefined";
    }
    if (typeof expr.value === "object") {
      if (Array.isArray(expr.value)) {
        const entries = expr.value.map(expression => compileExpression(expression, true));
        return `[${entries.join(", ")}]`;
      } else {
        return compileConstantObject(expr, isNullable);
      }
    }
    if (embeddedInBinding) {
      switch (typeof expr.value) {
        case "number":
        case "bigint":
        case "boolean":
          return expr.value.toString();
        case "string":
          return `'${escapeXmlAttribute(expr.value.toString())}'`;
        default:
          return "";
      }
    } else {
      return doNotStringify ? expr.value : expr.value.toString();
    }
  }

  /**
   * Generates the binding string for a Binding expression.
   *
   * @param expressionForBinding The expression to compile
   * @param embeddedInBinding Whether the expression to compile is embedded into another expression
   * @param embeddedSeparator The binding value evaluator ($ or % depending on whether we want to force the type or not)
   * @returns The corresponding expression binding
   */
  _exports.compileConstant = compileConstant;
  function compilePathInModelExpression(expressionForBinding, embeddedInBinding, embeddedSeparator) {
    if (expressionForBinding.type || expressionForBinding.parameters || expressionForBinding.targetType || expressionForBinding.formatOptions || expressionForBinding.constraints) {
      // This is now a complex binding definition, let's prepare for it
      const complexBindingDefinition = {
        path: compilePathInModel(expressionForBinding),
        type: expressionForBinding.type,
        targetType: expressionForBinding.targetType,
        parameters: expressionForBinding.parameters,
        formatOptions: expressionForBinding.formatOptions,
        constraints: expressionForBinding.constraints
      };
      const outBinding = compileExpression(complexBindingDefinition, false, false, true);
      if (embeddedInBinding) {
        return `${embeddedSeparator}${outBinding}`;
      }
      return outBinding;
    } else if (embeddedInBinding) {
      return `${embeddedSeparator}{${compilePathInModel(expressionForBinding)}}`;
    } else {
      return `{${compilePathInModel(expressionForBinding)}}`;
    }
  }
  function compileComplexTypeExpression(expression) {
    if (expression.bindingParameters.length === 1) {
      return `{${compilePathParameter(expression.bindingParameters[0], true)}, type: '${expression.type}'}`;
    }
    let outputEnd = `], type: '${expression.type}'`;
    if (hasElements(expression.formatOptions)) {
      outputEnd += `, formatOptions: ${compileExpression(expression.formatOptions)}`;
    }
    if (hasElements(expression.parameters)) {
      outputEnd += `, parameters: ${compileExpression(expression.parameters)}`;
    }
    outputEnd += "}";
    return `{mode:'TwoWay', parts:[${expression.bindingParameters.map(param => compilePathParameter(param)).join(",")}${outputEnd}`;
  }

  /**
   * Wrap the compiled binding string as required depending on its context.
   *
   * @param expression The compiled expression
   * @param embeddedInBinding True if the compiled expression is to be embedded in a binding
   * @param parenthesisRequired True if the embedded binding needs to be wrapped in parethesis so that it is evaluated as one
   * @returns Finalized compiled expression
   */
  function wrapBindingExpression(expression, embeddedInBinding) {
    let parenthesisRequired = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    if (embeddedInBinding) {
      if (parenthesisRequired) {
        return `(${expression})`;
      } else {
        return expression;
      }
    } else {
      return `{= ${expression}}`;
    }
  }

  /**
   * Compile an expression into an expression binding.
   *
   * @template T The target type
   * @param expression The expression to compile
   * @param embeddedInBinding Whether the expression to compile is embedded into another expression
   * @param keepTargetType Keep the target type of the embedded bindings instead of casting them to any
   * @param isNullable Whether binding expression can resolve to empty string or not
   * @returns The corresponding expression binding
   */
  function compileExpression(expression) {
    let embeddedInBinding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let keepTargetType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    let isNullable = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    const expr = wrapPrimitive(expression);
    const embeddedSeparator = keepTargetType ? "$" : "%";
    switch (expr._type) {
      case "Unresolvable":
        return undefined;
      case "Constant":
        return compileConstant(expr, embeddedInBinding, isNullable);
      case "Ref":
        return expr.ref || "null";
      case "Function":
        const argumentString = `${expr.parameters.map(arg => compileExpression(arg, true)).join(", ")}`;
        return expr.obj === undefined ? `${expr.fn}(${argumentString})` : `${compileExpression(expr.obj, true)}.${expr.fn}(${argumentString})`;
      case "EmbeddedExpressionBinding":
        return embeddedInBinding ? `(${expr.value.substring(2, expr.value.length - 1)})` : `${expr.value}`;
      case "EmbeddedBinding":
        return embeddedInBinding ? `${embeddedSeparator}${expr.value}` : `${expr.value}`;
      case "PathInModel":
        return compilePathInModelExpression(expr, embeddedInBinding, embeddedSeparator);
      case "Comparison":
        const comparisonExpression = compileComparisonExpression(expr);
        return wrapBindingExpression(comparisonExpression, embeddedInBinding);
      case "IfElse":
        const ifElseExpression = `${compileExpression(expr.condition, true)} ? ${compileExpression(expr.onTrue, true)} : ${compileExpression(expr.onFalse, true)}`;
        return wrapBindingExpression(ifElseExpression, embeddedInBinding, true);
      case "Set":
        const setExpression = expr.operands.map(operand => compileExpression(operand, true)).join(` ${expr.operator} `);
        return wrapBindingExpression(setExpression, embeddedInBinding, true);
      case "Concat":
        const concatExpression = expr.expressions.map(nestedExpression => compileExpression(nestedExpression, true, true)).join(" + ");
        return wrapBindingExpression(concatExpression, embeddedInBinding);
      case "Length":
        const lengthExpression = `${compileExpression(expr.pathInModel, true)}.length`;
        return wrapBindingExpression(lengthExpression, embeddedInBinding);
      case "Not":
        const notExpression = `!${compileExpression(expr.operand, true)}`;
        return wrapBindingExpression(notExpression, embeddedInBinding);
      case "Truthy":
        const truthyExpression = `!!${compileExpression(expr.operand, true)}`;
        return wrapBindingExpression(truthyExpression, embeddedInBinding);
      case "Formatter":
        const formatterExpression = compileFormatterExpression(expr);
        return embeddedInBinding ? `\$${formatterExpression}` : formatterExpression;
      case "ComplexType":
        const complexTypeExpression = compileComplexTypeExpression(expr);
        return embeddedInBinding ? `\$${complexTypeExpression}` : complexTypeExpression;
      default:
        return "";
    }
  }

  /**
   * Compile a comparison expression.
   *
   * @param expression The comparison expression.
   * @returns The compiled expression. Needs wrapping before it can be used as an expression binding.
   */
  _exports.compileExpression = compileExpression;
  function compileComparisonExpression(expression) {
    function compileOperand(operand) {
      const compiledOperand = compileExpression(operand, true) ?? "undefined";
      return wrapBindingExpression(compiledOperand, true, needParenthesis(operand));
    }
    return `${compileOperand(expression.operand1)} ${expression.operator} ${compileOperand(expression.operand2)}`;
  }

  /**
   * Compile a formatter expression.
   *
   * @param expression The formatter expression.
   * @returns The compiled expression.
   */
  function compileFormatterExpression(expression) {
    if (expression.parameters.length === 1) {
      return `{${compilePathParameter(expression.parameters[0], true)}, formatter: '${expression.fn}'}`;
    } else {
      const parts = expression.parameters.map(param => {
        if (param._type === "ComplexType") {
          return compileComplexTypeExpression(param);
        } else {
          return compilePathParameter(param);
        }
      });
      return `{parts: [${parts.join(", ")}], formatter: '${expression.fn}'}`;
    }
  }

  /**
   * Compile the path parameter of a formatter call.
   *
   * @param expression The binding part to evaluate
   * @param singlePath Whether there is one or multiple path to consider
   * @returns The string snippet to include in the overall binding definition
   */
  function compilePathParameter(expression) {
    let singlePath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let outValue = "";
    if (expression._type === "Constant") {
      if (expression.value === undefined) {
        // Special case otherwise the JSTokenizer complains about incorrect content
        outValue = `value: 'undefined'`;
      } else {
        outValue = `value: ${compileConstant(expression, true)}`;
      }
    } else if (expression._type === "PathInModel") {
      outValue = `path: '${compilePathInModel(expression)}'`;
      outValue += expression.type ? `, type: '${expression.type}'` : `, targetType: 'any'`;
      if (hasElements(expression.mode)) {
        outValue += `, mode: '${compileExpression(expression.mode)}'`;
      }
      if (hasElements(expression.constraints)) {
        outValue += `, constraints: ${compileExpression(expression.constraints)}`;
      }
      if (hasElements(expression.formatOptions)) {
        outValue += `, formatOptions: ${compileExpression(expression.formatOptions)}`;
      }
      if (hasElements(expression.parameters)) {
        outValue += `, parameters: ${compileExpression(expression.parameters)}`;
      }
    } else {
      return "";
    }
    return singlePath ? outValue : `{${outValue}}`;
  }
  function hasElements(obj) {
    return obj && Object.keys(obj).length > 0;
  }

  /**
   * Compile a binding expression path.
   *
   * @param expression The expression to compile.
   * @returns The compiled path.
   */
  function compilePathInModel(expression) {
    return `${expression.modelName ? `${expression.modelName}>` : ""}${expression.path}`;
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/BindingToolkit", ["./AnnotationEnum"],function(e){"use strict";var n={};var t=e.resolveEnumValue;const r={"Edm.Boolean":{type:"sap.ui.model.odata.type.Boolean"},"Edm.Byte":{type:"sap.ui.model.odata.type.Byte"},"Edm.Date":{type:"sap.ui.model.odata.type.Date"},"Edm.DateTimeOffset":{constraints:{$Precision:"precision",$V4:"V4"},type:"sap.ui.model.odata.type.DateTimeOffset"},"Edm.Decimal":{constraints:{"@Org.OData.Validation.V1.Minimum/$Decimal":"minimum","@Org.OData.Validation.V1.Minimum@Org.OData.Validation.V1.Exclusive":"minimumExclusive","@Org.OData.Validation.V1.Maximum/$Decimal":"maximum","@Org.OData.Validation.V1.Maximum@Org.OData.Validation.V1.Exclusive":"maximumExclusive",$Precision:"precision",$Scale:"scale"},type:"sap.ui.model.odata.type.Decimal"},"Edm.Double":{type:"sap.ui.model.odata.type.Double"},"Edm.Guid":{type:"sap.ui.model.odata.type.Guid"},"Edm.Int16":{type:"sap.ui.model.odata.type.Int16"},"Edm.Int32":{type:"sap.ui.model.odata.type.Int32"},"Edm.Int64":{type:"sap.ui.model.odata.type.Int64"},"Edm.SByte":{type:"sap.ui.model.odata.type.SByte"},"Edm.Single":{type:"sap.ui.model.odata.type.Single"},"Edm.Stream":{type:"sap.ui.model.odata.type.Stream"},"Edm.Binary":{type:"sap.ui.model.odata.type.Stream"},"Edm.String":{constraints:{"@com.sap.vocabularies.Common.v1.IsDigitSequence":"isDigitSequence",$MaxLength:"maxLength",$Nullable:"nullable"},type:"sap.ui.model.odata.type.String"},"Edm.TimeOfDay":{constraints:{$Precision:"precision"},type:"sap.ui.model.odata.type.TimeOfDay"}};n.EDM_TYPE_MAPPING=r;const a={_type:"Unresolvable"};n.unresolvableExpression=a;function o(e){return e.replace(/'/g,"\\'")}function i(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++){n[t]=arguments[t]}return n.find(e=>e._type==="Unresolvable")!==undefined}n.hasUnresolvableExpression=i;function s(e,n){if(e._type!==n._type){return false}switch(e._type){case"Unresolvable":return false;case"Constant":case"EmbeddedBinding":case"EmbeddedExpressionBinding":return e.value===n.value;case"Not":return s(e.operand,n.operand);case"Truthy":return s(e.operand,n.operand);case"Set":return e.operator===n.operator&&e.operands.length===n.operands.length&&e.operands.every(e=>n.operands.some(n=>s(e,n)));case"IfElse":return s(e.condition,n.condition)&&s(e.onTrue,n.onTrue)&&s(e.onFalse,n.onFalse);case"Comparison":return e.operator===n.operator&&s(e.operand1,n.operand1)&&s(e.operand2,n.operand2);case"Concat":const t=e.expressions;const r=n.expressions;if(t.length!==r.length){return false}return t.every((e,n)=>s(e,r[n]));case"Length":return s(e.pathInModel,n.pathInModel);case"PathInModel":return e.modelName===n.modelName&&e.path===n.path&&e.targetEntitySet===n.targetEntitySet;case"Formatter":return e.fn===n.fn&&e.parameters.length===n.parameters.length&&e.parameters.every((e,t)=>s(n.parameters[t],e));case"ComplexType":return e.type===n.type&&e.bindingParameters.length===n.bindingParameters.length&&e.bindingParameters.every((e,t)=>s(n.bindingParameters[t],e));case"Function":const a=n;if(e.obj===undefined||a.obj===undefined){return e.obj===a}return e.fn===a.fn&&s(e.obj,a.obj)&&e.parameters.length===a.parameters.length&&e.parameters.every((e,n)=>s(a.parameters[n],e));case"Ref":return e.ref===n.ref}return false}n._checkExpressionsAreEqual=s;function u(e){return e.operands.reduce((n,t)=>{const r=t._type==="Set"&&t.operator===e.operator?t.operands:[t];r.forEach(e=>{if(n.operands.every(n=>!s(n,e))){n.operands.push(e)}});return n},{_type:"Set",operator:e.operator,operands:[]})}function l(e){const n=e.map(f);return e.some((e,t)=>{for(let r=t+1;r<n.length;r++){if(s(e,n[r])){return true}}return false})}function p(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++){n[t]=arguments[t]}const r=u({_type:"Set",operator:"&&",operands:n.map($)}).operands;if(i(...r)){return a}let o=false;const s=r.filter(e=>{if(I(e)){o=true}return!E(e)});if(o){return v(false)}else if(s.length===0){const e=r.reduce((e,n)=>e&&O(n),true);return v(e)}else if(s.length===1){return s[0]}else if(l(s)){return v(false)}else{return{_type:"Set",operator:"&&",operands:s}}}n.and=p;function d(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++){n[t]=arguments[t]}const r=u({_type:"Set",operator:"||",operands:n.map($)}).operands;if(i(...r)){return a}let o=false;const s=r.filter(e=>{if(O(e)){o=true}return!E(e)||e.value});if(o){return v(true)}else if(s.length===0){const e=r.reduce((e,n)=>e&&O(n),true);return v(e)}else if(s.length===1){return s[0]}else if(l(s)){return v(true)}else{return{_type:"Set",operator:"||",operands:s}}}n.or=d;function f(e){e=$(e);if(i(e)){return a}else if(E(e)){return v(!e.value)}else if(typeof e==="object"&&e._type==="Set"&&e.operator==="||"&&e.operands.every(e=>E(e)||P(e))){return p(...e.operands.map(e=>f(e)))}else if(typeof e==="object"&&e._type==="Set"&&e.operator==="&&"&&e.operands.every(e=>E(e)||P(e))){return d(...e.operands.map(e=>f(e)))}else if(P(e)){switch(e.operator){case"!==":return{...e,operator:"==="};case"<":return{...e,operator:">="};case"<=":return{...e,operator:">"};case"===":return{...e,operator:"!=="};case">":return{...e,operator:"<="};case">=":return{...e,operator:"<"}}}else if(e._type==="Not"){return e.operand}return{_type:"Not",operand:e}}n.not=f;function c(e){if(E(e)){return v(!!e.value)}else{return{_type:"Truthy",operand:e}}}n.isTruthy=c;function m(e,n){let t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];let r=arguments.length>3?arguments[3]:undefined;return y(e,n,t,r)}n.bindingExpression=m;function y(e,n){let t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];let r=arguments.length>3?arguments[3]:undefined;if(e===undefined){return a}let o;if(r){o=r(e);if(o===undefined){return a}}else{const n=t.concat();n.push(e);o=n.join("/")}return{_type:"PathInModel",modelName:n,path:o}}n.pathInModel=y;function v(e){let n;if(typeof e==="object"&&e!==null&&e!==undefined){if(Array.isArray(e)){n=e.map($)}else if(F(e)){n=e.valueOf()}else{n=Object.entries(e).reduce((e,n)=>{let[t,r]=n;const a=$(r);if(a._type!=="Constant"||a.value!==undefined){e[t]=a}return e},{})}}else{n=e}return{_type:"Constant",value:n}}n.constant=v;function h(e,n){if(e!==undefined&&typeof e==="string"&&e.startsWith("{")){const n=/^{(.*)>(.+)}$/;const t=n.exec(e);if(e.startsWith("{=")){return{_type:"EmbeddedExpressionBinding",value:e}}else if(t){return y(t[2]||"",t[1]||undefined)}else{return{_type:"EmbeddedBinding",value:e}}}else if(n==="boolean"&&typeof e==="string"&&(e==="true"||e==="false")){return v(e==="true")}else if(n==="number"&&typeof e==="string"&&(!isNaN(Number(e))||e==="NaN")){return v(Number(e))}else{return v(e)}}n.resolveBindingString=h;function g(e){return{_type:"Ref",ref:e}}n.ref=g;function $(e){if(b(e)){return e}return v(e)}function b(e){return(e===null||e===void 0?void 0:e._type)!==undefined}n.isBindingToolkitExpression=b;function E(e){return typeof e!=="object"||e._type==="Constant"}n.isConstant=E;function O(e){return E(e)&&e.value===true}function I(e){return E(e)&&e.value===false}function _(e){return(e===null||e===void 0?void 0:e._type)==="PathInModel"}n.isPathInModelExpression=_;function x(e){return(e===null||e===void 0?void 0:e._type)==="ComplexType"}n.isComplexTypeExpression=x;function C(e){return(e===null||e===void 0?void 0:e._type)==="Concat"}function P(e){return e._type==="Comparison"}function S(e){const n=e;return(n===null||n===void 0?void 0:n._type)==="Constant"&&(n===null||n===void 0?void 0:n.value)===undefined}n.isUndefinedExpression=S;function F(e){switch(e.constructor.name){case"String":case"Number":case"Boolean":return true;default:return false}}function T(e){return typeof e==="object"&&!F(e)}function N(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let t=arguments.length>2?arguments[2]:undefined;let r=arguments.length>3?arguments[3]:undefined;return M(e,n,t,r)}n.annotationExpression=N;function M(e){var n;let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let r=arguments.length>2?arguments[2]:undefined;let o=arguments.length>3?arguments[3]:undefined;if(e===undefined){return $(r)}e=(n=e)===null||n===void 0?void 0:n.valueOf();if(!T(e)){return v(e)}switch(e.type){case"Path":return y(e.path,undefined,t,o);case"If":return D(e.If,t,o);case"Not":return f(w(e.Not,t,o));case"Eq":return L(w(e.Eq[0],t,o),w(e.Eq[1],t,o));case"Ne":return k(w(e.Ne[0],t,o),w(e.Ne[1],t,o));case"Gt":return B(w(e.Gt[0],t,o),w(e.Gt[1],t,o));case"Ge":return q(w(e.Ge[0],t,o),w(e.Ge[1],t,o));case"Lt":return U(w(e.Lt[0],t,o),w(e.Lt[1],t,o));case"Le":return G(w(e.Le[0],t,o),w(e.Le[1],t,o));case"Or":return d(...e.Or.map(function(e){return w(e,t,o)}));case"And":return p(...e.And.map(function(e){return w(e,t,o)}));case"Apply":return A(e,t,o)}return a}n.getExpressionFromAnnotation=M;function w(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let r=arguments.length>2?arguments[2]:undefined;if(e===null||typeof e!=="object"){return v(e)}else if(e.hasOwnProperty("$Or")){return d(...e.$Or.map(function(e){return w(e,n,r)}))}else if(e.hasOwnProperty("$And")){return p(...e.$And.map(function(e){return w(e,n,r)}))}else if(e.hasOwnProperty("$Not")){return f(w(e.$Not,n,r))}else if(e.hasOwnProperty("$Eq")){return L(w(e.$Eq[0],n,r),w(e.$Eq[1],n,r))}else if(e.hasOwnProperty("$Ne")){return k(w(e.$Ne[0],n,r),w(e.$Ne[1],n,r))}else if(e.hasOwnProperty("$Gt")){return B(w(e.$Gt[0],n,r),w(e.$Gt[1],n,r))}else if(e.hasOwnProperty("$Ge")){return q(w(e.$Ge[0],n,r),w(e.$Ge[1],n,r))}else if(e.hasOwnProperty("$Lt")){return U(w(e.$Lt[0],n,r),w(e.$Lt[1],n,r))}else if(e.hasOwnProperty("$Le")){return G(w(e.$Le[0],n,r),w(e.$Le[1],n,r))}else if(e.hasOwnProperty("$Path")){return y(e.$Path,undefined,n,r)}else if(e.hasOwnProperty("$Apply")){return M({type:"Apply",Function:e.$Function,Apply:e.$Apply},n,undefined,r)}else if(e.hasOwnProperty("$If")){return M({type:"If",If:e.$If},n,undefined,r)}else if(e.hasOwnProperty("$EnumMember")){return v(t(e.$EnumMember))}return v(false)}function D(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let t=arguments.length>2?arguments[2]:undefined;return Y(w(e[0],n,t),w(e[1],n,t),w(e[2],n,t))}n.annotationIfExpression=D;function A(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let t=arguments.length>2?arguments[2]:undefined;switch(e.Function){case"odata.concat":return ee(...e.Apply.map(e=>{let r=e;if(e.hasOwnProperty("$Path")){r={type:"Path",path:e.$Path}}else if(e.hasOwnProperty("$If")){r={type:"If",If:e.$If}}else if(e.hasOwnProperty("$Apply")){r={type:"Apply",Function:e.$Function,Apply:e.$Apply}}return M(r,n,undefined,t)}))}return a}n.annotationApplyExpression=A;function j(e,n,t){const r=$(n);const o=$(t);if(i(r,o)){return a}if(E(r)&&E(o)){switch(e){case"!==":return v(r.value!==o.value);case"===":return v(r.value===o.value);case"<":return v(r.value<o.value);case"<=":return v(r.value<=o.value);case">":return v(r.value>o.value);case">=":return v(r.value>=o.value)}}else{return{_type:"Comparison",operator:e,operand1:r,operand2:o}}}function V(e){if(e._type==="Unresolvable"){return e}return{_type:"Length",pathInModel:e}}n.length=V;function L(e,n){const t=$(e);const r=$(n);if(i(t,r)){return a}if(s(t,r)){return v(true)}function o(e,n){if(e._type==="Comparison"&&O(n)){return e}else if(e._type==="Comparison"&&I(n)){return f(e)}else if(e._type==="IfElse"&&s(e.onTrue,n)){return d(e.condition,L(e.onFalse,n))}else if(e._type==="IfElse"&&s(e.onFalse,n)){return d(f(e.condition),L(e.onTrue,n))}else if(e._type==="IfElse"&&E(e.onTrue)&&E(e.onFalse)&&E(n)&&!s(e.onTrue,n)&&!s(e.onFalse,n)){return v(false)}return undefined}const u=o(t,r)??o(r,t);return u??j("===",t,r)}n.equal=L;function k(e,n){return f(L(e,n))}n.notEqual=k;function q(e,n){return j(">=",e,n)}n.greaterOrEqual=q;function B(e,n){return j(">",e,n)}n.greaterThan=B;function G(e,n){return j("<=",e,n)}n.lessOrEqual=G;function U(e,n){return j("<",e,n)}n.lessThan=U;function Y(e,n,t){let r=$(e);let o=$(n);let u=$(t);if(i(r,o,u)){return a}if(r._type==="Not"){[o,u]=[u,o];r=f(r)}if(o._type==="IfElse"&&s(r,o.condition)){o=o.onTrue}if(u._type==="IfElse"&&s(r,u.condition)){u=u.onFalse}if(E(r)){return r.value?o:u}if(s(o,u)){return o}if(I(u)){return p(r,o)}if(O(u)){return d(f(r),o)}if(I(o)){return p(f(r),u)}if(O(o)){return d(r,u)}if(x(e)||x(n)||x(t)){let r=0;const a=R([e,n,t],"sap.fe.core.formatters.StandardFormatter#ifElse");const o=[];ne(a,"PathInModel",e=>{o.push(e);return y(`$${r++}`,"$")},true);o.unshift(v(JSON.stringify(a)));return R(o,"sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression",undefined,true)}return{_type:"IfElse",condition:r,onTrue:o,onFalse:u}}n.ifElse=Y;function W(e){switch(e._type){case"Constant":case"Formatter":case"ComplexType":return false;case"Set":return e.operands.some(W);case"PathInModel":return e.modelName===undefined;case"Comparison":return W(e.operand1)||W(e.operand2);case"IfElse":return W(e.condition)||W(e.onTrue)||W(e.onFalse);case"Not":case"Truthy":return W(e.operand);default:return false}}function R(e,n,t){let r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const o=e.map($);if(i(...o)){return a}if(t){if(!o.some(W)){t.keys.forEach(e=>o.push(y(e.name,"")))}}let s="";if(typeof n==="string"){s=n}else{s=n.__functionName}const[u,l]=s.split("#");if(!r&&(o.some(x)||o.some(C))){let e=0;const n=R(o,s,undefined,true);const t=[];ne(n,"PathInModel",n=>{t.push(n);return y(`$${e++}`,"$")});t.unshift(v(JSON.stringify(n)));return R(t,"sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression",undefined,true)}else if(!!l&&l.length>0){o.unshift(v(l))}return{_type:"Formatter",fn:u,parameters:o}}n.formatResult=R;function Q(e,n){var t,r,a,o,i,s,u,l,p,d,f,c,m;const y={};if(e!==null&&e!==void 0&&(t=e.constraints)!==null&&t!==void 0&&t.$Scale&&n.scale!==undefined){y.scale=n.scale}if(e!==null&&e!==void 0&&(r=e.constraints)!==null&&r!==void 0&&r.$Precision&&n.precision!==undefined){y.precision=n.precision}if(e!==null&&e!==void 0&&(a=e.constraints)!==null&&a!==void 0&&a.$MaxLength&&n.maxLength!==undefined){y.maxLength=n.maxLength}if(n.nullable===false){y.nullable=false}if(e!==null&&e!==void 0&&(o=e.constraints)!==null&&o!==void 0&&o["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN((i=n.annotations)===null||i===void 0?void 0:(s=i.Validation)===null||s===void 0?void 0:s.Minimum)){var v,h;y.minimum=`${(v=n.annotations)===null||v===void 0?void 0:(h=v.Validation)===null||h===void 0?void 0:h.Minimum}`}if(e!==null&&e!==void 0&&(u=e.constraints)!==null&&u!==void 0&&u["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN((l=n.annotations)===null||l===void 0?void 0:(p=l.Validation)===null||p===void 0?void 0:p.Maximum)){var g,$;y.maximum=`${(g=n.annotations)===null||g===void 0?void 0:($=g.Validation)===null||$===void 0?void 0:$.Maximum}`}if((d=n.annotations)!==null&&d!==void 0&&(f=d.Common)!==null&&f!==void 0&&f.IsDigitSequence&&e.type==="sap.ui.model.odata.type.String"&&e!==null&&e!==void 0&&(c=e.constraints)!==null&&c!==void 0&&c["@com.sap.vocabularies.Common.v1.IsDigitSequence"]){y.isDigitSequence=true}if(e!==null&&e!==void 0&&(m=e.constraints)!==null&&m!==void 0&&m.$V4){y.V4=true}return y}n.setUpConstraints=Q;function J(e,n){var t;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const o=n;if(e._type!=="Property"){return o}const i=r[e.type];if(!i){return o}if(!o.formatOptions){o.formatOptions={}}o.constraints={};o.type=i.type;if(!a){o.constraints=Q(i,e)}if((o===null||o===void 0?void 0:(t=o.type)===null||t===void 0?void 0:t.indexOf("sap.ui.model.odata.type.Int"))===0&&(o===null||o===void 0?void 0:o.type)!=="sap.ui.model.odata.type.Int64"||(o===null||o===void 0?void 0:o.type)==="sap.ui.model.odata.type.Double"){o.formatOptions=Object.assign(o.formatOptions,{parseAsString:false})}if(o.type==="sap.ui.model.odata.type.String"){o.formatOptions.parseKeepsEmptyString=true;const n=K(e);if(n){o.formatOptions.fiscalType=n;o.type="sap.fe.core.type.FiscalDate"}}if(o.type==="sap.ui.model.odata.type.Decimal"||(o===null||o===void 0?void 0:o.type)==="sap.ui.model.odata.type.Int64"){o.formatOptions=Object.assign(o.formatOptions,{emptyString:""})}return o}n.formatWithTypeInformation=J;const K=function(e){var n,t,r,a,o,i,s,u,l,p,d,f,c,m,y,v;if((n=e.annotations)!==null&&n!==void 0&&(t=n.Common)!==null&&t!==void 0&&t.IsFiscalYear){return"com.sap.vocabularies.Common.v1.IsFiscalYear"}if((r=e.annotations)!==null&&r!==void 0&&(a=r.Common)!==null&&a!==void 0&&a.IsFiscalPeriod){return"com.sap.vocabularies.Common.v1.IsFiscalPeriod"}if((o=e.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&i.IsFiscalYearPeriod){return"com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"}if((s=e.annotations)!==null&&s!==void 0&&(u=s.Common)!==null&&u!==void 0&&u.IsFiscalQuarter){return"com.sap.vocabularies.Common.v1.IsFiscalQuarter"}if((l=e.annotations)!==null&&l!==void 0&&(p=l.Common)!==null&&p!==void 0&&p.IsFiscalYearQuarter){return"com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"}if((d=e.annotations)!==null&&d!==void 0&&(f=d.Common)!==null&&f!==void 0&&f.IsFiscalWeek){return"com.sap.vocabularies.Common.v1.IsFiscalWeek"}if((c=e.annotations)!==null&&c!==void 0&&(m=c.Common)!==null&&m!==void 0&&m.IsFiscalYearWeek){return"com.sap.vocabularies.Common.v1.IsFiscalYearWeek"}if((y=e.annotations)!==null&&y!==void 0&&(v=y.Common)!==null&&v!==void 0&&v.IsDayOfFiscalYear){return"com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"}};n.getFiscalType=K;function z(e,n,t,r){const o=e.map($);if(i(...o)){return a}if(o.length===1&&E(o[0])&&!t){return o[0]}else if(t){if(!o.some(W)){t.keys.forEach(e=>o.push(y(e.name,"")))}}r=H(e[0],r);if(n==="sap.ui.model.odata.type.Unit"){const e=y("/##@@requestUnitsOfMeasure");e.targetType="any";e.mode="OneTime";o.push(e)}else if(n==="sap.ui.model.odata.type.Currency"){const e=y("/##@@requestCurrencyCodes");e.targetType="any";e.mode="OneTime";o.push(e)}return{_type:"ComplexType",type:n,formatOptions:r||{},parameters:{},bindingParameters:o}}n.addTypeInformation=z;function H(e,n){var t,r;if(!(n&&n.showNumber===false)&&((e===null||e===void 0?void 0:(t=e.type)===null||t===void 0?void 0:t.indexOf("sap.ui.model.odata.type.Int"))===0||(e===null||e===void 0?void 0:e.type)==="sap.ui.model.odata.type.Decimal"||(e===null||e===void 0?void 0:e.type)==="sap.ui.model.odata.type.Double")){if((e===null||e===void 0?void 0:e.type)==="sap.ui.model.odata.type.Int64"||(e===null||e===void 0?void 0:e.type)==="sap.ui.model.odata.type.Decimal"){var a;n=((a=n)===null||a===void 0?void 0:a.showMeasure)===false?{emptyString:"",showMeasure:false}:{emptyString:""}}else{var o;n=((o=n)===null||o===void 0?void 0:o.showMeasure)===false?{parseAsString:false,showMeasure:false}:{parseAsString:false}}}if((e===null||e===void 0?void 0:(r=e.constraints)===null||r===void 0?void 0:r.nullable)!==false){var i;(i=n)===null||i===void 0?true:delete i.emptyString}return n}function X(e,n,t){const r=typeof e==="string"?e:e.__functionName;return{_type:"Function",obj:t!==undefined?$(t):undefined,fn:r,parameters:n.map($)}}n.fn=X;function Z(e){const n=[];ne(e,"PathInModel",e=>{n.push(d(L(e,""),L(e,undefined),L(e,null)));return e});return p(...n)}n.isEmpty=Z;function ee(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++){n[t]=arguments[t]}const r=n.map($);if(i(...r)){return a}if(r.every(E)){return v(r.reduce((e,n)=>{if(n.value!==undefined){return e+n.value.toString()}return e},""))}else if(r.some(x)){let e=0;const n=R(r,"sap.fe.core.formatters.StandardFormatter#concat",undefined,true);const t=[];ne(n,"PathInModel",n=>{t.push(n);return y(`$${e++}`,"$")});t.unshift(v(JSON.stringify(n)));return R(t,"sap.fe.core.formatters.StandardFormatter#evaluateComplexExpression",undefined,true)}return{_type:"Concat",expressions:r}}n.concat=ee;function ne(e,n,t){let r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let a=e;switch(a._type){case"Function":case"Formatter":a.parameters=a.parameters.map(e=>ne(e,n,t,r));break;case"Concat":a.expressions=a.expressions.map(e=>ne(e,n,t,r));a=ee(...a.expressions);break;case"ComplexType":a.bindingParameters=a.bindingParameters.map(e=>ne(e,n,t,r));break;case"IfElse":const e=ne(a.onTrue,n,t,r);const o=ne(a.onFalse,n,t,r);let i=a.condition;if(r){i=ne(a.condition,n,t,r)}a=Y(i,e,o);break;case"Not":if(r){const e=ne(a.operand,n,t,r);a=f(e)}break;case"Truthy":break;case"Set":if(r){const e=a.operands.map(e=>ne(e,n,t,r));a=a.operator==="||"?d(...e):p(...e)}break;case"Comparison":if(r){const e=ne(a.operand1,n,t,r);const o=ne(a.operand2,n,t,r);a=j(a.operator,e,o)}break;case"Ref":case"Length":case"PathInModel":case"Constant":case"EmbeddedBinding":case"EmbeddedExpressionBinding":case"Unresolvable":break}if(n===a._type){a=t(e)}return a}n.transformRecursively=ne;const te=function(e){return!E(e)&&!_(e)&&b(e)&&e._type!=="IfElse"&&e._type!=="Function"};function re(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(n&&Object.keys(e.value).length===0){return""}const t=e.value;const r=[];Object.keys(t).forEach(e=>{const a=t[e];const o=ue(a,true,false,n);if(o&&o.length>0){r.push(`${e}: ${o}`)}});return`{${r.join(", ")}}`}function ae(e,n){let t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(e.value===null){return r?null:"null"}if(e.value===undefined){return r?undefined:"undefined"}if(typeof e.value==="object"){if(Array.isArray(e.value)){const n=e.value.map(e=>ue(e,true));return`[${n.join(", ")}]`}else{return re(e,t)}}if(n){switch(typeof e.value){case"number":case"bigint":case"boolean":return e.value.toString();case"string":return`'${o(e.value.toString())}'`;default:return""}}else{return r?e.value:e.value.toString()}}n.compileConstant=ae;function oe(e,n,t){if(e.type||e.parameters||e.targetType||e.formatOptions||e.constraints){const r={path:ce(e),type:e.type,targetType:e.targetType,parameters:e.parameters,formatOptions:e.formatOptions,constraints:e.constraints};const a=ue(r,false,false,true);if(n){return`${t}${a}`}return a}else if(n){return`${t}{${ce(e)}}`}else{return`{${ce(e)}}`}}function ie(e){if(e.bindingParameters.length===1){return`{${de(e.bindingParameters[0],true)}, type: '${e.type}'}`}let n=`], type: '${e.type}'`;if(fe(e.formatOptions)){n+=`, formatOptions: ${ue(e.formatOptions)}`}if(fe(e.parameters)){n+=`, parameters: ${ue(e.parameters)}`}n+="}";return`{mode:'TwoWay', parts:[${e.bindingParameters.map(e=>de(e)).join(",")}${n}`}function se(e,n){let t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(n){if(t){return`(${e})`}else{return e}}else{return`{= ${e}}`}}function ue(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const a=$(e);const o=t?"$":"%";switch(a._type){case"Unresolvable":return undefined;case"Constant":return ae(a,n,r);case"Ref":return a.ref||"null";case"Function":const e=`${a.parameters.map(e=>ue(e,true)).join(", ")}`;return a.obj===undefined?`${a.fn}(${e})`:`${ue(a.obj,true)}.${a.fn}(${e})`;case"EmbeddedExpressionBinding":return n?`(${a.value.substring(2,a.value.length-1)})`:`${a.value}`;case"EmbeddedBinding":return n?`${o}${a.value}`:`${a.value}`;case"PathInModel":return oe(a,n,o);case"Comparison":const t=le(a);return se(t,n);case"IfElse":const i=`${ue(a.condition,true)} ? ${ue(a.onTrue,true)} : ${ue(a.onFalse,true)}`;return se(i,n,true);case"Set":const s=a.operands.map(e=>ue(e,true)).join(` ${a.operator} `);return se(s,n,true);case"Concat":const u=a.expressions.map(e=>ue(e,true,true)).join(" + ");return se(u,n);case"Length":const l=`${ue(a.pathInModel,true)}.length`;return se(l,n);case"Not":const p=`!${ue(a.operand,true)}`;return se(p,n);case"Truthy":const d=`!!${ue(a.operand,true)}`;return se(d,n);case"Formatter":const f=pe(a);return n?`$${f}`:f;case"ComplexType":const c=ie(a);return n?`$${c}`:c;default:return""}}n.compileExpression=ue;function le(e){function n(e){const n=ue(e,true)??"undefined";return se(n,true,te(e))}return`${n(e.operand1)} ${e.operator} ${n(e.operand2)}`}function pe(e){if(e.parameters.length===1){return`{${de(e.parameters[0],true)}, formatter: '${e.fn}'}`}else{const n=e.parameters.map(e=>{if(e._type==="ComplexType"){return ie(e)}else{return de(e)}});return`{parts: [${n.join(", ")}], formatter: '${e.fn}'}`}}function de(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let t="";if(e._type==="Constant"){if(e.value===undefined){t=`value: 'undefined'`}else{t=`value: ${ae(e,true)}`}}else if(e._type==="PathInModel"){t=`path: '${ce(e)}'`;t+=e.type?`, type: '${e.type}'`:`, targetType: 'any'`;if(fe(e.mode)){t+=`, mode: '${ue(e.mode)}'`}if(fe(e.constraints)){t+=`, constraints: ${ue(e.constraints)}`}if(fe(e.formatOptions)){t+=`, formatOptions: ${ue(e.formatOptions)}`}if(fe(e.parameters)){t+=`, parameters: ${ue(e.parameters)}`}}else{return""}return n?t:`{${t}}`}function fe(e){return e&&Object.keys(e).length>0}function ce(e){return`${e.modelName?`${e.modelName}>`:""}${e.path}`}return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ClassSupport-dbg", ["sap/base/util/merge", "sap/base/util/ObjectPath", "sap/base/util/uid", "sap/ui/base/Metadata", "sap/ui/core/mvc/ControllerMetadata"], function (merge, ObjectPath, uid, Metadata, ControllerMetadata) {
  "use strict";

  var _exports = {};
  const ensureMetadata = function (target) {
    target.metadata = merge({
      controllerExtensions: {},
      properties: {},
      aggregations: {},
      associations: {},
      methods: {},
      events: {},
      interfaces: []
    }, target.metadata || {});
    return target.metadata;
  };

  /* #region CONTROLLER EXTENSIONS */

  /**
   * Defines that the following method is an override for the method name with the same name in the specific controller extension or base implementation.
   *
   * @param extensionName The name of the extension that will be overridden
   * @returns The decorated method
   */
  function methodOverride(extensionName) {
    return function (target, propertyKey) {
      if (!target.override) {
        target.override = {};
      }
      let currentTarget = target.override;
      if (extensionName) {
        if (!currentTarget.extension) {
          currentTarget.extension = {};
        }
        if (!currentTarget.extension[extensionName]) {
          currentTarget.extension[extensionName] = {};
        }
        currentTarget = currentTarget.extension[extensionName];
      }
      currentTarget[propertyKey.toString()] = target[propertyKey.toString()];
    };
  }

  /**
   * Defines that the method can be extended by other controller extension based on the defined overrideExecutionType.
   *
   * @param overrideExecutionType The OverrideExecution defining when the override should run (Before / After / Instead)
   * @returns The decorated method
   */
  _exports.methodOverride = methodOverride;
  function extensible(overrideExecutionType) {
    return function (target, propertyKey) {
      const metadata = ensureMetadata(target);
      if (!metadata.methods[propertyKey.toString()]) {
        metadata.methods[propertyKey.toString()] = {};
      }
      metadata.methods[propertyKey.toString()].overrideExecution = overrideExecutionType;
    };
  }

  /**
   * Defines that the method will be publicly available for controller extension usage.
   *
   * @returns The decorated method
   */
  _exports.extensible = extensible;
  function publicExtension() {
    return function (target, propertyKey, descriptor) {
      const metadata = ensureMetadata(target);
      descriptor.enumerable = true;
      if (!metadata.methods[propertyKey.toString()]) {
        metadata.methods[propertyKey.toString()] = {};
      }
      metadata.methods[propertyKey.toString()].public = true;
    };
  }
  /**
   * Defines that the method will be only available for internal usage of the controller extension.
   *
   * @returns The decorated method
   */
  _exports.publicExtension = publicExtension;
  function privateExtension() {
    return function (target, propertyKey, descriptor) {
      const metadata = ensureMetadata(target);
      descriptor.enumerable = true;
      if (!metadata.methods[propertyKey.toString()]) {
        metadata.methods[propertyKey.toString()] = {};
      }
      metadata.methods[propertyKey.toString()].public = false;
    };
  }
  /**
   * Defines that the method cannot be further extended by other controller extension.
   *
   * @returns The decorated method
   */
  _exports.privateExtension = privateExtension;
  function finalExtension() {
    return function (target, propertyKey, descriptor) {
      const metadata = ensureMetadata(target);
      descriptor.enumerable = true;
      if (!metadata.methods[propertyKey.toString()]) {
        metadata.methods[propertyKey.toString()] = {};
      }
      metadata.methods[propertyKey.toString()].final = true;
    };
  }

  /**
   * Defines that we are going to use instantiate a controller extension under the following variable name.
   *
   * @param extensionClass The controller extension that will be instantiated
   * @returns The decorated property
   */
  _exports.finalExtension = finalExtension;
  function usingExtension(extensionClass) {
    return function (target, propertyKey, propertyDescriptor) {
      const metadata = ensureMetadata(target);
      delete propertyDescriptor.initializer;
      metadata.controllerExtensions[propertyKey.toString()] = extensionClass;
      return propertyDescriptor;
    }; // This is technically an accessor decorator, but somehow the compiler doesn't like it if I declare it as such.
  }

  /* #endregion */

  /* #region CONTROL */
  /**
   * Indicates that the property shall be declared as an event on the control metadata.
   *
   * @returns The decorated property
   */
  _exports.usingExtension = usingExtension;
  function event() {
    return function (target, eventKey) {
      const metadata = ensureMetadata(target);
      if (!metadata.events[eventKey.toString()]) {
        metadata.events[eventKey.toString()] = {};
      }
    };
  }

  /**
   * Defines the following property in the control metatada.
   *
   * @param attributeDefinition The property definition
   * @returns The decorated property.
   */
  _exports.event = event;
  function property(attributeDefinition) {
    return function (target, propertyKey, propertyDescriptor) {
      const metadata = ensureMetadata(target);
      if (!metadata.properties[propertyKey]) {
        metadata.properties[propertyKey] = attributeDefinition;
      }
      delete propertyDescriptor.writable;
      delete propertyDescriptor.initializer;
      return propertyDescriptor;
    }; // This is technically an accessor decorator, but somehow the compiler doesn't like it if i declare it as such.;
  }
  /**
   * Defines and configure the following aggregation in the control metatada.
   *
   * @param aggregationDefinition The aggregation definition
   * @returns The decorated property.
   */
  _exports.property = property;
  function aggregation(aggregationDefinition) {
    return function (target, propertyKey, propertyDescriptor) {
      const metadata = ensureMetadata(target);
      if (aggregationDefinition.multiple === undefined) {
        // UI5 defaults this to true but this is just weird...
        aggregationDefinition.multiple = false;
      }
      if (!metadata.aggregations[propertyKey]) {
        metadata.aggregations[propertyKey] = aggregationDefinition;
      }
      if (aggregationDefinition.isDefault) {
        metadata.defaultAggregation = propertyKey;
      }
      delete propertyDescriptor.writable;
      delete propertyDescriptor.initializer;
      return propertyDescriptor;
    }; // This is technically an accessor decorator, but somehow the compiler doesn't like it if i declare it as such.;
  }

  /**
   * Defines and configure the following association in the control metatada.
   *
   * @param ui5AssociationMetadata The definition of the association.
   * @returns The decorated property
   */
  _exports.aggregation = aggregation;
  function association(ui5AssociationMetadata) {
    return function (target, propertyKey, propertyDescriptor) {
      const metadata = ensureMetadata(target);
      if (!metadata.associations[propertyKey]) {
        metadata.associations[propertyKey] = ui5AssociationMetadata;
      }
      delete propertyDescriptor.writable;
      delete propertyDescriptor.initializer;
      return propertyDescriptor;
    }; // This is technically an accessor decorator, but somehow the compiler doesn't like it if i declare it as such.;
  }

  /**
   * Defines in the metadata that this control implements a specific interface.
   *
   * @param interfaceName The name of the implemented interface
   * @returns The decorated method
   */
  _exports.association = association;
  function implementInterface(interfaceName) {
    return function (target) {
      const metadata = ensureMetadata(target);
      metadata.interfaces.push(interfaceName);
    };
  }

  /**
   * Indicates that the following method should also be exposed statically so we can call it from XML.
   *
   * @returns The decorated method
   */
  _exports.implementInterface = implementInterface;
  function xmlEventHandler() {
    return function (target, propertykey) {
      const currentConstructor = target.constructor;
      currentConstructor[propertykey.toString()] = function () {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }
        if (args && args.length) {
          const currentTarget = currentConstructor.getAPI(args[0]);
          currentTarget === null || currentTarget === void 0 ? void 0 : currentTarget[propertykey.toString()](...args);
        }
      };
    };
  }

  /**
   * Indicates that the following class should define a UI5 control of the specified name.
   *
   * @param sTarget The fully qualified name of the UI5 class
   * @param metadataDefinition Inline metadata definition
   * @class
   */
  _exports.xmlEventHandler = xmlEventHandler;
  function defineUI5Class(sTarget, metadataDefinition) {
    return function (constructor) {
      if (!constructor.prototype.metadata) {
        constructor.prototype.metadata = {};
      }
      if (metadataDefinition) {
        for (const key in metadataDefinition) {
          constructor.prototype.metadata[key] = metadataDefinition[key];
        }
      }
      return registerUI5Metadata(constructor, sTarget, constructor.prototype);
    };
  }
  _exports.defineUI5Class = defineUI5Class;
  function createReference() {
    return {
      current: undefined,
      setCurrent: function (oControlInstance) {
        this.current = oControlInstance;
      }
    };
  }
  /**
   * Defines that the following object will hold a reference to a control through jsx templating.
   *
   * @returns The decorated property.
   */
  _exports.createReference = createReference;
  function defineReference() {
    return function (target, propertyKey, propertyDescriptor) {
      delete propertyDescriptor.writable;
      delete propertyDescriptor.initializer;
      propertyDescriptor.initializer = createReference;
      return propertyDescriptor;
    }; // This is technically an accessor decorator, but somehow the compiler doesn't like it if i declare it as such.;
  }

  /**
   * Internal heavy lifting that will take care of creating the class property for ui5 to use.
   *
   * @param clazz The class prototype
   * @param name The name of the class to create
   * @param inObj The metadata object
   * @returns The metadata class
   */
  _exports.defineReference = defineReference;
  function registerUI5Metadata(clazz, name, inObj) {
    var _clazz$getMetadata, _inObj$metadata, _clazz$metadata, _obj$metadata;
    if (clazz.getMetadata && clazz.getMetadata().isA("sap.ui.core.mvc.ControllerExtension")) {
      Object.getOwnPropertyNames(inObj).forEach(objName => {
        const descriptor = Object.getOwnPropertyDescriptor(inObj, objName);
        if (descriptor && !descriptor.enumerable) {
          descriptor.enumerable = true;
          //		Log.error(`Property ${objName} from ${name} should be decorated as public`);
        }
      });
    }

    const obj = {};
    obj.metadata = inObj.metadata || {};
    obj.override = inObj.override;
    obj.constructor = clazz;
    obj.metadata.baseType = Object.getPrototypeOf(clazz.prototype).getMetadata().getName();
    if ((clazz === null || clazz === void 0 ? void 0 : (_clazz$getMetadata = clazz.getMetadata()) === null || _clazz$getMetadata === void 0 ? void 0 : _clazz$getMetadata.getStereotype()) === "control") {
      const rendererDefinition = inObj.renderer || clazz.renderer || clazz.render;
      obj.renderer = {
        apiVersion: 2
      };
      if (typeof rendererDefinition === "function") {
        obj.renderer.render = rendererDefinition;
      } else if (rendererDefinition != undefined) {
        obj.renderer = rendererDefinition;
      }
    }
    obj.metadata.interfaces = ((_inObj$metadata = inObj.metadata) === null || _inObj$metadata === void 0 ? void 0 : _inObj$metadata.interfaces) || ((_clazz$metadata = clazz.metadata) === null || _clazz$metadata === void 0 ? void 0 : _clazz$metadata.interfaces);
    Object.keys(clazz.prototype).forEach(key => {
      if (key !== "metadata") {
        try {
          obj[key] = clazz.prototype[key];
        } catch (e) {
          //console.log(e);
        }
      }
    });
    if ((_obj$metadata = obj.metadata) !== null && _obj$metadata !== void 0 && _obj$metadata.controllerExtensions && Object.keys(obj.metadata.controllerExtensions).length > 0) {
      for (const cExtName in obj.metadata.controllerExtensions) {
        obj[cExtName] = obj.metadata.controllerExtensions[cExtName];
      }
    }
    const output = clazz.extend(name, obj);
    const fnInit = output.prototype.init;
    output.prototype.init = function () {
      if (fnInit) {
        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
          args[_key2] = arguments[_key2];
        }
        fnInit.apply(this, args);
      }
      this.metadata = obj.metadata;
      if (obj.metadata.properties) {
        const aPropertyKeys = Object.keys(obj.metadata.properties);
        aPropertyKeys.forEach(propertyKey => {
          Object.defineProperty(this, propertyKey, {
            configurable: true,
            set: v => {
              return this.setProperty(propertyKey, v);
            },
            get: () => {
              return this.getProperty(propertyKey);
            }
          });
        });
        const aAggregationKeys = Object.keys(obj.metadata.aggregations);
        aAggregationKeys.forEach(aggregationKey => {
          Object.defineProperty(this, aggregationKey, {
            configurable: true,
            set: v => {
              return this.setAggregation(aggregationKey, v);
            },
            get: () => {
              const aggregationContent = this.getAggregation(aggregationKey);
              if (obj.metadata.aggregations[aggregationKey].multiple) {
                return aggregationContent || [];
              } else {
                return aggregationContent;
              }
            }
          });
        });
        const aAssociationKeys = Object.keys(obj.metadata.associations);
        aAssociationKeys.forEach(associationKey => {
          Object.defineProperty(this, associationKey, {
            configurable: true,
            set: v => {
              return this.setAssociation(associationKey, v);
            },
            get: () => {
              const aggregationContent = this.getAssociation(associationKey);
              if (obj.metadata.associations[associationKey].multiple) {
                return aggregationContent || [];
              } else {
                return aggregationContent;
              }
            }
          });
        });
      }
    };
    clazz.override = function (oExtension) {
      const pol = {};
      pol.constructor = function () {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }
        return clazz.apply(this, args);
      };
      const oClass = Metadata.createClass(clazz, `anonymousExtension~${uid()}`, pol, ControllerMetadata);
      oClass.getMetadata()._staticOverride = oExtension;
      oClass.getMetadata()._override = clazz.getMetadata()._override;
      return oClass;
    };
    ObjectPath.set(name, output);
    return output;
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ClassSupport", ["sap/base/util/merge","sap/base/util/ObjectPath","sap/base/util/uid","sap/ui/base/Metadata","sap/ui/core/mvc/ControllerMetadata"],function(t,e,n,r,i){"use strict";var o={};const a=function(e){e.metadata=t({controllerExtensions:{},properties:{},aggregations:{},associations:{},methods:{},events:{},interfaces:[]},e.metadata||{});return e.metadata};function s(t){return function(e,n){if(!e.override){e.override={}}let r=e.override;if(t){if(!r.extension){r.extension={}}if(!r.extension[t]){r.extension[t]={}}r=r.extension[t]}r[n.toString()]=e[n.toString()]}}o.methodOverride=s;function c(t){return function(e,n){const r=a(e);if(!r.methods[n.toString()]){r.methods[n.toString()]={}}r.methods[n.toString()].overrideExecution=t}}o.extensible=c;function u(){return function(t,e,n){const r=a(t);n.enumerable=true;if(!r.methods[e.toString()]){r.methods[e.toString()]={}}r.methods[e.toString()].public=true}}o.publicExtension=u;function f(){return function(t,e,n){const r=a(t);n.enumerable=true;if(!r.methods[e.toString()]){r.methods[e.toString()]={}}r.methods[e.toString()].public=false}}o.privateExtension=f;function d(){return function(t,e,n){const r=a(t);n.enumerable=true;if(!r.methods[e.toString()]){r.methods[e.toString()]={}}r.methods[e.toString()].final=true}}o.finalExtension=d;function l(t){return function(e,n,r){const i=a(e);delete r.initializer;i.controllerExtensions[n.toString()]=t;return r}}o.usingExtension=l;function g(){return function(t,e){const n=a(t);if(!n.events[e.toString()]){n.events[e.toString()]={}}}}o.event=g;function p(t){return function(e,n,r){const i=a(e);if(!i.properties[n]){i.properties[n]=t}delete r.writable;delete r.initializer;return r}}o.property=p;function m(t){return function(e,n,r){const i=a(e);if(t.multiple===undefined){t.multiple=false}if(!i.aggregations[n]){i.aggregations[n]=t}if(t.isDefault){i.defaultAggregation=n}delete r.writable;delete r.initializer;return r}}o.aggregation=m;function h(t){return function(e,n,r){const i=a(e);if(!i.associations[n]){i.associations[n]=t}delete r.writable;delete r.initializer;return r}}o.association=h;function v(t){return function(e){const n=a(e);n.interfaces.push(t)}}o.implementInterface=v;function b(){return function(t,e){const n=t.constructor;n[e.toString()]=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++){r[i]=arguments[i]}if(r&&r.length){const t=n.getAPI(r[0]);t===null||t===void 0?void 0:t[e.toString()](...r)}}}}o.xmlEventHandler=b;function y(t,e){return function(n){if(!n.prototype.metadata){n.prototype.metadata={}}if(e){for(const t in e){n.prototype.metadata[t]=e[t]}}return E(n,t,n.prototype)}}o.defineUI5Class=y;function x(){return{current:undefined,setCurrent:function(t){this.current=t}}}o.createReference=x;function S(){return function(t,e,n){delete n.writable;delete n.initializer;n.initializer=x;return n}}o.defineReference=S;function E(t,o,a){var s,c,u,f;if(t.getMetadata&&t.getMetadata().isA("sap.ui.core.mvc.ControllerExtension")){Object.getOwnPropertyNames(a).forEach(t=>{const e=Object.getOwnPropertyDescriptor(a,t);if(e&&!e.enumerable){e.enumerable=true}})}const d={};d.metadata=a.metadata||{};d.override=a.override;d.constructor=t;d.metadata.baseType=Object.getPrototypeOf(t.prototype).getMetadata().getName();if((t===null||t===void 0?void 0:(s=t.getMetadata())===null||s===void 0?void 0:s.getStereotype())==="control"){const e=a.renderer||t.renderer||t.render;d.renderer={apiVersion:2};if(typeof e==="function"){d.renderer.render=e}else if(e!=undefined){d.renderer=e}}d.metadata.interfaces=((c=a.metadata)===null||c===void 0?void 0:c.interfaces)||((u=t.metadata)===null||u===void 0?void 0:u.interfaces);Object.keys(t.prototype).forEach(e=>{if(e!=="metadata"){try{d[e]=t.prototype[e]}catch(t){}}});if((f=d.metadata)!==null&&f!==void 0&&f.controllerExtensions&&Object.keys(d.metadata.controllerExtensions).length>0){for(const t in d.metadata.controllerExtensions){d[t]=d.metadata.controllerExtensions[t]}}const l=t.extend(o,d);const g=l.prototype.init;l.prototype.init=function(){if(g){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++){e[n]=arguments[n]}g.apply(this,e)}this.metadata=d.metadata;if(d.metadata.properties){const t=Object.keys(d.metadata.properties);t.forEach(t=>{Object.defineProperty(this,t,{configurable:true,set:e=>this.setProperty(t,e),get:()=>this.getProperty(t)})});const e=Object.keys(d.metadata.aggregations);e.forEach(t=>{Object.defineProperty(this,t,{configurable:true,set:e=>this.setAggregation(t,e),get:()=>{const e=this.getAggregation(t);if(d.metadata.aggregations[t].multiple){return e||[]}else{return e}}})});const n=Object.keys(d.metadata.associations);n.forEach(t=>{Object.defineProperty(this,t,{configurable:true,set:e=>this.setAssociation(t,e),get:()=>{const e=this.getAssociation(t);if(d.metadata.associations[t].multiple){return e||[]}else{return e}}})})}};t.override=function(e){const o={};o.constructor=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++){n[r]=arguments[r]}return t.apply(this,n)};const a=r.createClass(t,`anonymousExtension~${n()}`,o,i);a.getMetadata()._staticOverride=e;a.getMetadata()._override=t.getMetadata()._override;return a};e.set(o,l);return l}return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/DeleteHelper-dbg", ["sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/editFlow/draft", "sap/m/CheckBox", "sap/m/MessageToast", "sap/m/Text"], function (CommonUtils, draft, CheckBox, MessageToast, Text) {
  "use strict";

  var _exports = {};
  let DeleteOptionTypes;
  (function (DeleteOptionTypes) {
    DeleteOptionTypes["deletableContexts"] = "deletableContexts";
    DeleteOptionTypes["draftsWithDeletableActive"] = "draftsWithDeletableActive";
    DeleteOptionTypes["createModeContexts"] = "createModeContexts";
    DeleteOptionTypes["unSavedContexts"] = "unSavedContexts";
    DeleteOptionTypes["draftsWithNonDeletableActive"] = "draftsWithNonDeletableActive";
  })(DeleteOptionTypes || (DeleteOptionTypes = {}));
  _exports.DeleteOptionTypes = DeleteOptionTypes;
  let DeleteDialogContentControl;
  (function (DeleteDialogContentControl) {
    DeleteDialogContentControl["CHECKBOX"] = "checkBox";
    DeleteDialogContentControl["TEXT"] = "text";
  })(DeleteDialogContentControl || (DeleteDialogContentControl = {}));
  _exports.DeleteDialogContentControl = DeleteDialogContentControl;
  function getUpdatedSelections(internalModelContext, type, selectedContexts, contextsToRemove) {
    contextsToRemove.forEach(context => {
      const idx = selectedContexts.indexOf(context);
      if (idx !== -1) {
        selectedContexts.splice(idx, 1);
      }
    });
    internalModelContext.setProperty(type, []);
    return [...selectedContexts];
  }
  function clearSelectedContextsForOption(internalModelContext, option) {
    let selectedContexts = internalModelContext.getProperty("selectedContexts") || [];
    if (option.type === DeleteOptionTypes.deletableContexts) {
      selectedContexts = getUpdatedSelections(internalModelContext, DeleteOptionTypes.deletableContexts, selectedContexts, internalModelContext.getProperty(DeleteOptionTypes.deletableContexts) || []);
      selectedContexts = getUpdatedSelections(internalModelContext, DeleteOptionTypes.createModeContexts, selectedContexts, internalModelContext.getProperty(DeleteOptionTypes.createModeContexts) || []);
      const draftSiblingPairs = internalModelContext.getProperty(DeleteOptionTypes.draftsWithDeletableActive) || [];
      const drafts = draftSiblingPairs.map(contextPair => {
        return contextPair.draft;
      });
      selectedContexts = getUpdatedSelections(internalModelContext, DeleteOptionTypes.draftsWithDeletableActive, selectedContexts, drafts);
    } else {
      const contextsToRemove = internalModelContext.getProperty(option.type) || [];
      selectedContexts = getUpdatedSelections(internalModelContext, option.type, selectedContexts, contextsToRemove);
    }
    internalModelContext.setProperty("selectedContexts", selectedContexts);
    internalModelContext.setProperty("numberOfSelectedContexts", selectedContexts.length);
  }
  function afterDeleteProcess(parameters, options, contexts, oResourceBundle) {
    const {
      internalModelContext,
      entitySetName
    } = parameters;
    if (internalModelContext) {
      if (internalModelContext.getProperty("deleteEnabled") != undefined) {
        options.forEach(option => {
          // if an option is selected, then it is deleted. So, we need to remove them from selected contexts.
          if (option.selected) {
            clearSelectedContextsForOption(internalModelContext, option);
          }
        });
      }
      // if atleast one of the options is not selected, then the delete button needs to be enabled.
      internalModelContext.setProperty("deleteEnabled", options.some(option => !option.selected));
    }
    if (contexts.length === 1) {
      MessageToast.show(CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_DELETE_TOAST_SINGULAR", oResourceBundle, undefined, entitySetName));
    } else {
      MessageToast.show(CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_DELETE_TOAST_PLURAL", oResourceBundle, undefined, entitySetName));
    }
  }
  function getLockedContextUser(lockedContext) {
    const draftAdminData = lockedContext.getObject()["DraftAdministrativeData"];
    return draftAdminData && draftAdminData["InProcessByUser"] || "";
  }
  function getLockedObjectsText(oResourceBundle, numberOfSelectedContexts, lockedContexts) {
    let retTxt = "";
    if (numberOfSelectedContexts === 1 && lockedContexts.length === 1) {
      //only one unsaved object
      const lockedUser = getLockedContextUser(lockedContexts[0]);
      retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_OBJECT_LOCKED", oResourceBundle, [lockedUser]);
    } else if (lockedContexts.length == 1) {
      const lockedUser = getLockedContextUser(lockedContexts[0]);
      retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_ONE_OBJECT_LOCKED", oResourceBundle, [numberOfSelectedContexts, lockedUser]);
    } else if (lockedContexts.length > 1) {
      retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_LOCKED", oResourceBundle, [lockedContexts.length, numberOfSelectedContexts]);
    }
    return retTxt;
  }
  function getNonDeletableActivesOfDraftsText(oResourceBundle, numberOfDrafts, totalDeletable) {
    let retTxt = "";
    if (totalDeletable === numberOfDrafts) {
      if (numberOfDrafts === 1) {
        retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_ONLY_DRAFT_OF_NON_DELETABLE_ACTIVE", oResourceBundle);
      } else {
        retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_ONLY_DRAFTS_OF_NON_DELETABLE_ACTIVE", oResourceBundle);
      }
    } else if (numberOfDrafts === 1) {
      retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_DRAFT_OF_NON_DELETABLE_ACTIVE", oResourceBundle);
    } else {
      retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_DRAFTS_OF_NON_DELETABLE_ACTIVE", oResourceBundle);
    }
    return retTxt;
  }
  function getUnSavedContextUser(unSavedContext) {
    const draftAdminData = unSavedContext.getObject()["DraftAdministrativeData"];
    let sLastChangedByUser = "";
    if (draftAdminData) {
      sLastChangedByUser = draftAdminData["LastChangedByUserDescription"] || draftAdminData["LastChangedByUser"] || "";
    }
    return sLastChangedByUser;
  }
  function getUnsavedContextsText(oResourceBundle, numberOfSelectedContexts, unSavedContexts, totalDeletable) {
    let infoTxt = "",
      optionTxt = "",
      optionWithoutTxt = false;
    if (numberOfSelectedContexts === 1 && unSavedContexts.length === 1) {
      //only one unsaved object are selected
      const lastChangedByUser = getUnSavedContextUser(unSavedContexts[0]);
      infoTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_CHANGES", oResourceBundle, [lastChangedByUser]);
      optionWithoutTxt = true;
    } else if (numberOfSelectedContexts === unSavedContexts.length) {
      //only multiple unsaved objects are selected
      infoTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_CHANGES_MULTIPLE_OBJECTS", oResourceBundle);
      optionWithoutTxt = true;
    } else if (totalDeletable === unSavedContexts.length) {
      // non-deletable/locked exists, all deletable are unsaved by others
      if (unSavedContexts.length === 1) {
        const lastChangedByUser = getUnSavedContextUser(unSavedContexts[0]);
        infoTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_SINGULAR", oResourceBundle, [lastChangedByUser]);
      } else {
        infoTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_PLURAL", oResourceBundle);
      }
      optionWithoutTxt = true;
    } else if (totalDeletable > unSavedContexts.length) {
      // non-deletable/locked exists, deletable include unsaved and other types.
      if (unSavedContexts.length === 1) {
        const lastChangedByUser = getUnSavedContextUser(unSavedContexts[0]);
        optionTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_SINGULAR", oResourceBundle, [lastChangedByUser]);
      } else {
        optionTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_PLURAL", oResourceBundle);
      }
    }
    return {
      infoTxt,
      optionTxt,
      optionWithoutTxt
    };
  }
  function getNonDeletableText(mParameters, totalNumDeletableContexts, oResourceBundle) {
    const {
      numberOfSelectedContexts,
      lockedContexts,
      draftsWithNonDeletableActive
    } = mParameters;
    const nonDeletableContexts = numberOfSelectedContexts - (lockedContexts.length + totalNumDeletableContexts - draftsWithNonDeletableActive.length);
    let retTxt = "";
    if (nonDeletableContexts > 0 && (totalNumDeletableContexts === 0 || draftsWithNonDeletableActive.length === totalNumDeletableContexts)) {
      // 1. None of the ccontexts are deletable
      // 2. Only drafts of non deletable contexts exist.
      if (lockedContexts.length > 0) {
        // Locked contexts exist
        if (nonDeletableContexts === 1) {
          retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_ALL_REMAINING_NON_DELETABLE_SINGULAR", oResourceBundle, undefined);
        } else {
          retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_ALL_REMAINING_NON_DELETABLE_PLURAL", oResourceBundle, undefined);
        }
      } else if (nonDeletableContexts === 1) {
        // Only pure non-deletable contexts exist single
        retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_AND_ONE_OBJECT_NON_DELETABLE", oResourceBundle, undefined);
      } else {
        // Only pure non-deletable contexts exist multiple
        retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_MULTIPLE_AND_ALL_OBJECT_NON_DELETABLE", oResourceBundle, undefined);
      }
    } else if (nonDeletableContexts === 1) {
      // deletable and non-deletable exists together, single
      retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_ONE_OBJECT_NON_DELETABLE", oResourceBundle, [numberOfSelectedContexts]);
    } else if (nonDeletableContexts > 1) {
      // deletable and non-deletable exists together, multiple
      retTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_NON_DELETABLE", oResourceBundle, [nonDeletableContexts, numberOfSelectedContexts]);
    }
    return retTxt;
  }
  function getConfirmedDeletableContext(contexts, options) {
    return options.reduce((result, option) => {
      return option.selected ? result.concat(option.contexts) : result;
    }, contexts);
  }
  function updateDraftOptionsForDeletableTexts(mParameters, vContexts, totalDeletable, oResourceBundle, items, options) {
    const {
      numberOfSelectedContexts,
      draftsWithDeletableActive,
      unSavedContexts,
      createModeContexts,
      lockedContexts,
      draftsWithNonDeletableActive
    } = mParameters;
    let nonDeletableContextText = "",
      lockedContextsTxt = "";

    // drafts with active
    if (draftsWithDeletableActive.length > 0) {
      draftsWithDeletableActive.forEach(deletableDraftInfo => {
        vContexts.push(deletableDraftInfo.siblingInfo.targetContext);
      });
    }

    // create mode drafts
    if (createModeContexts.length > 0) {
      // create mode drafts
      createModeContexts.forEach(context => vContexts.push(context));
    }

    // items locked msg
    if (lockedContexts.length > 0) {
      lockedContextsTxt = deleteHelper.getLockedObjectsText(oResourceBundle, numberOfSelectedContexts, lockedContexts) || "";
      items.push(new Text({
        text: lockedContextsTxt
      }));
    }

    // non deletable msg
    if (numberOfSelectedContexts != totalDeletable - draftsWithNonDeletableActive.length + lockedContexts.length) {
      nonDeletableContextText = deleteHelper.getNonDeletableText(mParameters, totalDeletable, oResourceBundle);
      items.push(new Text({
        text: nonDeletableContextText
      }));
    }

    // option: unsaved changes by others
    if (unSavedContexts.length > 0) {
      const unsavedChangesTxts = deleteHelper.getUnsavedContextsText(oResourceBundle, numberOfSelectedContexts, unSavedContexts, totalDeletable) || {};
      if (unsavedChangesTxts.infoTxt) {
        items.push(new Text({
          text: unsavedChangesTxts.infoTxt
        }));
      }
      if (unsavedChangesTxts.optionTxt || unsavedChangesTxts.optionWithoutTxt) {
        options.push({
          type: DeleteOptionTypes.unSavedContexts,
          contexts: unSavedContexts,
          text: unsavedChangesTxts.optionTxt,
          selected: true,
          control: DeleteDialogContentControl.CHECKBOX
        });
      }
    }

    // option: drafts with active not deletable
    if (draftsWithNonDeletableActive.length > 0) {
      const nonDeletableActivesOfDraftsText = deleteHelper.getNonDeletableActivesOfDraftsText(oResourceBundle, draftsWithNonDeletableActive.length, totalDeletable) || "";
      if (nonDeletableActivesOfDraftsText) {
        options.push({
          type: DeleteOptionTypes.draftsWithNonDeletableActive,
          contexts: draftsWithNonDeletableActive,
          text: nonDeletableActivesOfDraftsText,
          selected: true,
          control: totalDeletable > 0 ? DeleteDialogContentControl.CHECKBOX : DeleteDialogContentControl.TEXT
        });
      }
    }
  }
  function updateContentForDeleteDialog(options, items) {
    if (options.length === 1) {
      // Single option doesn't need checkBox
      const option = options[0];
      if (option.text) {
        items.push(new Text({
          text: option.text
        }));
      }
    } else if (options.length > 1) {
      // Multiple Options

      // Texts
      options.forEach(option => {
        if (option.control === "text" && option.text) {
          items.push(new Text({
            text: option.text
          }));
        }
      });
      // CheckBoxs
      options.forEach(option => {
        if (option.control === "checkBox" && option.text) {
          items.push(new CheckBox({
            text: option.text,
            selected: true,
            select: function (oEvent) {
              const checkBox = oEvent.getSource();
              const selected = checkBox.getSelected();
              option.selected = selected;
            }
          }));
        }
      });
    }
  }
  function updateOptionsForDeletableTexts(mParameters, directDeletableContexts, oResourceBundle, options) {
    const {
      numberOfSelectedContexts,
      entitySetName,
      parentControl,
      description,
      lockedContexts,
      draftsWithNonDeletableActive,
      unSavedContexts
    } = mParameters;
    const totalDeletable = directDeletableContexts.length + draftsWithNonDeletableActive.length + unSavedContexts.length;
    const nonDeletableContexts = numberOfSelectedContexts - (lockedContexts.length + totalDeletable - draftsWithNonDeletableActive.length);
    if (numberOfSelectedContexts === 1 && numberOfSelectedContexts === directDeletableContexts.length) {
      // single deletable context
      const oLineContextData = directDeletableContexts[0].getObject();
      const oTable = parentControl;
      const sKey = oTable && oTable.getParent().getIdentifierColumn();
      let txt;
      let aParams = [];
      if (sKey) {
        const sKeyValue = sKey ? oLineContextData[sKey] : undefined;
        const sDescription = description && description.path ? oLineContextData[description.path] : undefined;
        if (sKeyValue) {
          if (sDescription && description && sKey !== description.path) {
            aParams = [sKeyValue + " ", sDescription];
          } else {
            aParams = [sKeyValue, ""];
          }
          txt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO", oResourceBundle, aParams, entitySetName);
        } else if (sKeyValue) {
          aParams = [sKeyValue, ""];
          txt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO", oResourceBundle, aParams, entitySetName);
        } else {
          txt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR", oResourceBundle, undefined, entitySetName);
        }
      } else {
        txt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR", oResourceBundle, undefined, entitySetName);
      }
      options.push({
        type: DeleteOptionTypes.deletableContexts,
        contexts: directDeletableContexts,
        text: txt,
        selected: true,
        control: DeleteDialogContentControl.TEXT
      });
    } else if (unSavedContexts.length !== totalDeletable && numberOfSelectedContexts > 0 && (directDeletableContexts.length > 0 || unSavedContexts.length > 0 && draftsWithNonDeletableActive.length > 0)) {
      if (numberOfSelectedContexts > directDeletableContexts.length && nonDeletableContexts + lockedContexts.length > 0) {
        // other types exists with pure deletable ones
        let deletableOptionTxt = "";
        if (totalDeletable === 1) {
          deletableOptionTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR_NON_DELETABLE", oResourceBundle, undefined, entitySetName);
        } else {
          deletableOptionTxt = CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL_NON_DELETABLE", oResourceBundle, undefined, entitySetName);
        }
        options.unshift({
          type: DeleteOptionTypes.deletableContexts,
          contexts: directDeletableContexts,
          text: deletableOptionTxt,
          selected: true,
          control: DeleteDialogContentControl.TEXT
        });
      } else {
        // only deletable
        const allDeletableTxt = totalDeletable === 1 ? CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR", oResourceBundle, undefined, entitySetName) : CommonUtils.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL", oResourceBundle, undefined, entitySetName);
        options.push({
          type: DeleteOptionTypes.deletableContexts,
          contexts: directDeletableContexts,
          text: allDeletableTxt,
          selected: true,
          control: DeleteDialogContentControl.TEXT
        });
      }
    }
  }
  async function deleteConfirmHandler(options, mParameters, messageHandler, oResourceBundle, appComponent, draftEnabled) {
    try {
      const contexts = deleteHelper.getConfirmedDeletableContext([], options);
      const {
        beforeDeleteCallBack,
        parentControl
      } = mParameters;
      if (beforeDeleteCallBack) {
        await beforeDeleteCallBack({
          contexts: contexts
        });
      }
      if (contexts && contexts.length) {
        try {
          await Promise.all(contexts.map(function (context) {
            if (draftEnabled && !context.getProperty("IsActiveEntity")) {
              //delete the draft
              const enableStrictHandling = contexts.length === 1 ? true : false;
              return draft.deleteDraft(context, appComponent, enableStrictHandling);
            }
            return context.delete();
          }));
          deleteHelper.afterDeleteProcess(mParameters, options, contexts, oResourceBundle);
        } catch (error) {
          await messageHandler.showMessageDialog({
            control: parentControl
          });
          // re-throw error to enforce rejecting the general promise
          throw error;
        }
      }
    } catch (oError) {
      await messageHandler.showMessages();
      // re-throw error to enforce rejecting the general promise
      throw oError;
    }
  }

  // Table Runtime Helpers:

  /* refreshes data in internal model relevant for enablement of delete button according to selected contexts
  relevant data are: deletableContexts, draftsWithDeletableActive, draftsWithNonDeletableActive, createModeContexts, unSavedContexts, deleteEnabled
  not relevant: lockedContexts
  */
  async function updateDeleteInfoForSelectedContexts(internalModelContext, selectedContexts) {
    const contextInfos = selectedContexts.map(context => {
      // assuming metaContext is the same for all contexts, still not relying on this assumption
      const metaContext = context.getModel().getMetaModel().getMetaContext(context.getCanonicalPath());
      const deletablePath = metaContext.getProperty("@Org.OData.Capabilities.V1.DeleteRestrictions/Deletable/$Path");
      const staticDeletable = !deletablePath && metaContext.getProperty("@Org.OData.Capabilities.V1.DeleteRestrictions/Deletable") !== false;
      // default values according to non-draft case (sticky behaves the same as non-draft from UI point of view regarding deletion)
      const info = {
        context: context,
        isDraftRoot: !!metaContext.getProperty("@com.sap.vocabularies.Common.v1.DraftRoot"),
        isDraftNode: !!metaContext.getProperty("@com.sap.vocabularies.Common.v1.DraftNode"),
        isActive: true,
        hasActive: false,
        hasDraft: false,
        locked: false,
        deletable: deletablePath ? context.getProperty(deletablePath) : staticDeletable,
        siblingPromise: Promise.resolve(undefined),
        siblingInfo: undefined,
        siblingDeletable: false
      };
      if (info.isDraftRoot) {
        var _context$getObject;
        info.locked = !!((_context$getObject = context.getObject("DraftAdministrativeData")) !== null && _context$getObject !== void 0 && _context$getObject.InProcessByUser);
        info.hasDraft = context.getProperty("HasDraftEntity");
      }
      if (info.isDraftRoot || info.isDraftNode) {
        info.isActive = context.getProperty("IsActiveEntity");
        info.hasActive = context.getProperty("HasActiveEntity");
        if (!info.isActive && info.hasActive) {
          // get sibling contexts
          // draft.computeSiblingInformation expects draft root as first parameter - if we are on a subnode, this is not given
          // - done wrong also above, but seems not to break anything
          // - why is draft.computeSiblingInformation not able to calculate draft root on its own?!
          // - and why is it not able to deal with contexts not draft enabled (of course they never have a sibling - could just return undefined)
          info.siblingPromise = draft.computeSiblingInformation(context, context).then(async siblingInformation => {
            // For draftWithDeletableActive bucket, currently also siblingInformation is put into internalModel and used
            // from there in case of deletion. Therefore, sibling needs to be retrieved in case of staticDeletable.
            // Possible improvement: Only read siblingInfo here if needed for determination of delete button enablement,
            // in other cases, read it only if deletion really happens.
            info.siblingInfo = siblingInformation;
            if (deletablePath) {
              var _siblingInformation$t;
              info.siblingDeletable = await (siblingInformation === null || siblingInformation === void 0 ? void 0 : (_siblingInformation$t = siblingInformation.targetContext) === null || _siblingInformation$t === void 0 ? void 0 : _siblingInformation$t.requestProperty(deletablePath));
            } else {
              info.siblingDeletable = staticDeletable;
            }
          });
        }
      }
      return info;
    });
    // wait for all siblingPromises. If no sibling exists, promise is resolved to undefined (but it's still a promise)
    await Promise.all(contextInfos.map(info => info.siblingPromise));
    const buckets = [{
      key: "draftsWithDeletableActive",
      // only for draft root: In that case, the delete request needs to be sent for the active (i.e. the sibling),
      // while in draft node, the delete request needs to be send for the draft itself
      value: contextInfos.filter(info => info.isDraftRoot && !info.isActive && info.hasActive && info.siblingDeletable)
    }, {
      key: "draftsWithNonDeletableActive",
      value: contextInfos.filter(info => !info.isActive && info.hasActive && !info.siblingDeletable)
    }, {
      key: "lockedContexts",
      value: contextInfos.filter(info => info.isDraftRoot && info.isActive && info.hasDraft && info.locked)
    }, {
      key: "unSavedContexts",
      value: contextInfos.filter(info => info.isDraftRoot && info.isActive && info.hasDraft && !info.locked)
    },
    // non-draft/sticky and deletable
    // active draft root without any draft and deletable
    // created draft root (regardless of deletable)
    // draft node without active (regardless whether root is create or edit, and regardless of deletable)
    // draft node with deletable active
    {
      key: "deletableContexts",
      value: contextInfos.filter(info => !info.isDraftRoot && !info.isDraftNode && info.deletable || info.isDraftRoot && info.isActive && !info.hasDraft && info.deletable || info.isDraftRoot && !info.isActive && !info.hasActive || info.isDraftNode && !info.isActive && !info.hasActive || info.isDraftNode && !info.isActive && info.hasActive && info.siblingDeletable)
    }];
    for (const {
      key,
      value
    } of buckets) {
      internalModelContext.setProperty(key,
      // Currently, bucket draftsWithDeletableActive has a different structure (containing also sibling information, which is used
      // in case of deletion). Possible improvement: Read sibling information only when needed, and build all buckets with same
      // structure. However, in that case siblingInformation might need to be read twice (if already needed for button enablement),
      // thus a buffer probably would make sense.
      value.map(info => key === "draftsWithDeletableActive" ? {
        draft: info.context,
        siblingInfo: info.siblingInfo
      } : info.context));
    }
  }
  const deleteHelper = {
    getNonDeletableText,
    deleteConfirmHandler,
    updateOptionsForDeletableTexts,
    updateContentForDeleteDialog,
    updateDraftOptionsForDeletableTexts,
    getConfirmedDeletableContext,
    getLockedObjectsText,
    getUnsavedContextsText,
    getNonDeletableActivesOfDraftsText,
    afterDeleteProcess,
    updateDeleteInfoForSelectedContexts
  };
  return deleteHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/DeleteHelper", ["sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/editFlow/draft","sap/m/CheckBox","sap/m/MessageToast","sap/m/Text"],function(e,t,n,s,l){"use strict";var o={};let a;(function(e){e["deletableContexts"]="deletableContexts";e["draftsWithDeletableActive"]="draftsWithDeletableActive";e["createModeContexts"]="createModeContexts";e["unSavedContexts"]="unSavedContexts";e["draftsWithNonDeletableActive"]="draftsWithNonDeletableActive"})(a||(a={}));o.DeleteOptionTypes=a;let i;(function(e){e["CHECKBOX"]="checkBox";e["TEXT"]="text"})(i||(i={}));o.DeleteDialogContentControl=i;function E(e,t,n,s){s.forEach(e=>{const t=n.indexOf(e);if(t!==-1){n.splice(t,1)}});e.setProperty(t,[]);return[...n]}function T(e,t){let n=e.getProperty("selectedContexts")||[];if(t.type===a.deletableContexts){n=E(e,a.deletableContexts,n,e.getProperty(a.deletableContexts)||[]);n=E(e,a.createModeContexts,n,e.getProperty(a.createModeContexts)||[]);const t=e.getProperty(a.draftsWithDeletableActive)||[];const s=t.map(e=>e.draft);n=E(e,a.draftsWithDeletableActive,n,s)}else{const s=e.getProperty(t.type)||[];n=E(e,t.type,n,s)}e.setProperty("selectedContexts",n);e.setProperty("numberOfSelectedContexts",n.length)}function _(t,n,l,o){const{internalModelContext:a,entitySetName:i}=t;if(a){if(a.getProperty("deleteEnabled")!=undefined){n.forEach(e=>{if(e.selected){T(a,e)}})}a.setProperty("deleteEnabled",n.some(e=>!e.selected))}if(l.length===1){s.show(e.getTranslatedText("C_TRANSACTION_HELPER_DELETE_TOAST_SINGULAR",o,undefined,i))}else{s.show(e.getTranslatedText("C_TRANSACTION_HELPER_DELETE_TOAST_PLURAL",o,undefined,i))}}function r(e){const t=e.getObject()["DraftAdministrativeData"];return t&&t["InProcessByUser"]||""}function c(t,n,s){let l="";if(n===1&&s.length===1){const n=r(s[0]);l=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_OBJECT_LOCKED",t,[n])}else if(s.length==1){const o=r(s[0]);l=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_ONE_OBJECT_LOCKED",t,[n,o])}else if(s.length>1){l=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_LOCKED",t,[s.length,n])}return l}function f(t,n,s){let l="";if(s===n){if(n===1){l=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_ONLY_DRAFT_OF_NON_DELETABLE_ACTIVE",t)}else{l=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_ONLY_DRAFTS_OF_NON_DELETABLE_ACTIVE",t)}}else if(n===1){l=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_DRAFT_OF_NON_DELETABLE_ACTIVE",t)}else{l=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_DRAFTS_OF_NON_DELETABLE_ACTIVE",t)}return l}function C(e){const t=e.getObject()["DraftAdministrativeData"];let n="";if(t){n=t["LastChangedByUserDescription"]||t["LastChangedByUser"]||""}return n}function N(t,n,s,l){let o="",a="",i=false;if(n===1&&s.length===1){const n=C(s[0]);o=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_CHANGES",t,[n]);i=true}else if(n===s.length){o=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_CHANGES_MULTIPLE_OBJECTS",t);i=true}else if(l===s.length){if(s.length===1){const n=C(s[0]);o=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_SINGULAR",t,[n])}else{o=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_PLURAL",t)}i=true}else if(l>s.length){if(s.length===1){const n=C(s[0]);a=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_SINGULAR",t,[n])}else{a=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_PLURAL",t)}}return{infoTxt:o,optionTxt:a,optionWithoutTxt:i}}function d(t,n,s){const{numberOfSelectedContexts:l,lockedContexts:o,draftsWithNonDeletableActive:a}=t;const i=l-(o.length+n-a.length);let E="";if(i>0&&(n===0||a.length===n)){if(o.length>0){if(i===1){E=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_ALL_REMAINING_NON_DELETABLE_SINGULAR",s,undefined)}else{E=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_ALL_REMAINING_NON_DELETABLE_PLURAL",s,undefined)}}else if(i===1){E=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_AND_ONE_OBJECT_NON_DELETABLE",s,undefined)}else{E=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_MULTIPLE_AND_ALL_OBJECT_NON_DELETABLE",s,undefined)}}else if(i===1){E=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_ONE_OBJECT_NON_DELETABLE",s,[l])}else if(i>1){E=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_NON_DELETABLE",s,[i,l])}return E}function A(e,t){return t.reduce((e,t)=>t.selected?e.concat(t.contexts):e,e)}function D(e,t,n,s,o,E){const{numberOfSelectedContexts:T,draftsWithDeletableActive:_,unSavedContexts:r,createModeContexts:c,lockedContexts:f,draftsWithNonDeletableActive:C}=e;let N="",d="";if(_.length>0){_.forEach(e=>{t.push(e.siblingInfo.targetContext)})}if(c.length>0){c.forEach(e=>t.push(e))}if(f.length>0){d=x.getLockedObjectsText(s,T,f)||"";o.push(new l({text:d}))}if(T!=n-C.length+f.length){N=x.getNonDeletableText(e,n,s);o.push(new l({text:N}))}if(r.length>0){const e=x.getUnsavedContextsText(s,T,r,n)||{};if(e.infoTxt){o.push(new l({text:e.infoTxt}))}if(e.optionTxt||e.optionWithoutTxt){E.push({type:a.unSavedContexts,contexts:r,text:e.optionTxt,selected:true,control:i.CHECKBOX})}}if(C.length>0){const e=x.getNonDeletableActivesOfDraftsText(s,C.length,n)||"";if(e){E.push({type:a.draftsWithNonDeletableActive,contexts:C,text:e,selected:true,control:n>0?i.CHECKBOX:i.TEXT})}}}function O(e,t){if(e.length===1){const n=e[0];if(n.text){t.push(new l({text:n.text}))}}else if(e.length>1){e.forEach(e=>{if(e.control==="text"&&e.text){t.push(new l({text:e.text}))}});e.forEach(e=>{if(e.control==="checkBox"&&e.text){t.push(new n({text:e.text,selected:true,select:function(t){const n=t.getSource();const s=n.getSelected();e.selected=s}}))}})}}function g(t,n,s,l){const{numberOfSelectedContexts:o,entitySetName:E,parentControl:T,description:_,lockedContexts:r,draftsWithNonDeletableActive:c,unSavedContexts:f}=t;const C=n.length+c.length+f.length;const N=o-(r.length+C-c.length);if(o===1&&o===n.length){const t=n[0].getObject();const o=T;const r=o&&o.getParent().getIdentifierColumn();let c;let f=[];if(r){const n=r?t[r]:undefined;const l=_&&_.path?t[_.path]:undefined;if(n){if(l&&_&&r!==_.path){f=[n+" ",l]}else{f=[n,""]}c=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO",s,f,E)}else if(n){f=[n,""];c=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO",s,f,E)}else{c=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR",s,undefined,E)}}else{c=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR",s,undefined,E)}l.push({type:a.deletableContexts,contexts:n,text:c,selected:true,control:i.TEXT})}else if(f.length!==C&&o>0&&(n.length>0||f.length>0&&c.length>0)){if(o>n.length&&N+r.length>0){let t="";if(C===1){t=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR_NON_DELETABLE",s,undefined,E)}else{t=e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL_NON_DELETABLE",s,undefined,E)}l.unshift({type:a.deletableContexts,contexts:n,text:t,selected:true,control:i.TEXT})}else{const t=C===1?e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR",s,undefined,E):e.getTranslatedText("C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL",s,undefined,E);l.push({type:a.deletableContexts,contexts:n,text:t,selected:true,control:i.TEXT})}}}async function L(e,n,s,l,o,a){try{const i=x.getConfirmedDeletableContext([],e);const{beforeDeleteCallBack:E,parentControl:T}=n;if(E){await E({contexts:i})}if(i&&i.length){try{await Promise.all(i.map(function(e){if(a&&!e.getProperty("IsActiveEntity")){const n=i.length===1?true:false;return t.deleteDraft(e,o,n)}return e.delete()}));x.afterDeleteProcess(n,e,i,l)}catch(e){await s.showMessageDialog({control:T});throw e}}}catch(e){await s.showMessages();throw e}}async function I(e,n){const s=n.map(e=>{const n=e.getModel().getMetaModel().getMetaContext(e.getCanonicalPath());const s=n.getProperty("@Org.OData.Capabilities.V1.DeleteRestrictions/Deletable/$Path");const l=!s&&n.getProperty("@Org.OData.Capabilities.V1.DeleteRestrictions/Deletable")!==false;const o={context:e,isDraftRoot:!!n.getProperty("@com.sap.vocabularies.Common.v1.DraftRoot"),isDraftNode:!!n.getProperty("@com.sap.vocabularies.Common.v1.DraftNode"),isActive:true,hasActive:false,hasDraft:false,locked:false,deletable:s?e.getProperty(s):l,siblingPromise:Promise.resolve(undefined),siblingInfo:undefined,siblingDeletable:false};if(o.isDraftRoot){var a;o.locked=!!((a=e.getObject("DraftAdministrativeData"))!==null&&a!==void 0&&a.InProcessByUser);o.hasDraft=e.getProperty("HasDraftEntity")}if(o.isDraftRoot||o.isDraftNode){o.isActive=e.getProperty("IsActiveEntity");o.hasActive=e.getProperty("HasActiveEntity");if(!o.isActive&&o.hasActive){o.siblingPromise=t.computeSiblingInformation(e,e).then(async e=>{o.siblingInfo=e;if(s){var t;o.siblingDeletable=await(e===null||e===void 0?void 0:(t=e.targetContext)===null||t===void 0?void 0:t.requestProperty(s))}else{o.siblingDeletable=l}})}}return o});await Promise.all(s.map(e=>e.siblingPromise));const l=[{key:"draftsWithDeletableActive",value:s.filter(e=>e.isDraftRoot&&!e.isActive&&e.hasActive&&e.siblingDeletable)},{key:"draftsWithNonDeletableActive",value:s.filter(e=>!e.isActive&&e.hasActive&&!e.siblingDeletable)},{key:"lockedContexts",value:s.filter(e=>e.isDraftRoot&&e.isActive&&e.hasDraft&&e.locked)},{key:"unSavedContexts",value:s.filter(e=>e.isDraftRoot&&e.isActive&&e.hasDraft&&!e.locked)},{key:"deletableContexts",value:s.filter(e=>!e.isDraftRoot&&!e.isDraftNode&&e.deletable||e.isDraftRoot&&e.isActive&&!e.hasDraft&&e.deletable||e.isDraftRoot&&!e.isActive&&!e.hasActive||e.isDraftNode&&!e.isActive&&!e.hasActive||e.isDraftNode&&!e.isActive&&e.hasActive&&e.siblingDeletable)}];for(const{key:t,value:n}of l){e.setProperty(t,n.map(e=>t==="draftsWithDeletableActive"?{draft:e.context,siblingInfo:e.siblingInfo}:e.context))}}const x={getNonDeletableText:d,deleteConfirmHandler:L,updateOptionsForDeletableTexts:g,updateContentForDeleteDialog:O,updateDraftOptionsForDeletableTexts:D,getConfirmedDeletableContext:A,getLockedObjectsText:c,getUnsavedContextsText:N,getNonDeletableActivesOfDraftsText:f,afterDeleteProcess:_,updateDeleteInfoForSelectedContexts:I};return x},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/DynamicAnnotationPathHelper-dbg", ["sap/ui/base/BindingParser"], function (BindingParser) {
  "use strict";

  var _exports = {};
  function getObject(oObject, sPath) {
    if (!oObject) {
      return null;
    }
    const sPathSplit = sPath.split("/");
    if (sPathSplit.length === 1) {
      return oObject[sPath];
    } else {
      return getObject(oObject[sPathSplit[0]], sPathSplit.splice(1).join("/"));
    }
  }
  /**
   * Resolve a dynamic annotation path down to a standard annotation path.
   *
   * @param sAnnotationPath
   * @param oMetaModel
   * @returns The non dynamic version of the annotation path
   */
  function resolveDynamicExpression(sAnnotationPath, oMetaModel) {
    if (sAnnotationPath.indexOf("[") !== -1) {
      const firstBracket = sAnnotationPath.indexOf("[");
      const sStableBracket = sAnnotationPath.substr(0, firstBracket);
      const sRest = sAnnotationPath.substr(firstBracket + 1);
      const lastBracket = sRest.indexOf("]");
      const aValue = oMetaModel.getObject(sStableBracket);
      const oExpression = BindingParser.parseExpression(sRest.substr(0, lastBracket));
      if (Array.isArray(aValue) && oExpression && oExpression.result && oExpression.result.parts && oExpression.result.parts[0] && oExpression.result.parts[0].path) {
        let i;
        let bFound = false;
        for (i = 0; i < aValue.length && !bFound; i++) {
          const oObjectValue = getObject(aValue[i], oExpression.result.parts[0].path);
          const bResult = oExpression.result.formatter(oObjectValue);
          if (bResult) {
            bFound = true;
          }
        }
        if (bFound) {
          sAnnotationPath = resolveDynamicExpression(sStableBracket + (i - 1) + sRest.substr(lastBracket + 1), oMetaModel);
        }
      }
    }
    return sAnnotationPath;
  }
  _exports.resolveDynamicExpression = resolveDynamicExpression;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/DynamicAnnotationPathHelper", ["sap/ui/base/BindingParser"],function(s){"use strict";var t={};function r(s,t){if(!s){return null}const e=t.split("/");if(e.length===1){return s[t]}else{return r(s[e[0]],e.splice(1).join("/"))}}function e(t,n){if(t.indexOf("[")!==-1){const i=t.indexOf("[");const u=t.substr(0,i);const a=t.substr(i+1);const l=a.indexOf("]");const o=n.getObject(u);const f=s.parseExpression(a.substr(0,l));if(Array.isArray(o)&&f&&f.result&&f.result.parts&&f.result.parts[0]&&f.result.parts[0].path){let s;let i=false;for(s=0;s<o.length&&!i;s++){const t=r(o[s],f.result.parts[0].path);const e=f.result.formatter(t);if(e){i=true}}if(i){t=e(u+(s-1)+a.substr(l+1),n)}}}return t}t.resolveDynamicExpression=e;return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/EditState-dbg", [], function () {
  "use strict";

  const enumEditState = {
    CLEAN: 0,
    PROCESSED: 1,
    DIRTY: 2
  };
  let currentEditState = enumEditState.CLEAN;
  return {
    /**
     * This sets the edit state as dirty, meaning bindings have to be refreshed.
     *
     * @function
     * @name sap.fe.core.helpers.EditState#setEditStateDirty
     * @memberof sap.fe.core.helpers.EditState
     * @ui5-restricted
     * @final
     */
    setEditStateDirty: function () {
      currentEditState = enumEditState.DIRTY;
    },
    /**
     * This sets the edit state as processed, meaning is can be reset to clean after all bindings are refreshed.
     *
     * @function
     * @name sap.fe.core.helpers.EditState#setEditStateProcessed
     * @memberof sap.fe.core.helpers.EditState
     * @ui5-restricted
     * @final
     */
    setEditStateProcessed: function () {
      currentEditState = enumEditState.PROCESSED;
    },
    /**
     * Resets the edit state to the initial state.
     *
     * @function
     * @name sap.fe.core.helpers.EditState#resetEditState
     * @memberof sap.fe.core.helpers.EditState
     * @ui5-restricted
     * @final
     */
    resetEditState: function () {
      currentEditState = enumEditState.CLEAN;
    },
    /**
     * Returns true if the edit state is not clean, meaning bindings have to be refreshed
     *
     * @function
     * @name sap.fe.core.helpers.EditState#isEditStateDirty
     * @memberof sap.fe.core.helpers.EditState
     * @ui5-restricted
     * @final
     */

    isEditStateDirty: function () {
      return currentEditState !== enumEditState.CLEAN;
    },
    /**
     * Cleans the edit state if it has been processed, i.e. bindings have been properly refreshed.
     *
     * @function
     * @name sap.fe.core.helpers.EditState#cleanProcessedEditState
     * @memberof sap.fe.core.helpers.EditState
     * @ui5-restricted
     * @final
     */
    cleanProcessedEditState: function () {
      if (currentEditState === enumEditState.PROCESSED) {
        currentEditState = enumEditState.CLEAN;
      }
    }
  };
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/EditState", [],function(){"use strict";const t={CLEAN:0,PROCESSED:1,DIRTY:2};let e=t.CLEAN;return{setEditStateDirty:function(){e=t.DIRTY},setEditStateProcessed:function(){e=t.PROCESSED},resetEditState:function(){e=t.CLEAN},isEditStateDirty:function(){return e!==t.CLEAN},cleanProcessedEditState:function(){if(e===t.PROCESSED){e=t.CLEAN}}}},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ExcelFormatHelper-dbg", ["sap/ui/core/format/DateFormat"], function (DateFormat) {
  "use strict";

  const ExcelFormatHelper = {
    /**
     * Method for converting JS Date format to Excel custom date format.
     *
     * @returns Format for the Date column to be used on excel.
     */
    getExcelDatefromJSDate: function () {
      // Get date Format(pattern), which will be used for date format mapping between sapui5 and excel.
      // UI5_ANY
      let sJSDateFormat = DateFormat.getDateInstance().oFormatOptions.pattern.toLowerCase();
      if (sJSDateFormat) {
        // Checking for the existence of single 'y' in the pattern.
        const regex = /^[^y]*y[^y]*$/m;
        if (regex.exec(sJSDateFormat)) {
          sJSDateFormat = sJSDateFormat.replace("y", "yyyy");
        }
      }
      return sJSDateFormat;
    },
    getExcelDateTimefromJSDateTime: function () {
      // Get date Format(pattern), which will be used for date time format mapping between sapui5 and excel.
      // UI5_ANY
      let sJSDateTimeFormat = DateFormat.getDateTimeInstance().oFormatOptions.pattern.toLowerCase();
      if (sJSDateTimeFormat) {
        // Checking for the existence of single 'y' in the pattern.
        const regexYear = /^[^y]*y[^y]*$/m;
        if (regexYear.exec(sJSDateTimeFormat)) {
          sJSDateTimeFormat = sJSDateTimeFormat.replace("y", "yyyy");
        }
        if (sJSDateTimeFormat.includes("a")) {
          sJSDateTimeFormat = sJSDateTimeFormat.replace("a", "AM/PM");
        }
      }
      return sJSDateTimeFormat;
    },
    getExcelTimefromJSTime: function () {
      // Get date Format(pattern), which will be used for date time format mapping between sapui5 and excel.
      // UI5_ANY
      let sJSTimeFormat = DateFormat.getTimeInstance().oFormatOptions.pattern;
      if (sJSTimeFormat && sJSTimeFormat.includes("a")) {
        sJSTimeFormat = sJSTimeFormat.replace("a", "AM/PM");
      }
      return sJSTimeFormat;
    }
  };
  return ExcelFormatHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ExcelFormatHelper", ["sap/ui/core/format/DateFormat"],function(e){"use strict";const t={getExcelDatefromJSDate:function(){let t=e.getDateInstance().oFormatOptions.pattern.toLowerCase();if(t){const e=/^[^y]*y[^y]*$/m;if(e.exec(t)){t=t.replace("y","yyyy")}}return t},getExcelDateTimefromJSDateTime:function(){let t=e.getDateTimeInstance().oFormatOptions.pattern.toLowerCase();if(t){const e=/^[^y]*y[^y]*$/m;if(e.exec(t)){t=t.replace("y","yyyy")}if(t.includes("a")){t=t.replace("a","AM/PM")}}return t},getExcelTimefromJSTime:function(){let t=e.getTimeInstance().oFormatOptions.pattern;if(t&&t.includes("a")){t=t.replace("a","AM/PM")}return t}};return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/FPMHelper-dbg", ["sap/base/util/ObjectPath", "sap/fe/core/CommonUtils"], function (ObjectPath, CommonUtils) {
  "use strict";

  const FPMHelper = {
    actionWrapper: function (oEvent, sModule, sMethod, oParameters) {
      return new Promise(function (resolve) {
        //The source would be command execution, in case a command is defined for the action in the manifest.
        const oSource = oEvent.getSource ? oEvent.getSource() : oEvent.oSource,
          oView = CommonUtils.getTargetView(oSource),
          oBindingContext = oSource.getBindingContext();
        let oExtensionAPI;
        let aSelectedContexts;
        if (oParameters !== undefined) {
          aSelectedContexts = oParameters.contexts || [];
        } else if (oBindingContext !== undefined) {
          aSelectedContexts = [oBindingContext];
        } else {
          aSelectedContexts = [];
        }
        if (oView.getControllerName() === "sap.fe.templates.ObjectPage.ObjectPageController" || oView.getControllerName() === "sap.fe.templates.ListReport.ListReportController") {
          oExtensionAPI = oView.getController().getExtensionAPI();
        }
        if (sModule.startsWith("/extension/")) {
          const fnTarget = ObjectPath.get(sModule.replace(/\//g, ".").substr(1), oExtensionAPI);
          resolve(fnTarget[sMethod](oBindingContext, aSelectedContexts));
        } else {
          sap.ui.require([sModule], function (module) {
            // - we bind the action to the extensionAPI of the controller so it has the same scope as a custom section
            // - we provide the context as API, maybe if needed further properties
            resolve(module[sMethod].bind(oExtensionAPI)(oBindingContext, aSelectedContexts));
          });
        }
      });
    },
    validationWrapper: function (sModule, sMethod, oValidationContexts, oView, oBindingContext) {
      return new Promise(function (resolve) {
        let oExtensionAPI;
        if (oView.getControllerName() === "sap.fe.templates.ObjectPage.ObjectPageController" || oView.getControllerName() === "sap.fe.templates.ListReport.ListReportController") {
          oExtensionAPI = oView.getController().getExtensionAPI();
        }
        sap.ui.require([sModule], function (module) {
          // - we bind the action to the extensionAPI of the controller so it has the same scope as a custom section
          // - we provide the context as API, maybe if needed further properties
          resolve(module[sMethod].bind(oExtensionAPI)(oBindingContext, oValidationContexts));
        });
      });
    }
  };
  return FPMHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/FPMHelper", ["sap/base/util/ObjectPath","sap/fe/core/CommonUtils"],function(e,t){"use strict";const n={actionWrapper:function(n,o,r,i){return new Promise(function(s){const l=n.getSource?n.getSource():n.oSource,a=t.getTargetView(l),c=l.getBindingContext();let u;let p;if(i!==undefined){p=i.contexts||[]}else if(c!==undefined){p=[c]}else{p=[]}if(a.getControllerName()==="sap.fe.templates.ObjectPage.ObjectPageController"||a.getControllerName()==="sap.fe.templates.ListReport.ListReportController"){u=a.getController().getExtensionAPI()}if(o.startsWith("/extension/")){const t=e.get(o.replace(/\//g,".").substr(1),u);s(t[r](c,p))}else{sap.ui.require([o],function(e){s(e[r].bind(u)(c,p))})}})},validationWrapper:function(e,t,n,o,r){return new Promise(function(i){let s;if(o.getControllerName()==="sap.fe.templates.ObjectPage.ObjectPageController"||o.getControllerName()==="sap.fe.templates.ListReport.ListReportController"){s=o.getController().getExtensionAPI()}sap.ui.require([e],function(e){i(e[t].bind(s)(r,n))})})}};return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/KeepAliveHelper-dbg", ["sap/base/Log", "sap/fe/core/helpers/KeepAliveRefreshTypes", "./ModelHelper"], function (Log, KeepAliveRefreshTypes, ModelHelper) {
  "use strict";

  var RefreshStrategyType = KeepAliveRefreshTypes.RefreshStrategyType;
  var PATH_TO_STORE = KeepAliveRefreshTypes.PATH_TO_STORE;
  // Private functions - start
  const _fnSimplifyEntitySetPath = function (metaModel, entitySetPathToUse) {
    const entitySetPath = ModelHelper.getEntitySetPath(entitySetPathToUse);
    const entitySet = entitySetPath.indexOf("$NavigationPropertyBinding") > -1 && metaModel.getObject(entitySetPath);
    return entitySet ? `/${entitySet}` : entitySetPathToUse;
  };
  const _fnIsApplicable = function (primaryPath, key, strategy) {
    return primaryPath === key || strategy === RefreshStrategyType.IncludingDependents && primaryPath.startsWith(key);
  };
  /**
   * Check if given path resides in the context path provided.
   *
   * @param metaModel MetaModel to be used
   * @param contextPath Context path to be used
   * @param path Path to be used
   * @param strategy Strategy, it could be 'self' | 'includingDependents'
   * @returns Returns true if the context path is applicable.
   */
  const _isPathApplicableToContextPath = function (metaModel, contextPath, path, strategy) {
    let contextPathToCheck = contextPath.startsWith("/") ? contextPath : `/${contextPath}`,
      pathToCheck = path.startsWith("/") ? path : `/${path}`;
    if (!_fnIsApplicable(contextPathToCheck, pathToCheck, strategy)) {
      contextPathToCheck = _fnSimplifyEntitySetPath(metaModel, contextPathToCheck);
      if (!_fnIsApplicable(contextPathToCheck, pathToCheck, strategy)) {
        pathToCheck = _fnSimplifyEntitySetPath(metaModel, pathToCheck);
      } else {
        return true;
      }
    }
    return _fnIsApplicable(contextPathToCheck, pathToCheck, strategy);
  };
  // Private functions - end
  /**
   * Get controls to refresh in a view.
   *
   * @param view View of the controls
   * @param controls Context path to be used
   * @returns Returns controls that need to be refreshed.
   */
  const getControlsForRefresh = function (view, controls) {
    const controlsForRefresh = [];
    const metaModel = view.getModel().getMetaModel();
    const internalModel = view.getModel("internal");
    const refreshStrategy = internalModel.getProperty(PATH_TO_STORE) || {};
    if (controls) {
      controls.forEach(function (control) {
        const contextPath = control.data("targetCollectionPath");
        for (const key in refreshStrategy) {
          const strategy = refreshStrategy[key];
          if (controlsForRefresh.indexOf(control) === -1 && _isPathApplicableToContextPath(metaModel, contextPath, key, strategy)) {
            controlsForRefresh.push(control);
          }
        }
      });
    }
    return controlsForRefresh;
  };
  /**
   * Get refresh strategy for the control for a context path.
   *
   * @param control Control from which refresh info is needed
   * @param contextPath ContextPath for properities
   * @returns Returns strategy for control refresh.
   */
  const getControlRefreshStrategyForContextPath = function (control, contextPath) {
    const metaModel = control.getModel().getMetaModel();
    const internalModel = control.getModel("internal");
    const refreshStrategy = internalModel.getProperty(PATH_TO_STORE) || {};
    let strategy;
    if (contextPath) {
      for (const key in refreshStrategy) {
        const strategyToCheck = refreshStrategy[key];
        if (_isPathApplicableToContextPath(metaModel, contextPath, key, strategyToCheck)) {
          strategy = strategyToCheck;
          if (strategy === "includingDependents") {
            break;
          }
        }
      }
    }
    return strategy;
  };
  /**
   * Get refresh info from view.
   *
   * @param view View from which refresh info is needed
   * @returns Returns strategy for view refresh.
   */
  const getViewRefreshInfo = function (view) {
    const viewData = view.getViewData(),
      contextPath = viewData && ((viewData === null || viewData === void 0 ? void 0 : viewData.contextPath) || `/${viewData === null || viewData === void 0 ? void 0 : viewData.entitySet}`);
    return KeepAliveHelper.getControlRefreshStrategyForContextPath(view, contextPath);
  };

  /**
   * Get refresh strategy for an intent.
   *
   * @param refreshStrategies RefreshStrategies to consider
   * @param semanticObject Outbound Semantic Object
   * @param action Outbound Action
   * @returns Returns refresh strategies to use for the intent.
   */
  const getRefreshStrategyForIntent = function (refreshStrategies, semanticObject, action) {
    const soAction = semanticObject && action && `${semanticObject}-${action}`;
    const intents = refreshStrategies.intents;
    const soActionIntentMatch = intents && soAction && intents[soAction];
    const soIntentMatch = !soActionIntentMatch && intents && semanticObject && intents[semanticObject];
    return soActionIntentMatch || soIntentMatch || (refreshStrategies === null || refreshStrategies === void 0 ? void 0 : refreshStrategies.defaultBehavior) || (refreshStrategies === null || refreshStrategies === void 0 ? void 0 : refreshStrategies._feDefault);
  };
  /**
   * Store control refresh strategy for hash in the internal model.
   *
   * @param control Control for the refresh strategy
   * @param hash Shell hash object
   */
  const storeControlRefreshStrategyForHash = function (control, hash) {
    if (control && control.getModel("viewData") && control.getModel("internal")) {
      const viewData = control.getModel("viewData");
      const refreshStrategies = viewData.getProperty(PATH_TO_STORE);
      if (refreshStrategies) {
        const internalModel = control.getModel("internal");
        const refreshStrategy = KeepAliveHelper.getRefreshStrategyForIntent(refreshStrategies, hash === null || hash === void 0 ? void 0 : hash.semanticObject, hash === null || hash === void 0 ? void 0 : hash.action);
        internalModel.setProperty(PATH_TO_STORE, refreshStrategy);
      }
    }
  };

  /**
   * Method to refresh and restore the view if neccessary.
   *
   * @param view Control for the refresh strategy
   * @returns A promise after view refresh and restore are triggered
   */
  const restoreView = function (view) {
    const internalModelContext = view.getBindingContext("internal");
    const controller = view.getController();
    const viewState = controller === null || controller === void 0 ? void 0 : controller.viewState;
    let refreshBindings = Promise.resolve();
    if (internalModelContext && internalModelContext.getProperty("restoreStatus") === "pending") {
      if (viewState.refreshViewBindings) {
        refreshBindings = viewState.refreshViewBindings();
        refreshBindings.then(function () {
          Log.info(`FE V4: Refresh was triggered successfull: ${view.getId()}`);
        }).catch(function (err) {
          Log.warning(`FE V4: Refresh was unsuccessfull: ${view.getId()}`, err);
        });
      }
      refreshBindings = refreshBindings.then(function () {
        viewState.onRestore();
        internalModelContext.setProperty("restoreStatus", "done");
      }).catch(function (error) {
        Log.warning(`FE V4: Restore was unsuccessfull: ${view.getId()}`, error);
      });
    }
    return refreshBindings;
  };

  /**
   * helper class for KeepAlive feature in sap.fe.
   */
  const KeepAliveHelper = {
    getControlsForRefresh,
    getControlRefreshStrategyForContextPath,
    getViewRefreshInfo,
    getRefreshStrategyForIntent,
    storeControlRefreshStrategyForHash,
    restoreView
  };
  return KeepAliveHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/KeepAliveHelper", ["sap/base/Log","sap/fe/core/helpers/KeepAliveRefreshTypes","./ModelHelper"],function(t,e,n){"use strict";var o=e.RefreshStrategyType;var r=e.PATH_TO_STORE;const s=function(t,e){const o=n.getEntitySetPath(e);const r=o.indexOf("$NavigationPropertyBinding")>-1&&t.getObject(o);return r?`/${r}`:e};const i=function(t,e,n){return t===e||n===o.IncludingDependents&&t.startsWith(e)};const c=function(t,e,n,o){let r=e.startsWith("/")?e:`/${e}`,c=n.startsWith("/")?n:`/${n}`;if(!i(r,c,o)){r=s(t,r);if(!i(r,c,o)){c=s(t,c)}else{return true}}return i(r,c,o)};const a=function(t,e){const n=[];const o=t.getModel().getMetaModel();const s=t.getModel("internal");const i=s.getProperty(r)||{};if(e){e.forEach(function(t){const e=t.data("targetCollectionPath");for(const r in i){const s=i[r];if(n.indexOf(t)===-1&&c(o,e,r,s)){n.push(t)}}})}return n};const l=function(t,e){const n=t.getModel().getMetaModel();const o=t.getModel("internal");const s=o.getProperty(r)||{};let i;if(e){for(const t in s){const o=s[t];if(c(n,e,t,o)){i=o;if(i==="includingDependents"){break}}}}return i};const f=function(t){const e=t.getViewData(),n=e&&((e===null||e===void 0?void 0:e.contextPath)||`/${e===null||e===void 0?void 0:e.entitySet}`);return h.getControlRefreshStrategyForContextPath(t,n)};const u=function(t,e,n){const o=e&&n&&`${e}-${n}`;const r=t.intents;const s=r&&o&&r[o];const i=!s&&r&&e&&r[e];return s||i||(t===null||t===void 0?void 0:t.defaultBehavior)||(t===null||t===void 0?void 0:t._feDefault)};const g=function(t,e){if(t&&t.getModel("viewData")&&t.getModel("internal")){const n=t.getModel("viewData");const o=n.getProperty(r);if(o){const n=t.getModel("internal");const s=h.getRefreshStrategyForIntent(o,e===null||e===void 0?void 0:e.semanticObject,e===null||e===void 0?void 0:e.action);n.setProperty(r,s)}}};const d=function(e){const n=e.getBindingContext("internal");const o=e.getController();const r=o===null||o===void 0?void 0:o.viewState;let s=Promise.resolve();if(n&&n.getProperty("restoreStatus")==="pending"){if(r.refreshViewBindings){s=r.refreshViewBindings();s.then(function(){t.info(`FE V4: Refresh was triggered successfull: ${e.getId()}`)}).catch(function(n){t.warning(`FE V4: Refresh was unsuccessfull: ${e.getId()}`,n)})}s=s.then(function(){r.onRestore();n.setProperty("restoreStatus","done")}).catch(function(n){t.warning(`FE V4: Restore was unsuccessfull: ${e.getId()}`,n)})}return s};const h={getControlsForRefresh:a,getControlRefreshStrategyForContextPath:l,getViewRefreshInfo:f,getRefreshStrategyForIntent:u,storeControlRefreshStrategyForHash:g,restoreView:d};return h},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/KeepAliveRefreshTypes-dbg", [], function () {
  "use strict";

  var _exports = {};
  /**
   * Enumeration for supported refresh strategy type
   */
  let RefreshStrategyType;
  /**
   * Configuration of a RefreshStrategy
   */
  (function (RefreshStrategyType) {
    RefreshStrategyType["Self"] = "self";
    RefreshStrategyType["IncludingDependents"] = "includingDependents";
  })(RefreshStrategyType || (RefreshStrategyType = {}));
  _exports.RefreshStrategyType = RefreshStrategyType;
  /**
   * Path used to store information
   */
  const PATH_TO_STORE = "/refreshStrategyOnAppRestore";
  _exports.PATH_TO_STORE = PATH_TO_STORE;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/KeepAliveRefreshTypes", [],function(){"use strict";var e={};let n;(function(e){e["Self"]="self";e["IncludingDependents"]="includingDependents"})(n||(n={}));e.RefreshStrategyType=n;const t="/refreshStrategyOnAppRestore";e.PATH_TO_STORE=t;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/LoaderUtils-dbg", [], function () {
  "use strict";

  var _exports = {};
  async function requireDependencies(dependencyNames) {
    let resolveFn;
    const awaiter = new Promise(resolve => {
      resolveFn = resolve;
    });
    if (dependencyNames.length > 0) {
      sap.ui.require(dependencyNames, function () {
        for (var _len = arguments.length, dependencies = new Array(_len), _key = 0; _key < _len; _key++) {
          dependencies[_key] = arguments[_key];
        }
        resolveFn(dependencies);
      });
    } else {
      resolveFn([]);
    }
    return awaiter;
  }
  _exports.requireDependencies = requireDependencies;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/LoaderUtils", [],function(){"use strict";var e={};async function n(e){let n;const r=new Promise(e=>{n=e});if(e.length>0){sap.ui.require(e,function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++){r[i]=arguments[i]}n(r)})}else{n([])}return r}e.requireDependencies=n;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/MassEditHelper-dbg", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/library", "sap/fe/core/TemplateModel", "sap/fe/core/templating/DataModelPathHelper", "sap/fe/core/templating/PropertyHelper", "sap/fe/macros/field/FieldHelper", "sap/fe/macros/field/FieldTemplating", "sap/fe/macros/table/TableHelper", "sap/m/Button", "sap/m/Dialog", "sap/m/MessageToast", "sap/ui/core/Core", "sap/ui/core/Fragment", "sap/ui/core/util/XMLPreprocessor", "sap/ui/core/XMLTemplateProcessor", "sap/ui/mdc/enum/EditMode", "sap/ui/model/json/JSONModel", "../controllerextensions/messageHandler/messageHandling", "../controls/Any", "../converters/MetaModelConverter", "../templating/FieldControlHelper", "../templating/UIFormatters", "./SideEffectsHelper"], function (Log, CommonUtils, BindingToolkit, FELibrary, TemplateModel, DataModelPathHelper, PropertyHelper, FieldHelper, FieldTemplating, TableHelper, Button, Dialog, MessageToast, Core, Fragment, XMLPreprocessor, XMLTemplateProcessor, EditMode, JSONModel, messageHandling, Any, MetaModelConverter, FieldControlHelper, UIFormatters, SideEffectsHelper) {
  "use strict";

  var isMultiValueField = UIFormatters.isMultiValueField;
  var getRequiredExpression = UIFormatters.getRequiredExpression;
  var getEditMode = UIFormatters.getEditMode;
  var isReadOnlyExpression = FieldControlHelper.isReadOnlyExpression;
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  var convertMetaModelContext = MetaModelConverter.convertMetaModelContext;
  var setEditStyleProperties = FieldTemplating.setEditStyleProperties;
  var getTextBinding = FieldTemplating.getTextBinding;
  var hasValueHelpWithFixedValues = PropertyHelper.hasValueHelpWithFixedValues;
  var hasValueHelp = PropertyHelper.hasValueHelp;
  var hasUnit = PropertyHelper.hasUnit;
  var hasCurrency = PropertyHelper.hasCurrency;
  var getAssociatedUnitPropertyPath = PropertyHelper.getAssociatedUnitPropertyPath;
  var getAssociatedUnitProperty = PropertyHelper.getAssociatedUnitProperty;
  var getRelativePaths = DataModelPathHelper.getRelativePaths;
  var enhanceDataModelPath = DataModelPathHelper.enhanceDataModelPath;
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var not = BindingToolkit.not;
  var ifElse = BindingToolkit.ifElse;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  const MassEditHelper = {
    /**
     * Initializes the value at final or deepest level path with a blank array.
     * Return an empty array pointing to the final or deepest level path.
     *
     * @param sPath Property path
     * @param aValues Array instance where the default data needs to be added
     * @returns The final path
     */
    initLastLevelOfPropertyPath: function (sPath, aValues) {
      let aFinalPath;
      let index = 0;
      const aPaths = sPath.split("/");
      let sFullPath = "";
      aPaths.forEach(function (sPropertyPath) {
        if (!aValues[sPropertyPath] && index === 0) {
          aValues[sPropertyPath] = {};
          aFinalPath = aValues[sPropertyPath];
          sFullPath = sFullPath + sPropertyPath;
          index++;
        } else if (!aFinalPath[sPropertyPath]) {
          sFullPath = `${sFullPath}/${sPropertyPath}`;
          if (sFullPath !== sPath) {
            aFinalPath[sPropertyPath] = {};
            aFinalPath = aFinalPath[sPropertyPath];
          } else {
            aFinalPath[sPropertyPath] = [];
          }
        }
      });
      return aFinalPath;
    },
    /**
     * Method to get unique values for given array values.
     *
     * @param sValue Property value
     * @param index Index of the property value
     * @param self Instance of the array
     * @returns The unique value
     */
    getUniqueValues: function (sValue, index, self) {
      return sValue != undefined && sValue != null ? self.indexOf(sValue) === index : undefined;
    },
    /**
     * Gets the property value for a multi-level path (for example: _Materials/Material_Details gets the value of Material_Details under _Materials Object).
     * Returns the propertyValue, which can be of any type (string, number, etc..).
     *
     * @param sDataPropertyPath Property path
     * @param oValues Object of property values
     * @returns The property value
     */
    getValueForMultiLevelPath: function (sDataPropertyPath, oValues) {
      let result;
      if (sDataPropertyPath && sDataPropertyPath.indexOf("/") > 0) {
        const aPropertyPaths = sDataPropertyPath.split("/");
        aPropertyPaths.forEach(function (sPath) {
          result = oValues && oValues[sPath] ? oValues[sPath] : result && result[sPath];
        });
      }
      return result;
    },
    /**
     * Gets the key path for the key of a combo box that must be selected initially when the dialog opens:
     * => If propertyValue for all selected contexts is different, then < Keep Existing Values > is preselected.
     * => If propertyValue for all selected contexts is the same, then the propertyValue is preselected.
     * => If propertyValue for all selected contexts is empty, then < Leave Blank > is preselected.
     *
     *
     * @param aContexts Contexts for mass edit
     * @param sDataPropertyPath Data property path
     * @returns The key path
     */
    getDefaultSelectionPathComboBox: function (aContexts, sDataPropertyPath) {
      let result;
      if (sDataPropertyPath && aContexts.length > 0) {
        const oSelectedContext = aContexts,
          aPropertyValues = [];
        oSelectedContext.forEach(function (oContext) {
          const oDataObject = oContext.getObject();
          const sMultiLevelPathCondition = sDataPropertyPath.indexOf("/") > -1 && oDataObject.hasOwnProperty(sDataPropertyPath.split("/")[0]);
          if (oContext && (oDataObject.hasOwnProperty(sDataPropertyPath) || sMultiLevelPathCondition)) {
            aPropertyValues.push(oContext.getObject(sDataPropertyPath));
          }
        });
        const aUniquePropertyValues = aPropertyValues.filter(MassEditHelper.getUniqueValues);
        if (aUniquePropertyValues.length > 1) {
          result = `Default/${sDataPropertyPath}`;
        } else if (aUniquePropertyValues.length === 0) {
          result = `Empty/${sDataPropertyPath}`;
        } else if (aUniquePropertyValues.length === 1) {
          result = `${sDataPropertyPath}/${aUniquePropertyValues[0]}`;
        }
      }
      return result;
    },
    /**
     * Checks hidden annotation value [both static and path based] for table's selected context.
     *
     * @param hiddenValue Hidden annotation value / path for field
     * @param aContexts Contexts for mass edit
     * @returns The hidden annotation value
     */
    getHiddenValueForContexts: function (hiddenValue, aContexts) {
      if (hiddenValue && hiddenValue.$Path) {
        return !aContexts.some(function (oSelectedContext) {
          return oSelectedContext.getObject(hiddenValue.$Path) === false;
        });
      }
      return hiddenValue;
    },
    getInputType: function (propertyInfo, dataFieldConverted, oDataModelPath) {
      const editStyleProperties = {};
      let inputType;
      if (propertyInfo) {
        setEditStyleProperties(editStyleProperties, dataFieldConverted, oDataModelPath, true);
        inputType = (editStyleProperties === null || editStyleProperties === void 0 ? void 0 : editStyleProperties.editStyle) || "";
      }
      const isValidForMassEdit = inputType && ["DatePicker", "TimePicker", "DateTimePicker", "RatingIndicator"].indexOf(inputType) === -1 && !isMultiValueField(oDataModelPath) && !hasValueHelpWithFixedValues(propertyInfo);
      return (isValidForMassEdit || "") && inputType;
    },
    getIsFieldGrp: function (dataFieldConverted) {
      return dataFieldConverted && dataFieldConverted.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAnnotation" && dataFieldConverted.Target && dataFieldConverted.Target.value && dataFieldConverted.Target.value.indexOf("FieldGroup") > -1;
    },
    /**
     * Get text path for the mass edit field.
     *
     * @param property Property path
     * @param textBinding Text Binding Info
     * @param displayMode Display mode
     * @returns Text Property Path if it exists
     */
    getTextPath: function (property, textBinding, displayMode) {
      let descriptionPath;
      if (textBinding && (textBinding.path || textBinding.parameters && textBinding.parameters.length) && property) {
        if (textBinding.path && displayMode === "Description") {
          descriptionPath = textBinding.path;
        } else if (textBinding.parameters) {
          textBinding.parameters.forEach(function (props) {
            if (props.path && props.path !== property) {
              descriptionPath = props.path;
            }
          });
        }
      }
      return descriptionPath;
    },
    /**
     * Initializes a JSON Model for properties of dialog fields [label, visiblity, dataproperty, etc.].
     *
     * @param oTable Instance of Table
     * @param aContexts Contexts for mass edit
     * @param aDataArray Array containing data related to the dialog used by both the static and the runtime model
     * @returns The model
     */
    prepareDataForDialog: function (oTable, aContexts, aDataArray) {
      const oMetaModel = oTable && oTable.getModel().getMetaModel(),
        sCurrentEntitySetName = oTable.data("metaPath"),
        aTableFields = MassEditHelper.getTableFields(oTable),
        oEntityTypeContext = oMetaModel.getContext(`${sCurrentEntitySetName}/@`),
        oEntitySetContext = oMetaModel.getContext(sCurrentEntitySetName),
        oDataModelObjectPath = getInvolvedDataModelObjects(oEntityTypeContext);
      const oDataFieldModel = new JSONModel();
      let oResult;
      let sLabelText;
      let bValueHelpEnabled;
      let sUnitPropertyPath;
      let bValueHelpEnabledForUnit;
      let oTextBinding;
      aTableFields.forEach(function (oColumnInfo) {
        const sDataPropertyPath = oColumnInfo.dataProperty;
        if (sDataPropertyPath) {
          var _oDataFieldConverted$, _oDataFieldConverted$2, _oPropertyInfo, _oPropertyInfo$annota, _oPropertyInfo$annota2, _unitPropertyInfo$ann, _unitPropertyInfo$ann2;
          let oPropertyInfo = sDataPropertyPath && oMetaModel.getObject(`${sCurrentEntitySetName}/${sDataPropertyPath}@`);
          sLabelText = oColumnInfo.label || oPropertyInfo && oPropertyInfo["@com.sap.vocabularies.Common.v1.Label"] || sDataPropertyPath;
          if (oDataModelObjectPath) {
            oDataModelObjectPath.targetObject = oDataModelObjectPath.targetEntityType.entityProperties.filter(function (oProperty) {
              return oProperty.name === sDataPropertyPath;
            });
          }
          oDataModelObjectPath.targetObject = oDataModelObjectPath.targetObject[0] || {};
          oTextBinding = getTextBinding(oDataModelObjectPath, {}, true) || {};
          const oFieldContext = oMetaModel.getContext(oColumnInfo.annotationPath),
            oDataFieldConverted = convertMetaModelContext(oFieldContext),
            oPropertyContext = oMetaModel.getContext(`${sCurrentEntitySetName}/${sDataPropertyPath}@`),
            oInterface = oPropertyContext && oPropertyContext.getInterface();
          let oDataModelPath = getInvolvedDataModelObjects(oFieldContext, oEntitySetContext);
          if ((oDataFieldConverted === null || oDataFieldConverted === void 0 ? void 0 : (_oDataFieldConverted$ = oDataFieldConverted.Value) === null || _oDataFieldConverted$ === void 0 ? void 0 : (_oDataFieldConverted$2 = _oDataFieldConverted$.path) === null || _oDataFieldConverted$2 === void 0 ? void 0 : _oDataFieldConverted$2.length) > 0) {
            oDataModelPath = enhanceDataModelPath(oDataModelPath, sDataPropertyPath);
          }
          const bHiddenField = MassEditHelper.getHiddenValueForContexts(oFieldContext && oFieldContext.getObject()["@com.sap.vocabularies.UI.v1.Hidden"], aContexts) || false;
          const isImage = oPropertyInfo && oPropertyInfo["@com.sap.vocabularies.UI.v1.IsImageURL"];
          oInterface.context = {
            getModel: function () {
              return oInterface.getModel();
            },
            getPath: function () {
              return `${sCurrentEntitySetName}/${sDataPropertyPath}`;
            }
          };
          oPropertyInfo = oDataFieldConverted._type === "Property" ? oDataFieldConverted : oDataFieldConverted && oDataFieldConverted.Value && oDataFieldConverted.Value.$target || oDataFieldConverted && oDataFieldConverted.Target && oDataFieldConverted.Target.$target;
          // Datafield is not included in the FieldControl calculation, needs to be implemented

          const chartProperty = oPropertyInfo && oPropertyInfo.term && oPropertyInfo.term === "com.sap.vocabularies.UI.v1.Chart";
          const isAction = !!oDataFieldConverted.Action;
          const isFieldGrp = MassEditHelper.getIsFieldGrp(oDataFieldConverted);
          if (isImage || bHiddenField || chartProperty || isAction || isFieldGrp) {
            return;
          }

          // ValueHelp properties
          sUnitPropertyPath = (hasCurrency(oPropertyInfo) || hasUnit(oPropertyInfo)) && getAssociatedUnitPropertyPath(oPropertyInfo) || "";
          const unitPropertyInfo = sUnitPropertyPath && getAssociatedUnitProperty(oPropertyInfo);
          bValueHelpEnabled = hasValueHelp(oPropertyInfo);
          bValueHelpEnabledForUnit = unitPropertyInfo && hasValueHelp(unitPropertyInfo);
          const hasContextDependentVH = (bValueHelpEnabled || bValueHelpEnabledForUnit) && (((_oPropertyInfo = oPropertyInfo) === null || _oPropertyInfo === void 0 ? void 0 : (_oPropertyInfo$annota = _oPropertyInfo.annotations) === null || _oPropertyInfo$annota === void 0 ? void 0 : (_oPropertyInfo$annota2 = _oPropertyInfo$annota.Common) === null || _oPropertyInfo$annota2 === void 0 ? void 0 : _oPropertyInfo$annota2.ValueListRelevantQualifiers) || unitPropertyInfo && (unitPropertyInfo === null || unitPropertyInfo === void 0 ? void 0 : (_unitPropertyInfo$ann = unitPropertyInfo.annotations) === null || _unitPropertyInfo$ann === void 0 ? void 0 : (_unitPropertyInfo$ann2 = _unitPropertyInfo$ann.Common) === null || _unitPropertyInfo$ann2 === void 0 ? void 0 : _unitPropertyInfo$ann2.ValueListRelevantQualifiers));
          if (hasContextDependentVH) {
            // context dependent VH is not supported for Mass Edit.
            return;
          }

          // EditMode and InputType
          const propertyForFieldControl = oPropertyInfo && oPropertyInfo.Value ? oPropertyInfo.Value : oPropertyInfo;
          const expBinding = getEditMode(propertyForFieldControl, oDataModelPath, false, false, oDataFieldConverted, constant(true));
          const editModeValues = Object.keys(EditMode);
          const editModeIsStatic = !!expBinding && editModeValues.includes(expBinding);
          const editable = !!expBinding && (editModeIsStatic && expBinding === EditMode.Editable || !editModeIsStatic);
          const navPropertyWithValueHelp = sDataPropertyPath.includes("/") && bValueHelpEnabled;
          if (!editable || navPropertyWithValueHelp) {
            return;
          }
          const inputType = MassEditHelper.getInputType(oPropertyInfo, oDataFieldConverted, oDataModelPath);
          if (inputType) {
            const relativePath = getRelativePaths(oDataModelPath);
            const isReadOnly = isReadOnlyExpression(oPropertyInfo, relativePath);
            const displayMode = CommonUtils.computeDisplayMode(oPropertyContext.getObject());
            const isValueHelpEnabled = bValueHelpEnabled ? bValueHelpEnabled : false;
            const isValueHelpEnabledForUnit = bValueHelpEnabledForUnit && !sUnitPropertyPath.includes("/") ? bValueHelpEnabledForUnit : false;
            const unitProperty = sUnitPropertyPath && !sDataPropertyPath.includes("/") ? sUnitPropertyPath : false;
            oResult = {
              label: sLabelText,
              dataProperty: sDataPropertyPath,
              isValueHelpEnabled: bValueHelpEnabled ? bValueHelpEnabled : false,
              unitProperty,
              isFieldRequired: getRequiredExpression(oPropertyInfo, oDataFieldConverted, true, false, {}, oDataModelPath),
              defaultSelectionPath: sDataPropertyPath ? MassEditHelper.getDefaultSelectionPathComboBox(aContexts, sDataPropertyPath) : false,
              defaultSelectionUnitPath: sUnitPropertyPath ? MassEditHelper.getDefaultSelectionPathComboBox(aContexts, sUnitPropertyPath) : false,
              entitySet: sCurrentEntitySetName,
              display: displayMode,
              descriptionPath: MassEditHelper.getTextPath(sDataPropertyPath, oTextBinding, displayMode),
              nullable: oPropertyInfo.nullable !== undefined ? oPropertyInfo.nullable : true,
              isPropertyReadOnly: isReadOnly !== undefined ? isReadOnly : false,
              inputType: inputType,
              editMode: editable ? expBinding : undefined,
              propertyInfo: {
                hasVH: isValueHelpEnabled,
                runtimePath: "fieldsInfo>/values/",
                relativePath: sDataPropertyPath,
                propertyPathForValueHelp: `${sCurrentEntitySetName}/${sDataPropertyPath}`
              },
              unitInfo: unitProperty && {
                hasVH: isValueHelpEnabledForUnit,
                runtimePath: "fieldsInfo>/unitData/",
                relativePath: unitProperty,
                propertyPathForValueHelp: `${sCurrentEntitySetName}/${unitProperty}`
              }
            };
            aDataArray.push(oResult);
          }
        }
      });
      oDataFieldModel.setData(aDataArray);
      return oDataFieldModel;
    },
    getTableFields: function (oTable) {
      const aColumns = oTable && oTable.getColumns() || [];
      const columnsData = oTable && oTable.getParent().getTableDefinition().columns;
      return aColumns.map(function (oColumn) {
        const sDataProperty = oColumn && oColumn.getDataProperty(),
          aRealtedColumnInfo = columnsData && columnsData.filter(function (oColumnInfo) {
            return oColumnInfo.name === sDataProperty && oColumnInfo.type === "Annotation";
          });
        return {
          dataProperty: sDataProperty,
          label: oColumn.getHeader(),
          annotationPath: aRealtedColumnInfo && aRealtedColumnInfo[0] && aRealtedColumnInfo[0].annotationPath
        };
      });
    },
    getDefaultTextsForDialog: function (oResourceBundle, iSelectedContexts, oTable) {
      // The confirm button text is "Save" for table in Display mode and "Apply" for table in edit mode. This can be later exposed if needed.
      const bDisplayMode = oTable.data("displayModePropertyBinding") === "true";
      return {
        keepExistingPrefix: "< Keep",
        leaveBlankValue: "< Leave Blank >",
        clearFieldValue: "< Clear Values >",
        massEditTitle: oResourceBundle.getText("C_MASS_EDIT_DIALOG_TITLE", iSelectedContexts.toString()),
        applyButtonText: bDisplayMode ? oResourceBundle.getText("C_MASS_EDIT_SAVE_BUTTON_TEXT") : oResourceBundle.getText("C_MASS_EDIT_APPLY_BUTTON_TEXT"),
        useValueHelpValue: "< Use Value Help >",
        cancelButtonText: oResourceBundle.getText("C_COMMON_OBJECT_PAGE_CANCEL"),
        noFields: oResourceBundle.getText("C_MASS_EDIT_NO_EDITABLE_FIELDS"),
        okButtonText: oResourceBundle.getText("C_COMMON_DIALOG_OK")
      };
    },
    /**
     * Adds a suffix to the 'keep existing' property of the comboBox.
     *
     * @param sInputType InputType of the field
     * @returns The modified string
     */
    // getSuffixForKeepExisiting: function (sInputType: string) {
    // 	let sResult = "Values";

    // 	switch (sInputType) {
    // 		//TODO - Add for other control types as well (Radio Button, Email, Input, MDC Fields, Image etc.)
    // 		case "DatePicker":
    // 			sResult = "Dates";
    // 			break;
    // 		case "CheckBox":
    // 			sResult = "Settings";
    // 			break;
    // 		default:
    // 			sResult = "Values";
    // 	}
    // 	return sResult;
    // },

    /**
     * Adds default values to the model [Keep Existing Values, Leave Blank].
     *
     * @param aValues Array instance where the default data needs to be added
     * @param oDefaultValues Default values from Application Manifest
     * @param oPropertyInfo Property information
     * @param bUOMField
     */
    setDefaultValuesToDialog: function (aValues, oDefaultValues, oPropertyInfo, bUOMField) {
      const sPropertyPath = bUOMField ? oPropertyInfo.unitProperty : oPropertyInfo.dataProperty,
        sInputType = oPropertyInfo.inputType,
        bPropertyRequired = oPropertyInfo.isFieldRequired;
      // const sSuffixForKeepExisting = MassEditHelper.getSuffixForKeepExisiting(sInputType);
      const sSuffixForKeepExisting = "Values";
      aValues.defaultOptions = aValues.defaultOptions || [];
      const selectOptionsExist = aValues.selectOptions && aValues.selectOptions.length > 0;
      const keepEntry = {
        text: `${oDefaultValues.keepExistingPrefix} ${sSuffixForKeepExisting} >`,
        key: `Default/${sPropertyPath}`
      };
      if (sInputType === "CheckBox") {
        const falseEntry = {
          text: "No",
          key: `${sPropertyPath}/false`,
          textInfo: {
            value: false
          }
        };
        const truthyEntry = {
          text: "Yes",
          key: `${sPropertyPath}/true`,
          textInfo: {
            value: true
          }
        };
        aValues.unshift(falseEntry);
        aValues.defaultOptions.unshift(falseEntry);
        aValues.unshift(truthyEntry);
        aValues.defaultOptions.unshift(truthyEntry);
        aValues.unshift(keepEntry);
        aValues.defaultOptions.unshift(keepEntry);
      } else {
        var _oPropertyInfo$proper, _oPropertyInfo$unitIn;
        if (oPropertyInfo !== null && oPropertyInfo !== void 0 && (_oPropertyInfo$proper = oPropertyInfo.propertyInfo) !== null && _oPropertyInfo$proper !== void 0 && _oPropertyInfo$proper.hasVH || oPropertyInfo !== null && oPropertyInfo !== void 0 && (_oPropertyInfo$unitIn = oPropertyInfo.unitInfo) !== null && _oPropertyInfo$unitIn !== void 0 && _oPropertyInfo$unitIn.hasVH && bUOMField) {
          const vhdEntry = {
            text: oDefaultValues.useValueHelpValue,
            key: `UseValueHelpValue/${sPropertyPath}`
          };
          aValues.unshift(vhdEntry);
          aValues.defaultOptions.unshift(vhdEntry);
        }
        if (selectOptionsExist) {
          if (bPropertyRequired !== "true" && !bUOMField) {
            const clearEntry = {
              text: oDefaultValues.clearFieldValue,
              key: `ClearFieldValue/${sPropertyPath}`
            };
            aValues.unshift(clearEntry);
            aValues.defaultOptions.unshift(clearEntry);
          }
          aValues.unshift(keepEntry);
          aValues.defaultOptions.unshift(keepEntry);
        } else {
          const emptyEntry = {
            text: oDefaultValues.leaveBlankValue,
            key: `Default/${sPropertyPath}`
          };
          aValues.unshift(emptyEntry);
          aValues.defaultOptions.unshift(emptyEntry);
        }
      }
    },
    /**
     * Get text arrangement info for a context property.
     *
     * @param property Property Path
     * @param descriptionPath Path to text association of the property
     * @param displayMode Display mode of the property and text association
     * @param selectedContext Context to find the full text
     * @returns The text arrangement
     */
    getTextArrangementInfo: function (property, descriptionPath, displayMode, selectedContext) {
      let value = selectedContext.getObject(property),
        descriptionValue,
        fullText;
      if (descriptionPath && property) {
        switch (displayMode) {
          case "Description":
            descriptionValue = selectedContext.getObject(descriptionPath) || "";
            fullText = descriptionValue;
            break;
          case "Value":
            value = selectedContext.getObject(property) || "";
            fullText = value;
            break;
          case "ValueDescription":
            value = selectedContext.getObject(property) || "";
            descriptionValue = selectedContext.getObject(descriptionPath) || "";
            fullText = descriptionValue ? `${value} (${descriptionValue})` : value;
            break;
          case "DescriptionValue":
            value = selectedContext.getObject(property) || "";
            descriptionValue = selectedContext.getObject(descriptionPath) || "";
            fullText = descriptionValue ? `${descriptionValue} (${value})` : value;
            break;
          default:
            Log.info(`Display Property not applicable: ${property}`);
            break;
        }
      }
      return {
        textArrangement: displayMode,
        valuePath: property,
        descriptionPath: descriptionPath,
        value: value,
        description: descriptionValue,
        fullText: fullText
      };
    },
    /**
     * Return the visibility valuue for the ManagedObject Any.
     *
     * @param any The ManagedObject Any to be used to calculate the visible value of the binding.
     * @returns Returns true if the mass edit field is editable.
     */
    isEditable: function (any) {
      const binding = any.getBinding("any");
      const value = binding.getExternalValue();
      return value === EditMode.Editable;
    },
    /**
     * Calculate and update the visibility of mass edit field on change of the ManagedObject Any binding.
     *
     * @param oDialogDataModel Model to be used runtime.
     * @param dataProperty Field name.
     */
    onContextEditableChange: function (oDialogDataModel, dataProperty) {
      const objectsForVisibility = oDialogDataModel.getProperty(`/values/${dataProperty}/objectsForVisibility`) || [];
      const editable = objectsForVisibility.some(MassEditHelper.isEditable);
      if (editable) {
        oDialogDataModel.setProperty(`/values/${dataProperty}/visible`, editable);
      }
    },
    /**
     * Update Managed Object Any for visibility of the mass edit fields.
     *
     * @param mOToUse The ManagedObject Any to be used to calculate the visible value of the binding.
     * @param oDialogDataModel Model to be used runtime.
     * @param dataProperty Field name.
     * @param values Values of the field.
     */
    updateOnContextChange: function (mOToUse, oDialogDataModel, dataProperty, values) {
      const binding = mOToUse.getBinding("any");
      values.objectsForVisibility = values.objectsForVisibility || [];
      values.objectsForVisibility.push(mOToUse);
      binding === null || binding === void 0 ? void 0 : binding.attachChange(MassEditHelper.onContextEditableChange.bind(null, oDialogDataModel, dataProperty));
    },
    /**
     * Get bound object to calculate the visibility of contexts.
     *
     * @param expBinding Binding String object.
     * @param context Context the binding value.
     * @returns The ManagedObject Any to be used to calculate the visible value of the binding.
     */
    getBoundObject: function (expBinding, context) {
      const mOToUse = new Any({
        any: expBinding
      });
      const model = context.getModel();
      mOToUse.setModel(model);
      mOToUse.setBindingContext(context);
      return mOToUse;
    },
    /**
     * Get the visibility of the field.
     *
     * @param expBinding Binding String object.
     * @param oDialogDataModel Model to be used runtime.
     * @param dataProperty Field name.
     * @param values Values of the field.
     * @param context Context the binding value.
     * @returns Returns true if the mass edit field is editable.
     */
    getFieldVisiblity: function (expBinding, oDialogDataModel, dataProperty, values, context) {
      const mOToUse = MassEditHelper.getBoundObject(expBinding, context);
      const isContextEditable = MassEditHelper.isEditable(mOToUse);
      if (!isContextEditable) {
        MassEditHelper.updateOnContextChange(mOToUse, oDialogDataModel, dataProperty, values);
      }
      return isContextEditable;
    },
    /**
     * Initializes a runtime model:
     * => The model consists of values shown in the comboBox of the dialog (Leave Blank, Keep Existing Values, or any property value for the selected context, etc.)
     * => The model will capture runtime changes in the results property (the value entered in the comboBox).
     *
     * @param aContexts Contexts for mass edit
     * @param aDataArray Array containing data related to the dialog used by both the static and the runtime model
     * @param oDefaultValues Default values from i18n
     * @param dialogContext Transient context for mass edit dialog.
     * @returns The runtime model
     */
    setRuntimeModelOnDialog: function (aContexts, aDataArray, oDefaultValues, dialogContext) {
      const aValues = [];
      const aUnitData = [];
      const aResults = [];
      const textPaths = [];
      const aReadOnlyFieldInfo = [];
      const oData = {
        values: aValues,
        unitData: aUnitData,
        results: aResults,
        readablePropertyData: aReadOnlyFieldInfo,
        selectedKey: undefined,
        textPaths: textPaths,
        noFields: oDefaultValues.noFields
      };
      const oDialogDataModel = new JSONModel(oData);
      aDataArray.forEach(function (oInData) {
        let oTextInfo;
        let sPropertyKey;
        let sUnitPropertyName;
        const oDistinctValueMap = {};
        const oDistinctUnitMap = {};
        if (oInData.dataProperty && oInData.dataProperty.indexOf("/") > -1) {
          const aFinalPath = MassEditHelper.initLastLevelOfPropertyPath(oInData.dataProperty, aValues /*, dialogContext */);
          const aPropertyPaths = oInData.dataProperty.split("/");
          for (const context of aContexts) {
            const sMultiLevelPathValue = context.getObject(oInData.dataProperty);
            sPropertyKey = `${oInData.dataProperty}/${sMultiLevelPathValue}`;
            if (!oDistinctValueMap[sPropertyKey] && aFinalPath[aPropertyPaths[aPropertyPaths.length - 1]]) {
              oTextInfo = MassEditHelper.getTextArrangementInfo(oInData.dataProperty, oInData.descriptionPath, oInData.display, context);
              aFinalPath[aPropertyPaths[aPropertyPaths.length - 1]].push({
                text: oTextInfo && oTextInfo.fullText || sMultiLevelPathValue,
                key: sPropertyKey,
                textInfo: oTextInfo
              });
              oDistinctValueMap[sPropertyKey] = sMultiLevelPathValue;
            }
          }
          // if (Object.keys(oDistinctValueMap).length === 1) {
          // 	dialogContext.setProperty(oData.dataProperty, sPropertyKey && oDistinctValueMap[sPropertyKey]);
          // }

          aFinalPath[aPropertyPaths[aPropertyPaths.length - 1]].textInfo = {
            descriptionPath: oInData.descriptionPath,
            valuePath: oInData.dataProperty,
            displayMode: oInData.display
          };
        } else {
          aValues[oInData.dataProperty] = aValues[oInData.dataProperty] || [];
          aValues[oInData.dataProperty]["selectOptions"] = aValues[oInData.dataProperty]["selectOptions"] || [];
          if (oInData.unitProperty) {
            aUnitData[oInData.unitProperty] = aUnitData[oInData.unitProperty] || [];
            aUnitData[oInData.unitProperty]["selectOptions"] = aUnitData[oInData.unitProperty]["selectOptions"] || [];
          }
          for (const context of aContexts) {
            const oDataObject = context.getObject();
            sPropertyKey = `${oInData.dataProperty}/${oDataObject[oInData.dataProperty]}`;
            if (oInData.dataProperty && oDataObject[oInData.dataProperty] && !oDistinctValueMap[sPropertyKey]) {
              if (oInData.inputType != "CheckBox") {
                oTextInfo = MassEditHelper.getTextArrangementInfo(oInData.dataProperty, oInData.descriptionPath, oInData.display, context);
                const entry = {
                  text: oTextInfo && oTextInfo.fullText || oDataObject[oInData.dataProperty],
                  key: sPropertyKey,
                  textInfo: oTextInfo
                };
                aValues[oInData.dataProperty].push(entry);
                aValues[oInData.dataProperty]["selectOptions"].push(entry);
              }
              oDistinctValueMap[sPropertyKey] = oDataObject[oInData.dataProperty];
            }
            if (oInData.unitProperty && oDataObject[oInData.unitProperty]) {
              sUnitPropertyName = `${oInData.unitProperty}/${oDataObject[oInData.unitProperty]}`;
              if (!oDistinctUnitMap[sUnitPropertyName]) {
                if (oInData.inputType != "CheckBox") {
                  oTextInfo = MassEditHelper.getTextArrangementInfo(oInData.unitProperty, oInData.descriptionPath, oInData.display, context);
                  const unitEntry = {
                    text: oTextInfo && oTextInfo.fullText || oDataObject[oInData.unitProperty],
                    key: sUnitPropertyName,
                    textInfo: oTextInfo
                  };
                  aUnitData[oInData.unitProperty].push(unitEntry);
                  aUnitData[oInData.unitProperty]["selectOptions"].push(unitEntry);
                }
                oDistinctUnitMap[sUnitPropertyName] = oDataObject[oInData.unitProperty];
              }
            }
          }
          aValues[oInData.dataProperty].textInfo = {
            descriptionPath: oInData.descriptionPath,
            valuePath: oInData.dataProperty,
            displayMode: oInData.display
          };
          if (Object.keys(oDistinctValueMap).length === 1) {
            dialogContext.setProperty(oInData.dataProperty, sPropertyKey && oDistinctValueMap[sPropertyKey]);
          }
          if (Object.keys(oDistinctUnitMap).length === 1) {
            dialogContext.setProperty(oInData.unitProperty, sUnitPropertyName && oDistinctUnitMap[sUnitPropertyName]);
          }
        }
        textPaths[oInData.dataProperty] = oInData.descriptionPath ? [oInData.descriptionPath] : [];
      });
      aDataArray.forEach(function (oInData) {
        let values = {};
        if (oInData.dataProperty.indexOf("/") > -1) {
          const sMultiLevelPropPathValue = MassEditHelper.getValueForMultiLevelPath(oInData.dataProperty, aValues);
          if (!sMultiLevelPropPathValue) {
            sMultiLevelPropPathValue.push({
              text: oDefaultValues.leaveBlankValue,
              key: `Empty/${oInData.dataProperty}`
            });
          } else {
            MassEditHelper.setDefaultValuesToDialog(sMultiLevelPropPathValue, oDefaultValues, oInData);
          }
          values = sMultiLevelPropPathValue;
        } else if (aValues[oInData.dataProperty]) {
          aValues[oInData.dataProperty] = aValues[oInData.dataProperty] || [];
          MassEditHelper.setDefaultValuesToDialog(aValues[oInData.dataProperty], oDefaultValues, oInData);
          values = aValues[oInData.dataProperty];
        }
        if (aUnitData[oInData.unitProperty] && aUnitData[oInData.unitProperty].length) {
          MassEditHelper.setDefaultValuesToDialog(aUnitData[oInData.unitProperty], oDefaultValues, oInData, true);
          aUnitData[oInData.unitProperty].textInfo = {};
          aUnitData[oInData.unitProperty].selectedKey = MassEditHelper.getDefaultSelectionPathComboBox(aContexts, oInData.unitProperty);
          aUnitData[oInData.unitProperty].inputType = oInData.inputType;
        } else if (oInData.dataProperty && aValues[oInData.dataProperty] && !aValues[oInData.dataProperty].length || oInData.unitProperty && aUnitData[oInData.unitProperty] && !aUnitData[oInData.unitProperty].length) {
          const bClearFieldOrBlankValueExists = aValues[oInData.dataProperty] && aValues[oInData.dataProperty].some(function (obj) {
            return obj.text === "< Clear Values >" || obj.text === "< Leave Blank >";
          });
          if (oInData.dataProperty && !bClearFieldOrBlankValueExists) {
            aValues[oInData.dataProperty].push({
              text: oDefaultValues.leaveBlankValue,
              key: `Empty/${oInData.dataProperty}`
            });
          }
          const bClearFieldOrBlankUnitValueExists = aUnitData[oInData.unitProperty] && aUnitData[oInData.unitProperty].some(function (obj) {
            return obj.text === "< Clear Values >" || obj.text === "< Leave Blank >";
          });
          if (oInData.unitProperty) {
            if (!bClearFieldOrBlankUnitValueExists) {
              aUnitData[oInData.unitProperty].push({
                text: oDefaultValues.leaveBlankValue,
                key: `Empty/${oInData.unitProperty}`
              });
            }
            aUnitData[oInData.unitProperty].textInfo = {};
            aUnitData[oInData.unitProperty].selectedKey = MassEditHelper.getDefaultSelectionPathComboBox(aContexts, oInData.unitProperty);
            aUnitData[oInData.unitProperty].inputType = oInData.inputType;
          }
        }
        if (oInData.isPropertyReadOnly && typeof oInData.isPropertyReadOnly === "boolean") {
          aReadOnlyFieldInfo.push({
            property: oInData.dataProperty,
            value: oInData.isPropertyReadOnly,
            type: "Default"
          });
        } else if (oInData.isPropertyReadOnly && oInData.isPropertyReadOnly.operands && oInData.isPropertyReadOnly.operands[0] && oInData.isPropertyReadOnly.operands[0].operand1 && oInData.isPropertyReadOnly.operands[0].operand2) {
          // This needs to be refactored in accordance with the ReadOnlyExpression change
          aReadOnlyFieldInfo.push({
            property: oInData.dataProperty,
            propertyPath: oInData.isPropertyReadOnly.operands[0].operand1.path,
            propertyValue: oInData.isPropertyReadOnly.operands[0].operand2.value,
            type: "Path"
          });
        }

        // Setting visbility of the mass edit field.
        if (oInData.editMode) {
          values.visible = oInData.editMode === EditMode.Editable || aContexts.some(MassEditHelper.getFieldVisiblity.bind(MassEditHelper, oInData.editMode, oDialogDataModel, oInData.dataProperty, values));
        } else {
          values.visible = true;
        }
        values.selectedKey = MassEditHelper.getDefaultSelectionPathComboBox(aContexts, oInData.dataProperty);
        values.inputType = oInData.inputType;
        values.unitProperty = oInData.unitProperty;
      });
      return oDialogDataModel;
    },
    /**
     * Gets transient context for dialog.
     *
     * @param table Instance of Table.
     * @param dialog Mass Edit Dialog.
     * @returns Promise returning instance of dialog.
     */
    getDialogContext: function (table, dialog) {
      let transCtx = dialog && dialog.getBindingContext();
      if (!transCtx) {
        const model = table.getModel();
        const listBinding = table.getRowBinding();
        const transientListBinding = model.bindList(listBinding.getPath(), listBinding.getContext(), [], [], {
          $$updateGroupId: "submitLater"
        });
        transientListBinding.refreshInternal = function () {
          /* */
        };
        transCtx = transientListBinding.create({}, true);
      }
      return transCtx;
    },
    onDialogOpen: function (event) {
      const source = event.getSource();
      const fieldsInfoModel = source.getModel("fieldsInfo");
      fieldsInfoModel.setProperty("/isOpen", true);
    },
    closeDialog: function (oDialog) {
      oDialog.close();
      oDialog.destroy();
    },
    messageHandlingForMassEdit: async function (oTable, aContexts, oController, oInDialog, aResults, errorContexts) {
      var _oController$getView, _oController$getView$, _oController$getView4, _oController$getView5;
      const DraftStatus = FELibrary.DraftStatus;
      const oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core");
      (_oController$getView = oController.getView()) === null || _oController$getView === void 0 ? void 0 : (_oController$getView$ = _oController$getView.getBindingContext("internal")) === null || _oController$getView$ === void 0 ? void 0 : _oController$getView$.setProperty("getBoundMessagesForMassEdit", true);
      oController._editFlow.getMessageHandler().showMessages({
        onBeforeShowMessage: function (messages, showMessageParameters) {
          //messages.concatenate(messageHandling.getMessages(true, true));
          showMessageParameters.fnGetMessageSubtitle = messageHandling.setMessageSubtitle.bind({}, oTable, aContexts);
          const unboundErrors = [];
          messages.forEach(function (message) {
            if (!message.getTarget()) {
              unboundErrors.push(message);
            }
          });
          if (aResults.length > 0 && errorContexts.length === 0) {
            oController._editFlow.setDraftStatus(DraftStatus.Saved);
            const successToast = oResourceBundle.getText("C_MASS_EDIT_SUCCESS_TOAST");
            MessageToast.show(successToast);
          } else if (errorContexts.length < oTable.getSelectedContexts().length) {
            oController._editFlow.setDraftStatus(DraftStatus.Saved);
          } else if (errorContexts.length === oTable.getSelectedContexts().length) {
            oController._editFlow.setDraftStatus(DraftStatus.Clear);
          }
          if (oController.getModel("ui").getProperty("/isEditable") && unboundErrors.length === 0) {
            showMessageParameters.showMessageBox = false;
            showMessageParameters.showMessageDialog = false;
          }
          return showMessageParameters;
        }
      });
      if (oInDialog.isOpen()) {
        var _oController$getView2, _oController$getView3;
        MassEditHelper.closeDialog(oInDialog);
        (_oController$getView2 = oController.getView()) === null || _oController$getView2 === void 0 ? void 0 : (_oController$getView3 = _oController$getView2.getBindingContext("internal")) === null || _oController$getView3 === void 0 ? void 0 : _oController$getView3.setProperty("skipPatchHandlers", false);
      }
      (_oController$getView4 = oController.getView()) === null || _oController$getView4 === void 0 ? void 0 : (_oController$getView5 = _oController$getView4.getBindingContext("internal")) === null || _oController$getView5 === void 0 ? void 0 : _oController$getView5.setProperty("getBoundMessagesForMassEdit", false);
    },
    /**
     * This function generates side effects map from side effects ids(which is a combination of entity type and qualifier).
     *
     * @param oEntitySetContext
     * @param aSideEffects
     * @param oController
     * @param aResults
     * @returns Side effect map with data.
     */
    getSideEffectDataForKey: function (oEntitySetContext, aSideEffects, oController, aResults) {
      const sOwnerEntityType = oEntitySetContext.getProperty("$Type");
      const baseSideEffectsMapArray = {};
      aResults.forEach(result => {
        const sPath = result.keyValue;
        const sideEffectsArray = FieldHelper.getSideEffectsOnEntityAndProperty(sPath, sOwnerEntityType, aSideEffects);
        baseSideEffectsMapArray[sPath] = oController._sideEffects.getSideEffectsMapForFieldGroups(sideEffectsArray);
      });
      return baseSideEffectsMapArray;
    },
    /**
     * Give the entity type for a given spath for e.g.RequestedQuantity.
     *
     * @param sPath
     * @param sEntityType
     * @param oMetaModel
     * @returns Object having entity, spath and navigation path.
     */
    fnGetPathForSourceProperty: function (sPath, sEntityType, oMetaModel) {
      // if the property path has a navigation, get the target entity type of the navigation
      const sNavigationPath = sPath.indexOf("/") > 0 ? "/" + sEntityType + "/" + sPath.substr(0, sPath.lastIndexOf("/") + 1) + "@sapui.name" : false,
        pOwnerEntity = !sNavigationPath ? Promise.resolve(sEntityType) : oMetaModel.requestObject(sNavigationPath);
      sPath = sNavigationPath ? sPath.substr(sPath.lastIndexOf("/") + 1) : sPath;
      return {
        sPath,
        pOwnerEntity,
        sNavigationPath
      };
    },
    fnGetEntityTypeOfOwner: function (oMetaModel, baseNavPath, oEntitySetContext, targetEntity, aTargets) {
      const ownerEntityType = oEntitySetContext.getProperty("$Type");
      const {
        $Type: pOwner,
        $Partner: ownerNavPath
      } = oMetaModel.getObject(`${oEntitySetContext}/${baseNavPath}`); // nav path
      if (ownerNavPath) {
        const entityObjOfOwnerPartner = oMetaModel.getObject(`/${pOwner}/${ownerNavPath}`);
        if (entityObjOfOwnerPartner) {
          const entityTypeOfOwnerPartner = entityObjOfOwnerPartner["$Type"];
          // if the entity types defer, then base nav path is not from owner
          if (entityTypeOfOwnerPartner !== ownerEntityType) {
            // if target Prop is not from owner, we add it as immediate
            aTargets.push(targetEntity);
          }
        }
      } else {
        // if there is no $Partner attribute, it may not be from owner
        aTargets.push(targetEntity);
      }
      return aTargets;
    },
    /**
     * Give targets that are immediate or deferred based on the entity type of that target.
     *
     *
     * @param sideEffectsData
     * @param oEntitySetContext
     * @param sEntityType
     * @param oMetaModel
     * @returns Targets to request side effects.
     */
    fnGetTargetsForMassEdit: function (sideEffectsData, oEntitySetContext, sEntityType, oMetaModel) {
      const {
        TargetProperties: aTargetProperties,
        TargetEntities: aTargetEntities
      } = sideEffectsData;
      const aPromises = [];
      let aTargets = [];
      const ownerEntityType = oEntitySetContext.getProperty("$Type");
      if (sEntityType === ownerEntityType) {
        // if SalesOrdr Item
        aTargetEntities === null || aTargetEntities === void 0 ? void 0 : aTargetEntities.forEach(targetEntity => {
          targetEntity = targetEntity["$NavigationPropertyPath"];
          let baseNavPath;
          if (targetEntity.includes("/")) {
            baseNavPath = targetEntity.split("/")[0];
          } else {
            baseNavPath = targetEntity;
          }
          aTargets = MassEditHelper.fnGetEntityTypeOfOwner(oMetaModel, baseNavPath, oEntitySetContext, targetEntity, aTargets);
        });
      }
      if (aTargetProperties.length) {
        aTargetProperties.forEach(targetProp => {
          const {
            pOwnerEntity
          } = MassEditHelper.fnGetPathForSourceProperty(targetProp, sEntityType, oMetaModel);
          aPromises.push(pOwnerEntity.then(resultEntity => {
            // if entity is SalesOrderItem, Target Property is from Items table
            if (resultEntity === ownerEntityType) {
              aTargets.push(targetProp); // get immediate targets
            } else if (targetProp.includes("/")) {
              const baseNavPath = targetProp.split("/")[0];
              aTargets = MassEditHelper.fnGetEntityTypeOfOwner(oMetaModel, baseNavPath, oEntitySetContext, targetProp, aTargets);
            }
            return Promise.resolve(aTargets);
          }));
        });
      } else {
        aPromises.push(Promise.resolve(aTargets));
      }
      return Promise.all(aPromises);
    },
    /**
     * This function checks if in the given side Effects Obj, if _Item is set as Target Entity for any side Effects on
     * other entity set.
     *
     * @param sideEffectsMap
     * @param oEntitySetContext
     * @returns Length of sideEffectsArray where current Entity is set as Target Entity
     */
    checkIfEntityExistsAsTargetEntity: (sideEffectsMap, oEntitySetContext) => {
      const ownerEntityType = oEntitySetContext.getProperty("$Type");
      const sideEffectsOnOtherEntity = Object.values(sideEffectsMap).filter(obj => {
        return obj.name.indexOf(ownerEntityType) == -1;
      });
      const entitySetName = oEntitySetContext.getPath().split("/").pop();
      const sideEffectsWithCurrentEntityAsTarget = sideEffectsOnOtherEntity.filter(obj => {
        const targetEntitiesArray = obj.sideEffects.TargetEntities;
        return targetEntitiesArray !== null && targetEntitiesArray !== void 0 && targetEntitiesArray.filter(innerObj => innerObj["$NavigationPropertyPath"] === entitySetName).length ? obj : false;
      });
      return sideEffectsWithCurrentEntityAsTarget.length;
    },
    /**
     * Upon updating the field, array of immediate and deferred side effects for that field are created.
     * If there are any failed side effects for that context, they will also be used to generate the map.
     * If the field has text associated with it, then add it to request side effects.
     *
     * @param mParams
     * @param mParams.oController Controller
     * @param mParams.oFieldPromise Promise to update field
     * @param mParams.sideEffectMap SideEffectsMap for the field
     * @param mParams.textPaths TextPaths of the field if any
     * @param mParams.groupId Group Id to used to group requests
     * @param mParams.key KeyValue of the field
     * @param mParams.oEntitySetContext EntitySetcontext
     * @param mParams.oMetaModel Metamodel data
     * @param mParams.selectedContext Selected row context
     * @param mParams.deferredTargetsForAQualifiedName Deferred targets data
     * @returns Promise for all immediately requested side effects.
     */
    handleMassEditFieldUpdateAndRequestSideEffects: async function (mParams) {
      const {
        oController,
        oFieldPromise,
        sideEffectsMap,
        textPaths,
        groupId,
        key,
        oEntitySetContext,
        oMetaModel,
        oSelectedContext,
        deferredTargetsForAQualifiedName
      } = mParams;
      const immediateSideEffectsPromises = [oFieldPromise];
      const ownerEntityType = oEntitySetContext.getProperty("$Type");
      const oAppComponent = CommonUtils.getAppComponent(oController.getView());
      const oSideEffectsService = oAppComponent.getSideEffectsService();
      const isSideEffectsWithCurrentEntityAsTarget = MassEditHelper.checkIfEntityExistsAsTargetEntity(sideEffectsMap, oEntitySetContext);
      if (sideEffectsMap) {
        const allEntityTypesWithQualifier = Object.keys(sideEffectsMap);
        const sideEffectsDataForField = Object.values(sideEffectsMap);
        const mVisitedSideEffects = {};
        deferredTargetsForAQualifiedName[key] = {};
        for (const [index, data] of sideEffectsDataForField.entries()) {
          const entityTypeWithQualifier = allEntityTypesWithQualifier[index];
          const sEntityType = entityTypeWithQualifier.split("#")[0];
          const oContext = oController._sideEffects.getContextForSideEffects(oSelectedContext, sEntityType);
          data.context = oContext;
          const allFailedSideEffects = oController._sideEffects.getRegisteredFailedRequests();
          const aFailedSideEffects = allFailedSideEffects[oContext.getPath()];
          oController._sideEffects.unregisterFailedSideEffectsForAContext(oContext);
          let sideEffectsForCurrentContext = [data.sideEffects];
          sideEffectsForCurrentContext = aFailedSideEffects && aFailedSideEffects.length ? sideEffectsForCurrentContext.concat(aFailedSideEffects) : sideEffectsForCurrentContext;
          mVisitedSideEffects[oContext] = {};
          for (const aSideEffect of sideEffectsForCurrentContext) {
            if (!mVisitedSideEffects[oContext].hasOwnProperty(aSideEffect.fullyQualifiedName)) {
              mVisitedSideEffects[oContext][aSideEffect.fullyQualifiedName] = true;
              let aImmediateTargets = [],
                allTargets = [],
                triggerActionName;
              const fnGetImmediateTargetsAndActions = async function (mSideEffect) {
                const {
                  TargetProperties: aTargetProperties,
                  TargetEntities: aTargetEntities
                } = mSideEffect;
                const sideEffectEntityType = mSideEffect.fullyQualifiedName.split("@")[0];
                const targetsArrayForAllProperties = await MassEditHelper.fnGetTargetsForMassEdit(mSideEffect, oEntitySetContext, sideEffectEntityType, oMetaModel);
                aImmediateTargets = targetsArrayForAllProperties[0];
                allTargets = (aTargetProperties || []).concat(aTargetEntities || []);
                const actionName = mSideEffect.TriggerAction;
                const aDeferredTargets = allTargets.filter(target => {
                  return !aImmediateTargets.includes(target);
                });
                deferredTargetsForAQualifiedName[key][mSideEffect.fullyQualifiedName] = {
                  aTargets: aDeferredTargets,
                  oContext: oContext,
                  mSideEffect
                };

                // if entity is other than items table then action is defered
                if (actionName && sideEffectEntityType === ownerEntityType) {
                  // static action is on collection, so we defer it, else add to immediate requests array
                  const isStaticAction = TableHelper._isStaticAction(oMetaModel.getObject(`/${actionName}`), actionName);
                  if (!isStaticAction) {
                    triggerActionName = actionName;
                  } else {
                    deferredTargetsForAQualifiedName[key][mSideEffect.fullyQualifiedName]["TriggerAction"] = actionName;
                  }
                } else {
                  deferredTargetsForAQualifiedName[key][mSideEffect.fullyQualifiedName]["TriggerAction"] = actionName;
                }
                if (isSideEffectsWithCurrentEntityAsTarget) {
                  aImmediateTargets = [];
                }
                return {
                  aTargets: aImmediateTargets,
                  TriggerAction: triggerActionName
                };
              };
              immediateSideEffectsPromises.push(oController._sideEffects.requestSideEffects(aSideEffect, oContext, groupId, fnGetImmediateTargetsAndActions));
            }
          }
        }
      }
      if (textPaths !== null && textPaths !== void 0 && textPaths[key] && textPaths[key].length) {
        immediateSideEffectsPromises.push(oSideEffectsService.requestSideEffects(textPaths[key], oSelectedContext, groupId));
      }
      return Promise.allSettled(immediateSideEffectsPromises);
    },
    /**
     * Create the mass edit dialog.
     *
     * @param oTable Instance of Table
     * @param aContexts Contexts for mass edit
     * @param oController Controller for the view
     * @returns Promise returning instance of dialog.
     */
    createDialog: async function (oTable, aContexts, oController) {
      const sFragmentName = "sap/fe/core/controls/massEdit/MassEditDialog",
        aDataArray = [],
        oResourceBundle = Core.getLibraryResourceBundle("sap.fe.core"),
        oDefaultValues = MassEditHelper.getDefaultTextsForDialog(oResourceBundle, aContexts.length, oTable),
        oDataFieldModel = MassEditHelper.prepareDataForDialog(oTable, aContexts, aDataArray),
        dialogContext = MassEditHelper.getDialogContext(oTable),
        oDialogDataModel = MassEditHelper.setRuntimeModelOnDialog(aContexts, aDataArray, oDefaultValues, dialogContext),
        model = oTable.getModel(),
        metaModel = model.getMetaModel(),
        itemsModel = new TemplateModel(oDataFieldModel.getData(), metaModel);
      const oFragment = XMLTemplateProcessor.loadTemplate(sFragmentName, "fragment");
      const oCreatedFragment = await Promise.resolve(XMLPreprocessor.process(oFragment, {
        name: sFragmentName
      }, {
        bindingContexts: {
          dataFieldModel: itemsModel.createBindingContext("/"),
          metaModel: metaModel.createBindingContext("/"),
          contextPath: metaModel.createBindingContext(metaModel.getMetaPath(dialogContext.getPath()))
        },
        models: {
          dataFieldModel: itemsModel,
          metaModel: metaModel,
          contextPath: metaModel
        }
      }));
      const oDialogContent = await Fragment.load({
        definition: oCreatedFragment
      });
      const oDialog = new Dialog({
        resizable: true,
        title: oDefaultValues.massEditTitle,
        content: [oDialogContent],
        afterOpen: MassEditHelper.onDialogOpen,
        beginButton: new Button({
          text: MassEditHelper.helpers.getExpBindingForApplyButtonTxt(oDefaultValues, oDataFieldModel.getObject("/")),
          type: "Emphasized",
          press: async function (oEvent) {
            var _oController$getView6, _oController$getView7;
            messageHandling.removeBoundTransitionMessages();
            messageHandling.removeUnboundTransitionMessages();
            (_oController$getView6 = oController.getView()) === null || _oController$getView6 === void 0 ? void 0 : (_oController$getView7 = _oController$getView6.getBindingContext("internal")) === null || _oController$getView7 === void 0 ? void 0 : _oController$getView7.setProperty("skipPatchHandlers", true);
            const oInDialog = oEvent.getSource().getParent();
            const oModel = oInDialog.getModel("fieldsInfo");
            const aResults = oModel.getProperty("/results");
            const oMetaModel = oTable && oTable.getModel().getMetaModel(),
              sCurrentEntitySetName = oTable.data("metaPath"),
              oEntitySetContext = oMetaModel.getContext(sCurrentEntitySetName);
            const aSideEffects = await SideEffectsHelper.generateSideEffectsMapFromMetaModel(oMetaModel);
            const errorContexts = [];
            const textPaths = oModel.getProperty("/textPaths");
            const aPropertyReadableInfo = oModel.getProperty("/readablePropertyData");
            let groupId;
            let allSideEffects;
            const massEditPromises = [];
            const failedFieldsData = {};
            const selectedRowsLength = aContexts.length;
            const deferredTargetsForAQualifiedName = {};
            const baseSideEffectsMapArray = MassEditHelper.getSideEffectDataForKey(oEntitySetContext, aSideEffects, oController, aResults);
            //const changePromise: any[] = [];
            //let bReadOnlyField = false;
            //const errorContexts: object[] = [];

            aContexts.forEach(function (oSelectedContext, idx) {
              allSideEffects = [];
              aResults.forEach(async function (oResult) {
                if (!failedFieldsData.hasOwnProperty(oResult.keyValue)) {
                  failedFieldsData[oResult.keyValue] = 0;
                }
                //TODO - Add save implementation for Value Help.
                if (baseSideEffectsMapArray[oResult.keyValue]) {
                  allSideEffects[oResult.keyValue] = baseSideEffectsMapArray[oResult.keyValue];
                }
                if (aPropertyReadableInfo) {
                  aPropertyReadableInfo.some(function (oPropertyInfo) {
                    if (oResult.keyValue === oPropertyInfo.property) {
                      if (oPropertyInfo.type === "Default") {
                        return oPropertyInfo.value === true;
                      } else if (oPropertyInfo.type === "Path" && oPropertyInfo.propertyValue && oPropertyInfo.propertyPath) {
                        return oSelectedContext.getObject(oPropertyInfo.propertyPath) === oPropertyInfo.propertyValue;
                      }
                    }
                  });
                }
                groupId = `$auto.${idx}`;
                const oFieldPromise = oSelectedContext.setProperty(oResult.keyValue, oResult.value, groupId).catch(function (oError) {
                  errorContexts.push(oSelectedContext.getObject());
                  Log.error("Mass Edit: Something went wrong in updating entries.", oError);
                  failedFieldsData[oResult.keyValue] = failedFieldsData[oResult.keyValue] + 1;
                  return Promise.reject({
                    isFieldUpdateFailed: true
                  });
                });
                const dataToUpdateFieldAndSideEffects = {
                  oController,
                  oFieldPromise,
                  sideEffectsMap: baseSideEffectsMapArray[oResult.keyValue],
                  textPaths,
                  groupId,
                  key: oResult.keyValue,
                  oEntitySetContext,
                  oMetaModel,
                  oSelectedContext,
                  deferredTargetsForAQualifiedName
                };
                massEditPromises.push(MassEditHelper.handleMassEditFieldUpdateAndRequestSideEffects(dataToUpdateFieldAndSideEffects));
              });
            });
            await Promise.allSettled(massEditPromises).then(async function () {
              groupId = `$auto.massEditDeferred`;
              const deferredRequests = [];
              const sideEffectsDataForAllKeys = Object.values(deferredTargetsForAQualifiedName);
              const keysWithSideEffects = Object.keys(deferredTargetsForAQualifiedName);
              sideEffectsDataForAllKeys.forEach((aSideEffect, index) => {
                const currentKey = keysWithSideEffects[index];
                if (failedFieldsData[currentKey] !== selectedRowsLength) {
                  const deferredSideEffectsData = Object.values(aSideEffect);
                  deferredSideEffectsData.forEach(req => {
                    const {
                      aTargets,
                      oContext,
                      TriggerAction,
                      mSideEffect
                    } = req;
                    const fnGetDeferredTargets = function () {
                      return aTargets;
                    };
                    const fnGetDeferredTargetsAndActions = function () {
                      return {
                        aTargets: fnGetDeferredTargets(),
                        TriggerAction: TriggerAction
                      };
                    };
                    deferredRequests.push(
                    // if some deferred is rejected, it will be add to failed queue
                    oController._sideEffects.requestSideEffects(mSideEffect, oContext, groupId, fnGetDeferredTargetsAndActions));
                  });
                }
              });
            }).then(function () {
              MassEditHelper.messageHandlingForMassEdit(oTable, aContexts, oController, oInDialog, aResults, errorContexts);
            }).catch(e => {
              MassEditHelper.closeDialog(oDialog);
              return Promise.reject(e);
            });
          }
        }),
        endButton: new Button({
          text: oDefaultValues.cancelButtonText,
          visible: MassEditHelper.helpers.hasEditableFieldsBinding(oDataFieldModel.getObject("/"), true),
          press: function (oEvent) {
            const oInDialog = oEvent.getSource().getParent();
            MassEditHelper.closeDialog(oInDialog);
          }
        })
      });
      oDialog.setModel(oDialogDataModel, "fieldsInfo");
      oDialog.setModel(model);
      oDialog.setBindingContext(dialogContext);
      return oDialog;
    },
    helpers: {
      getBindingExpForHasEditableFields: (fields, editable) => {
        const totalExp = fields.reduce((expression, field) => or(expression, pathInModel("/values/" + field.dataProperty + "/visible", "fieldsInfo")), constant(false));
        return editable ? totalExp : not(totalExp);
      },
      getExpBindingForApplyButtonTxt: (defaultValues, fields) => {
        const editableExp = MassEditHelper.helpers.getBindingExpForHasEditableFields(fields, true);
        const totalExp = ifElse(editableExp, constant(defaultValues.applyButtonText), constant(defaultValues.okButtonText));
        return compileExpression(totalExp);
      },
      hasEditableFieldsBinding: (fields, editable) => {
        return compileExpression(MassEditHelper.helpers.getBindingExpForHasEditableFields(fields, editable));
      }
    }
  };
  return MassEditHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/MassEditHelper", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/helpers/BindingToolkit","sap/fe/core/library","sap/fe/core/TemplateModel","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/macros/field/FieldHelper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/table/TableHelper","sap/m/Button","sap/m/Dialog","sap/m/MessageToast","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/util/XMLPreprocessor","sap/ui/core/XMLTemplateProcessor","sap/ui/mdc/enum/EditMode","sap/ui/model/json/JSONModel","../controllerextensions/messageHandler/messageHandling","../controls/Any","../converters/MetaModelConverter","../templating/FieldControlHelper","../templating/UIFormatters","./SideEffectsHelper"],function(e,t,n,o,a,i,r,s,l,u,c,d,p,f,g,y,P,h,v,x,E,m,T,b,O){"use strict";var M=b.isMultiValueField;var C=b.getRequiredExpression;var F=b.getEditMode;var V=T.isReadOnlyExpression;var D=m.getInvolvedDataModelObjects;var S=m.convertMetaModelContext;var $=l.setEditStyleProperties;var B=l.getTextBinding;var k=r.hasValueHelpWithFixedValues;var I=r.hasValueHelp;var j=r.hasUnit;var A=r.hasCurrency;var _=r.getAssociatedUnitPropertyPath;var w=r.getAssociatedUnitProperty;var H=i.getRelativePaths;var R=i.enhanceDataModelPath;var L=n.pathInModel;var U=n.or;var N=n.not;var G=n.ifElse;var q=n.constant;var Q=n.compileExpression;const K={initLastLevelOfPropertyPath:function(e,t){let n;let o=0;const a=e.split("/");let i="";a.forEach(function(a){if(!t[a]&&o===0){t[a]={};n=t[a];i=i+a;o++}else if(!n[a]){i=`${i}/${a}`;if(i!==e){n[a]={};n=n[a]}else{n[a]=[]}}});return n},getUniqueValues:function(e,t,n){return e!=undefined&&e!=null?n.indexOf(e)===t:undefined},getValueForMultiLevelPath:function(e,t){let n;if(e&&e.indexOf("/")>0){const o=e.split("/");o.forEach(function(e){n=t&&t[e]?t[e]:n&&n[e]})}return n},getDefaultSelectionPathComboBox:function(e,t){let n;if(t&&e.length>0){const o=e,a=[];o.forEach(function(e){const n=e.getObject();const o=t.indexOf("/")>-1&&n.hasOwnProperty(t.split("/")[0]);if(e&&(n.hasOwnProperty(t)||o)){a.push(e.getObject(t))}});const i=a.filter(K.getUniqueValues);if(i.length>1){n=`Default/${t}`}else if(i.length===0){n=`Empty/${t}`}else if(i.length===1){n=`${t}/${i[0]}`}}return n},getHiddenValueForContexts:function(e,t){if(e&&e.$Path){return!t.some(function(t){return t.getObject(e.$Path)===false})}return e},getInputType:function(e,t,n){const o={};let a;if(e){$(o,t,n,true);a=(o===null||o===void 0?void 0:o.editStyle)||""}const i=a&&["DatePicker","TimePicker","DateTimePicker","RatingIndicator"].indexOf(a)===-1&&!M(n)&&!k(e);return(i||"")&&a},getIsFieldGrp:function(e){return e&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&e.Target&&e.Target.value&&e.Target.value.indexOf("FieldGroup")>-1},getTextPath:function(e,t,n){let o;if(t&&(t.path||t.parameters&&t.parameters.length)&&e){if(t.path&&n==="Description"){o=t.path}else if(t.parameters){t.parameters.forEach(function(t){if(t.path&&t.path!==e){o=t.path}})}}return o},prepareDataForDialog:function(e,n,o){const a=e&&e.getModel().getMetaModel(),i=e.data("metaPath"),r=K.getTableFields(e),s=a.getContext(`${i}/@`),l=a.getContext(i),u=D(s);const c=new v;let d;let p;let f;let g;let y;let P;r.forEach(function(e){const r=e.dataProperty;if(r){var s,c,v,x,E,m,T;let b=r&&a.getObject(`${i}/${r}@`);p=e.label||b&&b["@com.sap.vocabularies.Common.v1.Label"]||r;if(u){u.targetObject=u.targetEntityType.entityProperties.filter(function(e){return e.name===r})}u.targetObject=u.targetObject[0]||{};P=B(u,{},true)||{};const O=a.getContext(e.annotationPath),M=S(O),$=a.getContext(`${i}/${r}@`),k=$&&$.getInterface();let L=D(O,l);if((M===null||M===void 0?void 0:(s=M.Value)===null||s===void 0?void 0:(c=s.path)===null||c===void 0?void 0:c.length)>0){L=R(L,r)}const U=K.getHiddenValueForContexts(O&&O.getObject()["@com.sap.vocabularies.UI.v1.Hidden"],n)||false;const N=b&&b["@com.sap.vocabularies.UI.v1.IsImageURL"];k.context={getModel:function(){return k.getModel()},getPath:function(){return`${i}/${r}`}};b=M._type==="Property"?M:M&&M.Value&&M.Value.$target||M&&M.Target&&M.Target.$target;const G=b&&b.term&&b.term==="com.sap.vocabularies.UI.v1.Chart";const Q=!!M.Action;const X=K.getIsFieldGrp(M);if(N||U||G||Q||X){return}g=(A(b)||j(b))&&_(b)||"";const z=g&&w(b);f=I(b);y=z&&I(z);const J=(f||y)&&(((v=b)===null||v===void 0?void 0:(x=v.annotations)===null||x===void 0?void 0:(E=x.Common)===null||E===void 0?void 0:E.ValueListRelevantQualifiers)||z&&(z===null||z===void 0?void 0:(m=z.annotations)===null||m===void 0?void 0:(T=m.Common)===null||T===void 0?void 0:T.ValueListRelevantQualifiers));if(J){return}const Y=b&&b.Value?b.Value:b;const W=F(Y,L,false,false,M,q(true));const Z=Object.keys(h);const ee=!!W&&Z.includes(W);const te=!!W&&(ee&&W===h.Editable||!ee);const ne=r.includes("/")&&f;if(!te||ne){return}const oe=K.getInputType(b,M,L);if(oe){const e=H(L);const a=V(b,e);const s=t.computeDisplayMode($.getObject());const l=f?f:false;const u=y&&!g.includes("/")?y:false;const c=g&&!r.includes("/")?g:false;d={label:p,dataProperty:r,isValueHelpEnabled:f?f:false,unitProperty:c,isFieldRequired:C(b,M,true,false,{},L),defaultSelectionPath:r?K.getDefaultSelectionPathComboBox(n,r):false,defaultSelectionUnitPath:g?K.getDefaultSelectionPathComboBox(n,g):false,entitySet:i,display:s,descriptionPath:K.getTextPath(r,P,s),nullable:b.nullable!==undefined?b.nullable:true,isPropertyReadOnly:a!==undefined?a:false,inputType:oe,editMode:te?W:undefined,propertyInfo:{hasVH:l,runtimePath:"fieldsInfo>/values/",relativePath:r,propertyPathForValueHelp:`${i}/${r}`},unitInfo:c&&{hasVH:u,runtimePath:"fieldsInfo>/unitData/",relativePath:c,propertyPathForValueHelp:`${i}/${c}`}};o.push(d)}}});c.setData(o);return c},getTableFields:function(e){const t=e&&e.getColumns()||[];const n=e&&e.getParent().getTableDefinition().columns;return t.map(function(e){const t=e&&e.getDataProperty(),o=n&&n.filter(function(e){return e.name===t&&e.type==="Annotation"});return{dataProperty:t,label:e.getHeader(),annotationPath:o&&o[0]&&o[0].annotationPath}})},getDefaultTextsForDialog:function(e,t,n){const o=n.data("displayModePropertyBinding")==="true";return{keepExistingPrefix:"< Keep",leaveBlankValue:"< Leave Blank >",clearFieldValue:"< Clear Values >",massEditTitle:e.getText("C_MASS_EDIT_DIALOG_TITLE",t.toString()),applyButtonText:o?e.getText("C_MASS_EDIT_SAVE_BUTTON_TEXT"):e.getText("C_MASS_EDIT_APPLY_BUTTON_TEXT"),useValueHelpValue:"< Use Value Help >",cancelButtonText:e.getText("C_COMMON_OBJECT_PAGE_CANCEL"),noFields:e.getText("C_MASS_EDIT_NO_EDITABLE_FIELDS"),okButtonText:e.getText("C_COMMON_DIALOG_OK")}},setDefaultValuesToDialog:function(e,t,n,o){const a=o?n.unitProperty:n.dataProperty,i=n.inputType,r=n.isFieldRequired;const s="Values";e.defaultOptions=e.defaultOptions||[];const l=e.selectOptions&&e.selectOptions.length>0;const u={text:`${t.keepExistingPrefix} ${s} >`,key:`Default/${a}`};if(i==="CheckBox"){const t={text:"No",key:`${a}/false`,textInfo:{value:false}};const n={text:"Yes",key:`${a}/true`,textInfo:{value:true}};e.unshift(t);e.defaultOptions.unshift(t);e.unshift(n);e.defaultOptions.unshift(n);e.unshift(u);e.defaultOptions.unshift(u)}else{var c,d;if(n!==null&&n!==void 0&&(c=n.propertyInfo)!==null&&c!==void 0&&c.hasVH||n!==null&&n!==void 0&&(d=n.unitInfo)!==null&&d!==void 0&&d.hasVH&&o){const n={text:t.useValueHelpValue,key:`UseValueHelpValue/${a}`};e.unshift(n);e.defaultOptions.unshift(n)}if(l){if(r!=="true"&&!o){const n={text:t.clearFieldValue,key:`ClearFieldValue/${a}`};e.unshift(n);e.defaultOptions.unshift(n)}e.unshift(u);e.defaultOptions.unshift(u)}else{const n={text:t.leaveBlankValue,key:`Default/${a}`};e.unshift(n);e.defaultOptions.unshift(n)}}},getTextArrangementInfo:function(t,n,o,a){let i=a.getObject(t),r,s;if(n&&t){switch(o){case"Description":r=a.getObject(n)||"";s=r;break;case"Value":i=a.getObject(t)||"";s=i;break;case"ValueDescription":i=a.getObject(t)||"";r=a.getObject(n)||"";s=r?`${i} (${r})`:i;break;case"DescriptionValue":i=a.getObject(t)||"";r=a.getObject(n)||"";s=r?`${r} (${i})`:i;break;default:e.info(`Display Property not applicable: ${t}`);break}}return{textArrangement:o,valuePath:t,descriptionPath:n,value:i,description:r,fullText:s}},isEditable:function(e){const t=e.getBinding("any");const n=t.getExternalValue();return n===h.Editable},onContextEditableChange:function(e,t){const n=e.getProperty(`/values/${t}/objectsForVisibility`)||[];const o=n.some(K.isEditable);if(o){e.setProperty(`/values/${t}/visible`,o)}},updateOnContextChange:function(e,t,n,o){const a=e.getBinding("any");o.objectsForVisibility=o.objectsForVisibility||[];o.objectsForVisibility.push(e);a===null||a===void 0?void 0:a.attachChange(K.onContextEditableChange.bind(null,t,n))},getBoundObject:function(e,t){const n=new E({any:e});const o=t.getModel();n.setModel(o);n.setBindingContext(t);return n},getFieldVisiblity:function(e,t,n,o,a){const i=K.getBoundObject(e,a);const r=K.isEditable(i);if(!r){K.updateOnContextChange(i,t,n,o)}return r},setRuntimeModelOnDialog:function(e,t,n,o){const a=[];const i=[];const r=[];const s=[];const l=[];const u={values:a,unitData:i,results:r,readablePropertyData:l,selectedKey:undefined,textPaths:s,noFields:n.noFields};const c=new v(u);t.forEach(function(t){let n;let r;let l;const u={};const c={};if(t.dataProperty&&t.dataProperty.indexOf("/")>-1){const o=K.initLastLevelOfPropertyPath(t.dataProperty,a);const i=t.dataProperty.split("/");for(const a of e){const e=a.getObject(t.dataProperty);r=`${t.dataProperty}/${e}`;if(!u[r]&&o[i[i.length-1]]){n=K.getTextArrangementInfo(t.dataProperty,t.descriptionPath,t.display,a);o[i[i.length-1]].push({text:n&&n.fullText||e,key:r,textInfo:n});u[r]=e}}o[i[i.length-1]].textInfo={descriptionPath:t.descriptionPath,valuePath:t.dataProperty,displayMode:t.display}}else{a[t.dataProperty]=a[t.dataProperty]||[];a[t.dataProperty]["selectOptions"]=a[t.dataProperty]["selectOptions"]||[];if(t.unitProperty){i[t.unitProperty]=i[t.unitProperty]||[];i[t.unitProperty]["selectOptions"]=i[t.unitProperty]["selectOptions"]||[]}for(const o of e){const e=o.getObject();r=`${t.dataProperty}/${e[t.dataProperty]}`;if(t.dataProperty&&e[t.dataProperty]&&!u[r]){if(t.inputType!="CheckBox"){n=K.getTextArrangementInfo(t.dataProperty,t.descriptionPath,t.display,o);const i={text:n&&n.fullText||e[t.dataProperty],key:r,textInfo:n};a[t.dataProperty].push(i);a[t.dataProperty]["selectOptions"].push(i)}u[r]=e[t.dataProperty]}if(t.unitProperty&&e[t.unitProperty]){l=`${t.unitProperty}/${e[t.unitProperty]}`;if(!c[l]){if(t.inputType!="CheckBox"){n=K.getTextArrangementInfo(t.unitProperty,t.descriptionPath,t.display,o);const a={text:n&&n.fullText||e[t.unitProperty],key:l,textInfo:n};i[t.unitProperty].push(a);i[t.unitProperty]["selectOptions"].push(a)}c[l]=e[t.unitProperty]}}}a[t.dataProperty].textInfo={descriptionPath:t.descriptionPath,valuePath:t.dataProperty,displayMode:t.display};if(Object.keys(u).length===1){o.setProperty(t.dataProperty,r&&u[r])}if(Object.keys(c).length===1){o.setProperty(t.unitProperty,l&&c[l])}}s[t.dataProperty]=t.descriptionPath?[t.descriptionPath]:[]});t.forEach(function(t){let o={};if(t.dataProperty.indexOf("/")>-1){const e=K.getValueForMultiLevelPath(t.dataProperty,a);if(!e){e.push({text:n.leaveBlankValue,key:`Empty/${t.dataProperty}`})}else{K.setDefaultValuesToDialog(e,n,t)}o=e}else if(a[t.dataProperty]){a[t.dataProperty]=a[t.dataProperty]||[];K.setDefaultValuesToDialog(a[t.dataProperty],n,t);o=a[t.dataProperty]}if(i[t.unitProperty]&&i[t.unitProperty].length){K.setDefaultValuesToDialog(i[t.unitProperty],n,t,true);i[t.unitProperty].textInfo={};i[t.unitProperty].selectedKey=K.getDefaultSelectionPathComboBox(e,t.unitProperty);i[t.unitProperty].inputType=t.inputType}else if(t.dataProperty&&a[t.dataProperty]&&!a[t.dataProperty].length||t.unitProperty&&i[t.unitProperty]&&!i[t.unitProperty].length){const o=a[t.dataProperty]&&a[t.dataProperty].some(function(e){return e.text==="< Clear Values >"||e.text==="< Leave Blank >"});if(t.dataProperty&&!o){a[t.dataProperty].push({text:n.leaveBlankValue,key:`Empty/${t.dataProperty}`})}const r=i[t.unitProperty]&&i[t.unitProperty].some(function(e){return e.text==="< Clear Values >"||e.text==="< Leave Blank >"});if(t.unitProperty){if(!r){i[t.unitProperty].push({text:n.leaveBlankValue,key:`Empty/${t.unitProperty}`})}i[t.unitProperty].textInfo={};i[t.unitProperty].selectedKey=K.getDefaultSelectionPathComboBox(e,t.unitProperty);i[t.unitProperty].inputType=t.inputType}}if(t.isPropertyReadOnly&&typeof t.isPropertyReadOnly==="boolean"){l.push({property:t.dataProperty,value:t.isPropertyReadOnly,type:"Default"})}else if(t.isPropertyReadOnly&&t.isPropertyReadOnly.operands&&t.isPropertyReadOnly.operands[0]&&t.isPropertyReadOnly.operands[0].operand1&&t.isPropertyReadOnly.operands[0].operand2){l.push({property:t.dataProperty,propertyPath:t.isPropertyReadOnly.operands[0].operand1.path,propertyValue:t.isPropertyReadOnly.operands[0].operand2.value,type:"Path"})}if(t.editMode){o.visible=t.editMode===h.Editable||e.some(K.getFieldVisiblity.bind(K,t.editMode,c,t.dataProperty,o))}else{o.visible=true}o.selectedKey=K.getDefaultSelectionPathComboBox(e,t.dataProperty);o.inputType=t.inputType;o.unitProperty=t.unitProperty});return c},getDialogContext:function(e,t){let n=t&&t.getBindingContext();if(!n){const t=e.getModel();const o=e.getRowBinding();const a=t.bindList(o.getPath(),o.getContext(),[],[],{$$updateGroupId:"submitLater"});a.refreshInternal=function(){};n=a.create({},true)}return n},onDialogOpen:function(e){const t=e.getSource();const n=t.getModel("fieldsInfo");n.setProperty("/isOpen",true)},closeDialog:function(e){e.close();e.destroy()},messageHandlingForMassEdit:async function(e,t,n,a,i,r){var s,l,u,c;const d=o.DraftStatus;const g=f.getLibraryResourceBundle("sap.fe.core");(s=n.getView())===null||s===void 0?void 0:(l=s.getBindingContext("internal"))===null||l===void 0?void 0:l.setProperty("getBoundMessagesForMassEdit",true);n._editFlow.getMessageHandler().showMessages({onBeforeShowMessage:function(o,a){a.fnGetMessageSubtitle=x.setMessageSubtitle.bind({},e,t);const s=[];o.forEach(function(e){if(!e.getTarget()){s.push(e)}});if(i.length>0&&r.length===0){n._editFlow.setDraftStatus(d.Saved);const e=g.getText("C_MASS_EDIT_SUCCESS_TOAST");p.show(e)}else if(r.length<e.getSelectedContexts().length){n._editFlow.setDraftStatus(d.Saved)}else if(r.length===e.getSelectedContexts().length){n._editFlow.setDraftStatus(d.Clear)}if(n.getModel("ui").getProperty("/isEditable")&&s.length===0){a.showMessageBox=false;a.showMessageDialog=false}return a}});if(a.isOpen()){var y,P;K.closeDialog(a);(y=n.getView())===null||y===void 0?void 0:(P=y.getBindingContext("internal"))===null||P===void 0?void 0:P.setProperty("skipPatchHandlers",false)}(u=n.getView())===null||u===void 0?void 0:(c=u.getBindingContext("internal"))===null||c===void 0?void 0:c.setProperty("getBoundMessagesForMassEdit",false)},getSideEffectDataForKey:function(e,t,n,o){const a=e.getProperty("$Type");const i={};o.forEach(e=>{const o=e.keyValue;const r=s.getSideEffectsOnEntityAndProperty(o,a,t);i[o]=n._sideEffects.getSideEffectsMapForFieldGroups(r)});return i},fnGetPathForSourceProperty:function(e,t,n){const o=e.indexOf("/")>0?"/"+t+"/"+e.substr(0,e.lastIndexOf("/")+1)+"@sapui.name":false,a=!o?Promise.resolve(t):n.requestObject(o);e=o?e.substr(e.lastIndexOf("/")+1):e;return{sPath:e,pOwnerEntity:a,sNavigationPath:o}},fnGetEntityTypeOfOwner:function(e,t,n,o,a){const i=n.getProperty("$Type");const{$Type:r,$Partner:s}=e.getObject(`${n}/${t}`);if(s){const t=e.getObject(`/${r}/${s}`);if(t){const e=t["$Type"];if(e!==i){a.push(o)}}}else{a.push(o)}return a},fnGetTargetsForMassEdit:function(e,t,n,o){const{TargetProperties:a,TargetEntities:i}=e;const r=[];let s=[];const l=t.getProperty("$Type");if(n===l){i===null||i===void 0?void 0:i.forEach(e=>{e=e["$NavigationPropertyPath"];let n;if(e.includes("/")){n=e.split("/")[0]}else{n=e}s=K.fnGetEntityTypeOfOwner(o,n,t,e,s)})}if(a.length){a.forEach(e=>{const{pOwnerEntity:a}=K.fnGetPathForSourceProperty(e,n,o);r.push(a.then(n=>{if(n===l){s.push(e)}else if(e.includes("/")){const n=e.split("/")[0];s=K.fnGetEntityTypeOfOwner(o,n,t,e,s)}return Promise.resolve(s)}))})}else{r.push(Promise.resolve(s))}return Promise.all(r)},checkIfEntityExistsAsTargetEntity:(e,t)=>{const n=t.getProperty("$Type");const o=Object.values(e).filter(e=>e.name.indexOf(n)==-1);const a=t.getPath().split("/").pop();const i=o.filter(e=>{const t=e.sideEffects.TargetEntities;return t!==null&&t!==void 0&&t.filter(e=>e["$NavigationPropertyPath"]===a).length?e:false});return i.length},handleMassEditFieldUpdateAndRequestSideEffects:async function(e){const{oController:n,oFieldPromise:o,sideEffectsMap:a,textPaths:i,groupId:r,key:s,oEntitySetContext:l,oMetaModel:c,oSelectedContext:d,deferredTargetsForAQualifiedName:p}=e;const f=[o];const g=l.getProperty("$Type");const y=t.getAppComponent(n.getView());const P=y.getSideEffectsService();const h=K.checkIfEntityExistsAsTargetEntity(a,l);if(a){const e=Object.keys(a);const t=Object.values(a);const o={};p[s]={};for(const[a,i]of t.entries()){const t=e[a];const y=t.split("#")[0];const P=n._sideEffects.getContextForSideEffects(d,y);i.context=P;const v=n._sideEffects.getRegisteredFailedRequests();const x=v[P.getPath()];n._sideEffects.unregisterFailedSideEffectsForAContext(P);let E=[i.sideEffects];E=x&&x.length?E.concat(x):E;o[P]={};for(const e of E){if(!o[P].hasOwnProperty(e.fullyQualifiedName)){o[P][e.fullyQualifiedName]=true;let t=[],a=[],i;const d=async function(e){const{TargetProperties:n,TargetEntities:o}=e;const r=e.fullyQualifiedName.split("@")[0];const d=await K.fnGetTargetsForMassEdit(e,l,r,c);t=d[0];a=(n||[]).concat(o||[]);const f=e.TriggerAction;const y=a.filter(e=>!t.includes(e));p[s][e.fullyQualifiedName]={aTargets:y,oContext:P,mSideEffect:e};if(f&&r===g){const t=u._isStaticAction(c.getObject(`/${f}`),f);if(!t){i=f}else{p[s][e.fullyQualifiedName]["TriggerAction"]=f}}else{p[s][e.fullyQualifiedName]["TriggerAction"]=f}if(h){t=[]}return{aTargets:t,TriggerAction:i}};f.push(n._sideEffects.requestSideEffects(e,P,r,d))}}}}if(i!==null&&i!==void 0&&i[s]&&i[s].length){f.push(P.requestSideEffects(i[s],d,r))}return Promise.allSettled(f)},createDialog:async function(t,n,o){const i="sap/fe/core/controls/massEdit/MassEditDialog",r=[],s=f.getLibraryResourceBundle("sap.fe.core"),l=K.getDefaultTextsForDialog(s,n.length,t),u=K.prepareDataForDialog(t,n,r),p=K.getDialogContext(t),h=K.setRuntimeModelOnDialog(n,r,l,p),v=t.getModel(),E=v.getMetaModel(),m=new a(u.getData(),E);const T=P.loadTemplate(i,"fragment");const b=await Promise.resolve(y.process(T,{name:i},{bindingContexts:{dataFieldModel:m.createBindingContext("/"),metaModel:E.createBindingContext("/"),contextPath:E.createBindingContext(E.getMetaPath(p.getPath()))},models:{dataFieldModel:m,metaModel:E,contextPath:E}}));const M=await g.load({definition:b});const C=new d({resizable:true,title:l.massEditTitle,content:[M],afterOpen:K.onDialogOpen,beginButton:new c({text:K.helpers.getExpBindingForApplyButtonTxt(l,u.getObject("/")),type:"Emphasized",press:async function(a){var i,r;x.removeBoundTransitionMessages();x.removeUnboundTransitionMessages();(i=o.getView())===null||i===void 0?void 0:(r=i.getBindingContext("internal"))===null||r===void 0?void 0:r.setProperty("skipPatchHandlers",true);const s=a.getSource().getParent();const l=s.getModel("fieldsInfo");const u=l.getProperty("/results");const c=t&&t.getModel().getMetaModel(),d=t.data("metaPath"),p=c.getContext(d);const f=await O.generateSideEffectsMapFromMetaModel(c);const g=[];const y=l.getProperty("/textPaths");const P=l.getProperty("/readablePropertyData");let h;let v;const E=[];const m={};const T=n.length;const b={};const M=K.getSideEffectDataForKey(p,f,o,u);n.forEach(function(t,n){v=[];u.forEach(async function(a){if(!m.hasOwnProperty(a.keyValue)){m[a.keyValue]=0}if(M[a.keyValue]){v[a.keyValue]=M[a.keyValue]}if(P){P.some(function(e){if(a.keyValue===e.property){if(e.type==="Default"){return e.value===true}else if(e.type==="Path"&&e.propertyValue&&e.propertyPath){return t.getObject(e.propertyPath)===e.propertyValue}}})}h=`$auto.${n}`;const i=t.setProperty(a.keyValue,a.value,h).catch(function(n){g.push(t.getObject());e.error("Mass Edit: Something went wrong in updating entries.",n);m[a.keyValue]=m[a.keyValue]+1;return Promise.reject({isFieldUpdateFailed:true})});const r={oController:o,oFieldPromise:i,sideEffectsMap:M[a.keyValue],textPaths:y,groupId:h,key:a.keyValue,oEntitySetContext:p,oMetaModel:c,oSelectedContext:t,deferredTargetsForAQualifiedName:b};E.push(K.handleMassEditFieldUpdateAndRequestSideEffects(r))})});await Promise.allSettled(E).then(async function(){h=`$auto.massEditDeferred`;const e=[];const t=Object.values(b);const n=Object.keys(b);t.forEach((t,a)=>{const i=n[a];if(m[i]!==T){const n=Object.values(t);n.forEach(t=>{const{aTargets:n,oContext:a,TriggerAction:i,mSideEffect:r}=t;const s=function(){return n};const l=function(){return{aTargets:s(),TriggerAction:i}};e.push(o._sideEffects.requestSideEffects(r,a,h,l))})}})}).then(function(){K.messageHandlingForMassEdit(t,n,o,s,u,g)}).catch(e=>{K.closeDialog(C);return Promise.reject(e)})}}),endButton:new c({text:l.cancelButtonText,visible:K.helpers.hasEditableFieldsBinding(u.getObject("/"),true),press:function(e){const t=e.getSource().getParent();K.closeDialog(t)}})});C.setModel(h,"fieldsInfo");C.setModel(v);C.setBindingContext(p);return C},helpers:{getBindingExpForHasEditableFields:(e,t)=>{const n=e.reduce((e,t)=>U(e,L("/values/"+t.dataProperty+"/visible","fieldsInfo")),q(false));return t?n:N(n)},getExpBindingForApplyButtonTxt:(e,t)=>{const n=K.helpers.getBindingExpForHasEditableFields(t,true);const o=G(n,q(e.applyButtonText),q(e.okButtonText));return Q(o)},hasEditableFieldsBinding:(e,t)=>Q(K.helpers.getBindingExpForHasEditableFields(e,t))}};return K},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/MessageStrip-dbg", ["sap/fe/core/CommonUtils", "sap/fe/macros/DelegateUtil", "sap/ui/core/Core", "sap/ui/Device"], function (CommonUtils, DelegateUtil, Core, Device) {
  "use strict";

  var system = Device.system;
  function getLabels(aIgnoredFields, sEntityTypePath, oFilterControl, oResourceBundle) {
    const oMetaModel = oFilterControl.getModel().getMetaModel(),
      aIgnoredLabels = aIgnoredFields.map(function (sProperty) {
        const oMacroResourceBundle = Core.getLibraryResourceBundle("sap.fe.macros");
        if (sProperty === "$search") {
          return oMacroResourceBundle ? oMacroResourceBundle.getText("M_FILTERBAR_SEARCH") : "";
        }
        if (sProperty === "$editState") {
          return oResourceBundle ? oResourceBundle.getText("FILTERBAR_EDITING_STATUS") : "";
        }
        const sLabel = oMetaModel.getObject(`${sEntityTypePath}${sProperty}@com.sap.vocabularies.Common.v1.Label`);
        return DelegateUtil.getLocalizedText(sLabel, oFilterControl);
      });
    return aIgnoredLabels;
  }
  function getALPText(aIgnoredLabels, oFilterBar, bIsSearchIgnored) {
    let sResourceKey = "";
    let aParameters = [];
    const oResourceBundle = _getResourceBundle();
    if (!oResourceBundle) {
      return "";
    }
    const view = CommonUtils.getTargetView(oFilterBar);
    const oChart = view.getController().getChartControl();
    const bIsDraftSupported = oChart.data("draftSupported") === "true";
    const oMacroResourceBundle = Core.getLibraryResourceBundle("sap.fe.macros");
    bIsSearchIgnored = bIsSearchIgnored && aIgnoredLabels.includes(oMacroResourceBundle.getText("M_FILTERBAR_SEARCH"));
    const sDefaultResourceKey = `C_LR_MULTIVIZ_CHART_${_getArgumentSize(aIgnoredLabels)}_IGNORED_FILTER_${_getSizeText()}`;
    if (bIsDraftSupported && (aIgnoredLabels.length === 2 && bIsSearchIgnored || aIgnoredLabels.length === 1)) {
      sResourceKey = aIgnoredLabels.length === 1 ? "C_MULTIVIZ_CHART_IGNORED_FILTER_DRAFT_DATA" : "C_LR_MULTIVIZ_CHART_IGNORED_FILTER_DRAFT_DATA_AND_SEARCH";
    } else {
      sResourceKey = sDefaultResourceKey;
      aParameters = [aIgnoredLabels.join(", ")];
    }
    return oResourceBundle.getText(sResourceKey, aParameters);
  }
  function getText(aIgnoredLabels, oFilterBar, sTabTitle, fnGetLocalizedText) {
    const oResourceBundle = _getResourceBundle();
    return oResourceBundle ? oResourceBundle.getText(`C_LR_MULTITABLES_${_getArgumentSize(aIgnoredLabels)}_IGNORED_FILTER_${_getSizeText()}`, [aIgnoredLabels.join(", "), fnGetLocalizedText(sTabTitle, oFilterBar)]) : "";
  }
  function _getSizeText() {
    return system.desktop ? "LARGE" : "SMALL";
  }
  function _getArgumentSize(aIgnoredLabels) {
    return aIgnoredLabels.length === 1 ? "SINGLE" : "MULTI";
  }
  function _getResourceBundle() {
    return Core.getLibraryResourceBundle("sap.fe.templates");
  }
  const MessageStripHelper = {
    getALPText: getALPText,
    getText: getText,
    getLabels: getLabels
  };
  return MessageStripHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/MessageStrip", ["sap/fe/core/CommonUtils","sap/fe/macros/DelegateUtil","sap/ui/core/Core","sap/ui/Device"],function(e,t,n,r){"use strict";var o=r.system;function s(e,r,o,s){const c=o.getModel().getMetaModel(),_=e.map(function(e){const _=n.getLibraryResourceBundle("sap.fe.macros");if(e==="$search"){return _?_.getText("M_FILTERBAR_SEARCH"):""}if(e==="$editState"){return s?s.getText("FILTERBAR_EDITING_STATUS"):""}const a=c.getObject(`${r}${e}@com.sap.vocabularies.Common.v1.Label`);return t.getLocalizedText(a,o)});return _}function c(t,r,o){let s="";let c=[];const _=T();if(!_){return""}const i=e.getTargetView(r);const R=i.getController().getChartControl();const L=R.data("draftSupported")==="true";const l=n.getLibraryResourceBundle("sap.fe.macros");o=o&&t.includes(l.getText("M_FILTERBAR_SEARCH"));const g=`C_LR_MULTIVIZ_CHART_${u(t)}_IGNORED_FILTER_${a()}`;if(L&&(t.length===2&&o||t.length===1)){s=t.length===1?"C_MULTIVIZ_CHART_IGNORED_FILTER_DRAFT_DATA":"C_LR_MULTIVIZ_CHART_IGNORED_FILTER_DRAFT_DATA_AND_SEARCH"}else{s=g;c=[t.join(", ")]}return _.getText(s,c)}function _(e,t,n,r){const o=T();return o?o.getText(`C_LR_MULTITABLES_${u(e)}_IGNORED_FILTER_${a()}`,[e.join(", "),r(n,t)]):""}function a(){return o.desktop?"LARGE":"SMALL"}function u(e){return e.length===1?"SINGLE":"MULTI"}function T(){return n.getLibraryResourceBundle("sap.fe.templates")}const i={getALPText:c,getText:_,getLabels:s};return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ModelHelper-dbg", ["sap/fe/core/converters/MetaModelConverter"], function (MetaModelConverter) {
  "use strict";

  var _exports = {};
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  let TypeOfEntity;
  (function (TypeOfEntity) {
    TypeOfEntity["TypeSingleton"] = "Singleton";
    TypeOfEntity["TypeEntity"] = "EntitySet";
  })(TypeOfEntity || (TypeOfEntity = {}));
  _exports.TypeOfEntity = TypeOfEntity;
  const ModelHelper = {
    /**
     * Method to determine if the programming model is sticky.
     *
     * @function
     * @name isStickySessionSupported
     * @param metaModel ODataModelMetaModel to check for sticky enabled entity
     * @returns Returns true if sticky, else false
     */
    isStickySessionSupported: function (metaModel) {
      const entityContainer = metaModel.getObject("/");
      for (const entitySetName in entityContainer) {
        if (entityContainer[entitySetName].$kind === "EntitySet" && metaModel.getObject(`/${entitySetName}@com.sap.vocabularies.Session.v1.StickySessionSupported`)) {
          return true;
        }
      }
      return false;
    },
    /**
     * Method to determine if the programming model is draft.
     *
     * @function
     * @name isDraftSupported
     * @param metaModel ODataModelMetaModel of the context for which draft support shall be checked
     * @param path Path for which draft support shall be checked
     * @returns Returns true if draft, else false
     */
    isDraftSupported: function (metaModel, path) {
      const metaContext = metaModel.getMetaContext(path);
      const objectPath = getInvolvedDataModelObjects(metaContext);
      return this.isObjectPathDraftSupported(objectPath);
    },
    /**
     * Checks if draft is supported for the data model object path.
     *
     * @param dataModelObjectPath
     * @returns `true` if it is supported
     */
    isObjectPathDraftSupported: function (dataModelObjectPath) {
      var _dataModelObjectPath$, _dataModelObjectPath$2, _dataModelObjectPath$3, _dataModelObjectPath$4, _dataModelObjectPath$5, _dataModelObjectPath$6, _dataModelObjectPath$7;
      const currentEntitySet = dataModelObjectPath.targetEntitySet;
      const bIsDraftRoot = ModelHelper.isDraftRoot(currentEntitySet);
      const bIsDraftNode = ModelHelper.isDraftNode(currentEntitySet);
      const bIsDraftParentEntityForContainment = (_dataModelObjectPath$ = dataModelObjectPath.targetObject) !== null && _dataModelObjectPath$ !== void 0 && _dataModelObjectPath$.containsTarget && ((_dataModelObjectPath$2 = dataModelObjectPath.startingEntitySet) !== null && _dataModelObjectPath$2 !== void 0 && (_dataModelObjectPath$3 = _dataModelObjectPath$2.annotations) !== null && _dataModelObjectPath$3 !== void 0 && (_dataModelObjectPath$4 = _dataModelObjectPath$3.Common) !== null && _dataModelObjectPath$4 !== void 0 && _dataModelObjectPath$4.DraftRoot || (_dataModelObjectPath$5 = dataModelObjectPath.startingEntitySet) !== null && _dataModelObjectPath$5 !== void 0 && (_dataModelObjectPath$6 = _dataModelObjectPath$5.annotations) !== null && _dataModelObjectPath$6 !== void 0 && (_dataModelObjectPath$7 = _dataModelObjectPath$6.Common) !== null && _dataModelObjectPath$7 !== void 0 && _dataModelObjectPath$7.DraftNode) ? true : false;
      return bIsDraftRoot || bIsDraftNode || !currentEntitySet && bIsDraftParentEntityForContainment;
    },
    /**
     * Method to determine if the service, supports collaboration draft.
     *
     * @function
     * @name isCollaborationDraftSupported
     * @param metaObject MetaObject to be used for determination
     * @param templateInterface API provided by UI5 templating if used
     * @returns Returns true if the service supports collaboration draft, else false
     */
    isCollaborationDraftSupported: function (metaObject, templateInterface) {
      var _templateInterface$co;
      const oMetaModel = (templateInterface === null || templateInterface === void 0 ? void 0 : (_templateInterface$co = templateInterface.context) === null || _templateInterface$co === void 0 ? void 0 : _templateInterface$co.getModel()) || metaObject;
      const oEntityContainer = oMetaModel.getObject("/");
      for (const sEntitySet in oEntityContainer) {
        if (oEntityContainer[sEntitySet].$kind === "EntitySet" && oMetaModel.getObject(`/${sEntitySet}@com.sap.vocabularies.Common.v1.DraftRoot/ShareAction`)) {
          return true;
        }
      }
      return false;
    },
    /**
     * Method to get the path of the DraftRoot path according to the provided context.
     *
     * @function
     * @name getDraftRootPath
     * @param oContext OdataModel context
     * @returns Returns the path of the draftRoot entity, or undefined if no draftRoot is found
     */
    getDraftRootPath: function (oContext) {
      const oMetaModel = oContext.getModel().getMetaModel();
      const getRootPath = function (sPath, model) {
        var _RegExp$exec;
        let firstIteration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
        const sIterationPath = firstIteration ? sPath : (_RegExp$exec = new RegExp(/.*(?=\/)/).exec(sPath)) === null || _RegExp$exec === void 0 ? void 0 : _RegExp$exec[0]; // *Regex to get the ancestor
        if (sIterationPath && sIterationPath !== "/") {
          var _mDataModel$targetEnt, _mDataModel$targetEnt2;
          const sEntityPath = oMetaModel.getMetaPath(sIterationPath);
          const mDataModel = MetaModelConverter.getInvolvedDataModelObjects(oMetaModel.getContext(sEntityPath));
          if ((_mDataModel$targetEnt = mDataModel.targetEntitySet) !== null && _mDataModel$targetEnt !== void 0 && (_mDataModel$targetEnt2 = _mDataModel$targetEnt.annotations.Common) !== null && _mDataModel$targetEnt2 !== void 0 && _mDataModel$targetEnt2.DraftRoot) {
            return sIterationPath;
          }
          return getRootPath(sIterationPath, model, false);
        }
        return undefined;
      };
      return getRootPath(oContext.getPath(), oContext.getModel());
    },
    /**
     * Method to get the path of the StickyRoot path according to the provided context.
     *
     * @function
     * @name getStickyRootPath
     * @param oContext OdataModel context
     * @returns Returns the path of the StickyRoot entity, or undefined if no StickyRoot is found
     */
    getStickyRootPath: function (oContext) {
      const oMetaModel = oContext.getModel().getMetaModel();
      const getRootPath = function (sPath, model) {
        var _RegExp$exec2;
        let firstIteration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
        const sIterationPath = firstIteration ? sPath : (_RegExp$exec2 = new RegExp(/.*(?=\/)/).exec(sPath)) === null || _RegExp$exec2 === void 0 ? void 0 : _RegExp$exec2[0]; // *Regex to get the ancestor
        if (sIterationPath && sIterationPath !== "/") {
          var _mDataModel$targetEnt3, _mDataModel$targetEnt4, _mDataModel$targetEnt5;
          const sEntityPath = oMetaModel.getMetaPath(sIterationPath);
          const mDataModel = MetaModelConverter.getInvolvedDataModelObjects(oMetaModel.getContext(sEntityPath));
          if ((_mDataModel$targetEnt3 = mDataModel.targetEntitySet) !== null && _mDataModel$targetEnt3 !== void 0 && (_mDataModel$targetEnt4 = _mDataModel$targetEnt3.annotations) !== null && _mDataModel$targetEnt4 !== void 0 && (_mDataModel$targetEnt5 = _mDataModel$targetEnt4.Session) !== null && _mDataModel$targetEnt5 !== void 0 && _mDataModel$targetEnt5.StickySessionSupported) {
            return sIterationPath;
          }
          return getRootPath(sIterationPath, model, false);
        }
        return undefined;
      };
      return getRootPath(oContext.getPath(), oContext.getModel());
    },
    /**
     * Returns the path to the target entity set via navigation property binding.
     *
     * @function
     * @name getTargetEntitySet
     * @param oContext Context for which the target entity set will be determined
     * @returns Returns the path to the target entity set
     */
    getTargetEntitySet: function (oContext) {
      const sPath = oContext.getPath();
      if (oContext.getObject("$kind") === "EntitySet" || oContext.getObject("$kind") === "Action" || oContext.getObject("0/$kind") === "Action") {
        return sPath;
      }
      const sEntitySetPath = ModelHelper.getEntitySetPath(sPath);
      return `/${oContext.getObject(sEntitySetPath)}`;
    },
    /**
     * Returns complete path to the entity set via using navigation property binding. Note: To be used only after the metamodel has loaded.
     *
     * @function
     * @name getEntitySetPath
     * @param path Path for which complete entitySet path needs to be determined from entityType path
     * @param odataMetaModel Metamodel to be used.(Optional in normal scenarios, but needed for parameterized service scenarios)
     * @returns Returns complete path to the entity set
     */
    getEntitySetPath: function (path, odataMetaModel) {
      let entitySetPath = "";
      if (!odataMetaModel) {
        // Previous implementation for getting entitySetPath from entityTypePath
        entitySetPath = `/${path.split("/").filter(ModelHelper.filterOutNavPropBinding).join("/$NavigationPropertyBinding/")}`;
      } else {
        // Calculating the entitySetPath from MetaModel.
        const pathParts = path.split("/").filter(ModelHelper.filterOutNavPropBinding);
        if (pathParts.length > 1) {
          const initialPathObject = {
            growingPath: "/",
            pendingNavPropBinding: ""
          };
          const pathObject = pathParts.reduce((pathUnderConstruction, pathPart, idx) => {
            const delimiter = !!idx && "/$NavigationPropertyBinding/" || "";
            let {
              growingPath,
              pendingNavPropBinding
            } = pathUnderConstruction;
            const tempPath = growingPath + delimiter;
            const navPropBindings = odataMetaModel.getObject(tempPath);
            const navPropBindingToCheck = pendingNavPropBinding ? `${pendingNavPropBinding}/${pathPart}` : pathPart;
            if (navPropBindings && Object.keys(navPropBindings).length > 0 && navPropBindings.hasOwnProperty(navPropBindingToCheck)) {
              growingPath = tempPath + navPropBindingToCheck.replace("/", "%2F");
              pendingNavPropBinding = "";
            } else {
              pendingNavPropBinding += pendingNavPropBinding ? `/${pathPart}` : pathPart;
            }
            return {
              growingPath,
              pendingNavPropBinding
            };
          }, initialPathObject);
          entitySetPath = pathObject.growingPath;
        } else {
          entitySetPath = `/${pathParts[0]}`;
        }
      }
      return entitySetPath;
    },
    /**
     * Gets the path for the items property of MultiValueField parameters.
     *
     * @function
     * @name getActionParameterItemsModelPath
     * @param oParameter Action Parameter
     * @returns Returns the complete model path for the items property of MultiValueField parameters
     */
    getActionParameterItemsModelPath: function (oParameter) {
      return oParameter && oParameter.$Name ? `{path: 'mvfview>/${oParameter.$Name}'}` : undefined;
    },
    filterOutNavPropBinding: function (sPathPart) {
      return sPathPart !== "" && sPathPart !== "$NavigationPropertyBinding";
    },
    /**
     * Adds a setProperty to the created binding contexts of the internal JSON model.
     *
     * @function
     * @name enhanceInternalJSONModel
     * @param {sap.ui.model.json.JSONModel} Internal JSON Model which is enhanced
     */

    enhanceInternalJSONModel: function (oInternalModel) {
      const fnBindContext = oInternalModel.bindContext;
      oInternalModel.bindContext = function (sPath, oContext, mParameters) {
        for (var _len = arguments.length, args = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {
          args[_key - 3] = arguments[_key];
        }
        oContext = fnBindContext.apply(this, [sPath, oContext, mParameters, ...args]);
        const fnGetBoundContext = oContext.getBoundContext;
        oContext.getBoundContext = function () {
          for (var _len2 = arguments.length, subArgs = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
            subArgs[_key2] = arguments[_key2];
          }
          const oBoundContext = fnGetBoundContext.apply(this, ...subArgs);
          if (oBoundContext && !oBoundContext.setProperty) {
            oBoundContext.setProperty = function (sSetPropPath, value) {
              if (this.getObject() === undefined) {
                // initialize
                this.getModel().setProperty(this.getPath(), {});
              }
              this.getModel().setProperty(sSetPropPath, value, this);
            };
          }
          return oBoundContext;
        };
        return oContext;
      };
    },
    /**
     * Adds an handler on propertyChange.
     * The property "/editMode" is changed according to property '/isEditable' when this last one is set
     * in order to be compliant with former versions where building blocks use the property "/editMode"
     *
     * @function
     * @name enhanceUiJSONModel
     * @param {sap.ui.model.json.JSONModel} uiModel JSON Model which is enhanced
     * @param {object} library Core library of SAP Fiori elements
     */

    enhanceUiJSONModel: function (uiModel, library) {
      const fnSetProperty = uiModel.setProperty;
      uiModel.setProperty = function () {
        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
          args[_key3] = arguments[_key3];
        }
        const value = args[1];
        if (args[0] === "/isEditable") {
          uiModel.setProperty("/editMode", value ? library.EditMode.Editable : library.EditMode.Display, args[2], args[3]);
        }
        return fnSetProperty.apply(this, [...args]);
      };
    },
    /**
     * Returns whether filtering on the table is case sensitive.
     *
     * @param oMetaModel The instance of the meta model
     * @returns Returns 'false' if FilterFunctions annotation supports 'tolower', else 'true'
     */
    isFilteringCaseSensitive: function (oMetaModel) {
      if (!oMetaModel) {
        return undefined;
      }
      const aFilterFunctions = oMetaModel.getObject("/@Org.OData.Capabilities.V1.FilterFunctions");
      // Get filter functions defined at EntityContainer and check for existence of 'tolower'
      return aFilterFunctions ? aFilterFunctions.indexOf("tolower") === -1 : true;
    },
    /**
     * Get MetaPath for the context.
     *
     * @param oContext Context to be used
     * @returns Returns the metapath for the context.
     */
    getMetaPathForContext: function (oContext) {
      const oModel = oContext.getModel(),
        oMetaModel = oModel.getMetaModel(),
        sPath = oContext.getPath();
      return oMetaModel && sPath && oMetaModel.getMetaPath(sPath);
    },
    /**
     * Get MetaPath for the context.
     *
     * @param contextPath MetaPath to be used
     * @returns Returns the root entity set path.
     */
    getRootEntitySetPath: function (contextPath) {
      let rootEntitySetPath = "";
      const aPaths = contextPath ? contextPath.split("/") : [];
      if (aPaths.length > 1) {
        rootEntitySetPath = aPaths[1];
      }
      return rootEntitySetPath;
    },
    /**
     * Get MetaPath for the listBinding.
     *
     * @param oView View of the control using listBinding
     * @param vListBinding ODataListBinding object or the binding path for a temporary list binding
     * @returns Returns the metapath for the listbinding.
     */
    getAbsoluteMetaPathForListBinding: function (oView, vListBinding) {
      const oMetaModel = oView.getModel().getMetaModel();
      let sMetaPath;
      if (typeof vListBinding === "string") {
        if (vListBinding.startsWith("/")) {
          // absolute path
          sMetaPath = oMetaModel.getMetaPath(vListBinding);
        } else {
          // relative path
          const oBindingContext = oView.getBindingContext();
          const sRootContextPath = oBindingContext.getPath();
          sMetaPath = oMetaModel.getMetaPath(`${sRootContextPath}/${vListBinding}`);
        }
      } else {
        // we already get a list binding use this one
        const oBinding = vListBinding;
        const oRootBinding = oBinding.getRootBinding();
        if (oBinding === oRootBinding) {
          // absolute path
          sMetaPath = oMetaModel.getMetaPath(oBinding.getPath());
        } else {
          // relative path
          const sRootBindingPath = oRootBinding.getPath();
          const sRelativePath = oBinding.getPath();
          sMetaPath = oMetaModel.getMetaPath(`${sRootBindingPath}/${sRelativePath}`);
        }
      }
      return sMetaPath;
    },
    /**
     * Method to determine if the draft root is supported or not.
     *
     * @function
     * @name isSingleton
     * @param entitySet EntitySet | Singleton | undefined
     * @returns True if entity type is singleton
     */
    isSingleton: function (entitySet) {
      if ((entitySet === null || entitySet === void 0 ? void 0 : entitySet._type) === TypeOfEntity.TypeSingleton) {
        return true;
      }
      return false;
    },
    /**
     * Method to determine if the draft root is supported or not.
     *
     * @function
     * @name isDraftRoot
     * @param entitySet EntitySet | Singleton | undefined
     * @returns True if draft root is present
     */
    isDraftRoot: function (entitySet) {
      var _annotations$Common;
      if (ModelHelper.isSingleton(entitySet)) {
        return false;
      }
      return entitySet && (_annotations$Common = entitySet.annotations.Common) !== null && _annotations$Common !== void 0 && _annotations$Common.DraftRoot ? true : false;
    },
    /**
     * Method to determine if the draft root is supported or not.
     *
     * @function
     * @name isDraftNode
     * @param entitySet EntitySet | Singleton | undefined
     * @returns True if draft root is present
     */
    isDraftNode: function (entitySet) {
      var _annotations$Common2;
      if (ModelHelper.isSingleton(entitySet)) {
        return false;
      }
      return entitySet && (_annotations$Common2 = entitySet.annotations.Common) !== null && _annotations$Common2 !== void 0 && _annotations$Common2.DraftNode ? true : false;
    },
    /**
     * Method to determine if the draft root is supported or not.
     *
     * @function
     * @name isSticky
     * @param entitySet EntitySet | Singleton | undefined
     * @returns True if sticky is supported else false
     */
    isSticky: function (entitySet) {
      var _annotations$Session;
      if (ModelHelper.isSingleton(entitySet)) {
        return false;
      }
      return entitySet && (_annotations$Session = entitySet.annotations.Session) !== null && _annotations$Session !== void 0 && _annotations$Session.StickySessionSupported ? true : false;
    },
    /**
     * Method to determine if entity is updatable or not.
     *
     * @function
     * @name isUpdateHidden
     * @param entitySet EntitySet | Singleton | undefined
     * @param entityType EntityType
     * @returns True if updatable else false
     */
    isUpdateHidden: function (entitySet, entityType) {
      var _annotations$UI, _annotations$UI$Updat, _annotations$UI2, _entityType$annotatio;
      if (ModelHelper.isSingleton(entitySet)) {
        return false;
      }
      return (entitySet === null || entitySet === void 0 ? void 0 : (_annotations$UI = entitySet.annotations.UI) === null || _annotations$UI === void 0 ? void 0 : (_annotations$UI$Updat = _annotations$UI.UpdateHidden) === null || _annotations$UI$Updat === void 0 ? void 0 : _annotations$UI$Updat.valueOf()) !== undefined ? entitySet === null || entitySet === void 0 ? void 0 : (_annotations$UI2 = entitySet.annotations.UI) === null || _annotations$UI2 === void 0 ? void 0 : _annotations$UI2.UpdateHidden : entityType === null || entityType === void 0 ? void 0 : (_entityType$annotatio = entityType.annotations.UI) === null || _entityType$annotatio === void 0 ? void 0 : _entityType$annotatio.UpdateHidden;
    },
    /**
     * Method to get draft root.
     *
     * @function
     * @name getDraftRoot
     * @param entitySet EntitySet | Singleton | undefined
     * @returns DraftRoot
     */
    getDraftRoot: function (entitySet) {
      var _annotations$Common3;
      if (ModelHelper.isSingleton(entitySet)) {
        return undefined;
      }
      return entitySet && ((_annotations$Common3 = entitySet.annotations.Common) === null || _annotations$Common3 === void 0 ? void 0 : _annotations$Common3.DraftRoot);
    },
    /**
     * Method to get draft root.
     *
     * @function
     * @name getDraftNode
     * @param entitySet EntitySet | Singleton | undefined
     * @returns DraftRoot
     */
    getDraftNode: function (entitySet) {
      var _annotations$Common4;
      if (ModelHelper.isSingleton(entitySet)) {
        return undefined;
      }
      return entitySet && ((_annotations$Common4 = entitySet.annotations.Common) === null || _annotations$Common4 === void 0 ? void 0 : _annotations$Common4.DraftNode);
    },
    /**
     * Helper method to get sticky session.
     *
     * @function
     * @name getStickySession
     * @param entitySet EntitySet | Singleton | undefined
     * @returns Session StickySessionSupported
     */
    getStickySession: function (entitySet) {
      var _annotations, _annotations$Session2;
      if (ModelHelper.isSingleton(entitySet)) {
        return undefined;
      }
      return entitySet && ((_annotations = entitySet.annotations) === null || _annotations === void 0 ? void 0 : (_annotations$Session2 = _annotations.Session) === null || _annotations$Session2 === void 0 ? void 0 : _annotations$Session2.StickySessionSupported);
    },
    /**
     * Method to get the visibility state of delete button.
     *
     * @function
     * @name getDeleteHidden
     * @param entitySet EntitySet | Singleton | undefined
     * @param entityType EntityType
     * @returns True if delete button is hidden
     */
    getDeleteHidden: function (entitySet, entityType) {
      var _annotations$UI3, _annotations$UI3$Dele, _annotations$UI4, _entityType$annotatio2;
      if (ModelHelper.isSingleton(entitySet)) {
        return false;
      }
      return (entitySet === null || entitySet === void 0 ? void 0 : (_annotations$UI3 = entitySet.annotations.UI) === null || _annotations$UI3 === void 0 ? void 0 : (_annotations$UI3$Dele = _annotations$UI3.DeleteHidden) === null || _annotations$UI3$Dele === void 0 ? void 0 : _annotations$UI3$Dele.valueOf()) !== undefined ? entitySet === null || entitySet === void 0 ? void 0 : (_annotations$UI4 = entitySet.annotations.UI) === null || _annotations$UI4 === void 0 ? void 0 : _annotations$UI4.DeleteHidden : entityType === null || entityType === void 0 ? void 0 : (_entityType$annotatio2 = entityType.annotations.UI) === null || _entityType$annotatio2 === void 0 ? void 0 : _entityType$annotatio2.DeleteHidden;
    }
  };
  return ModelHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ModelHelper", ["sap/fe/core/converters/MetaModelConverter"],function(t){"use strict";var n={};var e=t.getInvolvedDataModelObjects;let o;(function(t){t["TypeSingleton"]="Singleton";t["TypeEntity"]="EntitySet"})(o||(o={}));n.TypeOfEntity=o;const i={isStickySessionSupported:function(t){const n=t.getObject("/");for(const e in n){if(n[e].$kind==="EntitySet"&&t.getObject(`/${e}@com.sap.vocabularies.Session.v1.StickySessionSupported`)){return true}}return false},isDraftSupported:function(t,n){const o=t.getMetaContext(n);const i=e(o);return this.isObjectPathDraftSupported(i)},isObjectPathDraftSupported:function(t){var n,e,o,r,a,d,l;const s=t.targetEntitySet;const u=i.isDraftRoot(s);const c=i.isDraftNode(s);const f=(n=t.targetObject)!==null&&n!==void 0&&n.containsTarget&&((e=t.startingEntitySet)!==null&&e!==void 0&&(o=e.annotations)!==null&&o!==void 0&&(r=o.Common)!==null&&r!==void 0&&r.DraftRoot||(a=t.startingEntitySet)!==null&&a!==void 0&&(d=a.annotations)!==null&&d!==void 0&&(l=d.Common)!==null&&l!==void 0&&l.DraftNode)?true:false;return u||c||!s&&f},isCollaborationDraftSupported:function(t,n){var e;const o=(n===null||n===void 0?void 0:(e=n.context)===null||e===void 0?void 0:e.getModel())||t;const i=o.getObject("/");for(const t in i){if(i[t].$kind==="EntitySet"&&o.getObject(`/${t}@com.sap.vocabularies.Common.v1.DraftRoot/ShareAction`)){return true}}return false},getDraftRootPath:function(n){const e=n.getModel().getMetaModel();const o=function(n,i){var r;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const d=a?n:(r=new RegExp(/.*(?=\/)/).exec(n))===null||r===void 0?void 0:r[0];if(d&&d!=="/"){var l,s;const n=e.getMetaPath(d);const r=t.getInvolvedDataModelObjects(e.getContext(n));if((l=r.targetEntitySet)!==null&&l!==void 0&&(s=l.annotations.Common)!==null&&s!==void 0&&s.DraftRoot){return d}return o(d,i,false)}return undefined};return o(n.getPath(),n.getModel())},getStickyRootPath:function(n){const e=n.getModel().getMetaModel();const o=function(n,i){var r;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const d=a?n:(r=new RegExp(/.*(?=\/)/).exec(n))===null||r===void 0?void 0:r[0];if(d&&d!=="/"){var l,s,u;const n=e.getMetaPath(d);const r=t.getInvolvedDataModelObjects(e.getContext(n));if((l=r.targetEntitySet)!==null&&l!==void 0&&(s=l.annotations)!==null&&s!==void 0&&(u=s.Session)!==null&&u!==void 0&&u.StickySessionSupported){return d}return o(d,i,false)}return undefined};return o(n.getPath(),n.getModel())},getTargetEntitySet:function(t){const n=t.getPath();if(t.getObject("$kind")==="EntitySet"||t.getObject("$kind")==="Action"||t.getObject("0/$kind")==="Action"){return n}const e=i.getEntitySetPath(n);return`/${t.getObject(e)}`},getEntitySetPath:function(t,n){let e="";if(!n){e=`/${t.split("/").filter(i.filterOutNavPropBinding).join("/$NavigationPropertyBinding/")}`}else{const o=t.split("/").filter(i.filterOutNavPropBinding);if(o.length>1){const t={growingPath:"/",pendingNavPropBinding:""};const i=o.reduce((t,e,o)=>{const i=!!o&&"/$NavigationPropertyBinding/"||"";let{growingPath:r,pendingNavPropBinding:a}=t;const d=r+i;const l=n.getObject(d);const s=a?`${a}/${e}`:e;if(l&&Object.keys(l).length>0&&l.hasOwnProperty(s)){r=d+s.replace("/","%2F");a=""}else{a+=a?`/${e}`:e}return{growingPath:r,pendingNavPropBinding:a}},t);e=i.growingPath}else{e=`/${o[0]}`}}return e},getActionParameterItemsModelPath:function(t){return t&&t.$Name?`{path: 'mvfview>/${t.$Name}'}`:undefined},filterOutNavPropBinding:function(t){return t!==""&&t!=="$NavigationPropertyBinding"},enhanceInternalJSONModel:function(t){const n=t.bindContext;t.bindContext=function(t,e,o){for(var i=arguments.length,r=new Array(i>3?i-3:0),a=3;a<i;a++){r[a-3]=arguments[a]}e=n.apply(this,[t,e,o,...r]);const d=e.getBoundContext;e.getBoundContext=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++){n[e]=arguments[e]}const o=d.apply(this,...n);if(o&&!o.setProperty){o.setProperty=function(t,n){if(this.getObject()===undefined){this.getModel().setProperty(this.getPath(),{})}this.getModel().setProperty(t,n,this)}}return o};return e}},enhanceUiJSONModel:function(t,n){const e=t.setProperty;t.setProperty=function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++){i[r]=arguments[r]}const a=i[1];if(i[0]==="/isEditable"){t.setProperty("/editMode",a?n.EditMode.Editable:n.EditMode.Display,i[2],i[3])}return e.apply(this,[...i])}},isFilteringCaseSensitive:function(t){if(!t){return undefined}const n=t.getObject("/@Org.OData.Capabilities.V1.FilterFunctions");return n?n.indexOf("tolower")===-1:true},getMetaPathForContext:function(t){const n=t.getModel(),e=n.getMetaModel(),o=t.getPath();return e&&o&&e.getMetaPath(o)},getRootEntitySetPath:function(t){let n="";const e=t?t.split("/"):[];if(e.length>1){n=e[1]}return n},getAbsoluteMetaPathForListBinding:function(t,n){const e=t.getModel().getMetaModel();let o;if(typeof n==="string"){if(n.startsWith("/")){o=e.getMetaPath(n)}else{const i=t.getBindingContext();const r=i.getPath();o=e.getMetaPath(`${r}/${n}`)}}else{const t=n;const i=t.getRootBinding();if(t===i){o=e.getMetaPath(t.getPath())}else{const n=i.getPath();const r=t.getPath();o=e.getMetaPath(`${n}/${r}`)}}return o},isSingleton:function(t){if((t===null||t===void 0?void 0:t._type)===o.TypeSingleton){return true}return false},isDraftRoot:function(t){var n;if(i.isSingleton(t)){return false}return t&&(n=t.annotations.Common)!==null&&n!==void 0&&n.DraftRoot?true:false},isDraftNode:function(t){var n;if(i.isSingleton(t)){return false}return t&&(n=t.annotations.Common)!==null&&n!==void 0&&n.DraftNode?true:false},isSticky:function(t){var n;if(i.isSingleton(t)){return false}return t&&(n=t.annotations.Session)!==null&&n!==void 0&&n.StickySessionSupported?true:false},isUpdateHidden:function(t,n){var e,o,r,a;if(i.isSingleton(t)){return false}return(t===null||t===void 0?void 0:(e=t.annotations.UI)===null||e===void 0?void 0:(o=e.UpdateHidden)===null||o===void 0?void 0:o.valueOf())!==undefined?t===null||t===void 0?void 0:(r=t.annotations.UI)===null||r===void 0?void 0:r.UpdateHidden:n===null||n===void 0?void 0:(a=n.annotations.UI)===null||a===void 0?void 0:a.UpdateHidden},getDraftRoot:function(t){var n;if(i.isSingleton(t)){return undefined}return t&&((n=t.annotations.Common)===null||n===void 0?void 0:n.DraftRoot)},getDraftNode:function(t){var n;if(i.isSingleton(t)){return undefined}return t&&((n=t.annotations.Common)===null||n===void 0?void 0:n.DraftNode)},getStickySession:function(t){var n,e;if(i.isSingleton(t)){return undefined}return t&&((n=t.annotations)===null||n===void 0?void 0:(e=n.Session)===null||e===void 0?void 0:e.StickySessionSupported)},getDeleteHidden:function(t,n){var e,o,r,a;if(i.isSingleton(t)){return false}return(t===null||t===void 0?void 0:(e=t.annotations.UI)===null||e===void 0?void 0:(o=e.DeleteHidden)===null||o===void 0?void 0:o.valueOf())!==undefined?t===null||t===void 0?void 0:(r=t.annotations.UI)===null||r===void 0?void 0:r.DeleteHidden:n===null||n===void 0?void 0:(a=n.annotations.UI)===null||a===void 0?void 0:a.DeleteHidden}};return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/PasteHelper-dbg", ["sap/base/Log", "sap/m/MessageBox", "sap/ui/core/Core", "sap/ui/core/util/PasteHelper"], function (Log, MessageBox, Core, CorePasteHelper) {
  "use strict";

  const getInfoForEntityProperty = function (propertyPath, rowBindingPath, metaContext, metaModel) {
    const property = metaContext.getProperty(propertyPath),
      formatOptions = {
        parseKeepsEmptyString: true
      },
      type = metaModel.getUI5Type(`${rowBindingPath}/${propertyPath}`, formatOptions),
      isIgnored = !property || metaContext.getProperty(`${propertyPath}@Org.OData.Core.V1.Computed`);
    return {
      property: propertyPath,
      ignore: isIgnored,
      type: type
    };
  };
  const displayErrorMessages = function (errorMessages) {
    const messageDetails = [...errorMessages];
    const resourceBundle = Core.getLibraryResourceBundle("sap.fe.core"),
      errorCorrectionMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_CORRECTION_MESSAGE"),
      noteMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_CORRECTION_NOTE");
    let pasteErrorMessage;
    if (messageDetails.length > 1) {
      pasteErrorMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_MESSAGE_PLURAL", [messageDetails.length]);
    } else {
      pasteErrorMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_MESSAGE_SINGULAR");
    }
    messageDetails.unshift(""); // To show space between the short text and the list of errors
    messageDetails.unshift(noteMessage);
    messageDetails.unshift(errorCorrectionMessage);
    MessageBox.error(pasteErrorMessage, {
      title: resourceBundle.getText("C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR"),
      details: messageDetails.join("<br>")
    });
  };
  const PasteHelper = {
    displayErrorMessages: displayErrorMessages,
    formatCustomMessage: function (validationMessages, iRowNumber) {
      let errorMessage = "";
      const numberMessages = validationMessages.length;
      const resourceBundle = Core.getLibraryResourceBundle("sap.fe.core"),
        i18nRow = resourceBundle.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW");
      if (numberMessages > 0) {
        errorMessage += `${i18nRow} ${iRowNumber}: `;
        validationMessages.forEach((message, indexMessage) => {
          if (message.messageText) {
            errorMessage += message.messageText + (indexMessage + 1 !== numberMessages ? " " : "");
          }
        });
      }
      return errorMessage;
    },
    getColumnInfo: function (table) {
      const model = table.getRowBinding().getModel(),
        metaModel = model.getMetaModel(),
        rowBindingPath = model.resolve(table.getRowBinding().getPath(), table.getRowBinding().getContext()),
        metaContext = metaModel.getMetaContext(rowBindingPath);
      return table.getControlDelegate().fetchProperties(table).then(propertyInfo => {
        const PropertyInfoDict = Object.assign({}, ...propertyInfo.map(property => ({
          [property.name]: property
        })));
        const columnInfos = [];
        table.getColumns().forEach(column => {
          const infoProperty = PropertyInfoDict[column.getDataProperty()];
          // Check if it's a complex property (property associated to multiple simple properties)
          if (infoProperty.propertyInfos) {
            // Get data from simple property
            infoProperty.propertyInfos.forEach(property => {
              const dataProperty = PropertyInfoDict[property];
              // Non exported columns should be parte of the columnInfos
              if (dataProperty.exportSettings !== null) {
                // Check a navigation property within the current Complex property --> ignore
                if (property.indexOf("/") > -1) {
                  columnInfos.push({
                    property: dataProperty.path,
                    ignore: true
                  });
                } else {
                  columnInfos.push(this.getInfoForEntityProperty(dataProperty.path, rowBindingPath, metaContext, metaModel));
                }
              }
            });
            if (infoProperty.exportDataPointTargetValue) {
              columnInfos.push({
                property: "targetValueFromDataPoint",
                ignore: true
              });
            }
            // Non exported columns should be parte of the columnInfos
          } else if (infoProperty.exportSettings !== null) {
            if (infoProperty.path) {
              columnInfos.push(this.getInfoForEntityProperty(infoProperty.path, rowBindingPath, metaContext, metaModel));
            } else {
              // Empty column --> ignore
              columnInfos.push({
                property: "unused",
                type: null,
                ignore: true
              });
            }
          }
        });
        return columnInfos;
      });
    },
    getInfoForEntityProperty: getInfoForEntityProperty,
    parsePastedData: function (rawData, table) {
      return this.getColumnInfo(table).then(function (pasteInfos) {
        // Check if we have data for at least the first editable column
        const pastedColumnCount = rawData.length ? rawData[0].length : 0;
        let firstEditableColumnIndex = -1;
        for (let I = 0; I < pasteInfos.length && firstEditableColumnIndex < 0; I++) {
          if (!pasteInfos[I].ignore) {
            firstEditableColumnIndex = I;
          }
        }
        return firstEditableColumnIndex < 0 || firstEditableColumnIndex > pastedColumnCount - 1 ? Promise.resolve({}) // We don't have data for an editable column --> return empty parsed data
        : CorePasteHelper.parse(rawData, pasteInfos);
      }).then(parseResult => {
        if (parseResult.errors) {
          const errorMessages = parseResult.errors.map(function (oElement) {
            return oElement.message;
          });
          this.displayErrorMessages(errorMessages);
          return []; // Errors --> return nothing
        } else {
          return parseResult.parsedData ? parseResult.parsedData : [];
        }
      });
    },
    pasteData: function (rawData, table, controller) {
      const oInternalEditFlow = controller._editFlow;
      const tableDefinition = table.getParent().getTableDefinition();
      let aData = [];
      return this.parsePastedData(rawData, table).then(aParsedData => {
        aData = aParsedData || [];
        return Promise.all(aData.map(mData => {
          var _tableDefinition$cont;
          return oInternalEditFlow.getTransactionHelper().validateDocument(table.getBindingContext(), {
            data: mData,
            customValidationFunction: tableDefinition === null || tableDefinition === void 0 ? void 0 : (_tableDefinition$cont = tableDefinition.control) === null || _tableDefinition$cont === void 0 ? void 0 : _tableDefinition$cont.customValidationFunction
          }, controller.getView());
        }));
      }).then(aValidationMessages => {
        const aErrorMessages = aValidationMessages.reduce(function (aMessages, aCustomMessages, index) {
          if (aCustomMessages.length > 0) {
            aMessages.push({
              messages: aCustomMessages,
              row: index + 1
            });
          }
          return aMessages;
        }, []);
        if (aErrorMessages.length > 0) {
          const aRowMessages = aErrorMessages.map(mError => this.formatCustomMessage(mError.messages, mError.row));
          this.displayErrorMessages(aRowMessages);
          return [];
        }
        return aData;
      }).then(aValidatedData => {
        var _tableDefinition$cont2;
        return aValidatedData.length > 0 ? oInternalEditFlow.createMultipleDocuments(table.getRowBinding(), aValidatedData, tableDefinition === null || tableDefinition === void 0 ? void 0 : (_tableDefinition$cont2 = tableDefinition.control) === null || _tableDefinition$cont2 === void 0 ? void 0 : _tableDefinition$cont2.createAtEnd, true, controller.editFlow.onBeforeCreate) : undefined;
      }).catch(oError => {
        Log.error("Error while pasting data", oError);
      });
    }
  };
  return PasteHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/PasteHelper", ["sap/base/Log","sap/m/MessageBox","sap/ui/core/Core","sap/ui/core/util/PasteHelper"],function(e,t,r,n){"use strict";const o=function(e,t,r,n){const o=r.getProperty(e),s={parseKeepsEmptyString:true},i=n.getUI5Type(`${t}/${e}`,s),a=!o||r.getProperty(`${e}@Org.OData.Core.V1.Computed`);return{property:e,ignore:a,type:i}};const s=function(e){const n=[...e];const o=r.getLibraryResourceBundle("sap.fe.core"),s=o.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_CORRECTION_MESSAGE"),i=o.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_CORRECTION_NOTE");let a;if(n.length>1){a=o.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_MESSAGE_PLURAL",[n.length])}else{a=o.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_MESSAGE_SINGULAR")}n.unshift("");n.unshift(i);n.unshift(s);t.error(a,{title:o.getText("C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR"),details:n.join("<br>")})};const i={displayErrorMessages:s,formatCustomMessage:function(e,t){let n="";const o=e.length;const s=r.getLibraryResourceBundle("sap.fe.core"),i=s.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW");if(o>0){n+=`${i} ${t}: `;e.forEach((e,t)=>{if(e.messageText){n+=e.messageText+(t+1!==o?" ":"")}})}return n},getColumnInfo:function(e){const t=e.getRowBinding().getModel(),r=t.getMetaModel(),n=t.resolve(e.getRowBinding().getPath(),e.getRowBinding().getContext()),o=r.getMetaContext(n);return e.getControlDelegate().fetchProperties(e).then(t=>{const s=Object.assign({},...t.map(e=>({[e.name]:e})));const i=[];e.getColumns().forEach(e=>{const t=s[e.getDataProperty()];if(t.propertyInfos){t.propertyInfos.forEach(e=>{const t=s[e];if(t.exportSettings!==null){if(e.indexOf("/")>-1){i.push({property:t.path,ignore:true})}else{i.push(this.getInfoForEntityProperty(t.path,n,o,r))}}});if(t.exportDataPointTargetValue){i.push({property:"targetValueFromDataPoint",ignore:true})}}else if(t.exportSettings!==null){if(t.path){i.push(this.getInfoForEntityProperty(t.path,n,o,r))}else{i.push({property:"unused",type:null,ignore:true})}}});return i})},getInfoForEntityProperty:o,parsePastedData:function(e,t){return this.getColumnInfo(t).then(function(t){const r=e.length?e[0].length:0;let o=-1;for(let e=0;e<t.length&&o<0;e++){if(!t[e].ignore){o=e}}return o<0||o>r-1?Promise.resolve({}):n.parse(e,t)}).then(e=>{if(e.errors){const t=e.errors.map(function(e){return e.message});this.displayErrorMessages(t);return[]}else{return e.parsedData?e.parsedData:[]}})},pasteData:function(t,r,n){const o=n._editFlow;const s=r.getParent().getTableDefinition();let i=[];return this.parsePastedData(t,r).then(e=>{i=e||[];return Promise.all(i.map(e=>{var t;return o.getTransactionHelper().validateDocument(r.getBindingContext(),{data:e,customValidationFunction:s===null||s===void 0?void 0:(t=s.control)===null||t===void 0?void 0:t.customValidationFunction},n.getView())}))}).then(e=>{const t=e.reduce(function(e,t,r){if(t.length>0){e.push({messages:t,row:r+1})}return e},[]);if(t.length>0){const e=t.map(e=>this.formatCustomMessage(e.messages,e.row));this.displayErrorMessages(e);return[]}return i}).then(e=>{var t;return e.length>0?o.createMultipleDocuments(r.getRowBinding(),e,s===null||s===void 0?void 0:(t=s.control)===null||t===void 0?void 0:t.createAtEnd,true,n.editFlow.onBeforeCreate):undefined}).catch(t=>{e.error("Error while pasting data",t)})}};return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/SemanticDateOperators-dbg", ["sap/ui/mdc/condition/FilterOperatorUtil", "sap/ui/mdc/condition/Operator", "sap/ui/model/Filter", "sap/ui/model/FilterOperator", "sap/ui/model/ValidateException"], function (FilterOperatorUtil, Operator, Filter, ModelOperator, ValidateException) {
  "use strict";

  const aSupportedOperations = ["DATE", "FROM", "TO", "DATERANGE"];
  const DYNAMIC_DATE_CATEGORY = "DYNAMIC.DATE";
  const FIXED_DATE_CATEGORY = "FIXED.DATE";
  const DYNAMIC_DATE_INT_CATEGORY = "DYNAMIC.DATE.INT";
  const DYNAMIC_DATERANGE_CATEGORY = "DYNAMIC.DATERANGE";
  const DYNAMIC_MONTH_CATEGORY = "DYNAMIC.MONTH";
  const FIXED_WEEK_CATEGORY = "FIXED.WEEK";
  const FIXED_MONTH_CATEGORY = "FIXED.MONTH";
  const FIXED_QUARTER_CATEGORY = "FIXED.QUARTER";
  const FIXED_YEAR_CATEGORY = "FIXED.YEAR";
  const DYNAMIC_WEEK_INT_CATEGORY = "DYNAMIC.WEEK.INT";
  const DYNAMIC_MONTH_INT_CATEGORY = "DYNAMIC.MONTH.INT";
  const DYNAMIC_QUARTER_INT_CATEGORY = "DYNAMIC.QUARTER.INT";
  const DYNAMIC_YEAR_INT_CATEGORY = "DYNAMIC.YEAR.INT";
  const mSemanticDateOperations = {
    DATE: {
      key: "DATE",
      category: DYNAMIC_DATE_CATEGORY
    },
    FROM: {
      key: "FROM",
      category: DYNAMIC_DATE_CATEGORY
    },
    TO: {
      key: "TO",
      category: DYNAMIC_DATE_CATEGORY
    },
    DATERANGE: {
      key: "DATERANGE",
      category: DYNAMIC_DATERANGE_CATEGORY
    },
    SPECIFICMONTH: {
      key: "SPECIFICMONTH",
      category: DYNAMIC_MONTH_CATEGORY
    },
    TODAY: {
      key: "TODAY",
      category: FIXED_DATE_CATEGORY
    },
    TODAYFROMTO: {
      key: "TODAYFROMTO",
      category: DYNAMIC_DATE_INT_CATEGORY
    },
    YESTERDAY: {
      key: "YESTERDAY",
      category: FIXED_DATE_CATEGORY
    },
    TOMORROW: {
      key: "TOMORROW",
      category: FIXED_DATE_CATEGORY
    },
    LASTDAYS: {
      key: "LASTDAYS",
      category: DYNAMIC_DATE_INT_CATEGORY
    },
    NEXTDAYS: {
      key: "NEXTDAYS",
      category: DYNAMIC_DATE_INT_CATEGORY
    },
    THISWEEK: {
      key: "THISWEEK",
      category: FIXED_WEEK_CATEGORY
    },
    LASTWEEK: {
      key: "LASTWEEK",
      category: FIXED_WEEK_CATEGORY
    },
    LASTWEEKS: {
      key: "LASTWEEKS",
      category: DYNAMIC_WEEK_INT_CATEGORY
    },
    NEXTWEEK: {
      key: "NEXTWEEK",
      category: FIXED_WEEK_CATEGORY
    },
    NEXTWEEKS: {
      key: "NEXTWEEKS",
      category: DYNAMIC_WEEK_INT_CATEGORY
    },
    THISMONTH: {
      key: "THISMONTH",
      category: FIXED_MONTH_CATEGORY
    },
    LASTMONTH: {
      key: "LASTMONTH",
      category: FIXED_MONTH_CATEGORY
    },
    LASTMONTHS: {
      key: "LASTMONTHS",
      category: DYNAMIC_MONTH_INT_CATEGORY
    },
    NEXTMONTH: {
      key: "NEXTMONTH",
      category: FIXED_MONTH_CATEGORY
    },
    NEXTMONTHS: {
      key: "NEXTMONTHS",
      category: DYNAMIC_MONTH_INT_CATEGORY
    },
    THISQUARTER: {
      key: "THISQUARTER",
      category: FIXED_QUARTER_CATEGORY
    },
    LASTQUARTER: {
      key: "LASTQUARTER",
      category: FIXED_QUARTER_CATEGORY
    },
    LASTQUARTERS: {
      key: "LASTQUARTERS",
      category: DYNAMIC_QUARTER_INT_CATEGORY
    },
    NEXTQUARTER: {
      key: "NEXTQUARTER",
      category: FIXED_QUARTER_CATEGORY
    },
    NEXTQUARTERS: {
      key: "NEXTQUARTERS",
      category: DYNAMIC_QUARTER_INT_CATEGORY
    },
    QUARTER1: {
      key: "QUARTER1",
      category: FIXED_QUARTER_CATEGORY
    },
    QUARTER2: {
      key: "QUARTER2",
      category: FIXED_QUARTER_CATEGORY
    },
    QUARTER3: {
      key: "QUARTER3",
      category: FIXED_QUARTER_CATEGORY
    },
    QUARTER4: {
      key: "QUARTER4",
      category: FIXED_QUARTER_CATEGORY
    },
    THISYEAR: {
      key: "THISYEAR",
      category: FIXED_YEAR_CATEGORY
    },
    LASTYEAR: {
      key: "LASTYEAR",
      category: FIXED_YEAR_CATEGORY
    },
    LASTYEARS: {
      key: "LASTYEARS",
      category: DYNAMIC_YEAR_INT_CATEGORY
    },
    NEXTYEAR: {
      key: "NEXTYEAR",
      category: FIXED_YEAR_CATEGORY
    },
    NEXTYEARS: {
      key: "NEXTYEARS",
      category: DYNAMIC_YEAR_INT_CATEGORY
    },
    YEARTODATE: {
      key: "YEARTODATE",
      category: FIXED_YEAR_CATEGORY
    },
    DATETOYEAR: {
      key: "DATETOYEAR",
      category: FIXED_YEAR_CATEGORY
    }
  };
  function _getDateRangeOperator() {
    return new Operator({
      name: "DATERANGE",
      filterOperator: ModelOperator.BT,
      alias: {
        Date: "DATERANGE",
        DateTime: "DATERANGE"
      },
      valueTypes: [Operator.ValueType.Self, Operator.ValueType.Self],
      validate: function (aValues, oType) {
        if (aValues.length < 2) {
          throw new ValidateException("Date Range must have two values");
        } else {
          const fromDate = new Date(aValues[0]);
          const toDate = new Date(aValues[1]);
          if (fromDate.getTime() > toDate.getTime()) {
            throw new ValidateException("From Date Should Be Less Than To Date");
          }
        }
        Operator.prototype.validate.apply(this, [aValues, oType]);
      }
    });
  }
  function _getDateOperator() {
    return new Operator({
      name: "DATE",
      alias: {
        Date: "DATE",
        DateTime: "DATE"
      },
      filterOperator: ModelOperator.EQ,
      valueTypes: [Operator.ValueType.Self],
      getModelFilter: function (oCondition, sFieldPath, oType) {
        return SemanticDateOperators.getModelFilterForDate(oCondition, sFieldPath, oType);
      }
    });
  }
  function _getFromOperator() {
    return new Operator({
      name: "FROM",
      alias: {
        Date: "FROM",
        DateTime: "FROM"
      },
      filterOperator: ModelOperator.GE,
      valueTypes: [Operator.ValueType.Self]
    });
  }
  function _getToOperator() {
    return new Operator({
      name: "TO",
      alias: {
        Date: "TO",
        DateTime: "TO"
      },
      filterOperator: ModelOperator.LE,
      valueTypes: [Operator.ValueType.Self],
      getModelFilter: function (oCondition, sFieldPath, oType) {
        return SemanticDateOperators.getModelFilterForTo(oCondition, sFieldPath, oType);
      }
    });
  }
  function _filterOperation(oOperation, aOperatorConfiguration) {
    if (!aOperatorConfiguration) {
      return true;
    }
    aOperatorConfiguration = Array.isArray(aOperatorConfiguration) ? aOperatorConfiguration : [aOperatorConfiguration];
    let bResult;
    aOperatorConfiguration.some(function (oOperatorConfiguration) {
      let j;
      if (!oOperatorConfiguration.path) {
        return false;
      }
      const sValue = oOperation[oOperatorConfiguration.path];
      const bExclude = oOperatorConfiguration.exclude || false;
      let aOperatorValues;
      if (oOperatorConfiguration.contains && sValue) {
        aOperatorValues = oOperatorConfiguration.contains.split(",");
        bResult = bExclude;
        for (j = 0; j < aOperatorValues.length; j++) {
          if (bExclude && sValue.indexOf(aOperatorValues[j]) > -1) {
            bResult = false;
            return true;
          } else if (!bExclude && sValue.indexOf(aOperatorValues[j]) > -1) {
            bResult = true;
            return true;
          }
        }
      }
      if (oOperatorConfiguration.equals && sValue) {
        aOperatorValues = oOperatorConfiguration.equals.split(",");
        bResult = bExclude;
        for (j = 0; j < aOperatorValues.length; j++) {
          if (bExclude && sValue === aOperatorValues[j]) {
            bResult = false;
            return true;
          } else if (!bExclude && sValue === aOperatorValues[j]) {
            bResult = true;
            return true;
          }
        }
      }
      return false;
    });
    return bResult;
  }
  const SemanticDateOperators = {
    // Extending operators for Sematic Date Control
    addSemanticDateOperators: function () {
      FilterOperatorUtil.addOperator(_getDateRangeOperator());
      FilterOperatorUtil.addOperator(_getDateOperator());
      FilterOperatorUtil.addOperator(_getFromOperator());
      FilterOperatorUtil.addOperator(_getToOperator());
    },
    getSupportedOperations: function () {
      return aSupportedOperations;
    },
    getSemanticDateOperations: function () {
      return Object.keys(mSemanticDateOperations);
    },
    // TODO: Would need to check with MDC for removeOperator method
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    removeSemanticDateOperators: function () {},
    // To filter operators based on manifest aOperatorConfiguration settings
    getFilterOperations: function (aOperatorConfiguration) {
      const aOperations = [];
      for (const n in mSemanticDateOperations) {
        const oOperation = mSemanticDateOperations[n];
        if (_filterOperation(oOperation, aOperatorConfiguration)) {
          aOperations.push(oOperation);
        }
      }
      return aOperations.map(function (oOperation) {
        return oOperation.key;
      });
    },
    hasSemanticDateOperations: function (oConditions) {
      const aSemanticDateOps = this.getSemanticDateOperations();
      for (const n in oConditions) {
        const aFilterCondtion = oConditions[n];
        const oSemanticOperator = aFilterCondtion.find(function (oCondition) {
          return aSemanticDateOps.indexOf(oCondition.operator) > -1;
        });
        if (oSemanticOperator) {
          return false;
        }
      }
      return true;
    },
    getModelFilterForDate: function (oCondition, sFieldPath, oType) {
      if (oType.isA("sap.ui.model.odata.type.DateTimeOffset")) {
        const sFrom = oCondition.values[0];
        const oModelFormat = oType.getModelFormat(); // use ModelFormat to convert in JS-Date and add 23:59:59
        const oDate = oModelFormat.parse(sFrom);
        oDate.setHours(23);
        oDate.setMinutes(59);
        oDate.setSeconds(59);
        oDate.setMilliseconds(999);
        const sTo = oModelFormat.format(oDate);
        return new Filter({
          path: sFieldPath,
          operator: ModelOperator.BT,
          value1: sFrom,
          value2: sTo
        });
      } else {
        return new Filter({
          path: sFieldPath,
          operator: ModelOperator.EQ,
          value1: oCondition.values[0]
        });
      }
    },
    getModelFilterForTo: function (oCondition, sFieldPath, oType) {
      if (oType.isA("sap.ui.model.odata.type.DateTimeOffset")) {
        const value = oCondition.values[0];
        const oModelFormat = oType.getModelFormat(); // use ModelFormat to convert in JS-Date and add 23:59:59
        const oDate = oModelFormat.parse(value);
        oDate.setHours(23);
        oDate.setMinutes(59);
        oDate.setSeconds(59);
        oDate.setMilliseconds(999);
        const sTo = oModelFormat.format(oDate);
        return new Filter({
          path: sFieldPath,
          operator: ModelOperator.LE,
          value1: sTo
        });
      } else {
        return new Filter({
          path: sFieldPath,
          operator: ModelOperator.LE,
          value1: oCondition.values[0]
        });
      }
    }
  };
  return SemanticDateOperators;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/SemanticDateOperators", ["sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/mdc/condition/Operator","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/ValidateException"],function(e,t,r,o,a){"use strict";const n=["DATE","FROM","TO","DATERANGE"];const T="DYNAMIC.DATE";const E="FIXED.DATE";const s="DYNAMIC.DATE.INT";const c="DYNAMIC.DATERANGE";const i="DYNAMIC.MONTH";const A="FIXED.WEEK";const u="FIXED.MONTH";const y="FIXED.QUARTER";const l="FIXED.YEAR";const R="DYNAMIC.WEEK.INT";const O="DYNAMIC.MONTH.INT";const f="DYNAMIC.QUARTER.INT";const D="DYNAMIC.YEAR.INT";const S={DATE:{key:"DATE",category:T},FROM:{key:"FROM",category:T},TO:{key:"TO",category:T},DATERANGE:{key:"DATERANGE",category:c},SPECIFICMONTH:{key:"SPECIFICMONTH",category:i},TODAY:{key:"TODAY",category:E},TODAYFROMTO:{key:"TODAYFROMTO",category:s},YESTERDAY:{key:"YESTERDAY",category:E},TOMORROW:{key:"TOMORROW",category:E},LASTDAYS:{key:"LASTDAYS",category:s},NEXTDAYS:{key:"NEXTDAYS",category:s},THISWEEK:{key:"THISWEEK",category:A},LASTWEEK:{key:"LASTWEEK",category:A},LASTWEEKS:{key:"LASTWEEKS",category:R},NEXTWEEK:{key:"NEXTWEEK",category:A},NEXTWEEKS:{key:"NEXTWEEKS",category:R},THISMONTH:{key:"THISMONTH",category:u},LASTMONTH:{key:"LASTMONTH",category:u},LASTMONTHS:{key:"LASTMONTHS",category:O},NEXTMONTH:{key:"NEXTMONTH",category:u},NEXTMONTHS:{key:"NEXTMONTHS",category:O},THISQUARTER:{key:"THISQUARTER",category:y},LASTQUARTER:{key:"LASTQUARTER",category:y},LASTQUARTERS:{key:"LASTQUARTERS",category:f},NEXTQUARTER:{key:"NEXTQUARTER",category:y},NEXTQUARTERS:{key:"NEXTQUARTERS",category:f},QUARTER1:{key:"QUARTER1",category:y},QUARTER2:{key:"QUARTER2",category:y},QUARTER3:{key:"QUARTER3",category:y},QUARTER4:{key:"QUARTER4",category:y},THISYEAR:{key:"THISYEAR",category:l},LASTYEAR:{key:"LASTYEAR",category:l},LASTYEARS:{key:"LASTYEARS",category:D},NEXTYEAR:{key:"NEXTYEAR",category:l},NEXTYEARS:{key:"NEXTYEARS",category:D},YEARTODATE:{key:"YEARTODATE",category:l},DATETOYEAR:{key:"DATETOYEAR",category:l}};function p(){return new t({name:"DATERANGE",filterOperator:o.BT,alias:{Date:"DATERANGE",DateTime:"DATERANGE"},valueTypes:[t.ValueType.Self,t.ValueType.Self],validate:function(e,r){if(e.length<2){throw new a("Date Range must have two values")}else{const t=new Date(e[0]);const r=new Date(e[1]);if(t.getTime()>r.getTime()){throw new a("From Date Should Be Less Than To Date")}}t.prototype.validate.apply(this,[e,r])}})}function g(){return new t({name:"DATE",alias:{Date:"DATE",DateTime:"DATE"},filterOperator:o.EQ,valueTypes:[t.ValueType.Self],getModelFilter:function(e,t,r){return k.getModelFilterForDate(e,t,r)}})}function N(){return new t({name:"FROM",alias:{Date:"FROM",DateTime:"FROM"},filterOperator:o.GE,valueTypes:[t.ValueType.Self]})}function M(){return new t({name:"TO",alias:{Date:"TO",DateTime:"TO"},filterOperator:o.LE,valueTypes:[t.ValueType.Self],getModelFilter:function(e,t,r){return k.getModelFilterForTo(e,t,r)}})}function d(e,t){if(!t){return true}t=Array.isArray(t)?t:[t];let r;t.some(function(t){let o;if(!t.path){return false}const a=e[t.path];const n=t.exclude||false;let T;if(t.contains&&a){T=t.contains.split(",");r=n;for(o=0;o<T.length;o++){if(n&&a.indexOf(T[o])>-1){r=false;return true}else if(!n&&a.indexOf(T[o])>-1){r=true;return true}}}if(t.equals&&a){T=t.equals.split(",");r=n;for(o=0;o<T.length;o++){if(n&&a===T[o]){r=false;return true}else if(!n&&a===T[o]){r=true;return true}}}return false});return r}const k={addSemanticDateOperators:function(){e.addOperator(p());e.addOperator(g());e.addOperator(N());e.addOperator(M())},getSupportedOperations:function(){return n},getSemanticDateOperations:function(){return Object.keys(S)},removeSemanticDateOperators:function(){},getFilterOperations:function(e){const t=[];for(const r in S){const o=S[r];if(d(o,e)){t.push(o)}}return t.map(function(e){return e.key})},hasSemanticDateOperations:function(e){const t=this.getSemanticDateOperations();for(const r in e){const o=e[r];const a=o.find(function(e){return t.indexOf(e.operator)>-1});if(a){return false}}return true},getModelFilterForDate:function(e,t,a){if(a.isA("sap.ui.model.odata.type.DateTimeOffset")){const n=e.values[0];const T=a.getModelFormat();const E=T.parse(n);E.setHours(23);E.setMinutes(59);E.setSeconds(59);E.setMilliseconds(999);const s=T.format(E);return new r({path:t,operator:o.BT,value1:n,value2:s})}else{return new r({path:t,operator:o.EQ,value1:e.values[0]})}},getModelFilterForTo:function(e,t,a){if(a.isA("sap.ui.model.odata.type.DateTimeOffset")){const n=e.values[0];const T=a.getModelFormat();const E=T.parse(n);E.setHours(23);E.setMinutes(59);E.setSeconds(59);E.setMilliseconds(999);const s=T.format(E);return new r({path:t,operator:o.LE,value1:s})}else{return new r({path:t,operator:o.LE,value1:e.values[0]})}}};return k},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/SemanticKeyHelper-dbg", ["sap/base/Log"], function (Log) {
  "use strict";

  const SemanticKeyHelper = {
    getSemanticKeys: function (oMetaModel, sEntitySetName) {
      return oMetaModel.getObject(`/${sEntitySetName}/@com.sap.vocabularies.Common.v1.SemanticKey`);
    },
    getSemanticObjectInformation: function (oMetaModel, sEntitySetName) {
      const oSemanticObject = oMetaModel.getObject(`/${sEntitySetName}/@com.sap.vocabularies.Common.v1.SemanticObject`);
      const aSemanticKeys = this.getSemanticKeys(oMetaModel, sEntitySetName);
      return {
        semanticObject: oSemanticObject,
        semanticKeys: aSemanticKeys
      };
    },
    getSemanticPath: function (oContext) {
      let bStrict = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      const oMetaModel = oContext.getModel().getMetaModel(),
        sEntitySetName = oMetaModel.getMetaContext(oContext.getPath()).getObject("@sapui.name"),
        oSemanticObjectInformation = this.getSemanticObjectInformation(oMetaModel, sEntitySetName);
      let sTechnicalPath, sSemanticPath;
      if (oContext.isA("sap.ui.model.odata.v4.ODataListBinding") && oContext.isRelative()) {
        sTechnicalPath = oContext.getHeaderContext().getPath();
      } else {
        sTechnicalPath = oContext.getPath();
      }
      if (this._isPathForSemantic(sTechnicalPath) && oSemanticObjectInformation.semanticKeys) {
        const aSemanticKeys = oSemanticObjectInformation.semanticKeys,
          oEntityType = oMetaModel.getObject(`/${oMetaModel.getObject(`/${sEntitySetName}`).$Type}`);
        try {
          const sSemanticKeysPart = aSemanticKeys.map(function (oSemanticKey) {
            const sPropertyPath = oSemanticKey.$PropertyPath;
            let sKeyValue = oContext.getProperty(sPropertyPath);
            if (sKeyValue === undefined || sKeyValue === null) {
              throw new Error(`Couldn't resolve semantic key value for ${sPropertyPath}`);
            } else {
              if (oEntityType[sPropertyPath].$Type === "Edm.String") {
                sKeyValue = `'${encodeURIComponent(sKeyValue)}'`;
              }
              if (aSemanticKeys.length > 1) {
                // Several semantic keys --> path should be entitySet(key1=value1, key2=value2, ...)
                // Otherwise we keep entitySet(keyValue)
                sKeyValue = `${sPropertyPath}=${sKeyValue}`;
              }
              return sKeyValue;
            }
          }).join(",");
          sSemanticPath = `/${sEntitySetName}(${sSemanticKeysPart})`;
        } catch (e) {
          Log.info(e);
        }
      }
      return bStrict ? sSemanticPath : sSemanticPath || sTechnicalPath;
    },
    // ==============================
    // INTERNAL METHODS
    // ==============================

    _isPathForSemantic: function (sPath) {
      // Only path on root objects allow semantic keys, i.e. sPath = xxx(yyy)
      return /^[^\(\)]+\([^\(\)]+\)$/.test(sPath);
    }
  };
  return SemanticKeyHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/SemanticKeyHelper", ["sap/base/Log"],function(e){"use strict";const t={getSemanticKeys:function(e,t){return e.getObject(`/${t}/@com.sap.vocabularies.Common.v1.SemanticKey`)},getSemanticObjectInformation:function(e,t){const n=e.getObject(`/${t}/@com.sap.vocabularies.Common.v1.SemanticObject`);const i=this.getSemanticKeys(e,t);return{semanticObject:n,semanticKeys:i}},getSemanticPath:function(t){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const i=t.getModel().getMetaModel(),a=i.getMetaContext(t.getPath()).getObject("@sapui.name"),o=this.getSemanticObjectInformation(i,a);let c,s;if(t.isA("sap.ui.model.odata.v4.ODataListBinding")&&t.isRelative()){c=t.getHeaderContext().getPath()}else{c=t.getPath()}if(this._isPathForSemantic(c)&&o.semanticKeys){const n=o.semanticKeys,c=i.getObject(`/${i.getObject(`/${a}`).$Type}`);try{const e=n.map(function(e){const i=e.$PropertyPath;let a=t.getProperty(i);if(a===undefined||a===null){throw new Error(`Couldn't resolve semantic key value for ${i}`)}else{if(c[i].$Type==="Edm.String"){a=`'${encodeURIComponent(a)}'`}if(n.length>1){a=`${i}=${a}`}return a}}).join(",");s=`/${a}(${e})`}catch(t){e.info(t)}}return n?s:s||c},_isPathForSemantic:function(e){return/^[^\(\)]+\([^\(\)]+\)$/.test(e)}};return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/SideEffectsHelper-dbg", [], function () {
  "use strict";

  const fnGetOwnerEntityForSourceEntity = function (oSourceEntity, sEntityType, oMetaModel) {
    const sNavigationPath = oSourceEntity["$NavigationPropertyPath"];
    let pOwnerEntity;
    // Source entities have an empty path, that is same as the target entity type of the side effect annotation
    // or it always involves get target entity for this navigation path
    if (sNavigationPath === "") {
      pOwnerEntity = Promise.resolve(sEntityType);
    } else {
      pOwnerEntity = oMetaModel.requestObject("/" + sEntityType + "/" + sNavigationPath + "/@sapui.name");
    }
    return {
      pOwnerEntity,
      sNavigationPath
    };
  };
  const fnGetObjectToGenerateSideEffectMap = function (sEntityType, sSideEffectAnnotation, oSideEffectAnnotation, oMetaModel) {
    const sQualifier = sSideEffectAnnotation.indexOf("#") > -1 && sSideEffectAnnotation.substr(sSideEffectAnnotation.indexOf("#")) || "",
      aSourceProperties = oSideEffectAnnotation.SourceProperties || [],
      aSourceEntities = oSideEffectAnnotation.SourceEntities || [],
      // for each source property or source entity, there could be a oMetaModel.requestObject(...) to get the target entity type of the navigation involved
      resultArray = [];
    aSourceProperties.forEach(function (oSourceProperty) {
      const {
        sPath,
        pOwnerEntity,
        sNavigationPath
      } = fnGetPathForSourceProperty(oSourceProperty["$PropertyPath"], sEntityType, oMetaModel);
      resultArray.push({
        pOwnerEntity,
        sQualifier,
        sNavigationPath,
        sPath,
        sEntityType,
        oSideEffectAnnotation
      });
    });
    aSourceEntities.forEach(function (oSourceEntity) {
      const {
        pOwnerEntity,
        sNavigationPath
      } = fnGetOwnerEntityForSourceEntity(oSourceEntity, sEntityType, oMetaModel);
      resultArray.push({
        pOwnerEntity,
        sQualifier,
        sNavigationPath,
        sPath: "entity",
        sEntityType,
        oSideEffectAnnotation
      });
    });
    return resultArray;
  };
  const fnGetPathForSourceProperty = function (sPath, sEntityType, oMetaModel) {
    // if the property path has a navigation, get the target entity type of the navigation
    const sNavigationPath = sPath.indexOf("/") > 0 ? "/" + sEntityType + "/" + sPath.substr(0, sPath.lastIndexOf("/") + 1) + "@sapui.name" : false,
      pOwnerEntity = !sNavigationPath ? Promise.resolve(sEntityType) : oMetaModel.requestObject(sNavigationPath);
    sPath = sNavigationPath ? sPath.substr(sPath.lastIndexOf("/") + 1) : sPath;
    return {
      sPath,
      pOwnerEntity,
      sNavigationPath
    };
  };
  const SideEffectsHelper = {
    IMMEDIATE_REQUEST: "$$ImmediateRequest",
    generateSideEffectsMapFromMetaModel(oMetaModel) {
      const oSideEffects = {};
      let allEntityTypes = [];
      let allSideEffectsDataArray = [];
      return oMetaModel.requestObject("/$").then(function (oEverything) {
        const fnFilterEntityTypes = function (sKey) {
          return oEverything[sKey]["$kind"] === "EntityType";
        };
        // get everything --> filter the entity types which have side effects annotated
        return Object.keys(oEverything).filter(fnFilterEntityTypes);
      }).then(mapEntityTypes => {
        allEntityTypes = mapEntityTypes;
        return Promise.allSettled(mapEntityTypes.map(sEntityType => {
          return oMetaModel.requestObject("/" + sEntityType + "@");
        }));
      }).then(entityTypesAnnotations => {
        let allSideEffectsPromises = [];
        // loop through all entity types and filter entities having side effect annotations
        // then generate map object for all side effects found
        // also generate the promises array out of the side effect object
        entityTypesAnnotations.forEach(function (entityTypeData, index) {
          if (entityTypeData.status === "fulfilled") {
            const sEntityType = allEntityTypes[index];
            const oAnnotations = entityTypeData.value;
            Object.keys(oAnnotations).filter(function (sAnnotation) {
              return sAnnotation.indexOf("@com.sap.vocabularies.Common.v1.SideEffects") > -1;
            }).forEach(function (sSideEffectAnnotation) {
              const sideEffectsMap = fnGetObjectToGenerateSideEffectMap(sEntityType, sSideEffectAnnotation, oAnnotations[sSideEffectAnnotation], oMetaModel);
              allSideEffectsDataArray = allSideEffectsDataArray.concat(sideEffectsMap);
              allSideEffectsPromises = allSideEffectsPromises.concat(sideEffectsMap.map(i => i["pOwnerEntity"]));
            });
          }
        });
        return Promise.allSettled(allSideEffectsPromises);
      }).then(allSideEffectPromisesResult => {
        // when all the side effects promises have been settled(from source properties and ewntites), we generate side effects object based on side effect data objects values, like entity, sourceproperties

        allSideEffectPromisesResult.forEach((result, index) => {
          if (result.status === "fulfilled") {
            const sOwnerEntityType = result.value;
            const sideeffectDataMap = allSideEffectsDataArray[index];
            const {
              sEntityType,
              sQualifier,
              oSideEffectAnnotation,
              sPath
            } = sideeffectDataMap;
            const aSourceProperties = oSideEffectAnnotation.SourceProperties;
            if (sPath === "entity") {
              // data coming from source entities
              oSideEffects[sOwnerEntityType] = oSideEffects[sOwnerEntityType] || [[], {}];
              // side effects for fields referenced via source entities must always be requested immediately
              oSideEffects[sOwnerEntityType][0].push(`${sEntityType}${sQualifier}${SideEffectsHelper.IMMEDIATE_REQUEST}`); // --> mappingSourceEntities
            } else {
              oSideEffects[sOwnerEntityType] = oSideEffects[sOwnerEntityType] || [[], {}];
              oSideEffects[sOwnerEntityType][1][sPath] = oSideEffects[sOwnerEntityType][1][sPath] || [];
              // if there is only one source property, side effect request is required immediately
              oSideEffects[sOwnerEntityType][1][sPath].push(sEntityType + sQualifier + (aSourceProperties.length === 1 && SideEffectsHelper.IMMEDIATE_REQUEST || "")); // --> mappingSourceProperties
            }
          }
        });

        return oSideEffects;
      }).catch(e => Promise.reject(e));
    }
  };
  return SideEffectsHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/SideEffectsHelper", [],function(){"use strict";const t=function(t,e,n){const i=t["$NavigationPropertyPath"];let s;if(i===""){s=Promise.resolve(e)}else{s=n.requestObject("/"+e+"/"+i+"/@sapui.name")}return{pOwnerEntity:s,sNavigationPath:i}};const e=function(e,i,s,o){const r=i.indexOf("#")>-1&&i.substr(i.indexOf("#"))||"",a=s.SourceProperties||[],c=s.SourceEntities||[],u=[];a.forEach(function(t){const{sPath:i,pOwnerEntity:a,sNavigationPath:c}=n(t["$PropertyPath"],e,o);u.push({pOwnerEntity:a,sQualifier:r,sNavigationPath:c,sPath:i,sEntityType:e,oSideEffectAnnotation:s})});c.forEach(function(n){const{pOwnerEntity:i,sNavigationPath:a}=t(n,e,o);u.push({pOwnerEntity:i,sQualifier:r,sNavigationPath:a,sPath:"entity",sEntityType:e,oSideEffectAnnotation:s})});return u};const n=function(t,e,n){const i=t.indexOf("/")>0?"/"+e+"/"+t.substr(0,t.lastIndexOf("/")+1)+"@sapui.name":false,s=!i?Promise.resolve(e):n.requestObject(i);t=i?t.substr(t.lastIndexOf("/")+1):t;return{sPath:t,pOwnerEntity:s,sNavigationPath:i}};const i={IMMEDIATE_REQUEST:"$$ImmediateRequest",generateSideEffectsMapFromMetaModel(t){const n={};let s=[];let o=[];return t.requestObject("/$").then(function(t){const e=function(e){return t[e]["$kind"]==="EntityType"};return Object.keys(t).filter(e)}).then(e=>{s=e;return Promise.allSettled(e.map(e=>t.requestObject("/"+e+"@")))}).then(n=>{let i=[];n.forEach(function(n,r){if(n.status==="fulfilled"){const a=s[r];const c=n.value;Object.keys(c).filter(function(t){return t.indexOf("@com.sap.vocabularies.Common.v1.SideEffects")>-1}).forEach(function(n){const s=e(a,n,c[n],t);o=o.concat(s);i=i.concat(s.map(t=>t["pOwnerEntity"]))})}});return Promise.allSettled(i)}).then(t=>{t.forEach((t,e)=>{if(t.status==="fulfilled"){const s=t.value;const r=o[e];const{sEntityType:a,sQualifier:c,oSideEffectAnnotation:u,sPath:f}=r;const l=u.SourceProperties;if(f==="entity"){n[s]=n[s]||[[],{}];n[s][0].push(`${a}${c}${i.IMMEDIATE_REQUEST}`)}else{n[s]=n[s]||[[],{}];n[s][1][f]=n[s][1][f]||[];n[s][1][f].push(a+c+(l.length===1&&i.IMMEDIATE_REQUEST||""))}}});return n}).catch(t=>Promise.reject(t))}};return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/StableIdHelper-dbg", [], function () {
  "use strict";

  var _exports = {};
  /**
   * Generates the Id from an IBN.
   *
   * The id contains the value, the potential action and context.
   *
   * @param dataField The IBN annotation
   * @returns The Id
   */
  const _getStableIdPartFromIBN = dataField => {
    var _dataField$Action;
    const idParts = [dataField.SemanticObject.valueOf(), (_dataField$Action = dataField.Action) === null || _dataField$Action === void 0 ? void 0 : _dataField$Action.valueOf()];
    if (dataField.RequiresContext) {
      idParts.push("RequiresContext");
    }
    return idParts.filter(id => id).join("::");
  };

  /**
   * Generates the Id part related to the value of the dataField.
   *
   * @param dataField The dataField
   * @returns String related to the dataField value
   */
  const _getStableIdPartFromValue = dataField => {
    const value = dataField.Value;
    if (value.path) {
      return value.path;
    } else if (value.Apply && value.Function === "odata.concat") {
      return value.Apply.map(app => app.$Path).join("::");
    }
    return replaceSpecialChars(value.replace(/ /g, "_"));
  };

  /**
   * Copy for the Core.isValid function to be independent.
   *
   * @param value String to validate
   * @returns Whether the value is valid or not
   */
  const _isValid = value => {
    return /^([A-Za-z_][-A-Za-z0-9_.:]*)$/.test(value);
  };

  /**
   * Removes the annotation namespaces.
   *
   * @param id String to manipulate
   * @returns String without the annotation namespaces
   */
  const _removeNamespaces = id => {
    id = id.replace("com.sap.vocabularies.UI.v1.", "");
    id = id.replace("com.sap.vocabularies.Communication.v1.", "");
    return id;
  };

  /**
   * Generates the Id from an annotation.
   *
   * @param annotation The annotation
   * @returns The Id
   */
  const createIdForAnnotation = annotation => {
    let id;
    switch (annotation.$Type) {
      case "com.sap.vocabularies.UI.v1.ReferenceFacet":
        id = annotation.ID ?? annotation.Target.value;
        break;
      case "com.sap.vocabularies.UI.v1.CollectionFacet":
        id = annotation.ID ?? "undefined"; // CollectionFacet without Id is not supported but doesn't necessary fail right now
        break;
      case "com.sap.vocabularies.UI.v1.FieldGroupType":
        id = annotation.Label;
        break;
      default:
        id = getStableIdPartFromDataField(annotation);
        break;
    }
    return id ? prepareId(id) : id;
  };

  /**
   * Generates a stable Id based on the given parameters.
   *
   * parameters are combined in the same order that they are provided and are separated by '::'.
   * generate(['Stable', 'Id']) would result in 'Stable::Id' as the Stable Id.
   * Currently supported annotations are Facets, FieldGroup and all kinds of DataField.
   *
   * @param stableIdParts Array of strings, undefined, dataModelObjectPath or annotations
   * @returns Stable Id constructed from the provided parameters
   */
  _exports.createIdForAnnotation = createIdForAnnotation;
  const generate = stableIdParts => {
    const ids = stableIdParts.map(element => {
      if (typeof element === "string" || !element) {
        return element;
      }
      return createIdForAnnotation(element.targetObject || element);
    });
    const result = ids.filter(id => id).join("::");
    return prepareId(result);
  };

  /**
   * Generates the Id from a dataField.
   *
   * @param dataField The dataField
   * @param ignoreForCompatibility Ignore a part of the Id on the DataFieldWithNavigationPath to be aligned with previous version
   * @returns The Id
   */
  _exports.generate = generate;
  const getStableIdPartFromDataField = function (dataField) {
    let ignoreForCompatibility = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let id = "";
    switch (dataField.$Type) {
      case "com.sap.vocabularies.UI.v1.DataFieldForAction":
        id = `DataFieldForAction::${dataField.Action}`;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":
        id = `DataFieldForIntentBasedNavigation::${_getStableIdPartFromIBN(dataField)}`;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
        id = `DataFieldForAnnotation::${dataField.Target.value}`;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
        id = `DataFieldWithAction::${_getStableIdPartFromValue(dataField)}::${dataField.Action}`;
        break;
      case "com.sap.vocabularies.UI.v1.DataField":
        id = `DataField::${_getStableIdPartFromValue(dataField)}`;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
        id = `DataFieldWithIntentBasedNavigation::${_getStableIdPartFromValue(dataField)}::${_getStableIdPartFromIBN(dataField)}`;
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
        id = `DataFieldWithNavigationPath::${_getStableIdPartFromValue(dataField)}`;
        if (dataField.Target.type === "NavigationPropertyPath" && !ignoreForCompatibility) {
          id = `${id}::${dataField.Target.value}`;
        }
        break;
      case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
        id = `DataFieldWithUrl::${_getStableIdPartFromValue(dataField)}`;
        break;
      default:
        break;
    }
    return id ? prepareId(id) : undefined;
  };

  /**
   * Removes or replaces with "::" some special characters.
   * Special characters (@, /, #) are replaced by '::' if they are in the middle of the Stable Id and removed all together if the are part at the beginning or end.
   *
   * @param id String to manipulate
   * @returns String without the special characters
   */
  _exports.getStableIdPartFromDataField = getStableIdPartFromDataField;
  const replaceSpecialChars = id => {
    if (id.indexOf(" ") >= 0) {
      throw Error(`${id} - Spaces are not allowed in ID parts.`);
    }
    id = id.replace(/^\/|^@|^#|^\*/, "") // remove special characters from the beginning of the string
    .replace(/\/$|@$|#$|\*$/, "") // remove special characters from the end of the string
    .replace(/\/|@|\(|\)|#|\*/g, "::"); // replace special characters with ::

    // Replace double occurrences of the separator with a single separator
    while (id.indexOf("::::") > -1) {
      id = id.replace("::::", "::");
    }

    // If there is a :: at the end of the ID remove it
    if (id.slice(-2) == "::") {
      id = id.slice(0, -2);
    }
    return id;
  };

  /**
   * Prepares the Id.
   *
   * Removes namespaces and special characters and checks the validity of this Id.
   *
   * @param id The id
   * @returns The Id or throw an error
   */
  _exports.replaceSpecialChars = replaceSpecialChars;
  const prepareId = function (id) {
    id = replaceSpecialChars(_removeNamespaces(id));
    if (_isValid(id)) {
      return id;
    } else {
      throw Error(`${id} - Stable Id could not be generated due to insufficient information.`);
    }
  };
  _exports.prepareId = prepareId;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/StableIdHelper", [],function(){"use strict";var a={};const e=a=>{var e;const t=[a.SemanticObject.valueOf(),(e=a.Action)===null||e===void 0?void 0:e.valueOf()];if(a.RequiresContext){t.push("RequiresContext")}return t.filter(a=>a).join("::")};const t=a=>{const e=a.Value;if(e.path){return e.path}else if(e.Apply&&e.Function==="odata.concat"){return e.Apply.map(a=>a.$Path).join("::")}return l(e.replace(/ /g,"_"))};const i=a=>/^([A-Za-z_][-A-Za-z0-9_.:]*)$/.test(a);const r=a=>{a=a.replace("com.sap.vocabularies.UI.v1.","");a=a.replace("com.sap.vocabularies.Communication.v1.","");return a};const o=a=>{let e;switch(a.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":e=a.ID??a.Target.value;break;case"com.sap.vocabularies.UI.v1.CollectionFacet":e=a.ID??"undefined";break;case"com.sap.vocabularies.UI.v1.FieldGroupType":e=a.Label;break;default:e=c(a);break}return e?s(e):e};a.createIdForAnnotation=o;const n=a=>{const e=a.map(a=>{if(typeof a==="string"||!a){return a}return o(a.targetObject||a)});const t=e.filter(a=>a).join("::");return s(t)};a.generate=n;const c=function(a){let i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let r="";switch(a.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":r=`DataFieldForAction::${a.Action}`;break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":r=`DataFieldForIntentBasedNavigation::${e(a)}`;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":r=`DataFieldForAnnotation::${a.Target.value}`;break;case"com.sap.vocabularies.UI.v1.DataFieldWithAction":r=`DataFieldWithAction::${t(a)}::${a.Action}`;break;case"com.sap.vocabularies.UI.v1.DataField":r=`DataField::${t(a)}`;break;case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":r=`DataFieldWithIntentBasedNavigation::${t(a)}::${e(a)}`;break;case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":r=`DataFieldWithNavigationPath::${t(a)}`;if(a.Target.type==="NavigationPropertyPath"&&!i){r=`${r}::${a.Target.value}`}break;case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":r=`DataFieldWithUrl::${t(a)}`;break;default:break}return r?s(r):undefined};a.getStableIdPartFromDataField=c;const l=a=>{if(a.indexOf(" ")>=0){throw Error(`${a} - Spaces are not allowed in ID parts.`)}a=a.replace(/^\/|^@|^#|^\*/,"").replace(/\/$|@$|#$|\*$/,"").replace(/\/|@|\(|\)|#|\*/g,"::");while(a.indexOf("::::")>-1){a=a.replace("::::","::")}if(a.slice(-2)=="::"){a=a.slice(0,-2)}return a};a.replaceSpecialChars=l;const s=function(a){a=l(r(a));if(i(a)){return a}else{throw Error(`${a} - Stable Id could not be generated due to insufficient information.`)}};a.prepareId=s;return a},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/Synchronization-dbg", [], function () {
  "use strict";

  let Synchronization = /*#__PURE__*/function () {
    function Synchronization() {
      this._fnResolve = null;
      this._isResolved = false;
    }
    var _proto = Synchronization.prototype;
    _proto.waitFor = function waitFor() {
      if (this._isResolved) {
        return Promise.resolve();
      } else {
        return new Promise(resolve => {
          this._fnResolve = resolve;
        });
      }
    };
    _proto.resolve = function resolve() {
      if (!this._isResolved) {
        this._isResolved = true;
        if (this._fnResolve) {
          this._fnResolve();
        }
      }
    };
    return Synchronization;
  }();
  return Synchronization;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/Synchronization", [],function(){"use strict";let e=function(){function e(){this._fnResolve=null;this._isResolved=false}var s=e.prototype;s.waitFor=function e(){if(this._isResolved){return Promise.resolve()}else{return new Promise(e=>{this._fnResolve=e})}};s.resolve=function e(){if(!this._isResolved){this._isResolved=true;if(this._fnResolve){this._fnResolve()}}};return e}();return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ToES6Promise-dbg", [], function () {
  "use strict";

  /**
   * Transforms a jQuery promise into a regular ES6/TS promise.
   *
   * @param oThenable The jQueryPromise
   * @returns The corresponding ES6 Promise
   */
  function toES6Promise(oThenable) {
    return Promise.resolve(oThenable.then(function () {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      return Array.prototype.slice.call(args);
    }).catch(function () {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      return Array.prototype.slice.call(args);
    }));
  }
  return toES6Promise;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/ToES6Promise", [],function(){"use strict";function r(r){return Promise.resolve(r.then(function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++){e[n]=arguments[n]}return Array.prototype.slice.call(e)}).catch(function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++){e[n]=arguments[n]}return Array.prototype.slice.call(e)}))}return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/TypeGuards-dbg", [], function () {
  "use strict";

  var _exports = {};
  function isContext(potentialContext) {
    var _isA, _ref;
    return potentialContext === null || potentialContext === void 0 ? void 0 : (_isA = (_ref = potentialContext).isA) === null || _isA === void 0 ? void 0 : _isA.call(_ref, "sap.ui.model.Context");
  }
  _exports.isContext = isContext;
  function isFunctionArray(potentialFunctionArray) {
    return Array.isArray(potentialFunctionArray) && potentialFunctionArray.length > 0 && potentialFunctionArray.every(item => typeof item === "function");
  }
  _exports.isFunctionArray = isFunctionArray;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/helpers/TypeGuards", [],function(){"use strict";var n={};function i(n){var i,r;return n===null||n===void 0?void 0:(i=(r=n).isA)===null||i===void 0?void 0:i.call(r,"sap.ui.model.Context")}n.isContext=i;function r(n){return Array.isArray(n)&&n.length>0&&n.every(n=>typeof n==="function")}n.isFunctionArray=r;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/Fragment-dbg", [], function () {
  "use strict";

  var _exports = {};
  let Fragment = function Fragment() {};
  Fragment.isFragment = true;
  _exports = Fragment;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/Fragment", [],function(){"use strict";var e={};let t=function e(){};t.isFragment=true;e=t;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/ViewLoader-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/m/Page", "sap/ui/base/ManagedObject", "sap/ui/core/mvc/View", "sap/fe/core/jsx-runtime/jsx"], function (ClassSupport, Page, ManagedObject, View, _jsx) {
  "use strict";

  var _dec, _dec2, _class, _class2, _descriptor;
  var _exports = {};
  var property = ClassSupport.property;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let ViewLoader = (_dec = defineUI5Class("sap.fe.core.jsx-runtime.MDXViewLoader"), _dec2 = property({
    type: "string"
  }), _dec(_class = (_class2 = /*#__PURE__*/function (_View) {
    _inheritsLoose(ViewLoader, _View);
    function ViewLoader() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _View.call(this, ...args) || this;
      _initializerDefineProperty(_this, "viewName", _descriptor, _assertThisInitialized(_this));
      return _this;
    }
    _exports = ViewLoader;
    var _proto = ViewLoader.prototype;
    _proto.loadDependency = function loadDependency(name) {
      return new Promise(resolve => {
        sap.ui.require([name], async MDXContent => {
          resolve(MDXContent);
        });
      });
    };
    _proto.getControllerName = function getControllerName() {
      const viewData = this.getViewData();
      return viewData.controllerName;
    }
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    // @ts-ignore
    ;
    _proto.createContent = async function createContent(oController) {
      const viewData = this.getViewData();
      const MDXContent = viewData.viewContent || (await this.loadDependency(viewData._mdxViewName));
      ViewLoader.preprocessorData = this.mPreprocessors.xml;
      ViewLoader.controller = oController;
      const mdxContent = ManagedObject.runWithPreprocessors(() => {
        return MDXContent();
      }, {
        id: sId => {
          return this.createId(sId);
        }
      });
      return _jsx(Page, {
        class: "sapUiContentPadding",
        children: {
          content: mdxContent
        }
      });
    };
    return ViewLoader;
  }(View), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "viewName", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  _exports = ViewLoader;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/ViewLoader", ["sap/fe/core/helpers/ClassSupport","sap/m/Page","sap/ui/base/ManagedObject","sap/ui/core/mvc/View","sap/fe/core/jsx-runtime/jsx"],function(e,r,t,i,n){"use strict";var a,o,s,c,l;var u={};var p=e.property;var f=e.defineUI5Class;function d(e,r,t,i){if(!t)return;Object.defineProperty(e,r,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(i):void 0})}function b(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function v(e,r){e.prototype=Object.create(r.prototype);e.prototype.constructor=e;h(e,r)}function h(e,r){h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(r,t){r.__proto__=t;return r};return h(e,r)}function m(e,r,t,i,n){var a={};Object.keys(i).forEach(function(e){a[e]=i[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=t.slice().reverse().reduce(function(t,i){return i(e,r,t)||t},a);if(n&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(n):void 0;a.initializer=undefined}if(a.initializer===void 0){Object.defineProperty(e,r,a);a=null}return a}function w(e,r){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let y=(a=f("sap.fe.core.jsx-runtime.MDXViewLoader"),o=p({type:"string"}),a(s=(c=function(e){v(i,e);function i(){var r;for(var t=arguments.length,i=new Array(t),n=0;n<t;n++){i[n]=arguments[n]}r=e.call(this,...i)||this;d(r,"viewName",l,b(r));return r}u=i;var a=i.prototype;a.loadDependency=function e(r){return new Promise(e=>{sap.ui.require([r],async r=>{e(r)})})};a.getControllerName=function e(){const r=this.getViewData();return r.controllerName};a.createContent=async function e(a){const o=this.getViewData();const s=o.viewContent||await this.loadDependency(o._mdxViewName);i.preprocessorData=this.mPreprocessors.xml;i.controller=a;const c=t.runWithPreprocessors(()=>s(),{id:e=>this.createId(e)});return n(r,{class:"sapUiContentPadding",children:{content:c}})};return i}(i),l=m(c.prototype,"viewName",[o],{configurable:true,enumerable:true,writable:true,initializer:null}),c))||s);u=y;return u},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsx-control-dbg", ["sap/fe/core/helpers/BindingToolkit", "sap/m/Text", "sap/ui/base/DataType"], function (BindingToolkit, Text, DataType) {
  "use strict";

  var isConstant = BindingToolkit.isConstant;
  var compileExpression = BindingToolkit.compileExpression;
  var compileConstant = BindingToolkit.compileConstant;
  const addChildAggregation = function (aggregationChildren, aggregationName, child) {
    if (child === undefined || typeof child === "string") {
      return;
    }
    if (!aggregationChildren[aggregationName]) {
      aggregationChildren[aggregationName] = [];
    }
    if (isChildAnElement(child)) {
      aggregationChildren[aggregationName].push(child);
    } else if (Array.isArray(child)) {
      child.forEach(subChild => {
        addChildAggregation(aggregationChildren, aggregationName, subChild);
      });
    } else {
      Object.keys(child).forEach(childKey => {
        addChildAggregation(aggregationChildren, childKey, child[childKey]);
      });
    }
  };
  const isChildAnElement = function (children) {
    var _isA, _ref;
    return children === null || children === void 0 ? void 0 : (_isA = (_ref = children).isA) === null || _isA === void 0 ? void 0 : _isA.call(_ref, "sap.ui.core.Element");
  };
  const isAControl = function (children) {
    return !!(children !== null && children !== void 0 && children.getMetadata);
  };
  function processAggregations(metadata, mSettings) {
    const metadataAggregations = metadata.getAllAggregations();
    const defaultAggregationName = metadata.getDefaultAggregationName();
    const aggregationChildren = {};
    addChildAggregation(aggregationChildren, defaultAggregationName, mSettings.children);
    delete mSettings.children;
    // find out which aggregation are bound (both in children and directly under it)
    Object.keys(metadataAggregations).forEach(aggregationName => {
      if (aggregationChildren[aggregationName] !== undefined) {
        if (mSettings.hasOwnProperty(aggregationName)) {
          // always use the first item as template according to UI5 logic
          mSettings[aggregationName].template = aggregationChildren[aggregationName][0];
        } else {
          mSettings[aggregationName] = aggregationChildren[aggregationName];
        }
      }
    });
  }

  /**
   * Processes the properties.
   *
   * If the property is a bindingToolkit expression we need to compile it.
   * Else if the property is set as string (compiled binding expression returns string by default even if it's a boolean, int, etc.) and it doesn't match with expected
   * format the value is parsed to provide expected format.
   *
   * @param metadata Metadata of the control
   * @param settings Settings of the control
   * @returns {void}
   */
  function processProperties(metadata, settings) {
    let settingsKey;
    for (settingsKey in settings) {
      const value = settings[settingsKey];
      if (value !== null && value !== void 0 && value._type) {
        const bindingToolkitExpression = value;
        if (isConstant(bindingToolkitExpression)) {
          settings[settingsKey] = compileConstant(value, false, true, true);
        } else {
          settings[settingsKey] = compileExpression(bindingToolkitExpression);
        }
      } else if (typeof settings[settingsKey] === "string" && !settings[settingsKey].startsWith("{")) {
        var _metadata$getAllPrope, _metadata$getAllPrope2, _metadata$getAllPrope3;
        const propertyType = (_metadata$getAllPrope = metadata.getAllProperties()[settingsKey]) === null || _metadata$getAllPrope === void 0 ? void 0 : (_metadata$getAllPrope2 = (_metadata$getAllPrope3 = _metadata$getAllPrope).getType) === null || _metadata$getAllPrope2 === void 0 ? void 0 : _metadata$getAllPrope2.call(_metadata$getAllPrope3);
        if (propertyType && propertyType instanceof DataType && ["boolean", "int", "float"].indexOf(propertyType.getName()) > -1) {
          settings[settingsKey] = propertyType.parseValue(value);
        }
      }
    }
  }
  const jsxControl = function (ControlType, mSettings, key, jsxContext) {
    let targetControl;
    if (ControlType !== null && ControlType !== void 0 && ControlType.isFragment) {
      targetControl = mSettings.children;
    } else if (ControlType !== null && ControlType !== void 0 && ControlType.isRuntime) {
      const runtimeBuildingBlock = new ControlType(mSettings);
      targetControl = runtimeBuildingBlock.getContent(jsxContext.view, jsxContext.appComponent);
    } else if (isAControl(ControlType)) {
      const metadata = ControlType.getMetadata();
      if (key !== undefined) {
        mSettings["key"] = key;
      }
      processAggregations(metadata, mSettings);
      const classDef = mSettings.class;
      const refDef = mSettings.ref;
      delete mSettings.ref;
      delete mSettings.class;
      processProperties(metadata, mSettings);
      targetControl = new ControlType(mSettings);
      if (classDef) {
        targetControl.addStyleClass(classDef);
      }
      if (refDef) {
        refDef.setCurrent(targetControl);
      }
    } else if (typeof ControlType === "function") {
      const controlTypeFn = ControlType;
      targetControl = controlTypeFn(mSettings);
    } else {
      targetControl = new Text({
        text: "Missing component " + ControlType
      });
    }
    return targetControl;
  };
  return jsxControl;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsx-control", ["sap/fe/core/helpers/BindingToolkit","sap/m/Text","sap/ui/base/DataType"],function(e,t,n){"use strict";var i=e.isConstant;var s=e.compileExpression;var o=e.compileConstant;const l=function(e,t,n){if(n===undefined||typeof n==="string"){return}if(!e[t]){e[t]=[]}if(a(n)){e[t].push(n)}else if(Array.isArray(n)){n.forEach(n=>{l(e,t,n)})}else{Object.keys(n).forEach(t=>{l(e,t,n[t])})}};const a=function(e){var t,n;return e===null||e===void 0?void 0:(t=(n=e).isA)===null||t===void 0?void 0:t.call(n,"sap.ui.core.Element")};const r=function(e){return!!(e!==null&&e!==void 0&&e.getMetadata)};function f(e,t){const n=e.getAllAggregations();const i=e.getDefaultAggregationName();const s={};l(s,i,t.children);delete t.children;Object.keys(n).forEach(e=>{if(s[e]!==undefined){if(t.hasOwnProperty(e)){t[e].template=s[e][0]}else{t[e]=s[e]}}})}function c(e,t){let l;for(l in t){const c=t[l];if(c!==null&&c!==void 0&&c._type){const e=c;if(i(e)){t[l]=o(c,false,true,true)}else{t[l]=s(e)}}else if(typeof t[l]==="string"&&!t[l].startsWith("{")){var a,r,f;const i=(a=e.getAllProperties()[l])===null||a===void 0?void 0:(r=(f=a).getType)===null||r===void 0?void 0:r.call(f);if(i&&i instanceof n&&["boolean","int","float"].indexOf(i.getName())>-1){t[l]=i.parseValue(c)}}}}const u=function(e,n,i,s){let o;if(e!==null&&e!==void 0&&e.isFragment){o=n.children}else if(e!==null&&e!==void 0&&e.isRuntime){const t=new e(n);o=t.getContent(s.view,s.appComponent)}else if(r(e)){const t=e.getMetadata();if(i!==undefined){n["key"]=i}f(t,n);const s=n.class;const l=n.ref;delete n.ref;delete n.class;c(t,n);o=new e(n);if(s){o.addStyleClass(s)}if(l){l.setCurrent(o)}}else if(typeof e==="function"){const t=e;o=t(n)}else{o=new t({text:"Missing component "+e})}return o};return u},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsx-dbg", ["sap/fe/core/jsx-runtime/jsx-control", "sap/fe/core/jsx-runtime/jsx-xml"], function (jsxControl, jsxXml) {
  "use strict";

  let renderNextAsXML = false;
  const jsx = function (ControlType, mSettings, key) {
    if (!renderNextAsXML) {
      return jsxControl(ControlType, mSettings, key, jsxContext);
    } else {
      return jsxXml(ControlType, mSettings, key);
    }
  };

  /**
   * Indicates that the next JSX call should be rendered as XML.
   *
   * @param renderMethod The method that needs to be rendered as XML
   * @returns The XML representation of the control
   */
  jsx.renderAsXML = function (renderMethod) {
    renderNextAsXML = true;
    const returnValue = renderMethod();
    renderNextAsXML = false;
    return returnValue;
  };
  let jsxContext = {};
  jsx.getContext = function () {
    return jsxContext;
  };
  jsx.withContext = function (context, functionToExecute) {
    jsxContext = context;
    const callBackReturn = functionToExecute();
    jsxContext = {};
    return callBackReturn;
  };
  return jsx;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsx-xml-dbg", [], function () {
  "use strict";

  const writeChildren = function (val) {
    if (Array.isArray(val)) {
      return val.join("");
    } else {
      return val;
    }
  };
  const addChildAggregation = function (aggregationChildren, aggregationName, child) {
    if (child === undefined) {
      return;
    }
    if (!aggregationChildren[aggregationName]) {
      aggregationChildren[aggregationName] = [];
    }
    if (typeof child === "string" && child.trim().length > 0) {
      aggregationChildren[aggregationName].push(child);
    } else if (Array.isArray(child)) {
      child.forEach(subChild => {
        addChildAggregation(aggregationChildren, aggregationName, subChild);
      });
    } else {
      Object.keys(child).forEach(childKey => {
        addChildAggregation(aggregationChildren, childKey, child[childKey]);
      });
    }
  };
  const FL_DELEGATE = "fl:delegate";
  const jsxXml = function (type, mSettings, key) {
    const metadata = type.getMetadata();
    const namesSplit = metadata.getName().split(".");
    if (key !== undefined) {
      mSettings["key"] = key;
    }
    const metadataProperties = metadata.getAllProperties();
    const metadataAggregations = metadata.getAllAggregations();
    metadataProperties["class"] = {
      name: "class"
    };
    metadataProperties["id"] = {
      name: "id"
    };
    metadataProperties[FL_DELEGATE] = {
      name: FL_DELEGATE
    };
    metadataProperties["xmlns:fl"] = {
      name: FL_DELEGATE
    };
    if (metadata.getName() === "sap.ui.core.Fragment") {
      metadataProperties["fragmentName"] = {
        name: "fragmentName"
      };
    }
    const namespace = namesSplit.slice(0, -1);
    const name = namesSplit[namesSplit.length - 1];
    const namespaceAlias = namespace[namespace.length - 1];
    const tagName = `${namespaceAlias}:${name}`;
    const propertiesString = [];
    const aggregationString = [];
    const defaultAggregationName = metadata.getDefaultAggregationName();
    Object.keys(metadataProperties).forEach(propertyName => {
      if (mSettings.hasOwnProperty(propertyName) && mSettings[propertyName] !== undefined) {
        if (typeof mSettings[propertyName] === "object") {
          propertiesString.push(`${propertyName}='${JSON.stringify(mSettings[propertyName])}'`);
        } else {
          propertiesString.push(`${propertyName}='${mSettings[propertyName]}'`);
        }
      }
    });
    const aggregationChildren = {
      [defaultAggregationName]: []
    };
    addChildAggregation(aggregationChildren, defaultAggregationName, mSettings.children);
    Object.keys(metadataAggregations).forEach(aggregationName => {
      if (aggregationChildren.hasOwnProperty(aggregationName) && aggregationChildren[aggregationName].length > 0) {
        aggregationString.push(`<${namespaceAlias}:${aggregationName}>
						${writeChildren(aggregationChildren[aggregationName])}
					</${namespaceAlias}:${aggregationName}>`);
      }
      if (mSettings.hasOwnProperty(aggregationName) && mSettings[aggregationName] !== undefined) {
        propertiesString.push(`${aggregationName}='${JSON.stringify(mSettings[aggregationName])}'`);
      }
    });
    return `<${tagName} xmlns:${namespaceAlias}="${namespace.join(".")}" ${propertiesString.join(" ")}>${aggregationString.join("")}</${tagName}>`;
  };
  return jsxXml;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsx-xml", [],function(){"use strict";const e=function(e){if(Array.isArray(e)){return e.join("")}else{return e}};const t=function(e,n,s){if(s===undefined){return}if(!e[n]){e[n]=[]}if(typeof s==="string"&&s.trim().length>0){e[n].push(s)}else if(Array.isArray(s)){s.forEach(s=>{t(e,n,s)})}else{Object.keys(s).forEach(n=>{t(e,n,s[n])})}};const n="fl:delegate";const s=function(s,i,r){const o=s.getMetadata();const a=o.getName().split(".");if(r!==undefined){i["key"]=r}const c=o.getAllProperties();const f=o.getAllAggregations();c["class"]={name:"class"};c["id"]={name:"id"};c[n]={name:n};c["xmlns:fl"]={name:n};if(o.getName()==="sap.ui.core.Fragment"){c["fragmentName"]={name:"fragmentName"}}const l=a.slice(0,-1);const g=a[a.length-1];const u=l[l.length-1];const $=`${u}:${g}`;const h=[];const m=[];const y=o.getDefaultAggregationName();Object.keys(c).forEach(e=>{if(i.hasOwnProperty(e)&&i[e]!==undefined){if(typeof i[e]==="object"){h.push(`${e}='${JSON.stringify(i[e])}'`)}else{h.push(`${e}='${i[e]}'`)}}});const d={[y]:[]};t(d,y,i.children);Object.keys(f).forEach(t=>{if(d.hasOwnProperty(t)&&d[t].length>0){m.push(`<${u}:${t}>\n\t\t\t\t\t\t${e(d[t])}\n\t\t\t\t\t</${u}:${t}>`)}if(i.hasOwnProperty(t)&&i[t]!==undefined){h.push(`${t}='${JSON.stringify(i[t])}'`)}});return`<${$} xmlns:${u}="${l.join(".")}" ${h.join(" ")}>${m.join("")}</${$}>`};return s},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsx", ["sap/fe/core/jsx-runtime/jsx-control","sap/fe/core/jsx-runtime/jsx-xml"],function(e,t){"use strict";let n=false;const r=function(r,u,o){if(!n){return e(r,u,o,s)}else{return t(r,u,o)}};r.renderAsXML=function(e){n=true;const t=e();n=false;return t};let s={};r.getContext=function(){return s};r.withContext=function(e,t){s=e;const n=t();s={};return n};return r},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsxs-dbg", ["sap/fe/core/jsx-runtime/jsx"], function (jsx) {
  "use strict";

  return jsx;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/jsxs", ["sap/fe/core/jsx-runtime/jsx"],function(e){"use strict";return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/useMDXComponents-dbg", ["sap/base/Log", "sap/fe/core/buildingBlocks/BuildingBlockRuntime", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/jsx-runtime/ViewLoader", "sap/fe/macros/macroLibrary", "sap/m/FormattedText", "sap/m/HBox", "sap/m/Panel", "sap/m/Title", "sap/ui/codeeditor/CodeEditor", "sap/ui/core/Fragment", "sap/ui/core/library", "sap/ui/core/util/XMLPreprocessor", "sap/fe/core/jsx-runtime/jsx"], function (Log, BuildingBlockRuntime, ClassSupport, MDXViewLoader, macroLibrary, FormattedText, HBox, Panel, Title, CodeEditor, Fragment, library, XMLPreprocessor, _jsx) {
  "use strict";

  var TitleLevel = library.TitleLevel;
  var createReference = ClassSupport.createReference;
  var parseXMLString = BuildingBlockRuntime.parseXMLString;
  function p(strValue) {
    const content = Array.isArray(strValue.children) ? strValue.children.map(child => {
      let output;
      if (typeof child === "string") {
        output = child;
      } else {
        switch (child.getMetadata().getName()) {
          case "sap.m.Link":
            output = `<a href="${child.getHref()}">${child.getText()}</a>`;
            break;
          case "sap.ui.codeeditor.CodeEditor":
            output = `<code>${child.getValue()}</code>`;
            break;
        }
      }
      return output;
    }).join("") : strValue.children;
    return _jsx(FormattedText, {
      htmlText: content,
      class: "sapUiTinyMarginBottom"
    });
  }
  function h1(strValue) {
    return _jsx(Title, {
      text: strValue.children,
      level: TitleLevel.H1,
      class: "sapUiTinyMarginBottom"
    });
  }
  function a(strValue) {
    return `<a href={strValue.href}>${strValue.children}</a>`;
  }
  function ul(strValue) {
    const ulContent = `<ul>${Array.isArray(strValue.children) ? strValue.children.join("") : strValue.children}</ul>`;
    return _jsx(FormattedText, {
      htmlText: ulContent
    });
  }
  function li(strValue) {
    return `<li>${Array.isArray(strValue.children) ? strValue.children.join("") : strValue.children}</li>`;
  }
  function h2(strValue) {
    return _jsx(Title, {
      text: strValue.children,
      level: TitleLevel.H2,
      class: "sapUiSmallMarginTop sapUiTinyMarginBottom"
    });
  }
  function pre(content) {
    return content.children;
  }
  function BuildingBlockPlayground(inValue) {
    const sourceHBox = createReference();
    const binding = inValue.binding ? {
      path: inValue.binding
    } : undefined;
    const target = _jsx(Panel, {
      headerText: inValue.headerText || "",
      class: "sapUiSmallMarginTop",
      children: _jsx(HBox, {
        ref: sourceHBox
      })
    });
    // 	<TabContainer>
    // 		{{
    // 			items: [
    // 				<TabContainerItem name={"Sample"}>{{ content:  }},</TabContainerItem>,
    // 				<TabContainerItem name={"Source"}>
    // 					{{
    // 						content: (
    // 							<CodeBlock editable={false} lineNumbers={true} type={"xml"} lineCount={10}>
    // 								{inValue.children}
    // 							</CodeBlock>
    // 						)
    // 					}}
    // 				</TabContainerItem>
    // 			]
    // 		}}
    // 	</TabContainer>
    // );
    if (binding) {
      target.bindElement(binding);
    }
    macroLibrary.register();
    const fragmentOrPromise = XMLPreprocessor.process(parseXMLString(`<root>${inValue.children}</root>`, true)[0], {
      name: "myBuildingBlockFragment"
    }, MDXViewLoader.preprocessorData);
    Promise.resolve(fragmentOrPromise).then(fragment => {
      return Fragment.load({
        definition: fragment.firstElementChild,
        controller: MDXViewLoader.controller
      });
    }).then(fragmentContent => {
      sourceHBox.current.removeAllItems();
      sourceHBox.current.addItem(fragmentContent);
    }).catch(err => {
      Log.error(err);
    });
    return target;
  }
  function CodeBlock(inValue) {
    var _inValue$children, _snippet$split, _inValue$className;
    const snippet = ((_inValue$children = inValue.children) === null || _inValue$children === void 0 ? void 0 : _inValue$children.trim()) || "";
    const lineCount = inValue.lineCount || Math.max((_snippet$split = snippet.split("\n")) === null || _snippet$split === void 0 ? void 0 : _snippet$split.length, 3);
    const type = inValue.type || (inValue === null || inValue === void 0 ? void 0 : (_inValue$className = inValue.className) === null || _inValue$className === void 0 ? void 0 : _inValue$className.split("-")[1]) || "js";
    const myCodeEditor = _jsx(CodeEditor, {
      class: "sapUiTinyMargin",
      lineNumbers: inValue.lineNumbers || false,
      type: type,
      editable: inValue.editable || false,
      maxLines: lineCount,
      height: "auto",
      width: "98%"
    });
    myCodeEditor.setValue(snippet);
    if (inValue.source) {
      fetch(inValue.source).then(res => res.text()).then(text => {
        var _text$split;
        const newLineCount = Math.max((_text$split = text.split("\n")) === null || _text$split === void 0 ? void 0 : _text$split.length, 3);
        myCodeEditor.setMaxLines(newLineCount);
        myCodeEditor.setValue(text);
      }).catch(e => {
        myCodeEditor.setValue(e.message);
      });
    }
    return myCodeEditor;
  }
  const provideComponenents = function () {
    return {
      p: p,
      a: a,
      h1: h1,
      h2: h2,
      ul: ul,
      li: li,
      pre: pre,
      code: CodeBlock,
      CodeBlock: CodeBlock,
      BuildingBlockPlayground: BuildingBlockPlayground
    };
  };
  return provideComponenents;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/jsx-runtime/useMDXComponents", ["sap/base/Log","sap/fe/core/buildingBlocks/BuildingBlockRuntime","sap/fe/core/helpers/ClassSupport","sap/fe/core/jsx-runtime/ViewLoader","sap/fe/macros/macroLibrary","sap/m/FormattedText","sap/m/HBox","sap/m/Panel","sap/m/Title","sap/ui/codeeditor/CodeEditor","sap/ui/core/Fragment","sap/ui/core/library","sap/ui/core/util/XMLPreprocessor","sap/fe/core/jsx-runtime/jsx"],function(e,r,t,n,i,a,o,s,l,c,u,d,h,p){"use strict";var m=d.TitleLevel;var f=t.createReference;var g=r.parseXMLString;function v(e){const r=Array.isArray(e.children)?e.children.map(e=>{let r;if(typeof e==="string"){r=e}else{switch(e.getMetadata().getName()){case"sap.m.Link":r=`<a href="${e.getHref()}">${e.getText()}</a>`;break;case"sap.ui.codeeditor.CodeEditor":r=`<code>${e.getValue()}</code>`;break}}return r}).join(""):e.children;return p(a,{htmlText:r,class:"sapUiTinyMarginBottom"})}function x(e){return p(l,{text:e.children,level:m.H1,class:"sapUiTinyMarginBottom"})}function y(e){return`<a href={strValue.href}>${e.children}</a>`}function T(e){const r=`<ul>${Array.isArray(e.children)?e.children.join(""):e.children}</ul>`;return p(a,{htmlText:r})}function b(e){return`<li>${Array.isArray(e.children)?e.children.join(""):e.children}</li>`}function B(e){return p(l,{text:e.children,level:m.H2,class:"sapUiSmallMarginTop sapUiTinyMarginBottom"})}function M(e){return e.children}function L(r){const t=f();const a=r.binding?{path:r.binding}:undefined;const l=p(s,{headerText:r.headerText||"",class:"sapUiSmallMarginTop",children:p(o,{ref:t})});if(a){l.bindElement(a)}i.register();const c=h.process(g(`<root>${r.children}</root>`,true)[0],{name:"myBuildingBlockFragment"},n.preprocessorData);Promise.resolve(c).then(e=>u.load({definition:e.firstElementChild,controller:n.controller})).then(e=>{t.current.removeAllItems();t.current.addItem(e)}).catch(r=>{e.error(r)});return l}function k(e){var r,t,n;const i=((r=e.children)===null||r===void 0?void 0:r.trim())||"";const a=e.lineCount||Math.max((t=i.split("\n"))===null||t===void 0?void 0:t.length,3);const o=e.type||(e===null||e===void 0?void 0:(n=e.className)===null||n===void 0?void 0:n.split("-")[1])||"js";const s=p(c,{class:"sapUiTinyMargin",lineNumbers:e.lineNumbers||false,type:o,editable:e.editable||false,maxLines:a,height:"auto",width:"98%"});s.setValue(i);if(e.source){fetch(e.source).then(e=>e.text()).then(e=>{var r;const t=Math.max((r=e.split("\n"))===null||r===void 0?void 0:r.length,3);s.setMaxLines(t);s.setValue(e)}).catch(e=>{s.setValue(e.message)})}return s}const j=function(){return{p:v,a:y,h1:x,h2:B,ul:T,li:b,pre:M,code:k,CodeBlock:k,BuildingBlockPlayground:L}};return j},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/library-dbg", ["sap/base/Log", "sap/fe/core/formatters/FPMFormatter", "sap/fe/core/formatters/StandardFormatter", "sap/fe/core/formatters/ValueFormatter", "sap/fe/core/services/AsyncComponentServiceFactory", "sap/fe/core/services/CacheHandlerServiceFactory", "sap/fe/core/services/EnvironmentServiceFactory", "sap/fe/core/services/NavigationServiceFactory", "sap/fe/core/services/ResourceModelServiceFactory", "sap/fe/core/services/RoutingServiceFactory", "sap/fe/core/services/ShellServicesFactory", "sap/fe/core/services/SideEffectsServiceFactory", "sap/fe/core/services/TemplatedViewServiceFactory", "sap/fe/core/type/DateTimeWithTimezone", "sap/fe/core/type/Email", "sap/fe/core/type/FiscalDate", "sap/fe/navigation/library", "sap/fe/placeholder/library", "sap/ui/base/DataType", "sap/ui/core/Core", "sap/ui/core/library", "sap/ui/core/service/ServiceFactoryRegistry", "sap/ui/fl/library", "sap/ui/mdc/library"], function (Log, _FPMFormatter, _StandardFormatter, _ValueFormatter, AsyncComponentServiceFactory, CacheHandlerServiceFactory, EnvironmentServiceFactory, NavigationService, ResourceModelServiceFactory, RoutingServiceFactory, ShellServicesFactory, SideEffectsServiceFactory, TemplatedViewServiceFactory, _DateTimeWithTimezone, _Email, _FiscalDate, _library, _library2, DataType, Core, _library3, ServiceFactoryRegistry, _library4, _library5) {
  "use strict";

  var _exports = {};
  /**
   * Root namespace for all the libraries related to SAP Fiori elements.
   *
   * @namespace
   * @name sap.fe
   * @public
   */
  const feNamespace = "sap.fe";
  /**
   * Library providing the core functionality of the runtime for SAP Fiori elements for OData V4.
   *
   * @namespace
   * @name sap.fe.core
   * @public
   */
  _exports.feNamespace = feNamespace;
  const feCoreNamespace = "sap.fe.core";
  /**
   * Collection of controller extensions used internally in SAP Fiori elements exposing a method that you can override to allow more flexibility.
   *
   * @namespace
   * @name sap.fe.core.controllerextensions
   * @public
   */
  _exports.feCoreNamespace = feCoreNamespace;
  const feCextNamespace = "sap.fe.controllerextensions";
  /**
   * Collection of classes provided by SAP Fiori elements for the Flexible Programming Model
   *
   * @namespace
   * @name sap.fe.core.fpm
   * @public
   */
  _exports.feCextNamespace = feCextNamespace;
  const feFpmNamespace = "sap.fe.core.fpm";
  _exports.feFpmNamespace = feFpmNamespace;
  const thisLib = Core.initLibrary({
    name: "sap.fe.core",
    dependencies: ["sap.ui.core", "sap.fe.navigation", "sap.fe.placeholder", "sap.ui.fl", "sap.ui.mdc", "sap.f"],
    types: ["sap.fe.core.CreationMode", "sap.fe.core.VariantManagement"],
    interfaces: [],
    controls: [],
    elements: [],
    // eslint-disable-next-line no-template-curly-in-string
    version: "1.111.1",
    noLibraryCSS: true,
    extensions: {
      //Configuration used for rule loading of Support Assistant
      "sap.ui.support": {
        publicRules: true,
        internalRules: true
      },
      flChangeHandlers: {
        "sap.fe.core.controls.FilterBar": "sap/ui/mdc/flexibility/FilterBar"
      }
    }
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
  });

  /**
   * Available values for invocation grouping.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.InvocationGrouping = {
    /**
     * Isolated.
     *
     * @constant
     * @type {string}
     * @public
     */
    Isolated: "Isolated",
    /**
     * ChangeSet.
     *
     * @constant
     * @type {string}
     * @public
     */
    ChangeSet: "ChangeSet"
  };
  /**
   * Available values for creation mode.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.CreationMode = {
    /**
     * New Page.
     *
     * @constant
     * @type {string}
     * @public
     */
    NewPage: "NewPage",
    /**
     * Sync.
     *
     * @constant
     * @type {string}
     * @public
     */
    Sync: "Sync",
    /**
     * Async.
     *
     * @constant
     * @type {string}
     * @public
     */
    Async: "Async",
    /**
     * Deferred.
     *
     * @constant
     * @type {string}
     * @public
     */
    Deferred: "Deferred",
    /**
     * Inline.
     *
     * @constant
     * @type {string}
     * @public
     */
    Inline: "Inline",
    /**
     * Creation row.
     *
     * @constant
     * @type {string}
     * @public
     */
    CreationRow: "CreationRow",
    /**
     * Inline creation rows.
     *
     * @constant
     * @type {string}
     * @public
     */
    InlineCreationRows: "InlineCreationRows",
    /**
     * External (by outbound navigation).
     *
     * @constant
     * @type {string}
     * @public
     */
    External: "External"
  };
  /**
   * Available values for Variant Management.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.VariantManagement = {
    /**
     * No variant management at all.
     *
     * @constant
     * @type {string}
     * @public
     */
    None: "None",
    /**
     * One variant configuration for the whole page.
     *
     * @constant
     * @type {string}
     * @public
     */
    Page: "Page",
    /**
     * Variant management on control level.
     *
     * @constant
     * @type {string}
     * @public
     */
    Control: "Control"
  };
  /**
   * Available constants.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.Constants = {
    /*
     * Indicates cancelling of an action dialog.
     *
     * @constant
     * @type {string}
     * @public
     */
    CancelActionDialog: "cancel",
    /*
     * Indicates failure returned from backend during the execution of an action
     *
     * @constant
     * @type {string}
     * @public
     */
    ActionExecutionFailed: "actionExecutionFailed",
    /*
     * Indicates failure returned from backend during creation of a business object (via direct POST)
     *
     * @constant
     * @type {string}
     * @public
     */
    CreationFailed: "creationFailed"
  };
  /**
   * Available values for programming model.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.ProgrammingModel = {
    /*
     * Draft.
     *
     * @constant
     * @type {string}
     * @public
     */
    Draft: "Draft",
    /**
     * Sticky.
     *
     * @constant
     * @type {string}
     * @public
     */
    Sticky: "Sticky",
    /**
     * NonDraft.
     *
     * @constant
     * @type {string}
     * @public
     */
    NonDraft: "NonDraft"
  };
  /**
   * Available values for draft status.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.DraftStatus = {
    /**
     * Saving.
     *
     * @constant
     * @type {string}
     * @public
     */
    Saving: "Saving",
    /**
     * Saved.
     *
     * @constant
     * @type {string}
     * @public
     */
    Saved: "Saved",
    /**
     * Clear.
     *
     * @constant
     * @type {string}
     * @public
     */
    Clear: "Clear"
  };
  /**
   * Edit mode values.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.EditMode = {
    /**
     * View is currently displaying only.
     *
     * @constant
     * @type {string}
     * @public
     */
    Display: "Display",
    /**
     * View is currently editable.
     *
     * @constant
     * @type {string}
     * @public
     */
    Editable: "Editable"
  };
  /**
   * Template views.
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.TemplateContentView = {
    /**
     * Hybrid.
     *
     * @constant
     * @type {string}
     */
    Hybrid: "Hybrid",
    /**
     * Chart.
     *
     * @constant
     * @type {string}
     */
    Chart: "Chart",
    /**
     * Table.
     *
     * @constant
     * @type {string}
     */
    Table: "Table"
  };
  /**
   * Possible initial load (first app startup) modes for a ListReport.
   *
   * @enum {string}
   * @name sap.fe.core.InitialLoadMode
   * @readonly
   * @public
   * @since 1.86.0
   */
  let InitialLoadMode;
  (function (InitialLoadMode) {
    InitialLoadMode["Enabled"] = "Enabled";
    InitialLoadMode["Disabled"] = "Disabled";
    InitialLoadMode["Auto"] = "Auto";
  })(InitialLoadMode || (InitialLoadMode = {}));
  _exports.InitialLoadMode = InitialLoadMode;
  thisLib.InitialLoadMode = InitialLoadMode;

  /**
   * Value of the startup mode
   *
   * @readonly
   * @enum {string}
   * @private
   */
  thisLib.StartupMode = {
    /**
     * App has been started normally.
     *
     * @constant
     * @type {string}
     */
    Normal: "Normal",
    /**
     * App has been started with startup keys (deeplink).
     *
     * @constant
     * @type {string}
     */
    Deeplink: "Deeplink",
    /**
     * App has been started in 'create' mode.
     *
     * @constant
     * @type {string}
     */
    Create: "Create",
    /**
     * App has been started in 'auto create' mode which means to skip any dialogs on startup
     *
     * @constant
     * @type {string}
     */
    AutoCreate: "AutoCreate"
  };
  // explicit type to handle backward compatibility with boolean values
  const InitialLoadType = DataType.createType("sap.fe.core.InitialLoadMode", {
    defaultValue: thisLib.InitialLoadMode.Auto,
    isValid: function (vValue) {
      if (typeof vValue === "boolean") {
        Log.warning("DEPRECATED: boolean value not allowed for 'initialLoad' manifest setting - supported values are: Disabled|Enabled|Auto");
      }
      return vValue === undefined || vValue === null || typeof vValue === "boolean" || thisLib.InitialLoadMode.hasOwnProperty(vValue);
    }
  });
  // normalize a value, taking care of boolean type
  InitialLoadType.setNormalizer(function (vValue) {
    if (!vValue) {
      // undefined, null or false
      return thisLib.InitialLoadMode.Disabled;
    }
    return vValue === true ? thisLib.InitialLoadMode.Enabled : vValue;
  });
  ServiceFactoryRegistry.register("sap.fe.core.services.TemplatedViewService", new TemplatedViewServiceFactory());
  ServiceFactoryRegistry.register("sap.fe.core.services.ResourceModelService", new ResourceModelServiceFactory());
  ServiceFactoryRegistry.register("sap.fe.core.services.CacheHandlerService", new CacheHandlerServiceFactory());
  ServiceFactoryRegistry.register("sap.fe.core.services.NavigationService", new NavigationService());
  ServiceFactoryRegistry.register("sap.fe.core.services.RoutingService", new RoutingServiceFactory());
  ServiceFactoryRegistry.register("sap.fe.core.services.SideEffectsService", new SideEffectsServiceFactory());
  ServiceFactoryRegistry.register("sap.fe.core.services.ShellServices", new ShellServicesFactory());
  ServiceFactoryRegistry.register("sap.fe.core.services.EnvironmentService", new EnvironmentServiceFactory());
  ServiceFactoryRegistry.register("sap.fe.core.services.AsyncComponentService", new AsyncComponentServiceFactory());
  return thisLib;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/library", ["sap/base/Log","sap/fe/core/formatters/FPMFormatter","sap/fe/core/formatters/StandardFormatter","sap/fe/core/formatters/ValueFormatter","sap/fe/core/services/AsyncComponentServiceFactory","sap/fe/core/services/CacheHandlerServiceFactory","sap/fe/core/services/EnvironmentServiceFactory","sap/fe/core/services/NavigationServiceFactory","sap/fe/core/services/ResourceModelServiceFactory","sap/fe/core/services/RoutingServiceFactory","sap/fe/core/services/ShellServicesFactory","sap/fe/core/services/SideEffectsServiceFactory","sap/fe/core/services/TemplatedViewServiceFactory","sap/fe/core/type/DateTimeWithTimezone","sap/fe/core/type/Email","sap/fe/core/type/FiscalDate","sap/fe/navigation/library","sap/fe/placeholder/library","sap/ui/base/DataType","sap/ui/core/Core","sap/ui/core/library","sap/ui/core/service/ServiceFactoryRegistry","sap/ui/fl/library","sap/ui/mdc/library"],function(e,a,r,i,o,t,s,n,c,l,p,f,d,v,u,y,S,m,g,C,b,F,w,D){"use strict";var E={};const M="sap.fe";E.feNamespace=M;const N="sap.fe.core";E.feCoreNamespace=N;const I="sap.fe.controllerextensions";E.feCextNamespace=I;const h="sap.fe.core.fpm";E.feFpmNamespace=h;const A=C.initLibrary({name:"sap.fe.core",dependencies:["sap.ui.core","sap.fe.navigation","sap.fe.placeholder","sap.ui.fl","sap.ui.mdc","sap.f"],types:["sap.fe.core.CreationMode","sap.fe.core.VariantManagement"],interfaces:[],controls:[],elements:[],version:"1.111.1",noLibraryCSS:true,extensions:{"sap.ui.support":{publicRules:true,internalRules:true},flChangeHandlers:{"sap.fe.core.controls.FilterBar":"sap/ui/mdc/flexibility/FilterBar"}}});A.InvocationGrouping={Isolated:"Isolated",ChangeSet:"ChangeSet"};A.CreationMode={NewPage:"NewPage",Sync:"Sync",Async:"Async",Deferred:"Deferred",Inline:"Inline",CreationRow:"CreationRow",InlineCreationRows:"InlineCreationRows",External:"External"};A.VariantManagement={None:"None",Page:"Page",Control:"Control"};A.Constants={CancelActionDialog:"cancel",ActionExecutionFailed:"actionExecutionFailed",CreationFailed:"creationFailed"};A.ProgrammingModel={Draft:"Draft",Sticky:"Sticky",NonDraft:"NonDraft"};A.DraftStatus={Saving:"Saving",Saved:"Saved",Clear:"Clear"};A.EditMode={Display:"Display",Editable:"Editable"};A.TemplateContentView={Hybrid:"Hybrid",Chart:"Chart",Table:"Table"};let R;(function(e){e["Enabled"]="Enabled";e["Disabled"]="Disabled";e["Auto"]="Auto"})(R||(R={}));E.InitialLoadMode=R;A.InitialLoadMode=R;A.StartupMode={Normal:"Normal",Deeplink:"Deeplink",Create:"Create",AutoCreate:"AutoCreate"};const L=g.createType("sap.fe.core.InitialLoadMode",{defaultValue:A.InitialLoadMode.Auto,isValid:function(a){if(typeof a==="boolean"){e.warning("DEPRECATED: boolean value not allowed for 'initialLoad' manifest setting - supported values are: Disabled|Enabled|Auto")}return a===undefined||a===null||typeof a==="boolean"||A.InitialLoadMode.hasOwnProperty(a)}});L.setNormalizer(function(e){if(!e){return A.InitialLoadMode.Disabled}return e===true?A.InitialLoadMode.Enabled:e});F.register("sap.fe.core.services.TemplatedViewService",new d);F.register("sap.fe.core.services.ResourceModelService",new c);F.register("sap.fe.core.services.CacheHandlerService",new t);F.register("sap.fe.core.services.NavigationService",new n);F.register("sap.fe.core.services.RoutingService",new l);F.register("sap.fe.core.services.SideEffectsService",new f);F.register("sap.fe.core.services.ShellServices",new p);F.register("sap.fe.core.services.EnvironmentService",new s);F.register("sap.fe.core.services.AsyncComponentService",new o);return A},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/manifestMerger/ChangePageConfiguration-dbg", ["sap/base/Log", "sap/base/util/ObjectPath"], function (Log, ObjectPath) {
  "use strict";

  var _exports = {};
  /**
   * Apply change method.
   *
   * This method is being called by the FLEX framework in case a manifest change with the change type
   * 'appdescr_fe_changePageConfiguration' was created for the current application. This method is not meant to be
   * called by anyone else but the FLEX framework.
   *
   * @function
   * @name sap.fe.core.manifestMerger#applyChange
   * @param manifest The original manifest.
   * @param change The change content.
   * @returns The changed or unchanged manifest.
   * @private
   */
  function applyChange(manifest, change) {
    const changeContent = change.getContent();
    const pageId = changeContent === null || changeContent === void 0 ? void 0 : changeContent.page;
    const propertyChange = changeContent === null || changeContent === void 0 ? void 0 : changeContent.entityPropertyChange;

    // return unmodified manifest in case change not valid
    if ((propertyChange === null || propertyChange === void 0 ? void 0 : propertyChange.operation) !== "UPSERT" || !(propertyChange !== null && propertyChange !== void 0 && propertyChange.propertyPath) || (propertyChange === null || propertyChange === void 0 ? void 0 : propertyChange.propertyValue) === undefined || propertyChange !== null && propertyChange !== void 0 && propertyChange.propertyPath.startsWith("/")) {
      Log.error("Change content is not a valid");
      return manifest;
    }
    return changeConfiguration(manifest, pageId, propertyChange.propertyPath, propertyChange.propertyValue);
  }

  /**
   * Changes the page configuration of SAP Fiori elements.
   *
   * This method enables you to change the page configuration of SAP Fiori elements.
   *
   * @function
   * @name sap.fe.core.manifestMerger#changeConfiguration
   * @param manifest The original manifest.
   * @param pageId The ID of the page for which the configuration is to be changed.
   * @param path The path in the page settings for which the configuration is to be changed.
   * @param value The new value of the configuration. This could be a plain value like a string, or a Boolean, or a structured object.
   * @returns The changed or unchanged manifest.
   * @private
   */
  _exports.applyChange = applyChange;
  function changeConfiguration(manifest, pageId, path, value) {
    const pageSettings = getPageSettings(manifest, pageId);
    if (pageSettings) {
      let propertyPath = path.split("/");
      if (propertyPath[0] === "controlConfiguration") {
        let annotationPath = "";
        // the annotation path in the control configuration has to stay together. For now rely on the fact the @ is in the last part
        for (let i = 1; i < propertyPath.length; i++) {
          annotationPath += (i > 1 ? "/" : "") + propertyPath[i];
          if (annotationPath.indexOf("@") > -1) {
            propertyPath = ["controlConfiguration", annotationPath].concat(propertyPath.slice(i + 1));
            break;
          }
        }
      }
      ObjectPath.set(propertyPath, value, pageSettings);
    } else {
      Log.error(`No Fiori elements page with ID ${pageId} found in routing targets.`);
    }
    return manifest;
  }

  /**
   * Search the page settings in the manifest for a given page ID.
   *
   * @function
   * @name sap.fe.core.manifestMerger#getPageSettings
   * @param manifest The manifest where the search is carried out to find the page settings.
   * @param pageId The ID of the page.
   * @returns The page settings for the page ID or undefined if not found.
   * @private
   */
  _exports.changeConfiguration = changeConfiguration;
  function getPageSettings(manifest, pageId) {
    var _manifest$sapUi, _manifest$sapUi$routi;
    let pageSettings;
    const targets = ((_manifest$sapUi = manifest["sap.ui5"]) === null || _manifest$sapUi === void 0 ? void 0 : (_manifest$sapUi$routi = _manifest$sapUi.routing) === null || _manifest$sapUi$routi === void 0 ? void 0 : _manifest$sapUi$routi.targets) ?? {};
    for (const p in targets) {
      if (targets[p].id === pageId && targets[p].name.startsWith("sap.fe.templates.")) {
        var _targets$p$options;
        pageSettings = ((_targets$p$options = targets[p].options) === null || _targets$p$options === void 0 ? void 0 : _targets$p$options.settings) ?? {};
        break;
      }
    }
    return pageSettings;
  }
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/manifestMerger/ChangePageConfiguration", ["sap/base/Log","sap/base/util/ObjectPath"],function(t,n){"use strict";var o={};function e(n,o){const e=o.getContent();const r=e===null||e===void 0?void 0:e.page;const a=e===null||e===void 0?void 0:e.entityPropertyChange;if((a===null||a===void 0?void 0:a.operation)!=="UPSERT"||!(a!==null&&a!==void 0&&a.propertyPath)||(a===null||a===void 0?void 0:a.propertyValue)===undefined||a!==null&&a!==void 0&&a.propertyPath.startsWith("/")){t.error("Change content is not a valid");return n}return i(n,r,a.propertyPath,a.propertyValue)}o.applyChange=e;function i(o,e,i,a){const l=r(o,e);if(l){let t=i.split("/");if(t[0]==="controlConfiguration"){let n="";for(let o=1;o<t.length;o++){n+=(o>1?"/":"")+t[o];if(n.indexOf("@")>-1){t=["controlConfiguration",n].concat(t.slice(o+1));break}}}n.set(t,a,l)}else{t.error(`No Fiori elements page with ID ${e} found in routing targets.`)}return o}o.changeConfiguration=i;function r(t,n){var o,e;let i;const r=((o=t["sap.ui5"])===null||o===void 0?void 0:(e=o.routing)===null||e===void 0?void 0:e.targets)??{};for(const t in r){if(r[t].id===n&&r[t].name.startsWith("sap.fe.templates.")){var a;i=((a=r[t].options)===null||a===void 0?void 0:a.settings)??{};break}}return i}return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/operationsHelper-dbg", ["sap/m/MessageBox", "sap/ui/core/message/Message", "sap/ui/model/json/JSONModel", "./CommonUtils", "./controllerextensions/dialog/OperationsDialog.block", "./controllerextensions/messageHandler/messageHandling", "./formatters/TableFormatterTypes"], function (MessageBox, Message, JSONModel, CommonUtils, OperationsDialog, messageHandling, TableFormatterTypes) {
  "use strict";

  var MessageType = TableFormatterTypes.MessageType;
  function renderMessageView(mParameters, oResourceBundle, messageHandler, aMessages, strictHandlingUtilities, isMultiContext412, resolve, sGroupId) {
    const sActionName = mParameters.label;
    const oModel = mParameters.model;
    const strictHandlingPromises = strictHandlingUtilities === null || strictHandlingUtilities === void 0 ? void 0 : strictHandlingUtilities.strictHandlingPromises;
    let sMessage;
    let sCancelButtonTxt = CommonUtils.getTranslatedText("C_COMMON_DIALOG_CANCEL", oResourceBundle);
    if (aMessages.length === 1) {
      const messageText = aMessages[0].getMessage();
      const identifierText = aMessages[0].getAdditionalText();
      if (!isMultiContext412) {
        sMessage = `${messageText}\n${CommonUtils.getTranslatedText("PROCEED", oResourceBundle)}`;
      } else if (identifierText !== undefined && identifierText !== "") {
        sCancelButtonTxt = CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP", oResourceBundle);
        const sHeaderInfoTypeName = mParameters.control.getParent().getTableDefinition().headerInfoTypeName;
        if (sHeaderInfoTypeName) {
          sMessage = `${sHeaderInfoTypeName} ${identifierText}: ${messageText}\n\n${CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP_SINGLE_MESSAGE_TEXT", oResourceBundle)}`;
        } else {
          sMessage = `${identifierText}: ${messageText}\n\n${CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP_SINGLE_MESSAGE_TEXT", oResourceBundle)}`;
        }
      } else {
        sCancelButtonTxt = CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP", oResourceBundle);
        sMessage = `${messageText}\n\n${CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP_SINGLE_MESSAGE_TEXT", oResourceBundle)}`;
      }
      MessageBox.warning(sMessage, {
        title: CommonUtils.getTranslatedText("WARNING", oResourceBundle),
        actions: [sActionName, sCancelButtonTxt],
        emphasizedAction: sActionName,
        onClose: function (sAction) {
          if (sAction === sActionName) {
            if (!isMultiContext412) {
              resolve(true);
              oModel.submitBatch(sGroupId);
              if (mParameters.requestSideEffects) {
                mParameters.requestSideEffects();
              }
            } else {
              strictHandlingPromises.forEach(function (sHPromise) {
                sHPromise.resolve(true);
                oModel.submitBatch(sHPromise.groupId);
                if (sHPromise.requestSideEffects) {
                  sHPromise.requestSideEffects();
                }
              });
              const strictHandlingFails = strictHandlingUtilities === null || strictHandlingUtilities === void 0 ? void 0 : strictHandlingUtilities.strictHandlingTransitionFails;
              if (strictHandlingFails.length > 0) {
                messageHandler === null || messageHandler === void 0 ? void 0 : messageHandler.removeTransitionMessages();
              }
            }
            if (strictHandlingUtilities) {
              strictHandlingUtilities.is412Executed = true;
            }
          } else {
            if (strictHandlingUtilities) {
              strictHandlingUtilities.is412Executed = false;
            }
            if (!isMultiContext412) {
              resolve(false);
            } else {
              strictHandlingPromises.forEach(function (sHPromise) {
                sHPromise.resolve(false);
              });
            }
          }
          if (strictHandlingUtilities) {
            strictHandlingUtilities.strictHandlingWarningMessages = [];
          }
        }
      });
    } else if (aMessages.length > 1) {
      if (isMultiContext412) {
        sCancelButtonTxt = CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP", oResourceBundle);
        const genericMessage = new Message({
          message: CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP_MESSAGES_WARNING", oResourceBundle),
          type: MessageType.Warning,
          target: undefined,
          persistent: true,
          description: CommonUtils.getTranslatedText("C_COMMON_DIALOG_SKIP_MESSAGES_TEXT", oResourceBundle, [sActionName])
        });
        aMessages = [genericMessage].concat(aMessages);
      }
      const oMessageDialogModel = new JSONModel();
      oMessageDialogModel.setData(aMessages);
      const bStrictHandlingFlow = true;
      const oMessageObject = messageHandling.prepareMessageViewForDialog(oMessageDialogModel, bStrictHandlingFlow, isMultiContext412);
      const operationsDialog = new OperationsDialog({
        messageObject: oMessageObject,
        isMultiContext412: isMultiContext412,
        resolve: resolve,
        model: oModel,
        groupId: sGroupId,
        actionName: sActionName,
        strictHandlingUtilities: strictHandlingUtilities,
        strictHandlingPromises: strictHandlingPromises,
        messageHandler: messageHandler,
        messageDialogModel: oMessageDialogModel,
        cancelButtonTxt: sCancelButtonTxt
      });
      operationsDialog.open();
    }
  }
  async function fnOnStrictHandlingFailed(sGroupId, mParameters, oResourceBundle, currentContextIndex, oContext, iContextLength, messageHandler, strictHandlingUtilities, a412Messages) {
    if (currentContextIndex === null && iContextLength === null || currentContextIndex === 1 && iContextLength === 1) {
      return new Promise(function (resolve) {
        operationsHelper.renderMessageView(mParameters, oResourceBundle, messageHandler, a412Messages, strictHandlingUtilities, false, resolve, sGroupId);
      });
    } else {
      const sActionName = mParameters.label;
      const a412TransitionMessages = strictHandlingUtilities === null || strictHandlingUtilities === void 0 ? void 0 : strictHandlingUtilities.strictHandlingWarningMessages;
      const sColumn = mParameters.control.getParent().getIdentifierColumn();
      let sValue = "";
      if (sColumn && iContextLength && iContextLength > 1) {
        sValue = oContext && oContext.getObject(sColumn);
      }
      a412Messages.forEach(function (msg) {
        msg.setType("Warning");
        msg.setAdditionalText(sValue);
        a412TransitionMessages.push(msg);
      });
      if (mParameters.dialog && mParameters.dialog.isOpen()) {
        mParameters.dialog.close();
      }
      const strictHandlingPromises = strictHandlingUtilities === null || strictHandlingUtilities === void 0 ? void 0 : strictHandlingUtilities.strictHandlingPromises;
      const strictHandlingPromise = new Promise(function (resolve) {
        strictHandlingPromises.push({
          groupId: sGroupId,
          resolve: resolve,
          actionName: sActionName,
          model: mParameters.model,
          value: sValue,
          requestSideEffects: mParameters.requestSideEffects
        });
      });
      strictHandlingUtilities.strictHandlingWarningMessages = a412TransitionMessages;
      strictHandlingUtilities.strictHandlingPromises = strictHandlingPromises;
      if (currentContextIndex === iContextLength) {
        operationsHelper.renderMessageView(mParameters, oResourceBundle, messageHandler, strictHandlingUtilities.strictHandlingWarningMessages, strictHandlingUtilities, true);
      }
      return strictHandlingPromise;
    }
  }
  const operationsHelper = {
    renderMessageView: renderMessageView,
    fnOnStrictHandlingFailed: fnOnStrictHandlingFailed
  };
  return operationsHelper;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/operationsHelper", ["sap/m/MessageBox","sap/ui/core/message/Message","sap/ui/model/json/JSONModel","./CommonUtils","./controllerextensions/dialog/OperationsDialog.block","./controllerextensions/messageHandler/messageHandling","./formatters/TableFormatterTypes"],function(e,t,s,n,i,a,o){"use strict";var l=o.MessageType;function r(o,r,d,c,g,f,u,T){const _=o.label;const M=o.model;const O=g===null||g===void 0?void 0:g.strictHandlingPromises;let m;let E=n.getTranslatedText("C_COMMON_DIALOG_CANCEL",r);if(c.length===1){const t=c[0].getMessage();const s=c[0].getAdditionalText();if(!f){m=`${t}\n${n.getTranslatedText("PROCEED",r)}`}else if(s!==undefined&&s!==""){E=n.getTranslatedText("C_COMMON_DIALOG_SKIP",r);const e=o.control.getParent().getTableDefinition().headerInfoTypeName;if(e){m=`${e} ${s}: ${t}\n\n${n.getTranslatedText("C_COMMON_DIALOG_SKIP_SINGLE_MESSAGE_TEXT",r)}`}else{m=`${s}: ${t}\n\n${n.getTranslatedText("C_COMMON_DIALOG_SKIP_SINGLE_MESSAGE_TEXT",r)}`}}else{E=n.getTranslatedText("C_COMMON_DIALOG_SKIP",r);m=`${t}\n\n${n.getTranslatedText("C_COMMON_DIALOG_SKIP_SINGLE_MESSAGE_TEXT",r)}`}e.warning(m,{title:n.getTranslatedText("WARNING",r),actions:[_,E],emphasizedAction:_,onClose:function(e){if(e===_){if(!f){u(true);M.submitBatch(T);if(o.requestSideEffects){o.requestSideEffects()}}else{O.forEach(function(e){e.resolve(true);M.submitBatch(e.groupId);if(e.requestSideEffects){e.requestSideEffects()}});const e=g===null||g===void 0?void 0:g.strictHandlingTransitionFails;if(e.length>0){d===null||d===void 0?void 0:d.removeTransitionMessages()}}if(g){g.is412Executed=true}}else{if(g){g.is412Executed=false}if(!f){u(false)}else{O.forEach(function(e){e.resolve(false)})}}if(g){g.strictHandlingWarningMessages=[]}}})}else if(c.length>1){if(f){E=n.getTranslatedText("C_COMMON_DIALOG_SKIP",r);const e=new t({message:n.getTranslatedText("C_COMMON_DIALOG_SKIP_MESSAGES_WARNING",r),type:l.Warning,target:undefined,persistent:true,description:n.getTranslatedText("C_COMMON_DIALOG_SKIP_MESSAGES_TEXT",r,[_])});c=[e].concat(c)}const e=new s;e.setData(c);const o=true;const m=a.prepareMessageViewForDialog(e,o,f);const S=new i({messageObject:m,isMultiContext412:f,resolve:u,model:M,groupId:T,actionName:_,strictHandlingUtilities:g,strictHandlingPromises:O,messageHandler:d,messageDialogModel:e,cancelButtonTxt:E});S.open()}}async function d(e,t,s,n,i,a,o,l,r){if(n===null&&a===null||n===1&&a===1){return new Promise(function(n){c.renderMessageView(t,s,o,r,l,false,n,e)})}else{const d=t.label;const g=l===null||l===void 0?void 0:l.strictHandlingWarningMessages;const f=t.control.getParent().getIdentifierColumn();let u="";if(f&&a&&a>1){u=i&&i.getObject(f)}r.forEach(function(e){e.setType("Warning");e.setAdditionalText(u);g.push(e)});if(t.dialog&&t.dialog.isOpen()){t.dialog.close()}const T=l===null||l===void 0?void 0:l.strictHandlingPromises;const _=new Promise(function(s){T.push({groupId:e,resolve:s,actionName:d,model:t.model,value:u,requestSideEffects:t.requestSideEffects})});l.strictHandlingWarningMessages=g;l.strictHandlingPromises=T;if(n===a){c.renderMessageView(t,s,o,l.strictHandlingWarningMessages,l,true)}return _}}const c={renderMessageView:r,fnOnStrictHandlingFailed:d};return c},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/rootView/Fcl-dbg.controller", ["sap/base/Log", "sap/f/FlexibleColumnLayoutSemanticHelper", "sap/f/library", "sap/fe/core/controllerextensions/ViewState", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/KeepAliveHelper", "sap/m/Link", "sap/m/MessageBox", "sap/m/MessagePage", "./RootViewBaseController"], function (Log, FlexibleColumnLayoutSemanticHelper, fLibrary, ViewState, ClassSupport, KeepAliveHelper, Link, MessageBox, MessagePage, BaseController) {
  "use strict";

  var _dec, _dec2, _class, _class2, _descriptor;
  var Icon = MessageBox.Icon;
  var Action = MessageBox.Action;
  var usingExtension = ClassSupport.usingExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  const LayoutType = fLibrary.LayoutType;
  const CONSTANTS = {
    page: {
      names: ["BeginColumn", "MidColumn", "EndColumn"],
      currentGetter: {
        prefix: "getCurrent",
        suffix: "Page"
      },
      getter: {
        prefix: "get",
        suffix: "Pages"
      }
    }
  };
  const _getViewFromContainer = function (oContainer) {
    if (oContainer.isA("sap.ui.core.ComponentContainer")) {
      return oContainer.getComponentInstance().getRootControl();
    } else {
      return oContainer;
    }
  };
  /**
   * Base controller class for your own root view with an sap.f.FlexibleColumnLayout control.
   *
   * By using or extending this controller, you can use your own root view with the sap.fe.core.AppComponent and
   * you can make use of SAP Fiori elements pages and SAP Fiori elements building blocks.
   *
   * @hideconstructor
   * @public
   * @since 1.110.0
   */
  let FclController = (_dec = defineUI5Class("sap.fe.core.rootView.Fcl"), _dec2 = usingExtension(ViewState.override({
    applyInitialStateOnly: function () {
      return false;
    },
    adaptBindingRefreshControls: function (aControls) {
      this.getView().getController()._getAllVisibleViews().forEach(function (oChildView) {
        const pChildView = Promise.resolve(oChildView);
        aControls.push(pChildView);
      });
    },
    adaptStateControls: function (aStateControls) {
      this.getView().getController()._getAllVisibleViews().forEach(function (oChildView) {
        const pChildView = Promise.resolve(oChildView);
        aStateControls.push(pChildView);
      });
    },
    onRestore: function () {
      const fclController = this.getView().getController();
      const appContentContainer = fclController.getAppContentContainer();
      const internalModel = appContentContainer.getModel("internal");
      const pages = internalModel.getProperty("/pages");
      for (const componentId in pages) {
        internalModel.setProperty(`/pages/${componentId}/restoreStatus`, "pending");
      }
      fclController.onContainerReady();
    },
    onSuspend: function () {
      const oFCLController = this.getView().getController();
      const oFCLControl = oFCLController.getFclControl();
      const aBeginColumnPages = oFCLControl.getBeginColumnPages() || [];
      const aMidColumnPages = oFCLControl.getMidColumnPages() || [];
      const aEndColumnPages = oFCLControl.getEndColumnPages() || [];
      const aPages = [].concat(aBeginColumnPages, aMidColumnPages, aEndColumnPages);
      aPages.forEach(function (oPage) {
        const oTargetView = _getViewFromContainer(oPage);
        const oController = oTargetView && oTargetView.getController();
        if (oController && oController.viewState && oController.viewState.onSuspend) {
          oController.viewState.onSuspend();
        }
      });
    }
  })), _dec(_class = (_class2 = /*#__PURE__*/function (_BaseController) {
    _inheritsLoose(FclController, _BaseController);
    function FclController() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _BaseController.call(this, ...args) || this;
      _initializerDefineProperty(_this, "viewState", _descriptor, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = FclController.prototype;
    /**
     * @private
     * @name sap.fe.core.rootView.Fcl.getMetadata
     * @function
     */
    _proto.onInit = function onInit() {
      _BaseController.prototype.onInit.call(this);
      this._internalInit();
    };
    _proto.manageDataReceived = function manageDataReceived(event) {
      if (event.getParameter("error")) {
        var _targetedView$getBind;
        const path = event.getParameter("path"),
          targetedView = this._getAllVisibleViews().find(view => {
            var _view$getBindingConte;
            return ((_view$getBindingConte = view.getBindingContext()) === null || _view$getBindingConte === void 0 ? void 0 : _view$getBindingConte.getPath()) === path;
          });
        // We need to manage error when the request is related to a form  into an ObjectPage
        if (path && targetedView !== null && targetedView !== void 0 && (_targetedView$getBind = targetedView.getBindingContext()) !== null && _targetedView$getBind !== void 0 && _targetedView$getBind.isKeepAlive()) {
          targetedView.getController()._routing.onDataReceived(event);
        }
      }
    };
    _proto.attachRouteMatchers = function attachRouteMatchers() {
      this.getRouter().attachBeforeRouteMatched(this._getViewForNavigatedRowsComputation, this);
      _BaseController.prototype.attachRouteMatchers.call(this);
      this._internalInit();
      this.getRouter().attachBeforeRouteMatched(this.onBeforeRouteMatched, this);
      this.getRouter().attachRouteMatched(this.onRouteMatched, this);
      this.getFclControl().attachStateChange(this._saveLayout, this);
    };
    _proto._internalInit = function _internalInit() {
      var _oRoutingConfig$confi, _oRoutingConfig$confi2;
      if (this._oRouterProxy) {
        return; // Already initialized
      }

      this.sCurrentRouteName = "";
      this.sCurrentArguments = {};
      this.SQUERYKEYNAME = "?query";
      const oAppComponent = this.getAppComponent();
      const oDataModel = this.getAppComponent().getModel();
      oDataModel === null || oDataModel === void 0 ? void 0 : oDataModel.attachEvent("dataReceived", this.manageDataReceived.bind(this));
      this._oRouterProxy = oAppComponent.getRouterProxy();

      // Get FCL configuration in the manifest
      this._oFCLConfig = {
        maxColumnsCount: 3
      };
      const oRoutingConfig = oAppComponent.getManifest()["sap.ui5"].routing;
      if (oRoutingConfig !== null && oRoutingConfig !== void 0 && (_oRoutingConfig$confi = oRoutingConfig.config) !== null && _oRoutingConfig$confi !== void 0 && _oRoutingConfig$confi.flexibleColumnLayout) {
        const oFCLManifestConfig = oRoutingConfig.config.flexibleColumnLayout;

        // Default layout for 2 columns
        if (oFCLManifestConfig.defaultTwoColumnLayoutType) {
          this._oFCLConfig.defaultTwoColumnLayoutType = oFCLManifestConfig.defaultTwoColumnLayoutType;
        }

        // Default layout for 3 columns
        if (oFCLManifestConfig.defaultThreeColumnLayoutType) {
          this._oFCLConfig.defaultThreeColumnLayoutType = oFCLManifestConfig.defaultThreeColumnLayoutType;
        }

        // Limit FCL to 2 columns ?
        if (oFCLManifestConfig.limitFCLToTwoColumns === true) {
          this._oFCLConfig.maxColumnsCount = 2;
        }
      }
      if (oRoutingConfig !== null && oRoutingConfig !== void 0 && (_oRoutingConfig$confi2 = oRoutingConfig.config) !== null && _oRoutingConfig$confi2 !== void 0 && _oRoutingConfig$confi2.controlAggregation) {
        this._oFCLConfig.defaultControlAggregation = oRoutingConfig.config.controlAggregation;
      }
      this._initializeTargetAggregation(oAppComponent);
      this._initializeRoutesInformation(oAppComponent);
      this.getFclControl().attachStateChange(this.onStateChanged, this);
      this.getFclControl().attachAfterEndColumnNavigate(this.onStateChanged, this);
    };
    _proto.getFclControl = function getFclControl() {
      return this.getAppContentContainer();
    };
    _proto._saveLayout = function _saveLayout(oEvent) {
      this.sPreviousLayout = oEvent.getParameters().layout;
    }

    /**
     * Get the additional view (on top of the visible views), to be able to compute the latest table navigated rows of
     * the most right visible view after a nav back or column fullscreen.
     *
     * @function
     * @name sap.fe.core.rootView.Fcl.controller#_getRightMostViewBeforeRouteMatched
     * @memberof sap.fe.core.rootView.Fcl.controller
     */;
    _proto._getViewForNavigatedRowsComputation = function _getViewForNavigatedRowsComputation() {
      const aAllVisibleViewsBeforeRouteMatched = this._getAllVisibleViews(this.sPreviousLayout);
      const oRightMostViewBeforeRouteMatched = aAllVisibleViewsBeforeRouteMatched[aAllVisibleViewsBeforeRouteMatched.length - 1];
      let oRightMostView;
      this.getRouter().attachEventOnce("routeMatched", oEvent => {
        oRightMostView = _getViewFromContainer(oEvent.getParameter("views")[oEvent.getParameter("views").length - 1]);
        if (oRightMostViewBeforeRouteMatched) {
          // Navigation forward from L2 to view level L3 (FullScreenLayout):
          if (oRightMostView.getViewData() && oRightMostView.getViewData().viewLevel === this._oFCLConfig.maxColumnsCount) {
            this.oAdditionalViewForNavRowsComputation = oRightMostView;
          }
          // Navigations backward from L3 down to L2, L1, L0 (ThreeColumn layout):
          if (oRightMostView.getViewData() && oRightMostViewBeforeRouteMatched.getViewData() && oRightMostViewBeforeRouteMatched.getViewData().viewLevel < this._oFCLConfig.maxColumnsCount && oRightMostViewBeforeRouteMatched.getViewData() && oRightMostViewBeforeRouteMatched.getViewData().viewLevel > oRightMostView.getViewData().viewLevel && oRightMostView !== oRightMostViewBeforeRouteMatched) {
            this.oAdditionalViewForNavRowsComputation = oRightMostViewBeforeRouteMatched;
          }
        }
      });
    };
    _proto.getViewForNavigatedRowsComputation = function getViewForNavigatedRowsComputation() {
      return this.oAdditionalViewForNavRowsComputation;
    };
    _proto.onExit = function onExit() {
      this.getRouter().detachRouteMatched(this.onRouteMatched, this);
      this.getRouter().detachBeforeRouteMatched(this.onBeforeRouteMatched, this);
      this.getFclControl().detachStateChange(this.onStateChanged, this);
      this.getFclControl().detachAfterEndColumnNavigate(this.onStateChanged, this);
      this._oTargetsAggregation = null;
      this._oTargetsFromRoutePattern = null;
      BaseController.prototype.onExit.bind(this)();
    }

    /**
     * Check if the FCL component is enabled.
     *
     * @function
     * @name sap.fe.core.rootView.Fcl.controller#isFclEnabled
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @returns `true` since we are in FCL scenario
     * @ui5-restricted
     * @final
     */;
    _proto.isFclEnabled = function isFclEnabled() {
      return true;
    }

    /**
     * Method that creates a new Page to display the IllustratedMessage containing the current error.
     *
     * @param sErrorMessage
     * @param mParameters
     * @alias sap.fe.core.rootView.Fcl.controller#displayErrorPage
     * @returns A promise that creates a Page to display the error
     * @public
     */;
    _proto.displayErrorPage = function displayErrorPage(sErrorMessage, mParameters) {
      const oFCLControl = this.getFclControl();
      if (this._oFCLConfig && mParameters.FCLLevel >= this._oFCLConfig.maxColumnsCount) {
        mParameters.FCLLevel = this._oFCLConfig.maxColumnsCount - 1;
      }
      if (!this.aMessagePages) {
        this.aMessagePages = [null, null, null];
      }
      let oMessagePage = this.aMessagePages[mParameters.FCLLevel];
      if (!oMessagePage) {
        oMessagePage = new MessagePage({
          showHeader: false,
          icon: "sap-icon://message-error"
        });
        this.aMessagePages[mParameters.FCLLevel] = oMessagePage;
        switch (mParameters.FCLLevel) {
          case 0:
            oFCLControl.addBeginColumnPage(oMessagePage);
            break;
          case 1:
            oFCLControl.addMidColumnPage(oMessagePage);
            break;
          default:
            oFCLControl.addEndColumnPage(oMessagePage);
        }
      }
      oMessagePage.setText(sErrorMessage);
      if (mParameters.technicalMessage) {
        oMessagePage.setCustomDescription(new Link({
          text: mParameters.description || mParameters.technicalMessage,
          press: function () {
            MessageBox.show(mParameters.technicalMessage, {
              icon: Icon.ERROR,
              title: mParameters.title,
              actions: [Action.OK],
              defaultAction: Action.OK,
              details: mParameters.technicalDetails || "",
              contentWidth: "60%"
            });
          }
        }));
      } else {
        oMessagePage.setDescription(mParameters.description || "");
      }
      oFCLControl.to(oMessagePage.getId());
      return Promise.resolve(true);
    }

    /**
     * Initialize the object _oTargetsAggregation that defines for each route the relevant aggregation and pattern.
     *
     * @name sap.fe.core.rootView.Fcl.controller#_initializeTargetAggregation
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @function
     * @param [oAppComponent] Reference to the AppComponent
     */;
    _proto._initializeTargetAggregation = function _initializeTargetAggregation(oAppComponent) {
      const oManifest = oAppComponent.getManifest(),
        oTargets = oManifest["sap.ui5"].routing ? oManifest["sap.ui5"].routing.targets : null;
      this._oTargetsAggregation = {};
      if (oTargets) {
        Object.keys(oTargets).forEach(sTargetName => {
          const oTarget = oTargets[sTargetName];
          if (oTarget.controlAggregation) {
            this._oTargetsAggregation[sTargetName] = {
              aggregation: oTarget.controlAggregation,
              pattern: oTarget.contextPattern
            };
          } else {
            this._oTargetsAggregation[sTargetName] = {
              aggregation: "page",
              pattern: null
            };
          }
        });
      }
    }

    /**
     * Initializes the mapping between a route (identifed as its pattern) and the corresponding targets
     *
     * @name sap.fe.core.rootView.Fcl.controller#_initializeRoutesInformation
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @function
     * @param oAppComponent ref to the AppComponent
     */;
    _proto._initializeRoutesInformation = function _initializeRoutesInformation(oAppComponent) {
      const oManifest = oAppComponent.getManifest(),
        aRoutes = oManifest["sap.ui5"].routing ? oManifest["sap.ui5"].routing.routes : null;
      this._oTargetsFromRoutePattern = {};
      if (aRoutes) {
        aRoutes.forEach(route => {
          this._oTargetsFromRoutePattern[route.pattern] = route.target;
        });
      }
    };
    _proto.getCurrentArgument = function getCurrentArgument() {
      return this.sCurrentArguments;
    };
    _proto.getCurrentRouteName = function getCurrentRouteName() {
      return this.sCurrentRouteName;
    }

    /**
     * Get FE FCL constant.
     *
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @returns The constants
     */;
    _proto.getConstants = function getConstants() {
      return CONSTANTS;
    }

    /**
     * Getter for oTargetsAggregation array.
     *
     * @name sap.fe.core.rootView.Fcl.controller#getTargetAggregation
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @function
     * @returns The _oTargetsAggregation array
     * @ui5-restricted
     */;
    _proto.getTargetAggregation = function getTargetAggregation() {
      return this._oTargetsAggregation;
    }

    /**
     * Function triggered by the router RouteMatched event.
     *
     * @name sap.fe.core.rootView.Fcl.controller#onRouteMatched
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @param oEvent
     */;
    _proto.onRouteMatched = function onRouteMatched(oEvent) {
      const sRouteName = oEvent.getParameter("name");

      // Save the current/previous routes and arguments
      this.sCurrentRouteName = sRouteName;
      this.sCurrentArguments = oEvent.getParameter("arguments");
    }

    /**
     * This function is triggering the table scroll to the navigated row after each layout change.
     *
     * @name sap.fe.core.rootView.Fcl.controller#scrollToLastSelectedItem
     * @memberof sap.fe.core.rootView.Fcl.controller
     */;
    _proto._scrollTablesToLastNavigatedItems = function _scrollTablesToLastNavigatedItems() {
      const aViews = this._getAllVisibleViews();
      //The scrolls are triggered only if the layout is with several columns or when switching the mostRight column in full screen
      if (aViews.length > 1 || aViews[0].getViewData().viewLevel < this._oFCLConfig.maxColumnsCount) {
        let sCurrentViewPath;
        const oAdditionalView = this.getViewForNavigatedRowsComputation();
        if (oAdditionalView && aViews.indexOf(oAdditionalView) === -1) {
          aViews.push(oAdditionalView);
        }
        for (let index = aViews.length - 1; index > 0; index--) {
          const oView = aViews[index],
            oPreviousView = aViews[index - 1];
          if (oView.getBindingContext()) {
            sCurrentViewPath = oView.getBindingContext().getPath();
            oPreviousView.getController()._scrollTablesToRow(sCurrentViewPath);
          }
        }
      }
    }

    /**
     * Function triggered by the FCL StateChanged event.
     *
     * @name sap.fe.core.rootView.Fcl.controller#onStateChanged
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @param oEvent
     */;
    _proto.onStateChanged = function onStateChanged(oEvent) {
      const bIsNavigationArrow = oEvent.getParameter("isNavigationArrow");
      if (this.sCurrentArguments !== undefined) {
        if (!this.sCurrentArguments[this.SQUERYKEYNAME]) {
          this.sCurrentArguments[this.SQUERYKEYNAME] = {};
        }
        this.sCurrentArguments[this.SQUERYKEYNAME].layout = oEvent.getParameter("layout");
      }
      this._forceModelContextChangeOnBreadCrumbs(oEvent);

      // Replace the URL with the new layout if a navigation arrow was used
      if (bIsNavigationArrow) {
        this._oRouterProxy.navTo(this.sCurrentRouteName, this.sCurrentArguments);
      }
      const oView = this.getRightmostView();
      if (oView) {
        this._computeTitleHierarchy(oView);
      }
    }

    /**
     * Function to fire ModelContextChange event on all breadcrumbs ( on each ObjectPages).
     *
     * @name sap.fe.core.rootView.Fcl.controller#_forceModelContextChangeOnBreadCrumbs
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @param oEvent
     */;
    _proto._forceModelContextChangeOnBreadCrumbs = function _forceModelContextChangeOnBreadCrumbs(oEvent) {
      //force modelcontextchange on ObjectPages to refresh the breadcrumbs link hrefs
      const oFcl = oEvent.getSource();
      let oPages = [];
      oPages = oPages.concat(oFcl.getBeginColumnPages()).concat(oFcl.getMidColumnPages()).concat(oFcl.getEndColumnPages());
      oPages.forEach(function (oPage) {
        const oView = _getViewFromContainer(oPage);
        const oBreadCrumbs = oView.byId && oView.byId("breadcrumbs");
        if (oBreadCrumbs) {
          oBreadCrumbs.fireModelContextChange();
        }
      });
    }

    /**
     * Function triggered to update the Share button Visibility.
     *
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @param viewColumn Name of the current column ("beginColumn", "midColumn", "endColumn")
     * @param sLayout The current layout used by the FCL
     * @returns The share button visibility
     */;
    _proto._updateShareButtonVisibility = function _updateShareButtonVisibility(viewColumn, sLayout) {
      let bShowShareIcon;
      switch (sLayout) {
        case "OneColumn":
          bShowShareIcon = viewColumn === "beginColumn";
          break;
        case "MidColumnFullScreen":
        case "ThreeColumnsBeginExpandedEndHidden":
        case "ThreeColumnsMidExpandedEndHidden":
        case "TwoColumnsBeginExpanded":
        case "TwoColumnsMidExpanded":
          bShowShareIcon = viewColumn === "midColumn";
          break;
        case "EndColumnFullScreen":
        case "ThreeColumnsEndExpanded":
        case "ThreeColumnsMidExpanded":
          bShowShareIcon = viewColumn === "endColumn";
          break;
        default:
          bShowShareIcon = false;
      }
      return bShowShareIcon;
    };
    _proto._updateEditButtonVisiblity = function _updateEditButtonVisiblity(viewColumn, sLayout) {
      let bEditButtonVisible = true;
      switch (viewColumn) {
        case "midColumn":
          switch (sLayout) {
            case "TwoColumnsMidExpanded":
            case "ThreeColumnsMidExpanded":
            case "ThreeColumnsEndExpanded":
              bEditButtonVisible = false;
              break;
          }
          break;
        case "endColumn":
          switch (sLayout) {
            case "ThreeColumnsMidExpanded":
            case "ThreeColumnsEndExpanded":
              bEditButtonVisible = false;
          }
          break;
      }
      return bEditButtonVisible;
    };
    _proto.updateUIStateForView = function updateUIStateForView(oView, FCLLevel) {
      const oUIState = this.getHelper().getCurrentUIState(),
        oFclColName = ["beginColumn", "midColumn", "endColumn"],
        sLayout = this.getFclControl().getLayout();
      let viewColumn;
      if (!oView.getModel("fclhelper")) {
        oView.setModel(this._createHelperModel(), "fclhelper");
      }
      if (FCLLevel >= this._oFCLConfig.maxColumnsCount) {
        // The view is on a level > max number of columns. It's always fullscreen without close/exit buttons
        viewColumn = oFclColName[this._oFCLConfig.maxColumnsCount - 1];
        oUIState.actionButtonsInfo.midColumn.fullScreen = null;
        oUIState.actionButtonsInfo.midColumn.exitFullScreen = null;
        oUIState.actionButtonsInfo.midColumn.closeColumn = null;
        oUIState.actionButtonsInfo.endColumn.exitFullScreen = null;
        oUIState.actionButtonsInfo.endColumn.fullScreen = null;
        oUIState.actionButtonsInfo.endColumn.closeColumn = null;
      } else {
        viewColumn = oFclColName[FCLLevel];
      }
      if (FCLLevel >= this._oFCLConfig.maxColumnsCount || sLayout === "EndColumnFullScreen" || sLayout === "MidColumnFullScreen" || sLayout === "OneColumn") {
        oView.getModel("fclhelper").setProperty("/breadCrumbIsVisible", true);
      } else {
        oView.getModel("fclhelper").setProperty("/breadCrumbIsVisible", false);
      }
      // Unfortunately, the FCLHelper doesn't provide actionButton values for the first column
      // so we have to add this info manually
      oUIState.actionButtonsInfo.beginColumn = {
        fullScreen: null,
        exitFullScreen: null,
        closeColumn: null
      };
      const oActionButtonInfos = Object.assign({}, oUIState.actionButtonsInfo[viewColumn]);
      oActionButtonInfos.switchVisible = oActionButtonInfos.fullScreen !== null || oActionButtonInfos.exitFullScreen !== null;
      oActionButtonInfos.switchIcon = oActionButtonInfos.fullScreen !== null ? "sap-icon://full-screen" : "sap-icon://exit-full-screen";
      oActionButtonInfos.isFullScreen = oActionButtonInfos.fullScreen === null;
      oActionButtonInfos.closeVisible = oActionButtonInfos.closeColumn !== null;
      oView.getModel("fclhelper").setProperty("/actionButtonsInfo", oActionButtonInfos);
      oView.getModel("fclhelper").setProperty("/showEditButton", this._updateEditButtonVisiblity(viewColumn, sLayout));
      oView.getModel("fclhelper").setProperty("/showShareIcon", this._updateShareButtonVisibility(viewColumn, sLayout));
    }

    /**
     * Function triggered by the router BeforeRouteMatched event.
     *
     * @name sap.fe.core.rootView.Fcl.controller#onBeforeRouteMatched
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @param oEvent
     */;
    _proto.onBeforeRouteMatched = function onBeforeRouteMatched(oEvent) {
      if (oEvent) {
        const oQueryParams = oEvent.getParameters().arguments[this.SQUERYKEYNAME];
        let sLayout = oQueryParams ? oQueryParams.layout : null;

        // If there is no layout parameter, query for the default level 0 layout (normally OneColumn)
        if (!sLayout) {
          const oNextUIState = this.getHelper().getNextUIState(0);
          sLayout = oNextUIState.layout;
        }

        // Check if the layout if compatible with the number of targets
        // This should always be the case for normal navigation, just needed in case
        // the URL has been manually modified
        const aTargets = oEvent.getParameter("config").target;
        sLayout = this._correctLayoutForTargets(sLayout, aTargets);

        // Update the layout of the FlexibleColumnLayout
        if (sLayout) {
          this.getFclControl().setLayout(sLayout);
        }
      }
    }

    /**
     * Helper for the FCL Component.
     *
     * @name sap.fe.core.rootView.Fcl.controller#getHelper
     * @memberof sap.fe.core.rootView.Fcl.controller
     * @returns Instance of a semantic helper
     */;
    _proto.getHelper = function getHelper() {
      return FlexibleColumnLayoutSemanticHelper.getInstanceFor(this.getFclControl(), this._oFCLConfig);
    }

    /**
     * Calculates the FCL layout for a given FCL level and a target hash.
     *
     * @param iNextFCLLevel FCL level to be navigated to
     * @param sHash The hash to be navigated to
     * @param sProposedLayout The proposed layout
     * @param keepCurrentLayout True if we want to keep the current layout if possible
     * @returns The calculated layout
     */;
    _proto.calculateLayout = function calculateLayout(iNextFCLLevel, sHash, sProposedLayout) {
      let keepCurrentLayout = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      // First, ask the FCL helper to calculate the layout if nothing is proposed
      if (!sProposedLayout) {
        sProposedLayout = keepCurrentLayout ? this.getFclControl().getLayout() : this.getHelper().getNextUIState(iNextFCLLevel).layout;
      }

      // Then change this value if necessary, based on the number of targets
      const oRoute = this.getRouter().getRouteByHash(`${sHash}?layout=${sProposedLayout}`);
      const aTargets = this._oTargetsFromRoutePattern[oRoute.getPattern()];
      return this._correctLayoutForTargets(sProposedLayout, aTargets);
    }

    /**
     * Checks whether a given FCL layout is compatible with an array of targets.
     *
     * @param sProposedLayout Proposed value for the FCL layout
     * @param aTargets Array of target names used for checking
     * @returns The corrected layout
     */;
    _proto._correctLayoutForTargets = function _correctLayoutForTargets(sProposedLayout, aTargets) {
      const allAllowedLayouts = {
        "2": ["TwoColumnsMidExpanded", "TwoColumnsBeginExpanded", "MidColumnFullScreen"],
        "3": ["ThreeColumnsMidExpanded", "ThreeColumnsEndExpanded", "ThreeColumnsMidExpandedEndHidden", "ThreeColumnsBeginExpandedEndHidden", "MidColumnFullScreen", "EndColumnFullScreen"]
      };
      if (aTargets && !Array.isArray(aTargets)) {
        // To support single target as a string in the manifest
        aTargets = [aTargets];
      }
      if (!aTargets) {
        // Defensive, just in case...
        return sProposedLayout;
      } else if (aTargets.length > 1) {
        // More than 1 target: just simply check from the allowed values
        const aLayouts = allAllowedLayouts[aTargets.length];
        if (aLayouts.indexOf(sProposedLayout) < 0) {
          // The proposed layout isn't compatible with the number of columns
          // --> Ask the helper for the default layout for the number of columns
          sProposedLayout = aLayouts[0];
        }
      } else {
        // Only one target
        const sTargetAggregation = this.getTargetAggregation()[aTargets[0]].aggregation || this._oFCLConfig.defaultControlAggregation;
        switch (sTargetAggregation) {
          case "beginColumnPages":
            sProposedLayout = "OneColumn";
            break;
          case "midColumnPages":
            sProposedLayout = "MidColumnFullScreen";
            break;
          case "endColumnPages":
            sProposedLayout = "EndColumnFullScreen";
            break;
          // no default
        }
      }

      return sProposedLayout;
    }

    /**
     * Gets the instanced views in the FCL component.
     *
     * @returns {Array} Return the views.
     */;
    _proto.getInstancedViews = function getInstancedViews() {
      const fclControl = this.getFclControl();
      const componentContainers = [...fclControl.getBeginColumnPages(), ...fclControl.getMidColumnPages(), ...fclControl.getEndColumnPages()];
      return componentContainers.map(oPage => oPage.getComponentInstance().getRootControl());
    }

    /**
     * get all visible views in the FCL component.
     * sLayout optional parameter is very specific as part of the calculation of the latest navigated row
     *
     * @param {*} sLayout Layout that was applied just before the current navigation
     * @returns {Array} return views
     */;
    _proto._getAllVisibleViews = function _getAllVisibleViews(sLayout) {
      const aViews = [];
      sLayout = sLayout ? sLayout : this.getFclControl().getLayout();
      switch (sLayout) {
        case LayoutType.EndColumnFullScreen:
          if (this.getFclControl().getCurrentEndColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentEndColumnPage()));
          }
          break;
        case LayoutType.MidColumnFullScreen:
          if (this.getFclControl().getCurrentMidColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentMidColumnPage()));
          }
          break;
        case LayoutType.OneColumn:
          if (this.getFclControl().getCurrentBeginColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentBeginColumnPage()));
          }
          break;
        case LayoutType.ThreeColumnsEndExpanded:
        case LayoutType.ThreeColumnsMidExpanded:
          if (this.getFclControl().getCurrentBeginColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentBeginColumnPage()));
          }
          if (this.getFclControl().getCurrentMidColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentMidColumnPage()));
          }
          if (this.getFclControl().getCurrentEndColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentEndColumnPage()));
          }
          break;
        case LayoutType.TwoColumnsBeginExpanded:
        case LayoutType.TwoColumnsMidExpanded:
        case LayoutType.ThreeColumnsMidExpandedEndHidden:
        case LayoutType.ThreeColumnsBeginExpandedEndHidden:
          if (this.getFclControl().getCurrentBeginColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentBeginColumnPage()));
          }
          if (this.getFclControl().getCurrentMidColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentMidColumnPage()));
          }
          break;
        default:
          Log.error(`Unhandled switch case for ${this.getFclControl().getLayout()}`);
      }
      return aViews;
    };
    _proto._getAllViews = function _getAllViews(sLayout) {
      const aViews = [];
      sLayout = sLayout ? sLayout : this.getFclControl().getLayout();
      switch (sLayout) {
        case LayoutType.OneColumn:
          if (this.getFclControl().getCurrentBeginColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentBeginColumnPage()));
          }
          break;
        case LayoutType.ThreeColumnsEndExpanded:
        case LayoutType.ThreeColumnsMidExpanded:
        case LayoutType.ThreeColumnsMidExpandedEndHidden:
        case LayoutType.ThreeColumnsBeginExpandedEndHidden:
        case LayoutType.EndColumnFullScreen:
          if (this.getFclControl().getCurrentBeginColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentBeginColumnPage()));
          }
          if (this.getFclControl().getCurrentMidColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentMidColumnPage()));
          }
          if (this.getFclControl().getCurrentEndColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentEndColumnPage()));
          }
          break;
        case LayoutType.TwoColumnsBeginExpanded:
        case LayoutType.TwoColumnsMidExpanded:
          if (this.getFclControl().getCurrentBeginColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentBeginColumnPage()));
          }
          if (this.getFclControl().getCurrentMidColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentMidColumnPage()));
          }
          break;
        case LayoutType.MidColumnFullScreen:
          // In this case we need to determine if this mid column fullscreen comes from a 2 or a 3 column layout
          const sLayoutWhenExitFullScreen = this.getHelper().getCurrentUIState().actionButtonsInfo.midColumn.exitFullScreen;
          if (this.getFclControl().getCurrentBeginColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentBeginColumnPage()));
          }
          if (this.getFclControl().getCurrentMidColumnPage()) {
            aViews.push(_getViewFromContainer(this.getFclControl().getCurrentMidColumnPage()));
          }
          if (sLayoutWhenExitFullScreen.indexOf("ThreeColumn") >= 0) {
            // We come from a 3 column layout
            if (this.getFclControl().getCurrentEndColumnPage()) {
              aViews.push(_getViewFromContainer(this.getFclControl().getCurrentEndColumnPage()));
            }
          }
          break;
        default:
          Log.error(`Unhandled switch case for ${this.getFclControl().getLayout()}`);
      }
      return aViews;
    };
    _proto.onContainerReady = function onContainerReady() {
      // Restore views if neccessary.
      const aViews = this._getAllVisibleViews();
      const aRestorePromises = aViews.reduce(function (aPromises, oTargetView) {
        aPromises.push(KeepAliveHelper.restoreView(oTargetView));
        return aPromises;
      }, []);
      return Promise.all(aRestorePromises);
    };
    _proto.getRightmostContext = function getRightmostContext() {
      const oView = this.getRightmostView();
      return oView && oView.getBindingContext();
    };
    _proto.getRightmostView = function getRightmostView() {
      return this._getAllViews().pop();
    };
    _proto.isContextUsedInPages = function isContextUsedInPages(oContext) {
      if (!this.getFclControl()) {
        return false;
      }
      const aAllVisibleViews = this._getAllViews();
      for (const view of aAllVisibleViews) {
        if (view) {
          if (view.getBindingContext() === oContext) {
            return true;
          }
        } else {
          // A view has been destroyed --> app is currently being destroyed
          return false;
        }
      }
      return false;
    };
    _proto._setShellMenuTitle = function _setShellMenuTitle(oAppComponent, sTitle, sAppTitle) {
      if (this.getHelper().getCurrentUIState().isFullScreen !== true) {
        oAppComponent.getShellServices().setTitle(sAppTitle);
      } else {
        oAppComponent.getShellServices().setTitle(sTitle);
      }
    };
    return FclController;
  }(BaseController), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "viewState", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return FclController;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/rootView/Fcl.controller", ["sap/base/Log","sap/f/FlexibleColumnLayoutSemanticHelper","sap/f/library","sap/fe/core/controllerextensions/ViewState","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/KeepAliveHelper","sap/m/Link","sap/m/MessageBox","sap/m/MessagePage","./RootViewBaseController"],function(e,t,n,o,i,r,l,s,a,u){"use strict";var g,c,C,h,d;var f=s.Icon;var m=s.Action;var p=i.usingExtension;var F=i.defineUI5Class;function w(e,t,n,o){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0})}function E(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function P(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;b(e,t)}function b(e,t){b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return b(e,t)}function M(e,t,n,o,i){var r={};Object.keys(o).forEach(function(e){r[e]=o[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}function v(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}const y=n.LayoutType;const x={page:{names:["BeginColumn","MidColumn","EndColumn"],currentGetter:{prefix:"getCurrent",suffix:"Page"},getter:{prefix:"get",suffix:"Pages"}}};const T=function(e){if(e.isA("sap.ui.core.ComponentContainer")){return e.getComponentInstance().getRootControl()}else{return e}};let R=(g=F("sap.fe.core.rootView.Fcl"),c=p(o.override({applyInitialStateOnly:function(){return false},adaptBindingRefreshControls:function(e){this.getView().getController()._getAllVisibleViews().forEach(function(t){const n=Promise.resolve(t);e.push(n)})},adaptStateControls:function(e){this.getView().getController()._getAllVisibleViews().forEach(function(t){const n=Promise.resolve(t);e.push(n)})},onRestore:function(){const e=this.getView().getController();const t=e.getAppContentContainer();const n=t.getModel("internal");const o=n.getProperty("/pages");for(const e in o){n.setProperty(`/pages/${e}/restoreStatus`,"pending")}e.onContainerReady()},onSuspend:function(){const e=this.getView().getController();const t=e.getFclControl();const n=t.getBeginColumnPages()||[];const o=t.getMidColumnPages()||[];const i=t.getEndColumnPages()||[];const r=[].concat(n,o,i);r.forEach(function(e){const t=T(e);const n=t&&t.getController();if(n&&n.viewState&&n.viewState.onSuspend){n.viewState.onSuspend()}})}})),g(C=(h=function(n){P(o,n);function o(){var e;for(var t=arguments.length,o=new Array(t),i=0;i<t;i++){o[i]=arguments[i]}e=n.call(this,...o)||this;w(e,"viewState",d,E(e));return e}var i=o.prototype;i.onInit=function e(){n.prototype.onInit.call(this);this._internalInit()};i.manageDataReceived=function e(t){if(t.getParameter("error")){var n;const e=t.getParameter("path"),o=this._getAllVisibleViews().find(t=>{var n;return((n=t.getBindingContext())===null||n===void 0?void 0:n.getPath())===e});if(e&&o!==null&&o!==void 0&&(n=o.getBindingContext())!==null&&n!==void 0&&n.isKeepAlive()){o.getController()._routing.onDataReceived(t)}}};i.attachRouteMatchers=function e(){this.getRouter().attachBeforeRouteMatched(this._getViewForNavigatedRowsComputation,this);n.prototype.attachRouteMatchers.call(this);this._internalInit();this.getRouter().attachBeforeRouteMatched(this.onBeforeRouteMatched,this);this.getRouter().attachRouteMatched(this.onRouteMatched,this);this.getFclControl().attachStateChange(this._saveLayout,this)};i._internalInit=function e(){var t,n;if(this._oRouterProxy){return}this.sCurrentRouteName="";this.sCurrentArguments={};this.SQUERYKEYNAME="?query";const o=this.getAppComponent();const i=this.getAppComponent().getModel();i===null||i===void 0?void 0:i.attachEvent("dataReceived",this.manageDataReceived.bind(this));this._oRouterProxy=o.getRouterProxy();this._oFCLConfig={maxColumnsCount:3};const r=o.getManifest()["sap.ui5"].routing;if(r!==null&&r!==void 0&&(t=r.config)!==null&&t!==void 0&&t.flexibleColumnLayout){const e=r.config.flexibleColumnLayout;if(e.defaultTwoColumnLayoutType){this._oFCLConfig.defaultTwoColumnLayoutType=e.defaultTwoColumnLayoutType}if(e.defaultThreeColumnLayoutType){this._oFCLConfig.defaultThreeColumnLayoutType=e.defaultThreeColumnLayoutType}if(e.limitFCLToTwoColumns===true){this._oFCLConfig.maxColumnsCount=2}}if(r!==null&&r!==void 0&&(n=r.config)!==null&&n!==void 0&&n.controlAggregation){this._oFCLConfig.defaultControlAggregation=r.config.controlAggregation}this._initializeTargetAggregation(o);this._initializeRoutesInformation(o);this.getFclControl().attachStateChange(this.onStateChanged,this);this.getFclControl().attachAfterEndColumnNavigate(this.onStateChanged,this)};i.getFclControl=function e(){return this.getAppContentContainer()};i._saveLayout=function e(t){this.sPreviousLayout=t.getParameters().layout};i._getViewForNavigatedRowsComputation=function e(){const t=this._getAllVisibleViews(this.sPreviousLayout);const n=t[t.length-1];let o;this.getRouter().attachEventOnce("routeMatched",e=>{o=T(e.getParameter("views")[e.getParameter("views").length-1]);if(n){if(o.getViewData()&&o.getViewData().viewLevel===this._oFCLConfig.maxColumnsCount){this.oAdditionalViewForNavRowsComputation=o}if(o.getViewData()&&n.getViewData()&&n.getViewData().viewLevel<this._oFCLConfig.maxColumnsCount&&n.getViewData()&&n.getViewData().viewLevel>o.getViewData().viewLevel&&o!==n){this.oAdditionalViewForNavRowsComputation=n}}})};i.getViewForNavigatedRowsComputation=function e(){return this.oAdditionalViewForNavRowsComputation};i.onExit=function e(){this.getRouter().detachRouteMatched(this.onRouteMatched,this);this.getRouter().detachBeforeRouteMatched(this.onBeforeRouteMatched,this);this.getFclControl().detachStateChange(this.onStateChanged,this);this.getFclControl().detachAfterEndColumnNavigate(this.onStateChanged,this);this._oTargetsAggregation=null;this._oTargetsFromRoutePattern=null;u.prototype.onExit.bind(this)()};i.isFclEnabled=function e(){return true};i.displayErrorPage=function e(t,n){const o=this.getFclControl();if(this._oFCLConfig&&n.FCLLevel>=this._oFCLConfig.maxColumnsCount){n.FCLLevel=this._oFCLConfig.maxColumnsCount-1}if(!this.aMessagePages){this.aMessagePages=[null,null,null]}let i=this.aMessagePages[n.FCLLevel];if(!i){i=new a({showHeader:false,icon:"sap-icon://message-error"});this.aMessagePages[n.FCLLevel]=i;switch(n.FCLLevel){case 0:o.addBeginColumnPage(i);break;case 1:o.addMidColumnPage(i);break;default:o.addEndColumnPage(i)}}i.setText(t);if(n.technicalMessage){i.setCustomDescription(new l({text:n.description||n.technicalMessage,press:function(){s.show(n.technicalMessage,{icon:f.ERROR,title:n.title,actions:[m.OK],defaultAction:m.OK,details:n.technicalDetails||"",contentWidth:"60%"})}}))}else{i.setDescription(n.description||"")}o.to(i.getId());return Promise.resolve(true)};i._initializeTargetAggregation=function e(t){const n=t.getManifest(),o=n["sap.ui5"].routing?n["sap.ui5"].routing.targets:null;this._oTargetsAggregation={};if(o){Object.keys(o).forEach(e=>{const t=o[e];if(t.controlAggregation){this._oTargetsAggregation[e]={aggregation:t.controlAggregation,pattern:t.contextPattern}}else{this._oTargetsAggregation[e]={aggregation:"page",pattern:null}}})}};i._initializeRoutesInformation=function e(t){const n=t.getManifest(),o=n["sap.ui5"].routing?n["sap.ui5"].routing.routes:null;this._oTargetsFromRoutePattern={};if(o){o.forEach(e=>{this._oTargetsFromRoutePattern[e.pattern]=e.target})}};i.getCurrentArgument=function e(){return this.sCurrentArguments};i.getCurrentRouteName=function e(){return this.sCurrentRouteName};i.getConstants=function e(){return x};i.getTargetAggregation=function e(){return this._oTargetsAggregation};i.onRouteMatched=function e(t){const n=t.getParameter("name");this.sCurrentRouteName=n;this.sCurrentArguments=t.getParameter("arguments")};i._scrollTablesToLastNavigatedItems=function e(){const t=this._getAllVisibleViews();if(t.length>1||t[0].getViewData().viewLevel<this._oFCLConfig.maxColumnsCount){let e;const n=this.getViewForNavigatedRowsComputation();if(n&&t.indexOf(n)===-1){t.push(n)}for(let n=t.length-1;n>0;n--){const o=t[n],i=t[n-1];if(o.getBindingContext()){e=o.getBindingContext().getPath();i.getController()._scrollTablesToRow(e)}}}};i.onStateChanged=function e(t){const n=t.getParameter("isNavigationArrow");if(this.sCurrentArguments!==undefined){if(!this.sCurrentArguments[this.SQUERYKEYNAME]){this.sCurrentArguments[this.SQUERYKEYNAME]={}}this.sCurrentArguments[this.SQUERYKEYNAME].layout=t.getParameter("layout")}this._forceModelContextChangeOnBreadCrumbs(t);if(n){this._oRouterProxy.navTo(this.sCurrentRouteName,this.sCurrentArguments)}const o=this.getRightmostView();if(o){this._computeTitleHierarchy(o)}};i._forceModelContextChangeOnBreadCrumbs=function e(t){const n=t.getSource();let o=[];o=o.concat(n.getBeginColumnPages()).concat(n.getMidColumnPages()).concat(n.getEndColumnPages());o.forEach(function(e){const t=T(e);const n=t.byId&&t.byId("breadcrumbs");if(n){n.fireModelContextChange()}})};i._updateShareButtonVisibility=function e(t,n){let o;switch(n){case"OneColumn":o=t==="beginColumn";break;case"MidColumnFullScreen":case"ThreeColumnsBeginExpandedEndHidden":case"ThreeColumnsMidExpandedEndHidden":case"TwoColumnsBeginExpanded":case"TwoColumnsMidExpanded":o=t==="midColumn";break;case"EndColumnFullScreen":case"ThreeColumnsEndExpanded":case"ThreeColumnsMidExpanded":o=t==="endColumn";break;default:o=false}return o};i._updateEditButtonVisiblity=function e(t,n){let o=true;switch(t){case"midColumn":switch(n){case"TwoColumnsMidExpanded":case"ThreeColumnsMidExpanded":case"ThreeColumnsEndExpanded":o=false;break}break;case"endColumn":switch(n){case"ThreeColumnsMidExpanded":case"ThreeColumnsEndExpanded":o=false}break}return o};i.updateUIStateForView=function e(t,n){const o=this.getHelper().getCurrentUIState(),i=["beginColumn","midColumn","endColumn"],r=this.getFclControl().getLayout();let l;if(!t.getModel("fclhelper")){t.setModel(this._createHelperModel(),"fclhelper")}if(n>=this._oFCLConfig.maxColumnsCount){l=i[this._oFCLConfig.maxColumnsCount-1];o.actionButtonsInfo.midColumn.fullScreen=null;o.actionButtonsInfo.midColumn.exitFullScreen=null;o.actionButtonsInfo.midColumn.closeColumn=null;o.actionButtonsInfo.endColumn.exitFullScreen=null;o.actionButtonsInfo.endColumn.fullScreen=null;o.actionButtonsInfo.endColumn.closeColumn=null}else{l=i[n]}if(n>=this._oFCLConfig.maxColumnsCount||r==="EndColumnFullScreen"||r==="MidColumnFullScreen"||r==="OneColumn"){t.getModel("fclhelper").setProperty("/breadCrumbIsVisible",true)}else{t.getModel("fclhelper").setProperty("/breadCrumbIsVisible",false)}o.actionButtonsInfo.beginColumn={fullScreen:null,exitFullScreen:null,closeColumn:null};const s=Object.assign({},o.actionButtonsInfo[l]);s.switchVisible=s.fullScreen!==null||s.exitFullScreen!==null;s.switchIcon=s.fullScreen!==null?"sap-icon://full-screen":"sap-icon://exit-full-screen";s.isFullScreen=s.fullScreen===null;s.closeVisible=s.closeColumn!==null;t.getModel("fclhelper").setProperty("/actionButtonsInfo",s);t.getModel("fclhelper").setProperty("/showEditButton",this._updateEditButtonVisiblity(l,r));t.getModel("fclhelper").setProperty("/showShareIcon",this._updateShareButtonVisibility(l,r))};i.onBeforeRouteMatched=function e(t){if(t){const e=t.getParameters().arguments[this.SQUERYKEYNAME];let n=e?e.layout:null;if(!n){const e=this.getHelper().getNextUIState(0);n=e.layout}const o=t.getParameter("config").target;n=this._correctLayoutForTargets(n,o);if(n){this.getFclControl().setLayout(n)}}};i.getHelper=function e(){return t.getInstanceFor(this.getFclControl(),this._oFCLConfig)};i.calculateLayout=function e(t,n,o){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(!o){o=i?this.getFclControl().getLayout():this.getHelper().getNextUIState(t).layout}const r=this.getRouter().getRouteByHash(`${n}?layout=${o}`);const l=this._oTargetsFromRoutePattern[r.getPattern()];return this._correctLayoutForTargets(o,l)};i._correctLayoutForTargets=function e(t,n){const o={2:["TwoColumnsMidExpanded","TwoColumnsBeginExpanded","MidColumnFullScreen"],3:["ThreeColumnsMidExpanded","ThreeColumnsEndExpanded","ThreeColumnsMidExpandedEndHidden","ThreeColumnsBeginExpandedEndHidden","MidColumnFullScreen","EndColumnFullScreen"]};if(n&&!Array.isArray(n)){n=[n]}if(!n){return t}else if(n.length>1){const e=o[n.length];if(e.indexOf(t)<0){t=e[0]}}else{const e=this.getTargetAggregation()[n[0]].aggregation||this._oFCLConfig.defaultControlAggregation;switch(e){case"beginColumnPages":t="OneColumn";break;case"midColumnPages":t="MidColumnFullScreen";break;case"endColumnPages":t="EndColumnFullScreen";break}}return t};i.getInstancedViews=function e(){const t=this.getFclControl();const n=[...t.getBeginColumnPages(),...t.getMidColumnPages(),...t.getEndColumnPages()];return n.map(e=>e.getComponentInstance().getRootControl())};i._getAllVisibleViews=function t(n){const o=[];n=n?n:this.getFclControl().getLayout();switch(n){case y.EndColumnFullScreen:if(this.getFclControl().getCurrentEndColumnPage()){o.push(T(this.getFclControl().getCurrentEndColumnPage()))}break;case y.MidColumnFullScreen:if(this.getFclControl().getCurrentMidColumnPage()){o.push(T(this.getFclControl().getCurrentMidColumnPage()))}break;case y.OneColumn:if(this.getFclControl().getCurrentBeginColumnPage()){o.push(T(this.getFclControl().getCurrentBeginColumnPage()))}break;case y.ThreeColumnsEndExpanded:case y.ThreeColumnsMidExpanded:if(this.getFclControl().getCurrentBeginColumnPage()){o.push(T(this.getFclControl().getCurrentBeginColumnPage()))}if(this.getFclControl().getCurrentMidColumnPage()){o.push(T(this.getFclControl().getCurrentMidColumnPage()))}if(this.getFclControl().getCurrentEndColumnPage()){o.push(T(this.getFclControl().getCurrentEndColumnPage()))}break;case y.TwoColumnsBeginExpanded:case y.TwoColumnsMidExpanded:case y.ThreeColumnsMidExpandedEndHidden:case y.ThreeColumnsBeginExpandedEndHidden:if(this.getFclControl().getCurrentBeginColumnPage()){o.push(T(this.getFclControl().getCurrentBeginColumnPage()))}if(this.getFclControl().getCurrentMidColumnPage()){o.push(T(this.getFclControl().getCurrentMidColumnPage()))}break;default:e.error(`Unhandled switch case for ${this.getFclControl().getLayout()}`)}return o};i._getAllViews=function t(n){const o=[];n=n?n:this.getFclControl().getLayout();switch(n){case y.OneColumn:if(this.getFclControl().getCurrentBeginColumnPage()){o.push(T(this.getFclControl().getCurrentBeginColumnPage()))}break;case y.ThreeColumnsEndExpanded:case y.ThreeColumnsMidExpanded:case y.ThreeColumnsMidExpandedEndHidden:case y.ThreeColumnsBeginExpandedEndHidden:case y.EndColumnFullScreen:if(this.getFclControl().getCurrentBeginColumnPage()){o.push(T(this.getFclControl().getCurrentBeginColumnPage()))}if(this.getFclControl().getCurrentMidColumnPage()){o.push(T(this.getFclControl().getCurrentMidColumnPage()))}if(this.getFclControl().getCurrentEndColumnPage()){o.push(T(this.getFclControl().getCurrentEndColumnPage()))}break;case y.TwoColumnsBeginExpanded:case y.TwoColumnsMidExpanded:if(this.getFclControl().getCurrentBeginColumnPage()){o.push(T(this.getFclControl().getCurrentBeginColumnPage()))}if(this.getFclControl().getCurrentMidColumnPage()){o.push(T(this.getFclControl().getCurrentMidColumnPage()))}break;case y.MidColumnFullScreen:const t=this.getHelper().getCurrentUIState().actionButtonsInfo.midColumn.exitFullScreen;if(this.getFclControl().getCurrentBeginColumnPage()){o.push(T(this.getFclControl().getCurrentBeginColumnPage()))}if(this.getFclControl().getCurrentMidColumnPage()){o.push(T(this.getFclControl().getCurrentMidColumnPage()))}if(t.indexOf("ThreeColumn")>=0){if(this.getFclControl().getCurrentEndColumnPage()){o.push(T(this.getFclControl().getCurrentEndColumnPage()))}}break;default:e.error(`Unhandled switch case for ${this.getFclControl().getLayout()}`)}return o};i.onContainerReady=function e(){const t=this._getAllVisibleViews();const n=t.reduce(function(e,t){e.push(r.restoreView(t));return e},[]);return Promise.all(n)};i.getRightmostContext=function e(){const t=this.getRightmostView();return t&&t.getBindingContext()};i.getRightmostView=function e(){return this._getAllViews().pop()};i.isContextUsedInPages=function e(t){if(!this.getFclControl()){return false}const n=this._getAllViews();for(const e of n){if(e){if(e.getBindingContext()===t){return true}}else{return false}}return false};i._setShellMenuTitle=function e(t,n,o){if(this.getHelper().getCurrentUIState().isFullScreen!==true){t.getShellServices().setTitle(o)}else{t.getShellServices().setTitle(n)}};return o}(u),d=M(h.prototype,"viewState",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),h))||C);return R},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/rootView/NavContainer-dbg.controller", ["sap/base/Log", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/ViewState", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/KeepAliveHelper", "sap/m/IllustratedMessage", "sap/m/Page", "./RootViewBaseController"], function (Log, CommonUtils, ViewState, ClassSupport, KeepAliveHelper, IllustratedMessage, Page, BaseController) {
  "use strict";

  var _dec, _dec2, _class, _class2, _descriptor;
  var usingExtension = ClassSupport.usingExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  /**
   * Base controller class for your own root view with a sap.m.NavContainer control.
   *
   * By using or extending this controller you can use your own root view with the sap.fe.core.AppComponent and
   * you can make use of SAP Fiori elements pages and SAP Fiori elements building blocks.
   *
   * @hideconstructor
   * @public
   * @since 1.108.0
   */
  let NavContainerController = (_dec = defineUI5Class("sap.fe.core.rootView.NavContainer"), _dec2 = usingExtension(ViewState.override({
    applyInitialStateOnly: function () {
      return false;
    },
    adaptBindingRefreshControls: function (aControls) {
      const oView = this.getView(),
        oController = oView.getController();
      aControls.push(oController._getCurrentPage(oView));
    },
    adaptStateControls: function (aStateControls) {
      const oView = this.getView(),
        oController = oView.getController();
      aStateControls.push(oController._getCurrentPage(oView));
    },
    onRestore: function () {
      const oView = this.getView(),
        oController = oView.getController(),
        oNavContainer = oController.getAppContentContainer();
      const oInternalModel = oNavContainer.getModel("internal");
      const oPages = oInternalModel.getProperty("/pages");
      for (const sComponentId in oPages) {
        oInternalModel.setProperty(`/pages/${sComponentId}/restoreStatus`, "pending");
      }
      oController.onContainerReady();
    },
    onSuspend: function () {
      const oView = this.getView(),
        oNavController = oView.getController(),
        oNavContainer = oNavController.getAppContentContainer();
      const aPages = oNavContainer.getPages();
      aPages.forEach(function (oPage) {
        const oTargetView = CommonUtils.getTargetView(oPage);
        const oController = oTargetView && oTargetView.getController();
        if (oController && oController.viewState && oController.viewState.onSuspend) {
          oController.viewState.onSuspend();
        }
      });
    }
  })), _dec(_class = (_class2 = /*#__PURE__*/function (_BaseController) {
    _inheritsLoose(NavContainerController, _BaseController);
    function NavContainerController() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _BaseController.call(this, ...args) || this;
      _initializerDefineProperty(_this, "viewState", _descriptor, _assertThisInitialized(_this));
      return _this;
    }
    var _proto = NavContainerController.prototype;
    _proto.onContainerReady = function onContainerReady() {
      // Restore views if neccessary.
      const oView = this.getView(),
        oPagePromise = this._getCurrentPage(oView);
      return oPagePromise.then(function (oCurrentPage) {
        const oTargetView = CommonUtils.getTargetView(oCurrentPage);
        return KeepAliveHelper.restoreView(oTargetView);
      });
    };
    _proto._getCurrentPage = function _getCurrentPage(oView) {
      const oNavContainer = this.getAppContentContainer();
      return new Promise(function (resolve) {
        const oCurrentPage = oNavContainer.getCurrentPage();
        if (oCurrentPage && oCurrentPage.getController && oCurrentPage.getController().isPlaceholder && oCurrentPage.getController().isPlaceholder()) {
          oCurrentPage.getController().attachEventOnce("targetPageInsertedInContainer", function (oEvent) {
            const oTargetPage = oEvent.getParameter("targetpage");
            const oTargetView = CommonUtils.getTargetView(oTargetPage);
            resolve(oTargetView !== oView && oTargetView);
          });
        } else {
          const oTargetView = CommonUtils.getTargetView(oCurrentPage);
          resolve(oTargetView !== oView && oTargetView);
        }
      });
    }

    /**
     * @private
     * @name sap.fe.core.rootView.NavContainer.getMetadata
     * @function
     */;
    _proto._getNavContainer = function _getNavContainer() {
      return this.getView().getContent()[0];
    }

    /**
     * Gets the instanced views in the navContainer component.
     *
     * @returns {Array} Return the views.
     */;
    _proto.getInstancedViews = function getInstancedViews() {
      return this._getNavContainer().getPages().map(oPage => oPage.getComponentInstance().getRootControl());
    }

    /**
     * Check if the FCL component is enabled.
     *
     * @function
     * @name sap.fe.core.rootView.NavContainer.controller#isFclEnabled
     * @memberof sap.fe.core.rootView.NavContainer.controller
     * @returns `false` since we are not in FCL scenario
     * @ui5-restricted
     * @final
     */;
    _proto.isFclEnabled = function isFclEnabled() {
      return false;
    };
    _proto._scrollTablesToLastNavigatedItems = function _scrollTablesToLastNavigatedItems() {
      // Do nothing
    }

    /**
     * Method that creates a new Page to display the IllustratedMessage containing the current error.
     *
     * @param sErrorMessage
     * @param mParameters
     * @alias sap.fe.core.rootView.NavContainer.controller#displayErrorPage
     * @returns A promise that creates a Page to display the error
     * @public
     */;
    _proto.displayErrorPage = function displayErrorPage(sErrorMessage, mParameters) {
      return new Promise((resolve, reject) => {
        try {
          const oNavContainer = this._getNavContainer();
          if (!this.oPage) {
            this.oPage = new Page({
              showHeader: false
            });
            this.oIllustratedMessage = new IllustratedMessage({
              title: sErrorMessage,
              description: mParameters.description || "",
              illustrationType: `sapIllus-${mParameters.errorType}`
            });
            this.oPage.insertContent(this.oIllustratedMessage, 0);
            oNavContainer.addPage(this.oPage);
          }
          if (mParameters.handleShellBack) {
            const oErrorOriginPage = oNavContainer.getCurrentPage(),
              oAppComponent = CommonUtils.getAppComponent(oNavContainer.getCurrentPage());
            oAppComponent.getShellServices().setBackNavigation(function () {
              oNavContainer.to(oErrorOriginPage.getId());
              oAppComponent.getShellServices().setBackNavigation();
            });
          }
          oNavContainer.attachAfterNavigate(function () {
            resolve(true);
          });
          oNavContainer.to(this.oPage.getId());
        } catch (e) {
          reject(false);
          Log.info(e);
        }
      });
    };
    return NavContainerController;
  }(BaseController), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "viewState", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return NavContainerController;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/rootView/NavContainer.controller", ["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/ViewState","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/KeepAliveHelper","sap/m/IllustratedMessage","sap/m/Page","./RootViewBaseController"],function(e,t,n,r,o,i,a,s){"use strict";var l,c,u,g,f;var p=r.usingExtension;var d=r.defineUI5Class;function h(e,t,n,r){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function C(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function v(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;w(e,t)}function w(e,t){w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return w(e,t)}function P(e,t,n,r,o){var i={};Object.keys(r).forEach(function(e){i[e]=r[e]});i.enumerable=!!i.enumerable;i.configurable=!!i.configurable;if("value"in i||i.initializer){i.writable=true}i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i);if(o&&i.initializer!==void 0){i.value=i.initializer?i.initializer.call(o):void 0;i.initializer=undefined}if(i.initializer===void 0){Object.defineProperty(e,t,i);i=null}return i}function b(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let y=(l=d("sap.fe.core.rootView.NavContainer"),c=p(n.override({applyInitialStateOnly:function(){return false},adaptBindingRefreshControls:function(e){const t=this.getView(),n=t.getController();e.push(n._getCurrentPage(t))},adaptStateControls:function(e){const t=this.getView(),n=t.getController();e.push(n._getCurrentPage(t))},onRestore:function(){const e=this.getView(),t=e.getController(),n=t.getAppContentContainer();const r=n.getModel("internal");const o=r.getProperty("/pages");for(const e in o){r.setProperty(`/pages/${e}/restoreStatus`,"pending")}t.onContainerReady()},onSuspend:function(){const e=this.getView(),n=e.getController(),r=n.getAppContentContainer();const o=r.getPages();o.forEach(function(e){const n=t.getTargetView(e);const r=n&&n.getController();if(r&&r.viewState&&r.viewState.onSuspend){r.viewState.onSuspend()}})}})),l(u=(g=function(n){v(r,n);function r(){var e;for(var t=arguments.length,r=new Array(t),o=0;o<t;o++){r[o]=arguments[o]}e=n.call(this,...r)||this;h(e,"viewState",f,C(e));return e}var s=r.prototype;s.onContainerReady=function e(){const n=this.getView(),r=this._getCurrentPage(n);return r.then(function(e){const n=t.getTargetView(e);return o.restoreView(n)})};s._getCurrentPage=function e(n){const r=this.getAppContentContainer();return new Promise(function(e){const o=r.getCurrentPage();if(o&&o.getController&&o.getController().isPlaceholder&&o.getController().isPlaceholder()){o.getController().attachEventOnce("targetPageInsertedInContainer",function(r){const o=r.getParameter("targetpage");const i=t.getTargetView(o);e(i!==n&&i)})}else{const r=t.getTargetView(o);e(r!==n&&r)}})};s._getNavContainer=function e(){return this.getView().getContent()[0]};s.getInstancedViews=function e(){return this._getNavContainer().getPages().map(e=>e.getComponentInstance().getRootControl())};s.isFclEnabled=function e(){return false};s._scrollTablesToLastNavigatedItems=function e(){};s.displayErrorPage=function n(r,o){return new Promise((n,s)=>{try{const e=this._getNavContainer();if(!this.oPage){this.oPage=new a({showHeader:false});this.oIllustratedMessage=new i({title:r,description:o.description||"",illustrationType:`sapIllus-${o.errorType}`});this.oPage.insertContent(this.oIllustratedMessage,0);e.addPage(this.oPage)}if(o.handleShellBack){const n=e.getCurrentPage(),r=t.getAppComponent(e.getCurrentPage());r.getShellServices().setBackNavigation(function(){e.to(n.getId());r.getShellServices().setBackNavigation()})}e.attachAfterNavigate(function(){n(true)});e.to(this.oPage.getId())}catch(t){s(false);e.info(t)}})};return r}(s),f=P(g.prototype,"viewState",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),g))||u);return y},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/rootView/RootViewBaseController-dbg", ["sap/base/Log", "sap/fe/core/BaseController", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/Placeholder", "sap/fe/core/controllerextensions/ViewState", "sap/fe/core/helpers/ClassSupport", "sap/fe/macros/table/TableSizeHelper", "sap/ui/base/BindingParser", "sap/ui/core/routing/HashChanger", "sap/ui/model/json/JSONModel", "sap/ui/model/odata/v4/AnnotationHelper", "sap/ui/thirdparty/URI"], function (Log, BaseController, CommonUtils, Placeholder, ViewState, ClassSupport, TableSizeHelper, BindingParser, HashChanger, JSONModel, AnnotationHelper, URI) {
  "use strict";

  var _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2;
  var usingExtension = ClassSupport.usingExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let RootViewBaseController = (_dec = defineUI5Class("sap.fe.core.rootView.RootViewBaseController"), _dec2 = usingExtension(Placeholder), _dec3 = usingExtension(ViewState), _dec(_class = (_class2 = /*#__PURE__*/function (_BaseController) {
    _inheritsLoose(RootViewBaseController, _BaseController);
    function RootViewBaseController() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _BaseController.call(this, ...args) || this;
      _initializerDefineProperty(_this, "oPlaceholder", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "viewState", _descriptor2, _assertThisInitialized(_this));
      _this.bIsComputingTitleHierachy = false;
      return _this;
    }
    var _proto = RootViewBaseController.prototype;
    _proto.onInit = function onInit() {
      TableSizeHelper.init();
      this._aHelperModels = [];
    };
    _proto.getPlaceholder = function getPlaceholder() {
      return this.oPlaceholder;
    };
    _proto.attachRouteMatchers = function attachRouteMatchers() {
      this.oPlaceholder.attachRouteMatchers();
      this.getAppComponent().getRoutingService().attachAfterRouteMatched(this._onAfterRouteMatched, this);
    };
    _proto.onExit = function onExit() {
      this.getAppComponent().getRoutingService().detachAfterRouteMatched(this._onAfterRouteMatched, this);
      this.oRouter = undefined;
      TableSizeHelper.exit();

      // Destroy all JSON models created dynamically for the views
      this._aHelperModels.forEach(function (oModel) {
        oModel.destroy();
      });
    }
    /**
     * Convenience method for getting the resource bundle.
     *
     * @public
     * @returns The resourceModel of the component
     */;
    _proto.getResourceBundle = function getResourceBundle() {
      return this.getOwnerComponent().getModel("i18n").getResourceBundle();
    };
    _proto.getRouter = function getRouter() {
      if (!this.oRouter) {
        this.oRouter = this.getAppComponent().getRouter();
      }
      return this.oRouter;
    };
    _proto._createHelperModel = function _createHelperModel() {
      // We keep a reference on the models created dynamically, as they don't get destroyed
      // automatically when the view is destroyed.
      // This is done during onExit
      const oModel = new JSONModel();
      this._aHelperModels.push(oModel);
      return oModel;
    }

    /**
     * Function waiting for the Right most view to be ready.
     *
     * @memberof sap.fe.core.rootView.BaseController
     * @param oEvent Reference an Event parameter coming from routeMatched event
     * @returns A promise indicating when the right most view is ready
     */;
    _proto.waitForRightMostViewReady = function waitForRightMostViewReady(oEvent) {
      return new Promise(function (resolve) {
        const aContainers = oEvent.getParameter("views"),
          // There can also be reuse components in the view, remove them before processing.
          aFEContainers = [];
        aContainers.forEach(function (oContainer) {
          let oView = oContainer;
          if (oContainer && oContainer.getComponentInstance) {
            const oComponentInstance = oContainer.getComponentInstance();
            oView = oComponentInstance.getRootControl();
          }
          if (oView && oView.getController() && oView.getController().pageReady) {
            aFEContainers.push(oView);
          }
        });
        const oRightMostFEView = aFEContainers[aFEContainers.length - 1];
        if (oRightMostFEView && oRightMostFEView.getController().pageReady.isPageReady()) {
          resolve(oRightMostFEView);
        } else if (oRightMostFEView) {
          oRightMostFEView.getController().pageReady.attachEventOnce("pageReady", function () {
            resolve(oRightMostFEView);
          });
        }
      });
    }

    /**
     * Callback when the navigation is done.
     *  - update the shell title.
     *  - update table scroll.
     *  - call onPageReady on the rightMostView.
     *
     * @param oEvent
     * @name sap.fe.core.rootView.BaseController#_onAfterRouteMatched
     * @memberof sap.fe.core.rootView.BaseController
     */;
    _proto._onAfterRouteMatched = function _onAfterRouteMatched(oEvent) {
      if (!this._oRouteMatchedPromise) {
        this._oRouteMatchedPromise = this.waitForRightMostViewReady(oEvent).then(oView => {
          // The autoFocus is initially disabled on the navContainer or the FCL, so that the focus stays on the Shell menu
          // even if the app takes a long time to launch
          // The first time the view is displayed, we need to enable the autofocus so that it's managed properly during navigation
          const oRootControl = this.getView().getContent()[0];
          if (oRootControl && oRootControl.getAutoFocus && !oRootControl.getAutoFocus()) {
            oRootControl.setProperty("autoFocus", true, true); // Do not mark the container as invalid, otherwise it's re-rendered
          }

          const oAppComponent = this.getAppComponent();
          this._scrollTablesToLastNavigatedItems();
          if (oAppComponent.getEnvironmentCapabilities().getCapabilities().UShell) {
            this._computeTitleHierarchy(oView);
          }
          const bForceFocus = oAppComponent.getRouterProxy().isFocusForced();
          oAppComponent.getRouterProxy().setFocusForced(false); // reset
          if (oView.getController() && oView.getController().onPageReady && oView.getParent().onPageReady) {
            oView.getParent().onPageReady({
              forceFocus: bForceFocus
            });
          }
          if (this.onContainerReady) {
            this.onContainerReady();
          }
        }).catch(function (oError) {
          Log.error("An error occurs while computing the title hierarchy and calling focus method", oError);
        }).finally(() => {
          this._oRouteMatchedPromise = null;
        });
      }
    }

    /**
     * This function returns the TitleHierarchy cache ( or initializes it if undefined).
     *
     * @name sap.fe.core.rootView.BaseController#_getTitleHierarchyCache
     * @memberof sap.fe.core.rootView.BaseController
     * @returns  The TitleHierarchy cache
     */;
    _proto._getTitleHierarchyCache = function _getTitleHierarchyCache() {
      if (!this.oTitleHierarchyCache) {
        this.oTitleHierarchyCache = {};
      }
      return this.oTitleHierarchyCache;
    }

    /**
     * This function returns a titleInfo object.
     *
     * @memberof sap.fe.core.rootView.BaseController
     * @param title The application's title
     * @param subtitle The application's subTitle
     * @param sIntent The intent path to be redirected to
     * @param icon The application's icon
     * @returns The title information
     */;
    _proto._computeTitleInfo = function _computeTitleInfo(title, subtitle, sIntent) {
      let icon = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : "";
      const aParts = sIntent.split("/");
      sIntent = URI.decode(sIntent);
      if (aParts[aParts.length - 1].indexOf("?") === -1) {
        sIntent += "?restoreHistory=true";
      } else {
        sIntent += "&restoreHistory=true";
      }
      return {
        title: title,
        subtitle: subtitle,
        intent: sIntent,
        icon: icon
      };
    };
    _proto._formatTitle = function _formatTitle(displayMode, titleValue, titleDescription) {
      let formattedTitle = "";
      switch (displayMode) {
        case "Value":
          formattedTitle = `${titleValue}`;
          break;
        case "ValueDescription":
          formattedTitle = `${titleValue} (${titleDescription})`;
          break;
        case "DescriptionValue":
          formattedTitle = `${titleDescription} (${titleValue})`;
          break;
        case "Description":
          formattedTitle = `${titleDescription}`;
          break;
        default:
      }
      return formattedTitle;
    }

    /**
     * Fetches the value of the HeaderInfo title for a given path.
     *
     * @param sPath The path to the entity
     * @returns A promise containing the formatted title, or an empty string if no HeaderInfo title annotation is available
     */;
    _proto._fetchTitleValue = async function _fetchTitleValue(sPath) {
      const oAppComponent = this.getAppComponent(),
        oModel = this.getView().getModel(),
        oMetaModel = oAppComponent.getMetaModel(),
        sMetaPath = oMetaModel.getMetaPath(sPath),
        oBindingViewContext = oModel.createBindingContext(sPath),
        sValueExpression = AnnotationHelper.format(oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value`), {
          context: oMetaModel.createBindingContext("/")
        });
      if (!sValueExpression) {
        return Promise.resolve("");
      }
      const sTextExpression = AnnotationHelper.format(oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value/$Path@com.sap.vocabularies.Common.v1.Text`), {
          context: oMetaModel.createBindingContext("/")
        }),
        oPropertyContext = oMetaModel.getObject(`${sMetaPath}/@com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value/$Path@`),
        aPromises = [],
        oValueExpression = BindingParser.complexParser(sValueExpression),
        oPromiseForDisplayMode = new Promise(function (resolve) {
          const displayMode = CommonUtils.computeDisplayMode(oPropertyContext);
          resolve(displayMode);
        });
      aPromises.push(oPromiseForDisplayMode);
      const sValuePath = oValueExpression.parts ? oValueExpression.parts[0].path : oValueExpression.path,
        fnValueFormatter = oValueExpression.formatter,
        oValueBinding = oModel.bindProperty(sValuePath, oBindingViewContext);
      oValueBinding.initialize();
      const oPromiseForTitleValue = new Promise(function (resolve) {
        const fnChange = function (oEvent) {
          const sTargetValue = fnValueFormatter ? fnValueFormatter(oEvent.getSource().getValue()) : oEvent.getSource().getValue();
          oValueBinding.detachChange(fnChange);
          resolve(sTargetValue);
        };
        oValueBinding.attachChange(fnChange);
      });
      aPromises.push(oPromiseForTitleValue);
      if (sTextExpression) {
        const oTextExpression = BindingParser.complexParser(sTextExpression);
        let sTextPath = oTextExpression.parts ? oTextExpression.parts[0].path : oTextExpression.path;
        sTextPath = sValuePath.lastIndexOf("/") > -1 ? `${sValuePath.slice(0, sValuePath.lastIndexOf("/"))}/${sTextPath}` : sTextPath;
        const fnTextFormatter = oTextExpression.formatter,
          oTextBinding = oModel.bindProperty(sTextPath, oBindingViewContext);
        oTextBinding.initialize();
        const oPromiseForTitleText = new Promise(function (resolve) {
          const fnChange = function (oEvent) {
            const sTargetText = fnTextFormatter ? fnTextFormatter(oEvent.getSource().getValue()) : oEvent.getSource().getValue();
            oTextBinding.detachChange(fnChange);
            resolve(sTargetText);
          };
          oTextBinding.attachChange(fnChange);
        });
        aPromises.push(oPromiseForTitleText);
      }
      try {
        const titleInfo = await Promise.all(aPromises);
        let formattedTitle = "";
        if (typeof titleInfo !== "string") {
          formattedTitle = this._formatTitle(titleInfo[0], titleInfo[1], titleInfo[2]);
        }
        return formattedTitle;
      } catch (error) {
        Log.error("Error while fetching the title from the header info :" + error);
      }
      return "";
    };
    _proto._getAppSpecificHash = function _getAppSpecificHash() {
      // HashChanged isShellNavigationHashChanger
      const hashChanger = HashChanger.getInstance();
      return "hrefForAppSpecificHash" in hashChanger ? hashChanger.hrefForAppSpecificHash("") : "#/";
    };
    _proto._getHash = function _getHash() {
      return HashChanger.getInstance().getHash();
    }

    /**
     * This function returns titleInformation from a path.
     * It updates the cache to store title information if necessary
     *
     * @name sap.fe.core.rootView.BaseController#getTitleInfoFromPath
     * @memberof sap.fe.core.rootView.BaseController
     * @param {*} sPath path of the context to retrieve title information from MetaModel
     * @returns {Promise}  oTitleinformation returned as promise
     */;
    _proto.getTitleInfoFromPath = function getTitleInfoFromPath(sPath) {
      const oTitleHierarchyCache = this._getTitleHierarchyCache();
      if (oTitleHierarchyCache[sPath]) {
        // The title info is already stored in the cache
        return Promise.resolve(oTitleHierarchyCache[sPath]);
      }
      const oMetaModel = this.getAppComponent().getMetaModel();
      const sEntityPath = oMetaModel.getMetaPath(sPath);
      const sTypeName = oMetaModel.getObject(`${sEntityPath}/@com.sap.vocabularies.UI.v1.HeaderInfo/TypeName`);
      const sAppSpecificHash = this._getAppSpecificHash();
      const sIntent = sAppSpecificHash + sPath.slice(1);
      return this._fetchTitleValue(sPath).then(sTitle => {
        const oTitleInfo = this._computeTitleInfo(sTypeName, sTitle, sIntent);
        oTitleHierarchyCache[sPath] = oTitleInfo;
        return oTitleInfo;
      });
    }
    /**
     * Ensure that the ushell service receives all elements
     * (title, subtitle, intent, icon) as strings.
     *
     * Annotation HeaderInfo allows for binding of title and description
     * (which are used here as title and subtitle) to any element in the entity
     * (being possibly types like boolean, timestamp, double, etc.)
     *
     * Creates a new hierarchy and converts non-string types to string.
     *
     * @param aHierarchy Shell title hierarchy
     * @returns Copy of shell title hierarchy containing all elements as strings
     */;
    _proto._ensureHierarchyElementsAreStrings = function _ensureHierarchyElementsAreStrings(aHierarchy) {
      const aHierarchyShell = [];
      for (const level in aHierarchy) {
        const oHierarchy = aHierarchy[level];
        const oShellHierarchy = {};
        for (const key in oHierarchy) {
          oShellHierarchy[key] = typeof oHierarchy[key] !== "string" ? String(oHierarchy[key]) : oHierarchy[key];
        }
        aHierarchyShell.push(oShellHierarchy);
      }
      return aHierarchyShell;
    };
    _proto._getTargetTypeFromHash = function _getTargetTypeFromHash(sHash) {
      var _oAppComponent$getMan;
      const oAppComponent = this.getAppComponent();
      let sTargetType = "";
      const aRoutes = ((_oAppComponent$getMan = oAppComponent.getManifestEntry("sap.ui5").routing) === null || _oAppComponent$getMan === void 0 ? void 0 : _oAppComponent$getMan.routes) ?? [];
      for (const route of aRoutes) {
        const oRoute = oAppComponent.getRouter().getRoute(route.name);
        if (oRoute !== null && oRoute !== void 0 && oRoute.match(sHash)) {
          const sTarget = Array.isArray(route.target) ? route.target[0] : route.target;
          sTargetType = oAppComponent.getRouter().getTarget(sTarget)._oOptions.name;
          break;
        }
      }
      return sTargetType;
    }

    /**
     * This function updates the shell title after each navigation.
     *
     * @memberof sap.fe.core.rootView.BaseController
     * @param oView The current view
     * @returns A Promise that is resolved when the menu is filled properly
     */;
    _proto._computeTitleHierarchy = function _computeTitleHierarchy(oView) {
      const oAppComponent = this.getAppComponent(),
        oContext = oView.getBindingContext(),
        oCurrentPage = oView.getParent(),
        aTitleInformationPromises = [],
        sAppSpecificHash = this._getAppSpecificHash(),
        manifestAppSettings = oAppComponent.getManifestEntry("sap.app"),
        sAppTitle = manifestAppSettings.title || "",
        sAppSubTitle = manifestAppSettings.subTitle || "",
        appIcon = manifestAppSettings.icon || "";
      let oPageTitleInformation, sNewPath;
      if (oCurrentPage && oCurrentPage._getPageTitleInformation) {
        if (oContext) {
          // If the first page of the application is a LR, use the title and subtitle from the manifest
          if (this._getTargetTypeFromHash("") === "sap.fe.templates.ListReport") {
            aTitleInformationPromises.push(Promise.resolve(this._computeTitleInfo(sAppTitle, sAppSubTitle, sAppSpecificHash, appIcon)));
          }

          // Then manage other pages
          sNewPath = oContext.getPath();
          const aPathParts = sNewPath.split("/");
          let sPath = "";
          aPathParts.shift(); // Remove the first segment (empty string) as it has been managed above
          aPathParts.pop(); // Remove the last segment as it corresponds to the current page and shouldn't appear in the menu

          aPathParts.forEach(sPathPart => {
            sPath += `/${sPathPart}`;
            const oMetaModel = oAppComponent.getMetaModel(),
              sParameterPath = oMetaModel.getMetaPath(sPath),
              bIsParameterized = oMetaModel.getObject(`${sParameterPath}/@com.sap.vocabularies.Common.v1.ResultContext`);
            if (!bIsParameterized) {
              aTitleInformationPromises.push(this.getTitleInfoFromPath(sPath));
            }
          });
        }

        // Current page
        oPageTitleInformation = oCurrentPage._getPageTitleInformation();
        oPageTitleInformation = this._computeTitleInfo(oPageTitleInformation.title, oPageTitleInformation.subtitle, sAppSpecificHash + this._getHash());
        if (oContext) {
          this._getTitleHierarchyCache()[sNewPath] = oPageTitleInformation;
        } else {
          this._getTitleHierarchyCache()[sAppSpecificHash] = oPageTitleInformation;
        }
      } else {
        aTitleInformationPromises.push(Promise.reject("Title information missing in HeaderInfo"));
      }
      return Promise.all(aTitleInformationPromises).then(aTitleInfoHierarchy => {
        // workaround for shell which is expecting all elements being of type string
        const aTitleInfoHierarchyShell = this._ensureHierarchyElementsAreStrings(aTitleInfoHierarchy),
          sTitle = oPageTitleInformation.title;
        aTitleInfoHierarchyShell.reverse();
        oAppComponent.getShellServices().setHierarchy(aTitleInfoHierarchyShell);
        this._setShellMenuTitle(oAppComponent, sTitle, sAppTitle);
      }).catch(function (sErrorMessage) {
        Log.error(sErrorMessage);
      }).finally(() => {
        this.bIsComputingTitleHierachy = false;
      }).catch(function (sErrorMessage) {
        Log.error(sErrorMessage);
      });
    }

    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    ;
    _proto.calculateLayout = function calculateLayout(iNextFCLLevel, sHash, sProposedLayout) {
      let keepCurrentLayout = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      return null;
    }

    /**
     * Callback after a view has been bound to a context.
     *
     * @param oContext The context that has been bound to a view
     */;
    _proto.onContextBoundToView = function onContextBoundToView(oContext) {
      if (oContext) {
        const sDeepestPath = this.getView().getModel("internal").getProperty("/deepestPath"),
          sViewContextPath = oContext.getPath();
        if (!sDeepestPath || sDeepestPath.indexOf(sViewContextPath) !== 0) {
          // There was no previous value for the deepest reached path, or the path
          // for the view isn't a subpath of the previous deepest path --> update
          this.getView().getModel("internal").setProperty("/deepestPath", sViewContextPath, undefined, true);
        }
      }
    }

    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    ;
    _proto.displayErrorPage = function displayErrorPage(sErrorMessage, mParameters) {
      // To be overridden
      return Promise.resolve(true);
    }

    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    ;
    _proto.updateUIStateForView = function updateUIStateForView(oView, FCLLevel) {
      // To be overriden
    }

    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    ;
    _proto.getInstancedViews = function getInstancedViews() {
      return [];
      // To be overriden
    };
    _proto._scrollTablesToLastNavigatedItems = function _scrollTablesToLastNavigatedItems() {
      // To be overriden
    };
    _proto.isFclEnabled = function isFclEnabled() {
      return false;
    }

    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    ;
    _proto._setShellMenuTitle = function _setShellMenuTitle(oAppComponent, sTitle, sAppTitle) {
      // To be overriden by FclController
      oAppComponent.getShellServices().setTitle(sTitle);
    };
    _proto.getAppContentContainer = function getAppContentContainer() {
      var _oAppComponent$getMan2, _oAppComponent$getMan3;
      const oAppComponent = this.getAppComponent();
      const appContentId = ((_oAppComponent$getMan2 = oAppComponent.getManifestEntry("sap.ui5").routing) === null || _oAppComponent$getMan2 === void 0 ? void 0 : (_oAppComponent$getMan3 = _oAppComponent$getMan2.config) === null || _oAppComponent$getMan3 === void 0 ? void 0 : _oAppComponent$getMan3.controlId) ?? "appContent";
      return this.getView().byId(appContentId);
    };
    return RootViewBaseController;
  }(BaseController), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "oPlaceholder", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "viewState", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return RootViewBaseController;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/rootView/RootViewBaseController", ["sap/base/Log","sap/fe/core/BaseController","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/Placeholder","sap/fe/core/controllerextensions/ViewState","sap/fe/core/helpers/ClassSupport","sap/fe/macros/table/TableSizeHelper","sap/ui/base/BindingParser","sap/ui/core/routing/HashChanger","sap/ui/model/json/JSONModel","sap/ui/model/odata/v4/AnnotationHelper","sap/ui/thirdparty/URI"],function(e,t,o,n,i,r,a,s,c,l,u,h){"use strict";var f,p,g,d,m,y,b;var P=r.usingExtension;var v=r.defineUI5Class;function C(e,t,o,n){if(!o)return;Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function R(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function T(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;_(e,t)}function _(e,t){_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return _(e,t)}function w(e,t,o,n,i){var r={};Object.keys(n).forEach(function(e){r[e]=n[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}function H(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let M=(f=v("sap.fe.core.rootView.RootViewBaseController"),p=P(n),g=P(i),f(d=(m=function(t){T(n,t);function n(){var e;for(var o=arguments.length,n=new Array(o),i=0;i<o;i++){n[i]=arguments[i]}e=t.call(this,...n)||this;C(e,"oPlaceholder",y,R(e));C(e,"viewState",b,R(e));e.bIsComputingTitleHierachy=false;return e}var i=n.prototype;i.onInit=function e(){a.init();this._aHelperModels=[]};i.getPlaceholder=function e(){return this.oPlaceholder};i.attachRouteMatchers=function e(){this.oPlaceholder.attachRouteMatchers();this.getAppComponent().getRoutingService().attachAfterRouteMatched(this._onAfterRouteMatched,this)};i.onExit=function e(){this.getAppComponent().getRoutingService().detachAfterRouteMatched(this._onAfterRouteMatched,this);this.oRouter=undefined;a.exit();this._aHelperModels.forEach(function(e){e.destroy()})};i.getResourceBundle=function e(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()};i.getRouter=function e(){if(!this.oRouter){this.oRouter=this.getAppComponent().getRouter()}return this.oRouter};i._createHelperModel=function e(){const t=new l;this._aHelperModels.push(t);return t};i.waitForRightMostViewReady=function e(t){return new Promise(function(e){const o=t.getParameter("views"),n=[];o.forEach(function(e){let t=e;if(e&&e.getComponentInstance){const o=e.getComponentInstance();t=o.getRootControl()}if(t&&t.getController()&&t.getController().pageReady){n.push(t)}});const i=n[n.length-1];if(i&&i.getController().pageReady.isPageReady()){e(i)}else if(i){i.getController().pageReady.attachEventOnce("pageReady",function(){e(i)})}})};i._onAfterRouteMatched=function t(o){if(!this._oRouteMatchedPromise){this._oRouteMatchedPromise=this.waitForRightMostViewReady(o).then(e=>{const t=this.getView().getContent()[0];if(t&&t.getAutoFocus&&!t.getAutoFocus()){t.setProperty("autoFocus",true,true)}const o=this.getAppComponent();this._scrollTablesToLastNavigatedItems();if(o.getEnvironmentCapabilities().getCapabilities().UShell){this._computeTitleHierarchy(e)}const n=o.getRouterProxy().isFocusForced();o.getRouterProxy().setFocusForced(false);if(e.getController()&&e.getController().onPageReady&&e.getParent().onPageReady){e.getParent().onPageReady({forceFocus:n})}if(this.onContainerReady){this.onContainerReady()}}).catch(function(t){e.error("An error occurs while computing the title hierarchy and calling focus method",t)}).finally(()=>{this._oRouteMatchedPromise=null})}};i._getTitleHierarchyCache=function e(){if(!this.oTitleHierarchyCache){this.oTitleHierarchyCache={}}return this.oTitleHierarchyCache};i._computeTitleInfo=function e(t,o,n){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";const r=n.split("/");n=h.decode(n);if(r[r.length-1].indexOf("?")===-1){n+="?restoreHistory=true"}else{n+="&restoreHistory=true"}return{title:t,subtitle:o,intent:n,icon:i}};i._formatTitle=function e(t,o,n){let i="";switch(t){case"Value":i=`${o}`;break;case"ValueDescription":i=`${o} (${n})`;break;case"DescriptionValue":i=`${n} (${o})`;break;case"Description":i=`${n}`;break;default:}return i};i._fetchTitleValue=async function t(n){const i=this.getAppComponent(),r=this.getView().getModel(),a=i.getMetaModel(),c=a.getMetaPath(n),l=r.createBindingContext(n),h=u.format(a.getObject(`${c}/@com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value`),{context:a.createBindingContext("/")});if(!h){return Promise.resolve("")}const f=u.format(a.getObject(`${c}/@com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value/$Path@com.sap.vocabularies.Common.v1.Text`),{context:a.createBindingContext("/")}),p=a.getObject(`${c}/@com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value/$Path@`),g=[],d=s.complexParser(h),m=new Promise(function(e){const t=o.computeDisplayMode(p);e(t)});g.push(m);const y=d.parts?d.parts[0].path:d.path,b=d.formatter,P=r.bindProperty(y,l);P.initialize();const v=new Promise(function(e){const t=function(o){const n=b?b(o.getSource().getValue()):o.getSource().getValue();P.detachChange(t);e(n)};P.attachChange(t)});g.push(v);if(f){const e=s.complexParser(f);let t=e.parts?e.parts[0].path:e.path;t=y.lastIndexOf("/")>-1?`${y.slice(0,y.lastIndexOf("/"))}/${t}`:t;const o=e.formatter,n=r.bindProperty(t,l);n.initialize();const i=new Promise(function(e){const t=function(i){const r=o?o(i.getSource().getValue()):i.getSource().getValue();n.detachChange(t);e(r)};n.attachChange(t)});g.push(i)}try{const e=await Promise.all(g);let t="";if(typeof e!=="string"){t=this._formatTitle(e[0],e[1],e[2])}return t}catch(t){e.error("Error while fetching the title from the header info :"+t)}return""};i._getAppSpecificHash=function e(){const t=c.getInstance();return"hrefForAppSpecificHash"in t?t.hrefForAppSpecificHash(""):"#/"};i._getHash=function e(){return c.getInstance().getHash()};i.getTitleInfoFromPath=function e(t){const o=this._getTitleHierarchyCache();if(o[t]){return Promise.resolve(o[t])}const n=this.getAppComponent().getMetaModel();const i=n.getMetaPath(t);const r=n.getObject(`${i}/@com.sap.vocabularies.UI.v1.HeaderInfo/TypeName`);const a=this._getAppSpecificHash();const s=a+t.slice(1);return this._fetchTitleValue(t).then(e=>{const n=this._computeTitleInfo(r,e,s);o[t]=n;return n})};i._ensureHierarchyElementsAreStrings=function e(t){const o=[];for(const e in t){const n=t[e];const i={};for(const e in n){i[e]=typeof n[e]!=="string"?String(n[e]):n[e]}o.push(i)}return o};i._getTargetTypeFromHash=function e(t){var o;const n=this.getAppComponent();let i="";const r=((o=n.getManifestEntry("sap.ui5").routing)===null||o===void 0?void 0:o.routes)??[];for(const e of r){const o=n.getRouter().getRoute(e.name);if(o!==null&&o!==void 0&&o.match(t)){const t=Array.isArray(e.target)?e.target[0]:e.target;i=n.getRouter().getTarget(t)._oOptions.name;break}}return i};i._computeTitleHierarchy=function t(o){const n=this.getAppComponent(),i=o.getBindingContext(),r=o.getParent(),a=[],s=this._getAppSpecificHash(),c=n.getManifestEntry("sap.app"),l=c.title||"",u=c.subTitle||"",h=c.icon||"";let f,p;if(r&&r._getPageTitleInformation){if(i){if(this._getTargetTypeFromHash("")==="sap.fe.templates.ListReport"){a.push(Promise.resolve(this._computeTitleInfo(l,u,s,h)))}p=i.getPath();const e=p.split("/");let t="";e.shift();e.pop();e.forEach(e=>{t+=`/${e}`;const o=n.getMetaModel(),i=o.getMetaPath(t),r=o.getObject(`${i}/@com.sap.vocabularies.Common.v1.ResultContext`);if(!r){a.push(this.getTitleInfoFromPath(t))}})}f=r._getPageTitleInformation();f=this._computeTitleInfo(f.title,f.subtitle,s+this._getHash());if(i){this._getTitleHierarchyCache()[p]=f}else{this._getTitleHierarchyCache()[s]=f}}else{a.push(Promise.reject("Title information missing in HeaderInfo"))}return Promise.all(a).then(e=>{const t=this._ensureHierarchyElementsAreStrings(e),o=f.title;t.reverse();n.getShellServices().setHierarchy(t);this._setShellMenuTitle(n,o,l)}).catch(function(t){e.error(t)}).finally(()=>{this.bIsComputingTitleHierachy=false}).catch(function(t){e.error(t)})};i.calculateLayout=function e(t,o,n){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;return null};i.onContextBoundToView=function e(t){if(t){const e=this.getView().getModel("internal").getProperty("/deepestPath"),o=t.getPath();if(!e||e.indexOf(o)!==0){this.getView().getModel("internal").setProperty("/deepestPath",o,undefined,true)}}};i.displayErrorPage=function e(t,o){return Promise.resolve(true)};i.updateUIStateForView=function e(t,o){};i.getInstancedViews=function e(){return[]};i._scrollTablesToLastNavigatedItems=function e(){};i.isFclEnabled=function e(){return false};i._setShellMenuTitle=function e(t,o,n){t.getShellServices().setTitle(o)};i.getAppContentContainer=function e(){var t,o;const n=this.getAppComponent();const i=((t=n.getManifestEntry("sap.ui5").routing)===null||t===void 0?void 0:(o=t.config)===null||o===void 0?void 0:o.controlId)??"appContent";return this.getView().byId(i)};return n}(t),y=w(m.prototype,"oPlaceholder",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),b=w(m.prototype,"viewState",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),m))||d);return M},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/AsyncComponentServiceFactory-dbg", ["sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory"], function (Service, ServiceFactory) {
  "use strict";

  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let AsyncComponentService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(AsyncComponentService, _Service);
    function AsyncComponentService() {
      return _Service.apply(this, arguments) || this;
    }
    var _proto = AsyncComponentService.prototype;
    // !: means that we know it will be assigned before usage
    _proto.init = function init() {
      this.initPromise = new Promise((resolve, reject) => {
        this.resolveFn = resolve;
        this.rejectFn = reject;
      });
      const oContext = this.getContext();
      const oComponent = oContext.scopeObject;
      const oServices = oComponent._getManifestEntry("/sap.ui5/services", true);
      Promise.all(Object.keys(oServices).filter(sServiceKey => oServices[sServiceKey].startup === "waitFor" && oServices[sServiceKey].factoryName !== "sap.fe.core.services.AsyncComponentService").map(sServiceKey => {
        return oComponent.getService(sServiceKey).then(oServiceInstance => {
          const sMethodName = `get${sServiceKey[0].toUpperCase()}${sServiceKey.substr(1)}`;
          if (!oComponent.hasOwnProperty(sMethodName)) {
            oComponent[sMethodName] = function () {
              return oServiceInstance;
            };
          }
        });
      })).then(() => {
        return oComponent.pRootControlLoaded || Promise.resolve();
      }).then(() => {
        // notifiy the component
        if (oComponent.onServicesStarted) {
          oComponent.onServicesStarted();
        }
        this.resolveFn(this);
      }).catch(this.rejectFn);
    };
    return AsyncComponentService;
  }(Service);
  let AsyncComponentServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(AsyncComponentServiceFactory, _ServiceFactory);
    function AsyncComponentServiceFactory() {
      return _ServiceFactory.apply(this, arguments) || this;
    }
    var _proto2 = AsyncComponentServiceFactory.prototype;
    _proto2.createInstance = function createInstance(oServiceContext) {
      const asyncComponentService = new AsyncComponentService(oServiceContext);
      return asyncComponentService.initPromise;
    };
    return AsyncComponentServiceFactory;
  }(ServiceFactory);
  return AsyncComponentServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/AsyncComponentServiceFactory", ["sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(t,e){"use strict";function r(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;n(t,e)}function n(t,e){n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,r){e.__proto__=r;return e};return n(t,e)}let o=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;n.init=function t(){this.initPromise=new Promise((t,e)=>{this.resolveFn=t;this.rejectFn=e});const e=this.getContext();const r=e.scopeObject;const n=r._getManifestEntry("/sap.ui5/services",true);Promise.all(Object.keys(n).filter(t=>n[t].startup==="waitFor"&&n[t].factoryName!=="sap.fe.core.services.AsyncComponentService").map(t=>r.getService(t).then(e=>{const n=`get${t[0].toUpperCase()}${t.substr(1)}`;if(!r.hasOwnProperty(n)){r[n]=function(){return e}}}))).then(()=>r.pRootControlLoaded||Promise.resolve()).then(()=>{if(r.onServicesStarted){r.onServicesStarted()}this.resolveFn(this)}).catch(this.rejectFn)};return e}(t);let i=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;n.createInstance=function t(e){const r=new o(e);return r.initPromise};return e}(e);return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/CacheHandlerServiceFactory-dbg", ["sap/base/strings/hash", "sap/ui/core/cache/CacheManager", "sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory"], function (hash, CacheManager, Service, ServiceFactory) {
  "use strict";

  var _exports = {};
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function getMetadataETag(sUrl, sETag, mUpdatedMetaModelETags) {
    return new Promise(function (resolve) {
      // There is an Url in the FE cache, that's not in the MetaModel yet -> we need to check the ETag
      jQuery.ajax(sUrl, {
        method: "GET"
      }).done(function (oResponse, sTextStatus, jqXHR) {
        // ETag is not the same -> invalid
        // ETag is the same -> valid
        // If ETag is available use it, otherwise use Last-Modified
        mUpdatedMetaModelETags[sUrl] = jqXHR.getResponseHeader("ETag") || jqXHR.getResponseHeader("Last-Modified");
        resolve(sETag === mUpdatedMetaModelETags[sUrl]);
      }).fail(function () {
        // Case 2z - Make sure we update the map so that we invalidate the cache
        mUpdatedMetaModelETags[sUrl] = "";
        resolve(false);
      });
    });
  }
  let CacheHandlerService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(CacheHandlerService, _Service);
    function CacheHandlerService() {
      return _Service.apply(this, arguments) || this;
    }
    _exports.CacheHandlerService = CacheHandlerService;
    var _proto = CacheHandlerService.prototype;
    _proto.init = function init() {
      const oContext = this.getContext();
      this.oFactory = oContext.factory;
      const mSettings = oContext.settings;
      if (!mSettings.metaModel) {
        throw new Error("a `metaModel` property is expected when instantiating the CacheHandlerService");
      }
      this.oMetaModel = mSettings.metaModel;
      this.oAppComponent = mSettings.appComponent;
      this.oComponent = mSettings.component;
      this.initPromise = this.oMetaModel.fetchEntityContainer().then(() => {
        return this;
      });
      this.mCacheNeedsInvalidate = {};
    };
    _proto.exit = function exit() {
      // Deregister global instance
      this.oFactory.removeGlobalInstance(this.oMetaModel);
    };
    _proto.validateCacheKey = async function validateCacheKey(sCacheIdentifier, oComponent) {
      // Keep track if the cache will anyway need to be updated
      let bCacheNeedUpdate = true;
      let sCacheKey;
      try {
        const mCacheOutput = await CacheManager.get(sCacheIdentifier);
        // We provide a default key so that an xml view cache is written
        const mMetaModelETags = this.getETags(oComponent);
        sCacheKey = JSON.stringify(mMetaModelETags);
        // Case #1a - No cache, so mCacheOuput is empty, cacheKey = current metamodel ETags
        if (mCacheOutput) {
          // Case #2 - Cache entry found, check if it's still valid
          const mUpdatedMetaModelETags = {};
          const mCachedETags = JSON.parse(mCacheOutput.cachedETags);
          const aValidETags = await Promise.all(Object.keys(mCachedETags).map(function (sUrl) {
            // Check validity of every single Url that's in the FE Cache object
            if (mCachedETags[sUrl]) {
              if (mMetaModelETags[sUrl]) {
                // Case #2a - Same number of ETags in the cache and in the metadata
                mUpdatedMetaModelETags[sUrl] = mMetaModelETags[sUrl];
                return mCachedETags[sUrl] === mMetaModelETags[sUrl];
              } else {
                // Case #2b - No ETag in the cache for that URL, cachedETags was enhanced
                return getMetadataETag(sUrl, mCachedETags[sUrl], mUpdatedMetaModelETags);
              }
            } else {
              // Case #2z - Last Templating added an URL without ETag
              mUpdatedMetaModelETags[sUrl] = mMetaModelETags[sUrl];
              return mCachedETags[sUrl] === mMetaModelETags[sUrl];
            }
          }));
          bCacheNeedUpdate = aValidETags.indexOf(false) >= 0;
          // Case #2a - Same number of ETags and all valid -> we return the viewCacheKey
          // Case #2b - Different number of ETags and still all valid -> we return the viewCacheKey
          // Case #2c - Same number of ETags but different values, main service Etag has changed, use that as cache key
          // Case #2d - Different number of ETags but different value, main service Etag or linked service Etag has changed, new ETags should be used as cacheKey
          // Case #2z - Cache has an invalid Etag - if there is an Etag provided from MetaModel use it as cacheKey
          if (Object.keys(mUpdatedMetaModelETags).some(function (sUrl) {
            return !mUpdatedMetaModelETags[sUrl];
          })) {
            // At least one of the MetaModel URLs doesn't provide an ETag, so no caching
            sCacheKey = null;
          } else {
            sCacheKey = bCacheNeedUpdate ? JSON.stringify(mUpdatedMetaModelETags) : mCacheOutput.viewCacheKey;
          }
        } else if (Object.keys(mMetaModelETags).some(function (sUrl) {
          return !mMetaModelETags[sUrl];
        })) {
          // Check if cache can be used (all the metadata and annotations have to provide at least a ETag or a Last-Modified header)
          // Case #1-b - No Cache, mCacheOuput is empty, but metamodel etags cannot be used, so no caching
          bCacheNeedUpdate = true;
          sCacheKey = null;
        }
      } catch (e) {
        // Don't use view cache in case of issues with the LRU cache
        bCacheNeedUpdate = true;
        sCacheKey = null;
      }
      this.mCacheNeedsInvalidate[sCacheIdentifier] = bCacheNeedUpdate;
      return sCacheKey;
    };
    _proto.invalidateIfNeeded = function invalidateIfNeeded(sCacheKeys, sCacheIdentifier, oComponent) {
      // Check FE cache after XML view is processed completely
      const sDataSourceETags = JSON.stringify(this.getETags(oComponent));
      if (this.mCacheNeedsInvalidate[sCacheIdentifier] || sCacheKeys && sCacheKeys !== sDataSourceETags) {
        // Something in the sources and/or its ETags changed -> update the FE cache
        const mCacheKeys = {};
        // New ETags that need to be verified, may differ from the one used to generate the view
        mCacheKeys.cachedETags = sDataSourceETags;
        // Old ETags that are used for the xml view cache as key
        mCacheKeys.viewCacheKey = sCacheKeys;
        return CacheManager.set(sCacheIdentifier, mCacheKeys);
      } else {
        return Promise.resolve();
      }
    };
    _proto.getETags = function getETags(oComponent) {
      const mMetaModelETags = this.oMetaModel.getETags();
      // ETags from UI5 are either a Date or a string, let's rationalize that
      Object.keys(mMetaModelETags).forEach(function (sMetaModelKey) {
        if (mMetaModelETags[sMetaModelKey] instanceof Date) {
          // MetaModel contains a Last-Modified timestamp for the URL
          mMetaModelETags[sMetaModelKey] = mMetaModelETags[sMetaModelKey].toISOString();
        }
      });

      // add also the manifest hash as UI5 only considers the root component hash
      const oManifestContent = this.oAppComponent.getManifest();
      const sManifestHash = hash(JSON.stringify({
        sapApp: oManifestContent["sap.app"],
        viewData: oComponent.getViewData()
      }));
      mMetaModelETags["manifest"] = sManifestHash;
      return mMetaModelETags;
    };
    _proto.getInterface = function getInterface() {
      return this;
    };
    return CacheHandlerService;
  }(Service);
  _exports.CacheHandlerService = CacheHandlerService;
  let CacheHandlerServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(CacheHandlerServiceFactory, _ServiceFactory);
    function CacheHandlerServiceFactory() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _ServiceFactory.call(this, ...args) || this;
      _this._oInstanceRegistry = {};
      return _this;
    }
    var _proto2 = CacheHandlerServiceFactory.prototype;
    _proto2.createInstance = function createInstance(oServiceContext) {
      const sMetaModelId = oServiceContext.settings.metaModel.getId();
      let cacheHandlerInstance = this._oInstanceRegistry[sMetaModelId];
      if (!cacheHandlerInstance) {
        this._oInstanceRegistry[sMetaModelId] = cacheHandlerInstance = new CacheHandlerService(Object.assign({
          factory: this,
          scopeObject: null,
          scopeType: "service"
        }, oServiceContext));
      }
      return cacheHandlerInstance.initPromise.then(() => {
        return this._oInstanceRegistry[sMetaModelId];
      }).catch(e => {
        // In case of error delete the global instance;
        this._oInstanceRegistry[sMetaModelId] = null;
        throw e;
      });
    };
    _proto2.getInstance = function getInstance(oMetaModel) {
      return this._oInstanceRegistry[oMetaModel.getId()];
    };
    _proto2.removeGlobalInstance = function removeGlobalInstance(oMetaModel) {
      this._oInstanceRegistry[oMetaModel.getId()] = null;
    };
    return CacheHandlerServiceFactory;
  }(ServiceFactory);
  return CacheHandlerServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/CacheHandlerServiceFactory", ["sap/base/strings/hash","sap/ui/core/cache/CacheManager","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(e,t,n,i){"use strict";var s={};function o(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;r(e,t)}function r(e,t){r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return r(e,t)}function a(e,t,n){return new Promise(function(i){jQuery.ajax(e,{method:"GET"}).done(function(s,o,r){n[e]=r.getResponseHeader("ETag")||r.getResponseHeader("Last-Modified");i(t===n[e])}).fail(function(){n[e]="";i(false)})})}let c=function(n){o(i,n);function i(){return n.apply(this,arguments)||this}s.CacheHandlerService=i;var r=i.prototype;r.init=function e(){const t=this.getContext();this.oFactory=t.factory;const n=t.settings;if(!n.metaModel){throw new Error("a `metaModel` property is expected when instantiating the CacheHandlerService")}this.oMetaModel=n.metaModel;this.oAppComponent=n.appComponent;this.oComponent=n.component;this.initPromise=this.oMetaModel.fetchEntityContainer().then(()=>this);this.mCacheNeedsInvalidate={}};r.exit=function e(){this.oFactory.removeGlobalInstance(this.oMetaModel)};r.validateCacheKey=async function e(n,i){let s=true;let o;try{const e=await t.get(n);const r=this.getETags(i);o=JSON.stringify(r);if(e){const t={};const n=JSON.parse(e.cachedETags);const i=await Promise.all(Object.keys(n).map(function(e){if(n[e]){if(r[e]){t[e]=r[e];return n[e]===r[e]}else{return a(e,n[e],t)}}else{t[e]=r[e];return n[e]===r[e]}}));s=i.indexOf(false)>=0;if(Object.keys(t).some(function(e){return!t[e]})){o=null}else{o=s?JSON.stringify(t):e.viewCacheKey}}else if(Object.keys(r).some(function(e){return!r[e]})){s=true;o=null}}catch(e){s=true;o=null}this.mCacheNeedsInvalidate[n]=s;return o};r.invalidateIfNeeded=function e(n,i,s){const o=JSON.stringify(this.getETags(s));if(this.mCacheNeedsInvalidate[i]||n&&n!==o){const e={};e.cachedETags=o;e.viewCacheKey=n;return t.set(i,e)}else{return Promise.resolve()}};r.getETags=function t(n){const i=this.oMetaModel.getETags();Object.keys(i).forEach(function(e){if(i[e]instanceof Date){i[e]=i[e].toISOString()}});const s=this.oAppComponent.getManifest();const o=e(JSON.stringify({sapApp:s["sap.app"],viewData:n.getViewData()}));i["manifest"]=o;return i};r.getInterface=function e(){return this};return i}(n);s.CacheHandlerService=c;let u=function(e){o(t,e);function t(){var t;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++){i[s]=arguments[s]}t=e.call(this,...i)||this;t._oInstanceRegistry={};return t}var n=t.prototype;n.createInstance=function e(t){const n=t.settings.metaModel.getId();let i=this._oInstanceRegistry[n];if(!i){this._oInstanceRegistry[n]=i=new c(Object.assign({factory:this,scopeObject:null,scopeType:"service"},t))}return i.initPromise.then(()=>this._oInstanceRegistry[n]).catch(e=>{this._oInstanceRegistry[n]=null;throw e})};n.getInstance=function e(t){return this._oInstanceRegistry[t.getId()]};n.removeGlobalInstance=function e(t){this._oInstanceRegistry[t.getId()]=null};return t}(i);return u},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/EnvironmentServiceFactory-dbg", ["sap/ui/core/Core", "sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory", "sap/ui/VersionInfo", "../converters/MetaModelConverter"], function (Core, Service, ServiceFactory, VersionInfo, MetaModelConverter) {
  "use strict";

  var _exports = {};
  var DefaultEnvironmentCapabilities = MetaModelConverter.DefaultEnvironmentCapabilities;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let EnvironmentCapabilitiesService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(EnvironmentCapabilitiesService, _Service);
    function EnvironmentCapabilitiesService() {
      return _Service.apply(this, arguments) || this;
    }
    _exports.EnvironmentCapabilitiesService = EnvironmentCapabilitiesService;
    var _proto = EnvironmentCapabilitiesService.prototype;
    // !: means that we know it will be assigned before usage
    _proto.init = function init() {
      this.initPromise = new Promise((resolve, reject) => {
        this.resolveFn = resolve;
        this.rejectFn = reject;
      });
      const oContext = this.getContext();
      this.environmentCapabilities = Object.assign({}, DefaultEnvironmentCapabilities);
      VersionInfo.load().then(versionInfo => {
        this.environmentCapabilities.Chart = !!versionInfo.libraries.find(lib => lib.name === "sap.viz");
        this.environmentCapabilities.MicroChart = !!versionInfo.libraries.find(lib => lib.name === "sap.suite.ui.microchart");
        this.environmentCapabilities.UShell = !!(sap && sap.ushell && sap.ushell.Container);
        this.environmentCapabilities.IntentBasedNavigation = !!(sap && sap.ushell && sap.ushell.Container);
        this.environmentCapabilities = Object.assign(this.environmentCapabilities, oContext.settings);
        this.resolveFn(this);
      }).catch(this.rejectFn);
    };
    _proto.resolveLibrary = function resolveLibrary(libraryName) {
      return new Promise(function (resolve) {
        try {
          Core.loadLibrary(`${libraryName.replace(/\./g, "/")}`, {
            async: true
          }).then(function () {
            resolve(true);
          }).catch(function () {
            resolve(false);
          });
        } catch (e) {
          resolve(false);
        }
      });
    };
    _proto.setCapabilities = function setCapabilities(oCapabilities) {
      this.environmentCapabilities = oCapabilities;
    };
    _proto.setCapability = function setCapability(capability, value) {
      this.environmentCapabilities[capability] = value;
    };
    _proto.getCapabilities = function getCapabilities() {
      return this.environmentCapabilities;
    };
    _proto.getInterface = function getInterface() {
      return this;
    };
    return EnvironmentCapabilitiesService;
  }(Service);
  _exports.EnvironmentCapabilitiesService = EnvironmentCapabilitiesService;
  let EnvironmentServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(EnvironmentServiceFactory, _ServiceFactory);
    function EnvironmentServiceFactory() {
      return _ServiceFactory.apply(this, arguments) || this;
    }
    var _proto2 = EnvironmentServiceFactory.prototype;
    _proto2.createInstance = function createInstance(oServiceContext) {
      const environmentCapabilitiesService = new EnvironmentCapabilitiesService(oServiceContext);
      return environmentCapabilitiesService.initPromise;
    };
    return EnvironmentServiceFactory;
  }(ServiceFactory);
  return EnvironmentServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/EnvironmentServiceFactory", ["sap/ui/core/Core","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory","sap/ui/VersionInfo","../converters/MetaModelConverter"],function(t,e,i,n,r){"use strict";var s={};var a=r.DefaultEnvironmentCapabilities;function o(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;c(t,e)}function c(t,e){c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,i){e.__proto__=i;return e};return c(t,e)}let p=function(e){o(i,e);function i(){return e.apply(this,arguments)||this}s.EnvironmentCapabilitiesService=i;var r=i.prototype;r.init=function t(){this.initPromise=new Promise((t,e)=>{this.resolveFn=t;this.rejectFn=e});const e=this.getContext();this.environmentCapabilities=Object.assign({},a);n.load().then(t=>{this.environmentCapabilities.Chart=!!t.libraries.find(t=>t.name==="sap.viz");this.environmentCapabilities.MicroChart=!!t.libraries.find(t=>t.name==="sap.suite.ui.microchart");this.environmentCapabilities.UShell=!!(sap&&sap.ushell&&sap.ushell.Container);this.environmentCapabilities.IntentBasedNavigation=!!(sap&&sap.ushell&&sap.ushell.Container);this.environmentCapabilities=Object.assign(this.environmentCapabilities,e.settings);this.resolveFn(this)}).catch(this.rejectFn)};r.resolveLibrary=function e(i){return new Promise(function(e){try{t.loadLibrary(`${i.replace(/\./g,"/")}`,{async:true}).then(function(){e(true)}).catch(function(){e(false)})}catch(t){e(false)}})};r.setCapabilities=function t(e){this.environmentCapabilities=e};r.setCapability=function t(e,i){this.environmentCapabilities[e]=i};r.getCapabilities=function t(){return this.environmentCapabilities};r.getInterface=function t(){return this};return i}(e);s.EnvironmentCapabilitiesService=p;let u=function(t){o(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.createInstance=function t(e){const i=new p(e);return i.initPromise};return e}(i);return u},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/NavigationServiceFactory-dbg", ["sap/fe/navigation/NavigationHandler", "sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory"], function (NavigationHandler, Service, ServiceFactory) {
  "use strict";

  var _exports = {};
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let NavigationService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(NavigationService, _Service);
    function NavigationService() {
      return _Service.apply(this, arguments) || this;
    }
    _exports.NavigationService = NavigationService;
    var _proto = NavigationService.prototype;
    _proto.init = function init() {
      const oContext = this.getContext(),
        oComponent = oContext && oContext.scopeObject;
      this.oNavHandler = new NavigationHandler(oComponent);
      this.oNavHandler.setModel(oComponent.getModel());
      this.initPromise = Promise.resolve(this);
    };
    _proto.exit = function exit() {
      this.oNavHandler.destroy();
    }

    /**
     * Triggers a cross-app navigation after saving the inner and the cross-app states.
     *
     * @private
     * @ui5-restricted
     * @param sSemanticObject Semantic object of the target app
     * @param sActionName Action of the target app
     * @param [vNavigationParameters] Navigation parameters as an object with key/value pairs or as a string representation of
     *        such an object. If passed as an object, the properties are not checked against the <code>IsPotentialSensitive</code> or
     *        <code>Measure</code> type.
     * @param [oInnerAppData] Object for storing current state of the app
     * @param [fnOnError] Callback that is called if an error occurs during navigation <br>
     * @param [oExternalAppData] Object for storing the state which will be forwarded to the target component.
     * @param [sNavMode] Argument is used to overwrite the FLP-configured target for opening a URL. If used, only the
     *        <code>explace</code> or <code>inplace</code> values are allowed. Any other value will lead to an exception
     *        <code>NavigationHandler.INVALID_NAV_MODE</code>.
     */;
    _proto.navigate = function navigate(sSemanticObject, sActionName, vNavigationParameters, oInnerAppData, fnOnError, oExternalAppData, sNavMode) {
      // TODO: Navigation Handler does not handle navigation without a context
      // but in v4 DataFieldForIBN with requiresContext false can trigger a navigation without any context
      // This should be handled
      this.oNavHandler.navigate(sSemanticObject, sActionName, vNavigationParameters, oInnerAppData, fnOnError, oExternalAppData, sNavMode);
    }
    /**
     * Parses the incoming URL and returns a Promise.
     *
     * @returns A Promise object which returns the
     * extracted app state, the startup parameters, and the type of navigation when execution is successful,
     * @private
     * @ui5-restricted
     */;
    _proto.parseNavigation = function parseNavigation() {
      return this.oNavHandler.parseNavigation();
    }
    /**
     * Processes navigation-related tasks related to beforePopoverOpens event handling for the SmartLink control and returns a Promise object.
     *
     * @param oTableEventParameters The parameters made available by the SmartTable control when the SmartLink control has been clicked,
     *        an instance of a PopOver object
     * @param sSelectionVariant Stringified JSON object as returned, for example, from getDataSuiteFormat() of the SmartFilterBar control
     * @param [mInnerAppData] Object containing the current state of the app. If provided, opening the Popover is deferred until the
     *        inner app data is saved in a consistent way.
     * @returns A Promise object to monitor when all actions of the function have been executed; if the execution is successful, the
     *          modified oTableEventParameters is returned; if an error occurs, an error object of type
     *          {@link sap.fe.navigation.NavError} is returned
     * @private
     */;
    _proto._processBeforeSmartLinkPopoverOpens = function _processBeforeSmartLinkPopoverOpens(oTableEventParameters, sSelectionVariant, mInnerAppData) {
      return this.oNavHandler.processBeforeSmartLinkPopoverOpens(oTableEventParameters, sSelectionVariant, mInnerAppData);
    }

    /**
     * Processes selectionVariant string and returns a Promise object (semanticAttributes and AppStateKey).
     *
     * @param sSelectionVariant Stringified JSON object
     * @returns A Promise object to monitor when all actions of the function have been executed; if the execution is successful, the
     *          semanticAttributes as well as the appStateKey are returned; if an error occurs, an error object of type
     *          {@link sap.fe.navigation.NavError} is returned
     * <br>
     * @example <code>
     *
     * 		var oSelectionVariant = new sap.fe.navigation.SelectionVariant();
     * 		oSelectionVariant.addSelectOption("CompanyCode", "I", "EQ", "0001");
     * 		oSelectionVariant.addSelectOption("Customer", "I", "EQ", "C0001");
     * 		var sSelectionVariant= oSelectionVariant.toJSONString();
     *
     * 		var oNavigationHandler = new sap.fe.navigation.NavigationHandler(oController);
     * 		var oPromiseObject = oNavigationHandler._getAppStateKeyAndUrlParameters(sSelectionVariant);
     *
     * 		oPromiseObject.done(function(oSemanticAttributes, sAppStateKey){
     * 			// here you can add coding that should run after all app state and the semantic attributes have been returned.
     * 		});
     *
     * 		oPromiseObject.fail(function(oError){
     * 			//some error handling
     * 		});
     *
     * </code>
     * @private
     * @ui5-restricted
     */;
    _proto.getAppStateKeyAndUrlParameters = function getAppStateKeyAndUrlParameters(sSelectionVariant) {
      return this.oNavHandler._getAppStateKeyAndUrlParameters(sSelectionVariant);
    }

    /**
     * Gets the application specific technical parameters.
     *
     * @returns Containing the technical parameters.
     * @private
     * @ui5-restricted
     */;
    _proto.getTechnicalParameters = function getTechnicalParameters() {
      return this.oNavHandler.getTechnicalParameters();
    }
    /**
     * Sets the application specific technical parameters. Technical parameters will not be added to the selection variant passed to the
     * application.
     * As a default sap-system, sap-ushell-defaultedParameterNames and hcpApplicationId are considered as technical parameters.
     *
     * @param aTechnicalParameters List of parameter names to be considered as technical parameters. <code>null</code> or
     *        <code>undefined</code> may be used to reset the complete list.
     * @private
     * @ui5-restricted
     */;
    _proto.setTechnicalParameters = function setTechnicalParameters(aTechnicalParameters) {
      this.oNavHandler.setTechnicalParameters(aTechnicalParameters);
    }
    /**
     * Sets the model that is used for verification of sensitive information. If the model is not set, the unnamed component model is used for the
     * verification of sensitive information.
     *
     * @private
     * @ui5-restricted
     * @param oModel Model For checking sensitive information
     */;
    _proto.setModel = function setModel(oModel) {
      this.oNavHandler.setModel(oModel);
    }
    /**
     * Changes the URL according to the current app state and stores the app state for later retrieval.
     *
     * @private
     * @ui5-restricted
     * @param mInnerAppData Object containing the current state of the app
     * @param [bImmediateHashReplace=true] If set to false, the inner app hash will not be replaced until storing is successful; do not
     *        set to false if you cannot react to the resolution of the Promise, for example, when calling the beforeLinkPressed event
     * @param [bSkipHashReplace=false] If set to true, the inner app hash will not be replaced in the storeInnerAppState. Also the bImmediateHashReplace
     * 		  will be ignored.
     * @returns A Promise object to monitor when all the actions of the function have been executed; if the execution is successful, the
     *          app state key is returned; if an error occurs, an object of type {@link sap.fe.navigation.NavError} is
     *          returned
     */;
    _proto.storeInnerAppStateAsync = function storeInnerAppStateAsync(mInnerAppData, bImmediateHashReplace, bSkipHashReplace) {
      // safely converting JQuerry deferred to ES6 promise
      return new Promise((resolve, reject) => this.oNavHandler.storeInnerAppStateAsync(mInnerAppData, bImmediateHashReplace, bSkipHashReplace).then(resolve, reject));
    }
    /**
     * Changes the URL according to the current app state and stores the app state for later retrieval.
     *
     * @private
     * @ui5-restricted
     * @param mInnerAppData Object containing the current state of the app
     * @param [bImmediateHashReplace=false] If set to false, the inner app hash will not be replaced until storing is successful; do not
     * @returns An object containing the appStateId and a promise object to monitor when all the actions of the function have been
     * executed; Please note that the appStateKey may be undefined or empty.
     */;
    _proto.storeInnerAppStateWithImmediateReturn = function storeInnerAppStateWithImmediateReturn(mInnerAppData, bImmediateHashReplace) {
      return this.oNavHandler.storeInnerAppStateWithImmediateReturn(mInnerAppData, bImmediateHashReplace);
    }
    /**
     * Changes the URL according to the current sAppStateKey. As an reaction route change event will be triggered.
     *
     * @private
     * @ui5-restricted
     * @param sAppStateKey The new app state key.
     */;
    _proto.replaceHash = function replaceHash(sAppStateKey) {
      this.oNavHandler.replaceHash(sAppStateKey);
    };
    _proto.replaceInnerAppStateKey = function replaceInnerAppStateKey(sAppHash, sAppStateKey) {
      return this.oNavHandler._replaceInnerAppStateKey(sAppHash, sAppStateKey);
    }
    /**
     * Get single values from SelectionVariant for url parameters.
     *
     * @private
     * @ui5-restricted
     * @param [vSelectionVariant]
     * @param [vSelectionVariant.oUrlParamaters]
     * @returns The url parameters
     */;
    _proto.getUrlParametersFromSelectionVariant = function getUrlParametersFromSelectionVariant(vSelectionVariant) {
      return this.oNavHandler._getURLParametersFromSelectionVariant(vSelectionVariant);
    }

    /**
     * Save app state and return immediately without waiting for response.
     *
     * @private
     * @ui5-restricted
     * @param oInSelectionVariant Instance of sap.fe.navigation.SelectionVariant
     * @returns AppState key
     */;
    _proto.saveAppStateWithImmediateReturn = function saveAppStateWithImmediateReturn(oInSelectionVariant) {
      if (oInSelectionVariant) {
        const sSelectionVariant = oInSelectionVariant.toJSONString(),
          // create an SV for app state in string format
          oSelectionVariant = JSON.parse(sSelectionVariant),
          // convert string into JSON to store in AppState
          oXAppStateObject = {
            selectionVariant: oSelectionVariant
          },
          oReturn = this.oNavHandler._saveAppStateWithImmediateReturn(oXAppStateObject);
        return oReturn !== null && oReturn !== void 0 && oReturn.appStateKey ? oReturn.appStateKey : "";
      } else {
        return undefined;
      }
    }

    /**
     * Mix Attributes and selectionVariant.
     *
     * @param vSemanticAttributes Object/(Array of Objects) containing key/value pairs
     * @param sSelectionVariant The selection variant in string format as provided by the SmartFilterBar control
     * @param [iSuppressionBehavior=sap.fe.navigation.SuppressionBehavior.standard] Indicates whether semantic
     *        attributes with special values (see {@link sap.fe.navigation.SuppressionBehavior suppression behavior}) must be
     *        suppressed before they are combined with the selection variant; several
     *        {@link sap.fe.navigation.SuppressionBehavior suppression behaviors} can be combined with the bitwise OR operator
     *        (|)
     * @returns Instance of {@link sap.fe.navigation.SelectionVariant}
     */;
    _proto.mixAttributesAndSelectionVariant = function mixAttributesAndSelectionVariant(vSemanticAttributes, sSelectionVariant, iSuppressionBehavior) {
      return this.oNavHandler.mixAttributesAndSelectionVariant(vSemanticAttributes, sSelectionVariant, iSuppressionBehavior);
    }

    /**
     * The method creates a context url based on provided data. This context url can either be used as.
     *
     * @param sEntitySetName Used for url determination
     * @param [oModel] The ODataModel used for url determination. If omitted, the NavigationHandler model is used.
     * @returns The context url for the given entities
     */;
    _proto.constructContextUrl = function constructContextUrl(sEntitySetName, oModel) {
      return this.oNavHandler.constructContextUrl(sEntitySetName, oModel);
    };
    _proto.getInterface = function getInterface() {
      return this;
    };
    return NavigationService;
  }(Service);
  _exports.NavigationService = NavigationService;
  function fnGetEmptyObject() {
    return {};
  }
  function fnGetPromise() {
    return Promise.resolve({});
  }
  function fnGetJQueryPromise() {
    const oMyDeffered = jQuery.Deferred();
    oMyDeffered.resolve({}, {}, "initial");
    return oMyDeffered.promise();
  }
  function fnGetEmptyString() {
    return "";
  }
  let NavigationServicesMock = /*#__PURE__*/function () {
    function NavigationServicesMock() {
      this.createEmptyAppState = fnGetEmptyObject;
      this.storeInnerAppStateWithImmediateReturn = fnGetEmptyObject;
      this.mixAttributesAndSelectionVariant = fnGetEmptyObject;
      this.getAppState = fnGetPromise;
      this.getStartupAppState = fnGetPromise;
      this.parseNavigation = fnGetJQueryPromise;
      this.constructContextUrl = fnGetEmptyString;
      this.initPromise = Promise.resolve(this);
    }
    _exports.NavigationServicesMock = NavigationServicesMock;
    var _proto2 = NavigationServicesMock.prototype;
    _proto2.getInterface = function getInterface() {
      return this;
    }

    // return empty object
    ;
    _proto2.replaceInnerAppStateKey = function replaceInnerAppStateKey(sAppHash) {
      return sAppHash ? sAppHash : "";
    };
    _proto2.navigate = function navigate() {
      // Don't do anything
    };
    return NavigationServicesMock;
  }();
  _exports.NavigationServicesMock = NavigationServicesMock;
  let NavigationServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(NavigationServiceFactory, _ServiceFactory);
    function NavigationServiceFactory() {
      return _ServiceFactory.apply(this, arguments) || this;
    }
    var _proto3 = NavigationServiceFactory.prototype;
    _proto3.createInstance = function createInstance(oServiceContext) {
      const oNavigationService = sap.ushell && sap.ushell.Container ? new NavigationService(oServiceContext) : new NavigationServicesMock();
      // Wait For init
      return oNavigationService.initPromise.then(function (oService) {
        return oService;
      });
    };
    return NavigationServiceFactory;
  }(ServiceFactory);
  return NavigationServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/NavigationServiceFactory", ["sap/fe/navigation/NavigationHandler","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(t,e,n){"use strict";var r={};function i(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;a(t,e)}function a(t,e){a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,n){e.__proto__=n;return e};return a(t,e)}let o=function(e){i(n,e);function n(){return e.apply(this,arguments)||this}r.NavigationService=n;var a=n.prototype;a.init=function e(){const n=this.getContext(),r=n&&n.scopeObject;this.oNavHandler=new t(r);this.oNavHandler.setModel(r.getModel());this.initPromise=Promise.resolve(this)};a.exit=function t(){this.oNavHandler.destroy()};a.navigate=function t(e,n,r,i,a,o,s){this.oNavHandler.navigate(e,n,r,i,a,o,s)};a.parseNavigation=function t(){return this.oNavHandler.parseNavigation()};a._processBeforeSmartLinkPopoverOpens=function t(e,n,r){return this.oNavHandler.processBeforeSmartLinkPopoverOpens(e,n,r)};a.getAppStateKeyAndUrlParameters=function t(e){return this.oNavHandler._getAppStateKeyAndUrlParameters(e)};a.getTechnicalParameters=function t(){return this.oNavHandler.getTechnicalParameters()};a.setTechnicalParameters=function t(e){this.oNavHandler.setTechnicalParameters(e)};a.setModel=function t(e){this.oNavHandler.setModel(e)};a.storeInnerAppStateAsync=function t(e,n,r){return new Promise((t,i)=>this.oNavHandler.storeInnerAppStateAsync(e,n,r).then(t,i))};a.storeInnerAppStateWithImmediateReturn=function t(e,n){return this.oNavHandler.storeInnerAppStateWithImmediateReturn(e,n)};a.replaceHash=function t(e){this.oNavHandler.replaceHash(e)};a.replaceInnerAppStateKey=function t(e,n){return this.oNavHandler._replaceInnerAppStateKey(e,n)};a.getUrlParametersFromSelectionVariant=function t(e){return this.oNavHandler._getURLParametersFromSelectionVariant(e)};a.saveAppStateWithImmediateReturn=function t(e){if(e){const t=e.toJSONString(),n=JSON.parse(t),r={selectionVariant:n},i=this.oNavHandler._saveAppStateWithImmediateReturn(r);return i!==null&&i!==void 0&&i.appStateKey?i.appStateKey:""}else{return undefined}};a.mixAttributesAndSelectionVariant=function t(e,n,r){return this.oNavHandler.mixAttributesAndSelectionVariant(e,n,r)};a.constructContextUrl=function t(e,n){return this.oNavHandler.constructContextUrl(e,n)};a.getInterface=function t(){return this};return n}(e);r.NavigationService=o;function s(){return{}}function c(){return Promise.resolve({})}function u(){const t=jQuery.Deferred();t.resolve({},{},"initial");return t.promise()}function p(){return""}let l=function(){function t(){this.createEmptyAppState=s;this.storeInnerAppStateWithImmediateReturn=s;this.mixAttributesAndSelectionVariant=s;this.getAppState=c;this.getStartupAppState=c;this.parseNavigation=u;this.constructContextUrl=p;this.initPromise=Promise.resolve(this)}r.NavigationServicesMock=t;var e=t.prototype;e.getInterface=function t(){return this};e.replaceInnerAppStateKey=function t(e){return e?e:""};e.navigate=function t(){};return t}();r.NavigationServicesMock=l;let h=function(t){i(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;n.createInstance=function t(e){const n=sap.ushell&&sap.ushell.Container?new o(e):new l;return n.initPromise.then(function(t){return t})};return e}(n);return h},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/ResourceModelServiceFactory-dbg", ["sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory", "sap/ui/model/resource/ResourceModel"], function (Service, ServiceFactory, ResourceModel) {
  "use strict";

  var _exports = {};
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let ResourceModelService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(ResourceModelService, _Service);
    function ResourceModelService() {
      return _Service.apply(this, arguments) || this;
    }
    _exports.ResourceModelService = ResourceModelService;
    var _proto = ResourceModelService.prototype;
    _proto.init = function init() {
      const oContext = this.getContext();
      const mSettings = oContext.settings;
      this.oFactory = oContext.factory;

      // When enhancing i18n keys the value in the last resource bundle takes precedence
      // hence arrange various resource bundles so that enhanceI18n provided by the application is the last.
      // The following order is used :
      // 1. sap.fe bundle - sap.fe.core.messagebundle (passed with mSettings.bundles)
      // 2. sap.fe bundle - sap.fe.templates.messagebundle (passed with mSettings.bundles)
      // 3. Multiple bundles passed by the application as part of enhanceI18n
      const aBundles = mSettings.bundles.concat(mSettings.enhanceI18n || []).map(function (vI18n) {
        // if value passed for enhanceI18n is a Resource Model, return the associated bundle
        // else the value is a bundleUrl, return Resource Bundle configuration so that a bundle can be created
        return typeof vI18n.isA === "function" && vI18n.isA("sap.ui.model.resource.ResourceModel") ? vI18n.getResourceBundle() : {
          bundleName: vI18n.replace(/\//g, ".")
        };
      });
      this.oResourceModel = new ResourceModel({
        bundleName: aBundles[0].bundleName,
        enhanceWith: aBundles.slice(1),
        async: true
      });
      if (oContext.scopeType === "component") {
        const oComponent = oContext.scopeObject;
        oComponent.setModel(this.oResourceModel, mSettings.modelName);
      }
      this.initPromise = Promise.all([this.oResourceModel.getResourceBundle(), this.oResourceModel._pEnhanced || Promise.resolve()]).then(oBundle => {
        this.oResourceModel.__bundle = oBundle[0];
        return this;
      });
    };
    _proto.getResourceModel = function getResourceModel() {
      return this.oResourceModel;
    };
    _proto.getInterface = function getInterface() {
      return this;
    };
    _proto.exit = function exit() {
      // Deregister global instance
      this.oFactory.removeGlobalInstance();
    };
    return ResourceModelService;
  }(Service);
  _exports.ResourceModelService = ResourceModelService;
  let ResourceModelServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(ResourceModelServiceFactory, _ServiceFactory);
    function ResourceModelServiceFactory() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _ServiceFactory.call(this, ...args) || this;
      _this._oInstances = {};
      return _this;
    }
    var _proto2 = ResourceModelServiceFactory.prototype;
    _proto2.createInstance = function createInstance(oServiceContext) {
      const sKey = `${oServiceContext.scopeObject.getId()}_${oServiceContext.settings.bundles.join(",")}` + (oServiceContext.settings.enhanceI18n ? `,${oServiceContext.settings.enhanceI18n.join(",")}` : "");
      if (!this._oInstances[sKey]) {
        this._oInstances[sKey] = new ResourceModelService(Object.assign({
          factory: this
        }, oServiceContext));
      }
      return this._oInstances[sKey].initPromise;
    };
    _proto2.removeGlobalInstance = function removeGlobalInstance() {
      this._oInstances = {};
    };
    return ResourceModelServiceFactory;
  }(ServiceFactory);
  return ResourceModelServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/ResourceModelServiceFactory", ["sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory","sap/ui/model/resource/ResourceModel"],function(e,t,n){"use strict";var o={};function s(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;r(e,t)}function r(e,t){r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return r(e,t)}let c=function(e){s(t,e);function t(){return e.apply(this,arguments)||this}o.ResourceModelService=t;var r=t.prototype;r.init=function e(){const t=this.getContext();const o=t.settings;this.oFactory=t.factory;const s=o.bundles.concat(o.enhanceI18n||[]).map(function(e){return typeof e.isA==="function"&&e.isA("sap.ui.model.resource.ResourceModel")?e.getResourceBundle():{bundleName:e.replace(/\//g,".")}});this.oResourceModel=new n({bundleName:s[0].bundleName,enhanceWith:s.slice(1),async:true});if(t.scopeType==="component"){const e=t.scopeObject;e.setModel(this.oResourceModel,o.modelName)}this.initPromise=Promise.all([this.oResourceModel.getResourceBundle(),this.oResourceModel._pEnhanced||Promise.resolve()]).then(e=>{this.oResourceModel.__bundle=e[0];return this})};r.getResourceModel=function e(){return this.oResourceModel};r.getInterface=function e(){return this};r.exit=function e(){this.oFactory.removeGlobalInstance()};return t}(e);o.ResourceModelService=c;let i=function(e){s(t,e);function t(){var t;for(var n=arguments.length,o=new Array(n),s=0;s<n;s++){o[s]=arguments[s]}t=e.call(this,...o)||this;t._oInstances={};return t}var n=t.prototype;n.createInstance=function e(t){const n=`${t.scopeObject.getId()}_${t.settings.bundles.join(",")}`+(t.settings.enhanceI18n?`,${t.settings.enhanceI18n.join(",")}`:"");if(!this._oInstances[n]){this._oInstances[n]=new c(Object.assign({factory:this},t))}return this._oInstances[n].initPromise};n.removeGlobalInstance=function e(){this._oInstances={}};return t}(t);return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/RoutingServiceFactory-dbg", ["sap/base/Log", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/controllerextensions/messageHandler/messageHandling", "sap/fe/core/controllerextensions/Placeholder", "sap/fe/core/controllerextensions/routing/NavigationReason", "sap/fe/core/helpers/AppStartupHelper", "sap/fe/core/helpers/ClassSupport", "sap/fe/core/helpers/EditState", "sap/fe/core/helpers/ModelHelper", "sap/fe/core/helpers/SemanticKeyHelper", "sap/suite/ui/commons/collaboration/CollaborationHelper", "sap/ui/base/BindingParser", "sap/ui/base/EventProvider", "sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory", "sap/ui/model/odata/v4/ODataUtils"], function (Log, BusyLocker, messageHandling, Placeholder, NavigationReason, AppStartupHelper, ClassSupport, EditState, ModelHelper, SemanticKeyHelper, CollaborationHelper, BindingParser, EventProvider, Service, ServiceFactory, ODataUtils) {
  "use strict";

  var _dec, _dec2, _dec3, _class, _class2, _descriptor, _descriptor2;
  var _exports = {};
  var event = ClassSupport.event;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let RoutingServiceEventing = (_dec = defineUI5Class("sap.fe.core.services.RoutingServiceEventing"), _dec2 = event(), _dec3 = event(), _dec(_class = (_class2 = /*#__PURE__*/function (_EventProvider) {
    _inheritsLoose(RoutingServiceEventing, _EventProvider);
    function RoutingServiceEventing() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _EventProvider.call(this, ...args) || this;
      _initializerDefineProperty(_this, "routeMatched", _descriptor, _assertThisInitialized(_this));
      _initializerDefineProperty(_this, "afterRouteMatched", _descriptor2, _assertThisInitialized(_this));
      return _this;
    }
    return RoutingServiceEventing;
  }(EventProvider), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "routeMatched", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "afterRouteMatched", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  let RoutingService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(RoutingService, _Service);
    function RoutingService() {
      var _this2;
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      _this2 = _Service.call(this, ...args) || this;
      _this2.navigationInfoQueue = [];
      return _this2;
    }
    _exports.RoutingService = RoutingService;
    var _proto = RoutingService.prototype;
    _proto.init = function init() {
      const oContext = this.getContext();
      if (oContext.scopeType === "component") {
        var _oAppConfig$crossNavi;
        this.oAppComponent = oContext.scopeObject;
        this.oModel = this.oAppComponent.getModel();
        this.oMetaModel = this.oModel.getMetaModel();
        this.oRouter = this.oAppComponent.getRouter();
        this.oRouterProxy = this.oAppComponent.getRouterProxy();
        this.eventProvider = new RoutingServiceEventing();
        const oRoutingConfig = this.oAppComponent.getManifestEntry("sap.ui5").routing;
        this._parseRoutingConfiguration(oRoutingConfig);
        const oAppConfig = this.oAppComponent.getManifestEntry("sap.app");
        this.outbounds = (_oAppConfig$crossNavi = oAppConfig.crossNavigation) === null || _oAppConfig$crossNavi === void 0 ? void 0 : _oAppConfig$crossNavi.outbounds;
      }
      this.initPromise = Promise.resolve(this);
    };
    _proto.beforeExit = function beforeExit() {
      this.oRouter.detachRouteMatched(this._fnOnRouteMatched, this);
      this.eventProvider.fireEvent("routeMatched", {});
    };
    _proto.exit = function exit() {
      this.eventProvider.destroy();
    }

    /**
     * Parse a manifest routing configuration for internal usage.
     *
     * @param oRoutingConfig The routing configuration from the manifest
     * @private
     */;
    _proto._parseRoutingConfiguration = function _parseRoutingConfiguration(oRoutingConfig) {
      var _oRoutingConfig$confi;
      const isFCL = (oRoutingConfig === null || oRoutingConfig === void 0 ? void 0 : (_oRoutingConfig$confi = oRoutingConfig.config) === null || _oRoutingConfig$confi === void 0 ? void 0 : _oRoutingConfig$confi.routerClass) === "sap.f.routing.Router";

      // Information of targets
      this._mTargets = {};
      Object.keys(oRoutingConfig.targets).forEach(sTargetName => {
        this._mTargets[sTargetName] = Object.assign({
          targetName: sTargetName
        }, oRoutingConfig.targets[sTargetName]);

        // View level for FCL cases is calculated from the target pattern
        if (this._mTargets[sTargetName].contextPattern !== undefined) {
          this._mTargets[sTargetName].viewLevel = this._getViewLevelFromPattern(this._mTargets[sTargetName].contextPattern, 0);
        }
      });

      // Information of routes
      this._mRoutes = {};
      for (const sRouteKey in oRoutingConfig.routes) {
        const oRouteManifestInfo = oRoutingConfig.routes[sRouteKey],
          aRouteTargets = Array.isArray(oRouteManifestInfo.target) ? oRouteManifestInfo.target : [oRouteManifestInfo.target],
          sRouteName = Array.isArray(oRoutingConfig.routes) ? oRouteManifestInfo.name : sRouteKey,
          sRoutePattern = oRouteManifestInfo.pattern;

        // Check route pattern: all patterns need to end with ':?query:', that we use for parameters
        if (sRoutePattern.length < 8 || sRoutePattern.indexOf(":?query:") !== sRoutePattern.length - 8) {
          Log.warning(`Pattern for route ${sRouteName} doesn't end with ':?query:' : ${sRoutePattern}`);
        }
        const iRouteLevel = this._getViewLevelFromPattern(sRoutePattern, 0);
        this._mRoutes[sRouteName] = {
          name: sRouteName,
          pattern: sRoutePattern,
          targets: aRouteTargets,
          routeLevel: iRouteLevel
        };

        // Add the parent targets in the list of targets for the route
        for (let i = 0; i < aRouteTargets.length; i++) {
          const sParentTargetName = this._mTargets[aRouteTargets[i]].parent;
          if (sParentTargetName) {
            aRouteTargets.push(sParentTargetName);
          }
        }
        if (!isFCL) {
          // View level for non-FCL cases is calculated from the route pattern
          if (this._mTargets[aRouteTargets[0]].viewLevel === undefined || this._mTargets[aRouteTargets[0]].viewLevel < iRouteLevel) {
            // There are cases when different routes point to the same target. We take the
            // largest viewLevel in that case.
            this._mTargets[aRouteTargets[0]].viewLevel = iRouteLevel;
          }

          // FCL level for non-FCL cases is equal to -1
          this._mTargets[aRouteTargets[0]].FCLLevel = -1;
        } else if (aRouteTargets.length === 1 && this._mTargets[aRouteTargets[0]].controlAggregation !== "beginColumnPages") {
          // We're in the case where there's only 1 target for the route, and it's not in the first column
          // --> this is a fullscreen column after all columns in the FCL have been used
          this._mTargets[aRouteTargets[0]].FCLLevel = 3;
        } else {
          // Other FCL cases
          aRouteTargets.forEach(sTargetName => {
            switch (this._mTargets[sTargetName].controlAggregation) {
              case "beginColumnPages":
                this._mTargets[sTargetName].FCLLevel = 0;
                break;
              case "midColumnPages":
                this._mTargets[sTargetName].FCLLevel = 1;
                break;
              default:
                this._mTargets[sTargetName].FCLLevel = 2;
            }
          });
        }
      }

      // Propagate viewLevel, contextPattern, FCLLevel and controlAggregation to parent targets
      Object.keys(this._mTargets).forEach(sTargetName => {
        while (this._mTargets[sTargetName].parent) {
          const sParentTargetName = this._mTargets[sTargetName].parent;
          this._mTargets[sParentTargetName].viewLevel = this._mTargets[sParentTargetName].viewLevel || this._mTargets[sTargetName].viewLevel;
          this._mTargets[sParentTargetName].contextPattern = this._mTargets[sParentTargetName].contextPattern || this._mTargets[sTargetName].contextPattern;
          this._mTargets[sParentTargetName].FCLLevel = this._mTargets[sParentTargetName].FCLLevel || this._mTargets[sTargetName].FCLLevel;
          this._mTargets[sParentTargetName].controlAggregation = this._mTargets[sParentTargetName].controlAggregation || this._mTargets[sTargetName].controlAggregation;
          sTargetName = sParentTargetName;
        }
      });

      // Determine the root entity for the app
      const aLevel0RouteNames = [];
      const aLevel1RouteNames = [];
      let sDefaultRouteName;
      for (const sName in this._mRoutes) {
        const iLevel = this._mRoutes[sName].routeLevel;
        if (iLevel === 0) {
          aLevel0RouteNames.push(sName);
        } else if (iLevel === 1) {
          aLevel1RouteNames.push(sName);
        }
      }
      if (aLevel0RouteNames.length === 1) {
        sDefaultRouteName = aLevel0RouteNames[0];
      } else if (aLevel1RouteNames.length === 1) {
        sDefaultRouteName = aLevel1RouteNames[0];
      }
      if (sDefaultRouteName) {
        const sDefaultTargetName = this._mRoutes[sDefaultRouteName].targets.slice(-1)[0];
        this.sContextPath = "";
        if (this._mTargets[sDefaultTargetName].options && this._mTargets[sDefaultTargetName].options.settings) {
          const oSettings = this._mTargets[sDefaultTargetName].options.settings;
          this.sContextPath = oSettings.contextPath || `/${oSettings.entitySet}`;
        }
        if (!this.sContextPath) {
          Log.warning(`Cannot determine default contextPath: contextPath or entitySet missing in default target: ${sDefaultTargetName}`);
        }
      } else {
        Log.warning("Cannot determine default contextPath: no default route found.");
      }

      // We need to establish the correct path to the different pages, including the navigation properties
      Object.keys(this._mTargets).map(sTargetKey => {
        return this._mTargets[sTargetKey];
      }).sort((a, b) => {
        return a.viewLevel < b.viewLevel ? -1 : 1;
      }).forEach(target => {
        // After sorting the targets per level we can then go through their navigation object and update the paths accordingly.
        if (target.options) {
          const settings = target.options.settings;
          const sContextPath = settings.contextPath || (settings.entitySet ? `/${settings.entitySet}` : "");
          if (!settings.fullContextPath && sContextPath) {
            settings.fullContextPath = `${sContextPath}/`;
          }
          Object.keys(settings.navigation || {}).forEach(sNavName => {
            // Check if it's a navigation property
            const targetRoute = this._mRoutes[settings.navigation[sNavName].detail.route];
            if (targetRoute && targetRoute.targets) {
              targetRoute.targets.forEach(sTargetName => {
                if (this._mTargets[sTargetName].options && this._mTargets[sTargetName].options.settings && !this._mTargets[sTargetName].options.settings.fullContextPath) {
                  if (target.viewLevel === 0) {
                    this._mTargets[sTargetName].options.settings.fullContextPath = `${(sNavName.startsWith("/") ? "" : "/") + sNavName}/`;
                  } else {
                    this._mTargets[sTargetName].options.settings.fullContextPath = `${settings.fullContextPath + sNavName}/`;
                  }
                }
              });
            }
          });
        }
      });
    }

    /**
     * Calculates a view level from a pattern by counting the number of segments.
     *
     * @param sPattern The pattern
     * @param viewLevel The current level of view
     * @returns The level
     */;
    _proto._getViewLevelFromPattern = function _getViewLevelFromPattern(sPattern, viewLevel) {
      sPattern = sPattern.replace(":?query:", "");
      const regex = new RegExp("/[^/]*$");
      if (sPattern && sPattern[0] !== "/" && sPattern[0] !== "?") {
        sPattern = `/${sPattern}`;
      }
      if (sPattern.length) {
        sPattern = sPattern.replace(regex, "");
        if (this.oRouter.match(sPattern) || sPattern === "") {
          return this._getViewLevelFromPattern(sPattern, ++viewLevel);
        } else {
          return this._getViewLevelFromPattern(sPattern, viewLevel);
        }
      } else {
        return viewLevel;
      }
    };
    _proto._getRouteInformation = function _getRouteInformation(sRouteName) {
      return this._mRoutes[sRouteName];
    };
    _proto._getTargetInformation = function _getTargetInformation(sTargetName) {
      return this._mTargets[sTargetName];
    };
    _proto._getComponentId = function _getComponentId(sOwnerId, sComponentId) {
      if (sComponentId.indexOf(`${sOwnerId}---`) === 0) {
        return sComponentId.substr(sOwnerId.length + 3);
      }
      return sComponentId;
    }

    /**
     * Get target information for a given component.
     *
     * @param oComponentInstance Instance of the component
     * @returns The configuration for the target
     */;
    _proto.getTargetInformationFor = function getTargetInformationFor(oComponentInstance) {
      const sTargetComponentId = this._getComponentId(oComponentInstance._sOwnerId, oComponentInstance.getId());
      let sCorrectTargetName = null;
      Object.keys(this._mTargets).forEach(sTargetName => {
        if (this._mTargets[sTargetName].id === sTargetComponentId || this._mTargets[sTargetName].viewId === sTargetComponentId) {
          sCorrectTargetName = sTargetName;
        }
      });
      return this._getTargetInformation(sCorrectTargetName);
    };
    _proto.getLastSemanticMapping = function getLastSemanticMapping() {
      return this.oLastSemanticMapping;
    };
    _proto.setLastSemanticMapping = function setLastSemanticMapping(oMapping) {
      this.oLastSemanticMapping = oMapping;
    };
    _proto.navigateTo = function navigateTo(oContext, sRouteName, mParameterMapping, bPreserveHistory) {
      let sTargetURLPromise, bIsStickyMode;
      if (oContext.getModel() && oContext.getModel().getMetaModel && oContext.getModel().getMetaModel()) {
        bIsStickyMode = ModelHelper.isStickySessionSupported(oContext.getModel().getMetaModel());
      }
      if (!mParameterMapping) {
        // if there is no parameter mapping define this mean we rely entirely on the binding context path
        sTargetURLPromise = Promise.resolve(SemanticKeyHelper.getSemanticPath(oContext));
      } else {
        sTargetURLPromise = this.prepareParameters(mParameterMapping, sRouteName, oContext).then(mParameters => {
          return this.oRouter.getURL(sRouteName, mParameters);
        });
      }
      return sTargetURLPromise.then(sTargetURL => {
        this.oRouterProxy.navToHash(sTargetURL, bPreserveHistory, false, false, !bIsStickyMode);
      });
    }

    /**
     * Method to return a map of routing target parameters where the binding syntax is resolved to the current model.
     *
     * @param mParameters Parameters map in the format [k: string] : ComplexBindingSyntax
     * @param sTargetRoute Name of the target route
     * @param oContext The instance of the binding context
     * @returns A promise which resolves to the routing target parameters
     */;
    _proto.prepareParameters = function prepareParameters(mParameters, sTargetRoute, oContext) {
      let oParametersPromise;
      try {
        const sContextPath = oContext.getPath();
        const oMetaModel = oContext.getModel().getMetaModel();
        const aContextPathParts = sContextPath.split("/");
        const aAllResolvedParameterPromises = Object.keys(mParameters).map(sParameterKey => {
          const sParameterMappingExpression = mParameters[sParameterKey];
          // We assume the defined parameters will be compatible with a binding expression
          const oParsedExpression = BindingParser.complexParser(sParameterMappingExpression);
          const aParts = oParsedExpression.parts || [oParsedExpression];
          const aResolvedParameterPromises = aParts.map(function (oPathPart) {
            const aRelativeParts = oPathPart.path.split("../");
            // We go up the current context path as many times as necessary
            const aLocalParts = aContextPathParts.slice(0, aContextPathParts.length - aRelativeParts.length + 1);
            aLocalParts.push(aRelativeParts[aRelativeParts.length - 1]);
            const sPropertyPath = aLocalParts.join("/");
            const oMetaContext = oMetaModel.getMetaContext(sPropertyPath);
            return oContext.requestProperty(sPropertyPath).then(function (oValue) {
              const oPropertyInfo = oMetaContext.getObject();
              const sEdmType = oPropertyInfo.$Type;
              return ODataUtils.formatLiteral(oValue, sEdmType);
            });
          });
          return Promise.all(aResolvedParameterPromises).then(aResolvedParameters => {
            const value = oParsedExpression.formatter ? oParsedExpression.formatter.apply(this, aResolvedParameters) : aResolvedParameters.join("");
            return {
              key: sParameterKey,
              value: value
            };
          });
        });
        oParametersPromise = Promise.all(aAllResolvedParameterPromises).then(function (aAllResolvedParameters) {
          const oParameters = {};
          aAllResolvedParameters.forEach(function (oResolvedParameter) {
            oParameters[oResolvedParameter.key] = oResolvedParameter.value;
          });
          return oParameters;
        });
      } catch (oError) {
        Log.error(`Could not parse the parameters for the navigation to route ${sTargetRoute}`);
        oParametersPromise = Promise.resolve(undefined);
      }
      return oParametersPromise;
    };
    _proto._fireRouteMatchEvents = function _fireRouteMatchEvents(mParameters) {
      this.eventProvider.fireEvent("routeMatched", mParameters);
      this.eventProvider.fireEvent("afterRouteMatched", mParameters);
      EditState.cleanProcessedEditState(); // Reset UI state when all bindings have been refreshed
    }

    /**
     * Navigates to a context.
     *
     * @param oContext The Context to be navigated to
     * @param [mParameters] Optional, map containing the following attributes:
     * @param [mParameters.checkNoHashChange] Navigate to the context without changing the URL
     * @param [mParameters.asyncContext] The context is created async, navigate to (...) and
     *                    wait for Promise to be resolved and then navigate into the context
     * @param [mParameters.bDeferredContext] The context shall be created deferred at the target page
     * @param [mParameters.editable] The target page shall be immediately in the edit mode to avoid flickering
     * @param [mParameters.bPersistOPScroll] The bPersistOPScroll will be used for scrolling to first tab
     * @param [mParameters.updateFCLLevel] `+1` if we add a column in FCL, `-1` to remove a column, 0 to stay on the same column
     * @param [mParameters.noPreservationCache] Do navigation without taking into account the preserved cache mechanism
     * @param [mParameters.bRecreateContext] Force re-creation of the context instead of using the one passed as parameter
     * @param [mParameters.bForceFocus] Forces focus selection after navigation
     * @param [oViewData] View data
     * @param [oCurrentTargetInfo] The target information from which the navigation is triggered
     * @returns Promise which is resolved once the navigation is triggered
     * @ui5-restricted
     * @final
     */;
    _proto.navigateToContext = function navigateToContext(oContext, mParameters, oViewData, oCurrentTargetInfo) {
      let sTargetRoute = "",
        oRouteParametersPromise,
        bIsStickyMode = false;
      if (oContext.getModel() && oContext.getModel().getMetaModel) {
        bIsStickyMode = ModelHelper.isStickySessionSupported(oContext.getModel().getMetaModel());
      }
      // Manage parameter mapping
      if (mParameters && mParameters.targetPath && oViewData && oViewData.navigation) {
        const oRouteDetail = oViewData.navigation[mParameters.targetPath].detail;
        sTargetRoute = oRouteDetail.route;
        if (oRouteDetail.parameters) {
          oRouteParametersPromise = this.prepareParameters(oRouteDetail.parameters, sTargetRoute, oContext);
        }
      }
      let sTargetPath = this._getPathFromContext(oContext, mParameters);
      // If the path is empty, we're supposed to navigate to the first page of the app
      // Check if we need to exit from the app instead
      if (sTargetPath.length === 0 && this.bExitOnNavigateBackToRoot) {
        this.oRouterProxy.exitFromApp();
        return Promise.resolve(true);
      }

      // If the context is deferred or async, we add (...) to the path
      if (mParameters !== null && mParameters !== void 0 && mParameters.asyncContext || mParameters !== null && mParameters !== void 0 && mParameters.bDeferredContext) {
        sTargetPath += "(...)";
      }

      // Add layout parameter if needed
      const sLayout = this._calculateLayout(sTargetPath, mParameters);
      if (sLayout) {
        sTargetPath += `?layout=${sLayout}`;
      }

      // Navigation parameters for later usage
      const oNavigationInfo = {
        oAsyncContext: mParameters === null || mParameters === void 0 ? void 0 : mParameters.asyncContext,
        bDeferredContext: mParameters === null || mParameters === void 0 ? void 0 : mParameters.bDeferredContext,
        bTargetEditable: mParameters === null || mParameters === void 0 ? void 0 : mParameters.editable,
        bPersistOPScroll: mParameters === null || mParameters === void 0 ? void 0 : mParameters.bPersistOPScroll,
        useContext: (mParameters === null || mParameters === void 0 ? void 0 : mParameters.updateFCLLevel) === -1 || mParameters !== null && mParameters !== void 0 && mParameters.bRecreateContext ? undefined : oContext,
        bDraftNavigation: mParameters === null || mParameters === void 0 ? void 0 : mParameters.bDraftNavigation,
        bShowPlaceholder: (mParameters === null || mParameters === void 0 ? void 0 : mParameters.showPlaceholder) !== undefined ? mParameters === null || mParameters === void 0 ? void 0 : mParameters.showPlaceholder : true,
        reason: mParameters === null || mParameters === void 0 ? void 0 : mParameters.reason
      };
      if (mParameters !== null && mParameters !== void 0 && mParameters.checkNoHashChange) {
        // Check if the new hash is different from the current one
        const sCurrentHashNoAppState = this.oRouterProxy.getHash().replace(/[&?]{1}sap-iapp-state=[A-Z0-9]+/, "");
        if (sTargetPath === sCurrentHashNoAppState) {
          // The hash doesn't change, but we fire the routeMatch event to trigger page refresh / binding
          const mEventParameters = this.oRouter.getRouteInfoByHash(this.oRouterProxy.getHash());
          if (mEventParameters) {
            mEventParameters.navigationInfo = oNavigationInfo;
            mEventParameters.routeInformation = this._getRouteInformation(this.sCurrentRouteName);
            mEventParameters.routePattern = this.sCurrentRoutePattern;
            mEventParameters.views = this.aCurrentViews;
          }
          this.oRouterProxy.setFocusForced(!!mParameters.bForceFocus);
          this._fireRouteMatchEvents(mEventParameters);
          return Promise.resolve(true);
        }
      }
      if (mParameters !== null && mParameters !== void 0 && mParameters.transient && mParameters.editable == true && sTargetPath.indexOf("(...)") === -1) {
        if (sTargetPath.indexOf("?") > -1) {
          sTargetPath += "&i-action=create";
        } else {
          sTargetPath += "?i-action=create";
        }
      }

      // Clear unbound messages upon navigating from LR to OP
      // This is to ensure stale error messages from LR are not shown to the user after navigation to OP.
      if (oCurrentTargetInfo && oCurrentTargetInfo.name === "sap.fe.templates.ListReport") {
        const oRouteInfo = this.oRouter.getRouteInfoByHash(sTargetPath);
        if (oRouteInfo) {
          const oRoute = this._getRouteInformation(oRouteInfo.name);
          if (oRoute && oRoute.targets && oRoute.targets.length > 0) {
            const sLastTargetName = oRoute.targets[oRoute.targets.length - 1];
            const oTarget = this._getTargetInformation(sLastTargetName);
            if (oTarget && oTarget.name === "sap.fe.templates.ObjectPage") {
              messageHandling.removeUnboundTransitionMessages();
            }
          }
        }
      }

      // Add the navigation parameters in the queue
      this.navigationInfoQueue.push(oNavigationInfo);
      if (sTargetRoute && oRouteParametersPromise) {
        return oRouteParametersPromise.then(oRouteParameters => {
          oRouteParameters.bIsStickyMode = bIsStickyMode;
          this.oRouter.navTo(sTargetRoute, oRouteParameters);
          return Promise.resolve(true);
        });
      }
      return this.oRouterProxy.navToHash(sTargetPath, false, mParameters === null || mParameters === void 0 ? void 0 : mParameters.noPreservationCache, mParameters === null || mParameters === void 0 ? void 0 : mParameters.bForceFocus, !bIsStickyMode).then(bNavigated => {
        if (!bNavigated) {
          // The navigation did not happen --> remove the navigation parameters from the queue as they shouldn't be used
          this.navigationInfoQueue.pop();
        }
        return bNavigated;
      });
    }

    /**
     * Navigates to a route.
     *
     * @function
     * @name sap.fe.core.controllerextensions.Routing#navigateToRoute
     * @memberof sap.fe.core.controllerextensions.Routing
     * @static
     * @param sTargetRouteName Name of the target route
     * @param [oRouteParameters] Parameters to be used with route to create the target hash
     * @returns Promise that is resolved when the navigation is finalized
     * @ui5-restricted
     * @final
     */;
    _proto.navigateToRoute = function navigateToRoute(sTargetRouteName, oRouteParameters) {
      const sTargetURL = this.oRouter.getURL(sTargetRouteName, oRouteParameters);
      return this.oRouterProxy.navToHash(sTargetURL, undefined, undefined, undefined, !oRouteParameters.bIsStickyMode);
    }

    /**
     * Checks if one of the current views on the screen is bound to a given context.
     *
     * @param oContext The context
     * @returns `true` or `false` if the current state is impacted or not
     */;
    _proto.isCurrentStateImpactedBy = function isCurrentStateImpactedBy(oContext) {
      const sPath = oContext.getPath();

      // First, check with the technical path. We have to try it, because for level > 1, we
      // uses technical keys even if Semantic keys are enabled
      if (this.oRouterProxy.isCurrentStateImpactedBy(sPath)) {
        return true;
      } else if (/^[^\(\)]+\([^\(\)]+\)$/.test(sPath)) {
        // If the current path can be semantic (i.e. is like xxx(yyy))
        // check with the semantic path if we can find it
        let sSemanticPath;
        if (this.oLastSemanticMapping && this.oLastSemanticMapping.technicalPath === sPath) {
          // We have already resolved this semantic path
          sSemanticPath = this.oLastSemanticMapping.semanticPath;
        } else {
          sSemanticPath = SemanticKeyHelper.getSemanticPath(oContext);
        }
        return sSemanticPath != sPath ? this.oRouterProxy.isCurrentStateImpactedBy(sSemanticPath) : false;
      } else {
        return false;
      }
    };
    _proto._findPathToNavigate = function _findPathToNavigate(sPath) {
      const regex = new RegExp("/[^/]*$");
      sPath = sPath.replace(regex, "");
      if (this.oRouter.match(sPath) || sPath === "") {
        return sPath;
      } else {
        return this._findPathToNavigate(sPath);
      }
    };
    _proto._checkIfContextSupportsSemanticPath = function _checkIfContextSupportsSemanticPath(oContext) {
      const sPath = oContext.getPath();

      // First, check if this is a level-1 object (path = /aaa(bbb))
      if (!/^\/[^\(]+\([^\)]+\)$/.test(sPath)) {
        return false;
      }

      // Then check if the entity has semantic keys
      const oMetaModel = oContext.getModel().getMetaModel();
      const sEntitySetName = oMetaModel.getMetaContext(oContext.getPath()).getObject("@sapui.name");
      if (!SemanticKeyHelper.getSemanticKeys(oMetaModel, sEntitySetName)) {
        return false;
      }

      // Then check the entity is draft-enabled
      return ModelHelper.isDraftSupported(oMetaModel, sPath);
    };
    _proto._getPathFromContext = function _getPathFromContext(oContext, mParameters) {
      let sPath;
      if (oContext.isA("sap.ui.model.odata.v4.ODataListBinding") && oContext.isRelative()) {
        sPath = oContext.getHeaderContext().getPath();
      } else {
        sPath = oContext.getPath();
      }
      if (mParameters.updateFCLLevel === -1) {
        // When navigating back from a context, we need to remove the last component of the path
        sPath = this._findPathToNavigate(sPath);

        // Check if we're navigating back to a semantic path that was previously resolved
        if (this.oLastSemanticMapping && this.oLastSemanticMapping.technicalPath === sPath) {
          sPath = this.oLastSemanticMapping.semanticPath;
        }
      } else if (this._checkIfContextSupportsSemanticPath(oContext)) {
        // We check if we have to use a semantic path
        const sSemanticPath = SemanticKeyHelper.getSemanticPath(oContext, true);
        if (!sSemanticPath) {
          // We were not able to build the semantic path --> Use the technical path and
          // clear the previous mapping, otherwise the old mapping is used in EditFlow#updateDocument
          // and it leads to unwanted page reloads
          this.setLastSemanticMapping(undefined);
        } else if (sSemanticPath !== sPath) {
          // Store the mapping technical <-> semantic path to avoid recalculating it later
          // and use the semantic path instead of the technical one
          this.setLastSemanticMapping({
            technicalPath: sPath,
            semanticPath: sSemanticPath
          });
          sPath = sSemanticPath;
        }
      }

      // remove extra '/' at the beginning of path
      if (sPath[0] === "/") {
        sPath = sPath.substring(1);
      }
      return sPath;
    };
    _proto._calculateLayout = function _calculateLayout(sPath, mParameters) {
      let FCLLevel = mParameters.FCLLevel;
      if (mParameters.updateFCLLevel) {
        FCLLevel += mParameters.updateFCLLevel;
        if (FCLLevel < 0) {
          FCLLevel = 0;
        }
      }
      return this.oAppComponent.getRootViewController().calculateLayout(FCLLevel, sPath, mParameters.sLayout, mParameters.keepCurrentLayout);
    }

    /**
     * Event handler before a route is matched.
     * Displays a busy indicator.
     *
     */;
    _proto._beforeRouteMatched = function _beforeRouteMatched( /*oEvent: Event*/
    ) {
      const bPlaceholderEnabled = new Placeholder().isPlaceholderEnabled();
      if (!bPlaceholderEnabled) {
        const oRootView = this.oAppComponent.getRootControl();
        BusyLocker.lock(oRootView);
      }
    }

    /**
     * Event handler when a route is matched.
     * Hides the busy indicator and fires its own 'routematched' event.
     *
     * @param oEvent The event
     */;
    _proto._onRouteMatched = function _onRouteMatched(oEvent) {
      const oAppStateHandler = this.oAppComponent.getAppStateHandler(),
        oRootView = this.oAppComponent.getRootControl();
      const bPlaceholderEnabled = new Placeholder().isPlaceholderEnabled();
      if (BusyLocker.isLocked(oRootView) && !bPlaceholderEnabled) {
        BusyLocker.unlock(oRootView);
      }
      const mParameters = oEvent.getParameters();
      if (this.navigationInfoQueue.length) {
        mParameters.navigationInfo = this.navigationInfoQueue[0];
        this.navigationInfoQueue = this.navigationInfoQueue.slice(1);
      } else {
        mParameters.navigationInfo = {};
      }
      if (oAppStateHandler.checkIfRouteChangedByIApp()) {
        mParameters.navigationInfo.reason = NavigationReason.AppStateChanged;
        oAppStateHandler.resetRouteChangedByIApp();
      }
      this.sCurrentRouteName = oEvent.getParameter("name");
      this.sCurrentRoutePattern = mParameters.config.pattern;
      this.aCurrentViews = oEvent.getParameter("views");
      mParameters.routeInformation = this._getRouteInformation(this.sCurrentRouteName);
      mParameters.routePattern = this.sCurrentRoutePattern;
      this._fireRouteMatchEvents(mParameters);

      // Check if current hash has been set by the routerProxy.navToHash function
      // If not, rebuild history properly (both in the browser and the RouterProxy)
      if (!history.state || history.state.feLevel === undefined) {
        this.oRouterProxy.restoreHistory().then(() => {
          this.oRouterProxy.resolveRouteMatch();
        }).catch(function (oError) {
          Log.error("Error while restoring history", oError);
        });
      } else {
        this.oRouterProxy.resolveRouteMatch();
      }
    };
    _proto.attachRouteMatched = function attachRouteMatched(oData, fnFunction, oListener) {
      this.eventProvider.attachEvent("routeMatched", oData, fnFunction, oListener);
    };
    _proto.detachRouteMatched = function detachRouteMatched(fnFunction, oListener) {
      this.eventProvider.detachEvent("routeMatched", fnFunction, oListener);
    };
    _proto.attachAfterRouteMatched = function attachAfterRouteMatched(oData, fnFunction, oListener) {
      this.eventProvider.attachEvent("afterRouteMatched", oData, fnFunction, oListener);
    };
    _proto.detachAfterRouteMatched = function detachAfterRouteMatched(fnFunction, oListener) {
      this.eventProvider.detachEvent("afterRouteMatched", fnFunction, oListener);
    };
    _proto.getRouteFromHash = function getRouteFromHash(oRouter, oAppComponent) {
      const sHash = oRouter.getHashChanger().hash;
      const oRouteInfo = oRouter.getRouteInfoByHash(sHash);
      return oAppComponent.getMetadata().getManifestEntry("/sap.ui5/routing/routes").filter(function (oRoute) {
        return oRoute.name === oRouteInfo.name;
      })[0];
    };
    _proto.getTargetsFromRoute = function getTargetsFromRoute(oRoute) {
      const oTarget = oRoute.target;
      if (typeof oTarget === "string") {
        return [this._mTargets[oTarget]];
      } else {
        const aTarget = [];
        oTarget.forEach(sTarget => {
          aTarget.push(this._mTargets[sTarget]);
        });
        return aTarget;
      }
    };
    _proto.initializeRouting = async function initializeRouting() {
      // Attach router handlers
      await CollaborationHelper.processAndExpandHash();
      this._fnOnRouteMatched = this._onRouteMatched.bind(this);
      this.oRouter.attachRouteMatched(this._fnOnRouteMatched, this);
      const bPlaceholderEnabled = new Placeholder().isPlaceholderEnabled();
      if (!bPlaceholderEnabled) {
        this.oRouter.attachBeforeRouteMatched(this._beforeRouteMatched.bind(this));
      }
      // Reset internal state
      this.navigationInfoQueue = [];
      EditState.resetEditState();
      this.bExitOnNavigateBackToRoot = !this.oRouter.match("");
      const bIsIappState = this.oRouter.getHashChanger().getHash().indexOf("sap-iapp-state") !== -1;
      try {
        const oStartupParameters = await this.oAppComponent.getStartupParameters();
        const bHasStartUpParameters = oStartupParameters !== undefined && Object.keys(oStartupParameters).length !== 0;
        const sHash = this.oRouter.getHashChanger().getHash();
        // Manage startup parameters (in case of no iapp-state)
        if (!bIsIappState && bHasStartUpParameters && !sHash) {
          if (oStartupParameters.preferredMode && oStartupParameters.preferredMode[0].toUpperCase().indexOf("CREATE") !== -1) {
            // Create mode
            // This check will catch multiple modes like create, createWith and autoCreateWith which all need
            // to be handled like create startup!
            await this._manageCreateStartup(oStartupParameters);
          } else {
            // Deep link
            await this._manageDeepLinkStartup(oStartupParameters);
          }
        }
      } catch (oError) {
        Log.error("Error during routing initialization", oError);
      }
    };
    _proto.getDefaultCreateHash = function getDefaultCreateHash(oStartupParameters) {
      return AppStartupHelper.getDefaultCreateHash(oStartupParameters, this.getContextPath(), this.oRouter);
    };
    _proto._manageCreateStartup = function _manageCreateStartup(oStartupParameters) {
      return AppStartupHelper.getCreateStartupHash(oStartupParameters, this.getContextPath(), this.oRouter, this.oMetaModel).then(sNewHash => {
        if (sNewHash) {
          this.oRouter.getHashChanger().replaceHash(sNewHash);
          if (oStartupParameters !== null && oStartupParameters !== void 0 && oStartupParameters.preferredMode && oStartupParameters.preferredMode[0].toUpperCase().indexOf("AUTOCREATE") !== -1) {
            this.oAppComponent.setStartupModeAutoCreate();
          } else {
            this.oAppComponent.setStartupModeCreate();
          }
          this.bExitOnNavigateBackToRoot = true;
        }
      });
    };
    _proto._manageDeepLinkStartup = function _manageDeepLinkStartup(oStartupParameters) {
      return AppStartupHelper.getDeepLinkStartupHash(this.oAppComponent.getManifest()["sap.ui5"].routing, oStartupParameters, this.oModel).then(oDeepLink => {
        let sHash;
        if (oDeepLink.context) {
          const sTechnicalPath = oDeepLink.context.getPath();
          const sSemanticPath = this._checkIfContextSupportsSemanticPath(oDeepLink.context) ? SemanticKeyHelper.getSemanticPath(oDeepLink.context) : sTechnicalPath;
          if (sSemanticPath !== sTechnicalPath) {
            // Store the mapping technical <-> semantic path to avoid recalculating it later
            // and use the semantic path instead of the technical one
            this.setLastSemanticMapping({
              technicalPath: sTechnicalPath,
              semanticPath: sSemanticPath
            });
          }
          sHash = sSemanticPath.substring(1); // To remove the leading '/'
        } else if (oDeepLink.hash) {
          sHash = oDeepLink.hash;
        }
        if (sHash) {
          //Replace the hash with newly created hash
          this.oRouter.getHashChanger().replaceHash(sHash);
          this.oAppComponent.setStartupModeDeeplink();
        }
      });
    };
    _proto.getOutbounds = function getOutbounds() {
      return this.outbounds;
    }

    /**
     * Gets the name of the Draft root entity set or the sticky-enabled entity set.
     *
     * @returns The name of the root EntitySet
     * @ui5-restricted
     */;
    _proto.getContextPath = function getContextPath() {
      return this.sContextPath;
    };
    _proto.getInterface = function getInterface() {
      return this;
    };
    return RoutingService;
  }(Service);
  _exports.RoutingService = RoutingService;
  let RoutingServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(RoutingServiceFactory, _ServiceFactory);
    function RoutingServiceFactory() {
      return _ServiceFactory.apply(this, arguments) || this;
    }
    var _proto2 = RoutingServiceFactory.prototype;
    _proto2.createInstance = function createInstance(oServiceContext) {
      const oRoutingService = new RoutingService(oServiceContext);
      return oRoutingService.initPromise;
    };
    return RoutingServiceFactory;
  }(ServiceFactory);
  return RoutingServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/RoutingServiceFactory", ["sap/base/Log","sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/controllerextensions/messageHandler/messageHandling","sap/fe/core/controllerextensions/Placeholder","sap/fe/core/controllerextensions/routing/NavigationReason","sap/fe/core/helpers/AppStartupHelper","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/EditState","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SemanticKeyHelper","sap/suite/ui/commons/collaboration/CollaborationHelper","sap/ui/base/BindingParser","sap/ui/base/EventProvider","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory","sap/ui/model/odata/v4/ODataUtils"],function(t,e,o,n,i,r,a,s,u,h,c,l,g,f,p,d){"use strict";var m,v,P,C,R,_,M;var y={};var b=a.event;var x=a.defineUI5Class;function L(t,e,o,n){if(!o)return;Object.defineProperty(t,e,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function T(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function S(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;w(t,e)}function w(t,e){w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,o){e.__proto__=o;return e};return w(t,e)}function E(t,e,o,n,i){var r={};Object.keys(n).forEach(function(t){r[t]=n[t]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=o.slice().reverse().reduce(function(o,n){return n(t,e,o)||o},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(t,e,r);r=null}return r}function I(t,e){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let A=(m=x("sap.fe.core.services.RoutingServiceEventing"),v=b(),P=b(),m(C=(R=function(t){S(e,t);function e(){var e;for(var o=arguments.length,n=new Array(o),i=0;i<o;i++){n[i]=arguments[i]}e=t.call(this,...n)||this;L(e,"routeMatched",_,T(e));L(e,"afterRouteMatched",M,T(e));return e}return e}(g),_=E(R.prototype,"routeMatched",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),M=E(R.prototype,"afterRouteMatched",[P],{configurable:true,enumerable:true,writable:true,initializer:null}),R))||C);let O=function(a){S(g,a);function g(){var t;for(var e=arguments.length,o=new Array(e),n=0;n<e;n++){o[n]=arguments[n]}t=a.call(this,...o)||this;t.navigationInfoQueue=[];return t}y.RoutingService=g;var f=g.prototype;f.init=function t(){const e=this.getContext();if(e.scopeType==="component"){var o;this.oAppComponent=e.scopeObject;this.oModel=this.oAppComponent.getModel();this.oMetaModel=this.oModel.getMetaModel();this.oRouter=this.oAppComponent.getRouter();this.oRouterProxy=this.oAppComponent.getRouterProxy();this.eventProvider=new A;const t=this.oAppComponent.getManifestEntry("sap.ui5").routing;this._parseRoutingConfiguration(t);const n=this.oAppComponent.getManifestEntry("sap.app");this.outbounds=(o=n.crossNavigation)===null||o===void 0?void 0:o.outbounds}this.initPromise=Promise.resolve(this)};f.beforeExit=function t(){this.oRouter.detachRouteMatched(this._fnOnRouteMatched,this);this.eventProvider.fireEvent("routeMatched",{})};f.exit=function t(){this.eventProvider.destroy()};f._parseRoutingConfiguration=function e(o){var n;const i=(o===null||o===void 0?void 0:(n=o.config)===null||n===void 0?void 0:n.routerClass)==="sap.f.routing.Router";this._mTargets={};Object.keys(o.targets).forEach(t=>{this._mTargets[t]=Object.assign({targetName:t},o.targets[t]);if(this._mTargets[t].contextPattern!==undefined){this._mTargets[t].viewLevel=this._getViewLevelFromPattern(this._mTargets[t].contextPattern,0)}});this._mRoutes={};for(const e in o.routes){const n=o.routes[e],r=Array.isArray(n.target)?n.target:[n.target],a=Array.isArray(o.routes)?n.name:e,s=n.pattern;if(s.length<8||s.indexOf(":?query:")!==s.length-8){t.warning(`Pattern for route ${a} doesn't end with ':?query:' : ${s}`)}const u=this._getViewLevelFromPattern(s,0);this._mRoutes[a]={name:a,pattern:s,targets:r,routeLevel:u};for(let t=0;t<r.length;t++){const e=this._mTargets[r[t]].parent;if(e){r.push(e)}}if(!i){if(this._mTargets[r[0]].viewLevel===undefined||this._mTargets[r[0]].viewLevel<u){this._mTargets[r[0]].viewLevel=u}this._mTargets[r[0]].FCLLevel=-1}else if(r.length===1&&this._mTargets[r[0]].controlAggregation!=="beginColumnPages"){this._mTargets[r[0]].FCLLevel=3}else{r.forEach(t=>{switch(this._mTargets[t].controlAggregation){case"beginColumnPages":this._mTargets[t].FCLLevel=0;break;case"midColumnPages":this._mTargets[t].FCLLevel=1;break;default:this._mTargets[t].FCLLevel=2}})}}Object.keys(this._mTargets).forEach(t=>{while(this._mTargets[t].parent){const e=this._mTargets[t].parent;this._mTargets[e].viewLevel=this._mTargets[e].viewLevel||this._mTargets[t].viewLevel;this._mTargets[e].contextPattern=this._mTargets[e].contextPattern||this._mTargets[t].contextPattern;this._mTargets[e].FCLLevel=this._mTargets[e].FCLLevel||this._mTargets[t].FCLLevel;this._mTargets[e].controlAggregation=this._mTargets[e].controlAggregation||this._mTargets[t].controlAggregation;t=e}});const r=[];const a=[];let s;for(const t in this._mRoutes){const e=this._mRoutes[t].routeLevel;if(e===0){r.push(t)}else if(e===1){a.push(t)}}if(r.length===1){s=r[0]}else if(a.length===1){s=a[0]}if(s){const e=this._mRoutes[s].targets.slice(-1)[0];this.sContextPath="";if(this._mTargets[e].options&&this._mTargets[e].options.settings){const t=this._mTargets[e].options.settings;this.sContextPath=t.contextPath||`/${t.entitySet}`}if(!this.sContextPath){t.warning(`Cannot determine default contextPath: contextPath or entitySet missing in default target: ${e}`)}}else{t.warning("Cannot determine default contextPath: no default route found.")}Object.keys(this._mTargets).map(t=>this._mTargets[t]).sort((t,e)=>t.viewLevel<e.viewLevel?-1:1).forEach(t=>{if(t.options){const e=t.options.settings;const o=e.contextPath||(e.entitySet?`/${e.entitySet}`:"");if(!e.fullContextPath&&o){e.fullContextPath=`${o}/`}Object.keys(e.navigation||{}).forEach(o=>{const n=this._mRoutes[e.navigation[o].detail.route];if(n&&n.targets){n.targets.forEach(n=>{if(this._mTargets[n].options&&this._mTargets[n].options.settings&&!this._mTargets[n].options.settings.fullContextPath){if(t.viewLevel===0){this._mTargets[n].options.settings.fullContextPath=`${(o.startsWith("/")?"":"/")+o}/`}else{this._mTargets[n].options.settings.fullContextPath=`${e.fullContextPath+o}/`}}})}})}})};f._getViewLevelFromPattern=function t(e,o){e=e.replace(":?query:","");const n=new RegExp("/[^/]*$");if(e&&e[0]!=="/"&&e[0]!=="?"){e=`/${e}`}if(e.length){e=e.replace(n,"");if(this.oRouter.match(e)||e===""){return this._getViewLevelFromPattern(e,++o)}else{return this._getViewLevelFromPattern(e,o)}}else{return o}};f._getRouteInformation=function t(e){return this._mRoutes[e]};f._getTargetInformation=function t(e){return this._mTargets[e]};f._getComponentId=function t(e,o){if(o.indexOf(`${e}---`)===0){return o.substr(e.length+3)}return o};f.getTargetInformationFor=function t(e){const o=this._getComponentId(e._sOwnerId,e.getId());let n=null;Object.keys(this._mTargets).forEach(t=>{if(this._mTargets[t].id===o||this._mTargets[t].viewId===o){n=t}});return this._getTargetInformation(n)};f.getLastSemanticMapping=function t(){return this.oLastSemanticMapping};f.setLastSemanticMapping=function t(e){this.oLastSemanticMapping=e};f.navigateTo=function t(e,o,n,i){let r,a;if(e.getModel()&&e.getModel().getMetaModel&&e.getModel().getMetaModel()){a=u.isStickySessionSupported(e.getModel().getMetaModel())}if(!n){r=Promise.resolve(h.getSemanticPath(e))}else{r=this.prepareParameters(n,o,e).then(t=>this.oRouter.getURL(o,t))}return r.then(t=>{this.oRouterProxy.navToHash(t,i,false,false,!a)})};f.prepareParameters=function e(o,n,i){let r;try{const t=i.getPath();const e=i.getModel().getMetaModel();const n=t.split("/");const a=Object.keys(o).map(t=>{const r=o[t];const a=l.complexParser(r);const s=a.parts||[a];const u=s.map(function(t){const o=t.path.split("../");const r=n.slice(0,n.length-o.length+1);r.push(o[o.length-1]);const a=r.join("/");const s=e.getMetaContext(a);return i.requestProperty(a).then(function(t){const e=s.getObject();const o=e.$Type;return d.formatLiteral(t,o)})});return Promise.all(u).then(e=>{const o=a.formatter?a.formatter.apply(this,e):e.join("");return{key:t,value:o}})});r=Promise.all(a).then(function(t){const e={};t.forEach(function(t){e[t.key]=t.value});return e})}catch(e){t.error(`Could not parse the parameters for the navigation to route ${n}`);r=Promise.resolve(undefined)}return r};f._fireRouteMatchEvents=function t(e){this.eventProvider.fireEvent("routeMatched",e);this.eventProvider.fireEvent("afterRouteMatched",e);s.cleanProcessedEditState()};f.navigateToContext=function t(e,n,i,r){let a="",s,h=false;if(e.getModel()&&e.getModel().getMetaModel){h=u.isStickySessionSupported(e.getModel().getMetaModel())}if(n&&n.targetPath&&i&&i.navigation){const t=i.navigation[n.targetPath].detail;a=t.route;if(t.parameters){s=this.prepareParameters(t.parameters,a,e)}}let c=this._getPathFromContext(e,n);if(c.length===0&&this.bExitOnNavigateBackToRoot){this.oRouterProxy.exitFromApp();return Promise.resolve(true)}if(n!==null&&n!==void 0&&n.asyncContext||n!==null&&n!==void 0&&n.bDeferredContext){c+="(...)"}const l=this._calculateLayout(c,n);if(l){c+=`?layout=${l}`}const g={oAsyncContext:n===null||n===void 0?void 0:n.asyncContext,bDeferredContext:n===null||n===void 0?void 0:n.bDeferredContext,bTargetEditable:n===null||n===void 0?void 0:n.editable,bPersistOPScroll:n===null||n===void 0?void 0:n.bPersistOPScroll,useContext:(n===null||n===void 0?void 0:n.updateFCLLevel)===-1||n!==null&&n!==void 0&&n.bRecreateContext?undefined:e,bDraftNavigation:n===null||n===void 0?void 0:n.bDraftNavigation,bShowPlaceholder:(n===null||n===void 0?void 0:n.showPlaceholder)!==undefined?n===null||n===void 0?void 0:n.showPlaceholder:true,reason:n===null||n===void 0?void 0:n.reason};if(n!==null&&n!==void 0&&n.checkNoHashChange){const t=this.oRouterProxy.getHash().replace(/[&?]{1}sap-iapp-state=[A-Z0-9]+/,"");if(c===t){const t=this.oRouter.getRouteInfoByHash(this.oRouterProxy.getHash());if(t){t.navigationInfo=g;t.routeInformation=this._getRouteInformation(this.sCurrentRouteName);t.routePattern=this.sCurrentRoutePattern;t.views=this.aCurrentViews}this.oRouterProxy.setFocusForced(!!n.bForceFocus);this._fireRouteMatchEvents(t);return Promise.resolve(true)}}if(n!==null&&n!==void 0&&n.transient&&n.editable==true&&c.indexOf("(...)")===-1){if(c.indexOf("?")>-1){c+="&i-action=create"}else{c+="?i-action=create"}}if(r&&r.name==="sap.fe.templates.ListReport"){const t=this.oRouter.getRouteInfoByHash(c);if(t){const e=this._getRouteInformation(t.name);if(e&&e.targets&&e.targets.length>0){const t=e.targets[e.targets.length-1];const n=this._getTargetInformation(t);if(n&&n.name==="sap.fe.templates.ObjectPage"){o.removeUnboundTransitionMessages()}}}}this.navigationInfoQueue.push(g);if(a&&s){return s.then(t=>{t.bIsStickyMode=h;this.oRouter.navTo(a,t);return Promise.resolve(true)})}return this.oRouterProxy.navToHash(c,false,n===null||n===void 0?void 0:n.noPreservationCache,n===null||n===void 0?void 0:n.bForceFocus,!h).then(t=>{if(!t){this.navigationInfoQueue.pop()}return t})};f.navigateToRoute=function t(e,o){const n=this.oRouter.getURL(e,o);return this.oRouterProxy.navToHash(n,undefined,undefined,undefined,!o.bIsStickyMode)};f.isCurrentStateImpactedBy=function t(e){const o=e.getPath();if(this.oRouterProxy.isCurrentStateImpactedBy(o)){return true}else if(/^[^\(\)]+\([^\(\)]+\)$/.test(o)){let t;if(this.oLastSemanticMapping&&this.oLastSemanticMapping.technicalPath===o){t=this.oLastSemanticMapping.semanticPath}else{t=h.getSemanticPath(e)}return t!=o?this.oRouterProxy.isCurrentStateImpactedBy(t):false}else{return false}};f._findPathToNavigate=function t(e){const o=new RegExp("/[^/]*$");e=e.replace(o,"");if(this.oRouter.match(e)||e===""){return e}else{return this._findPathToNavigate(e)}};f._checkIfContextSupportsSemanticPath=function t(e){const o=e.getPath();if(!/^\/[^\(]+\([^\)]+\)$/.test(o)){return false}const n=e.getModel().getMetaModel();const i=n.getMetaContext(e.getPath()).getObject("@sapui.name");if(!h.getSemanticKeys(n,i)){return false}return u.isDraftSupported(n,o)};f._getPathFromContext=function t(e,o){let n;if(e.isA("sap.ui.model.odata.v4.ODataListBinding")&&e.isRelative()){n=e.getHeaderContext().getPath()}else{n=e.getPath()}if(o.updateFCLLevel===-1){n=this._findPathToNavigate(n);if(this.oLastSemanticMapping&&this.oLastSemanticMapping.technicalPath===n){n=this.oLastSemanticMapping.semanticPath}}else if(this._checkIfContextSupportsSemanticPath(e)){const t=h.getSemanticPath(e,true);if(!t){this.setLastSemanticMapping(undefined)}else if(t!==n){this.setLastSemanticMapping({technicalPath:n,semanticPath:t});n=t}}if(n[0]==="/"){n=n.substring(1)}return n};f._calculateLayout=function t(e,o){let n=o.FCLLevel;if(o.updateFCLLevel){n+=o.updateFCLLevel;if(n<0){n=0}}return this.oAppComponent.getRootViewController().calculateLayout(n,e,o.sLayout,o.keepCurrentLayout)};f._beforeRouteMatched=function t(){const o=(new n).isPlaceholderEnabled();if(!o){const t=this.oAppComponent.getRootControl();e.lock(t)}};f._onRouteMatched=function o(r){const a=this.oAppComponent.getAppStateHandler(),s=this.oAppComponent.getRootControl();const u=(new n).isPlaceholderEnabled();if(e.isLocked(s)&&!u){e.unlock(s)}const h=r.getParameters();if(this.navigationInfoQueue.length){h.navigationInfo=this.navigationInfoQueue[0];this.navigationInfoQueue=this.navigationInfoQueue.slice(1)}else{h.navigationInfo={}}if(a.checkIfRouteChangedByIApp()){h.navigationInfo.reason=i.AppStateChanged;a.resetRouteChangedByIApp()}this.sCurrentRouteName=r.getParameter("name");this.sCurrentRoutePattern=h.config.pattern;this.aCurrentViews=r.getParameter("views");h.routeInformation=this._getRouteInformation(this.sCurrentRouteName);h.routePattern=this.sCurrentRoutePattern;this._fireRouteMatchEvents(h);if(!history.state||history.state.feLevel===undefined){this.oRouterProxy.restoreHistory().then(()=>{this.oRouterProxy.resolveRouteMatch()}).catch(function(e){t.error("Error while restoring history",e)})}else{this.oRouterProxy.resolveRouteMatch()}};f.attachRouteMatched=function t(e,o,n){this.eventProvider.attachEvent("routeMatched",e,o,n)};f.detachRouteMatched=function t(e,o){this.eventProvider.detachEvent("routeMatched",e,o)};f.attachAfterRouteMatched=function t(e,o,n){this.eventProvider.attachEvent("afterRouteMatched",e,o,n)};f.detachAfterRouteMatched=function t(e,o){this.eventProvider.detachEvent("afterRouteMatched",e,o)};f.getRouteFromHash=function t(e,o){const n=e.getHashChanger().hash;const i=e.getRouteInfoByHash(n);return o.getMetadata().getManifestEntry("/sap.ui5/routing/routes").filter(function(t){return t.name===i.name})[0]};f.getTargetsFromRoute=function t(e){const o=e.target;if(typeof o==="string"){return[this._mTargets[o]]}else{const t=[];o.forEach(e=>{t.push(this._mTargets[e])});return t}};f.initializeRouting=async function e(){await c.processAndExpandHash();this._fnOnRouteMatched=this._onRouteMatched.bind(this);this.oRouter.attachRouteMatched(this._fnOnRouteMatched,this);const o=(new n).isPlaceholderEnabled();if(!o){this.oRouter.attachBeforeRouteMatched(this._beforeRouteMatched.bind(this))}this.navigationInfoQueue=[];s.resetEditState();this.bExitOnNavigateBackToRoot=!this.oRouter.match("");const i=this.oRouter.getHashChanger().getHash().indexOf("sap-iapp-state")!==-1;try{const t=await this.oAppComponent.getStartupParameters();const e=t!==undefined&&Object.keys(t).length!==0;const o=this.oRouter.getHashChanger().getHash();if(!i&&e&&!o){if(t.preferredMode&&t.preferredMode[0].toUpperCase().indexOf("CREATE")!==-1){await this._manageCreateStartup(t)}else{await this._manageDeepLinkStartup(t)}}}catch(e){t.error("Error during routing initialization",e)}};f.getDefaultCreateHash=function t(e){return r.getDefaultCreateHash(e,this.getContextPath(),this.oRouter)};f._manageCreateStartup=function t(e){return r.getCreateStartupHash(e,this.getContextPath(),this.oRouter,this.oMetaModel).then(t=>{if(t){this.oRouter.getHashChanger().replaceHash(t);if(e!==null&&e!==void 0&&e.preferredMode&&e.preferredMode[0].toUpperCase().indexOf("AUTOCREATE")!==-1){this.oAppComponent.setStartupModeAutoCreate()}else{this.oAppComponent.setStartupModeCreate()}this.bExitOnNavigateBackToRoot=true}})};f._manageDeepLinkStartup=function t(e){return r.getDeepLinkStartupHash(this.oAppComponent.getManifest()["sap.ui5"].routing,e,this.oModel).then(t=>{let e;if(t.context){const o=t.context.getPath();const n=this._checkIfContextSupportsSemanticPath(t.context)?h.getSemanticPath(t.context):o;if(n!==o){this.setLastSemanticMapping({technicalPath:o,semanticPath:n})}e=n.substring(1)}else if(t.hash){e=t.hash}if(e){this.oRouter.getHashChanger().replaceHash(e);this.oAppComponent.setStartupModeDeeplink()}})};f.getOutbounds=function t(){return this.outbounds};f.getContextPath=function t(){return this.sContextPath};f.getInterface=function t(){return this};return g}(f);y.RoutingService=O;let k=function(t){S(e,t);function e(){return t.apply(this,arguments)||this}var o=e.prototype;o.createInstance=function t(e){const o=new O(e);return o.initPromise};return e}(p);return k},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/ShellServicesFactory-dbg", ["sap/base/Log", "sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory"], function (Log, Service, ServiceFactory) {
  "use strict";

  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  /**
   * Mock implementation of the ShellService for OpenFE
   *
   * @implements {IShellServices}
   * @private
   */
  let ShellServiceMock = /*#__PURE__*/function (_Service) {
    _inheritsLoose(ShellServiceMock, _Service);
    function ShellServiceMock() {
      return _Service.apply(this, arguments) || this;
    }
    var _proto = ShellServiceMock.prototype;
    _proto.init = function init() {
      this.initPromise = Promise.resolve(this);
      this.instanceType = "mock";
    };
    _proto.getLinks = function getLinks( /*oArgs: object*/
    ) {
      return Promise.resolve([]);
    };
    _proto.getLinksWithCache = function getLinksWithCache( /*oArgs: object*/
    ) {
      return Promise.resolve([]);
    };
    _proto.toExternal = function toExternal( /*oNavArgumentsArr: Array<object>, oComponent: object*/
    ) {
      /* Do Nothing */
    };
    _proto.getStartupAppState = function getStartupAppState( /*oArgs: object*/
    ) {
      return Promise.resolve(undefined);
    };
    _proto.backToPreviousApp = function backToPreviousApp() {
      /* Do Nothing */
    };
    _proto.hrefForExternal = function hrefForExternal( /*oArgs?: object, oComponent?: object, bAsync?: boolean*/
    ) {
      return "";
    };
    _proto.hrefForExternalAsync = function hrefForExternalAsync( /*oArgs?: object, oComponent?: object*/
    ) {
      return Promise.resolve({});
    };
    _proto.getAppState = function getAppState( /*oComponent: object, sAppStateKey: string*/
    ) {
      return Promise.resolve({});
    };
    _proto.createEmptyAppState = function createEmptyAppState( /*oComponent: object*/
    ) {
      return Promise.resolve({});
    };
    _proto.createEmptyAppStateAsync = function createEmptyAppStateAsync( /*oComponent: object*/
    ) {
      return Promise.resolve({});
    };
    _proto.isNavigationSupported = function isNavigationSupported( /*oNavArgumentsArr: Array<object>, oComponent: object*/
    ) {
      return Promise.resolve({});
    };
    _proto.isInitialNavigation = function isInitialNavigation() {
      return false;
    };
    _proto.isInitialNavigationAsync = function isInitialNavigationAsync() {
      return Promise.resolve({});
    };
    _proto.expandCompactHash = function expandCompactHash( /*sHashFragment: string*/
    ) {
      return Promise.resolve({});
    };
    _proto.parseShellHash = function parseShellHash( /*sHash: string*/
    ) {
      return {};
    };
    _proto.splitHash = function splitHash( /*sHash: string*/
    ) {
      return Promise.resolve({});
    };
    _proto.constructShellHash = function constructShellHash( /*oNewShellHash: object*/
    ) {
      return "";
    };
    _proto.setDirtyFlag = function setDirtyFlag( /*bDirty: boolean*/
    ) {
      /* Do Nothing */
    };
    _proto.registerDirtyStateProvider = function registerDirtyStateProvider( /*fnDirtyStateProvider: Function*/
    ) {
      /* Do Nothing */
    };
    _proto.deregisterDirtyStateProvider = function deregisterDirtyStateProvider( /*fnDirtyStateProvider: Function*/
    ) {
      /* Do Nothing */
    };
    _proto.createRenderer = function createRenderer() {
      return {};
    };
    _proto.getUser = function getUser() {
      return {};
    };
    _proto.hasUShell = function hasUShell() {
      return false;
    };
    _proto.registerNavigationFilter = function registerNavigationFilter( /*fnNavFilter: Function*/
    ) {
      /* Do Nothing */
    };
    _proto.unregisterNavigationFilter = function unregisterNavigationFilter( /*fnNavFilter: Function*/
    ) {
      /* Do Nothing */
    };
    _proto.setBackNavigation = function setBackNavigation( /*fnCallBack?: Function*/
    ) {
      /* Do Nothing */
    };
    _proto.setHierarchy = function setHierarchy( /*aHierarchyLevels: Array<object>*/
    ) {
      /* Do Nothing */
    };
    _proto.setTitle = function setTitle( /*sTitle: string*/
    ) {
      /* Do Nothing */
    };
    _proto.getContentDensity = function getContentDensity() {
      // in case there is no shell we probably need to look at the classes being defined on the body
      if (document.body.classList.contains("sapUiSizeCozy")) {
        return "cozy";
      } else if (document.body.classList.contains("sapUiSizeCompact")) {
        return "compact";
      } else {
        return "";
      }
    };
    _proto.getPrimaryIntent = function getPrimaryIntent( /*sSemanticObject: string, mParameters?: object*/
    ) {
      return Promise.resolve();
    };
    _proto.waitForPluginsLoad = function waitForPluginsLoad() {
      return Promise.resolve(true);
    };
    return ShellServiceMock;
  }(Service);
  /**
   * @typedef ShellServicesSettings
   * @private
   */
  /**
   * Wrap a JQuery Promise within a native {Promise}.
   *
   * @template {object} T
   * @param jqueryPromise The original jquery promise
   * @returns A native promise wrapping the same object
   * @private
   */
  function wrapJQueryPromise(jqueryPromise) {
    return new Promise((resolve, reject) => {
      // eslint-disable-next-line promise/catch-or-return
      jqueryPromise.done(resolve).fail(reject);
    });
  }

  /**
   * Base implementation of the ShellServices
   *
   * @implements {IShellServices}
   * @private
   */
  let ShellServices = /*#__PURE__*/function (_Service2) {
    _inheritsLoose(ShellServices, _Service2);
    function ShellServices() {
      return _Service2.apply(this, arguments) || this;
    }
    var _proto2 = ShellServices.prototype;
    // !: means that we know it will be assigned before usage
    _proto2.init = function init() {
      const oContext = this.getContext();
      const oComponent = oContext.scopeObject;
      this.oShellContainer = oContext.settings.shellContainer;
      this.instanceType = "real";
      this.linksCache = {};
      this.fnFindSemanticObjectsInCache = function (oArgs) {
        const _oArgs = oArgs;
        const aCachedSemanticObjects = [];
        const aNonCachedSemanticObjects = [];
        for (let i = 0; i < _oArgs.length; i++) {
          if (!!_oArgs[i][0] && !!_oArgs[i][0].semanticObject) {
            if (this.linksCache[_oArgs[i][0].semanticObject]) {
              aCachedSemanticObjects.push(this.linksCache[_oArgs[i][0].semanticObject].links);
              Object.defineProperty(oArgs[i][0], "links", {
                value: this.linksCache[_oArgs[i][0].semanticObject].links
              });
            } else {
              aNonCachedSemanticObjects.push(_oArgs[i]);
            }
          }
        }
        return {
          oldArgs: oArgs,
          newArgs: aNonCachedSemanticObjects,
          cachedLinks: aCachedSemanticObjects
        };
      };
      this.initPromise = new Promise((resolve, reject) => {
        this.resolveFn = resolve;
        this.rejectFn = reject;
      });
      const oCrossAppNavServicePromise = this.oShellContainer.getServiceAsync("CrossApplicationNavigation");
      const oUrlParsingServicePromise = this.oShellContainer.getServiceAsync("URLParsing");
      const oShellNavigationServicePromise = this.oShellContainer.getServiceAsync("ShellNavigation");
      const oShellPluginManagerPromise = this.oShellContainer.getServiceAsync("PluginManager");
      const oShellUIServicePromise = oComponent.getService("ShellUIService");
      Promise.all([oCrossAppNavServicePromise, oUrlParsingServicePromise, oShellNavigationServicePromise, oShellUIServicePromise, oShellPluginManagerPromise]).then(_ref => {
        let [oCrossAppNavService, oUrlParsingService, oShellNavigation, oShellUIService, oShellPluginManager] = _ref;
        this.crossAppNavService = oCrossAppNavService;
        this.urlParsingService = oUrlParsingService;
        this.shellNavigation = oShellNavigation;
        this.shellUIService = oShellUIService;
        this.shellPluginManager = oShellPluginManager;
        this.resolveFn();
      }).catch(this.rejectFn);
    }

    /**
     * Retrieves the target links configured for a given semantic object & action
     * Will retrieve the CrossApplicationNavigation
     * service reference call the getLinks method. In case service is not available or any exception
     * method throws exception error in console.
     *
     * @private
     * @ui5-restricted
     * @param oArgs Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>getLinks arguments
     * @returns Promise which will be resolved to target links array
     */;
    _proto2.getLinks = function getLinks(oArgs) {
      return new Promise((resolve, reject) => {
        // eslint-disable-next-line promise/catch-or-return
        this.crossAppNavService.getLinks(oArgs).fail(oError => {
          reject(new Error(`${oError} sap.fe.core.services.ShellServicesFactory.getLinks`));
        }).then(resolve);
      });
    }

    /**
     * Retrieves the target links configured for a given semantic object & action in cache
     * Will retrieve the CrossApplicationNavigation
     * service reference call the getLinks method. In case service is not available or any exception
     * method throws exception error in console.
     *
     * @private
     * @ui5-restricted
     * @param oArgs Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>getLinks arguments
     * @returns Promise which will be resolved to target links array
     */;
    _proto2.getLinksWithCache = function getLinksWithCache(oArgs) {
      return new Promise((resolve, reject) => {
        // eslint-disable-next-line promise/catch-or-return
        if (oArgs.length === 0) {
          resolve([]);
        } else {
          const oCacheResults = this.fnFindSemanticObjectsInCache(oArgs);
          if (oCacheResults.newArgs.length === 0) {
            resolve(oCacheResults.cachedLinks);
          } else {
            // eslint-disable-next-line promise/catch-or-return
            this.crossAppNavService.getLinks(oCacheResults.newArgs).fail(oError => {
              reject(new Error(`${oError} sap.fe.core.services.ShellServicesFactory.getLinksWithCache`));
            }).then(aLinks => {
              if (aLinks.length !== 0) {
                const oSemanticObjectsLinks = {};
                for (let i = 0; i < aLinks.length; i++) {
                  if (aLinks[i].length > 0 && oCacheResults.newArgs[i][0].links === undefined) {
                    oSemanticObjectsLinks[oCacheResults.newArgs[i][0].semanticObject] = {
                      links: aLinks[i]
                    };
                    this.linksCache = Object.assign(this.linksCache, oSemanticObjectsLinks);
                  }
                }
              }
              if (oCacheResults.cachedLinks.length === 0) {
                resolve(aLinks);
              } else {
                const aMergedLinks = [];
                let j = 0;
                for (let k = 0; k < oCacheResults.oldArgs.length; k++) {
                  if (j < aLinks.length) {
                    if (aLinks[j].length > 0 && oCacheResults.oldArgs[k][0].semanticObject === oCacheResults.newArgs[j][0].semanticObject) {
                      aMergedLinks.push(aLinks[j]);
                      j++;
                    } else {
                      aMergedLinks.push(oCacheResults.oldArgs[k][0].links);
                    }
                  } else {
                    aMergedLinks.push(oCacheResults.oldArgs[k][0].links);
                  }
                }
                resolve(aMergedLinks);
              }
            });
          }
        }
      });
    }

    /**
     * Will retrieve the ShellContainer.
     *
     * @private
     * @ui5-restricted
     * sap.ushell.container
     * @returns Object with predefined shellContainer methods
     */;
    _proto2.getShellContainer = function getShellContainer() {
      return this.oShellContainer;
    }

    /**
     * Will call toExternal method of CrossApplicationNavigation service with Navigation Arguments and oComponent.
     *
     * @private
     * @ui5-restricted
     * @param oNavArgumentsArr And
     * @param oComponent Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>toExternal arguments
     */;
    _proto2.toExternal = function toExternal(oNavArgumentsArr, oComponent) {
      this.crossAppNavService.toExternal(oNavArgumentsArr, oComponent);
    }

    /**
     * Retrieves the target startupAppState
     * Will check the existance of the ShellContainer and retrieve the CrossApplicationNavigation
     * service reference call the getStartupAppState method. In case service is not available or any exception
     * method throws exception error in console.
     *
     * @private
     * @ui5-restricted
     * @param oArgs Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>getStartupAppState arguments
     * @returns Promise which will be resolved to Object
     */;
    _proto2.getStartupAppState = function getStartupAppState(oArgs) {
      return new Promise((resolve, reject) => {
        // JQuery Promise behaves differently
        // eslint-disable-next-line promise/catch-or-return
        this.crossAppNavService.getStartupAppState(oArgs).fail(oError => {
          reject(new Error(`${oError} sap.fe.core.services.ShellServicesFactory.getStartupAppState`));
        }).then(startupAppState => resolve(startupAppState));
      });
    }

    /**
     * Will call backToPreviousApp method of CrossApplicationNavigation service.
     *
     * @returns Something that indicate we've navigated
     * @private
     * @ui5-restricted
     */;
    _proto2.backToPreviousApp = function backToPreviousApp() {
      return this.crossAppNavService.backToPreviousApp();
    }

    /**
     * Will call hrefForExternal method of CrossApplicationNavigation service.
     *
     * @private
     * @ui5-restricted
     * @param oArgs Check the definition of
     * @param oComponent The appComponent
     * @param bAsync Whether this call should be async or not
     * sap.ushell.services.CrossApplicationNavigation=>hrefForExternal arguments
     * @returns Promise which will be resolved to string
     */;
    _proto2.hrefForExternal = function hrefForExternal(oArgs, oComponent, bAsync) {
      return this.crossAppNavService.hrefForExternal(oArgs, oComponent, !!bAsync);
    }

    /**
     * Will call hrefForExternal method of CrossApplicationNavigation service.
     *
     * @private
     * @ui5-restricted
     * @param oArgs Check the definition of
     * @param oComponent The appComponent
     * sap.ushell.services.CrossApplicationNavigation=>hrefForExternalAsync arguments
     * @returns Promise which will be resolved to string
     */;
    _proto2.hrefForExternalAsync = function hrefForExternalAsync(oArgs, oComponent) {
      return this.crossAppNavService.hrefForExternalAsync(oArgs, oComponent);
    }

    /**
     * Will call getAppState method of CrossApplicationNavigation service with oComponent and oAppStateKey.
     *
     * @private
     * @ui5-restricted
     * @param oComponent
     * @param sAppStateKey Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>getAppState arguments
     * @returns Promise which will be resolved to object
     */;
    _proto2.getAppState = function getAppState(oComponent, sAppStateKey) {
      return wrapJQueryPromise(this.crossAppNavService.getAppState(oComponent, sAppStateKey));
    }

    /**
     * Will call createEmptyAppState method of CrossApplicationNavigation service with oComponent.
     *
     * @private
     * @ui5-restricted
     * @param oComponent Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>createEmptyAppState arguments
     * @returns Promise which will be resolved to object
     */;
    _proto2.createEmptyAppState = function createEmptyAppState(oComponent) {
      return this.crossAppNavService.createEmptyAppState(oComponent);
    }

    /**
     * Will call createEmptyAppStateAsync method of CrossApplicationNavigation service with oComponent.
     *
     * @private
     * @ui5-restricted
     * @param oComponent Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>createEmptyAppStateAsync arguments
     * @returns Promise which will be resolved to object
     */;
    _proto2.createEmptyAppStateAsync = function createEmptyAppStateAsync(oComponent) {
      return this.crossAppNavService.createEmptyAppStateAsync(oComponent);
    }

    /**
     * Will call isNavigationSupported method of CrossApplicationNavigation service with Navigation Arguments and oComponent.
     *
     * @private
     * @ui5-restricted
     * @param oNavArgumentsArr
     * @param oComponent Check the definition of
     * sap.ushell.services.CrossApplicationNavigation=>isNavigationSupported arguments
     * @returns Promise which will be resolved to object
     */;
    _proto2.isNavigationSupported = function isNavigationSupported(oNavArgumentsArr, oComponent) {
      return wrapJQueryPromise(this.crossAppNavService.isNavigationSupported(oNavArgumentsArr, oComponent));
    }

    /**
     * Will call isInitialNavigation method of CrossApplicationNavigation service.
     *
     * @private
     * @ui5-restricted
     * @returns Promise which will be resolved to boolean
     */;
    _proto2.isInitialNavigation = function isInitialNavigation() {
      return this.crossAppNavService.isInitialNavigation();
    }

    /**
     * Will call isInitialNavigationAsync method of CrossApplicationNavigation service.
     *
     * @private
     * @ui5-restricted
     * @returns Promise which will be resolved to boolean
     */;
    _proto2.isInitialNavigationAsync = function isInitialNavigationAsync() {
      return this.crossAppNavService.isInitialNavigationAsync();
    }

    /**
     * Will call expandCompactHash method of CrossApplicationNavigation service.
     *
     * @param sHashFragment An (internal format) shell hash
     * @returns A promise the success handler of the resolve promise get an expanded shell hash as first argument
     * @private
     * @ui5-restricted
     */;
    _proto2.expandCompactHash = function expandCompactHash(sHashFragment) {
      return this.crossAppNavService.expandCompactHash(sHashFragment);
    }

    /**
     * Will call parseShellHash method of URLParsing service with given sHash.
     *
     * @private
     * @ui5-restricted
     * @param sHash Check the definition of
     * sap.ushell.services.URLParsing=>parseShellHash arguments
     * @returns The parsed url
     */;
    _proto2.parseShellHash = function parseShellHash(sHash) {
      return this.urlParsingService.parseShellHash(sHash);
    }

    /**
     * Will call splitHash method of URLParsing service with given sHash.
     *
     * @private
     * @ui5-restricted
     * @param sHash Check the definition of
     * sap.ushell.services.URLParsing=>splitHash arguments
     * @returns Promise which will be resolved to object
     */;
    _proto2.splitHash = function splitHash(sHash) {
      return this.urlParsingService.splitHash(sHash);
    }

    /**
     * Will call constructShellHash method of URLParsing service with given sHash.
     *
     * @private
     * @ui5-restricted
     * @param oNewShellHash Check the definition of
     * sap.ushell.services.URLParsing=>constructShellHash arguments
     * @returns Shell Hash string
     */;
    _proto2.constructShellHash = function constructShellHash(oNewShellHash) {
      return this.urlParsingService.constructShellHash(oNewShellHash);
    }

    /**
     * Will call setDirtyFlag method with given dirty state.
     *
     * @private
     * @ui5-restricted
     * @param bDirty Check the definition of sap.ushell.Container.setDirtyFlag arguments
     */;
    _proto2.setDirtyFlag = function setDirtyFlag(bDirty) {
      this.oShellContainer.setDirtyFlag(bDirty);
    }

    /**
     * Will call registerDirtyStateProvider method with given dirty state provider callback method.
     *
     * @private
     * @ui5-restricted
     * @param fnDirtyStateProvider Check the definition of sap.ushell.Container.registerDirtyStateProvider arguments
     */;
    _proto2.registerDirtyStateProvider = function registerDirtyStateProvider(fnDirtyStateProvider) {
      this.oShellContainer.registerDirtyStateProvider(fnDirtyStateProvider);
    }

    /**
     * Will call deregisterDirtyStateProvider method with given dirty state provider callback method.
     *
     * @private
     * @ui5-restricted
     * @param fnDirtyStateProvider Check the definition of sap.ushell.Container.deregisterDirtyStateProvider arguments
     */;
    _proto2.deregisterDirtyStateProvider = function deregisterDirtyStateProvider(fnDirtyStateProvider) {
      this.oShellContainer.deregisterDirtyStateProvider(fnDirtyStateProvider);
    }

    /**
     * Will call createRenderer method of ushell container.
     *
     * @private
     * @ui5-restricted
     * @returns Returns renderer object
     */;
    _proto2.createRenderer = function createRenderer() {
      return this.oShellContainer.createRenderer();
    }

    /**
     * Will call getUser method of ushell container.
     *
     * @private
     * @ui5-restricted
     * @returns Returns User object
     */;
    _proto2.getUser = function getUser() {
      return this.oShellContainer.getUser();
    }

    /**
     * Will check if ushell container is available or not.
     *
     * @private
     * @ui5-restricted
     * @returns Returns true
     */;
    _proto2.hasUShell = function hasUShell() {
      return true;
    }

    /**
     * Will call registerNavigationFilter method of shellNavigation.
     *
     * @param fnNavFilter The filter function to register
     * @private
     * @ui5-restricted
     */;
    _proto2.registerNavigationFilter = function registerNavigationFilter(fnNavFilter) {
      this.shellNavigation.registerNavigationFilter(fnNavFilter);
    }

    /**
     * Will call unregisterNavigationFilter method of shellNavigation.
     *
     * @param fnNavFilter The filter function to unregister
     * @private
     * @ui5-restricted
     */;
    _proto2.unregisterNavigationFilter = function unregisterNavigationFilter(fnNavFilter) {
      this.shellNavigation.unregisterNavigationFilter(fnNavFilter);
    }

    /**
     * Will call setBackNavigation method of ShellUIService
     * that displays the back button in the shell header.
     *
     * @param [fnCallBack] A callback function called when the button is clicked in the UI.
     * @private
     * @ui5-restricted
     */;
    _proto2.setBackNavigation = function setBackNavigation(fnCallBack) {
      this.shellUIService.setBackNavigation(fnCallBack);
    }

    /**
     * Will call setHierarchy method of ShellUIService
     * that displays the given hierarchy in the shell header.
     *
     * @param [aHierarchyLevels] An array representing hierarchies of the currently displayed app.
     * @private
     * @ui5-restricted
     */;
    _proto2.setHierarchy = function setHierarchy(aHierarchyLevels) {
      this.shellUIService.setHierarchy(aHierarchyLevels);
    }

    /**
     * Will call setTitle method of ShellUIService
     * that displays the given title in the shell header.
     *
     * @param [sTitle] The new title. The default title is set if this argument is not given.
     * @private
     * @ui5-restricted
     */;
    _proto2.setTitle = function setTitle(sTitle) {
      this.shellUIService.setTitle(sTitle);
    }

    /**
     * Retrieves the currently defined content density.
     *
     * @returns The content density value
     */;
    _proto2.getContentDensity = function getContentDensity() {
      return this.oShellContainer.getUser().getContentDensity();
    }

    /**
     * For a given semantic object, this method considers all actions associated with the semantic object and
     * returns the one tagged as a "primaryAction". If no inbound tagged as "primaryAction" exists, then it returns
     * the intent of the first inbound (after sorting has been applied) matching the action "displayFactSheet".
     *
     * @private
     * @ui5-restricted
     * @param sSemanticObject Semantic object.
     * @param mParameters See #CrossApplicationNavigation#getLinks for description.
     * @returns Promise which will be resolved with an object containing the intent if it exists.
     */;
    _proto2.getPrimaryIntent = function getPrimaryIntent(sSemanticObject, mParameters) {
      return new Promise((resolve, reject) => {
        // eslint-disable-next-line promise/catch-or-return
        this.crossAppNavService.getPrimaryIntent(sSemanticObject, mParameters).fail(oError => {
          reject(new Error(`${oError} sap.fe.core.services.ShellServicesFactory.getPrimaryIntent`));
        }).then(resolve);
      });
    }

    /**
     * Wait for the render extensions plugin to be loaded.
     * If true is returned by the promise we were able to wait for it, otherwise we couldn't and cannot rely on it.
     */;
    _proto2.waitForPluginsLoad = function waitForPluginsLoad() {
      return new Promise(resolve => {
        var _this$shellPluginMana;
        if (!((_this$shellPluginMana = this.shellPluginManager) !== null && _this$shellPluginMana !== void 0 && _this$shellPluginMana.getPluginLoadingPromise)) {
          resolve(false);
        } else {
          // eslint-disable-next-line promise/catch-or-return
          this.shellPluginManager.getPluginLoadingPromise("RendererExtensions").fail(oError => {
            Log.error(oError, "sap.fe.core.services.ShellServicesFactory.waitForPluginsLoad");
            resolve(false);
          }).then(() => resolve(true));
        }
      });
    };
    return ShellServices;
  }(Service);
  /**
   * Service Factory for the ShellServices
   *
   * @private
   */
  let ShellServicesFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(ShellServicesFactory, _ServiceFactory);
    function ShellServicesFactory() {
      return _ServiceFactory.apply(this, arguments) || this;
    }
    var _proto3 = ShellServicesFactory.prototype;
    /**
     * Creates either a standard or a mock Shell service depending on the configuration.
     *
     * @param oServiceContext The shellservice context
     * @returns A promise for a shell service implementation
     * @see ServiceFactory#createInstance
     */
    _proto3.createInstance = function createInstance(oServiceContext) {
      oServiceContext.settings.shellContainer = sap.ushell && sap.ushell.Container;
      const oShellService = oServiceContext.settings.shellContainer ? new ShellServices(oServiceContext) : new ShellServiceMock(oServiceContext);
      return oShellService.initPromise.then(() => {
        // Enrich the appComponent with this method
        oServiceContext.scopeObject.getShellServices = () => oShellService;
        return oShellService;
      });
    };
    return ShellServicesFactory;
  }(ServiceFactory);
  return ShellServicesFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/ShellServicesFactory", ["sap/base/Log","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(e,t,n){"use strict";function i(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;r(e,t)}function r(e,t){r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return r(e,t)}let s=function(e){i(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.init=function e(){this.initPromise=Promise.resolve(this);this.instanceType="mock"};n.getLinks=function e(){return Promise.resolve([])};n.getLinksWithCache=function e(){return Promise.resolve([])};n.toExternal=function e(){};n.getStartupAppState=function e(){return Promise.resolve(undefined)};n.backToPreviousApp=function e(){};n.hrefForExternal=function e(){return""};n.hrefForExternalAsync=function e(){return Promise.resolve({})};n.getAppState=function e(){return Promise.resolve({})};n.createEmptyAppState=function e(){return Promise.resolve({})};n.createEmptyAppStateAsync=function e(){return Promise.resolve({})};n.isNavigationSupported=function e(){return Promise.resolve({})};n.isInitialNavigation=function e(){return false};n.isInitialNavigationAsync=function e(){return Promise.resolve({})};n.expandCompactHash=function e(){return Promise.resolve({})};n.parseShellHash=function e(){return{}};n.splitHash=function e(){return Promise.resolve({})};n.constructShellHash=function e(){return""};n.setDirtyFlag=function e(){};n.registerDirtyStateProvider=function e(){};n.deregisterDirtyStateProvider=function e(){};n.createRenderer=function e(){return{}};n.getUser=function e(){return{}};n.hasUShell=function e(){return false};n.registerNavigationFilter=function e(){};n.unregisterNavigationFilter=function e(){};n.setBackNavigation=function e(){};n.setHierarchy=function e(){};n.setTitle=function e(){};n.getContentDensity=function e(){if(document.body.classList.contains("sapUiSizeCozy")){return"cozy"}else if(document.body.classList.contains("sapUiSizeCompact")){return"compact"}else{return""}};n.getPrimaryIntent=function e(){return Promise.resolve()};n.waitForPluginsLoad=function e(){return Promise.resolve(true)};return t}(t);function o(e){return new Promise((t,n)=>{e.done(t).fail(n)})}let c=function(t){i(n,t);function n(){return t.apply(this,arguments)||this}var r=n.prototype;r.init=function e(){const t=this.getContext();const n=t.scopeObject;this.oShellContainer=t.settings.shellContainer;this.instanceType="real";this.linksCache={};this.fnFindSemanticObjectsInCache=function(e){const t=e;const n=[];const i=[];for(let r=0;r<t.length;r++){if(!!t[r][0]&&!!t[r][0].semanticObject){if(this.linksCache[t[r][0].semanticObject]){n.push(this.linksCache[t[r][0].semanticObject].links);Object.defineProperty(e[r][0],"links",{value:this.linksCache[t[r][0].semanticObject].links})}else{i.push(t[r])}}}return{oldArgs:e,newArgs:i,cachedLinks:n}};this.initPromise=new Promise((e,t)=>{this.resolveFn=e;this.rejectFn=t});const i=this.oShellContainer.getServiceAsync("CrossApplicationNavigation");const r=this.oShellContainer.getServiceAsync("URLParsing");const s=this.oShellContainer.getServiceAsync("ShellNavigation");const o=this.oShellContainer.getServiceAsync("PluginManager");const c=n.getService("ShellUIService");Promise.all([i,r,s,c,o]).then(e=>{let[t,n,i,r,s]=e;this.crossAppNavService=t;this.urlParsingService=n;this.shellNavigation=i;this.shellUIService=r;this.shellPluginManager=s;this.resolveFn()}).catch(this.rejectFn)};r.getLinks=function e(t){return new Promise((e,n)=>{this.crossAppNavService.getLinks(t).fail(e=>{n(new Error(`${e} sap.fe.core.services.ShellServicesFactory.getLinks`))}).then(e)})};r.getLinksWithCache=function e(t){return new Promise((e,n)=>{if(t.length===0){e([])}else{const i=this.fnFindSemanticObjectsInCache(t);if(i.newArgs.length===0){e(i.cachedLinks)}else{this.crossAppNavService.getLinks(i.newArgs).fail(e=>{n(new Error(`${e} sap.fe.core.services.ShellServicesFactory.getLinksWithCache`))}).then(t=>{if(t.length!==0){const e={};for(let n=0;n<t.length;n++){if(t[n].length>0&&i.newArgs[n][0].links===undefined){e[i.newArgs[n][0].semanticObject]={links:t[n]};this.linksCache=Object.assign(this.linksCache,e)}}}if(i.cachedLinks.length===0){e(t)}else{const n=[];let r=0;for(let e=0;e<i.oldArgs.length;e++){if(r<t.length){if(t[r].length>0&&i.oldArgs[e][0].semanticObject===i.newArgs[r][0].semanticObject){n.push(t[r]);r++}else{n.push(i.oldArgs[e][0].links)}}else{n.push(i.oldArgs[e][0].links)}}e(n)}})}}})};r.getShellContainer=function e(){return this.oShellContainer};r.toExternal=function e(t,n){this.crossAppNavService.toExternal(t,n)};r.getStartupAppState=function e(t){return new Promise((e,n)=>{this.crossAppNavService.getStartupAppState(t).fail(e=>{n(new Error(`${e} sap.fe.core.services.ShellServicesFactory.getStartupAppState`))}).then(t=>e(t))})};r.backToPreviousApp=function e(){return this.crossAppNavService.backToPreviousApp()};r.hrefForExternal=function e(t,n,i){return this.crossAppNavService.hrefForExternal(t,n,!!i)};r.hrefForExternalAsync=function e(t,n){return this.crossAppNavService.hrefForExternalAsync(t,n)};r.getAppState=function e(t,n){return o(this.crossAppNavService.getAppState(t,n))};r.createEmptyAppState=function e(t){return this.crossAppNavService.createEmptyAppState(t)};r.createEmptyAppStateAsync=function e(t){return this.crossAppNavService.createEmptyAppStateAsync(t)};r.isNavigationSupported=function e(t,n){return o(this.crossAppNavService.isNavigationSupported(t,n))};r.isInitialNavigation=function e(){return this.crossAppNavService.isInitialNavigation()};r.isInitialNavigationAsync=function e(){return this.crossAppNavService.isInitialNavigationAsync()};r.expandCompactHash=function e(t){return this.crossAppNavService.expandCompactHash(t)};r.parseShellHash=function e(t){return this.urlParsingService.parseShellHash(t)};r.splitHash=function e(t){return this.urlParsingService.splitHash(t)};r.constructShellHash=function e(t){return this.urlParsingService.constructShellHash(t)};r.setDirtyFlag=function e(t){this.oShellContainer.setDirtyFlag(t)};r.registerDirtyStateProvider=function e(t){this.oShellContainer.registerDirtyStateProvider(t)};r.deregisterDirtyStateProvider=function e(t){this.oShellContainer.deregisterDirtyStateProvider(t)};r.createRenderer=function e(){return this.oShellContainer.createRenderer()};r.getUser=function e(){return this.oShellContainer.getUser()};r.hasUShell=function e(){return true};r.registerNavigationFilter=function e(t){this.shellNavigation.registerNavigationFilter(t)};r.unregisterNavigationFilter=function e(t){this.shellNavigation.unregisterNavigationFilter(t)};r.setBackNavigation=function e(t){this.shellUIService.setBackNavigation(t)};r.setHierarchy=function e(t){this.shellUIService.setHierarchy(t)};r.setTitle=function e(t){this.shellUIService.setTitle(t)};r.getContentDensity=function e(){return this.oShellContainer.getUser().getContentDensity()};r.getPrimaryIntent=function e(t,n){return new Promise((e,i)=>{this.crossAppNavService.getPrimaryIntent(t,n).fail(e=>{i(new Error(`${e} sap.fe.core.services.ShellServicesFactory.getPrimaryIntent`))}).then(e)})};r.waitForPluginsLoad=function t(){return new Promise(t=>{var n;if(!((n=this.shellPluginManager)!==null&&n!==void 0&&n.getPluginLoadingPromise)){t(false)}else{this.shellPluginManager.getPluginLoadingPromise("RendererExtensions").fail(n=>{e.error(n,"sap.fe.core.services.ShellServicesFactory.waitForPluginsLoad");t(false)}).then(()=>t(true))}})};return n}(t);let a=function(e){i(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createInstance=function e(t){t.settings.shellContainer=sap.ushell&&sap.ushell.Container;const n=t.settings.shellContainer?new c(t):new s(t);return n.initPromise.then(()=>{t.scopeObject.getShellServices=()=>n;return n})};return t}(n);return a},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/SideEffectsServiceFactory-dbg", ["sap/base/Log", "sap/fe/core/converters/MetaModelConverter", "sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory", "../templating/PropertyHelper"], function (Log, MetaModelConverter, Service, ServiceFactory, PropertyHelper) {
  "use strict";

  var _exports = {};
  var isPathExpression = PropertyHelper.isPathExpression;
  var convertTypes = MetaModelConverter.convertTypes;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let SideEffectsService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(SideEffectsService, _Service);
    function SideEffectsService() {
      return _Service.apply(this, arguments) || this;
    }
    _exports.SideEffectsService = SideEffectsService;
    var _proto = SideEffectsService.prototype;
    // !: means that we know it will be assigned before usage
    _proto.init = function init() {
      this._oSideEffectsType = {
        oData: {
          entities: {},
          actions: {}
        },
        control: {}
      };
      this._bInitialized = false;
      this.initPromise = Promise.resolve(this);
    }

    /**
     * Adds a SideEffects control
     * SideEffects definition is added by a control to keep data up to date
     * These SideEffects get limited scope compared with SideEffects coming from an OData service:
     * - Only one SideEffects definition can be defined for the combination entity type - control Id
     * - Only SideEffects source properties are recognized and used to trigger SideEffects
     *
     * Ensure the sourceControlId matches the associated SAPUI5 control ID.
     *
     * @private
     * @ui5-restricted
     * @param sEntityType Name of the entity type
     * @param oSideEffect SideEffects definition
     */;
    _proto.addControlSideEffects = function addControlSideEffects(sEntityType, oSideEffect) {
      if (oSideEffect.sourceControlId) {
        const oControlSideEffect = {
          ...oSideEffect,
          fullyQualifiedName: `${sEntityType}/SideEffectsForControl/${oSideEffect.sourceControlId}`
        };
        const mEntityControlSideEffects = this._oSideEffectsType.control[sEntityType] || {};
        mEntityControlSideEffects[oControlSideEffect.sourceControlId] = oControlSideEffect;
        this._oSideEffectsType.control[sEntityType] = mEntityControlSideEffects;
      }
    }

    /**
     * Executes SideEffects action.
     *
     * @private
     * @ui5-restricted
     * @param sTriggerAction Name of the action
     * @param oContext Context
     * @param sGroupId The group ID to be used for the request
     * @returns A promise that is resolved without data or with a return value context when the action call succeeded
     */;
    _proto.executeAction = function executeAction(sTriggerAction, oContext, sGroupId) {
      const oTriggerAction = oContext.getModel().bindContext(`${sTriggerAction}(...)`, oContext);
      return oTriggerAction.execute(sGroupId || oContext.getBinding().getUpdateGroupId());
    }

    /**
     * Gets converted OData metaModel.
     *
     * @private
     * @ui5-restricted
     * @returns Converted OData metaModel
     */;
    _proto.getConvertedMetaModel = function getConvertedMetaModel() {
      const oContext = this.getContext();
      const oComponent = oContext.scopeObject;
      const oMetaModel = oComponent.getModel().getMetaModel();
      return convertTypes(oMetaModel, this._oCapabilities);
    }

    /**
     * Gets the entity type of a context.
     *
     * @function
     * @name getEntityTypeFromContext
     * @param oContext Context
     * @returns Entity Type
     */;
    _proto.getEntityTypeFromContext = function getEntityTypeFromContext(oContext) {
      const oMetaModel = oContext.getModel().getMetaModel(),
        sMetaPath = oMetaModel.getMetaPath(oContext.getPath()),
        sEntityType = oMetaModel.getObject(sMetaPath)["$Type"];
      return sEntityType;
    }

    /**
     * Gets the SideEffects that come from an OData service.
     *
     * @private
     * @ui5-restricted
     * @param sEntityTypeName Name of the entity type
     * @returns SideEffects dictionary
     */;
    _proto.getODataEntitySideEffects = function getODataEntitySideEffects(sEntityTypeName) {
      return this._oSideEffectsType.oData.entities[sEntityTypeName] || {};
    }

    /**
     * Gets the global SideEffects that come from an OData service.
     *
     * @private
     * @ui5-restricted
     * @param sEntityTypeName Name of the entity type
     * @returns Global SideEffects
     */;
    _proto.getGlobalODataEntitySideEffects = function getGlobalODataEntitySideEffects(sEntityTypeName) {
      const mEntitySideEffects = this.getODataEntitySideEffects(sEntityTypeName);
      const aGlobalSideEffects = [];
      for (const key in mEntitySideEffects) {
        const oEntitySideEffects = mEntitySideEffects[key];
        if (!oEntitySideEffects.SourceEntities && !oEntitySideEffects.SourceProperties) {
          aGlobalSideEffects.push(oEntitySideEffects);
        }
      }
      return aGlobalSideEffects;
    }

    /**
     * Gets the SideEffects that come from an OData service.
     *
     * @private
     * @ui5-restricted
     * @param sActionName Name of the action
     * @param oContext Context
     * @returns SideEffects definition
     */;
    _proto.getODataActionSideEffects = function getODataActionSideEffects(sActionName, oContext) {
      if (oContext) {
        const sEntityType = this.getEntityTypeFromContext(oContext);
        if (sEntityType) {
          var _this$_oSideEffectsTy;
          return (_this$_oSideEffectsTy = this._oSideEffectsType.oData.actions[sEntityType]) === null || _this$_oSideEffectsTy === void 0 ? void 0 : _this$_oSideEffectsTy[sActionName];
        }
      }
      return undefined;
    }

    /**
     * Generates the dictionary for the SideEffects.
     *
     * @private
     * @ui5-restricted
     * @param oCapabilities The current capabilities
     */;
    _proto.initializeSideEffects = function initializeSideEffects(oCapabilities) {
      this._oCapabilities = oCapabilities;
      if (!this._bInitialized) {
        const oConvertedMetaModel = this.getConvertedMetaModel();
        oConvertedMetaModel.entityTypes.forEach(entityType => {
          this._oSideEffectsType.oData.entities[entityType.fullyQualifiedName] = this._retrieveODataEntitySideEffects(entityType);
          this._oSideEffectsType.oData.actions[entityType.fullyQualifiedName] = this._retrieveODataActionsSideEffects(entityType); // only bound actions are analyzed since unbound ones don't get SideEffects
        });

        this._bInitialized = true;
      }
    }

    /**
     * Removes all SideEffects related to a control.
     *
     * @private
     * @ui5-restricted
     * @param sControlId Control Id
     */;
    _proto.removeControlSideEffects = function removeControlSideEffects(sControlId) {
      Object.keys(this._oSideEffectsType.control).forEach(sEntityType => {
        if (this._oSideEffectsType.control[sEntityType][sControlId]) {
          delete this._oSideEffectsType.control[sEntityType][sControlId];
        }
      });
    }

    /**
     * Request SideEffects on a specific context.
     *
     * @function
     * @name requestSideEffects
     * @param aPathExpressions Targets of SideEffects to be executed
     * @param oContext Context where SideEffects need to be executed
     * @param sGroupId The group ID to be used for the request
     * @returns Promise on SideEffects request
     */;
    _proto.requestSideEffects = async function requestSideEffects(aPathExpressions, oContext, sGroupId) {
      this._logRequest(aPathExpressions, oContext);
      return oContext.requestSideEffects(aPathExpressions, sGroupId);
    };
    _proto.requestSideEffectsForODataAction = function requestSideEffectsForODataAction(sideEffects, oContext) {
      var _sideEffects$triggerA, _sideEffects$pathExpr;
      let aPromises;
      if ((_sideEffects$triggerA = sideEffects.triggerActions) !== null && _sideEffects$triggerA !== void 0 && _sideEffects$triggerA.length) {
        aPromises = sideEffects.triggerActions.map(sTriggerActionName => {
          return this.executeAction(sTriggerActionName, oContext);
        });
      } else {
        aPromises = [];
      }
      if ((_sideEffects$pathExpr = sideEffects.pathExpressions) !== null && _sideEffects$pathExpr !== void 0 && _sideEffects$pathExpr.length) {
        aPromises.push(this.requestSideEffects(sideEffects.pathExpressions, oContext));
      }
      return aPromises.length ? Promise.all(aPromises) : Promise.resolve();
    }

    /**
     * Request SideEffects for a navigation property on a specific context.
     *
     * @function
     * @name requestSideEffectsForNavigationProperty
     * @param sNavigationProperty Navigation property
     * @param oContext Context where SideEffects need to be executed
     * @returns SideEffects request on SAPUI5 context
     */;
    _proto.requestSideEffectsForNavigationProperty = function requestSideEffectsForNavigationProperty(sNavigationProperty, oContext) {
      const sBaseEntityType = this.getEntityTypeFromContext(oContext);
      if (sBaseEntityType) {
        const sNavigationPath = `${sNavigationProperty}/`;
        const aSideEffects = this.getODataEntitySideEffects(sBaseEntityType);
        let targetProperties = [];
        let targetEntities = [];
        let sideEffectsTargets = [];
        Object.keys(aSideEffects).filter(
        // Keep relevant SideEffects
        sAnnotationName => {
          const oSideEffects = aSideEffects[sAnnotationName];
          return (oSideEffects.SourceProperties || []).some(oPropertyPath => {
            const sPropertyPath = oPropertyPath.value;
            return sPropertyPath.startsWith(sNavigationPath) && sPropertyPath.replace(sNavigationPath, "").indexOf("/") === -1;
          }) || (oSideEffects.SourceEntities || []).some(oNavigationPropertyPath => oNavigationPropertyPath.value === sNavigationProperty);
        }).forEach(sAnnotationName => {
          const oSideEffects = aSideEffects[sAnnotationName];
          if (oSideEffects.TriggerAction) {
            this.executeAction(oSideEffects.TriggerAction, oContext);
          }
          targetProperties = targetProperties.concat(oSideEffects.TargetProperties);
          targetEntities = targetEntities.concat(oSideEffects.TargetEntities);
        });
        // Remove duplicate targets
        const sideEffectsTargetDefinition = this._removeDuplicateTargets(targetProperties, targetEntities);
        sideEffectsTargets = [...sideEffectsTargetDefinition.TargetProperties, ...sideEffectsTargetDefinition.TargetEntities];
        if (sideEffectsTargets.length > 0) {
          return this.requestSideEffects(sideEffectsTargets, oContext).catch(oError => Log.error(`SideEffects - Error while processing SideEffects for Navigation Property ${sNavigationProperty}`, oError));
        }
      }
      return Promise.resolve();
    }

    /**
     * Gets the SideEffects that come from controls.
     *
     * @private
     * @ui5-restricted
     * @param sEntityTypeName Entity type Name
     * @returns SideEffects dictionary
     */;
    _proto.getControlEntitySideEffects = function getControlEntitySideEffects(sEntityTypeName) {
      return this._oSideEffectsType.control[sEntityTypeName] || {};
    }

    /**
     * Adds the text properties required for SideEffects
     * If a property has an associated text then this text needs to be added as targetProperties or targetEntities.
     *
     * @private
     * @ui5-restricted
     * @param oSideEffect SideEffects definition
     * @param mEntityType Entity type
     * @returns SideEffects definition with added text properties
     */;
    _proto._addRequiredTextProperties = function _addRequiredTextProperties(oSideEffect, mEntityType) {
      const aInitialProperties = oSideEffect.TargetProperties,
        aEntitiesRequested = oSideEffect.TargetEntities.map(navigation => navigation.$NavigationPropertyPath);
      let aDerivedProperties = [];
      aInitialProperties.forEach(sPropertyPath => {
        var _targetType;
        const bIsStarProperty = sPropertyPath.endsWith("*"),
          // Can be '*' or '.../navProp/*'
          sNavigationPropertyPath = sPropertyPath.substring(0, sPropertyPath.lastIndexOf("/")),
          sRelativePath = sNavigationPropertyPath ? `${sNavigationPropertyPath}/` : "",
          mTarget = mEntityType.resolvePath(sNavigationPropertyPath) || mEntityType;

        // mTarget can be an entity type, navigationProperty or or a complexType
        const aTargetEntityProperties = mTarget.entityProperties || ((_targetType = mTarget.targetType) === null || _targetType === void 0 ? void 0 : _targetType.properties) || mTarget.targetType.entityProperties;
        if (aTargetEntityProperties) {
          if (bIsStarProperty) {
            // Add all required properties behind the *
            aEntitiesRequested.push(sNavigationPropertyPath);
            aDerivedProperties = aDerivedProperties.concat(aTargetEntityProperties.map(mProperty => {
              return {
                navigationPath: sRelativePath,
                property: mProperty
              };
            }));
          } else {
            aDerivedProperties.push({
              property: aTargetEntityProperties.find(mProperty => mProperty.name === sPropertyPath.split("/").pop()),
              navigationPath: sRelativePath
            });
          }
        } else {
          Log.info(`SideEffects - The entity type associated to property path ${sPropertyPath} cannot be resolved`);
        }
      });
      aDerivedProperties.forEach(mPropertyInfo => {
        var _mPropertyInfo$proper, _mPropertyInfo$proper2, _mPropertyInfo$proper3;
        const textAnnotation = (_mPropertyInfo$proper = mPropertyInfo.property) === null || _mPropertyInfo$proper === void 0 ? void 0 : (_mPropertyInfo$proper2 = _mPropertyInfo$proper.annotations) === null || _mPropertyInfo$proper2 === void 0 ? void 0 : (_mPropertyInfo$proper3 = _mPropertyInfo$proper2.Common) === null || _mPropertyInfo$proper3 === void 0 ? void 0 : _mPropertyInfo$proper3.Text;
        if (textAnnotation && isPathExpression(textAnnotation)) {
          const sTargetTextPath = textAnnotation.path,
            sTextPathFromInitialEntity = mPropertyInfo.navigationPath + sTargetTextPath,
            sTargetCollectionPath = sTextPathFromInitialEntity.substring(0, sTextPathFromInitialEntity.lastIndexOf("/"));
          /**
           * The property Text must be added only if the property is
           * - not part of a star property (.i.e '*' or 'navigation/*') or a targeted Entity
           * - not include into the initial targeted properties of SideEffects
           *  Indeed in the two listed cases, the property containing text will be/is requested by initial SideEffects configuration.
           */

          if (sTargetTextPath && aEntitiesRequested.indexOf(sTargetCollectionPath) === -1 && aInitialProperties.indexOf(sTextPathFromInitialEntity) === -1) {
            var _mEntityType$resolveP;
            // The Text association is added as TargetEntities if it's contained on a different entitySet and not a complexType
            // Otherwise it's added as targetProperties
            if (sTargetTextPath.lastIndexOf("/") > -1 && ((_mEntityType$resolveP = mEntityType.resolvePath(sTargetCollectionPath)) === null || _mEntityType$resolveP === void 0 ? void 0 : _mEntityType$resolveP._type) === "NavigationProperty") {
              oSideEffect.TargetEntities.push({
                $NavigationPropertyPath: sTargetCollectionPath
              });
              aEntitiesRequested.push(sTargetCollectionPath);
            } else {
              oSideEffect.TargetProperties.push(sTextPathFromInitialEntity);
            }
          }
        }
      });
      return oSideEffect;
    }
    /**
     * Converts SideEffects to expected format
     *  - Converts SideEffects targets to expected format
     *  - Removes binding parameter from SideEffects targets properties
     *  - Adds the text properties
     *  - Replaces TargetProperties having reference to Source Properties for a SideEffects.
     *
     * @private
     * @ui5-restricted
     * @param oSideEffects SideEffects definition
     * @param mEntityType Entity type
     * @param sBindingParameter Name of the binding parameter
     * @returns SideEffects definition
     */;
    _proto._convertSideEffects = function _convertSideEffects(oSideEffects, mEntityType, sBindingParameter) {
      const oTempSideEffects = this._removeBindingParameter(this._convertTargetsFormat(oSideEffects), sBindingParameter);
      return this._addRequiredTextProperties(oTempSideEffects, mEntityType);
    }

    /**
     * Converts SideEffects targets (TargetEntities and TargetProperties) to expected format
     *  - TargetProperties as array of string
     *  - TargetEntities as array of object with property $NavigationPropertyPath.
     *
     * @private
     * @ui5-restricted
     * @param oSideEffects SideEffects definition
     * @returns Converted SideEffects
     */;
    _proto._convertTargetsFormat = function _convertTargetsFormat(oSideEffects) {
      const TargetProperties = (oSideEffects.TargetProperties || []).reduce((aTargetProperties, vTarget) => {
          const sTarget = vTarget.type && vTarget.value || vTarget;
          if (sTarget) {
            aTargetProperties.push(sTarget);
          } else {
            Log.error(`SideEffects - Error while processing TargetProperties for SideEffects${oSideEffects.fullyQualifiedName}`);
          }
          return aTargetProperties;
        }, []),
        TargetEntities = (oSideEffects.TargetEntities || []).map(mTargetEntity => {
          return {
            $NavigationPropertyPath: mTargetEntity.value || ""
          };
        });
      return {
        ...oSideEffects,
        ...{
          TargetProperties,
          TargetEntities
        }
      };
    }

    /**
     * Gets SideEffects related to an entity type or action that come from an OData Service
     * Internal routine to get, from converted oData metaModel, SideEffects related to a specific entity type or action
     * and to convert these SideEffects with expected format.
     *
     * @private
     * @ui5-restricted
     * @param oSource Entity type or action
     * @returns Array of SideEffects
     */;
    _proto._getSideEffectsFromSource = function _getSideEffectsFromSource(oSource) {
      const aSideEffects = [];
      const mEntityType = oSource._type === "EntityType" ? oSource : oSource.sourceEntityType;
      if (mEntityType) {
        var _oSource$annotations;
        const mCommonAnnotation = ((_oSource$annotations = oSource.annotations) === null || _oSource$annotations === void 0 ? void 0 : _oSource$annotations.Common) || {};
        const mBindingParameter = (oSource.parameters || []).find(mParameter => mParameter.type === mEntityType.fullyQualifiedName);
        const sBindingParameter = mBindingParameter ? mBindingParameter.fullyQualifiedName.split("/")[1] : "";
        Object.keys(mCommonAnnotation).filter(sAnnotationName => mCommonAnnotation[sAnnotationName].$Type === "com.sap.vocabularies.Common.v1.SideEffectsType").forEach(sAnnotationName => {
          aSideEffects.push(this._convertSideEffects(mCommonAnnotation[sAnnotationName], mEntityType, sBindingParameter));
        });
      }
      return aSideEffects;
    }

    /**
     * Logs SideEffects request.
     *
     * @private
     * @ui5-restricted
     * @param aPathExpressions SideEffects targets
     * @param oContext Context
     */;
    _proto._logRequest = function _logRequest(aPathExpressions, oContext) {
      const sTargetPaths = aPathExpressions.reduce(function (sPaths, mTarget) {
        return `${sPaths}\n\t\t${mTarget.$NavigationPropertyPath || mTarget || ""}`;
      }, "");
      Log.debug(`SideEffects - Request:\n\tContext path : ${oContext.getPath()}\n\tProperty paths :${sTargetPaths}`);
    }

    /**
     * Removes name of binding parameter on SideEffects targets.
     *
     * @private
     * @ui5-restricted
     * @param oSideEffects SideEffects definition
     * @param sBindingParameterName Name of binding parameter
     * @returns SideEffects definition
     */;
    _proto._removeBindingParameter = function _removeBindingParameter(oSideEffects, sBindingParameterName) {
      if (sBindingParameterName) {
        const replaceBindingParameter = function (value) {
          return value.replace(new RegExp(`^${sBindingParameterName}/?`), "");
        };
        oSideEffects.TargetProperties = oSideEffects.TargetProperties.map(targetProperty => replaceBindingParameter(targetProperty));
        oSideEffects.TargetEntities = oSideEffects.TargetEntities.map(targetEntity => {
          return {
            $NavigationPropertyPath: replaceBindingParameter(targetEntity.$NavigationPropertyPath)
          };
        });
      }
      return oSideEffects;
    }

    /**
     * Remove duplicates in SideEffects targets.
     *
     * @private
     * @ui5-restricted
     * @param targetProperties SideEffects TargetProperties
     * @param targetEntities SideEffects TargetEntities
     * @returns SideEffects targets without duplicates
     */;
    _proto._removeDuplicateTargets = function _removeDuplicateTargets(targetProperties, targetEntities) {
      const uniqueTargetedEntitiesPath = new Set([]);
      const uniqueTargetProperties = new Set(targetProperties);
      const uniqueTargetedEntities = targetEntities.filter(targetEntity => {
        const navigationPath = targetEntity.$NavigationPropertyPath;
        if (!uniqueTargetedEntitiesPath.has(navigationPath)) {
          uniqueTargetedEntitiesPath.add(navigationPath);
          return true;
        }
        return false;
      });
      return {
        TargetProperties: Array.from(uniqueTargetProperties),
        TargetEntities: uniqueTargetedEntities
      };
    }

    /**
     * Gets SideEffects action type that come from an OData Service
     * Internal routine to get, from converted oData metaModel, SideEffects on actions
     * related to a specific entity type and to convert these SideEffects with
     * expected format.
     *
     * @private
     * @ui5-restricted
     * @param entityType Entity type
     * @returns Entity type SideEffects dictionary
     */;
    _proto._retrieveODataActionsSideEffects = function _retrieveODataActionsSideEffects(entityType) {
      const sideEffects = {};
      const actions = entityType.actions;
      if (actions) {
        Object.keys(actions).forEach(actionName => {
          const action = entityType.actions[actionName];
          const triggerActions = new Set();
          let targetProperties = [];
          let targetEntities = [];
          this._getSideEffectsFromSource(action).forEach(oDataSideEffect => {
            const triggerAction = oDataSideEffect.TriggerAction;
            targetProperties = targetProperties.concat(oDataSideEffect.TargetProperties);
            targetEntities = targetEntities.concat(oDataSideEffect.TargetEntities);
            if (triggerAction) {
              triggerActions.add(triggerAction);
            }
          });
          const sideEffectsTargets = this._removeDuplicateTargets(targetProperties, targetEntities);
          sideEffects[actionName] = {
            pathExpressions: [...sideEffectsTargets.TargetProperties, ...sideEffectsTargets.TargetEntities],
            triggerActions: Array.from(triggerActions)
          };
        });
      }
      return sideEffects;
    }

    /**
     * Gets SideEffects entity type that come from an OData Service
     * Internal routine to get, from converted oData metaModel, SideEffects
     * related to a specific entity type and to convert these SideEffects with
     * expected format.
     *
     * @private
     * @ui5-restricted
     * @param mEntityType Entity type
     * @returns Entity type SideEffects dictionary
     */;
    _proto._retrieveODataEntitySideEffects = function _retrieveODataEntitySideEffects(mEntityType) {
      const oEntitySideEffects = {};
      this._getSideEffectsFromSource(mEntityType).forEach(oSideEffects => {
        oEntitySideEffects[oSideEffects.fullyQualifiedName] = oSideEffects;
      });
      return oEntitySideEffects;
    };
    _proto.getInterface = function getInterface() {
      return this;
    };
    return SideEffectsService;
  }(Service);
  _exports.SideEffectsService = SideEffectsService;
  let SideEffectsServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(SideEffectsServiceFactory, _ServiceFactory);
    function SideEffectsServiceFactory() {
      return _ServiceFactory.apply(this, arguments) || this;
    }
    var _proto2 = SideEffectsServiceFactory.prototype;
    _proto2.createInstance = function createInstance(oServiceContext) {
      const SideEffectsServiceService = new SideEffectsService(oServiceContext);
      return SideEffectsServiceService.initPromise;
    };
    return SideEffectsServiceFactory;
  }(ServiceFactory);
  return SideEffectsServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/SideEffectsServiceFactory", ["sap/base/Log","sap/fe/core/converters/MetaModelConverter","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory","../templating/PropertyHelper"],function(t,e,i,r,o){"use strict";var n={};var s=o.isPathExpression;var a=e.convertTypes;function c(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;f(t,e)}function f(t,e){f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,i){e.__proto__=i;return e};return f(t,e)}let u=function(e){c(i,e);function i(){return e.apply(this,arguments)||this}n.SideEffectsService=i;var r=i.prototype;r.init=function t(){this._oSideEffectsType={oData:{entities:{},actions:{}},control:{}};this._bInitialized=false;this.initPromise=Promise.resolve(this)};r.addControlSideEffects=function t(e,i){if(i.sourceControlId){const t={...i,fullyQualifiedName:`${e}/SideEffectsForControl/${i.sourceControlId}`};const r=this._oSideEffectsType.control[e]||{};r[t.sourceControlId]=t;this._oSideEffectsType.control[e]=r}};r.executeAction=function t(e,i,r){const o=i.getModel().bindContext(`${e}(...)`,i);return o.execute(r||i.getBinding().getUpdateGroupId())};r.getConvertedMetaModel=function t(){const e=this.getContext();const i=e.scopeObject;const r=i.getModel().getMetaModel();return a(r,this._oCapabilities)};r.getEntityTypeFromContext=function t(e){const i=e.getModel().getMetaModel(),r=i.getMetaPath(e.getPath()),o=i.getObject(r)["$Type"];return o};r.getODataEntitySideEffects=function t(e){return this._oSideEffectsType.oData.entities[e]||{}};r.getGlobalODataEntitySideEffects=function t(e){const i=this.getODataEntitySideEffects(e);const r=[];for(const t in i){const e=i[t];if(!e.SourceEntities&&!e.SourceProperties){r.push(e)}}return r};r.getODataActionSideEffects=function t(e,i){if(i){const t=this.getEntityTypeFromContext(i);if(t){var r;return(r=this._oSideEffectsType.oData.actions[t])===null||r===void 0?void 0:r[e]}}return undefined};r.initializeSideEffects=function t(e){this._oCapabilities=e;if(!this._bInitialized){const t=this.getConvertedMetaModel();t.entityTypes.forEach(t=>{this._oSideEffectsType.oData.entities[t.fullyQualifiedName]=this._retrieveODataEntitySideEffects(t);this._oSideEffectsType.oData.actions[t.fullyQualifiedName]=this._retrieveODataActionsSideEffects(t)});this._bInitialized=true}};r.removeControlSideEffects=function t(e){Object.keys(this._oSideEffectsType.control).forEach(t=>{if(this._oSideEffectsType.control[t][e]){delete this._oSideEffectsType.control[t][e]}})};r.requestSideEffects=async function t(e,i,r){this._logRequest(e,i);return i.requestSideEffects(e,r)};r.requestSideEffectsForODataAction=function t(e,i){var r,o;let n;if((r=e.triggerActions)!==null&&r!==void 0&&r.length){n=e.triggerActions.map(t=>this.executeAction(t,i))}else{n=[]}if((o=e.pathExpressions)!==null&&o!==void 0&&o.length){n.push(this.requestSideEffects(e.pathExpressions,i))}return n.length?Promise.all(n):Promise.resolve()};r.requestSideEffectsForNavigationProperty=function e(i,r){const o=this.getEntityTypeFromContext(r);if(o){const e=`${i}/`;const n=this.getODataEntitySideEffects(o);let s=[];let a=[];let c=[];Object.keys(n).filter(t=>{const r=n[t];return(r.SourceProperties||[]).some(t=>{const i=t.value;return i.startsWith(e)&&i.replace(e,"").indexOf("/")===-1})||(r.SourceEntities||[]).some(t=>t.value===i)}).forEach(t=>{const e=n[t];if(e.TriggerAction){this.executeAction(e.TriggerAction,r)}s=s.concat(e.TargetProperties);a=a.concat(e.TargetEntities)});const f=this._removeDuplicateTargets(s,a);c=[...f.TargetProperties,...f.TargetEntities];if(c.length>0){return this.requestSideEffects(c,r).catch(e=>t.error(`SideEffects - Error while processing SideEffects for Navigation Property ${i}`,e))}}return Promise.resolve()};r.getControlEntitySideEffects=function t(e){return this._oSideEffectsType.control[e]||{}};r._addRequiredTextProperties=function e(i,r){const o=i.TargetProperties,n=i.TargetEntities.map(t=>t.$NavigationPropertyPath);let a=[];o.forEach(e=>{var i;const o=e.endsWith("*"),s=e.substring(0,e.lastIndexOf("/")),c=s?`${s}/`:"",f=r.resolvePath(s)||r;const u=f.entityProperties||((i=f.targetType)===null||i===void 0?void 0:i.properties)||f.targetType.entityProperties;if(u){if(o){n.push(s);a=a.concat(u.map(t=>({navigationPath:c,property:t})))}else{a.push({property:u.find(t=>t.name===e.split("/").pop()),navigationPath:c})}}else{t.info(`SideEffects - The entity type associated to property path ${e} cannot be resolved`)}});a.forEach(t=>{var e,a,c;const f=(e=t.property)===null||e===void 0?void 0:(a=e.annotations)===null||a===void 0?void 0:(c=a.Common)===null||c===void 0?void 0:c.Text;if(f&&s(f)){const e=f.path,s=t.navigationPath+e,a=s.substring(0,s.lastIndexOf("/"));if(e&&n.indexOf(a)===-1&&o.indexOf(s)===-1){var u;if(e.lastIndexOf("/")>-1&&((u=r.resolvePath(a))===null||u===void 0?void 0:u._type)==="NavigationProperty"){i.TargetEntities.push({$NavigationPropertyPath:a});n.push(a)}else{i.TargetProperties.push(s)}}}});return i};r._convertSideEffects=function t(e,i,r){const o=this._removeBindingParameter(this._convertTargetsFormat(e),r);return this._addRequiredTextProperties(o,i)};r._convertTargetsFormat=function e(i){const r=(i.TargetProperties||[]).reduce((e,r)=>{const o=r.type&&r.value||r;if(o){e.push(o)}else{t.error(`SideEffects - Error while processing TargetProperties for SideEffects${i.fullyQualifiedName}`)}return e},[]),o=(i.TargetEntities||[]).map(t=>({$NavigationPropertyPath:t.value||""}));return{...i,...{TargetProperties:r,TargetEntities:o}}};r._getSideEffectsFromSource=function t(e){const i=[];const r=e._type==="EntityType"?e:e.sourceEntityType;if(r){var o;const t=((o=e.annotations)===null||o===void 0?void 0:o.Common)||{};const n=(e.parameters||[]).find(t=>t.type===r.fullyQualifiedName);const s=n?n.fullyQualifiedName.split("/")[1]:"";Object.keys(t).filter(e=>t[e].$Type==="com.sap.vocabularies.Common.v1.SideEffectsType").forEach(e=>{i.push(this._convertSideEffects(t[e],r,s))})}return i};r._logRequest=function e(i,r){const o=i.reduce(function(t,e){return`${t}\n\t\t${e.$NavigationPropertyPath||e||""}`},"");t.debug(`SideEffects - Request:\n\tContext path : ${r.getPath()}\n\tProperty paths :${o}`)};r._removeBindingParameter=function t(e,i){if(i){const t=function(t){return t.replace(new RegExp(`^${i}/?`),"")};e.TargetProperties=e.TargetProperties.map(e=>t(e));e.TargetEntities=e.TargetEntities.map(e=>({$NavigationPropertyPath:t(e.$NavigationPropertyPath)}))}return e};r._removeDuplicateTargets=function t(e,i){const r=new Set([]);const o=new Set(e);const n=i.filter(t=>{const e=t.$NavigationPropertyPath;if(!r.has(e)){r.add(e);return true}return false});return{TargetProperties:Array.from(o),TargetEntities:n}};r._retrieveODataActionsSideEffects=function t(e){const i={};const r=e.actions;if(r){Object.keys(r).forEach(t=>{const r=e.actions[t];const o=new Set;let n=[];let s=[];this._getSideEffectsFromSource(r).forEach(t=>{const e=t.TriggerAction;n=n.concat(t.TargetProperties);s=s.concat(t.TargetEntities);if(e){o.add(e)}});const a=this._removeDuplicateTargets(n,s);i[t]={pathExpressions:[...a.TargetProperties,...a.TargetEntities],triggerActions:Array.from(o)}})}return i};r._retrieveODataEntitySideEffects=function t(e){const i={};this._getSideEffectsFromSource(e).forEach(t=>{i[t.fullyQualifiedName]=t});return i};r.getInterface=function t(){return this};return i}(i);n.SideEffectsService=u;let p=function(t){c(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.createInstance=function t(e){const i=new u(e);return i.initPromise};return e}(r);return p},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/TemplatedViewServiceFactory-dbg", ["sap/base/Log", "sap/base/util/UriParameters", "sap/fe/core/helpers/LoaderUtils", "sap/fe/core/TemplateModel", "sap/ui/core/Component", "sap/ui/core/mvc/View", "sap/ui/core/service/Service", "sap/ui/core/service/ServiceFactory", "sap/ui/core/service/ServiceFactoryRegistry", "sap/ui/Device", "sap/ui/model/base/ManagedObjectModel", "sap/ui/model/json/JSONModel", "sap/ui/VersionInfo", "../helpers/DynamicAnnotationPathHelper"], function (Log, UriParameters, LoaderUtils, TemplateModel, Component, View, Service, ServiceFactory, ServiceFactoryRegistry, Device, ManagedObjectModel, JSONModel, VersionInfo, DynamicAnnotationPathHelper) {
  "use strict";

  var resolveDynamicExpression = DynamicAnnotationPathHelper.resolveDynamicExpression;
  var requireDependencies = LoaderUtils.requireDependencies;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let TemplatedViewService = /*#__PURE__*/function (_Service) {
    _inheritsLoose(TemplatedViewService, _Service);
    function TemplatedViewService() {
      return _Service.apply(this, arguments) || this;
    }
    var _proto = TemplatedViewService.prototype;
    _proto.init = function init() {
      const aServiceDependencies = [];
      const oContext = this.getContext();
      const oComponent = oContext.scopeObject;
      const oAppComponent = Component.getOwnerComponentFor(oComponent);
      const oMetaModel = oAppComponent.getMetaModel();
      const sStableId = `${oAppComponent.getMetadata().getComponentName()}::${oAppComponent.getLocalId(oComponent.getId())}`;
      const aEnhanceI18n = oComponent.getEnhanceI18n() || [];
      let sAppNamespace;
      this.oFactory = oContext.factory;
      if (aEnhanceI18n) {
        sAppNamespace = oAppComponent.getMetadata().getComponentName();
        for (let i = 0; i < aEnhanceI18n.length; i++) {
          // In order to support text-verticalization applications can also passs a resource model defined in the manifest
          // UI5 takes care of text-verticalization for resource models defined in the manifest
          // Hence check if the given key is a resource model defined in the manifest
          // if so this model should be used to enhance the sap.fe resource model so pass it as it is
          const oResourceModel = oAppComponent.getModel(aEnhanceI18n[i]);
          if (oResourceModel && oResourceModel.isA("sap.ui.model.resource.ResourceModel")) {
            aEnhanceI18n[i] = oResourceModel;
          } else {
            aEnhanceI18n[i] = `${sAppNamespace}.${aEnhanceI18n[i].replace(".properties", "")}`;
          }
        }
      }
      const sCacheIdentifier = `${oAppComponent.getMetadata().getName()}_${sStableId}_${sap.ui.getCore().getConfiguration().getLanguageTag()}`;
      aServiceDependencies.push(ServiceFactoryRegistry.get("sap.fe.core.services.ResourceModelService").createInstance({
        scopeType: "component",
        scopeObject: oComponent,
        settings: {
          bundles: ["sap.fe.core.messagebundle", "sap.fe.macros.messagebundle", "sap.fe.templates.messagebundle"],
          enhanceI18n: aEnhanceI18n,
          modelName: "sap.fe.i18n"
        }
      }).then(oResourceModelService => {
        this.oResourceModelService = oResourceModelService;
        return oResourceModelService.getResourceModel();
      }));
      aServiceDependencies.push(ServiceFactoryRegistry.get("sap.fe.core.services.CacheHandlerService").createInstance({
        settings: {
          metaModel: oMetaModel,
          appComponent: oAppComponent,
          component: oComponent
        }
      }).then(oCacheHandlerService => {
        this.oCacheHandlerService = oCacheHandlerService;
        return oCacheHandlerService.validateCacheKey(sCacheIdentifier, oComponent);
      }));
      aServiceDependencies.push(VersionInfo.load().then(function (oInfo) {
        let sTimestamp = "";
        if (!oInfo.libraries) {
          sTimestamp = sap.ui.buildinfo.buildtime;
        } else {
          oInfo.libraries.forEach(function (oLibrary) {
            sTimestamp += oLibrary.buildTimestamp;
          });
        }
        return sTimestamp;
      }).catch(function () {
        return "<NOVALUE>";
      }));
      this.initPromise = Promise.all(aServiceDependencies).then(async aDependenciesResult => {
        const oResourceModel = aDependenciesResult[0];
        const sCacheKey = aDependenciesResult[1];
        const oSideEffectsServices = oAppComponent.getSideEffectsService();
        oSideEffectsServices.initializeSideEffects(oAppComponent.getEnvironmentCapabilities().getCapabilities());
        const [TemplateConverter, MetaModelConverter] = await requireDependencies(["sap/fe/core/converters/TemplateConverter", "sap/fe/core/converters/MetaModelConverter"]);
        return this.createView(oResourceModel, sStableId, sCacheKey, TemplateConverter, MetaModelConverter);
      }).then(function (sCacheKey) {
        const oCacheHandlerService = ServiceFactoryRegistry.get("sap.fe.core.services.CacheHandlerService").getInstance(oMetaModel);
        oCacheHandlerService.invalidateIfNeeded(sCacheKey, sCacheIdentifier, oComponent);
      });
    }

    /**
     * Refresh the current view using the same configuration as before.
     *
     * @param oComponent
     * @returns A promise indicating when the view is refreshed
     * @private
     */;
    _proto.refreshView = function refreshView(oComponent) {
      const oRootView = oComponent.getRootControl();
      if (oRootView) {
        oRootView.destroy();
      } else if (this.oView) {
        this.oView.destroy();
      }
      return this.createView(this.resourceModel, this.stableId, "", this.TemplateConverter, this.MetaModelConverter).then(function () {
        oComponent.oContainer.invalidate();
      }).catch(function (oError) {
        oComponent.oContainer.invalidate();
        Log.error(oError);
      });
    };
    _proto.createView = async function createView(oResourceModel, sStableId, sCacheKey, TemplateConverter, MetaModelConverter) {
      this.resourceModel = oResourceModel;
      this.stableId = sStableId;
      this.TemplateConverter = TemplateConverter;
      this.MetaModelConverter = MetaModelConverter;
      const oContext = this.getContext();
      const mServiceSettings = oContext.settings;
      const sConverterType = mServiceSettings.converterType;
      const oComponent = oContext.scopeObject;
      const oAppComponent = Component.getOwnerComponentFor(oComponent);
      const sFullContextPath = oAppComponent.getRoutingService().getTargetInformationFor(oComponent).options.settings.fullContextPath;
      const oMetaModel = oAppComponent.getMetaModel();
      const oManifestContent = oAppComponent.getManifest();
      const oDeviceModel = new JSONModel(Device).setDefaultBindingMode("OneWay");
      const oManifestModel = new JSONModel(oManifestContent);
      const bError = false;
      let oPageModel, oViewDataModel, oViewSettings, mViewData;
      // Load the index for the additional building blocks which is responsible for initializing them
      function getViewSettings() {
        const aSplitPath = sFullContextPath.split("/");
        const sEntitySetPath = aSplitPath.reduce(function (sPathSoFar, sNextPathPart) {
          if (sNextPathPart === "") {
            return sPathSoFar;
          }
          if (sPathSoFar === "") {
            sPathSoFar = `/${sNextPathPart}`;
          } else {
            const oTarget = oMetaModel.getObject(`${sPathSoFar}/$NavigationPropertyBinding/${sNextPathPart}`);
            if (oTarget && Object.keys(oTarget).length > 0) {
              sPathSoFar += "/$NavigationPropertyBinding";
            }
            sPathSoFar += `/${sNextPathPart}`;
          }
          return sPathSoFar;
        }, "");
        let viewType = mServiceSettings.viewType || oComponent.getViewType() || "XML";
        if (viewType !== "XML") {
          viewType = undefined;
        }
        return {
          type: viewType,
          preprocessors: {
            xml: {
              bindingContexts: {
                entitySet: sEntitySetPath ? oMetaModel.createBindingContext(sEntitySetPath) : null,
                fullContextPath: sFullContextPath ? oMetaModel.createBindingContext(sFullContextPath) : null,
                contextPath: sFullContextPath ? oMetaModel.createBindingContext(sFullContextPath) : null,
                converterContext: oPageModel.createBindingContext("/", undefined, {
                  noResolve: true
                }),
                viewData: mViewData ? oViewDataModel.createBindingContext("/") : null
              },
              models: {
                entitySet: oMetaModel,
                fullContextPath: oMetaModel,
                contextPath: oMetaModel,
                "sap.fe.i18n": oResourceModel,
                metaModel: oMetaModel,
                device: oDeviceModel,
                manifest: oManifestModel,
                converterContext: oPageModel,
                viewData: oViewDataModel
              },
              appComponent: oAppComponent
            }
          },
          id: sStableId,
          viewName: mServiceSettings.viewName || oComponent.getViewName(),
          viewData: mViewData,
          cache: {
            keys: [sCacheKey],
            additionalData: {
              // We store the page model data in the `additionalData` of the view cache, this way it is always in sync
              getAdditionalCacheData: () => {
                return oPageModel.getData();
              },
              setAdditionalCacheData: value => {
                oPageModel.setData(value);
              }
            }
          },
          models: {
            "sap.fe.i18n": oResourceModel
          },
          height: "100%"
        };
      }
      const createErrorPage = reason => {
        // just replace the view name and add an additional model containing the reason, but
        // keep the other settings
        Log.error(reason.message, reason);
        oViewSettings.viewName = mServiceSettings.errorViewName || "sap.fe.core.services.view.TemplatingErrorPage";
        oViewSettings.preprocessors.xml.models["error"] = new JSONModel(reason);
        return oComponent.runAsOwner(() => {
          return View.create(oViewSettings).then(oView => {
            this.oView = oView;
            this.oView.setModel(new ManagedObjectModel(this.oView), "$view");
            oComponent.setAggregation("rootControl", this.oView);
            return sCacheKey;
          });
        });
      };
      try {
        var _oManifestContent$sap;
        const oRoutingService = await oAppComponent.getService("routingService");
        // Retrieve the viewLevel for the component
        const oTargetInfo = oRoutingService.getTargetInformationFor(oComponent);
        const mOutbounds = oManifestContent["sap.app"] && oManifestContent["sap.app"].crossNavigation && oManifestContent["sap.app"].crossNavigation.outbounds || {};
        const mNavigation = oComponent.getNavigation() || {};
        Object.keys(mNavigation).forEach(function (navigationObjectKey) {
          const navigationObject = mNavigation[navigationObjectKey];
          let outboundConfig;
          if (navigationObject.detail && navigationObject.detail.outbound && mOutbounds[navigationObject.detail.outbound]) {
            outboundConfig = mOutbounds[navigationObject.detail.outbound];
            navigationObject.detail.outboundDetail = {
              semanticObject: outboundConfig.semanticObject,
              action: outboundConfig.action,
              parameters: outboundConfig.parameters
            };
          }
          if (navigationObject.create && navigationObject.create.outbound && mOutbounds[navigationObject.create.outbound]) {
            outboundConfig = mOutbounds[navigationObject.create.outbound];
            navigationObject.create.outboundDetail = {
              semanticObject: outboundConfig.semanticObject,
              action: outboundConfig.action,
              parameters: outboundConfig.parameters
            };
          }
        });
        mViewData = {
          navigation: mNavigation,
          viewLevel: oTargetInfo.viewLevel,
          stableId: sStableId,
          contentDensities: (_oManifestContent$sap = oManifestContent["sap.ui5"]) === null || _oManifestContent$sap === void 0 ? void 0 : _oManifestContent$sap.contentDensities,
          resourceBundle: oResourceModel.__bundle,
          fullContextPath: sFullContextPath,
          isDesktop: Device.system.desktop,
          isPhone: Device.system.phone
        };
        if (oComponent.getViewData) {
          Object.assign(mViewData, oComponent.getViewData());
        }
        const oShellServices = oAppComponent.getShellServices();
        mViewData.converterType = sConverterType;
        mViewData.shellContentDensity = oShellServices.getContentDensity();
        mViewData.useNewLazyLoading = UriParameters.fromQuery(window.location.search).get("sap-fe-xx-lazyloadingtest") === "true";
        mViewData.retrieveTextFromValueList = oManifestContent["sap.fe"] && oManifestContent["sap.fe"].form ? oManifestContent["sap.fe"].form.retrieveTextFromValueList : undefined;
        oViewDataModel = new JSONModel(mViewData);
        if (mViewData.controlConfiguration) {
          for (const sAnnotationPath in mViewData.controlConfiguration) {
            if (sAnnotationPath.indexOf("[") !== -1) {
              const sTargetAnnotationPath = resolveDynamicExpression(sAnnotationPath, oMetaModel);
              mViewData.controlConfiguration[sTargetAnnotationPath] = mViewData.controlConfiguration[sAnnotationPath];
            }
          }
        }
        MetaModelConverter.convertTypes(oMetaModel, oAppComponent.getEnvironmentCapabilities().getCapabilities());
        oPageModel = new TemplateModel(() => {
          try {
            const oDiagnostics = oAppComponent.getDiagnostics();
            const iIssueCount = oDiagnostics.getIssues().length;
            const oConverterPageModel = TemplateConverter.convertPage(sConverterType, oMetaModel, mViewData, oDiagnostics, sFullContextPath, oAppComponent.getEnvironmentCapabilities().getCapabilities(), oComponent);
            const aIssues = oDiagnostics.getIssues();
            const aAddedIssues = aIssues.slice(iIssueCount);
            if (aAddedIssues.length > 0) {
              Log.warning("Some issues have been detected in your project, please check the UI5 support assistant rule for sap.fe.core");
            }
            return oConverterPageModel;
          } catch (error) {
            Log.error(error, error);
            return {};
          }
        }, oMetaModel);
        if (!bError) {
          oViewSettings = getViewSettings();
          // Setting the pageModel on the component for potential reuse
          oComponent.setModel(oPageModel, "_pageModel");
          return oComponent.runAsOwner(() => {
            return View.create(oViewSettings).catch(createErrorPage).then(oView => {
              this.oView = oView;
              this.oView.setModel(new ManagedObjectModel(this.oView), "$view");
              this.oView.setModel(oViewDataModel, "viewData");
              oComponent.setAggregation("rootControl", this.oView);
              return sCacheKey;
            }).catch(e => Log.error(e.message, e));
          });
        }
      } catch (error) {
        Log.error(error.message, error);
        throw new Error(`Error while creating view : ${error}`);
      }
    };
    _proto.getView = function getView() {
      return this.oView;
    };
    _proto.getInterface = function getInterface() {
      return this;
    };
    _proto.exit = function exit() {
      // Deregister global instance
      if (this.oResourceModelService) {
        this.oResourceModelService.destroy();
      }
      if (this.oCacheHandlerService) {
        this.oCacheHandlerService.destroy();
      }
      this.oFactory.removeGlobalInstance();
    };
    return TemplatedViewService;
  }(Service);
  let TemplatedViewServiceFactory = /*#__PURE__*/function (_ServiceFactory) {
    _inheritsLoose(TemplatedViewServiceFactory, _ServiceFactory);
    function TemplatedViewServiceFactory() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _ServiceFactory.call(this, ...args) || this;
      _this._oInstanceRegistry = {};
      return _this;
    }
    var _proto2 = TemplatedViewServiceFactory.prototype;
    _proto2.createInstance = function createInstance(oServiceContext) {
      TemplatedViewServiceFactory.iCreatingViews++;
      const oTemplatedViewService = new TemplatedViewService(Object.assign({
        factory: this
      }, oServiceContext));
      return oTemplatedViewService.initPromise.then(function () {
        TemplatedViewServiceFactory.iCreatingViews--;
        return oTemplatedViewService;
      });
    };
    _proto2.removeGlobalInstance = function removeGlobalInstance() {
      this._oInstanceRegistry = {};
    };
    TemplatedViewServiceFactory.getNumberOfViewsInCreationState = function getNumberOfViewsInCreationState() {
      return TemplatedViewServiceFactory.iCreatingViews;
    };
    return TemplatedViewServiceFactory;
  }(ServiceFactory);
  return TemplatedViewServiceFactory;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/TemplatedViewServiceFactory", ["sap/base/Log","sap/base/util/UriParameters","sap/fe/core/helpers/LoaderUtils","sap/fe/core/TemplateModel","sap/ui/core/Component","sap/ui/core/mvc/View","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory","sap/ui/core/service/ServiceFactoryRegistry","sap/ui/Device","sap/ui/model/base/ManagedObjectModel","sap/ui/model/json/JSONModel","sap/ui/VersionInfo","../helpers/DynamicAnnotationPathHelper"],function(e,t,n,o,i,r,s,a,c,l,u,p,g,d){"use strict";var f=d.resolveDynamicExpression;var h=n.requireDependencies;function v(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;m(e,t)}function m(e,t){m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return m(e,t)}let w=function(n){v(s,n);function s(){return n.apply(this,arguments)||this}var a=s.prototype;a.init=function e(){const t=[];const n=this.getContext();const o=n.scopeObject;const r=i.getOwnerComponentFor(o);const s=r.getMetaModel();const a=`${r.getMetadata().getComponentName()}::${r.getLocalId(o.getId())}`;const l=o.getEnhanceI18n()||[];let u;this.oFactory=n.factory;if(l){u=r.getMetadata().getComponentName();for(let e=0;e<l.length;e++){const t=r.getModel(l[e]);if(t&&t.isA("sap.ui.model.resource.ResourceModel")){l[e]=t}else{l[e]=`${u}.${l[e].replace(".properties","")}`}}}const p=`${r.getMetadata().getName()}_${a}_${sap.ui.getCore().getConfiguration().getLanguageTag()}`;t.push(c.get("sap.fe.core.services.ResourceModelService").createInstance({scopeType:"component",scopeObject:o,settings:{bundles:["sap.fe.core.messagebundle","sap.fe.macros.messagebundle","sap.fe.templates.messagebundle"],enhanceI18n:l,modelName:"sap.fe.i18n"}}).then(e=>{this.oResourceModelService=e;return e.getResourceModel()}));t.push(c.get("sap.fe.core.services.CacheHandlerService").createInstance({settings:{metaModel:s,appComponent:r,component:o}}).then(e=>{this.oCacheHandlerService=e;return e.validateCacheKey(p,o)}));t.push(g.load().then(function(e){let t="";if(!e.libraries){t=sap.ui.buildinfo.buildtime}else{e.libraries.forEach(function(e){t+=e.buildTimestamp})}return t}).catch(function(){return"<NOVALUE>"}));this.initPromise=Promise.all(t).then(async e=>{const t=e[0];const n=e[1];const o=r.getSideEffectsService();o.initializeSideEffects(r.getEnvironmentCapabilities().getCapabilities());const[i,s]=await h(["sap/fe/core/converters/TemplateConverter","sap/fe/core/converters/MetaModelConverter"]);return this.createView(t,a,n,i,s)}).then(function(e){const t=c.get("sap.fe.core.services.CacheHandlerService").getInstance(s);t.invalidateIfNeeded(e,p,o)})};a.refreshView=function t(n){const o=n.getRootControl();if(o){o.destroy()}else if(this.oView){this.oView.destroy()}return this.createView(this.resourceModel,this.stableId,"",this.TemplateConverter,this.MetaModelConverter).then(function(){n.oContainer.invalidate()}).catch(function(t){n.oContainer.invalidate();e.error(t)})};a.createView=async function n(s,a,c,g,d){this.resourceModel=s;this.stableId=a;this.TemplateConverter=g;this.MetaModelConverter=d;const h=this.getContext();const v=h.settings;const m=v.converterType;const w=h.scopeObject;const C=i.getOwnerComponentFor(w);const b=C.getRoutingService().getTargetInformationFor(w).options.settings.fullContextPath;const y=C.getMetaModel();const M=C.getManifest();const V=new p(l).setDefaultBindingMode("OneWay");const O=new p(M);const x=false;let S,D,I,N;function j(){const e=b.split("/");const t=e.reduce(function(e,t){if(t===""){return e}if(e===""){e=`/${t}`}else{const n=y.getObject(`${e}/$NavigationPropertyBinding/${t}`);if(n&&Object.keys(n).length>0){e+="/$NavigationPropertyBinding"}e+=`/${t}`}return e},"");let n=v.viewType||w.getViewType()||"XML";if(n!=="XML"){n=undefined}return{type:n,preprocessors:{xml:{bindingContexts:{entitySet:t?y.createBindingContext(t):null,fullContextPath:b?y.createBindingContext(b):null,contextPath:b?y.createBindingContext(b):null,converterContext:S.createBindingContext("/",undefined,{noResolve:true}),viewData:N?D.createBindingContext("/"):null},models:{entitySet:y,fullContextPath:y,contextPath:y,"sap.fe.i18n":s,metaModel:y,device:V,manifest:O,converterContext:S,viewData:D},appComponent:C}},id:a,viewName:v.viewName||w.getViewName(),viewData:N,cache:{keys:[c],additionalData:{getAdditionalCacheData:()=>S.getData(),setAdditionalCacheData:e=>{S.setData(e)}}},models:{"sap.fe.i18n":s},height:"100%"}}const P=t=>{e.error(t.message,t);I.viewName=v.errorViewName||"sap.fe.core.services.view.TemplatingErrorPage";I.preprocessors.xml.models["error"]=new p(t);return w.runAsOwner(()=>r.create(I).then(e=>{this.oView=e;this.oView.setModel(new u(this.oView),"$view");w.setAggregation("rootControl",this.oView);return c}))};try{var T;const n=await C.getService("routingService");const i=n.getTargetInformationFor(w);const h=M["sap.app"]&&M["sap.app"].crossNavigation&&M["sap.app"].crossNavigation.outbounds||{};const v=w.getNavigation()||{};Object.keys(v).forEach(function(e){const t=v[e];let n;if(t.detail&&t.detail.outbound&&h[t.detail.outbound]){n=h[t.detail.outbound];t.detail.outboundDetail={semanticObject:n.semanticObject,action:n.action,parameters:n.parameters}}if(t.create&&t.create.outbound&&h[t.create.outbound]){n=h[t.create.outbound];t.create.outboundDetail={semanticObject:n.semanticObject,action:n.action,parameters:n.parameters}}});N={navigation:v,viewLevel:i.viewLevel,stableId:a,contentDensities:(T=M["sap.ui5"])===null||T===void 0?void 0:T.contentDensities,resourceBundle:s.__bundle,fullContextPath:b,isDesktop:l.system.desktop,isPhone:l.system.phone};if(w.getViewData){Object.assign(N,w.getViewData())}const V=C.getShellServices();N.converterType=m;N.shellContentDensity=V.getContentDensity();N.useNewLazyLoading=t.fromQuery(window.location.search).get("sap-fe-xx-lazyloadingtest")==="true";N.retrieveTextFromValueList=M["sap.fe"]&&M["sap.fe"].form?M["sap.fe"].form.retrieveTextFromValueList:undefined;D=new p(N);if(N.controlConfiguration){for(const e in N.controlConfiguration){if(e.indexOf("[")!==-1){const t=f(e,y);N.controlConfiguration[t]=N.controlConfiguration[e]}}}d.convertTypes(y,C.getEnvironmentCapabilities().getCapabilities());S=new o(()=>{try{const t=C.getDiagnostics();const n=t.getIssues().length;const o=g.convertPage(m,y,N,t,b,C.getEnvironmentCapabilities().getCapabilities(),w);const i=t.getIssues();const r=i.slice(n);if(r.length>0){e.warning("Some issues have been detected in your project, please check the UI5 support assistant rule for sap.fe.core")}return o}catch(t){e.error(t,t);return{}}},y);if(!x){I=j();w.setModel(S,"_pageModel");return w.runAsOwner(()=>r.create(I).catch(P).then(e=>{this.oView=e;this.oView.setModel(new u(this.oView),"$view");this.oView.setModel(D,"viewData");w.setAggregation("rootControl",this.oView);return c}).catch(t=>e.error(t.message,t)))}}catch(t){e.error(t.message,t);throw new Error(`Error while creating view : ${t}`)}};a.getView=function e(){return this.oView};a.getInterface=function e(){return this};a.exit=function e(){if(this.oResourceModelService){this.oResourceModelService.destroy()}if(this.oCacheHandlerService){this.oCacheHandlerService.destroy()}this.oFactory.removeGlobalInstance()};return s}(s);let C=function(e){v(t,e);function t(){var t;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++){o[i]=arguments[i]}t=e.call(this,...o)||this;t._oInstanceRegistry={};return t}var n=t.prototype;n.createInstance=function e(n){t.iCreatingViews++;const o=new w(Object.assign({factory:this},n));return o.initPromise.then(function(){t.iCreatingViews--;return o})};n.removeGlobalInstance=function e(){this._oInstanceRegistry={}};t.getNumberOfViewsInCreationState=function e(){return t.iCreatingViews};return t}(a);return C},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/view/TemplatingErrorPage-dbg.controller", ["sap/fe/core/controllerextensions/InternalRouting", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/mvc/Controller"], function (InternalRouting, ClassSupport, Controller) {
  "use strict";

  var _dec, _dec2, _class, _class2, _descriptor;
  var usingExtension = ClassSupport.usingExtension;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }
  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }
  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }
  let TemplatingErrorPage = (_dec = defineUI5Class("sap.fe.core.services.view.TemplatingErrorPage"), _dec2 = usingExtension(InternalRouting), _dec(_class = (_class2 = /*#__PURE__*/function (_Controller) {
    _inheritsLoose(TemplatingErrorPage, _Controller);
    function TemplatingErrorPage() {
      var _this;
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      _this = _Controller.call(this, ...args) || this;
      _initializerDefineProperty(_this, "_routing", _descriptor, _assertThisInitialized(_this));
      return _this;
    }
    return TemplatingErrorPage;
  }(Controller), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "_routing", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: null
  })), _class2)) || _class);
  return TemplatingErrorPage;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/services/view/TemplatingErrorPage.controller", ["sap/fe/core/controllerextensions/InternalRouting","sap/fe/core/helpers/ClassSupport","sap/ui/core/mvc/Controller"],function(e,r,i){"use strict";var t,n,o,a,l;var u=r.usingExtension;var c=r.defineUI5Class;function s(e,r,i,t){if(!i)return;Object.defineProperty(e,r,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(t):void 0})}function f(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function p(e,r){e.prototype=Object.create(r.prototype);e.prototype.constructor=e;b(e,r)}function b(e,r){b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(r,i){r.__proto__=i;return r};return b(e,r)}function d(e,r,i,t,n){var o={};Object.keys(t).forEach(function(e){o[e]=t[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=i.slice().reverse().reduce(function(i,t){return t(e,r,i)||i},o);if(n&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(n):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,r,o);o=null}return o}function v(e,r){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let g=(t=c("sap.fe.core.services.view.TemplatingErrorPage"),n=u(e),t(o=(a=function(e){p(r,e);function r(){var r;for(var i=arguments.length,t=new Array(i),n=0;n<i;n++){t[n]=arguments[n]}r=e.call(this,...t)||this;s(r,"_routing",l,f(r));return r}return r}(i),l=d(a.prototype,"_routing",[n],{configurable:true,enumerable:true,writable:true,initializer:null}),a))||o);return g},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/support/CommonHelper-dbg", ["sap/fe/core/converters/helpers/IssueManager", "sap/ui/support/library"], function (IssueManager, SupportLib) {
  "use strict";

  var _exports = {};
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategory = IssueManager.IssueCategory;
  const Categories = SupportLib.Categories,
    // Accessibility, Performance, Memory, ...
    Severity = SupportLib.Severity,
    // Hint, Warning, Error
    Audiences = SupportLib.Audiences; // Control, Internal, Application

  //**********************************************************
  // Rule Definitions
  //**********************************************************

  // Rule checks if objectPage componentContainer height is set
  _exports.Categories = Categories;
  _exports.Audiences = Audiences;
  _exports.Severity = Severity;
  const getSeverity = function (oSeverity) {
    switch (oSeverity) {
      case IssueSeverity.Low:
        return Severity.Low;
      case IssueSeverity.High:
        return Severity.High;
      case IssueSeverity.Medium:
        return Severity.Medium;
      // no default
    }
  };
  _exports.getSeverity = getSeverity;
  const getIssueByCategory = function (oIssueManager, oCoreFacade, issueCategoryType, issueSubCategoryType) {
    const mComponents = oCoreFacade.getComponents();
    let oAppComponent;
    Object.keys(mComponents).forEach(sKey => {
      var _oComponent$getMetada, _oComponent$getMetada2;
      const oComponent = mComponents[sKey];
      if ((oComponent === null || oComponent === void 0 ? void 0 : (_oComponent$getMetada = oComponent.getMetadata()) === null || _oComponent$getMetada === void 0 ? void 0 : (_oComponent$getMetada2 = _oComponent$getMetada.getParent()) === null || _oComponent$getMetada2 === void 0 ? void 0 : _oComponent$getMetada2.getName()) === "sap.fe.core.AppComponent") {
        oAppComponent = oComponent;
      }
    });
    if (oAppComponent) {
      const aIssues = oAppComponent.getDiagnostics().getIssuesByCategory(IssueCategory[issueCategoryType], issueSubCategoryType);
      aIssues.forEach(function (oElement) {
        oIssueManager.addIssue({
          severity: getSeverity(oElement.severity),
          details: oElement.details,
          context: {
            id: oElement.category
          }
        });
      });
    }
  };
  _exports.getIssueByCategory = getIssueByCategory;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/support/CommonHelper", ["sap/fe/core/converters/helpers/IssueManager","sap/ui/support/library"],function(e,t){"use strict";var s={};var i=e.IssueSeverity;var r=e.IssueCategory;const o=t.Categories,n=t.Severity,a=t.Audiences;s.Categories=o;s.Audiences=a;s.Severity=n;const c=function(e){switch(e){case i.Low:return n.Low;case i.High:return n.High;case i.Medium:return n.Medium}};s.getSeverity=c;const u=function(e,t,s,i){const o=t.getComponents();let n;Object.keys(o).forEach(e=>{var t,s;const i=o[e];if((i===null||i===void 0?void 0:(t=i.getMetadata())===null||t===void 0?void 0:(s=t.getParent())===null||s===void 0?void 0:s.getName())==="sap.fe.core.AppComponent"){n=i}});if(n){const t=n.getDiagnostics().getIssuesByCategory(r[s],i);t.forEach(function(t){e.addIssue({severity:c(t.severity),details:t.details,context:{id:t.category}})})}};s.getIssueByCategory=u;return s},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/support/Diagnostics-dbg", [], function () {
  "use strict";

  let Diagnostics = /*#__PURE__*/function () {
    function Diagnostics() {
      this._issues = [];
    }
    var _proto = Diagnostics.prototype;
    _proto.addIssue = function addIssue(issueCategory, issueSeverity, details, issueCategoryType, subCategory) {
      const checkIfIssueExists = this.checkIfIssueExists(issueCategory, issueSeverity, details, issueCategoryType, subCategory);
      if (!checkIfIssueExists) {
        this._issues.push({
          category: issueCategory,
          severity: issueSeverity,
          details: details,
          subCategory: subCategory
        });
      }
    };
    _proto.getIssues = function getIssues() {
      return this._issues;
    };
    _proto.getIssuesByCategory = function getIssuesByCategory(inCategory, subCategory) {
      if (subCategory) {
        return this._issues.filter(issue => issue.category === inCategory && issue.subCategory === subCategory);
      } else {
        return this._issues.filter(issue => issue.category === inCategory);
      }
    };
    _proto.checkIfIssueExists = function checkIfIssueExists(inCategory, severity, details, issueCategoryType, issueSubCategory) {
      if (issueCategoryType && issueCategoryType[inCategory] && issueSubCategory) {
        return this._issues.some(issue => issue.category === inCategory && issue.severity === severity && issue.details.replace(/\n/g, "") === details.replace(/\n/g, "") && issue.subCategory === issueSubCategory);
      }
      return this._issues.some(issue => issue.category === inCategory && issue.severity === severity && issue.details.replace(/\n/g, "") === details.replace(/\n/g, ""));
    };
    return Diagnostics;
  }();
  return Diagnostics;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/support/Diagnostics", [],function(){"use strict";let s=function(){function s(){this._issues=[]}var e=s.prototype;e.addIssue=function s(e,t,i,r,u){const n=this.checkIfIssueExists(e,t,i,r,u);if(!n){this._issues.push({category:e,severity:t,details:i,subCategory:u})}};e.getIssues=function s(){return this._issues};e.getIssuesByCategory=function s(e,t){if(t){return this._issues.filter(s=>s.category===e&&s.subCategory===t)}else{return this._issues.filter(s=>s.category===e)}};e.checkIfIssueExists=function s(e,t,i,r,u){if(r&&r[e]&&u){return this._issues.some(s=>s.category===e&&s.severity===t&&s.details.replace(/\n/g,"")===i.replace(/\n/g,"")&&s.subCategory===u)}return this._issues.some(s=>s.category===e&&s.severity===t&&s.details.replace(/\n/g,"")===i.replace(/\n/g,""))};return s}();return s},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/CommonFormatters-dbg", ["sap/fe/core/formatters/ValueFormatter", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/templating/DataModelPathHelper", "sap/fe/core/templating/PropertyHelper", "sap/fe/core/templating/UIFormatters", "../converters/helpers/DataFieldHelper"], function (valueFormatters, BindingToolkit, DataModelPathHelper, PropertyHelper, UIFormatters, DataFieldHelper) {
  "use strict";

  var _exports = {};
  var isReferencePropertyStaticallyHidden = DataFieldHelper.isReferencePropertyStaticallyHidden;
  var getRelativePaths = DataModelPathHelper.getRelativePaths;
  var getContextRelativeTargetObjectPath = DataModelPathHelper.getContextRelativeTargetObjectPath;
  var enhanceDataModelPath = DataModelPathHelper.enhanceDataModelPath;
  var pathInModel = BindingToolkit.pathInModel;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var formatWithTypeInformation = BindingToolkit.formatWithTypeInformation;
  var formatResult = BindingToolkit.formatResult;
  var compileExpression = BindingToolkit.compileExpression;
  // Import-export methods related to the common annotations used by the converter to use them in the templating through the Common Formatters.

  /**
   * Retrieves the expressionBinding created out of a binding expression.
   *
   * @param expression The expression which needs to be compiled
   * @returns The expression-binding string
   */
  const getExpressionBinding = function (expression) {
    return compileExpression(expression);
  };
  _exports.getExpressionBinding = getExpressionBinding;
  const getBindingWithTextArrangement = function (oPropertyDataModelPath, propertyBindingExpression, fieldFormatOptions) {
    var _oPropertyDefinition$, _oPropertyDefinition$2;
    const targetDisplayModeOverride = fieldFormatOptions === null || fieldFormatOptions === void 0 ? void 0 : fieldFormatOptions.displayMode;
    let outExpression = propertyBindingExpression;
    const oPropertyDefinition = oPropertyDataModelPath.targetObject.type === "PropertyPath" ? oPropertyDataModelPath.targetObject.$target : oPropertyDataModelPath.targetObject;
    const targetDisplayMode = targetDisplayModeOverride || UIFormatters.getDisplayMode(oPropertyDataModelPath);
    const commonText = (_oPropertyDefinition$ = oPropertyDefinition.annotations) === null || _oPropertyDefinition$ === void 0 ? void 0 : (_oPropertyDefinition$2 = _oPropertyDefinition$.Common) === null || _oPropertyDefinition$2 === void 0 ? void 0 : _oPropertyDefinition$2.Text;
    const relativeLocation = getRelativePaths(oPropertyDataModelPath);
    propertyBindingExpression = formatWithTypeInformation(oPropertyDefinition, propertyBindingExpression);
    if (targetDisplayMode !== "Value" && commonText) {
      switch (targetDisplayMode) {
        case "Description":
          outExpression = getExpressionFromAnnotation(commonText, relativeLocation);
          break;
        case "DescriptionValue":
          outExpression = formatResult([getExpressionFromAnnotation(commonText, relativeLocation), propertyBindingExpression], valueFormatters.formatWithBrackets);
          break;
        case "ValueDescription":
          outExpression = formatResult([propertyBindingExpression, getExpressionFromAnnotation(commonText, relativeLocation)], valueFormatters.formatWithBrackets);
          break;
      }
    }
    return outExpression;
  };
  _exports.getBindingWithTextArrangement = getBindingWithTextArrangement;
  const getBindingWithText = function (targetDataModelPath) {
    let propertyDataModelPath = targetDataModelPath;
    if (PropertyHelper.isPathExpression(targetDataModelPath === null || targetDataModelPath === void 0 ? void 0 : targetDataModelPath.targetObject)) {
      var _targetDataModelPath$;
      propertyDataModelPath = enhanceDataModelPath(targetDataModelPath, (_targetDataModelPath$ = targetDataModelPath.targetObject) === null || _targetDataModelPath$ === void 0 ? void 0 : _targetDataModelPath$.path);
    }
    const propertyDefinition = propertyDataModelPath.targetObject;
    let propertyBindingExpression = pathInModel(getContextRelativeTargetObjectPath(propertyDataModelPath));
    propertyBindingExpression = formatWithTypeInformation(propertyDefinition, propertyBindingExpression, true);
    const textArrangementBinding = getBindingWithTextArrangement(propertyDataModelPath, propertyBindingExpression);
    return propertyDefinition.annotations.UI && !isReferencePropertyStaticallyHidden(propertyDefinition.annotations.UI.DataFieldDefault) && compileExpression(textArrangementBinding) || undefined;
  };
  _exports.getBindingWithText = getBindingWithText;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/CommonFormatters", ["sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","../converters/helpers/DataFieldHelper"],function(t,e,a,r,n,o){"use strict";var i={};var s=o.isReferencePropertyStaticallyHidden;var c=a.getRelativePaths;var l=a.getContextRelativeTargetObjectPath;var p=a.enhanceDataModelPath;var d=e.pathInModel;var v=e.getExpressionFromAnnotation;var g=e.formatWithTypeInformation;var u=e.formatResult;var f=e.compileExpression;const h=function(t){return f(t)};i.getExpressionBinding=h;const m=function(e,a,r){var o,i;const s=r===null||r===void 0?void 0:r.displayMode;let l=a;const p=e.targetObject.type==="PropertyPath"?e.targetObject.$target:e.targetObject;const d=s||n.getDisplayMode(e);const f=(o=p.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:i.Text;const h=c(e);a=g(p,a);if(d!=="Value"&&f){switch(d){case"Description":l=v(f,h);break;case"DescriptionValue":l=u([v(f,h),a],t.formatWithBrackets);break;case"ValueDescription":l=u([a,v(f,h)],t.formatWithBrackets);break}}return l};i.getBindingWithTextArrangement=m;const b=function(t){let e=t;if(r.isPathExpression(t===null||t===void 0?void 0:t.targetObject)){var a;e=p(t,(a=t.targetObject)===null||a===void 0?void 0:a.path)}const n=e.targetObject;let o=d(l(e));o=g(n,o,true);const i=m(e,o);return n.annotations.UI&&!s(n.annotations.UI.DataFieldDefault)&&f(i)||undefined};i.getBindingWithText=b;return i},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/CriticalityFormatters-dbg", ["sap/fe/core/helpers/BindingToolkit", "sap/fe/core/templating/DataModelPathHelper"], function (BindingToolkit, DataModelPathHelper) {
  "use strict";

  var _exports = {};
  var getRelativePaths = DataModelPathHelper.getRelativePaths;
  var or = BindingToolkit.or;
  var ifElse = BindingToolkit.ifElse;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var equal = BindingToolkit.equal;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  /**
   * Returns an expression to set button type based on Criticality
   * Supported Criticality: Positive, Negative, Critical and Information leading to Success, Error, Warning and None state respectively.
   *
   * @function
   * @static
   * @name sap.fe.core.CriticalityFormatters.buildExpressionForCriticalityColor
   * @memberof sap.fe.core.CriticalityFormatters
   * @param oTarget A DataField a DataPoint or a DataModelObjectPath.
   * @param [oPropertyDataModelPath] DataModelObjectPath.
   * @returns An expression to deduce the state of an objectStatus.
   * @private
   * @ui5-restricted
   */
  const buildExpressionForCriticalityColor = (oTarget, oPropertyDataModelPath) => {
    const oAnnotationTarget = oTarget.targetObject ? oTarget.targetObject : oTarget;
    const oCriticalityProperty = oAnnotationTarget === null || oAnnotationTarget === void 0 ? void 0 : oAnnotationTarget.Criticality;
    const relativeLocation = oPropertyDataModelPath ? getRelativePaths(oPropertyDataModelPath) : undefined;
    const oCriticalityExpression = getExpressionFromAnnotation(oCriticalityProperty, relativeLocation);
    let sValueStateExpression;
    if (oCriticalityProperty) {
      sValueStateExpression = ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Negative")), equal(oCriticalityExpression, constant(1)), equal(oCriticalityExpression, constant("1"))), constant("Error"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Critical")), equal(oCriticalityExpression, constant(2)), equal(oCriticalityExpression, constant("2"))), constant("Warning"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Positive")), equal(oCriticalityExpression, constant(3)), equal(oCriticalityExpression, constant("3"))), constant("Success"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Information")), equal(oCriticalityExpression, constant(5)), equal(oCriticalityExpression, constant("5"))), constant("Information"), constant("None")))));
    } else {
      // Any other cases are not valid, the default value of 'None' will be returned
      sValueStateExpression = constant("None");
    }
    return compileExpression(sValueStateExpression);
  };

  /**
   * Returns an expression to set icon type based on Criticality
   * Supported Criticality: Positive, Negative, Critical and Information.
   *
   * @function
   * @static
   * @name sap.fe.core.CriticalityFormatters.buildExpressionForCriticalityIcon
   * @memberof sap.fe.core.CriticalityFormatters
   * @param oTarget A DataField a DataPoint or a DataModelObjectPath.
   * @param [oPropertyDataModelPath] DataModelObjectPath.
   * @returns An expression to deduce the icon of an objectStatus.
   * @private
   * @ui5-restricted
   */
  _exports.buildExpressionForCriticalityColor = buildExpressionForCriticalityColor;
  const buildExpressionForCriticalityIcon = (oTarget, oPropertyDataModelPath) => {
    const oAnnotationTarget = oTarget !== null && oTarget !== void 0 && oTarget.targetObject ? oTarget.targetObject : oTarget;
    const oCriticalityProperty = oAnnotationTarget === null || oAnnotationTarget === void 0 ? void 0 : oAnnotationTarget.Criticality;
    const relativeLocation = oPropertyDataModelPath ? getRelativePaths(oPropertyDataModelPath) : undefined;
    const oCriticalityExpression = getExpressionFromAnnotation(oCriticalityProperty, relativeLocation);
    const bCondition = (oAnnotationTarget === null || oAnnotationTarget === void 0 ? void 0 : oAnnotationTarget.CriticalityRepresentation) && (oAnnotationTarget === null || oAnnotationTarget === void 0 ? void 0 : oAnnotationTarget.CriticalityRepresentation) === "UI.CriticalityRepresentationType/WithoutIcon";
    let sIconPath;
    if (!bCondition) {
      if (oCriticalityProperty) {
        sIconPath = ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Negative")), equal(oCriticalityExpression, constant(1)), equal(oCriticalityExpression, constant("1"))), constant("sap-icon://message-error"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Critical")), equal(oCriticalityExpression, constant(2)), equal(oCriticalityExpression, constant("2"))), constant("sap-icon://message-warning"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Positive")), equal(oCriticalityExpression, constant(3)), equal(oCriticalityExpression, constant("3"))), constant("sap-icon://message-success"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Information")), equal(oCriticalityExpression, constant(5)), equal(oCriticalityExpression, constant("5"))), constant("sap-icon://message-information"), constant("")))));
      } else {
        sIconPath = constant("");
      }
    } else {
      sIconPath = constant("");
    }
    return compileExpression(sIconPath);
  };

  /**
   * Returns an expression to set button type based on Criticality
   * Supported Criticality: Positive and Negative leading to Accept and Reject button type respectively.
   *
   * @function
   * @static
   * @name sap.fe.core.CriticalityFormatters.buildExpressionForCriticalityButtonType
   * @memberof sap.fe.core.CriticalityFormatters
   * @param oTarget A DataField, DataPoint, DataModelObjectPath.
   * @returns An expression to deduce button type.
   * @private
   * @ui5-restricted
   */
  _exports.buildExpressionForCriticalityIcon = buildExpressionForCriticalityIcon;
  const buildExpressionForCriticalityButtonType = oTarget => {
    const oAnnotationTarget = oTarget !== null && oTarget !== void 0 && oTarget.targetObject ? oTarget.targetObject : oTarget;
    const oCriticalityProperty = oAnnotationTarget === null || oAnnotationTarget === void 0 ? void 0 : oAnnotationTarget.Criticality;
    const oCriticalityExpression = getExpressionFromAnnotation(oCriticalityProperty);
    let sButtonTypeExpression;
    if (oCriticalityProperty) {
      sButtonTypeExpression = ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Negative")), equal(oCriticalityExpression, constant(1)), equal(oCriticalityExpression, constant("1"))), constant("Reject"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Positive")), equal(oCriticalityExpression, constant(3)), equal(oCriticalityExpression, constant("3"))), constant("Accept"), constant("Default")));
    } else {
      // Any other cases are not valid, the default value of 'Default' will be returned
      sButtonTypeExpression = constant("Default");
    }
    return compileExpression(sButtonTypeExpression);
  };

  /**
   * Returns an expression to set color in MicroCharts based on Criticality
   * Supported Criticality: Positive, Negative and Critical leading to Good, Error and Critical color respectively.
   *
   * @function
   * @static
   * @name sap.fe.core.CriticalityFormatters.buildExpressionForCriticalityColorMicroChart
   * @memberof sap.fe.core.CriticalityFormatters
   * @param oTarget A DataField, DataPoint, DataModelObjectPath
   * @returns An expression to deduce colors in Microcharts
   * @private
   * @ui5-restricted
   */
  _exports.buildExpressionForCriticalityButtonType = buildExpressionForCriticalityButtonType;
  const buildExpressionForCriticalityColorMicroChart = oTarget => {
    const oAnnotationTarget = oTarget !== null && oTarget !== void 0 && oTarget.targetObject ? oTarget.targetObject : oTarget;
    const oCriticalityProperty = oAnnotationTarget === null || oAnnotationTarget === void 0 ? void 0 : oAnnotationTarget.Criticality;
    const oCriticalityExpression = getExpressionFromAnnotation(oCriticalityProperty);
    let sColorExpression;
    if (oCriticalityProperty) {
      sColorExpression = ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Negative")), equal(oCriticalityExpression, constant(1)), equal(oCriticalityExpression, constant("1"))), constant("Error"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Critical")), equal(oCriticalityExpression, constant(2)), equal(oCriticalityExpression, constant("2"))), constant("Critical"), ifElse(or(equal(oCriticalityExpression, constant("UI.CriticalityType/Positive")), equal(oCriticalityExpression, constant(3)), equal(oCriticalityExpression, constant("3"))), constant("Good"), constant("Neutral"))));
    } else {
      sColorExpression = constant("Neutral");
    }
    return compileExpression(sColorExpression);
  };
  _exports.buildExpressionForCriticalityColorMicroChart = buildExpressionForCriticalityColorMicroChart;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/CriticalityFormatters", ["sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper"],function(i,t){"use strict";var e={};var r=t.getRelativePaths;var o=i.or;var a=i.ifElse;var n=i.getExpressionFromAnnotation;var c=i.equal;var l=i.constant;var s=i.compileExpression;const y=(i,t)=>{const e=i.targetObject?i.targetObject:i;const y=e===null||e===void 0?void 0:e.Criticality;const p=t?r(t):undefined;const u=n(y,p);let v;if(y){v=a(o(c(u,l("UI.CriticalityType/Negative")),c(u,l(1)),c(u,l("1"))),l("Error"),a(o(c(u,l("UI.CriticalityType/Critical")),c(u,l(2)),c(u,l("2"))),l("Warning"),a(o(c(u,l("UI.CriticalityType/Positive")),c(u,l(3)),c(u,l("3"))),l("Success"),a(o(c(u,l("UI.CriticalityType/Information")),c(u,l(5)),c(u,l("5"))),l("Information"),l("None")))))}else{v=l("None")}return s(v)};e.buildExpressionForCriticalityColor=y;const p=(i,t)=>{const e=i!==null&&i!==void 0&&i.targetObject?i.targetObject:i;const y=e===null||e===void 0?void 0:e.Criticality;const p=t?r(t):undefined;const u=n(y,p);const v=(e===null||e===void 0?void 0:e.CriticalityRepresentation)&&(e===null||e===void 0?void 0:e.CriticalityRepresentation)==="UI.CriticalityRepresentationType/WithoutIcon";let C;if(!v){if(y){C=a(o(c(u,l("UI.CriticalityType/Negative")),c(u,l(1)),c(u,l("1"))),l("sap-icon://message-error"),a(o(c(u,l("UI.CriticalityType/Critical")),c(u,l(2)),c(u,l("2"))),l("sap-icon://message-warning"),a(o(c(u,l("UI.CriticalityType/Positive")),c(u,l(3)),c(u,l("3"))),l("sap-icon://message-success"),a(o(c(u,l("UI.CriticalityType/Information")),c(u,l(5)),c(u,l("5"))),l("sap-icon://message-information"),l("")))))}else{C=l("")}}else{C=l("")}return s(C)};e.buildExpressionForCriticalityIcon=p;const u=i=>{const t=i!==null&&i!==void 0&&i.targetObject?i.targetObject:i;const e=t===null||t===void 0?void 0:t.Criticality;const r=n(e);let y;if(e){y=a(o(c(r,l("UI.CriticalityType/Negative")),c(r,l(1)),c(r,l("1"))),l("Reject"),a(o(c(r,l("UI.CriticalityType/Positive")),c(r,l(3)),c(r,l("3"))),l("Accept"),l("Default")))}else{y=l("Default")}return s(y)};e.buildExpressionForCriticalityButtonType=u;const v=i=>{const t=i!==null&&i!==void 0&&i.targetObject?i.targetObject:i;const e=t===null||t===void 0?void 0:t.Criticality;const r=n(e);let y;if(e){y=a(o(c(r,l("UI.CriticalityType/Negative")),c(r,l(1)),c(r,l("1"))),l("Error"),a(o(c(r,l("UI.CriticalityType/Critical")),c(r,l(2)),c(r,l("2"))),l("Critical"),a(o(c(r,l("UI.CriticalityType/Positive")),c(r,l(3)),c(r,l("3"))),l("Good"),l("Neutral"))))}else{y=l("Neutral")}return s(y)};e.buildExpressionForCriticalityColorMicroChart=v;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/DataFieldFormatters-dbg", ["sap/fe/core/converters/MetaModelConverter", "sap/fe/core/templating/DataModelPathHelper", "sap/fe/core/templating/UIFormatters"], function (MetaModelConverter, DataModelPathHelper, UIFormatters) {
  "use strict";

  var _exports = {};
  var getConverterContext = UIFormatters.getConverterContext;
  var enhanceDataModelPath = DataModelPathHelper.enhanceDataModelPath;
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  const getDataField = function (oContext, oInterface) {
    const sPath = oInterface.context.getPath();
    if (!oContext) {
      throw new Error(`Unresolved context path ${sPath}`);
    }
    let isPath = false;
    if (typeof oContext === "object" && (oContext.hasOwnProperty("$Path") || oContext.hasOwnProperty("$AnnotationPath"))) {
      isPath = true;
    } else if (typeof oContext === "object" && oContext.hasOwnProperty("$kind") && oContext.$kind !== "Property") {
      throw new Error(`Context does not resolve to a DataField object but to a ${oContext.$kind}`);
    }
    let oConverterContext = getConverterContext(oContext, oInterface);
    if (isPath) {
      oConverterContext = oConverterContext.$target;
    }
    return oConverterContext;
  };
  _exports.getDataField = getDataField;
  const getDataFieldObjectPath = function (oContext, oInterface) {
    const sPath = oInterface.context.getPath();
    if (!oContext) {
      throw new Error(`Unresolved context path ${sPath}`);
    }
    if (typeof oContext === "object" && oContext.hasOwnProperty("$kind") && oContext.$kind !== "Property") {
      throw new Error(`Context does not resolve to a Property object but to a ${oContext.$kind}`);
    }
    let involvedDataModelObjects = getInvolvedDataModelObjects(oInterface.context);
    if (involvedDataModelObjects.targetObject && involvedDataModelObjects.targetObject.type === "Path") {
      involvedDataModelObjects = enhanceDataModelPath(involvedDataModelObjects, involvedDataModelObjects.targetObject.path);
    }
    if (involvedDataModelObjects.targetObject && involvedDataModelObjects.targetObject.type === "AnnotationPath") {
      involvedDataModelObjects = enhanceDataModelPath(involvedDataModelObjects, involvedDataModelObjects.targetObject);
    }
    if (sPath.endsWith("$Path") || sPath.endsWith("$AnnotationPath")) {
      involvedDataModelObjects = enhanceDataModelPath(involvedDataModelObjects, oContext);
    }
    return involvedDataModelObjects;
  };
  _exports.getDataFieldObjectPath = getDataFieldObjectPath;
  const isSemanticallyConnectedFields = function (oContext, oInterface) {
    const oDataField = getDataField(oContext, oInterface);
    return oDataField.$Type === "com.sap.vocabularies.UI.v1.ConnectedFieldsType";
  };
  _exports.isSemanticallyConnectedFields = isSemanticallyConnectedFields;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/DataFieldFormatters", ["sap/fe/core/converters/MetaModelConverter","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/UIFormatters"],function(t,e,o){"use strict";var n={};var r=o.getConverterContext;var a=e.enhanceDataModelPath;var c=t.getInvolvedDataModelObjects;const i=function(t,e){const o=e.context.getPath();if(!t){throw new Error(`Unresolved context path ${o}`)}let n=false;if(typeof t==="object"&&(t.hasOwnProperty("$Path")||t.hasOwnProperty("$AnnotationPath"))){n=true}else if(typeof t==="object"&&t.hasOwnProperty("$kind")&&t.$kind!=="Property"){throw new Error(`Context does not resolve to a DataField object but to a ${t.$kind}`)}let a=r(t,e);if(n){a=a.$target}return a};n.getDataField=i;const s=function(t,e){const o=e.context.getPath();if(!t){throw new Error(`Unresolved context path ${o}`)}if(typeof t==="object"&&t.hasOwnProperty("$kind")&&t.$kind!=="Property"){throw new Error(`Context does not resolve to a Property object but to a ${t.$kind}`)}let n=c(e.context);if(n.targetObject&&n.targetObject.type==="Path"){n=a(n,n.targetObject.path)}if(n.targetObject&&n.targetObject.type==="AnnotationPath"){n=a(n,n.targetObject)}if(o.endsWith("$Path")||o.endsWith("$AnnotationPath")){n=a(n,t)}return n};n.getDataFieldObjectPath=s;const l=function(t,e){const o=i(t,e);return o.$Type==="com.sap.vocabularies.UI.v1.ConnectedFieldsType"};n.isSemanticallyConnectedFields=l;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/DataModelPathHelper-dbg", ["sap/fe/core/helpers/BindingToolkit", "sap/fe/core/templating/PropertyHelper"], function (BindingToolkit, PropertyHelper) {
  "use strict";

  var _exports = {};
  var isPathExpression = PropertyHelper.isPathExpression;
  var isAnnotationPathExpression = PropertyHelper.isAnnotationPathExpression;
  var unresolvableExpression = BindingToolkit.unresolvableExpression;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var equal = BindingToolkit.equal;
  var constant = BindingToolkit.constant;
  /**
   * Function that returns the relative path to the property from the DataModelObjectPath.
   *
   * @param contextPath The DataModelObjectPath object to the property
   * @returns The path from the root entity set.
   */
  const getRelativePaths = function (contextPath) {
    return getPathRelativeLocation(contextPath === null || contextPath === void 0 ? void 0 : contextPath.contextLocation, contextPath === null || contextPath === void 0 ? void 0 : contextPath.navigationProperties).map(np => np.name);
  };
  _exports.getRelativePaths = getRelativePaths;
  const getPathRelativeLocation = function (contextPath) {
    let visitedNavProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    if (!contextPath) {
      return visitedNavProps;
    } else if (visitedNavProps.length >= contextPath.navigationProperties.length) {
      let remainingNavProps = [];
      contextPath.navigationProperties.forEach((navProp, navIndex) => {
        if (visitedNavProps[navIndex] !== navProp) {
          remainingNavProps.push(visitedNavProps[navIndex]);
        }
      });
      remainingNavProps = remainingNavProps.concat(visitedNavProps.slice(contextPath.navigationProperties.length));
      // Clean up NavProp -> Owner
      let currentIdx = 0;
      while (remainingNavProps.length > 1 && currentIdx != remainingNavProps.length - 1) {
        const currentNav = remainingNavProps[currentIdx];
        const nextNavProp = remainingNavProps[currentIdx + 1];
        if (currentNav._type === "NavigationProperty" && currentNav.partner === nextNavProp.name) {
          remainingNavProps.splice(0, 2);
        } else {
          currentIdx++;
        }
      }
      return remainingNavProps;
    } else {
      let extraNavProp = [];
      visitedNavProps.forEach((navProp, navIndex) => {
        if (contextPath.navigationProperties[navIndex] !== navProp) {
          extraNavProp.push(visitedNavProps[navIndex]);
        }
      });
      extraNavProp = extraNavProp.concat(contextPath.navigationProperties.slice(visitedNavProps.length));
      // Clean up NavProp -> Owner
      let currentIdx = 0;
      while (extraNavProp.length > 1 && currentIdx != extraNavProp.length - 1) {
        const currentNav = extraNavProp[currentIdx];
        const nextNavProp = extraNavProp[currentIdx + 1];
        if (currentNav._type === "NavigationProperty" && currentNav.partner === nextNavProp.name) {
          extraNavProp.splice(0, 2);
        } else {
          currentIdx++;
        }
      }
      extraNavProp = extraNavProp.map(navProp => {
        return navProp._type === "NavigationProperty" ? navProp.targetType.navigationProperties.find(np => np.name === navProp.partner) : navProp;
      });
      return extraNavProp;
    }
  };
  _exports.getPathRelativeLocation = getPathRelativeLocation;
  const enhanceDataModelPath = function (dataModelObjectPath, propertyPath) {
    let sPropertyPath = "";
    if ((isPathExpression(propertyPath) || isAnnotationPathExpression(propertyPath)) && propertyPath.path) {
      sPropertyPath = propertyPath.path;
    } else if (typeof propertyPath === "string") {
      sPropertyPath = propertyPath;
    }
    let oTarget;
    if (isPathExpression(propertyPath) || isAnnotationPathExpression(propertyPath)) {
      oTarget = propertyPath.$target;
    } else if (dataModelObjectPath.targetEntityType) {
      oTarget = dataModelObjectPath.targetEntityType.resolvePath(sPropertyPath);
    } else {
      oTarget = dataModelObjectPath.targetObject;
    }
    const aPathSplit = sPropertyPath.split("/");
    let currentEntitySet = dataModelObjectPath.targetEntitySet;
    let currentEntityType = dataModelObjectPath.targetEntityType;
    const navigationProperties = dataModelObjectPath.navigationProperties.concat();
    // Process only if we have to go through navigation properties

    let reducedEntityType = dataModelObjectPath.targetEntityType;
    aPathSplit.forEach(pathPart => {
      if (!reducedEntityType) {
        return;
      }
      const potentialNavProp = reducedEntityType.navigationProperties.find(navProp => navProp.name === pathPart);
      if (potentialNavProp) {
        navigationProperties.push(potentialNavProp);
        currentEntityType = potentialNavProp.targetType;
        if (currentEntitySet && currentEntitySet.navigationPropertyBinding.hasOwnProperty(pathPart)) {
          currentEntitySet = currentEntitySet.navigationPropertyBinding[pathPart];
        }
        reducedEntityType = currentEntityType;
      } else {
        const potentialComplexType = reducedEntityType.entityProperties.find(navProp => navProp.name === pathPart);
        if (potentialComplexType !== null && potentialComplexType !== void 0 && potentialComplexType.targetType) {
          navigationProperties.push(potentialComplexType);
          reducedEntityType = currentEntityType;
        } else {
          reducedEntityType = undefined;
        }
      }
    });
    return {
      startingEntitySet: dataModelObjectPath.startingEntitySet,
      navigationProperties: navigationProperties,
      contextLocation: dataModelObjectPath.contextLocation,
      targetEntitySet: currentEntitySet,
      targetEntityType: currentEntityType,
      targetObject: oTarget,
      convertedTypes: dataModelObjectPath.convertedTypes
    };
  };
  _exports.enhanceDataModelPath = enhanceDataModelPath;
  const getTargetEntitySetPath = function (dataModelObjectPath) {
    let targetEntitySetPath = `/${dataModelObjectPath.startingEntitySet.name}`;
    let currentEntitySet = dataModelObjectPath.startingEntitySet;
    let navigatedPaths = [];
    dataModelObjectPath.navigationProperties.forEach(navProp => {
      navigatedPaths.push(navProp.name);
      if (currentEntitySet && currentEntitySet.navigationPropertyBinding.hasOwnProperty(navigatedPaths.join("/"))) {
        targetEntitySetPath += `/$NavigationPropertyBinding/${navigatedPaths.join("/")}/$`;
        currentEntitySet = currentEntitySet.navigationPropertyBinding[navigatedPaths.join("/")];
        navigatedPaths = [];
      }
    });
    return targetEntitySetPath;
  };
  _exports.getTargetEntitySetPath = getTargetEntitySetPath;
  const getTargetObjectPath = function (dataModelObjectPath) {
    var _dataModelObjectPath$;
    let bRelative = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let path = "";
    if (!dataModelObjectPath.startingEntitySet) {
      return "/";
    }
    if (!bRelative) {
      path += `/${dataModelObjectPath.startingEntitySet.name}`;
    }
    if (dataModelObjectPath.navigationProperties.length > 0) {
      path = setTrailingSlash(path);
      path += dataModelObjectPath.navigationProperties.map(navProp => navProp.name).join("/");
    }
    if ((_dataModelObjectPath$ = dataModelObjectPath.targetObject) !== null && _dataModelObjectPath$ !== void 0 && _dataModelObjectPath$.name && dataModelObjectPath.targetObject._type !== "NavigationProperty" && dataModelObjectPath.targetObject._type !== "EntityType" && dataModelObjectPath.targetObject._type !== "EntitySet" && dataModelObjectPath.targetObject !== dataModelObjectPath.startingEntitySet) {
      path = setTrailingSlash(path);
      path += `${dataModelObjectPath.targetObject.name}`;
    } else if (dataModelObjectPath.targetObject && dataModelObjectPath.targetObject.hasOwnProperty("term")) {
      path = setTrailingSlash(path);
      path += `@${dataModelObjectPath.targetObject.term}`;
      if (dataModelObjectPath.targetObject.hasOwnProperty("qualifier") && !!dataModelObjectPath.targetObject.qualifier) {
        path += `#${dataModelObjectPath.targetObject.qualifier}`;
      }
    }
    return path;
  };
  _exports.getTargetObjectPath = getTargetObjectPath;
  const getContextRelativeTargetObjectPath = function (dataModelObjectPath) {
    var _dataModelObjectPath$2;
    let forBindingExpression = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let forFilterConditionPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    if (((_dataModelObjectPath$2 = dataModelObjectPath.contextLocation) === null || _dataModelObjectPath$2 === void 0 ? void 0 : _dataModelObjectPath$2.startingEntitySet) !== dataModelObjectPath.startingEntitySet) {
      return getTargetObjectPath(dataModelObjectPath);
    }
    return _getContextRelativeTargetObjectPath(dataModelObjectPath, forBindingExpression, forFilterConditionPath);
  };
  _exports.getContextRelativeTargetObjectPath = getContextRelativeTargetObjectPath;
  const _getContextRelativeTargetObjectPath = function (dataModelObjectPath) {
    let forBindingExpression = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    let forFilterConditionPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    const navProperties = getPathRelativeLocation(dataModelObjectPath.contextLocation, dataModelObjectPath.navigationProperties);
    if (forBindingExpression) {
      if (navProperties.find(np => np._type === "NavigationProperty" && np.isCollection)) {
        return undefined;
      }
    }
    let path = forFilterConditionPath ? navProperties.map(navProp => {
      const isCollection = navProp._type === "NavigationProperty" && navProp.isCollection;
      return isCollection ? `${navProp.name}*` : navProp.name;
    }).join("/") : navProperties.map(navProp => navProp.name).join("/");
    if (dataModelObjectPath.targetObject && (dataModelObjectPath.targetObject.name || dataModelObjectPath.targetObject.type === "PropertyPath" && dataModelObjectPath.targetObject.value) && dataModelObjectPath.targetObject._type !== "NavigationProperty" && dataModelObjectPath.targetObject._type !== "EntityType" && dataModelObjectPath.targetObject._type !== "EntitySet" && dataModelObjectPath.targetObject !== dataModelObjectPath.startingEntitySet) {
      path = setTrailingSlash(path);
      path += dataModelObjectPath.targetObject.type === "PropertyPath" ? `${dataModelObjectPath.targetObject.value}` : `${dataModelObjectPath.targetObject.name}`;
    } else if (dataModelObjectPath.targetObject && dataModelObjectPath.targetObject.hasOwnProperty("term")) {
      path = setTrailingSlash(path);
      path += `@${dataModelObjectPath.targetObject.term}`;
      if (dataModelObjectPath.targetObject.hasOwnProperty("qualifier") && !!dataModelObjectPath.targetObject.qualifier) {
        path += `#${dataModelObjectPath.targetObject.qualifier}`;
      }
    } else if (!dataModelObjectPath.targetObject) {
      return undefined;
    }
    return path;
  };
  const isPathUpdatable = function (dataModelObjectPath, extractionParametersOnPath) {
    return checkOnPath(dataModelObjectPath, annotationObject => {
      var _annotationObject$Upd;
      return annotationObject === null || annotationObject === void 0 ? void 0 : (_annotationObject$Upd = annotationObject.UpdateRestrictions) === null || _annotationObject$Upd === void 0 ? void 0 : _annotationObject$Upd.Updatable;
    }, extractionParametersOnPath);
  };
  _exports.isPathUpdatable = isPathUpdatable;
  const isPathSearchable = function (dataModelObjectPath, extractionParametersOnPath) {
    return checkOnPath(dataModelObjectPath, annotationObject => {
      var _annotationObject$Sea;
      return annotationObject === null || annotationObject === void 0 ? void 0 : (_annotationObject$Sea = annotationObject.SearchRestrictions) === null || _annotationObject$Sea === void 0 ? void 0 : _annotationObject$Sea.Searchable;
    }, extractionParametersOnPath);
  };
  _exports.isPathSearchable = isPathSearchable;
  const isPathDeletable = function (dataModelObjectPath, extractionParametersOnPath) {
    return checkOnPath(dataModelObjectPath, annotationObject => {
      var _annotationObject$Del;
      return annotationObject === null || annotationObject === void 0 ? void 0 : (_annotationObject$Del = annotationObject.DeleteRestrictions) === null || _annotationObject$Del === void 0 ? void 0 : _annotationObject$Del.Deletable;
    }, extractionParametersOnPath);
  };
  _exports.isPathDeletable = isPathDeletable;
  const isPathInsertable = function (dataModelObjectPath, extractionParametersOnPath) {
    return checkOnPath(dataModelObjectPath, annotationObject => {
      var _annotationObject$Ins;
      return annotationObject === null || annotationObject === void 0 ? void 0 : (_annotationObject$Ins = annotationObject.InsertRestrictions) === null || _annotationObject$Ins === void 0 ? void 0 : _annotationObject$Ins.Insertable;
    }, extractionParametersOnPath);
  };
  _exports.isPathInsertable = isPathInsertable;
  const checkFilterExpressionRestrictions = function (dataModelObjectPath, allowedExpression) {
    return checkOnPath(dataModelObjectPath, annotationObject => {
      if (annotationObject && "FilterRestrictions" in annotationObject) {
        var _annotationObject$Fil;
        const filterExpressionRestrictions = (annotationObject === null || annotationObject === void 0 ? void 0 : (_annotationObject$Fil = annotationObject.FilterRestrictions) === null || _annotationObject$Fil === void 0 ? void 0 : _annotationObject$Fil.FilterExpressionRestrictions) || [];
        const currentObjectRestriction = filterExpressionRestrictions.find(restriction => {
          return restriction.Property.$target === dataModelObjectPath.targetObject;
        });
        if (currentObjectRestriction) {
          var _currentObjectRestric;
          return allowedExpression.indexOf(currentObjectRestriction === null || currentObjectRestriction === void 0 ? void 0 : (_currentObjectRestric = currentObjectRestriction.AllowedExpressions) === null || _currentObjectRestric === void 0 ? void 0 : _currentObjectRestric.toString()) !== -1;
        } else {
          return false;
        }
      } else {
        return false;
      }
    });
  };
  _exports.checkFilterExpressionRestrictions = checkFilterExpressionRestrictions;
  const checkOnPath = function (dataModelObjectPath, checkFunction, extractionParametersOnPath) {
    if (!dataModelObjectPath || !dataModelObjectPath.startingEntitySet) {
      return constant(true);
    }
    dataModelObjectPath = enhanceDataModelPath(dataModelObjectPath, extractionParametersOnPath === null || extractionParametersOnPath === void 0 ? void 0 : extractionParametersOnPath.propertyPath);
    let currentEntitySet = dataModelObjectPath.startingEntitySet;
    let parentEntitySet = null;
    let visitedNavigationPropsName = [];
    const allVisitedNavigationProps = [];
    let targetEntitySet = currentEntitySet;
    const targetEntityType = dataModelObjectPath.targetEntityType;
    let resetVisitedNavProps = false;
    dataModelObjectPath.navigationProperties.forEach(navigationProperty => {
      if (resetVisitedNavProps) {
        visitedNavigationPropsName = [];
      }
      visitedNavigationPropsName.push(navigationProperty.name);
      allVisitedNavigationProps.push(navigationProperty);
      if (navigationProperty._type === "Property" || !navigationProperty.containsTarget) {
        // We should have a navigationPropertyBinding associated with the path so far which can consist of ([ContainmentNavProp]/)*[NavProp]
        const fullNavigationPath = visitedNavigationPropsName.join("/");
        if (currentEntitySet && currentEntitySet.navigationPropertyBinding.hasOwnProperty(fullNavigationPath)) {
          parentEntitySet = currentEntitySet;
          currentEntitySet = currentEntitySet.navigationPropertyBinding[fullNavigationPath];
          targetEntitySet = currentEntitySet;
          // If we reached a navigation property with a navigationpropertybinding, we need to reset the visited path on the next iteration (if there is one)
          resetVisitedNavProps = true;
        } else {
          // We really should not end up here but at least let's try to avoid incorrect behavior
          parentEntitySet = currentEntitySet;
          currentEntitySet = null;
          resetVisitedNavProps = true;
        }
      } else {
        parentEntitySet = currentEntitySet;
        targetEntitySet = null;
      }
    });

    // At this point we have navigated down all the nav prop and we should have
    // The target entitySet pointing to either null (in case of containment navprop a last part), or the actual target (non containment as target)
    // The parent entitySet pointing to the previous entitySet used in the path
    // VisitedNavigationPath should contain the path up to this property

    // Restrictions should then be evaluated as ParentEntitySet.NavRestrictions[NavPropertyPath] || TargetEntitySet.Restrictions
    const fullNavigationPath = visitedNavigationPropsName.join("/");
    let restrictions, visitedNavProps;
    if (parentEntitySet !== null) {
      var _parentEntitySet$anno, _parentEntitySet$anno2, _parentEntitySet$anno3;
      const _parentEntitySet = parentEntitySet;
      (_parentEntitySet$anno = _parentEntitySet.annotations) === null || _parentEntitySet$anno === void 0 ? void 0 : (_parentEntitySet$anno2 = _parentEntitySet$anno.Capabilities) === null || _parentEntitySet$anno2 === void 0 ? void 0 : (_parentEntitySet$anno3 = _parentEntitySet$anno2.NavigationRestrictions) === null || _parentEntitySet$anno3 === void 0 ? void 0 : _parentEntitySet$anno3.RestrictedProperties.forEach(restrictedNavProp => {
        var _restrictedNavProp$Na;
        if (((_restrictedNavProp$Na = restrictedNavProp.NavigationProperty) === null || _restrictedNavProp$Na === void 0 ? void 0 : _restrictedNavProp$Na.type) === "NavigationPropertyPath") {
          const restrictionDefinition = checkFunction(restrictedNavProp);
          if (fullNavigationPath === restrictedNavProp.NavigationProperty.value && restrictionDefinition !== undefined) {
            var _dataModelObjectPath;
            const _allVisitedNavigationProps = allVisitedNavigationProps.slice(0, -1);
            visitedNavProps = _allVisitedNavigationProps;
            const pathRelativeLocation = getPathRelativeLocation((_dataModelObjectPath = dataModelObjectPath) === null || _dataModelObjectPath === void 0 ? void 0 : _dataModelObjectPath.contextLocation, visitedNavProps).map(np => np.name);
            const pathVisitorFunction = extractionParametersOnPath !== null && extractionParametersOnPath !== void 0 && extractionParametersOnPath.pathVisitor ? getPathVisitorForSingleton(extractionParametersOnPath.pathVisitor, pathRelativeLocation) : undefined; // send pathVisitor function only when it is defined and only send function or defined as a parameter
            restrictions = equal(getExpressionFromAnnotation(restrictionDefinition, pathRelativeLocation, undefined, pathVisitorFunction), true);
          }
        }
      });
    }
    let targetRestrictions;
    if (!(extractionParametersOnPath !== null && extractionParametersOnPath !== void 0 && extractionParametersOnPath.ignoreTargetCollection)) {
      var _targetEntitySet, _targetEntitySet$anno;
      let restrictionDefinition = checkFunction((_targetEntitySet = targetEntitySet) === null || _targetEntitySet === void 0 ? void 0 : (_targetEntitySet$anno = _targetEntitySet.annotations) === null || _targetEntitySet$anno === void 0 ? void 0 : _targetEntitySet$anno.Capabilities);
      if (targetEntitySet === null && restrictionDefinition === undefined) {
        var _targetEntityType$ann;
        restrictionDefinition = checkFunction(targetEntityType === null || targetEntityType === void 0 ? void 0 : (_targetEntityType$ann = targetEntityType.annotations) === null || _targetEntityType$ann === void 0 ? void 0 : _targetEntityType$ann.Capabilities);
      }
      if (restrictionDefinition !== undefined) {
        const pathRelativeLocation = getPathRelativeLocation(dataModelObjectPath.contextLocation, allVisitedNavigationProps).map(np => np.name);
        const pathVisitorFunction = extractionParametersOnPath !== null && extractionParametersOnPath !== void 0 && extractionParametersOnPath.pathVisitor ? getPathVisitorForSingleton(extractionParametersOnPath.pathVisitor, pathRelativeLocation) : undefined;
        targetRestrictions = equal(getExpressionFromAnnotation(restrictionDefinition, pathRelativeLocation, undefined, pathVisitorFunction), true);
      }
    }
    return restrictions || targetRestrictions || (extractionParametersOnPath !== null && extractionParametersOnPath !== void 0 && extractionParametersOnPath.authorizeUnresolvable ? unresolvableExpression : constant(true));
  };

  /**
   * Set a trailing slash to a path if not already set.
   *
   * @param path The path
   * @returns The path with a trailing slash
   */
  _exports.checkOnPath = checkOnPath;
  const setTrailingSlash = function (path) {
    if (path.length && !path.endsWith("/")) {
      return `${path}/`;
    }
    return path;
  };

  // This helper method is used to add relative path location argument to singletonPathVisitorFunction i.e. pathVisitor
  // pathVisitor method is used later to get the correct bindings for singleton entity
  // method is invoked later in pathInModel() method to get the correct binding.
  const getPathVisitorForSingleton = function (pathVisitor, pathRelativeLocation) {
    return function (path) {
      return pathVisitor(path, pathRelativeLocation);
    };
  };
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/DataModelPathHelper", ["sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/PropertyHelper"],function(t,e){"use strict";var n={};var i=e.isPathExpression;var r=e.isAnnotationPathExpression;var a=t.unresolvableExpression;var o=t.getExpressionFromAnnotation;var l=t.equal;var s=t.constant;const c=function(t){return g(t===null||t===void 0?void 0:t.contextLocation,t===null||t===void 0?void 0:t.navigationProperties).map(t=>t.name)};n.getRelativePaths=c;const g=function(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!t){return e}else if(e.length>=t.navigationProperties.length){let n=[];t.navigationProperties.forEach((t,i)=>{if(e[i]!==t){n.push(e[i])}});n=n.concat(e.slice(t.navigationProperties.length));let i=0;while(n.length>1&&i!=n.length-1){const t=n[i];const e=n[i+1];if(t._type==="NavigationProperty"&&t.partner===e.name){n.splice(0,2)}else{i++}}return n}else{let n=[];e.forEach((i,r)=>{if(t.navigationProperties[r]!==i){n.push(e[r])}});n=n.concat(t.navigationProperties.slice(e.length));let i=0;while(n.length>1&&i!=n.length-1){const t=n[i];const e=n[i+1];if(t._type==="NavigationProperty"&&t.partner===e.name){n.splice(0,2)}else{i++}}n=n.map(t=>t._type==="NavigationProperty"?t.targetType.navigationProperties.find(e=>e.name===t.partner):t);return n}};n.getPathRelativeLocation=g;const u=function(t,e){let n="";if((i(e)||r(e))&&e.path){n=e.path}else if(typeof e==="string"){n=e}let a;if(i(e)||r(e)){a=e.$target}else if(t.targetEntityType){a=t.targetEntityType.resolvePath(n)}else{a=t.targetObject}const o=n.split("/");let l=t.targetEntitySet;let s=t.targetEntityType;const c=t.navigationProperties.concat();let g=t.targetEntityType;o.forEach(t=>{if(!g){return}const e=g.navigationProperties.find(e=>e.name===t);if(e){c.push(e);s=e.targetType;if(l&&l.navigationPropertyBinding.hasOwnProperty(t)){l=l.navigationPropertyBinding[t]}g=s}else{const e=g.entityProperties.find(e=>e.name===t);if(e!==null&&e!==void 0&&e.targetType){c.push(e);g=s}else{g=undefined}}});return{startingEntitySet:t.startingEntitySet,navigationProperties:c,contextLocation:t.contextLocation,targetEntitySet:l,targetEntityType:s,targetObject:a,convertedTypes:t.convertedTypes}};n.enhanceDataModelPath=u;const p=function(t){let e=`/${t.startingEntitySet.name}`;let n=t.startingEntitySet;let i=[];t.navigationProperties.forEach(t=>{i.push(t.name);if(n&&n.navigationPropertyBinding.hasOwnProperty(i.join("/"))){e+=`/$NavigationPropertyBinding/${i.join("/")}/$`;n=n.navigationPropertyBinding[i.join("/")];i=[]}});return e};n.getTargetEntitySetPath=p;const v=function(t){var e;let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let i="";if(!t.startingEntitySet){return"/"}if(!n){i+=`/${t.startingEntitySet.name}`}if(t.navigationProperties.length>0){i=E(i);i+=t.navigationProperties.map(t=>t.name).join("/")}if((e=t.targetObject)!==null&&e!==void 0&&e.name&&t.targetObject._type!=="NavigationProperty"&&t.targetObject._type!=="EntityType"&&t.targetObject._type!=="EntitySet"&&t.targetObject!==t.startingEntitySet){i=E(i);i+=`${t.targetObject.name}`}else if(t.targetObject&&t.targetObject.hasOwnProperty("term")){i=E(i);i+=`@${t.targetObject.term}`;if(t.targetObject.hasOwnProperty("qualifier")&&!!t.targetObject.qualifier){i+=`#${t.targetObject.qualifier}`}}return i};n.getTargetObjectPath=v;const d=function(t){var e;let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(((e=t.contextLocation)===null||e===void 0?void 0:e.startingEntitySet)!==t.startingEntitySet){return v(t)}return f(t,n,i)};n.getContextRelativeTargetObjectPath=d;const f=function(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const i=g(t.contextLocation,t.navigationProperties);if(e){if(i.find(t=>t._type==="NavigationProperty"&&t.isCollection)){return undefined}}let r=n?i.map(t=>{const e=t._type==="NavigationProperty"&&t.isCollection;return e?`${t.name}*`:t.name}).join("/"):i.map(t=>t.name).join("/");if(t.targetObject&&(t.targetObject.name||t.targetObject.type==="PropertyPath"&&t.targetObject.value)&&t.targetObject._type!=="NavigationProperty"&&t.targetObject._type!=="EntityType"&&t.targetObject._type!=="EntitySet"&&t.targetObject!==t.startingEntitySet){r=E(r);r+=t.targetObject.type==="PropertyPath"?`${t.targetObject.value}`:`${t.targetObject.name}`}else if(t.targetObject&&t.targetObject.hasOwnProperty("term")){r=E(r);r+=`@${t.targetObject.term}`;if(t.targetObject.hasOwnProperty("qualifier")&&!!t.targetObject.qualifier){r+=`#${t.targetObject.qualifier}`}}else if(!t.targetObject){return undefined}return r};const y=function(t,e){return j(t,t=>{var e;return t===null||t===void 0?void 0:(e=t.UpdateRestrictions)===null||e===void 0?void 0:e.Updatable},e)};n.isPathUpdatable=y;const h=function(t,e){return j(t,t=>{var e;return t===null||t===void 0?void 0:(e=t.SearchRestrictions)===null||e===void 0?void 0:e.Searchable},e)};n.isPathSearchable=h;const P=function(t,e){return j(t,t=>{var e;return t===null||t===void 0?void 0:(e=t.DeleteRestrictions)===null||e===void 0?void 0:e.Deletable},e)};n.isPathDeletable=P;const b=function(t,e){return j(t,t=>{var e;return t===null||t===void 0?void 0:(e=t.InsertRestrictions)===null||e===void 0?void 0:e.Insertable},e)};n.isPathInsertable=b;const O=function(t,e){return j(t,n=>{if(n&&"FilterRestrictions"in n){var i;const a=(n===null||n===void 0?void 0:(i=n.FilterRestrictions)===null||i===void 0?void 0:i.FilterExpressionRestrictions)||[];const o=a.find(e=>e.Property.$target===t.targetObject);if(o){var r;return e.indexOf(o===null||o===void 0?void 0:(r=o.AllowedExpressions)===null||r===void 0?void 0:r.toString())!==-1}else{return false}}else{return false}})};n.checkFilterExpressionRestrictions=O;const j=function(t,e,n){if(!t||!t.startingEntitySet){return s(true)}t=u(t,n===null||n===void 0?void 0:n.propertyPath);let i=t.startingEntitySet;let r=null;let c=[];const p=[];let v=i;const d=t.targetEntityType;let f=false;t.navigationProperties.forEach(t=>{if(f){c=[]}c.push(t.name);p.push(t);if(t._type==="Property"||!t.containsTarget){const t=c.join("/");if(i&&i.navigationPropertyBinding.hasOwnProperty(t)){r=i;i=i.navigationPropertyBinding[t];v=i;f=true}else{r=i;i=null;f=true}}else{r=i;v=null}});const y=c.join("/");let h,P;if(r!==null){var b,O,j;const i=r;(b=i.annotations)===null||b===void 0?void 0:(O=b.Capabilities)===null||O===void 0?void 0:(j=O.NavigationRestrictions)===null||j===void 0?void 0:j.RestrictedProperties.forEach(i=>{var r;if(((r=i.NavigationProperty)===null||r===void 0?void 0:r.type)==="NavigationPropertyPath"){const r=e(i);if(y===i.NavigationProperty.value&&r!==undefined){var a;const e=p.slice(0,-1);P=e;const i=g((a=t)===null||a===void 0?void 0:a.contextLocation,P).map(t=>t.name);const s=n!==null&&n!==void 0&&n.pathVisitor?m(n.pathVisitor,i):undefined;h=l(o(r,i,undefined,s),true)}}})}let E;if(!(n!==null&&n!==void 0&&n.ignoreTargetCollection)){var S,T;let i=e((S=v)===null||S===void 0?void 0:(T=S.annotations)===null||T===void 0?void 0:T.Capabilities);if(v===null&&i===undefined){var x;i=e(d===null||d===void 0?void 0:(x=d.annotations)===null||x===void 0?void 0:x.Capabilities)}if(i!==undefined){const e=g(t.contextLocation,p).map(t=>t.name);const r=n!==null&&n!==void 0&&n.pathVisitor?m(n.pathVisitor,e):undefined;E=l(o(i,e,undefined,r),true)}}return h||E||(n!==null&&n!==void 0&&n.authorizeUnresolvable?a:s(true))};n.checkOnPath=j;const E=function(t){if(t.length&&!t.endsWith("/")){return`${t}/`}return t};const m=function(t,e){return function(n){return t(n,e)}};return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/DisplayModeFormatter-dbg", ["sap/fe/core/templating/PropertyHelper"], function (PropertyHelper) {
  "use strict";

  var _exports = {};
  var isPropertyPathExpression = PropertyHelper.isPropertyPathExpression;
  var isPathExpression = PropertyHelper.isPathExpression;
  const ODATA_TYPE_MAPPING = {
    "sap.ui.model.odata.type.Boolean": "Edm.Boolean",
    "sap.ui.model.odata.type.Byte": "Edm.Byte",
    "sap.ui.model.odata.type.Date": "Edm.Date",
    "sap.ui.model.odata.type.DateTimeOffset": "Edm.DateTimeOffset",
    "sap.ui.model.odata.type.Decimal": "Edm.Decimal",
    "sap.ui.model.odata.type.Double": "Edm.Double",
    "sap.ui.model.odata.type.Guid": "Edm.Guid",
    "sap.ui.model.odata.type.Int16": "Edm.Int16",
    "sap.ui.model.odata.type.Int32": "Edm.Int32",
    "sap.ui.model.odata.type.Int64": "Edm.Int64",
    "sap.ui.model.odata.type.SByte": "Edm.SByte",
    "sap.ui.model.odata.type.Single": "Edm.Single",
    "sap.ui.model.odata.type.Stream": "Edm.Stream",
    "sap.ui.model.odata.type.TimeOfDay": "Edm.TimeOfDay",
    "sap.ui.model.odata.type.String": "Edm.String"
  };
  _exports.ODATA_TYPE_MAPPING = ODATA_TYPE_MAPPING;
  const getDisplayMode = function (oPropertyPath, oDataModelObjectPath) {
    var _oProperty$annotation, _oProperty$annotation2, _oTextAnnotation$anno, _oTextAnnotation$anno2, _oTextAnnotation$anno3, _oEntityType$annotati, _oEntityType$annotati2, _oEntityType$annotati3, _oEntityType$annotati4, _oEntityType$annotati5, _oEntityType$annotati6;
    if (!oPropertyPath || typeof oPropertyPath === "string") {
      return "Value";
    }
    const oProperty = (isPathExpression(oPropertyPath) || isPropertyPathExpression(oPropertyPath)) && oPropertyPath.$target || oPropertyPath;
    const oEntityType = oDataModelObjectPath && oDataModelObjectPath.targetEntityType;
    const oTextAnnotation = (_oProperty$annotation = oProperty.annotations) === null || _oProperty$annotation === void 0 ? void 0 : (_oProperty$annotation2 = _oProperty$annotation.Common) === null || _oProperty$annotation2 === void 0 ? void 0 : _oProperty$annotation2.Text;
    const oTextArrangementAnnotation = typeof oTextAnnotation !== "string" && (oTextAnnotation === null || oTextAnnotation === void 0 ? void 0 : (_oTextAnnotation$anno = oTextAnnotation.annotations) === null || _oTextAnnotation$anno === void 0 ? void 0 : (_oTextAnnotation$anno2 = _oTextAnnotation$anno.UI) === null || _oTextAnnotation$anno2 === void 0 ? void 0 : (_oTextAnnotation$anno3 = _oTextAnnotation$anno2.TextArrangement) === null || _oTextAnnotation$anno3 === void 0 ? void 0 : _oTextAnnotation$anno3.toString()) || (oEntityType === null || oEntityType === void 0 ? void 0 : (_oEntityType$annotati = oEntityType.annotations) === null || _oEntityType$annotati === void 0 ? void 0 : (_oEntityType$annotati2 = _oEntityType$annotati.UI) === null || _oEntityType$annotati2 === void 0 ? void 0 : (_oEntityType$annotati3 = _oEntityType$annotati2.TextArrangement) === null || _oEntityType$annotati3 === void 0 ? void 0 : _oEntityType$annotati3.toString());
    let sDisplayValue = oTextAnnotation ? "DescriptionValue" : "Value";
    if (oTextAnnotation && oTextArrangementAnnotation || oEntityType !== null && oEntityType !== void 0 && (_oEntityType$annotati4 = oEntityType.annotations) !== null && _oEntityType$annotati4 !== void 0 && (_oEntityType$annotati5 = _oEntityType$annotati4.UI) !== null && _oEntityType$annotati5 !== void 0 && (_oEntityType$annotati6 = _oEntityType$annotati5.TextArrangement) !== null && _oEntityType$annotati6 !== void 0 && _oEntityType$annotati6.toString()) {
      if (oTextArrangementAnnotation === "UI.TextArrangementType/TextOnly") {
        sDisplayValue = "Description";
      } else if (oTextArrangementAnnotation === "UI.TextArrangementType/TextLast") {
        sDisplayValue = "ValueDescription";
      } else if (oTextArrangementAnnotation === "UI.TextArrangementType/TextSeparate") {
        sDisplayValue = "Value";
      } else {
        //Default should be TextFirst if there is a Text annotation and neither TextOnly nor TextLast are set
        sDisplayValue = "DescriptionValue";
      }
    }
    return sDisplayValue;
  };
  _exports.getDisplayMode = getDisplayMode;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/DisplayModeFormatter", ["sap/fe/core/templating/PropertyHelper"],function(e){"use strict";var t={};var a=e.isPropertyPathExpression;var o=e.isPathExpression;const i={"sap.ui.model.odata.type.Boolean":"Edm.Boolean","sap.ui.model.odata.type.Byte":"Edm.Byte","sap.ui.model.odata.type.Date":"Edm.Date","sap.ui.model.odata.type.DateTimeOffset":"Edm.DateTimeOffset","sap.ui.model.odata.type.Decimal":"Edm.Decimal","sap.ui.model.odata.type.Double":"Edm.Double","sap.ui.model.odata.type.Guid":"Edm.Guid","sap.ui.model.odata.type.Int16":"Edm.Int16","sap.ui.model.odata.type.Int32":"Edm.Int32","sap.ui.model.odata.type.Int64":"Edm.Int64","sap.ui.model.odata.type.SByte":"Edm.SByte","sap.ui.model.odata.type.Single":"Edm.Single","sap.ui.model.odata.type.Stream":"Edm.Stream","sap.ui.model.odata.type.TimeOfDay":"Edm.TimeOfDay","sap.ui.model.odata.type.String":"Edm.String"};t.ODATA_TYPE_MAPPING=i;const n=function(e,t){var i,n,d,l,p,s,m,r,u,y,v;if(!e||typeof e==="string"){return"Value"}const T=(o(e)||a(e))&&e.$target||e;const g=t&&t.targetEntityType;const E=(i=T.annotations)===null||i===void 0?void 0:(n=i.Common)===null||n===void 0?void 0:n.Text;const f=typeof E!=="string"&&(E===null||E===void 0?void 0:(d=E.annotations)===null||d===void 0?void 0:(l=d.UI)===null||l===void 0?void 0:(p=l.TextArrangement)===null||p===void 0?void 0:p.toString())||(g===null||g===void 0?void 0:(s=g.annotations)===null||s===void 0?void 0:(m=s.UI)===null||m===void 0?void 0:(r=m.TextArrangement)===null||r===void 0?void 0:r.toString());let c=E?"DescriptionValue":"Value";if(E&&f||g!==null&&g!==void 0&&(u=g.annotations)!==null&&u!==void 0&&(y=u.UI)!==null&&y!==void 0&&(v=y.TextArrangement)!==null&&v!==void 0&&v.toString()){if(f==="UI.TextArrangementType/TextOnly"){c="Description"}else if(f==="UI.TextArrangementType/TextLast"){c="ValueDescription"}else if(f==="UI.TextArrangementType/TextSeparate"){c="Value"}else{c="DescriptionValue"}}return c};t.getDisplayMode=n;return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/EntitySetHelper-dbg", ["sap/fe/core/helpers/ModelHelper"], function (ModelHelper) {
  "use strict";

  var _exports = {};
  const isEntitySet = function (dataObject) {
    return dataObject && dataObject.hasOwnProperty("_type") && dataObject._type === "EntitySet";
  };
  _exports.isEntitySet = isEntitySet;
  const getFilterExpressionRestrictions = function (entitySet) {
    var _entitySet$annotation, _entitySet$annotation2, _entitySet$annotation3;
    return ((_entitySet$annotation = entitySet.annotations) === null || _entitySet$annotation === void 0 ? void 0 : (_entitySet$annotation2 = _entitySet$annotation.Capabilities) === null || _entitySet$annotation2 === void 0 ? void 0 : (_entitySet$annotation3 = _entitySet$annotation2.FilterRestrictions) === null || _entitySet$annotation3 === void 0 ? void 0 : _entitySet$annotation3.FilterExpressionRestrictions) || [];
  };

  /**
   * Reads all SortRestrictions of the main entity and the (first level) navigation restrictions.
   * This does not work for more than one level of navigation.
   *
   * @param entitySet Entity set to be analyzed
   * @returns Array containing the property names of all non-sortable properties
   */
  _exports.getFilterExpressionRestrictions = getFilterExpressionRestrictions;
  const getNonSortablePropertiesRestrictions = function (entitySet) {
    var _annotations, _annotations$Capabili, _annotations$Capabili2, _entitySet$annotation4, _entitySet$annotation5, _entitySet$annotation6, _entitySet$annotation7;
    let nonSortableProperties = [];
    // Check annotations for main entity
    if (ModelHelper.isSingleton(entitySet)) {
      return [];
    } else if ((entitySet === null || entitySet === void 0 ? void 0 : (_annotations = entitySet.annotations) === null || _annotations === void 0 ? void 0 : (_annotations$Capabili = _annotations.Capabilities) === null || _annotations$Capabili === void 0 ? void 0 : (_annotations$Capabili2 = _annotations$Capabili.SortRestrictions) === null || _annotations$Capabili2 === void 0 ? void 0 : _annotations$Capabili2.Sortable) === false) {
      // add all properties of the entity to the nonSortableProperties
      nonSortableProperties.push(...entitySet.entityType.entityProperties.map(property => property.name));
    } else {
      var _annotations2, _annotations2$Capabil, _annotations2$Capabil2, _annotations2$Capabil3;
      nonSortableProperties = (entitySet === null || entitySet === void 0 ? void 0 : (_annotations2 = entitySet.annotations) === null || _annotations2 === void 0 ? void 0 : (_annotations2$Capabil = _annotations2.Capabilities) === null || _annotations2$Capabil === void 0 ? void 0 : (_annotations2$Capabil2 = _annotations2$Capabil.SortRestrictions) === null || _annotations2$Capabil2 === void 0 ? void 0 : (_annotations2$Capabil3 = _annotations2$Capabil2.NonSortableProperties) === null || _annotations2$Capabil3 === void 0 ? void 0 : _annotations2$Capabil3.map(property => property.value)) || [];
    }
    // Check for every navigationRestriction if it has sortRestrictions
    entitySet === null || entitySet === void 0 ? void 0 : (_entitySet$annotation4 = entitySet.annotations) === null || _entitySet$annotation4 === void 0 ? void 0 : (_entitySet$annotation5 = _entitySet$annotation4.Capabilities) === null || _entitySet$annotation5 === void 0 ? void 0 : (_entitySet$annotation6 = _entitySet$annotation5.NavigationRestrictions) === null || _entitySet$annotation6 === void 0 ? void 0 : (_entitySet$annotation7 = _entitySet$annotation6.RestrictedProperties) === null || _entitySet$annotation7 === void 0 ? void 0 : _entitySet$annotation7.forEach(navigationRestriction => {
      var _navigationRestrictio;
      if ((navigationRestriction === null || navigationRestriction === void 0 ? void 0 : (_navigationRestrictio = navigationRestriction.SortRestrictions) === null || _navigationRestrictio === void 0 ? void 0 : _navigationRestrictio.Sortable) === false) {
        var _entitySet$entityType, _entitySet$entityType2;
        // find correct navigation property
        const navigationProperty = entitySet === null || entitySet === void 0 ? void 0 : (_entitySet$entityType = entitySet.entityType) === null || _entitySet$entityType === void 0 ? void 0 : (_entitySet$entityType2 = _entitySet$entityType.navigationProperties) === null || _entitySet$entityType2 === void 0 ? void 0 : _entitySet$entityType2.filter(navProperty => {
          var _navigationRestrictio2;
          return navProperty.name === (navigationRestriction === null || navigationRestriction === void 0 ? void 0 : (_navigationRestrictio2 = navigationRestriction.NavigationProperty) === null || _navigationRestrictio2 === void 0 ? void 0 : _navigationRestrictio2.value);
        });
        if (navigationProperty[0]) {
          var _navigationProperty$;
          // add all properties of the navigation property to the nonSortableProperties
          nonSortableProperties.push(...((_navigationProperty$ = navigationProperty[0].targetType) === null || _navigationProperty$ === void 0 ? void 0 : _navigationProperty$.entityProperties.map(property => `${navigationProperty[0].name}/${property.name}`)));
        }
      } else {
        var _navigationRestrictio3, _navigationRestrictio4;
        // leave the property path unchanged (it is relative to the annotation target!)
        const nonSortableNavigationProperties = navigationRestriction === null || navigationRestriction === void 0 ? void 0 : (_navigationRestrictio3 = navigationRestriction.SortRestrictions) === null || _navigationRestrictio3 === void 0 ? void 0 : (_navigationRestrictio4 = _navigationRestrictio3.NonSortableProperties) === null || _navigationRestrictio4 === void 0 ? void 0 : _navigationRestrictio4.map(property => property.value);
        if (nonSortableNavigationProperties) {
          nonSortableProperties.push(...nonSortableNavigationProperties);
        }
      }
    });
    return nonSortableProperties;
  };
  _exports.getNonSortablePropertiesRestrictions = getNonSortablePropertiesRestrictions;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/EntitySetHelper", ["sap/fe/core/helpers/ModelHelper"],function(i){"use strict";var o={};const t=function(i){return i&&i.hasOwnProperty("_type")&&i._type==="EntitySet"};o.isEntitySet=t;const n=function(i){var o,t,n;return((o=i.annotations)===null||o===void 0?void 0:(t=o.Capabilities)===null||t===void 0?void 0:(n=t.FilterRestrictions)===null||n===void 0?void 0:n.FilterExpressionRestrictions)||[]};o.getFilterExpressionRestrictions=n;const e=function(o){var t,n,e,l,v,r,s;let d=[];if(i.isSingleton(o)){return[]}else if((o===null||o===void 0?void 0:(t=o.annotations)===null||t===void 0?void 0:(n=t.Capabilities)===null||n===void 0?void 0:(e=n.SortRestrictions)===null||e===void 0?void 0:e.Sortable)===false){d.push(...o.entityType.entityProperties.map(i=>i.name))}else{var a,u,p,c;d=(o===null||o===void 0?void 0:(a=o.annotations)===null||a===void 0?void 0:(u=a.Capabilities)===null||u===void 0?void 0:(p=u.SortRestrictions)===null||p===void 0?void 0:(c=p.NonSortableProperties)===null||c===void 0?void 0:c.map(i=>i.value))||[]}o===null||o===void 0?void 0:(l=o.annotations)===null||l===void 0?void 0:(v=l.Capabilities)===null||v===void 0?void 0:(r=v.NavigationRestrictions)===null||r===void 0?void 0:(s=r.RestrictedProperties)===null||s===void 0?void 0:s.forEach(i=>{var t;if((i===null||i===void 0?void 0:(t=i.SortRestrictions)===null||t===void 0?void 0:t.Sortable)===false){var n,e;const t=o===null||o===void 0?void 0:(n=o.entityType)===null||n===void 0?void 0:(e=n.navigationProperties)===null||e===void 0?void 0:e.filter(o=>{var t;return o.name===(i===null||i===void 0?void 0:(t=i.NavigationProperty)===null||t===void 0?void 0:t.value)});if(t[0]){var l;d.push(...(l=t[0].targetType)===null||l===void 0?void 0:l.entityProperties.map(i=>`${t[0].name}/${i.name}`))}}else{var v,r;const o=i===null||i===void 0?void 0:(v=i.SortRestrictions)===null||v===void 0?void 0:(r=v.NonSortableProperties)===null||r===void 0?void 0:r.map(i=>i.value);if(o){d.push(...o)}}});return d};o.getNonSortablePropertiesRestrictions=e;return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/FieldControlHelper-dbg", ["sap/fe/core/helpers/BindingToolkit"], function (BindingToolkit) {
  "use strict";

  var _exports = {};
  var or = BindingToolkit.or;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var equal = BindingToolkit.equal;
  var constant = BindingToolkit.constant;
  /**
   * Create the binding expression to check if the property is read only or not.
   *
   * @param oTarget The target property or DataField
   * @param relativePath Array of navigation properties pointing to the location of field control property
   * @returns The binding expression resolving to a Boolean being true if it's read only
   */
  const isReadOnlyExpression = function (oTarget, relativePath) {
    var _oTarget$annotations, _oTarget$annotations$, _oTarget$annotations$2;
    const oFieldControlValue = oTarget === null || oTarget === void 0 ? void 0 : (_oTarget$annotations = oTarget.annotations) === null || _oTarget$annotations === void 0 ? void 0 : (_oTarget$annotations$ = _oTarget$annotations.Common) === null || _oTarget$annotations$ === void 0 ? void 0 : (_oTarget$annotations$2 = _oTarget$annotations$.FieldControl) === null || _oTarget$annotations$2 === void 0 ? void 0 : _oTarget$annotations$2.valueOf();
    if (typeof oFieldControlValue === "object" && !!oFieldControlValue) {
      return or(equal(getExpressionFromAnnotation(oFieldControlValue, relativePath), 1), equal(getExpressionFromAnnotation(oFieldControlValue, relativePath), "1"));
    }
    return constant(oFieldControlValue === "Common.FieldControlType/ReadOnly");
  };

  /**
   * Create the binding expression to check if the property is disabled or not.
   *
   * @param oTarget The target property or DataField
   * @param relativePath Array of navigation properties pointing to the location of field control property
   * @returns The binding expression resolving to a Boolean being true if it's disabled
   */
  _exports.isReadOnlyExpression = isReadOnlyExpression;
  const isDisabledExpression = function (oTarget, relativePath) {
    var _oTarget$annotations2, _oTarget$annotations3, _oTarget$annotations4;
    const oFieldControlValue = oTarget === null || oTarget === void 0 ? void 0 : (_oTarget$annotations2 = oTarget.annotations) === null || _oTarget$annotations2 === void 0 ? void 0 : (_oTarget$annotations3 = _oTarget$annotations2.Common) === null || _oTarget$annotations3 === void 0 ? void 0 : (_oTarget$annotations4 = _oTarget$annotations3.FieldControl) === null || _oTarget$annotations4 === void 0 ? void 0 : _oTarget$annotations4.valueOf();
    if (typeof oFieldControlValue === "object" && !!oFieldControlValue) {
      return or(equal(getExpressionFromAnnotation(oFieldControlValue, relativePath), 0), equal(getExpressionFromAnnotation(oFieldControlValue, relativePath), "0"));
    }
    return constant(oFieldControlValue === "Common.FieldControlType/Inapplicable");
  };

  /**
   * Create the binding expression to check if the property is editable or not.
   *
   * @param oTarget The target property or DataField
   * @param relativePath Array of navigation properties pointing to the location of field control property
   * @returns The binding expression resolving to a Boolean being true if it's not editable
   */
  _exports.isDisabledExpression = isDisabledExpression;
  const isNonEditableExpression = function (oTarget, relativePath) {
    return or(isReadOnlyExpression(oTarget, relativePath), isDisabledExpression(oTarget, relativePath));
  };

  /**
   * Create the binding expression to check if the property is read only or not.
   *
   * @param oTarget The target property or DataField
   * @param relativePath Array of navigation properties pointing to the location of field control property
   * @returns The binding expression resolving to a Boolean being true if it's read only
   */
  _exports.isNonEditableExpression = isNonEditableExpression;
  const isRequiredExpression = function (oTarget, relativePath) {
    var _oTarget$annotations5, _oTarget$annotations6, _oTarget$annotations7;
    const oFieldControlValue = oTarget === null || oTarget === void 0 ? void 0 : (_oTarget$annotations5 = oTarget.annotations) === null || _oTarget$annotations5 === void 0 ? void 0 : (_oTarget$annotations6 = _oTarget$annotations5.Common) === null || _oTarget$annotations6 === void 0 ? void 0 : (_oTarget$annotations7 = _oTarget$annotations6.FieldControl) === null || _oTarget$annotations7 === void 0 ? void 0 : _oTarget$annotations7.valueOf();
    if (typeof oFieldControlValue === "object" && !!oFieldControlValue) {
      return or(equal(getExpressionFromAnnotation(oFieldControlValue, relativePath), 7), equal(getExpressionFromAnnotation(oFieldControlValue, relativePath), "7"));
    }
    return constant(oFieldControlValue === "Common.FieldControlType/Mandatory");
  };
  _exports.isRequiredExpression = isRequiredExpression;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/FieldControlHelper", ["sap/fe/core/helpers/BindingToolkit"],function(o){"use strict";var n={};var i=o.or;var l=o.getExpressionFromAnnotation;var e=o.equal;var t=o.constant;const r=function(o,n){var r,d,v;const s=o===null||o===void 0?void 0:(r=o.annotations)===null||r===void 0?void 0:(d=r.Common)===null||d===void 0?void 0:(v=d.FieldControl)===null||v===void 0?void 0:v.valueOf();if(typeof s==="object"&&!!s){return i(e(l(s,n),1),e(l(s,n),"1"))}return t(s==="Common.FieldControlType/ReadOnly")};n.isReadOnlyExpression=r;const d=function(o,n){var r,d,v;const s=o===null||o===void 0?void 0:(r=o.annotations)===null||r===void 0?void 0:(d=r.Common)===null||d===void 0?void 0:(v=d.FieldControl)===null||v===void 0?void 0:v.valueOf();if(typeof s==="object"&&!!s){return i(e(l(s,n),0),e(l(s,n),"0"))}return t(s==="Common.FieldControlType/Inapplicable")};n.isDisabledExpression=d;const v=function(o,n){return i(r(o,n),d(o,n))};n.isNonEditableExpression=v;const s=function(o,n){var r,d,v;const s=o===null||o===void 0?void 0:(r=o.annotations)===null||r===void 0?void 0:(d=r.Common)===null||d===void 0?void 0:(v=d.FieldControl)===null||v===void 0?void 0:v.valueOf();if(typeof s==="object"&&!!s){return i(e(l(s,n),7),e(l(s,n),"7"))}return t(s==="Common.FieldControlType/Mandatory")};n.isRequiredExpression=s;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/FilterHelper-dbg", ["sap/base/Log", "sap/fe/core/type/EDM", "sap/ui/mdc/condition/Condition", "sap/ui/mdc/enum/ConditionValidated"], function (Log, EDM, Condition, ConditionValidated) {
  "use strict";

  var _exports = {};
  var isTypeFilterable = EDM.isTypeFilterable;
  const oExcludeMap = {
    Contains: "NotContains",
    StartsWith: "NotStartsWith",
    EndsWith: "NotEndsWith",
    Empty: "NotEmpty",
    NotEmpty: "Empty",
    LE: "NOTLE",
    GE: "NOTGE",
    LT: "NOTLT",
    GT: "NOTGT",
    BT: "NOTBT",
    NE: "EQ",
    EQ: "NE"
  };
  function _getDateTimeOffsetCompliantValue(sValue) {
    let oValue;
    if (sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})\+(\d{1,4})/)) {
      oValue = sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})\+(\d{1,4})/)[0];
    } else if (sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})/)) {
      oValue = `${sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})/)[0]}+0000`;
    } else if (sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)) {
      oValue = `${sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)[0]}T00:00:00+0000`;
    } else if (sValue.indexOf("Z") === sValue.length - 1) {
      oValue = `${sValue.split("Z")[0]}+0100`;
    } else {
      oValue = undefined;
    }
    return oValue;
  }
  _exports._getDateTimeOffsetCompliantValue = _getDateTimeOffsetCompliantValue;
  function _getDateCompliantValue(sValue) {
    return sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/) ? sValue.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)[0] : sValue.match(/^(\d{8})/) && sValue.match(/^(\d{8})/)[0];
  }

  /**
   * Method to get the compliant value type based on the data type.
   *
   * @param  sValue Raw value
   * @param  sType The property type
   * @returns Value to be propagated to the condition.
   */
  _exports._getDateCompliantValue = _getDateCompliantValue;
  function getTypeCompliantValue(sValue, sType) {
    let oValue;
    if (!isTypeFilterable(sType)) {
      return undefined;
    }
    oValue = sValue;
    switch (sType) {
      case "Edm.Boolean":
        if (typeof sValue === "boolean") {
          oValue = sValue;
        } else {
          oValue = sValue === "true" || (sValue === "false" ? false : undefined);
        }
        break;
      case "Edm.Double":
      case "Edm.Single":
        oValue = isNaN(sValue) ? undefined : parseFloat(sValue);
        break;
      case "Edm.Byte":
      case "Edm.Int16":
      case "Edm.Int32":
      case "Edm.SByte":
        oValue = isNaN(sValue) ? undefined : parseInt(sValue, 10);
        break;
      case "Edm.Date":
        oValue = _getDateCompliantValue(sValue);
        break;
      case "Edm.DateTimeOffset":
        oValue = _getDateTimeOffsetCompliantValue(sValue);
        break;
      case "Edm.TimeOfDay":
        oValue = sValue.match(/(\d{1,2}):(\d{1,2}):(\d{1,2})/) ? sValue.match(/(\d{1,2}):(\d{1,2}):(\d{1,2})/)[0] : undefined;
        break;
      default:
    }
    return oValue === null ? undefined : oValue;
  }

  /**
   * Method to create a condition.
   *
   * @param  sOption Operator to be used.
   * @param  oV1 Lower value
   * @param  oV2 Higher value
   * @param sSign
   * @returns Condition to be created
   */
  _exports.getTypeCompliantValue = getTypeCompliantValue;
  function resolveConditionValues(sOption, oV1, oV2, sSign) {
    let oValue = oV1,
      oValue2,
      sInternalOperation;
    const oCondition = {};
    oCondition.values = [];
    oCondition.isEmpty = null;
    if (oV1 === undefined || oV1 === null) {
      return undefined;
    }
    switch (sOption) {
      case "CP":
        sInternalOperation = "Contains";
        if (oValue) {
          const nIndexOf = oValue.indexOf("*");
          const nLastIndex = oValue.lastIndexOf("*");

          // only when there are '*' at all
          if (nIndexOf > -1) {
            if (nIndexOf === 0 && nLastIndex !== oValue.length - 1) {
              sInternalOperation = "EndsWith";
              oValue = oValue.substring(1, oValue.length);
            } else if (nIndexOf !== 0 && nLastIndex === oValue.length - 1) {
              sInternalOperation = "StartsWith";
              oValue = oValue.substring(0, oValue.length - 1);
            } else {
              oValue = oValue.substring(1, oValue.length - 1);
            }
          } else {
            Log.warning("Contains Option cannot be used without '*'.");
            return undefined;
          }
        }
        break;
      case "EQ":
        sInternalOperation = oV1 === "" ? "Empty" : sOption;
        break;
      case "NE":
        sInternalOperation = oV1 === "" ? "NotEmpty" : sOption;
        break;
      case "BT":
        if (oV2 === undefined || oV2 === null) {
          return;
        }
        oValue2 = oV2;
        sInternalOperation = sOption;
        break;
      case "LE":
      case "GE":
      case "GT":
      case "LT":
        sInternalOperation = sOption;
        break;
      default:
        Log.warning(`Selection Option is not supported : '${sOption}'`);
        return undefined;
    }
    if (sSign === "E") {
      sInternalOperation = oExcludeMap[sInternalOperation];
    }
    oCondition.operator = sInternalOperation;
    if (sInternalOperation !== "Empty") {
      oCondition.values.push(oValue);
      if (oValue2) {
        oCondition.values.push(oValue2);
      }
    }
    return oCondition;
  }

  /* Method to get the Range property from the Selection Option */
  _exports.resolveConditionValues = resolveConditionValues;
  function getRangeProperty(sProperty) {
    return sProperty.indexOf("/") > 0 ? sProperty.split("/")[1] : sProperty;
  }
  _exports.getRangeProperty = getRangeProperty;
  function _buildConditionsFromSelectionRanges(Ranges, oProperty, sPropertyName, getCustomConditions) {
    const aConditions = [];
    Ranges === null || Ranges === void 0 ? void 0 : Ranges.forEach(Range => {
      const oCondition = getCustomConditions ? getCustomConditions(Range, oProperty, sPropertyName) : getConditions(Range, oProperty);
      if (oCondition) {
        aConditions.push(oCondition);
      }
    });
    return aConditions;
  }
  function _getProperty(propertyName, metaModel, entitySetPath) {
    const lastSlashIndex = propertyName.lastIndexOf("/");
    const navigationPath = lastSlashIndex > -1 ? propertyName.substring(0, propertyName.lastIndexOf("/") + 1) : "";
    const collection = metaModel.getObject(`${entitySetPath}/${navigationPath}`);
    return collection === null || collection === void 0 ? void 0 : collection[propertyName.replace(navigationPath, "")];
  }
  function _buildFiltersConditionsFromSelectOption(selectOption, metaModel, entitySetPath, getCustomConditions) {
    const propertyName = selectOption.PropertyName,
      filterConditions = {},
      propertyPath = propertyName.value || propertyName.$PropertyPath,
      Ranges = selectOption.Ranges;
    const targetProperty = _getProperty(propertyPath, metaModel, entitySetPath);
    if (targetProperty) {
      const conditions = _buildConditionsFromSelectionRanges(Ranges, targetProperty, propertyPath, getCustomConditions);
      if (conditions.length) {
        filterConditions[propertyPath] = (filterConditions[propertyPath] || []).concat(conditions);
      }
    }
    return filterConditions;
  }
  function getFiltersConditionsFromSelectionVariant(sEntitySetPath, oMetaModel, selectionVariant, getCustomConditions) {
    let oFilterConditions = {};
    if (!selectionVariant) {
      return oFilterConditions;
    }
    const aSelectOptions = selectionVariant.SelectOptions,
      aParameters = selectionVariant.Parameters;
    aSelectOptions === null || aSelectOptions === void 0 ? void 0 : aSelectOptions.forEach(selectOption => {
      const propertyName = selectOption.PropertyName,
        sPropertyName = propertyName.value || propertyName.$PropertyPath;
      if (Object.keys(oFilterConditions).includes(sPropertyName)) {
        oFilterConditions[sPropertyName] = oFilterConditions[sPropertyName].concat(_buildFiltersConditionsFromSelectOption(selectOption, oMetaModel, sEntitySetPath, getCustomConditions)[sPropertyName]);
      } else {
        oFilterConditions = {
          ...oFilterConditions,
          ..._buildFiltersConditionsFromSelectOption(selectOption, oMetaModel, sEntitySetPath, getCustomConditions)
        };
      }
    });
    aParameters === null || aParameters === void 0 ? void 0 : aParameters.forEach(parameter => {
      const sPropertyPath = parameter.PropertyName.value || parameter.PropertyName.$PropertyPath;
      const oCondition = getCustomConditions ? {
        operator: "EQ",
        value1: parameter.PropertyValue,
        value2: null,
        path: sPropertyPath,
        isParameter: true
      } : {
        operator: "EQ",
        values: [parameter.PropertyValue],
        isEmpty: null,
        validated: ConditionValidated.Validated,
        isParameter: true
      };
      oFilterConditions[sPropertyPath] = [oCondition];
    });
    return oFilterConditions;
  }
  _exports.getFiltersConditionsFromSelectionVariant = getFiltersConditionsFromSelectionVariant;
  function getConditions(Range, oValidProperty) {
    let oCondition;
    const sign = Range.Sign ? getRangeProperty(Range.Sign) : undefined;
    const sOption = Range.Option ? getRangeProperty(Range.Option) : undefined;
    const oValue1 = getTypeCompliantValue(Range.Low, oValidProperty.$Type || oValidProperty.type);
    const oValue2 = Range.High ? getTypeCompliantValue(Range.High, oValidProperty.$Type || oValidProperty.type) : undefined;
    const oConditionValues = resolveConditionValues(sOption, oValue1, oValue2, sign);
    if (oConditionValues) {
      oCondition = Condition.createCondition(oConditionValues.operator, oConditionValues.values, null, null, ConditionValidated.Validated);
    }
    return oCondition;
  }
  _exports.getConditions = getConditions;
  const getDefaultValueFilters = function (oContext, properties) {
    const filterConditions = {};
    const entitySetPath = oContext.getInterface(1).getPath(),
      oMetaModel = oContext.getInterface(1).getModel();
    if (properties) {
      for (const key in properties) {
        const defaultFilterValue = oMetaModel.getObject(`${entitySetPath}/${key}@com.sap.vocabularies.Common.v1.FilterDefaultValue`);
        if (defaultFilterValue !== undefined) {
          const PropertyName = key;
          filterConditions[PropertyName] = [Condition.createCondition("EQ", [defaultFilterValue], null, null, ConditionValidated.Validated)];
        }
      }
    }
    return filterConditions;
  };
  const getDefaultSemanticDateFilters = function (oContext, properties, defaultSemanticDates) {
    const filterConditions = {};
    const oInterface = oContext.getInterface(1);
    const oMetaModel = oInterface.getModel();
    const sEntityTypePath = oInterface.getPath();
    for (const key in defaultSemanticDates) {
      if (defaultSemanticDates[key][0]) {
        const aPropertyPathParts = key.split("::");
        let sPath = "";
        const iPropertyPathLength = aPropertyPathParts.length;
        const sNavigationPath = aPropertyPathParts.slice(0, aPropertyPathParts.length - 1).join("/");
        const sProperty = aPropertyPathParts[iPropertyPathLength - 1];
        if (sNavigationPath) {
          //Create Proper Condition Path e.g. _Item*/Property or _Item/Property
          const vProperty = oMetaModel.getObject(sEntityTypePath + "/" + sNavigationPath);
          if (vProperty.$kind === "NavigationProperty" && vProperty.$isCollection) {
            sPath += `${sNavigationPath}*/`;
          } else if (vProperty.$kind === "NavigationProperty") {
            sPath += `${sNavigationPath}/`;
          }
        }
        sPath += sProperty;
        const operatorParamsArr = "values" in defaultSemanticDates[key][0] ? defaultSemanticDates[key][0].values : [];
        filterConditions[sPath] = [Condition.createCondition(defaultSemanticDates[key][0].operator, operatorParamsArr, null, null, null)];
      }
    }
    return filterConditions;
  };
  function getEditStatusFilter() {
    const ofilterConditions = {};
    ofilterConditions["$editState"] = [Condition.createCondition("DRAFT_EDIT_STATE", ["ALL"], null, null, ConditionValidated.Validated)];
    return ofilterConditions;
  }
  function getFilterConditions(oContext, filterConditions) {
    var _filterConditions, _filterConditions2;
    let editStateFilter;
    const entitySetPath = oContext.getInterface(1).getPath(),
      oMetaModel = oContext.getInterface(1).getModel(),
      entityTypeAnnotations = oMetaModel.getObject(`${entitySetPath}@`),
      entityTypeProperties = oMetaModel.getObject(`${entitySetPath}/`);
    if (entityTypeAnnotations["@com.sap.vocabularies.Common.v1.DraftRoot"] || entityTypeAnnotations["@com.sap.vocabularies.Common.v1.DraftNode"]) {
      editStateFilter = getEditStatusFilter();
    }
    const selectionVariant = (_filterConditions = filterConditions) === null || _filterConditions === void 0 ? void 0 : _filterConditions.selectionVariant;
    const defaultSemanticDates = ((_filterConditions2 = filterConditions) === null || _filterConditions2 === void 0 ? void 0 : _filterConditions2.defaultSemanticDates) || {};
    const defaultFilters = getDefaultValueFilters(oContext, entityTypeProperties);
    const defaultSemanticDateFilters = getDefaultSemanticDateFilters(oContext, entityTypeProperties, defaultSemanticDates);
    if (selectionVariant) {
      filterConditions = getFiltersConditionsFromSelectionVariant(entitySetPath, oMetaModel, selectionVariant);
    } else if (defaultFilters) {
      filterConditions = defaultFilters;
    }
    if (defaultSemanticDateFilters) {
      // only for semantic date:
      // 1. value from manifest get merged with SV
      // 2. manifest value is given preference when there is same semantic date property in SV and manifest
      filterConditions = {
        ...filterConditions,
        ...defaultSemanticDateFilters
      };
    }
    if (editStateFilter) {
      filterConditions = {
        ...filterConditions,
        ...editStateFilter
      };
    }
    return Object.keys(filterConditions).length > 0 ? JSON.stringify(filterConditions).replace(/([\{\}])/g, "\\$1") : undefined;
  }
  _exports.getFilterConditions = getFilterConditions;
  getFilterConditions.requiresIContext = true;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/FilterHelper", ["sap/base/Log","sap/fe/core/type/EDM","sap/ui/mdc/condition/Condition","sap/ui/mdc/enum/ConditionValidated"],function(e,t,n,i){"use strict";var o={};var a=t.isTypeFilterable;const s={Contains:"NotContains",StartsWith:"NotStartsWith",EndsWith:"NotEndsWith",Empty:"NotEmpty",NotEmpty:"Empty",LE:"NOTLE",GE:"NOTGE",LT:"NOTLT",GT:"NOTGT",BT:"NOTBT",NE:"EQ",EQ:"NE"};function d(e){let t;if(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})\+(\d{1,4})/)){t=e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})\+(\d{1,4})/)[0]}else if(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})/)){t=`${e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})/)[0]}+0000`}else if(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)){t=`${e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)[0]}T00:00:00+0000`}else if(e.indexOf("Z")===e.length-1){t=`${e.split("Z")[0]}+0100`}else{t=undefined}return t}o._getDateTimeOffsetCompliantValue=d;function r(e){return e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)?e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)[0]:e.match(/^(\d{8})/)&&e.match(/^(\d{8})/)[0]}o._getDateCompliantValue=r;function l(e,t){let n;if(!a(t)){return undefined}n=e;switch(t){case"Edm.Boolean":if(typeof e==="boolean"){n=e}else{n=e==="true"||(e==="false"?false:undefined)}break;case"Edm.Double":case"Edm.Single":n=isNaN(e)?undefined:parseFloat(e);break;case"Edm.Byte":case"Edm.Int16":case"Edm.Int32":case"Edm.SByte":n=isNaN(e)?undefined:parseInt(e,10);break;case"Edm.Date":n=r(e);break;case"Edm.DateTimeOffset":n=d(e);break;case"Edm.TimeOfDay":n=e.match(/(\d{1,2}):(\d{1,2}):(\d{1,2})/)?e.match(/(\d{1,2}):(\d{1,2}):(\d{1,2})/)[0]:undefined;break;default:}return n===null?undefined:n}o.getTypeCompliantValue=l;function c(t,n,i,o){let a=n,d,r;const l={};l.values=[];l.isEmpty=null;if(n===undefined||n===null){return undefined}switch(t){case"CP":r="Contains";if(a){const t=a.indexOf("*");const n=a.lastIndexOf("*");if(t>-1){if(t===0&&n!==a.length-1){r="EndsWith";a=a.substring(1,a.length)}else if(t!==0&&n===a.length-1){r="StartsWith";a=a.substring(0,a.length-1)}else{a=a.substring(1,a.length-1)}}else{e.warning("Contains Option cannot be used without '*'.");return undefined}}break;case"EQ":r=n===""?"Empty":t;break;case"NE":r=n===""?"NotEmpty":t;break;case"BT":if(i===undefined||i===null){return}d=i;r=t;break;case"LE":case"GE":case"GT":case"LT":r=t;break;default:e.warning(`Selection Option is not supported : '${t}'`);return undefined}if(o==="E"){r=s[r]}l.operator=r;if(r!=="Empty"){l.values.push(a);if(d){l.values.push(d)}}return l}o.resolveConditionValues=c;function u(e){return e.indexOf("/")>0?e.split("/")[1]:e}o.getRangeProperty=u;function f(e,t,n,i){const o=[];e===null||e===void 0?void 0:e.forEach(e=>{const a=i?i(e,t,n):h(e,t);if(a){o.push(a)}});return o}function p(e,t,n){const i=e.lastIndexOf("/");const o=i>-1?e.substring(0,e.lastIndexOf("/")+1):"";const a=t.getObject(`${n}/${o}`);return a===null||a===void 0?void 0:a[e.replace(o,"")]}function m(e,t,n,i){const o=e.PropertyName,a={},s=o.value||o.$PropertyPath,d=e.Ranges;const r=p(s,t,n);if(r){const e=f(d,r,s,i);if(e.length){a[s]=(a[s]||[]).concat(e)}}return a}function g(e,t,n,o){let a={};if(!n){return a}const s=n.SelectOptions,d=n.Parameters;s===null||s===void 0?void 0:s.forEach(n=>{const i=n.PropertyName,s=i.value||i.$PropertyPath;if(Object.keys(a).includes(s)){a[s]=a[s].concat(m(n,t,e,o)[s])}else{a={...a,...m(n,t,e,o)}}});d===null||d===void 0?void 0:d.forEach(e=>{const t=e.PropertyName.value||e.PropertyName.$PropertyPath;const n=o?{operator:"EQ",value1:e.PropertyValue,value2:null,path:t,isParameter:true}:{operator:"EQ",values:[e.PropertyValue],isEmpty:null,validated:i.Validated,isParameter:true};a[t]=[n]});return a}o.getFiltersConditionsFromSelectionVariant=g;function h(e,t){let o;const a=e.Sign?u(e.Sign):undefined;const s=e.Option?u(e.Option):undefined;const d=l(e.Low,t.$Type||t.type);const r=e.High?l(e.High,t.$Type||t.type):undefined;const f=c(s,d,r,a);if(f){o=n.createCondition(f.operator,f.values,null,null,i.Validated)}return o}o.getConditions=h;const E=function(e,t){const o={};const a=e.getInterface(1).getPath(),s=e.getInterface(1).getModel();if(t){for(const e in t){const t=s.getObject(`${a}/${e}@com.sap.vocabularies.Common.v1.FilterDefaultValue`);if(t!==undefined){const a=e;o[a]=[n.createCondition("EQ",[t],null,null,i.Validated)]}}}return o};const v=function(e,t,i){const o={};const a=e.getInterface(1);const s=a.getModel();const d=a.getPath();for(const e in i){if(i[e][0]){const t=e.split("::");let a="";const r=t.length;const l=t.slice(0,t.length-1).join("/");const c=t[r-1];if(l){const e=s.getObject(d+"/"+l);if(e.$kind==="NavigationProperty"&&e.$isCollection){a+=`${l}*/`}else if(e.$kind==="NavigationProperty"){a+=`${l}/`}}a+=c;const u="values"in i[e][0]?i[e][0].values:[];o[a]=[n.createCondition(i[e][0].operator,u,null,null,null)]}}return o};function y(){const e={};e["$editState"]=[n.createCondition("DRAFT_EDIT_STATE",["ALL"],null,null,i.Validated)];return e}function b(e,t){var n,i;let o;const a=e.getInterface(1).getPath(),s=e.getInterface(1).getModel(),d=s.getObject(`${a}@`),r=s.getObject(`${a}/`);if(d["@com.sap.vocabularies.Common.v1.DraftRoot"]||d["@com.sap.vocabularies.Common.v1.DraftNode"]){o=y()}const l=(n=t)===null||n===void 0?void 0:n.selectionVariant;const c=((i=t)===null||i===void 0?void 0:i.defaultSemanticDates)||{};const u=E(e,r);const f=v(e,r,c);if(l){t=g(a,s,l)}else if(u){t=u}if(f){t={...t,...f}}if(o){t={...t,...o}}return Object.keys(t).length>0?JSON.stringify(t).replace(/([\{\}])/g,"\\$1"):undefined}o.getFilterConditions=b;b.requiresIContext=true;return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/FilterTemplating-dbg", ["sap/fe/core/helpers/ModelHelper"], function (modelHelper) {
  "use strict";

  var _exports = {};
  function getIsRequired(converterContext, sPropertyPath) {
    var _capabilities, _capabilities$FilterR;
    const entitySet = converterContext.getEntitySet();
    const entitySetAnnotations = entitySet === null || entitySet === void 0 ? void 0 : entitySet.annotations;
    let capabilities;
    if (!modelHelper.isSingleton(entitySet)) {
      capabilities = entitySetAnnotations === null || entitySetAnnotations === void 0 ? void 0 : entitySetAnnotations.Capabilities;
    }
    const aRequiredProperties = (_capabilities = capabilities) === null || _capabilities === void 0 ? void 0 : (_capabilities$FilterR = _capabilities.FilterRestrictions) === null || _capabilities$FilterR === void 0 ? void 0 : _capabilities$FilterR.RequiredProperties;
    let bIsRequired = false;
    if (aRequiredProperties) {
      aRequiredProperties.forEach(function (oRequiredProperty) {
        if (sPropertyPath === (oRequiredProperty === null || oRequiredProperty === void 0 ? void 0 : oRequiredProperty.value)) {
          bIsRequired = true;
        }
      });
    }
    return bIsRequired;
  }
  _exports.getIsRequired = getIsRequired;
  function isPropertyFilterable(converterContext, valueListProperty) {
    var _capabilities2, _capabilities2$Filter;
    let bNotFilterable, bHidden;
    const entityType = converterContext.getEntityType();
    const entitySet = converterContext.getEntitySet();
    const entitySetAnnotations = entitySet === null || entitySet === void 0 ? void 0 : entitySet.annotations;
    let capabilities;
    if (!modelHelper.isSingleton(entitySet)) {
      capabilities = entitySetAnnotations === null || entitySetAnnotations === void 0 ? void 0 : entitySetAnnotations.Capabilities;
    }
    const nonFilterableProperties = (_capabilities2 = capabilities) === null || _capabilities2 === void 0 ? void 0 : (_capabilities2$Filter = _capabilities2.FilterRestrictions) === null || _capabilities2$Filter === void 0 ? void 0 : _capabilities2$Filter.NonFilterableProperties;
    const properties = entityType.entityProperties;
    properties.forEach(property => {
      const PropertyPath = property.name;
      if (PropertyPath === valueListProperty) {
        var _property$annotations, _property$annotations2, _property$annotations3;
        bHidden = (_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : (_property$annotations2 = _property$annotations.UI) === null || _property$annotations2 === void 0 ? void 0 : (_property$annotations3 = _property$annotations2.Hidden) === null || _property$annotations3 === void 0 ? void 0 : _property$annotations3.valueOf();
      }
    });
    if (nonFilterableProperties && nonFilterableProperties.length > 0) {
      for (let i = 0; i < nonFilterableProperties.length; i++) {
        var _nonFilterablePropert;
        const sPropertyName = (_nonFilterablePropert = nonFilterableProperties[i]) === null || _nonFilterablePropert === void 0 ? void 0 : _nonFilterablePropert.value;
        if (sPropertyName === valueListProperty) {
          bNotFilterable = true;
        }
      }
    }
    return bNotFilterable || bHidden;
  }
  _exports.isPropertyFilterable = isPropertyFilterable;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/FilterTemplating", ["sap/fe/core/helpers/ModelHelper"],function(i){"use strict";var t={};function e(t,e){var o,n;const l=t.getEntitySet();const r=l===null||l===void 0?void 0:l.annotations;let v;if(!i.isSingleton(l)){v=r===null||r===void 0?void 0:r.Capabilities}const s=(o=v)===null||o===void 0?void 0:(n=o.FilterRestrictions)===null||n===void 0?void 0:n.RequiredProperties;let d=false;if(s){s.forEach(function(i){if(e===(i===null||i===void 0?void 0:i.value)){d=true}})}return d}t.getIsRequired=e;function o(t,e){var o,n;let l,r;const v=t.getEntityType();const s=t.getEntitySet();const d=s===null||s===void 0?void 0:s.annotations;let u;if(!i.isSingleton(s)){u=d===null||d===void 0?void 0:d.Capabilities}const a=(o=u)===null||o===void 0?void 0:(n=o.FilterRestrictions)===null||n===void 0?void 0:n.NonFilterableProperties;const c=v.entityProperties;c.forEach(i=>{const t=i.name;if(t===e){var o,n,l;r=(o=i.annotations)===null||o===void 0?void 0:(n=o.UI)===null||n===void 0?void 0:(l=n.Hidden)===null||l===void 0?void 0:l.valueOf()}});if(a&&a.length>0){for(let i=0;i<a.length;i++){var f;const t=(f=a[i])===null||f===void 0?void 0:f.value;if(t===e){l=true}}}return l||r}t.isPropertyFilterable=o;return t},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/PropertyFormatters-dbg", ["sap/fe/core/converters/MetaModelConverter", "sap/fe/core/templating/DataModelPathHelper", "./PropertyHelper", "./UIFormatters"], function (MetaModelConverter, DataModelPathHelper, PropertyHelper, UIFormatters) {
  "use strict";

  var _exports = {};
  var getConverterContext = UIFormatters.getConverterContext;
  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var enhanceDataModelPath = DataModelPathHelper.enhanceDataModelPath;
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  const getProperty = function (oContext, oInterface) {
    const sPath = oInterface.context.getPath();
    if (!oContext) {
      throw new Error(`Unresolved context path ${sPath}`);
    }
    let isPath = false;
    if (typeof oContext === "object" && oContext.hasOwnProperty("$Path")) {
      isPath = true;
    } else if (typeof oContext === "object" && oContext.hasOwnProperty("$kind") && oContext.$kind !== "Property") {
      throw new Error(`Context does not resolve to a Property object but to a ${oContext.$kind}`);
    }
    let oConverterContext = getConverterContext(oContext, oInterface);
    if (isPath) {
      oConverterContext = oConverterContext.$target;
    }
    return oConverterContext;
  };
  _exports.getProperty = getProperty;
  const getPropertyObjectPath = function (oContext, oInterface) {
    const sPath = oInterface.context.getPath();
    if (!oContext) {
      throw new Error(`Unresolved context path ${sPath}`);
    }
    if (typeof oContext === "object" && oContext.hasOwnProperty("$kind") && oContext.$kind !== "Property") {
      throw new Error(`Context does not resolve to a Property object but to a ${oContext.$kind}`);
    }
    let involvedDataModelObjects = getInvolvedDataModelObjects(oInterface.context);
    if (involvedDataModelObjects.targetObject && involvedDataModelObjects.targetObject.type === "Path") {
      involvedDataModelObjects = enhanceDataModelPath(involvedDataModelObjects, involvedDataModelObjects.targetObject.path);
    }
    return involvedDataModelObjects;
  };
  _exports.getPropertyObjectPath = getPropertyObjectPath;
  const isKey = function (oContext, oInterface) {
    const oProperty = getProperty(oContext, oInterface);
    return PropertyHelper.isKey(oProperty);
  };
  _exports.isKey = isKey;
  const hasValueHelp = function (oContext, oInterface) {
    const oProperty = getProperty(oContext, oInterface);
    return PropertyHelper.hasValueHelp(oProperty);
  };
  _exports.hasValueHelp = hasValueHelp;
  const hasDateType = function (oContext, oInterface) {
    const oProperty = getProperty(oContext, oInterface);
    return PropertyHelper.hasDateType(oProperty);
  };
  _exports.hasDateType = hasDateType;
  const hasValueHelpWithFixedValues = function (oContext, oInterface) {
    const oProperty = getProperty(oContext, oInterface);
    return PropertyHelper.hasValueHelpWithFixedValues(oProperty);
  };
  _exports.hasValueHelpWithFixedValues = hasValueHelpWithFixedValues;
  const hasUnitOrCurrency = function (oContext, oInterface) {
    const oProperty = getProperty(oContext, oInterface);
    return PropertyHelper.hasCurrency(oProperty) || PropertyHelper.hasUnit(oProperty);
  };
  _exports.hasUnitOrCurrency = hasUnitOrCurrency;
  const getName = function (oContext, oInterface) {
    const oProperty = getProperty(oContext, oInterface);
    return oProperty.name;
  };
  _exports.getName = getName;
  const getLabel = function (oContext, oInterface) {
    const oProperty = getProperty(oContext, oInterface);
    return PropertyHelper.getLabel(oProperty);
  };
  _exports.getLabel = getLabel;
  const getPropertyPath = function (oContext, oInterface) {
    const propertyPath = getPropertyObjectPath(oContext, oInterface);
    return getTargetObjectPath(propertyPath);
  };
  _exports.getPropertyPath = getPropertyPath;
  const getRelativePropertyPath = function (oContext, oInterface) {
    const propertyPath = getPropertyObjectPath(oContext, oInterface);
    return getTargetObjectPath(propertyPath, true);
  };
  _exports.getRelativePropertyPath = getRelativePropertyPath;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/PropertyFormatters", ["sap/fe/core/converters/MetaModelConverter","sap/fe/core/templating/DataModelPathHelper","./PropertyHelper","./UIFormatters"],function(t,e,r,n){"use strict";var o={};var a=n.getConverterContext;var c=e.getTargetObjectPath;var s=e.enhanceDataModelPath;var i=t.getInvolvedDataModelObjects;const u=function(t,e){const r=e.context.getPath();if(!t){throw new Error(`Unresolved context path ${r}`)}let n=false;if(typeof t==="object"&&t.hasOwnProperty("$Path")){n=true}else if(typeof t==="object"&&t.hasOwnProperty("$kind")&&t.$kind!=="Property"){throw new Error(`Context does not resolve to a Property object but to a ${t.$kind}`)}let o=a(t,e);if(n){o=o.$target}return o};o.getProperty=u;const h=function(t,e){const r=e.context.getPath();if(!t){throw new Error(`Unresolved context path ${r}`)}if(typeof t==="object"&&t.hasOwnProperty("$kind")&&t.$kind!=="Property"){throw new Error(`Context does not resolve to a Property object but to a ${t.$kind}`)}let n=i(e.context);if(n.targetObject&&n.targetObject.type==="Path"){n=s(n,n.targetObject.path)}return n};o.getPropertyObjectPath=h;const l=function(t,e){const n=u(t,e);return r.isKey(n)};o.isKey=l;const p=function(t,e){const n=u(t,e);return r.hasValueHelp(n)};o.hasValueHelp=p;const f=function(t,e){const n=u(t,e);return r.hasDateType(n)};o.hasDateType=f;const y=function(t,e){const n=u(t,e);return r.hasValueHelpWithFixedValues(n)};o.hasValueHelpWithFixedValues=y;const P=function(t,e){const n=u(t,e);return r.hasCurrency(n)||r.hasUnit(n)};o.hasUnitOrCurrency=P;const d=function(t,e){const r=u(t,e);return r.name};o.getName=d;const g=function(t,e){const n=u(t,e);return r.getLabel(n)};o.getLabel=g;const b=function(t,e){const r=h(t,e);return c(r)};o.getPropertyPath=b;const v=function(t,e){const r=h(t,e);return c(r,true)};o.getRelativePropertyPath=v;return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/PropertyHelper-dbg", ["sap/fe/core/templating/SemanticObjectHelper"], function (SemanticObjectHelper) {
  "use strict";

  var _exports = {};
  /**
   * Identify if the given property passed is a "Property" (has a _type).
   *
   * @param property A target property to evaluate
   * @returns Validate that property is a Property
   */
  function isProperty(property) {
    return property && property.hasOwnProperty("_type") && property._type === "Property";
  }

  /**
   * Check whether the property has the Core.Computed annotation or not.
   *
   * @param oProperty The target property
   * @returns `true` if the property is computed
   */
  _exports.isProperty = isProperty;
  const isComputed = function (oProperty) {
    var _oProperty$annotation, _oProperty$annotation2, _oProperty$annotation3;
    return !!((_oProperty$annotation = oProperty.annotations) !== null && _oProperty$annotation !== void 0 && (_oProperty$annotation2 = _oProperty$annotation.Core) !== null && _oProperty$annotation2 !== void 0 && (_oProperty$annotation3 = _oProperty$annotation2.Computed) !== null && _oProperty$annotation3 !== void 0 && _oProperty$annotation3.valueOf());
  };

  /**
   * Identify if the given property passed is a "NavigationProperty".
   *
   * @param property A target property to evaluate
   * @returns Validate that property is a NavigationProperty
   */
  _exports.isComputed = isComputed;
  function isNavigationProperty(property) {
    return property && property.hasOwnProperty("_type") && property._type === "NavigationProperty";
  }

  /**
   * Check whether the property has the Core.Immutable annotation or not.
   *
   * @param oProperty The target property
   * @returns `true` if it's immutable
   */
  _exports.isNavigationProperty = isNavigationProperty;
  const isImmutable = function (oProperty) {
    var _oProperty$annotation4, _oProperty$annotation5, _oProperty$annotation6;
    return !!((_oProperty$annotation4 = oProperty.annotations) !== null && _oProperty$annotation4 !== void 0 && (_oProperty$annotation5 = _oProperty$annotation4.Core) !== null && _oProperty$annotation5 !== void 0 && (_oProperty$annotation6 = _oProperty$annotation5.Immutable) !== null && _oProperty$annotation6 !== void 0 && _oProperty$annotation6.valueOf());
  };

  /**
   * Check whether the property is a key or not.
   *
   * @param oProperty The target property
   * @returns `true` if it's a key
   */
  _exports.isImmutable = isImmutable;
  const isKey = function (oProperty) {
    return !!oProperty.isKey;
  };

  /**
   * Check whether the property is a semanticKey for the context entity.
   *
   * @param property
   * @param contextDataModelObject The DataModelObject that holds the context
   * @returns `true`if it's a semantic key
   */
  _exports.isKey = isKey;
  const isSemanticKey = function (property, contextDataModelObject) {
    var _contextDataModelObje, _contextDataModelObje2, _contextDataModelObje3, _contextDataModelObje4;
    const semanticKeys = (_contextDataModelObje = contextDataModelObject.contextLocation) === null || _contextDataModelObje === void 0 ? void 0 : (_contextDataModelObje2 = _contextDataModelObje.targetEntityType) === null || _contextDataModelObje2 === void 0 ? void 0 : (_contextDataModelObje3 = _contextDataModelObje2.annotations) === null || _contextDataModelObje3 === void 0 ? void 0 : (_contextDataModelObje4 = _contextDataModelObje3.Common) === null || _contextDataModelObje4 === void 0 ? void 0 : _contextDataModelObje4.SemanticKey;
    return (semanticKeys === null || semanticKeys === void 0 ? void 0 : semanticKeys.some(function (key) {
      var _key$$target;
      return (key === null || key === void 0 ? void 0 : (_key$$target = key.$target) === null || _key$$target === void 0 ? void 0 : _key$$target.fullyQualifiedName) === property.fullyQualifiedName;
    })) ?? false;
  };

  /**
   * Checks whether the property has a date time or not.
   *
   * @param oProperty
   * @returns `true` if it is of type date / datetime / datetimeoffset
   */
  _exports.isSemanticKey = isSemanticKey;
  const hasDateType = function (oProperty) {
    return ["Edm.Date", "Edm.DateTime", "Edm.DateTimeOffset"].indexOf(oProperty.type) !== -1;
  };

  /**
   * Retrieve the label annotation.
   *
   * @param oProperty The target property
   * @returns The label string
   */
  _exports.hasDateType = hasDateType;
  const getLabel = function (oProperty) {
    var _oProperty$annotation7, _oProperty$annotation8, _oProperty$annotation9;
    return ((_oProperty$annotation7 = oProperty.annotations) === null || _oProperty$annotation7 === void 0 ? void 0 : (_oProperty$annotation8 = _oProperty$annotation7.Common) === null || _oProperty$annotation8 === void 0 ? void 0 : (_oProperty$annotation9 = _oProperty$annotation8.Label) === null || _oProperty$annotation9 === void 0 ? void 0 : _oProperty$annotation9.toString()) || "";
  };

  /**
   * Check whether the property has a semantic object defined or not.
   *
   * @param property The target property
   * @returns `true` if it has a semantic object
   */
  _exports.getLabel = getLabel;
  const hasSemanticObject = function (property) {
    return SemanticObjectHelper.hasSemanticObject(property);
  };
  _exports.hasSemanticObject = hasSemanticObject;
  const isPathExpression = function (expression) {
    return !!expression && expression.type !== undefined && expression.type === "Path";
  };
  _exports.isPathExpression = isPathExpression;
  const isPropertyPathExpression = function (expression) {
    return !!expression && expression.type !== undefined && expression.type === "PropertyPath";
  };
  _exports.isPropertyPathExpression = isPropertyPathExpression;
  const isAnnotationPathExpression = function (expression) {
    return !!expression && expression.type !== undefined && expression.type === "AnnotationPath";
  };

  /**
   * Retrieves the timezone property associated to the property, if applicable.
   *
   * @param oProperty The target property
   * @returns The timezone property, if it exists
   */
  _exports.isAnnotationPathExpression = isAnnotationPathExpression;
  const getAssociatedTimezoneProperty = function (oProperty) {
    var _oProperty$annotation10, _oProperty$annotation11, _oProperty$annotation12, _oProperty$annotation13;
    return isPathExpression(oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation10 = oProperty.annotations) === null || _oProperty$annotation10 === void 0 ? void 0 : (_oProperty$annotation11 = _oProperty$annotation10.Common) === null || _oProperty$annotation11 === void 0 ? void 0 : _oProperty$annotation11.Timezone) ? (_oProperty$annotation12 = oProperty.annotations) === null || _oProperty$annotation12 === void 0 ? void 0 : (_oProperty$annotation13 = _oProperty$annotation12.Common) === null || _oProperty$annotation13 === void 0 ? void 0 : _oProperty$annotation13.Timezone.$target : undefined;
  };

  /**
   * Retrieves the timezone property path associated to the property, if applicable.
   *
   * @param oProperty The target property
   * @returns The timezone property path, if it exists
   */
  _exports.getAssociatedTimezoneProperty = getAssociatedTimezoneProperty;
  const getAssociatedTimezonePropertyPath = function (oProperty) {
    var _oProperty$annotation14, _oProperty$annotation15, _oProperty$annotation16, _oProperty$annotation17, _oProperty$annotation18;
    return isPathExpression(oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation14 = oProperty.annotations) === null || _oProperty$annotation14 === void 0 ? void 0 : (_oProperty$annotation15 = _oProperty$annotation14.Common) === null || _oProperty$annotation15 === void 0 ? void 0 : _oProperty$annotation15.Timezone) ? oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation16 = oProperty.annotations) === null || _oProperty$annotation16 === void 0 ? void 0 : (_oProperty$annotation17 = _oProperty$annotation16.Common) === null || _oProperty$annotation17 === void 0 ? void 0 : (_oProperty$annotation18 = _oProperty$annotation17.Timezone) === null || _oProperty$annotation18 === void 0 ? void 0 : _oProperty$annotation18.path : undefined;
  };

  /**
   * Retrieves the associated text property for that property, if it exists.
   *
   * @param oProperty The target property
   * @returns The text property, if it exists
   */
  _exports.getAssociatedTimezonePropertyPath = getAssociatedTimezonePropertyPath;
  const getAssociatedTextProperty = function (oProperty) {
    var _oProperty$annotation19, _oProperty$annotation20, _oProperty$annotation21, _oProperty$annotation22;
    return isPathExpression(oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation19 = oProperty.annotations) === null || _oProperty$annotation19 === void 0 ? void 0 : (_oProperty$annotation20 = _oProperty$annotation19.Common) === null || _oProperty$annotation20 === void 0 ? void 0 : _oProperty$annotation20.Text) ? (_oProperty$annotation21 = oProperty.annotations) === null || _oProperty$annotation21 === void 0 ? void 0 : (_oProperty$annotation22 = _oProperty$annotation21.Common) === null || _oProperty$annotation22 === void 0 ? void 0 : _oProperty$annotation22.Text.$target : undefined;
  };

  /**
   * Retrieves the unit property associated to the property, if applicable.
   *
   * @param oProperty The target property
   * @returns The unit property, if it exists
   */
  _exports.getAssociatedTextProperty = getAssociatedTextProperty;
  const getAssociatedUnitProperty = function (oProperty) {
    var _oProperty$annotation23, _oProperty$annotation24, _oProperty$annotation25, _oProperty$annotation26;
    return isPathExpression(oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation23 = oProperty.annotations) === null || _oProperty$annotation23 === void 0 ? void 0 : (_oProperty$annotation24 = _oProperty$annotation23.Measures) === null || _oProperty$annotation24 === void 0 ? void 0 : _oProperty$annotation24.Unit) ? (_oProperty$annotation25 = oProperty.annotations) === null || _oProperty$annotation25 === void 0 ? void 0 : (_oProperty$annotation26 = _oProperty$annotation25.Measures) === null || _oProperty$annotation26 === void 0 ? void 0 : _oProperty$annotation26.Unit.$target : undefined;
  };
  _exports.getAssociatedUnitProperty = getAssociatedUnitProperty;
  const getAssociatedUnitPropertyPath = function (oProperty) {
    var _oProperty$annotation27, _oProperty$annotation28, _oProperty$annotation29, _oProperty$annotation30;
    return isPathExpression(oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation27 = oProperty.annotations) === null || _oProperty$annotation27 === void 0 ? void 0 : (_oProperty$annotation28 = _oProperty$annotation27.Measures) === null || _oProperty$annotation28 === void 0 ? void 0 : _oProperty$annotation28.Unit) ? (_oProperty$annotation29 = oProperty.annotations) === null || _oProperty$annotation29 === void 0 ? void 0 : (_oProperty$annotation30 = _oProperty$annotation29.Measures) === null || _oProperty$annotation30 === void 0 ? void 0 : _oProperty$annotation30.Unit.path : undefined;
  };

  /**
   * Retrieves the associated currency property for that property if it exists.
   *
   * @param oProperty The target property
   * @returns The unit property, if it exists
   */
  _exports.getAssociatedUnitPropertyPath = getAssociatedUnitPropertyPath;
  const getAssociatedCurrencyProperty = function (oProperty) {
    var _oProperty$annotation31, _oProperty$annotation32, _oProperty$annotation33, _oProperty$annotation34;
    return isPathExpression(oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation31 = oProperty.annotations) === null || _oProperty$annotation31 === void 0 ? void 0 : (_oProperty$annotation32 = _oProperty$annotation31.Measures) === null || _oProperty$annotation32 === void 0 ? void 0 : _oProperty$annotation32.ISOCurrency) ? (_oProperty$annotation33 = oProperty.annotations) === null || _oProperty$annotation33 === void 0 ? void 0 : (_oProperty$annotation34 = _oProperty$annotation33.Measures) === null || _oProperty$annotation34 === void 0 ? void 0 : _oProperty$annotation34.ISOCurrency.$target : undefined;
  };
  _exports.getAssociatedCurrencyProperty = getAssociatedCurrencyProperty;
  const getAssociatedCurrencyPropertyPath = function (oProperty) {
    var _oProperty$annotation35, _oProperty$annotation36, _oProperty$annotation37, _oProperty$annotation38;
    return isPathExpression(oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation35 = oProperty.annotations) === null || _oProperty$annotation35 === void 0 ? void 0 : (_oProperty$annotation36 = _oProperty$annotation35.Measures) === null || _oProperty$annotation36 === void 0 ? void 0 : _oProperty$annotation36.ISOCurrency) ? (_oProperty$annotation37 = oProperty.annotations) === null || _oProperty$annotation37 === void 0 ? void 0 : (_oProperty$annotation38 = _oProperty$annotation37.Measures) === null || _oProperty$annotation38 === void 0 ? void 0 : _oProperty$annotation38.ISOCurrency.path : undefined;
  };

  /**
   * Retrieves the Common.Text property path if it exists.
   *
   * @param oProperty The target property
   * @returns The Common.Text property path or undefined if it does not exist
   */
  _exports.getAssociatedCurrencyPropertyPath = getAssociatedCurrencyPropertyPath;
  const getAssociatedTextPropertyPath = function (oProperty) {
    var _oProperty$annotation39, _oProperty$annotation40, _oProperty$annotation41, _oProperty$annotation42;
    return isPathExpression((_oProperty$annotation39 = oProperty.annotations) === null || _oProperty$annotation39 === void 0 ? void 0 : (_oProperty$annotation40 = _oProperty$annotation39.Common) === null || _oProperty$annotation40 === void 0 ? void 0 : _oProperty$annotation40.Text) ? (_oProperty$annotation41 = oProperty.annotations) === null || _oProperty$annotation41 === void 0 ? void 0 : (_oProperty$annotation42 = _oProperty$annotation41.Common) === null || _oProperty$annotation42 === void 0 ? void 0 : _oProperty$annotation42.Text.path : undefined;
  };

  /**
   * Check whether the property has a value help annotation defined or not.
   *
   * @param property The target property to be checked
   * @returns `true` if it has a value help
   */
  _exports.getAssociatedTextPropertyPath = getAssociatedTextPropertyPath;
  const hasValueHelp = function (property) {
    var _property$annotations, _property$annotations2, _property$annotations3, _property$annotations4, _property$annotations5, _property$annotations6, _property$annotations7, _property$annotations8;
    return !!((_property$annotations = property.annotations) !== null && _property$annotations !== void 0 && (_property$annotations2 = _property$annotations.Common) !== null && _property$annotations2 !== void 0 && _property$annotations2.ValueList) || !!((_property$annotations3 = property.annotations) !== null && _property$annotations3 !== void 0 && (_property$annotations4 = _property$annotations3.Common) !== null && _property$annotations4 !== void 0 && _property$annotations4.ValueListReferences) || !!((_property$annotations5 = property.annotations) !== null && _property$annotations5 !== void 0 && (_property$annotations6 = _property$annotations5.Common) !== null && _property$annotations6 !== void 0 && _property$annotations6.ValueListWithFixedValues) || !!((_property$annotations7 = property.annotations) !== null && _property$annotations7 !== void 0 && (_property$annotations8 = _property$annotations7.Common) !== null && _property$annotations8 !== void 0 && _property$annotations8.ValueListMapping);
  };

  /**
   * Check whether the property has a value help with fixed value annotation defined or not.
   *
   * @param oProperty The target property
   * @returns `true` if it has a value help
   */
  _exports.hasValueHelp = hasValueHelp;
  const hasValueHelpWithFixedValues = function (oProperty) {
    var _oProperty$annotation43, _oProperty$annotation44, _oProperty$annotation45;
    return !!(oProperty !== null && oProperty !== void 0 && (_oProperty$annotation43 = oProperty.annotations) !== null && _oProperty$annotation43 !== void 0 && (_oProperty$annotation44 = _oProperty$annotation43.Common) !== null && _oProperty$annotation44 !== void 0 && (_oProperty$annotation45 = _oProperty$annotation44.ValueListWithFixedValues) !== null && _oProperty$annotation45 !== void 0 && _oProperty$annotation45.valueOf());
  };

  /**
   * Check whether the property has a value help for validation annotation defined or not.
   *
   * @param oProperty The target property
   * @returns `true` if it has a value help
   */
  _exports.hasValueHelpWithFixedValues = hasValueHelpWithFixedValues;
  const hasValueListForValidation = function (oProperty) {
    var _oProperty$annotation46, _oProperty$annotation47;
    return ((_oProperty$annotation46 = oProperty.annotations) === null || _oProperty$annotation46 === void 0 ? void 0 : (_oProperty$annotation47 = _oProperty$annotation46.Common) === null || _oProperty$annotation47 === void 0 ? void 0 : _oProperty$annotation47.ValueListForValidation) !== undefined;
  };
  _exports.hasValueListForValidation = hasValueListForValidation;
  const hasTimezone = function (oProperty) {
    var _oProperty$annotation48, _oProperty$annotation49;
    return ((_oProperty$annotation48 = oProperty.annotations) === null || _oProperty$annotation48 === void 0 ? void 0 : (_oProperty$annotation49 = _oProperty$annotation48.Common) === null || _oProperty$annotation49 === void 0 ? void 0 : _oProperty$annotation49.Timezone) !== undefined;
  };
  /**
   * Checks whether the property is a unit property.
   *
   * @param property The property to be checked
   * @returns `true` if it is a unit
   */
  _exports.hasTimezone = hasTimezone;
  const isUnit = function (property) {
    var _property$annotations9, _property$annotations10, _property$annotations11;
    return !!((_property$annotations9 = property.annotations) !== null && _property$annotations9 !== void 0 && (_property$annotations10 = _property$annotations9.Common) !== null && _property$annotations10 !== void 0 && (_property$annotations11 = _property$annotations10.IsUnit) !== null && _property$annotations11 !== void 0 && _property$annotations11.valueOf());
  };

  /**
   * Checks whether the property has a text property.
   *
   * @param property The property to be checked
   * @returns `true` if it is a Text
   */
  _exports.isUnit = isUnit;
  const hasText = function (property) {
    var _property$annotations12, _property$annotations13, _property$annotations14;
    return !!((_property$annotations12 = property.annotations) !== null && _property$annotations12 !== void 0 && (_property$annotations13 = _property$annotations12.Common) !== null && _property$annotations13 !== void 0 && (_property$annotations14 = _property$annotations13.Text) !== null && _property$annotations14 !== void 0 && _property$annotations14.valueOf());
  };

  /**
   * Checks whether the property has an ImageURL.
   *
   * @param property The property to be checked
   * @returns `true` if it is an ImageURL
   */
  _exports.hasText = hasText;
  const isImageURL = function (property) {
    var _property$annotations15, _property$annotations16, _property$annotations17;
    return !!((_property$annotations15 = property.annotations) !== null && _property$annotations15 !== void 0 && (_property$annotations16 = _property$annotations15.UI) !== null && _property$annotations16 !== void 0 && (_property$annotations17 = _property$annotations16.IsImageURL) !== null && _property$annotations17 !== void 0 && _property$annotations17.valueOf());
  };

  /**
   * Checks whether the property is a currency property.
   *
   * @param oProperty The property to be checked
   * @returns `true` if it is a currency
   */
  _exports.isImageURL = isImageURL;
  const isCurrency = function (oProperty) {
    var _oProperty$annotation50, _oProperty$annotation51, _oProperty$annotation52;
    return !!((_oProperty$annotation50 = oProperty.annotations) !== null && _oProperty$annotation50 !== void 0 && (_oProperty$annotation51 = _oProperty$annotation50.Common) !== null && _oProperty$annotation51 !== void 0 && (_oProperty$annotation52 = _oProperty$annotation51.IsCurrency) !== null && _oProperty$annotation52 !== void 0 && _oProperty$annotation52.valueOf());
  };

  /**
   * Checks whether the property has a currency property.
   *
   * @param property The property to be checked
   * @returns `true` if it has a currency
   */
  _exports.isCurrency = isCurrency;
  const hasCurrency = function (property) {
    var _property$annotations18, _property$annotations19;
    return ((_property$annotations18 = property.annotations) === null || _property$annotations18 === void 0 ? void 0 : (_property$annotations19 = _property$annotations18.Measures) === null || _property$annotations19 === void 0 ? void 0 : _property$annotations19.ISOCurrency) !== undefined;
  };

  /**
   * Checks whether the property has a unit property.
   *
   * @param property The property to be checked
   * @returns `true` if it has a unit
   */
  _exports.hasCurrency = hasCurrency;
  const hasUnit = function (property) {
    var _property$annotations20, _property$annotations21;
    return ((_property$annotations20 = property.annotations) === null || _property$annotations20 === void 0 ? void 0 : (_property$annotations21 = _property$annotations20.Measures) === null || _property$annotations21 === void 0 ? void 0 : _property$annotations21.Unit) !== undefined;
  };

  /**
   * Checks whether the property type has Edm.Guid.
   *
   * @param property The property to be checked
   * @returns `true` if it is a Guid
   */
  _exports.hasUnit = hasUnit;
  const isGuid = function (property) {
    return property.type === "Edm.Guid";
  };
  _exports.isGuid = isGuid;
  const hasStaticPercentUnit = function (oProperty) {
    var _oProperty$annotation53, _oProperty$annotation54, _oProperty$annotation55;
    return (oProperty === null || oProperty === void 0 ? void 0 : (_oProperty$annotation53 = oProperty.annotations) === null || _oProperty$annotation53 === void 0 ? void 0 : (_oProperty$annotation54 = _oProperty$annotation53.Measures) === null || _oProperty$annotation54 === void 0 ? void 0 : (_oProperty$annotation55 = _oProperty$annotation54.Unit) === null || _oProperty$annotation55 === void 0 ? void 0 : _oProperty$annotation55.toString()) === "%";
  };
  _exports.hasStaticPercentUnit = hasStaticPercentUnit;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/PropertyHelper", ["sap/fe/core/templating/SemanticObjectHelper"],function(n){"use strict";var o={};function i(n){return n&&n.hasOwnProperty("_type")&&n._type==="Property"}o.isProperty=i;const t=function(n){var o,i,t;return!!((o=n.annotations)!==null&&o!==void 0&&(i=o.Core)!==null&&i!==void 0&&(t=i.Computed)!==null&&t!==void 0&&t.valueOf())};o.isComputed=t;function e(n){return n&&n.hasOwnProperty("_type")&&n._type==="NavigationProperty"}o.isNavigationProperty=e;const u=function(n){var o,i,t;return!!((o=n.annotations)!==null&&o!==void 0&&(i=o.Core)!==null&&i!==void 0&&(t=i.Immutable)!==null&&t!==void 0&&t.valueOf())};o.isImmutable=u;const l=function(n){return!!n.isKey};o.isKey=l;const d=function(n,o){var i,t,e,u;const l=(i=o.contextLocation)===null||i===void 0?void 0:(t=i.targetEntityType)===null||t===void 0?void 0:(e=t.annotations)===null||e===void 0?void 0:(u=e.Common)===null||u===void 0?void 0:u.SemanticKey;return(l===null||l===void 0?void 0:l.some(function(o){var i;return(o===null||o===void 0?void 0:(i=o.$target)===null||i===void 0?void 0:i.fullyQualifiedName)===n.fullyQualifiedName}))??false};o.isSemanticKey=d;const a=function(n){return["Edm.Date","Edm.DateTime","Edm.DateTimeOffset"].indexOf(n.type)!==-1};o.hasDateType=a;const v=function(n){var o,i,t;return((o=n.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:(t=i.Label)===null||t===void 0?void 0:t.toString())||""};o.getLabel=v;const r=function(o){return n.hasSemanticObject(o)};o.hasSemanticObject=r;const s=function(n){return!!n&&n.type!==undefined&&n.type==="Path"};o.isPathExpression=s;const c=function(n){return!!n&&n.type!==undefined&&n.type==="PropertyPath"};o.isPropertyPathExpression=c;const m=function(n){return!!n&&n.type!==undefined&&n.type==="AnnotationPath"};o.isAnnotationPathExpression=m;const f=function(n){var o,i,t,e;return s(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:i.Timezone)?(t=n.annotations)===null||t===void 0?void 0:(e=t.Common)===null||e===void 0?void 0:e.Timezone.$target:undefined};o.getAssociatedTimezoneProperty=f;const p=function(n){var o,i,t,e,u;return s(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:i.Timezone)?n===null||n===void 0?void 0:(t=n.annotations)===null||t===void 0?void 0:(e=t.Common)===null||e===void 0?void 0:(u=e.Timezone)===null||u===void 0?void 0:u.path:undefined};o.getAssociatedTimezonePropertyPath=p;const y=function(n){var o,i,t,e;return s(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:i.Text)?(t=n.annotations)===null||t===void 0?void 0:(e=t.Common)===null||e===void 0?void 0:e.Text.$target:undefined};o.getAssociatedTextProperty=y;const C=function(n){var o,i,t,e;return s(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.Unit)?(t=n.annotations)===null||t===void 0?void 0:(e=t.Measures)===null||e===void 0?void 0:e.Unit.$target:undefined};o.getAssociatedUnitProperty=C;const h=function(n){var o,i,t,e;return s(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.Unit)?(t=n.annotations)===null||t===void 0?void 0:(e=t.Measures)===null||e===void 0?void 0:e.Unit.path:undefined};o.getAssociatedUnitPropertyPath=h;const P=function(n){var o,i,t,e;return s(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.ISOCurrency)?(t=n.annotations)===null||t===void 0?void 0:(e=t.Measures)===null||e===void 0?void 0:e.ISOCurrency.$target:undefined};o.getAssociatedCurrencyProperty=P;const g=function(n){var o,i,t,e;return s(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.ISOCurrency)?(t=n.annotations)===null||t===void 0?void 0:(e=t.Measures)===null||e===void 0?void 0:e.ISOCurrency.path:undefined};o.getAssociatedCurrencyPropertyPath=g;const T=function(n){var o,i,t,e;return s((o=n.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:i.Text)?(t=n.annotations)===null||t===void 0?void 0:(e=t.Common)===null||e===void 0?void 0:e.Text.path:undefined};o.getAssociatedTextPropertyPath=T;const O=function(n){var o,i,t,e,u,l,d,a;return!!((o=n.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&i.ValueList)||!!((t=n.annotations)!==null&&t!==void 0&&(e=t.Common)!==null&&e!==void 0&&e.ValueListReferences)||!!((u=n.annotations)!==null&&u!==void 0&&(l=u.Common)!==null&&l!==void 0&&l.ValueListWithFixedValues)||!!((d=n.annotations)!==null&&d!==void 0&&(a=d.Common)!==null&&a!==void 0&&a.ValueListMapping)};o.hasValueHelp=O;const x=function(n){var o,i,t;return!!(n!==null&&n!==void 0&&(o=n.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&(t=i.ValueListWithFixedValues)!==null&&t!==void 0&&t.valueOf())};o.hasValueHelpWithFixedValues=x;const U=function(n){var o,i;return((o=n.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:i.ValueListForValidation)!==undefined};o.hasValueListForValidation=U;const V=function(n){var o,i;return((o=n.annotations)===null||o===void 0?void 0:(i=o.Common)===null||i===void 0?void 0:i.Timezone)!==undefined};o.hasTimezone=V;const I=function(n){var o,i,t;return!!((o=n.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&(t=i.IsUnit)!==null&&t!==void 0&&t.valueOf())};o.isUnit=I;const S=function(n){var o,i,t;return!!((o=n.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&(t=i.Text)!==null&&t!==void 0&&t.valueOf())};o.hasText=S;const L=function(n){var o,i,t;return!!((o=n.annotations)!==null&&o!==void 0&&(i=o.UI)!==null&&i!==void 0&&(t=i.IsImageURL)!==null&&t!==void 0&&t.valueOf())};o.isImageURL=L;const M=function(n){var o,i,t;return!!((o=n.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&(t=i.IsCurrency)!==null&&t!==void 0&&t.valueOf())};o.isCurrency=M;const A=function(n){var o,i;return((o=n.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.ISOCurrency)!==undefined};o.hasCurrency=A;const z=function(n){var o,i;return((o=n.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.Unit)!==undefined};o.hasUnit=z;const E=function(n){return n.type==="Edm.Guid"};o.isGuid=E;const b=function(n){var o,i,t;return(n===null||n===void 0?void 0:(o=n.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:(t=i.Unit)===null||t===void 0?void 0:t.toString())==="%"};o.hasStaticPercentUnit=b;return o},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/SemanticObjectHelper-dbg", [], function () {
  "use strict";

  var _exports = {};
  /**
   * Get the path of the semantic Object if it is a dynamic SemanticObject.
   *
   * @param semanticObject The value of the Common.SemanticObject annotation.
   * @returns  The path of the semantic Object if it is a dynamic SemanticObject null otherwise.
   */
  const getDynamicPathFromSemanticObject = semanticObject => {
    const dynamicSemObjectRegex = semanticObject === null || semanticObject === void 0 ? void 0 : semanticObject.match(/{(.*?)}/);
    if (dynamicSemObjectRegex !== null && dynamicSemObjectRegex !== void 0 && dynamicSemObjectRegex.length && dynamicSemObjectRegex.length > 1) {
      return dynamicSemObjectRegex[1];
    }
    return null;
  };

  /**
   * Check whether a property or a NavigationProperty has a semantic object defined or not.
   *
   * @param property The target property
   * @returns `true` if it has a semantic object
   */
  _exports.getDynamicPathFromSemanticObject = getDynamicPathFromSemanticObject;
  const hasSemanticObject = function (property) {
    var _property$annotations;
    const _propertyCommonAnnotations = (_property$annotations = property.annotations) === null || _property$annotations === void 0 ? void 0 : _property$annotations.Common;
    if (_propertyCommonAnnotations) {
      for (const key in _propertyCommonAnnotations) {
        var _propertyCommonAnnota;
        if (((_propertyCommonAnnota = _propertyCommonAnnotations[key]) === null || _propertyCommonAnnota === void 0 ? void 0 : _propertyCommonAnnota.term) === "com.sap.vocabularies.Common.v1.SemanticObject") {
          return true;
        }
      }
    }
    return false;
  };
  _exports.hasSemanticObject = hasSemanticObject;
  const getSemanticObjects = function (property) {
    var _property$annotations2;
    const semanticObjects = [];
    const _propertyCommonAnnotations = (_property$annotations2 = property.annotations) === null || _property$annotations2 === void 0 ? void 0 : _property$annotations2.Common;
    if (_propertyCommonAnnotations) {
      for (const key in _propertyCommonAnnotations) {
        var _propertyCommonAnnota2;
        if (((_propertyCommonAnnota2 = _propertyCommonAnnotations[key]) === null || _propertyCommonAnnota2 === void 0 ? void 0 : _propertyCommonAnnota2.term) === "com.sap.vocabularies.Common.v1.SemanticObject") {
          semanticObjects.push(_propertyCommonAnnotations[key]);
        }
      }
    }
    return semanticObjects;
  };
  _exports.getSemanticObjects = getSemanticObjects;
  const getSemanticObjectMappings = function (property) {
    var _property$annotations3;
    const semanticObjectMappings = [];
    const _propertyCommonAnnotations = (_property$annotations3 = property.annotations) === null || _property$annotations3 === void 0 ? void 0 : _property$annotations3.Common;
    if (_propertyCommonAnnotations) {
      for (const key in _propertyCommonAnnotations) {
        var _propertyCommonAnnota3;
        if (((_propertyCommonAnnota3 = _propertyCommonAnnotations[key]) === null || _propertyCommonAnnota3 === void 0 ? void 0 : _propertyCommonAnnota3.term) === "com.sap.vocabularies.Common.v1.SemanticObjectMapping") {
          semanticObjectMappings.push(_propertyCommonAnnotations[key]);
        }
      }
    }
    return semanticObjectMappings;
  };
  _exports.getSemanticObjectMappings = getSemanticObjectMappings;
  const getSemanticObjectUnavailableActions = function (property) {
    var _property$annotations4;
    const semanticObjectUnavailableActions = [];
    const _propertyCommonAnnotations = (_property$annotations4 = property.annotations) === null || _property$annotations4 === void 0 ? void 0 : _property$annotations4.Common;
    if (_propertyCommonAnnotations) {
      for (const key in _propertyCommonAnnotations) {
        var _propertyCommonAnnota4;
        if (((_propertyCommonAnnota4 = _propertyCommonAnnotations[key]) === null || _propertyCommonAnnota4 === void 0 ? void 0 : _propertyCommonAnnota4.term) === "com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions") {
          semanticObjectUnavailableActions.push(_propertyCommonAnnotations[key]);
        }
      }
    }
    return semanticObjectUnavailableActions;
  };
  _exports.getSemanticObjectUnavailableActions = getSemanticObjectUnavailableActions;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/SemanticObjectHelper", [],function(){"use strict";var n={};const o=n=>{const o=n===null||n===void 0?void 0:n.match(/{(.*?)}/);if(o!==null&&o!==void 0&&o.length&&o.length>1){return o[1]}return null};n.getDynamicPathFromSemanticObject=o;const t=function(n){var o;const t=(o=n.annotations)===null||o===void 0?void 0:o.Common;if(t){for(const n in t){var i;if(((i=t[n])===null||i===void 0?void 0:i.term)==="com.sap.vocabularies.Common.v1.SemanticObject"){return true}}}return false};n.hasSemanticObject=t;const i=function(n){var o;const t=[];const i=(o=n.annotations)===null||o===void 0?void 0:o.Common;if(i){for(const n in i){var a;if(((a=i[n])===null||a===void 0?void 0:a.term)==="com.sap.vocabularies.Common.v1.SemanticObject"){t.push(i[n])}}}return t};n.getSemanticObjects=i;const a=function(n){var o;const t=[];const i=(o=n.annotations)===null||o===void 0?void 0:o.Common;if(i){for(const n in i){var a;if(((a=i[n])===null||a===void 0?void 0:a.term)==="com.sap.vocabularies.Common.v1.SemanticObjectMapping"){t.push(i[n])}}}return t};n.getSemanticObjectMappings=a;const c=function(n){var o;const t=[];const i=(o=n.annotations)===null||o===void 0?void 0:o.Common;if(i){for(const n in i){var a;if(((a=i[n])===null||a===void 0?void 0:a.term)==="com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"){t.push(i[n])}}}return t};n.getSemanticObjectUnavailableActions=c;return n},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/UIFormatters-dbg", ["sap/fe/core/converters/helpers/BindingHelper", "sap/fe/core/converters/MetaModelConverter", "sap/fe/core/formatters/ValueFormatter", "sap/fe/core/helpers/BindingToolkit", "sap/fe/core/templating/DataModelPathHelper", "sap/fe/core/templating/DisplayModeFormatter", "sap/fe/core/templating/FieldControlHelper", "sap/fe/core/templating/PropertyHelper"], function (BindingHelper, MetaModelConverter, valueFormatters, BindingToolkit, DataModelPathHelper, DisplayModeFormatter, FieldControlHelper, PropertyHelper) {
  "use strict";

  var _exports = {};
  var isProperty = PropertyHelper.isProperty;
  var isPathExpression = PropertyHelper.isPathExpression;
  var isKey = PropertyHelper.isKey;
  var isImmutable = PropertyHelper.isImmutable;
  var isComputed = PropertyHelper.isComputed;
  var hasValueHelp = PropertyHelper.hasValueHelp;
  var getAssociatedUnitProperty = PropertyHelper.getAssociatedUnitProperty;
  var getAssociatedCurrencyProperty = PropertyHelper.getAssociatedCurrencyProperty;
  var isRequiredExpression = FieldControlHelper.isRequiredExpression;
  var isReadOnlyExpression = FieldControlHelper.isReadOnlyExpression;
  var isNonEditableExpression = FieldControlHelper.isNonEditableExpression;
  var isDisabledExpression = FieldControlHelper.isDisabledExpression;
  var isPathUpdatable = DataModelPathHelper.isPathUpdatable;
  var getTargetObjectPath = DataModelPathHelper.getTargetObjectPath;
  var getRelativePaths = DataModelPathHelper.getRelativePaths;
  var getContextRelativeTargetObjectPath = DataModelPathHelper.getContextRelativeTargetObjectPath;
  var pathInModel = BindingToolkit.pathInModel;
  var or = BindingToolkit.or;
  var notEqual = BindingToolkit.notEqual;
  var not = BindingToolkit.not;
  var isTruthy = BindingToolkit.isTruthy;
  var isConstant = BindingToolkit.isConstant;
  var ifElse = BindingToolkit.ifElse;
  var getExpressionFromAnnotation = BindingToolkit.getExpressionFromAnnotation;
  var formatWithTypeInformation = BindingToolkit.formatWithTypeInformation;
  var formatResult = BindingToolkit.formatResult;
  var equal = BindingToolkit.equal;
  var EDM_TYPE_MAPPING = BindingToolkit.EDM_TYPE_MAPPING;
  var constant = BindingToolkit.constant;
  var compileExpression = BindingToolkit.compileExpression;
  var and = BindingToolkit.and;
  var addTypeInformation = BindingToolkit.addTypeInformation;
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  var convertMetaModelContext = MetaModelConverter.convertMetaModelContext;
  var UI = BindingHelper.UI;
  var singletonPathVisitor = BindingHelper.singletonPathVisitor;
  const getDisplayMode = function (oDataModelObjectPath) {
    return DisplayModeFormatter.getDisplayMode(oDataModelObjectPath.targetObject, oDataModelObjectPath);
  };
  _exports.getDisplayMode = getDisplayMode;
  const getEditableExpressionAsObject = function (oPropertyPath) {
    let oDataFieldConverted = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    let oDataModelObjectPath = arguments.length > 2 ? arguments[2] : undefined;
    let isEditable = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : UI.IsEditable;
    return getEditableExpression(oPropertyPath, oDataFieldConverted, oDataModelObjectPath, true, isEditable);
  };
  _exports.getEditableExpressionAsObject = getEditableExpressionAsObject;
  /**
   * Create the expression to generate an "editable" Boolean value.
   *
   * @param oPropertyPath The input property
   * @param oDataFieldConverted The DataFieldConverted object to read the fieldControl annotation
   * @param oDataModelObjectPath The path to this property object
   * @param bAsObject Whether or not this should be returned as an object or a binding string
   * @param isEditable Whether or not UI.IsEditable be considered.
   * @returns The binding expression used to determine if a property is editable or not
   */
  const getEditableExpression = function (oPropertyPath) {
    let oDataFieldConverted = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    let oDataModelObjectPath = arguments.length > 2 ? arguments[2] : undefined;
    let bAsObject = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    let isEditable = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : UI.IsEditable;
    if (!oPropertyPath || typeof oPropertyPath === "string") {
      return compileExpression(false);
    }
    let dataFieldEditableExpression = constant(true);
    if (oDataFieldConverted !== null) {
      dataFieldEditableExpression = ifElse(isNonEditableExpression(oDataFieldConverted), false, isEditable);
    }
    const oProperty = isPathExpression(oPropertyPath) && oPropertyPath.$target || oPropertyPath;
    const relativePath = getRelativePaths(oDataModelObjectPath);
    // Editability depends on the field control expression
    // If the Field control is statically in ReadOnly or Inapplicable (disabled) -> not editable
    // If the property is a key -> not editable except in creation if not computed
    // If the property is computed -> not editable
    // If the property is not updatable -> not editable
    // If the property is immutable -> not editable except in creation
    // If the Field control is a path resolving to ReadOnly or Inapplicable (disabled) (<= 1) -> not editable
    // Else, to be editable you need
    // immutable and key while in the creation row
    // ui/isEditable
    const isPathUpdatableExpression = isPathUpdatable(oDataModelObjectPath, {
      propertyPath: oPropertyPath,
      pathVisitor: (path, navigationPaths) => singletonPathVisitor(path, oDataModelObjectPath.convertedTypes, navigationPaths)
    });
    const editableExpression = ifElse(or(not(isPathUpdatableExpression), isComputed(oProperty), isKey(oProperty), isImmutable(oProperty), isNonEditableExpression(oProperty, relativePath)), ifElse(or(isComputed(oProperty), isNonEditableExpression(oProperty, relativePath)), false, UI.IsTransientBinding), isEditable);
    if (bAsObject) {
      return and(editableExpression, dataFieldEditableExpression);
    }
    return compileExpression(and(editableExpression, dataFieldEditableExpression));
  };
  _exports.getEditableExpression = getEditableExpression;
  const getCollaborationExpression = function (dataModelObjectPath, formatter) {
    var _dataModelObjectPath$;
    const objectPath = getTargetObjectPath(dataModelObjectPath);
    const activityExpression = pathInModel(`/collaboration/activities${objectPath}`, "internal");
    const keys = dataModelObjectPath === null || dataModelObjectPath === void 0 ? void 0 : (_dataModelObjectPath$ = dataModelObjectPath.targetEntityType) === null || _dataModelObjectPath$ === void 0 ? void 0 : _dataModelObjectPath$.keys;
    const keysExpressions = [];
    keys === null || keys === void 0 ? void 0 : keys.forEach(function (key) {
      const keyExpression = pathInModel(key.name);
      keysExpressions.push(keyExpression);
    });
    return formatResult([activityExpression, ...keysExpressions], formatter);
  };
  _exports.getCollaborationExpression = getCollaborationExpression;
  const getEnabledExpressionAsObject = function (oPropertyPath, oDataFieldConverted, oDataModelObjectPath) {
    return getEnabledExpression(oPropertyPath, oDataFieldConverted, true, oDataModelObjectPath);
  };
  /**
   * Create the expression to generate an "enabled" Boolean value.
   *
   * @param oPropertyPath The input property
   * @param oDataFieldConverted The DataFieldConverted Object to read the fieldControl annotation
   * @param bAsObject Whether or not this should be returned as an object or a binding string
   * @param oDataModelObjectPath
   * @returns The binding expression to determine if a property is enabled or not
   */
  _exports.getEnabledExpressionAsObject = getEnabledExpressionAsObject;
  const getEnabledExpression = function (oPropertyPath, oDataFieldConverted) {
    let bAsObject = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    let oDataModelObjectPath = arguments.length > 3 ? arguments[3] : undefined;
    if (!oPropertyPath || typeof oPropertyPath === "string") {
      return compileExpression(true);
    }
    let relativePath;
    if (oDataModelObjectPath) {
      relativePath = getRelativePaths(oDataModelObjectPath);
    }
    let dataFieldEnabledExpression = constant(true);
    if (oDataFieldConverted !== null) {
      dataFieldEnabledExpression = ifElse(isDisabledExpression(oDataFieldConverted), false, true);
    }
    const oProperty = isPathExpression(oPropertyPath) && oPropertyPath.$target || oPropertyPath;
    // Enablement depends on the field control expression
    // If the Field control is statically in Inapplicable (disabled) -> not enabled
    const enabledExpression = ifElse(isDisabledExpression(oProperty, relativePath), false, true);
    if (bAsObject) {
      return and(enabledExpression, dataFieldEnabledExpression);
    }
    return compileExpression(and(enabledExpression, dataFieldEnabledExpression));
  };

  /**
   * Create the expression to generate an "editMode" enum value.
   *
   * @param propertyPath The input property
   * @param dataModelObjectPath The list of data model objects that are involved to reach that property
   * @param measureReadOnly Whether we should set UoM / currency field mode to read only
   * @param asObject Whether we should return this as an expression or as a string
   * @param dataFieldConverted The dataField object
   * @param isEditable Whether or not UI.IsEditable be considered.
   * @returns The binding expression representing the current property edit mode, compliant with the MDC Field definition of editMode.
   */
  _exports.getEnabledExpression = getEnabledExpression;
  const getEditMode = function (propertyPath, dataModelObjectPath) {
    let measureReadOnly = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    let asObject = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    let dataFieldConverted = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;
    let isEditable = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : UI.IsEditable;
    if (!propertyPath || typeof propertyPath === "string" || (dataFieldConverted === null || dataFieldConverted === void 0 ? void 0 : dataFieldConverted.$Type) === "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath") {
      return "Display";
    }
    const property = isPathExpression(propertyPath) && propertyPath.$target || propertyPath;
    const relativePath = getRelativePaths(dataModelObjectPath);
    // if the property is not enabled => Disabled
    // if the property is enabled && not editable => ReadOnly
    // if the property is enabled && editable => Editable
    // If there is an associated unit, and it has a field control also use consider the following
    // if the unit field control is readonly -> EditableReadOnly
    // otherwise -> Editable
    const editableExpression = getEditableExpressionAsObject(propertyPath, dataFieldConverted, dataModelObjectPath, isEditable);
    const enabledExpression = getEnabledExpressionAsObject(propertyPath, dataFieldConverted, dataModelObjectPath);
    const associatedCurrencyProperty = getAssociatedCurrencyProperty(property);
    const unitProperty = associatedCurrencyProperty || getAssociatedUnitProperty(property);
    let resultExpression = constant("Editable");
    if (unitProperty) {
      const isUnitReadOnly = isReadOnlyExpression(unitProperty, relativePath);
      resultExpression = ifElse(or(isUnitReadOnly, isComputed(unitProperty), and(isImmutable(unitProperty), not(UI.IsTransientBinding)), measureReadOnly), ifElse(!isConstant(isUnitReadOnly) && isUnitReadOnly, "EditableReadOnly", "EditableDisplay"), "Editable");
    }
    const readOnlyExpression = or(isReadOnlyExpression(property, relativePath), isReadOnlyExpression(dataFieldConverted));

    // if the property is from a non-updatable entity => Read only mode, previously calculated edit Mode is ignored
    // if the property is from an updatable entity => previously calculated edit Mode expression
    const editModeExpression = ifElse(enabledExpression, ifElse(editableExpression, resultExpression, ifElse(and(!isConstant(readOnlyExpression) && readOnlyExpression, isEditable), "ReadOnly", "Display")), ifElse(isEditable, "Disabled", "Display"));
    if (asObject) {
      return editModeExpression;
    }
    return compileExpression(editModeExpression);
  };
  _exports.getEditMode = getEditMode;
  const hasValidAnalyticalCurrencyOrUnit = function (oPropertyDataModelObjectPath) {
    var _oPropertyDefinition$, _oPropertyDefinition$2, _oPropertyDefinition$3, _oPropertyDefinition$4;
    const oPropertyDefinition = oPropertyDataModelObjectPath.targetObject;
    const currency = (_oPropertyDefinition$ = oPropertyDefinition.annotations) === null || _oPropertyDefinition$ === void 0 ? void 0 : (_oPropertyDefinition$2 = _oPropertyDefinition$.Measures) === null || _oPropertyDefinition$2 === void 0 ? void 0 : _oPropertyDefinition$2.ISOCurrency;
    const measure = currency ? currency : (_oPropertyDefinition$3 = oPropertyDefinition.annotations) === null || _oPropertyDefinition$3 === void 0 ? void 0 : (_oPropertyDefinition$4 = _oPropertyDefinition$3.Measures) === null || _oPropertyDefinition$4 === void 0 ? void 0 : _oPropertyDefinition$4.Unit;
    if (measure) {
      return compileExpression(or(isTruthy(getExpressionFromAnnotation(measure)), not(UI.IsTotal)));
    } else {
      return compileExpression(constant(true));
    }
  };
  _exports.hasValidAnalyticalCurrencyOrUnit = hasValidAnalyticalCurrencyOrUnit;
  const ifUnitEditable = function (oPropertyPath, sEditableValue, sNonEditableValue) {
    const oProperty = isPathExpression(oPropertyPath) && oPropertyPath.$target || oPropertyPath;
    const unitProperty = getAssociatedCurrencyProperty(oProperty) || getAssociatedUnitProperty(oProperty);
    if (!unitProperty) {
      return compileExpression(sNonEditableValue);
    }
    const isUnitReadOnly = isReadOnlyExpression(unitProperty);
    const editableExpression = and(or(!isConstant(isUnitReadOnly), not(isUnitReadOnly)), not(isComputed(unitProperty)), not(isImmutable(unitProperty)));
    return compileExpression(ifElse(editableExpression, sEditableValue, sNonEditableValue));
  };
  _exports.ifUnitEditable = ifUnitEditable;
  const getFieldDisplay = function (oPropertyPath, sTargetDisplayMode, oComputedEditMode) {
    const oProperty = isPathExpression(oPropertyPath) && oPropertyPath.$target || oPropertyPath;
    return hasValueHelp(oProperty) ? compileExpression(sTargetDisplayMode) : compileExpression(ifElse(equal(oComputedEditMode, "Editable"), "Value", sTargetDisplayMode));
  };
  _exports.getFieldDisplay = getFieldDisplay;
  const getTypeConfig = function (oProperty, dataType) {
    var _propertyTypeConfig$t, _propertyTypeConfig$t2, _propertyTypeConfig$t3, _propertyTypeConfig$t4;
    const oTargetMapping = EDM_TYPE_MAPPING[oProperty === null || oProperty === void 0 ? void 0 : oProperty.type] || (dataType ? EDM_TYPE_MAPPING[dataType] : undefined);
    const propertyTypeConfig = {
      type: oTargetMapping.type,
      constraints: {},
      formatOptions: {}
    };
    if (isProperty(oProperty)) {
      var _oTargetMapping$const, _oTargetMapping$const2, _oTargetMapping$const3, _oTargetMapping$const4, _oTargetMapping$const5, _oProperty$annotation, _oProperty$annotation2, _oProperty$annotation3, _oProperty$annotation4, _oTargetMapping$const6, _oProperty$annotation5, _oProperty$annotation6, _oProperty$annotation7, _oProperty$annotation8, _oTargetMapping$const7, _oProperty$annotation9, _oProperty$annotation10, _oTargetMapping$const8;
      propertyTypeConfig.constraints = {
        scale: (_oTargetMapping$const = oTargetMapping.constraints) !== null && _oTargetMapping$const !== void 0 && _oTargetMapping$const.$Scale ? oProperty.scale : undefined,
        precision: (_oTargetMapping$const2 = oTargetMapping.constraints) !== null && _oTargetMapping$const2 !== void 0 && _oTargetMapping$const2.$Precision ? oProperty.precision : undefined,
        maxLength: (_oTargetMapping$const3 = oTargetMapping.constraints) !== null && _oTargetMapping$const3 !== void 0 && _oTargetMapping$const3.$MaxLength ? oProperty.maxLength : undefined,
        nullable: (_oTargetMapping$const4 = oTargetMapping.constraints) !== null && _oTargetMapping$const4 !== void 0 && _oTargetMapping$const4.$Nullable ? oProperty.nullable : undefined,
        minimum: (_oTargetMapping$const5 = oTargetMapping.constraints) !== null && _oTargetMapping$const5 !== void 0 && _oTargetMapping$const5["@Org.OData.Validation.V1.Minimum/$Decimal"] && !isNaN((_oProperty$annotation = oProperty.annotations) === null || _oProperty$annotation === void 0 ? void 0 : (_oProperty$annotation2 = _oProperty$annotation.Validation) === null || _oProperty$annotation2 === void 0 ? void 0 : _oProperty$annotation2.Minimum) ? `${(_oProperty$annotation3 = oProperty.annotations) === null || _oProperty$annotation3 === void 0 ? void 0 : (_oProperty$annotation4 = _oProperty$annotation3.Validation) === null || _oProperty$annotation4 === void 0 ? void 0 : _oProperty$annotation4.Minimum}` : undefined,
        maximum: (_oTargetMapping$const6 = oTargetMapping.constraints) !== null && _oTargetMapping$const6 !== void 0 && _oTargetMapping$const6["@Org.OData.Validation.V1.Maximum/$Decimal"] && !isNaN((_oProperty$annotation5 = oProperty.annotations) === null || _oProperty$annotation5 === void 0 ? void 0 : (_oProperty$annotation6 = _oProperty$annotation5.Validation) === null || _oProperty$annotation6 === void 0 ? void 0 : _oProperty$annotation6.Maximum) ? `${(_oProperty$annotation7 = oProperty.annotations) === null || _oProperty$annotation7 === void 0 ? void 0 : (_oProperty$annotation8 = _oProperty$annotation7.Validation) === null || _oProperty$annotation8 === void 0 ? void 0 : _oProperty$annotation8.Maximum}` : undefined,
        isDigitSequence: propertyTypeConfig.type === "sap.ui.model.odata.type.String" && (_oTargetMapping$const7 = oTargetMapping.constraints) !== null && _oTargetMapping$const7 !== void 0 && _oTargetMapping$const7["@com.sap.vocabularies.Common.v1.IsDigitSequence"] && (_oProperty$annotation9 = oProperty.annotations) !== null && _oProperty$annotation9 !== void 0 && (_oProperty$annotation10 = _oProperty$annotation9.Common) !== null && _oProperty$annotation10 !== void 0 && _oProperty$annotation10.IsDigitSequence ? true : undefined,
        V4: (_oTargetMapping$const8 = oTargetMapping.constraints) !== null && _oTargetMapping$const8 !== void 0 && _oTargetMapping$const8.$V4 ? true : undefined
      };
    }
    propertyTypeConfig.formatOptions = {
      parseAsString: (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t = propertyTypeConfig.type) === null || _propertyTypeConfig$t === void 0 ? void 0 : _propertyTypeConfig$t.indexOf("sap.ui.model.odata.type.Int")) === 0 || (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t2 = propertyTypeConfig.type) === null || _propertyTypeConfig$t2 === void 0 ? void 0 : _propertyTypeConfig$t2.indexOf("sap.ui.model.odata.type.Double")) === 0 ? false : undefined,
      emptyString: (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t3 = propertyTypeConfig.type) === null || _propertyTypeConfig$t3 === void 0 ? void 0 : _propertyTypeConfig$t3.indexOf("sap.ui.model.odata.type.Int")) === 0 || (propertyTypeConfig === null || propertyTypeConfig === void 0 ? void 0 : (_propertyTypeConfig$t4 = propertyTypeConfig.type) === null || _propertyTypeConfig$t4 === void 0 ? void 0 : _propertyTypeConfig$t4.indexOf("sap.ui.model.odata.type.Double")) === 0 ? "" : undefined,
      parseKeepsEmptyString: propertyTypeConfig.type === "sap.ui.model.odata.type.String" ? true : undefined
    };
    return propertyTypeConfig;
  };
  _exports.getTypeConfig = getTypeConfig;
  const getBindingWithUnitOrCurrency = function (oPropertyDataModelPath, propertyBindingExpression, ignoreUnitConstraint, formatOptions) {
    var _oPropertyDefinition$5, _oPropertyDefinition$6, _unit, _oPropertyDefinition$7, _oPropertyDefinition$8;
    const oPropertyDefinition = oPropertyDataModelPath.targetObject;
    let unit = (_oPropertyDefinition$5 = oPropertyDefinition.annotations) === null || _oPropertyDefinition$5 === void 0 ? void 0 : (_oPropertyDefinition$6 = _oPropertyDefinition$5.Measures) === null || _oPropertyDefinition$6 === void 0 ? void 0 : _oPropertyDefinition$6.Unit;
    const relativeLocation = getRelativePaths(oPropertyDataModelPath);
    propertyBindingExpression = formatWithTypeInformation(oPropertyDefinition, propertyBindingExpression);
    if (((_unit = unit) === null || _unit === void 0 ? void 0 : _unit.toString()) === "%") {
      if ((formatOptions === null || formatOptions === void 0 ? void 0 : formatOptions.showMeasure) === false) {
        return propertyBindingExpression;
      }
      return formatResult([propertyBindingExpression], valueFormatters.formatWithPercentage);
    }
    const complexType = unit ? "sap.ui.model.odata.type.Unit" : "sap.ui.model.odata.type.Currency";
    unit = unit ? unit : (_oPropertyDefinition$7 = oPropertyDefinition.annotations) === null || _oPropertyDefinition$7 === void 0 ? void 0 : (_oPropertyDefinition$8 = _oPropertyDefinition$7.Measures) === null || _oPropertyDefinition$8 === void 0 ? void 0 : _oPropertyDefinition$8.ISOCurrency;
    const unitBindingExpression = unit.$target ? formatWithTypeInformation(unit.$target, getExpressionFromAnnotation(unit, relativeLocation), ignoreUnitConstraint) : getExpressionFromAnnotation(unit, relativeLocation);
    return addTypeInformation([propertyBindingExpression, unitBindingExpression], complexType, undefined, formatOptions);
  };
  _exports.getBindingWithUnitOrCurrency = getBindingWithUnitOrCurrency;
  const getBindingForUnitOrCurrency = function (oPropertyDataModelPath) {
    var _oPropertyDefinition$9, _oPropertyDefinition$10, _unit2, _oPropertyDefinition$11, _oPropertyDefinition$12;
    const oPropertyDefinition = oPropertyDataModelPath.targetObject;
    let unit = (_oPropertyDefinition$9 = oPropertyDefinition.annotations) === null || _oPropertyDefinition$9 === void 0 ? void 0 : (_oPropertyDefinition$10 = _oPropertyDefinition$9.Measures) === null || _oPropertyDefinition$10 === void 0 ? void 0 : _oPropertyDefinition$10.Unit;
    if (((_unit2 = unit) === null || _unit2 === void 0 ? void 0 : _unit2.toString()) === "%") {
      return constant("%");
    }
    const relativeLocation = getRelativePaths(oPropertyDataModelPath);
    const complexType = unit ? "sap.ui.model.odata.type.Unit" : "sap.ui.model.odata.type.Currency";
    unit = unit ? unit : (_oPropertyDefinition$11 = oPropertyDefinition.annotations) === null || _oPropertyDefinition$11 === void 0 ? void 0 : (_oPropertyDefinition$12 = _oPropertyDefinition$11.Measures) === null || _oPropertyDefinition$12 === void 0 ? void 0 : _oPropertyDefinition$12.ISOCurrency;
    const unitBindingExpression = unit.$target ? formatWithTypeInformation(unit.$target, getExpressionFromAnnotation(unit, relativeLocation)) : getExpressionFromAnnotation(unit, relativeLocation);
    let propertyBindingExpression = pathInModel(getContextRelativeTargetObjectPath(oPropertyDataModelPath));
    propertyBindingExpression = formatWithTypeInformation(oPropertyDefinition, propertyBindingExpression, true);
    return addTypeInformation([propertyBindingExpression, unitBindingExpression], complexType, undefined, {
      parseKeepsEmptyString: true,
      emptyString: "",
      showNumber: false
    });
  };
  _exports.getBindingForUnitOrCurrency = getBindingForUnitOrCurrency;
  const getBindingWithTimezone = function (oPropertyDataModelPath, propertyBindingExpression) {
    var _oPropertyDefinition$13, _oPropertyDefinition$14;
    let ignoreUnitConstraint = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    let hideTimezoneForEmptyValues = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    let dateFormatOptions = arguments.length > 4 ? arguments[4] : undefined;
    const oPropertyDefinition = oPropertyDataModelPath.targetObject;
    const timezone = (_oPropertyDefinition$13 = oPropertyDefinition.annotations) === null || _oPropertyDefinition$13 === void 0 ? void 0 : (_oPropertyDefinition$14 = _oPropertyDefinition$13.Common) === null || _oPropertyDefinition$14 === void 0 ? void 0 : _oPropertyDefinition$14.Timezone;
    const relativeLocation = getRelativePaths(oPropertyDataModelPath);
    propertyBindingExpression = formatWithTypeInformation(oPropertyDefinition, propertyBindingExpression);
    const complexType = "sap.fe.core.type.DateTimeWithTimezone";
    const unitBindingExpression = timezone.$target ? formatWithTypeInformation(timezone.$target, getExpressionFromAnnotation(timezone, relativeLocation), ignoreUnitConstraint) : getExpressionFromAnnotation(timezone, relativeLocation);
    let formatOptions = {};
    if (hideTimezoneForEmptyValues) {
      formatOptions = {
        showTimezoneForEmptyValues: false
      };
    }
    if (dateFormatOptions !== null && dateFormatOptions !== void 0 && dateFormatOptions.showTime) {
      formatOptions = {
        ...formatOptions,
        ...{
          showTime: dateFormatOptions.showTime === "false" ? false : true
        }
      };
    }
    if (dateFormatOptions !== null && dateFormatOptions !== void 0 && dateFormatOptions.showDate) {
      formatOptions = {
        ...formatOptions,
        ...{
          showDate: dateFormatOptions.showDate === "false" ? false : true
        }
      };
    }
    if (dateFormatOptions !== null && dateFormatOptions !== void 0 && dateFormatOptions.showTimezone) {
      formatOptions = {
        ...formatOptions,
        ...{
          showTimezone: dateFormatOptions.showTimezone === "false" ? false : true
        }
      };
    }
    return addTypeInformation([propertyBindingExpression, unitBindingExpression], complexType, undefined, formatOptions);
  };
  _exports.getBindingWithTimezone = getBindingWithTimezone;
  const getAlignmentExpression = function (oComputedEditMode) {
    let sAlignDisplay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "Begin";
    let sAlignEdit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : "Begin";
    return compileExpression(ifElse(equal(oComputedEditMode, "Display"), sAlignDisplay, sAlignEdit));
  };

  /**
   * Formatter helper to retrieve the converterContext from the metamodel context.
   *
   * @param oContext The original metamodel context
   * @param oInterface The current templating context
   * @returns The ConverterContext representing that object
   */
  _exports.getAlignmentExpression = getAlignmentExpression;
  const getConverterContext = function (oContext, oInterface) {
    if (oInterface && oInterface.context) {
      return convertMetaModelContext(oInterface.context);
    }
    return null;
  };
  getConverterContext.requiresIContext = true;

  /**
   * Formatter helper to retrieve the data model objects that are involved from the metamodel context.
   *
   * @param oContext The original ODataMetaModel context
   * @param oInterface The current templating context
   * @returns An array of entitysets and navproperties that are involved to get to a specific object in the metamodel
   */
  _exports.getConverterContext = getConverterContext;
  const getDataModelObjectPath = function (oContext, oInterface) {
    if (oInterface && oInterface.context) {
      return getInvolvedDataModelObjects(oInterface.context);
    }
    return null;
  };
  getDataModelObjectPath.requiresIContext = true;

  /**
   * Checks if the referenced property is part of a 1..n navigation.
   *
   * @param oDataModelPath The data model path to check
   * @returns True if the property is part of a 1..n navigation
   */
  _exports.getDataModelObjectPath = getDataModelObjectPath;
  const isMultiValueField = function (oDataModelPath) {
    var _oDataModelPath$navig;
    if ((_oDataModelPath$navig = oDataModelPath.navigationProperties) !== null && _oDataModelPath$navig !== void 0 && _oDataModelPath$navig.length) {
      const hasOneToManyNavigation = (oDataModelPath === null || oDataModelPath === void 0 ? void 0 : oDataModelPath.navigationProperties.findIndex(oNav => {
        if (oNav._type === "NavigationProperty" && oNav.isCollection) {
          var _oDataModelPath$conte, _oDataModelPath$conte2;
          if ((_oDataModelPath$conte = oDataModelPath.contextLocation) !== null && _oDataModelPath$conte !== void 0 && (_oDataModelPath$conte2 = _oDataModelPath$conte.navigationProperties) !== null && _oDataModelPath$conte2 !== void 0 && _oDataModelPath$conte2.length) {
            var _oDataModelPath$conte3;
            //we check the one to many nav is not already part of the context
            return ((_oDataModelPath$conte3 = oDataModelPath.contextLocation) === null || _oDataModelPath$conte3 === void 0 ? void 0 : _oDataModelPath$conte3.navigationProperties.findIndex(oContextNav => oContextNav.name === oNav.name)) === -1;
          }
          return true;
        }
        return false;
      })) > -1;
      if (hasOneToManyNavigation) {
        return true;
      }
    }
    return false;
  };
  _exports.isMultiValueField = isMultiValueField;
  const getRequiredExpressionAsObject = function (oPropertyPath, oDataFieldConverted) {
    let forceEditMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    return getRequiredExpression(oPropertyPath, oDataFieldConverted, forceEditMode, true);
  };
  _exports.getRequiredExpressionAsObject = getRequiredExpressionAsObject;
  const getRequiredExpression = function (oPropertyPath, oDataFieldConverted) {
    let forceEditMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    let bAsObject = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    let oRequiredProperties = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
    let dataModelObjectPath = arguments.length > 5 ? arguments[5] : undefined;
    const aRequiredPropertiesFromInsertRestrictions = oRequiredProperties.requiredPropertiesFromInsertRestrictions;
    const aRequiredPropertiesFromUpdateRestrictions = oRequiredProperties.requiredPropertiesFromUpdateRestrictions;
    if (!oPropertyPath || typeof oPropertyPath === "string") {
      if (bAsObject) {
        return constant(false);
      }
      return compileExpression(constant(false));
    }
    let relativePath;
    if (dataModelObjectPath) {
      relativePath = getRelativePaths(dataModelObjectPath);
    }
    let dataFieldRequiredExpression = constant(true);
    if (oDataFieldConverted !== null) {
      dataFieldRequiredExpression = isRequiredExpression(oDataFieldConverted);
    }
    let requiredPropertyFromInsertRestrictionsExpression = constant(false);
    let requiredPropertyFromUpdateRestrictionsExpression = constant(false);
    const oProperty = isPathExpression(oPropertyPath) && oPropertyPath.$target || oPropertyPath;
    // Enablement depends on the field control expression
    // If the Field control is statically in Inapplicable (disabled) -> not enabled
    const requiredExpression = isRequiredExpression(oProperty, relativePath);
    const editMode = forceEditMode || UI.IsEditable;
    if (aRequiredPropertiesFromInsertRestrictions !== null && aRequiredPropertiesFromInsertRestrictions !== void 0 && aRequiredPropertiesFromInsertRestrictions.includes(oPropertyPath.name)) {
      requiredPropertyFromInsertRestrictionsExpression = and(constant(true), UI.IsCreateMode);
    }
    if (aRequiredPropertiesFromUpdateRestrictions !== null && aRequiredPropertiesFromUpdateRestrictions !== void 0 && aRequiredPropertiesFromUpdateRestrictions.includes(oPropertyPath.name)) {
      requiredPropertyFromUpdateRestrictionsExpression = and(constant(true), notEqual(UI.IsCreateMode, true));
    }
    const returnExpression = or(and(or(requiredExpression, dataFieldRequiredExpression), editMode), requiredPropertyFromInsertRestrictionsExpression, requiredPropertyFromUpdateRestrictionsExpression);
    if (bAsObject) {
      return returnExpression;
    }
    return compileExpression(returnExpression);
  };
  _exports.getRequiredExpression = getRequiredExpression;
  const getRequiredExpressionForConnectedDataField = function (dataFieldObjectPath) {
    var _dataFieldObjectPath$, _dataFieldObjectPath$2;
    const data = dataFieldObjectPath === null || dataFieldObjectPath === void 0 ? void 0 : (_dataFieldObjectPath$ = dataFieldObjectPath.targetObject) === null || _dataFieldObjectPath$ === void 0 ? void 0 : (_dataFieldObjectPath$2 = _dataFieldObjectPath$.$target) === null || _dataFieldObjectPath$2 === void 0 ? void 0 : _dataFieldObjectPath$2.Data;
    const keys = Object.keys(data);
    const dataFields = [];
    let propertyPath;
    const isRequiredExpressions = [];
    for (const key of keys) {
      if (data[key]["$Type"] && data[key]["$Type"].indexOf("DataField") > -1) {
        dataFields.push(data[key]);
      }
    }
    for (const dataField of dataFields) {
      switch (dataField.$Type) {
        case "com.sap.vocabularies.UI.v1.DataField":
        case "com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":
        case "com.sap.vocabularies.UI.v1.DataFieldWithUrl":
        case "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":
        case "com.sap.vocabularies.UI.v1.DataFieldWithAction":
          if (typeof dataField.Value === "object") {
            propertyPath = dataField.Value.$target;
          }
          break;
        case "com.sap.vocabularies.UI.v1.DataFieldForAnnotation":
          if (dataField.Target.$target) {
            if (dataField.Target.$target.$Type === "com.sap.vocabularies.UI.v1.DataField" || dataField.Target.$target.$Type === "com.sap.vocabularies.UI.v1.DataPointType") {
              if (typeof dataField.Target.$target.Value === "object") {
                propertyPath = dataField.Target.$target.Value.$target;
              }
            } else {
              if (typeof dataField.Target === "object") {
                propertyPath = dataField.Target.$target;
              }
              break;
            }
          }
          break;
        // no default
      }

      isRequiredExpressions.push(getRequiredExpressionAsObject(propertyPath, dataField, false));
    }
    return compileExpression(or(...isRequiredExpressions));
  };
  _exports.getRequiredExpressionForConnectedDataField = getRequiredExpressionForConnectedDataField;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/templating/UIFormatters", ["sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/MetaModelConverter","sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper"],function(e,t,n,i,o,a,r,l){"use strict";var s={};var d=l.isProperty;var u=l.isPathExpression;var c=l.isKey;var v=l.isImmutable;var f=l.isComputed;var p=l.hasValueHelp;var g=l.getAssociatedUnitProperty;var m=l.getAssociatedCurrencyProperty;var y=r.isRequiredExpression;var h=r.isReadOnlyExpression;var b=r.isNonEditableExpression;var x=r.isDisabledExpression;var E=o.isPathUpdatable;var D=o.getTargetObjectPath;var I=o.getRelativePaths;var T=o.getContextRelativeTargetObjectPath;var $=i.pathInModel;var O=i.or;var M=i.notEqual;var C=i.not;var P=i.isTruthy;var U=i.isConstant;var F=i.ifElse;var V=i.getExpressionFromAnnotation;var j=i.formatWithTypeInformation;var S=i.formatResult;var q=i.equal;var w=i.EDM_TYPE_MAPPING;var A=i.constant;var N=i.compileExpression;var R=i.and;var B=i.addTypeInformation;var W=t.getInvolvedDataModelObjects;var z=t.convertMetaModelContext;var k=e.UI;var H=e.singletonPathVisitor;const L=function(e){return a.getDisplayMode(e.targetObject,e)};s.getDisplayMode=L;const K=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let n=arguments.length>2?arguments[2]:undefined;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:k.IsEditable;return _(e,t,n,true,i)};s.getEditableExpressionAsObject=K;const _=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let n=arguments.length>2?arguments[2]:undefined;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:k.IsEditable;if(!e||typeof e==="string"){return N(false)}let a=A(true);if(t!==null){a=F(b(t),false,o)}const r=u(e)&&e.$target||e;const l=I(n);const s=E(n,{propertyPath:e,pathVisitor:(e,t)=>H(e,n.convertedTypes,t)});const d=F(O(C(s),f(r),c(r),v(r),b(r,l)),F(O(f(r),b(r,l)),false,k.IsTransientBinding),o);if(i){return R(d,a)}return N(R(d,a))};s.getEditableExpression=_;const G=function(e,t){var n;const i=D(e);const o=$(`/collaboration/activities${i}`,"internal");const a=e===null||e===void 0?void 0:(n=e.targetEntityType)===null||n===void 0?void 0:n.keys;const r=[];a===null||a===void 0?void 0:a.forEach(function(e){const t=$(e.name);r.push(t)});return S([o,...r],t)};s.getCollaborationExpression=G;const Y=function(e,t,n){return J(e,t,true,n)};s.getEnabledExpressionAsObject=Y;const J=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3?arguments[3]:undefined;if(!e||typeof e==="string"){return N(true)}let o;if(i){o=I(i)}let a=A(true);if(t!==null){a=F(x(t),false,true)}const r=u(e)&&e.$target||e;const l=F(x(r,o),false,true);if(n){return R(l,a)}return N(R(l,a))};s.getEnabledExpression=J;const Q=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:k.IsEditable;if(!e||typeof e==="string"||(o===null||o===void 0?void 0:o.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){return"Display"}const r=u(e)&&e.$target||e;const l=I(t);const s=K(e,o,t,a);const d=Y(e,o,t);const c=m(r);const p=c||g(r);let y=A("Editable");if(p){const e=h(p,l);y=F(O(e,f(p),R(v(p),C(k.IsTransientBinding)),n),F(!U(e)&&e,"EditableReadOnly","EditableDisplay"),"Editable")}const b=O(h(r,l),h(o));const x=F(d,F(s,y,F(R(!U(b)&&b,a),"ReadOnly","Display")),F(a,"Disabled","Display"));if(i){return x}return N(x)};s.getEditMode=Q;const X=function(e){var t,n,i,o;const a=e.targetObject;const r=(t=a.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.ISOCurrency;const l=r?r:(i=a.annotations)===null||i===void 0?void 0:(o=i.Measures)===null||o===void 0?void 0:o.Unit;if(l){return N(O(P(V(l)),C(k.IsTotal)))}else{return N(A(true))}};s.hasValidAnalyticalCurrencyOrUnit=X;const Z=function(e,t,n){const i=u(e)&&e.$target||e;const o=m(i)||g(i);if(!o){return N(n)}const a=h(o);const r=R(O(!U(a),C(a)),C(f(o)),C(v(o)));return N(F(r,t,n))};s.ifUnitEditable=Z;const ee=function(e,t,n){const i=u(e)&&e.$target||e;return p(i)?N(t):N(F(q(n,"Editable"),"Value",t))};s.getFieldDisplay=ee;const te=function(e,t){var n,i,o,a;const r=w[e===null||e===void 0?void 0:e.type]||(t?w[t]:undefined);const l={type:r.type,constraints:{},formatOptions:{}};if(d(e)){var s,u,c,v,f,p,g,m,y,h,b,x,E,D,I,T,$,O;l.constraints={scale:(s=r.constraints)!==null&&s!==void 0&&s.$Scale?e.scale:undefined,precision:(u=r.constraints)!==null&&u!==void 0&&u.$Precision?e.precision:undefined,maxLength:(c=r.constraints)!==null&&c!==void 0&&c.$MaxLength?e.maxLength:undefined,nullable:(v=r.constraints)!==null&&v!==void 0&&v.$Nullable?e.nullable:undefined,minimum:(f=r.constraints)!==null&&f!==void 0&&f["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN((p=e.annotations)===null||p===void 0?void 0:(g=p.Validation)===null||g===void 0?void 0:g.Minimum)?`${(m=e.annotations)===null||m===void 0?void 0:(y=m.Validation)===null||y===void 0?void 0:y.Minimum}`:undefined,maximum:(h=r.constraints)!==null&&h!==void 0&&h["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN((b=e.annotations)===null||b===void 0?void 0:(x=b.Validation)===null||x===void 0?void 0:x.Maximum)?`${(E=e.annotations)===null||E===void 0?void 0:(D=E.Validation)===null||D===void 0?void 0:D.Maximum}`:undefined,isDigitSequence:l.type==="sap.ui.model.odata.type.String"&&(I=r.constraints)!==null&&I!==void 0&&I["@com.sap.vocabularies.Common.v1.IsDigitSequence"]&&(T=e.annotations)!==null&&T!==void 0&&($=T.Common)!==null&&$!==void 0&&$.IsDigitSequence?true:undefined,V4:(O=r.constraints)!==null&&O!==void 0&&O.$V4?true:undefined}}l.formatOptions={parseAsString:(l===null||l===void 0?void 0:(n=l.type)===null||n===void 0?void 0:n.indexOf("sap.ui.model.odata.type.Int"))===0||(l===null||l===void 0?void 0:(i=l.type)===null||i===void 0?void 0:i.indexOf("sap.ui.model.odata.type.Double"))===0?false:undefined,emptyString:(l===null||l===void 0?void 0:(o=l.type)===null||o===void 0?void 0:o.indexOf("sap.ui.model.odata.type.Int"))===0||(l===null||l===void 0?void 0:(a=l.type)===null||a===void 0?void 0:a.indexOf("sap.ui.model.odata.type.Double"))===0?"":undefined,parseKeepsEmptyString:l.type==="sap.ui.model.odata.type.String"?true:undefined};return l};s.getTypeConfig=te;const ne=function(e,t,i,o){var a,r,l,s,d;const u=e.targetObject;let c=(a=u.annotations)===null||a===void 0?void 0:(r=a.Measures)===null||r===void 0?void 0:r.Unit;const v=I(e);t=j(u,t);if(((l=c)===null||l===void 0?void 0:l.toString())==="%"){if((o===null||o===void 0?void 0:o.showMeasure)===false){return t}return S([t],n.formatWithPercentage)}const f=c?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";c=c?c:(s=u.annotations)===null||s===void 0?void 0:(d=s.Measures)===null||d===void 0?void 0:d.ISOCurrency;const p=c.$target?j(c.$target,V(c,v),i):V(c,v);return B([t,p],f,undefined,o)};s.getBindingWithUnitOrCurrency=ne;const ie=function(e){var t,n,i,o,a;const r=e.targetObject;let l=(t=r.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.Unit;if(((i=l)===null||i===void 0?void 0:i.toString())==="%"){return A("%")}const s=I(e);const d=l?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";l=l?l:(o=r.annotations)===null||o===void 0?void 0:(a=o.Measures)===null||a===void 0?void 0:a.ISOCurrency;const u=l.$target?j(l.$target,V(l,s)):V(l,s);let c=$(T(e));c=j(r,c,true);return B([c,u],d,undefined,{parseKeepsEmptyString:true,emptyString:"",showNumber:false})};s.getBindingForUnitOrCurrency=ie;const oe=function(e,t){var n,i;let o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let r=arguments.length>4?arguments[4]:undefined;const l=e.targetObject;const s=(n=l.annotations)===null||n===void 0?void 0:(i=n.Common)===null||i===void 0?void 0:i.Timezone;const d=I(e);t=j(l,t);const u="sap.fe.core.type.DateTimeWithTimezone";const c=s.$target?j(s.$target,V(s,d),o):V(s,d);let v={};if(a){v={showTimezoneForEmptyValues:false}}if(r!==null&&r!==void 0&&r.showTime){v={...v,...{showTime:r.showTime==="false"?false:true}}}if(r!==null&&r!==void 0&&r.showDate){v={...v,...{showDate:r.showDate==="false"?false:true}}}if(r!==null&&r!==void 0&&r.showTimezone){v={...v,...{showTimezone:r.showTimezone==="false"?false:true}}}return B([t,c],u,undefined,v)};s.getBindingWithTimezone=oe;const ae=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Begin";let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Begin";return N(F(q(e,"Display"),t,n))};s.getAlignmentExpression=ae;const re=function(e,t){if(t&&t.context){return z(t.context)}return null};re.requiresIContext=true;s.getConverterContext=re;const le=function(e,t){if(t&&t.context){return W(t.context)}return null};le.requiresIContext=true;s.getDataModelObjectPath=le;const se=function(e){var t;if((t=e.navigationProperties)!==null&&t!==void 0&&t.length){const t=(e===null||e===void 0?void 0:e.navigationProperties.findIndex(t=>{if(t._type==="NavigationProperty"&&t.isCollection){var n,i;if((n=e.contextLocation)!==null&&n!==void 0&&(i=n.navigationProperties)!==null&&i!==void 0&&i.length){var o;return((o=e.contextLocation)===null||o===void 0?void 0:o.navigationProperties.findIndex(e=>e.name===t.name))===-1}return true}return false}))>-1;if(t){return true}}return false};s.isMultiValueField=se;const de=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return ue(e,t,n,true)};s.getRequiredExpressionAsObject=de;const ue=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};let a=arguments.length>5?arguments[5]:undefined;const r=o.requiredPropertiesFromInsertRestrictions;const l=o.requiredPropertiesFromUpdateRestrictions;if(!e||typeof e==="string"){if(i){return A(false)}return N(A(false))}let s;if(a){s=I(a)}let d=A(true);if(t!==null){d=y(t)}let c=A(false);let v=A(false);const f=u(e)&&e.$target||e;const p=y(f,s);const g=n||k.IsEditable;if(r!==null&&r!==void 0&&r.includes(e.name)){c=R(A(true),k.IsCreateMode)}if(l!==null&&l!==void 0&&l.includes(e.name)){v=R(A(true),M(k.IsCreateMode,true))}const m=O(R(O(p,d),g),c,v);if(i){return m}return N(m)};s.getRequiredExpression=ue;const ce=function(e){var t,n;const i=e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.Data;const o=Object.keys(i);const a=[];let r;const l=[];for(const e of o){if(i[e]["$Type"]&&i[e]["$Type"].indexOf("DataField")>-1){a.push(i[e])}}for(const e of a){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(typeof e.Value==="object"){r=e.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(e.Target.$target){if(e.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataPointType"){if(typeof e.Target.$target.Value==="object"){r=e.Target.$target.Value.$target}}else{if(typeof e.Target==="object"){r=e.Target.$target}break}}break}l.push(de(r,e,false))}return N(O(...l))};s.getRequiredExpressionForConnectedDataField=ce;return s},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/DateTimeWithTimezone-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/model/odata/type/DateTimeWithTimezone"], function (ClassSupport, _DateTimeWithTimezone) {
  "use strict";

  var _dec, _class;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  let DateTimeWithTimezone = (_dec = defineUI5Class("sap.fe.core.type.DateTimeWithTimezone"), _dec(_class = /*#__PURE__*/function (_DateTimeWithTimezone2) {
    _inheritsLoose(DateTimeWithTimezone, _DateTimeWithTimezone2);
    function DateTimeWithTimezone(oFormatOptions, oConstraints) {
      var _this;
      _this = _DateTimeWithTimezone2.call(this, oFormatOptions, oConstraints) || this;
      _this.bShowTimezoneForEmptyValues = (oFormatOptions === null || oFormatOptions === void 0 ? void 0 : oFormatOptions.showTimezoneForEmptyValues) ?? true;
      return _this;
    }
    var _proto = DateTimeWithTimezone.prototype;
    _proto.formatValue = function formatValue(aValues, sTargetType) {
      const oTimestamp = aValues && aValues[0];
      if (oTimestamp === undefined ||
      // data is not yet available
      // if time zone is not shown falsy timestamps cannot be formatted -> return null
      !oTimestamp && !this.bShowTimezoneForEmptyValues) {
        return null;
      }
      return _DateTimeWithTimezone2.prototype.formatValue.call(this, aValues, sTargetType);
    };
    return DateTimeWithTimezone;
  }(_DateTimeWithTimezone)) || _class);
  return DateTimeWithTimezone;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/DateTimeWithTimezone", ["sap/fe/core/helpers/ClassSupport","sap/ui/model/odata/type/DateTimeWithTimezone"],function(e,t){"use strict";var o,r;var n=e.defineUI5Class;function i(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;u(e,t)}function u(e,t){u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,o){t.__proto__=o;return t};return u(e,t)}let a=(o=n("sap.fe.core.type.DateTimeWithTimezone"),o(r=function(e){i(t,e);function t(t,o){var r;r=e.call(this,t,o)||this;r.bShowTimezoneForEmptyValues=(t===null||t===void 0?void 0:t.showTimezoneForEmptyValues)??true;return r}var o=t.prototype;o.formatValue=function t(o,r){const n=o&&o[0];if(n===undefined||!n&&!this.bShowTimezoneForEmptyValues){return null}return e.prototype.formatValue.call(this,o,r)};return t}(t))||r);return a},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/EDM-dbg", [], function () {
  "use strict";

  var _exports = {};
  const DefaultTypeForEdmType = {
    "Edm.Binary": {
      modelType: undefined
    },
    "Edm.Boolean": {
      modelType: "Bool"
    },
    "Edm.Byte": {
      modelType: "Int"
    },
    "Edm.Date": {
      modelType: "Date"
    },
    "Edm.DateTime": {
      modelType: "Date"
    },
    "Edm.DateTimeOffset": {
      modelType: "DateTimeOffset"
    },
    "Edm.Decimal": {
      modelType: "Decimal"
    },
    "Edm.Duration": {
      modelType: undefined
    },
    "Edm.Double": {
      modelType: "Float"
    },
    "Edm.Float": {
      modelType: "Float"
    },
    "Edm.Guid": {
      modelType: "Guid"
    },
    "Edm.Int16": {
      modelType: "Int"
    },
    "Edm.Int32": {
      modelType: "Int"
    },
    "Edm.Int64": {
      modelType: "Int"
    },
    "Edm.SByte": {
      modelType: "Int"
    },
    "Edm.Single": {
      modelType: "Float"
    },
    "Edm.String": {
      modelType: "String"
    },
    "Edm.Time": {
      modelType: "TimeOfDay"
    },
    "Edm.TimeOfDay": {
      modelType: "TimeOfDay"
    },
    "Edm.Stream": {
      modelType: undefined
    }
  };
  _exports.DefaultTypeForEdmType = DefaultTypeForEdmType;
  function isTypeFilterable(edmType) {
    var _DefaultTypeForEdmTyp;
    return !!((_DefaultTypeForEdmTyp = DefaultTypeForEdmType[edmType]) !== null && _DefaultTypeForEdmTyp !== void 0 && _DefaultTypeForEdmTyp.modelType);
  }
  _exports.isTypeFilterable = isTypeFilterable;
  function getModelType(edmType) {
    var _DefaultTypeForEdmTyp2;
    return (_DefaultTypeForEdmTyp2 = DefaultTypeForEdmType[edmType]) === null || _DefaultTypeForEdmTyp2 === void 0 ? void 0 : _DefaultTypeForEdmTyp2.modelType;
  }
  _exports.getModelType = getModelType;
  return _exports;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/EDM", [],function(){"use strict";var e={};const d={"Edm.Binary":{modelType:undefined},"Edm.Boolean":{modelType:"Bool"},"Edm.Byte":{modelType:"Int"},"Edm.Date":{modelType:"Date"},"Edm.DateTime":{modelType:"Date"},"Edm.DateTimeOffset":{modelType:"DateTimeOffset"},"Edm.Decimal":{modelType:"Decimal"},"Edm.Duration":{modelType:undefined},"Edm.Double":{modelType:"Float"},"Edm.Float":{modelType:"Float"},"Edm.Guid":{modelType:"Guid"},"Edm.Int16":{modelType:"Int"},"Edm.Int32":{modelType:"Int"},"Edm.Int64":{modelType:"Int"},"Edm.SByte":{modelType:"Int"},"Edm.Single":{modelType:"Float"},"Edm.String":{modelType:"String"},"Edm.Time":{modelType:"TimeOfDay"},"Edm.TimeOfDay":{modelType:"TimeOfDay"},"Edm.Stream":{modelType:undefined}};e.DefaultTypeForEdmType=d;function m(e){var m;return!!((m=d[e])!==null&&m!==void 0&&m.modelType)}e.isTypeFilterable=m;function l(e){var m;return(m=d[e])===null||m===void 0?void 0:m.modelType}e.getModelType=l;return e},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/Email-dbg", ["sap/fe/core/helpers/ClassSupport", "sap/ui/core/Core", "sap/ui/model/odata/type/String", "sap/ui/model/ValidateException"], function (ClassSupport, Core, ODataStringType, ValidateException) {
  "use strict";

  var _dec, _class;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  const emailW3CRegexp = /^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:.[a-zA-Z0-9-]+)*$/;
  let EmailType = (_dec = defineUI5Class("sap.fe.core.type.Email"), _dec(_class = /*#__PURE__*/function (_ODataStringType) {
    _inheritsLoose(EmailType, _ODataStringType);
    function EmailType() {
      return _ODataStringType.apply(this, arguments) || this;
    }
    var _proto = EmailType.prototype;
    _proto.validateValue = function validateValue(sValue) {
      if (!emailW3CRegexp.test(sValue)) {
        throw new ValidateException(Core.getLibraryResourceBundle("sap.fe.core").getText("T_EMAILTYPE_INVALID_VALUE"));
      }
      _ODataStringType.prototype.validateValue.call(this, sValue);
    };
    return EmailType;
  }(ODataStringType)) || _class);
  return EmailType;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/Email", ["sap/fe/core/helpers/ClassSupport","sap/ui/core/Core","sap/ui/model/odata/type/String","sap/ui/model/ValidateException"],function(t,e,o,r){"use strict";var a,n;var p=t.defineUI5Class;function i(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;s(t,e)}function s(t,e){s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,o){e.__proto__=o;return e};return s(t,e)}const u=/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:.[a-zA-Z0-9-]+)*$/;let c=(a=p("sap.fe.core.type.Email"),a(n=function(t){i(o,t);function o(){return t.apply(this,arguments)||this}var a=o.prototype;a.validateValue=function o(a){if(!u.test(a)){throw new r(e.getLibraryResourceBundle("sap.fe.core").getText("T_EMAILTYPE_INVALID_VALUE"))}t.prototype.validateValue.call(this,a)};return o}(o))||n);return c},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/FiscalDate-dbg", ["sap/fe/core/formatters/FiscalFormat", "sap/fe/core/helpers/ClassSupport", "sap/ui/core/CalendarType", "sap/ui/core/Core", "sap/ui/model/odata/type/String", "sap/ui/model/ValidateException"], function (FiscalFormat, ClassSupport, CalendarType, Core, ODataStringType, ValidateException) {
  "use strict";

  var _dec, _class, _class2;
  var defineUI5Class = ClassSupport.defineUI5Class;
  function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }
  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }
  /**
   * Define the UI5 class for a type of fiscal date.
   *
   * @class The data type Fiscal Date supports the parsing and formatting of fiscal dates that follow the pattern 'yM'
   * @param formatOptions Format options
   * @param formatOptions.fiscalType String with a fiscal annotation type
   * @param constraints Constraints
   * @version 1.111.1
   * @experimental
   * @extends sap.ui.model.odata.type.String
   * @alias {sap.fe.core.type.FiscalDate} The implementation of the fiscal date
   */
  let FiscalDate = (_dec = defineUI5Class("sap.fe.core.type.FiscalDate"), _dec(_class = (_class2 = /*#__PURE__*/function (_ODataStringType) {
    _inheritsLoose(FiscalDate, _ODataStringType);
    function FiscalDate(formatOptions, constraints) {
      var _this;
      if ((formatOptions.fiscalType === "com.sap.vocabularies.Common.v1.IsFiscalYearPeriod" || formatOptions.fiscalType === "com.sap.vocabularies.Common.v1.IsFiscalYearQuarter" || formatOptions.fiscalType === "com.sap.vocabularies.Common.v1.IsFiscalYearWeek") && constraints !== null && constraints !== void 0 && constraints.maxLength) {
        // We increase maxLength for +1 for any fiscal type that have delimiter in locale format.
        // It's necessary for validation to work correctly.
        // Also for validation to function properly user also should specify constraints.isDigitSequence = true
        // isDigitSequence and maxLength combination ensures that missing characters will be populated with leading zeros
        // that will ensure user will receive correct validation results.
        constraints.maxLength = constraints.maxLength + 1;
      }
      _this = _ODataStringType.call(this, formatOptions, constraints) || this;
      _this.annotationType = formatOptions.fiscalType;
      const format = FiscalDate.dateFormats[_this.annotationType];
      if (format) {
        _this.formatter = FiscalFormat.getDateInstance({
          format,
          calendarType: CalendarType.Gregorian
        });
      }
      return _this;
    }

    /**
     * Return pattern for fiscal date type.
     *
     * @returns The fiscal date pattern
     */
    var _proto = FiscalDate.prototype;
    _proto.getPattern = function getPattern() {
      var _this$formatter;
      return (_this$formatter = this.formatter) === null || _this$formatter === void 0 ? void 0 : _this$formatter.getPattern();
    }

    /**
     * Formats the given value to the given fiscal type.
     *
     * @param value The value to be formatted
     * @returns The formatted output value; <code>undefined</code> is always formatted to <code>null</code>
     * @override
     */;
    _proto.formatValue = function formatValue(value, targetType) {
      return this.formatter ? this.formatter.format(_ODataStringType.prototype.formatValue.call(this, value, targetType)) : _ODataStringType.prototype.formatValue.call(this, value, targetType);
    }

    /**
     * Parses the given value, which is expected to be of the fiscal type, to a string.
     *
     * @param value The value to be parsed
     * @returns The parsed value
     * @override
     */;
    _proto.parseValue = function parseValue(value, sourceType) {
      return this.formatter ? this.formatter.parse(_ODataStringType.prototype.parseValue.call(this, value, sourceType)) : _ODataStringType.prototype.parseValue.call(this, value, sourceType);
    }

    /**
     * @inheritDoc
     */;
    _proto.validateValue = function validateValue(value) {
      try {
        _ODataStringType.prototype.validateValue.call(this, value);
      } catch (error) {
        if (!this.formatter) {
          throw error;
        }
        if (!this.formatter.validate(value)) {
          throw new ValidateException(this.getErrorMessage(this.annotationType));
        }
      }
      if (!this.formatter || value === "" || value === null) {
        return;
      }
      if (!this.formatter.validate(value)) {
        throw new ValidateException(this.getErrorMessage(this.annotationType));
      }
    }

    /**
     * Returns the matching locale-dependent error message for the type based on the fiscal annotation.
     *
     * @param annotationType The fiscal annotation type
     * @returns The locale-dependent error message
     */;
    _proto.getErrorMessage = function getErrorMessage(annotationType) {
      let sValue = "";
      this.fullYear = this.fullYear || new Date().getFullYear().toString();
      switch (annotationType) {
        case "com.sap.vocabularies.Common.v1.IsFiscalYear":
          sValue = this.fullYear;
          break;
        case "com.sap.vocabularies.Common.v1.IsFiscalPeriod":
          sValue = "001";
          break;
        case "com.sap.vocabularies.Common.v1.IsFiscalYearPeriod":
          sValue = this.fullYear + "001";
          break;
        case "com.sap.vocabularies.Common.v1.IsFiscalQuarter":
          sValue = "1";
          break;
        case "com.sap.vocabularies.Common.v1.IsFiscalYearQuarter":
          sValue = this.fullYear + "1";
          break;
        case "com.sap.vocabularies.Common.v1.IsFiscalWeek":
          sValue = "01";
          break;
        case "com.sap.vocabularies.Common.v1.IsFiscalYearWeek":
          sValue = this.fullYear + "01";
          break;
        case "com.sap.vocabularies.Common.v1.IsDayOfFiscalYear":
          sValue = "1";
          break;
        case "com.sap.vocabularies.Common.v1.IsFiscalYearVariant":
          break;
        default:
          sValue = this.fullYear;
      }
      return Core.getLibraryResourceBundle("sap.fe.core").getText("FISCAL_VALIDATION_FAILS", [this.formatValue(sValue, "string")]);
    }

    /**
     * @inheritDoc
     */;
    _proto.getName = function getName() {
      return "sap.fe.core.type.FiscalDate";
    }

    /**
     * Returns the formatter that is assigned to this particular FiscalDate type.
     *
     * @returns The assigned instance of FiscalFormat
     */;
    _proto.getFormatter = function getFormatter() {
      return this.formatter;
    };
    return FiscalDate;
  }(ODataStringType), _class2.dateFormats = {
    ["com.sap.vocabularies.Common.v1.IsFiscalYear"]: "YYYY",
    ["com.sap.vocabularies.Common.v1.IsFiscalPeriod"]: "PPP",
    ["com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"]: "YYYYPPP",
    ["com.sap.vocabularies.Common.v1.IsFiscalQuarter"]: "Q",
    ["com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"]: "YYYYQ",
    ["com.sap.vocabularies.Common.v1.IsFiscalWeek"]: "WW",
    ["com.sap.vocabularies.Common.v1.IsFiscalYearWeek"]: "YYYYWW",
    ["com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"]: "d",
    ["com.sap.vocabularies.Common.v1.IsFiscalYearVariant"]: ""
  }, _class2)) || _class);
  return FiscalDate;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/FiscalDate", ["sap/fe/core/formatters/FiscalFormat","sap/fe/core/helpers/ClassSupport","sap/ui/core/CalendarType","sap/ui/core/Core","sap/ui/model/odata/type/String","sap/ui/model/ValidateException"],function(a,e,r,t,o,s){"use strict";var i,c,l;var n=e.defineUI5Class;function m(a,e){a.prototype=Object.create(e.prototype);a.prototype.constructor=a;u(a,e)}function u(a,e){u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function a(e,r){e.__proto__=r;return e};return u(a,e)}let p=(i=n("sap.fe.core.type.FiscalDate"),i(c=(l=function(e){m(o,e);function o(t,s){var i;if((t.fiscalType==="com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"||t.fiscalType==="com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"||t.fiscalType==="com.sap.vocabularies.Common.v1.IsFiscalYearWeek")&&s!==null&&s!==void 0&&s.maxLength){s.maxLength=s.maxLength+1}i=e.call(this,t,s)||this;i.annotationType=t.fiscalType;const c=o.dateFormats[i.annotationType];if(c){i.formatter=a.getDateInstance({format:c,calendarType:r.Gregorian})}return i}var i=o.prototype;i.getPattern=function a(){var e;return(e=this.formatter)===null||e===void 0?void 0:e.getPattern()};i.formatValue=function a(r,t){return this.formatter?this.formatter.format(e.prototype.formatValue.call(this,r,t)):e.prototype.formatValue.call(this,r,t)};i.parseValue=function a(r,t){return this.formatter?this.formatter.parse(e.prototype.parseValue.call(this,r,t)):e.prototype.parseValue.call(this,r,t)};i.validateValue=function a(r){try{e.prototype.validateValue.call(this,r)}catch(a){if(!this.formatter){throw a}if(!this.formatter.validate(r)){throw new s(this.getErrorMessage(this.annotationType))}}if(!this.formatter||r===""||r===null){return}if(!this.formatter.validate(r)){throw new s(this.getErrorMessage(this.annotationType))}};i.getErrorMessage=function a(e){let r="";this.fullYear=this.fullYear||(new Date).getFullYear().toString();switch(e){case"com.sap.vocabularies.Common.v1.IsFiscalYear":r=this.fullYear;break;case"com.sap.vocabularies.Common.v1.IsFiscalPeriod":r="001";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearPeriod":r=this.fullYear+"001";break;case"com.sap.vocabularies.Common.v1.IsFiscalQuarter":r="1";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearQuarter":r=this.fullYear+"1";break;case"com.sap.vocabularies.Common.v1.IsFiscalWeek":r="01";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearWeek":r=this.fullYear+"01";break;case"com.sap.vocabularies.Common.v1.IsDayOfFiscalYear":r="1";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearVariant":break;default:r=this.fullYear}return t.getLibraryResourceBundle("sap.fe.core").getText("FISCAL_VALIDATION_FAILS",[this.formatValue(r,"string")])};i.getName=function a(){return"sap.fe.core.type.FiscalDate"};i.getFormatter=function a(){return this.formatter};return o}(o),l.dateFormats={["com.sap.vocabularies.Common.v1.IsFiscalYear"]:"YYYY",["com.sap.vocabularies.Common.v1.IsFiscalPeriod"]:"PPP",["com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"]:"YYYYPPP",["com.sap.vocabularies.Common.v1.IsFiscalQuarter"]:"Q",["com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"]:"YYYYQ",["com.sap.vocabularies.Common.v1.IsFiscalWeek"]:"WW",["com.sap.vocabularies.Common.v1.IsFiscalYearWeek"]:"YYYYWW",["com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"]:"d",["com.sap.vocabularies.Common.v1.IsFiscalYearVariant"]:""},l))||c);return p},false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/TypeUtil-dbg", ["sap/base/util/merge", "sap/ui/mdc/enum/BaseType", "sap/ui/mdc/odata/TypeUtil"], function (merge, BaseType, ODataTypeUtil) {
  "use strict";

  const ODataV4TypeUtil = Object.assign({}, ODataTypeUtil);
  ODataV4TypeUtil.getBaseType = function (type, formatOptions, constraints) {
    switch (type) {
      case "sap.ui.model.odata.type.Date":
        return BaseType.Date;
      case "sap.ui.model.odata.type.TimeOfDay":
        return BaseType.Time;
      case "sap.ui.model.odata.type.Unit":
      case "sap.ui.model.odata.type.Currency":
        if (!formatOptions || (!formatOptions.hasOwnProperty("showMeasure") || formatOptions.showMeasure) && (!formatOptions.hasOwnProperty("showNumber") || formatOptions.showNumber)) {
          return BaseType.Unit;
        } else if (!formatOptions.hasOwnProperty("showNumber") || formatOptions.showNumber) {
          return BaseType.Numeric; // only number to show
        } else {
          return BaseType.String; // only unit to show
        }

      default:
        return ODataTypeUtil.getBaseType.call(ODataV4TypeUtil, type, formatOptions, constraints);
    }
  };
  ODataV4TypeUtil.getDataTypeClassName = function (type) {
    // V4 specific types
    const edmTypes = {
      "Edm.Date": "sap.ui.model.odata.type.Date",
      // V4 Date
      "Edm.TimeOfDay": "sap.ui.model.odata.type.TimeOfDay" // V4 constraints: {precision}
    };

    if (edmTypes[type]) {
      type = edmTypes[type];
    } else {
      type = ODataTypeUtil.getDataTypeClassName.call(ODataV4TypeUtil, type);
    }
    return type;
  };
  ODataV4TypeUtil.getDataTypeInstance = function (dataType, formatOptions, constraints) {
    switch (dataType) {
      case "sap.ui.model.odata.type.DateTimeOffset":
      case "Edm.DateTimeOffset":
        constraints = merge({}, constraints || {});
        constraints.V4 = true;
        break;
      default:
    }
    const TypeClass = ODataV4TypeUtil.getDataTypeClass(dataType);
    return new TypeClass(formatOptions, constraints);
  };
  return ODataV4TypeUtil;
}, false);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/fe/core/type/TypeUtil", ["sap/base/util/merge","sap/ui/mdc/enum/BaseType","sap/ui/mdc/odata/TypeUtil"],function(e,a,t){"use strict";const s=Object.assign({},t);s.getBaseType=function(e,r,u){switch(e){case"sap.ui.model.odata.type.Date":return a.Date;case"sap.ui.model.odata.type.TimeOfDay":return a.Time;case"sap.ui.model.odata.type.Unit":case"sap.ui.model.odata.type.Currency":if(!r||(!r.hasOwnProperty("showMeasure")||r.showMeasure)&&(!r.hasOwnProperty("showNumber")||r.showNumber)){return a.Unit}else if(!r.hasOwnProperty("showNumber")||r.showNumber){return a.Numeric}else{return a.String}default:return t.getBaseType.call(s,e,r,u)}};s.getDataTypeClassName=function(e){const a={"Edm.Date":"sap.ui.model.odata.type.Date","Edm.TimeOfDay":"sap.ui.model.odata.type.TimeOfDay"};if(a[e]){e=a[e]}else{e=t.getDataTypeClassName.call(s,e)}return e};s.getDataTypeInstance=function(a,t,r){switch(a){case"sap.ui.model.odata.type.DateTimeOffset":case"Edm.DateTimeOffset":r=e({},r||{});r.V4=true;break;default:}const u=s.getDataTypeClass(a);return new u(t,r)};return s},false);
sap.ui.require.preload({
	"sap/fe/core/controllerextensions/collaboration/ManageDialog.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:mdc="sap.ui.mdc"\n\txmlns:core="sap.ui.core"\n\txmlns:macro="sap.fe.macros"\n\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\ttemplate:require="{\n\t\tMODEL: \'sap/ui/model/odata/v4/AnnotationHelper\',\n\t\tCOMMON: \'sap/fe/core/controllerextensions/collaboration/CollaborationCommon\',\n\t\tHELPER: \'sap/fe/macros/CommonHelper\',\n\t\tUI: \'sap/fe/core/templating/UIFormatters\'\n\t}"\n\tcore:require="{FORMATTER: \'sap/fe/core/formatters/CollaborationFormatter\'}"\n><Dialog\n\t\tid="dialog"\n\t\ttitle="{= COMMON.getInvitationDialogTitleExpBinding(${contextPath>./@com.sap.vocabularies.UI.v1.HeaderInfo@@UI.getDataModelObjectPath}) }"\n\t\tbinding="{internal>collaboration}"\n\t><VBox class="sapUiMediumMargin"><VBox width="40em"><MessageStrip\n\t\t\t\t\ttext="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_MESSAGESTRIP}"\n\t\t\t\t\ttype="Information"\n\t\t\t\t\tshowIcon="true"\n\t\t\t\t\tshowCloseButton="false"\n\t\t\t\t\tclass="sapUiMediumMarginBottom"\n\t\t\t\t/></VBox><Label text="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_INPUT_LABEL}" /><HBox class="sapUiMediumMarginBottom" width="100%" id="newUserBox"><mdc:Field\n\t\t\t\t\tid="UserID"\n\t\t\t\t\tvalue="{internal>UserID}"\n\t\t\t\t\tadditionalValue="{internal>UserDescription}"\n\t\t\t\t\tdisplay="DescriptionValue"\n\t\t\t\t\twidth="37em"\n\t\t\t\t\trequired="true"\n\t\t\t\t\tfieldHelp="userValueHelp"\n\t\t\t\t\tplaceholder="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_INPUT_PLACEHOLDER}"\n\t\t\t\t\tchange=".addUserChanged"\n\t\t\t\t><mdc:dependents><template:with path="contextPath>DraftAdministrativeData/DraftAdministrativeUser/UserID" var="vhProperty"><macro:ValueHelp _flexId="userValueHelp" property="{vhProperty>}" requiresValidation="true" /></template:with></mdc:dependents></mdc:Field><Button\n\t\t\t\t\tclass="sapUiTinyMarginBegin"\n\t\t\t\t\ttext="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_DIALOG_ADD_USER}"\n\t\t\t\t\tpress=".addUser"\n\t\t\t\t/></HBox><Table id="userList" width="40em" items="{internal>invitedUsers}"><headerToolbar><Toolbar width="100%"><content><Title text="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_TABLE_TOOLBAR_TITLE}" level="H3" /><ToolbarSpacer /><SearchField width="15em" /></content></Toolbar></headerToolbar><columns><Column width="3em" /><Column width="20em"><Text text="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_TABLE_USER_COLUMN}" /></Column><Column width="17em"><Text text="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_TABLE_USER_STATUS_COLUMN}" /></Column><Column width="5em" /></columns><items><ColumnListItem vAlign="Middle" highlight="{= ${internal>transient} ? \'Information\' : \'None\' }"><cells><Avatar displaySize="XS" backgroundColor="Accent{internal>color}" initials="{internal>initials}" /><Text text="{internal>name}" /><ObjectStatus\n\t\t\t\t\t\t\t\tstate="{path : \'internal>status\', formatter: \'.formatUserStatusColor\'}"\n\t\t\t\t\t\t\t\ttext="{path : \'internal>status\', formatter: \'.formatUserStatus\'}"\n\t\t\t\t\t\t\t/><HBox><Button\n\t\t\t\t\t\t\t\t\ticon="sap-icon://decline"\n\t\t\t\t\t\t\t\t\ttype="Transparent"\n\t\t\t\t\t\t\t\t\tpress=".removeUser"\n\t\t\t\t\t\t\t\t\tvisible="{= !!${internal>transient} }"\n\t\t\t\t\t\t\t\t/></HBox></cells></ColumnListItem></items></Table></VBox><beginButton><Button text="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_DIALOG_CONFIRMATION}" press=".share" type="Emphasized" /></beginButton><endButton><Button text="{sap.fe.i18n>C_COLLABORATIONDRAFT_INVITATION_DIALOG_CANCEL}" press=".close" /></endButton></Dialog></core:FragmentDefinition>\n',
	"sap/fe/core/controllerextensions/collaboration/UserDetails.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:f="sap.f" xmlns:core="sap.ui.core"><ResponsivePopover id="userDetails" showHeader="false" class="sapUiContentPadding" placement="Bottom"><HBox><f:Avatar initials="{internal>initials}" displaySize="S" /><VBox><Label class="sapUiMediumMarginBegin" text="{internal>name}" /><Label class="sapUiMediumMarginBegin" text="{internal>id}" /></VBox></HBox></ResponsivePopover></core:FragmentDefinition>\n',
	"sap/fe/core/controls/ActionParameterDialog.fragment.xml":'\n<core:FragmentDefinition\n\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n\txmlns:mdc="sap.ui.mdc"\n\txmlns:mdcField="sap.ui.mdc.field"\n\txmlns:form="sap.ui.layout.form"\n\txmlns:unittest="http://schemas.sap.com/sapui5/preprocessorextension/sap.fe.unittesting/1"\n\ttemplate:require="{\n\t\tMODEL: \'sap/ui/model/odata/v4/AnnotationHelper\',\n\t\tCOMMON: \'sap/fe/macros/CommonHelper\',\n\t\tFIELD: \'sap/fe/macros/field/FieldHelper\',\n\t\tID: \'sap/fe/core/helpers/StableIdHelper\',\n\t\tFE_MODEL: \'sap/fe/core/helpers/ModelHelper\',\n\t\tValueHelpTemplating: \'sap/fe/macros/internal/valuehelp/ValueHelpTemplating\',\n\t\tProperty: \'sap/fe/core/templating/PropertyFormatters\'\n\t}"\n><form:SimpleForm binding="{$Parameter}"><template:repeat list="{action>$Parameter}" var="parameter"><template:with path="parameter>" helper="COMMON.gotoActionParameter" var="actionParameter"><template:if test="{= !${action>$IsBound} || ${parameter>$Name} !== ${action>$Parameter/0/$Name} }"><Label\n\t\t\t\t\t\tunittest:id="ActionParameterDialogLabelExpressionTest"\n\t\t\t\t\t\ttext="{= ${actionParameter>@com.sap.vocabularies.Common.v1.Label} ? ${actionParameter>@com.sap.vocabularies.Common.v1.Label} : ${parameter>$Name}}"\n\t\t\t\t\t/><template:if test="{=  !${parameter>$isCollection} }"><template:then><mdc:Field\n\t\t\t\t\t\t\t\tdelegate="{name:\'sap/fe/macros/field/FieldBaseDelegate\', payload:{retrieveTextFromValueList:true}}"\n\t\t\t\t\t\t\t\tunittest:id="ActionParameterDialogFieldExpressionTest"\n\t\t\t\t\t\t\t\tid="{= ID.generate([\'APD_\', ${parameter>$Name}]) }"\n\t\t\t\t\t\t\t\tvalue="{parameter>@@MODEL.format}"\n\t\t\t\t\t\t\t\tdisplay="{actionParameter>@@FIELD.getAPDialogDisplayFormat}"\n\t\t\t\t\t\t\t\teditMode="{actionParameter>@@COMMON.getParameterEditMode}"\n\t\t\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\t\t\tmultipleLines="{= ${actionParameter>@com.sap.vocabularies.UI.v1.MultiLineText} ? (${actionParameter>@com.sap.vocabularies.UI.v1.MultiLineText} !== false)  : undefined}"\n\t\t\t\t\t\t\t\trequired="{= FIELD.isRequired(${actionParameter>@@FIELD.fieldControl}, \'Editable\')}"\n\t\t\t\t\t\t\t\tchange="{= \'.handleChange($event, \\\'\' + ${parameter>$Name} + \'\\\')\' }"\n\t\t\t\t\t\t\t\tfieldHelp="{= FIELD.getActionParameterDialogFieldHelp(${actionParameter>@}, ${actionName>@sapui.name}, ${parameter>$Name}) }"\n\t\t\t\t\t\t\t\tvisible="{= (${actionParameter>$Name} === \'ResultIsActiveEntity\') ? false : ${actionParameter>@com.sap.vocabularies.UI.v1.Hidden@@FIELD.getActionParameterVisibility} }"\n\t\t\t\t\t\t\t><core:Fragment fragmentName="sap.fe.core.controls.ActionParameterDialogValueHelp" type="XML" /></mdc:Field></template:then><template:else><mdc:MultiValueField\n\t\t\t\t\t\t\t\tid="{= ID.generate([\'APD_\', ${parameter>$Name}]) }"\n\t\t\t\t\t\t\t\titems="{actionParameter>@@FE_MODEL.getActionParameterItemsModelPath}"\n\t\t\t\t\t\t\t\tdelegate="{name: \'sap/fe/core/controls/MultiValueParameterDelegate\'}"\n\t\t\t\t\t\t\t\tunittest:id="ActionParameterDialogMultiValueFieldExpressionTest"\n\t\t\t\t\t\t\t\tdisplay="{actionParameter>@@FIELD.getAPDialogDisplayFormat}"\n\t\t\t\t\t\t\t\teditMode="{actionParameter>@@COMMON.getParameterEditMode}"\n\t\t\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\t\t\tmultipleLines="{= ${actionParameter>@com.sap.vocabularies.UI.v1.MultiLineText} ? (${actionParameter>@com.sap.vocabularies.UI.v1.MultiLineText} !== false)  : undefined}"\n\t\t\t\t\t\t\t\trequired="{= FIELD.isRequired(${actionParameter>@@FIELD.fieldControl}, \'Editable\')}"\n\t\t\t\t\t\t\t\tfieldHelp="{= FIELD.getActionParameterDialogFieldHelp(${actionParameter>@}, ${actionName>@sapui.name}, ${parameter>$Name}) }"\n\t\t\t\t\t\t\t\tchange="{= \'.handleChange($event, \\\'\' + ${parameter>$Name} + \'\\\')\' }"\n\t\t\t\t\t\t\t\tvisible="{actionParameter>@com.sap.vocabularies.UI.v1.Hidden@@FIELD.getActionParameterVisibility}"\n\t\t\t\t\t\t\t><mdcField:MultiValueFieldItem\n\t\t\t\t\t\t\t\t\tkey="{path: \'mvfview>Key\', type:\'sap.ui.model.type.String\'}"\n\t\t\t\t\t\t\t\t\tdescription="{mvfview>Desc}"\n\t\t\t\t\t\t\t\t/><core:Fragment fragmentName="sap.fe.core.controls.ActionParameterDialogValueHelp" type="XML" /></mdc:MultiValueField></template:else></template:if></template:if></template:with></template:repeat></form:SimpleForm></core:FragmentDefinition>\n',
	"sap/fe/core/controls/ActionParameterDialogValueHelp.fragment.xml":'<core:FragmentDefinition\n\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n\txmlns:mdc="sap.ui.mdc"\n\txmlns:mdcv="sap.ui.mdc.valuehelp"\n\txmlns:mdcvc="sap.ui.mdc.valuehelp.content"\n\txmlns:unittest="http://schemas.sap.com/sapui5/preprocessorextension/sap.fe.unittesting/1"\n\txmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"\n\ttemplate:require="{\n\t\tCOMMON: \'sap/fe/macros/CommonHelper\',\n\t\tFIELD: \'sap/fe/macros/field/FieldHelper\',\n\t\tID: \'sap/fe/core/helpers/StableIdHelper\',\n\t\tValueHelpTemplating: \'sap/fe/macros/internal/valuehelp/ValueHelpTemplating\',\n\t\tProperty: \'sap/fe/core/templating/PropertyFormatters\'\n\t}"\n><template:if test="{= FIELD.hasValueHelpAnnotation(${actionParameter>@}) }"><mdc:dependents><mdc:ValueHelp\n\t\t\t\tunittest:id="ActionParameterDialogValuehelpExpressionTest"\n\t\t\t\tid="{= ID.generate([${actionName>@sapui.name},${parameter>$Name}]) }"\n\t\t\t\tdelegate="{= FIELD.getValueHelpDelegate(${action>$IsBound}, ${entitySet>@@COMMON.getContextPath}, ${actionName>@sapui.name}, ${parameter>$Name}) }"\n\t\t\t\tvalidateInput="{= ValueHelpTemplating.requiresValidation(${actionParameter>@@Property.getProperty})}"\n\t\t\t><mdc:typeahead><mdcv:Popover><mdcvc:MTable\n\t\t\t\t\t\t\tid="{= ID.generate([${actionName>@sapui.name},${parameter>$Name}]) }::Popover::qualifier::"\n\t\t\t\t\t\t\tcaseSensitive="{= ValueHelpTemplating.useCaseSensitiveFilterRequests(${actionParameter>@@Property.getPropertyObjectPath}, ${actionParameter>/@Org.OData.Capabilities.V1.FilterFunctions})}"\n\t\t\t\t\t\t\tuseAsValueHelp="{= ${actionParameter>@com.sap.vocabularies.Common.v1.ValueListWithFixedValues} || false}"\n\t\t\t\t\t\t/></mdcv:Popover></mdc:typeahead><template:if\n\t\t\t\t\ttest="{= ${actionParameter>@com.sap.vocabularies.Common.v1.ValueListWithFixedValues} ? (${actionParameter>@com.sap.vocabularies.Common.v1.ValueListWithFixedValues} === \'true\') : true}"\n\t\t\t\t><mdc:dialog><mdcv:Dialog /></mdc:dialog></template:if></mdc:ValueHelp></mdc:dependents></template:if></core:FragmentDefinition>\n',
	"sap/fe/core/controls/ActionPartial.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\txmlns:unittest="http://schemas.sap.com/sapui5/preprocessorextension/sap.fe.unittesting/1"\n\ttemplate:require="{\n                   macroLibrary: \'sap/fe/macros/macroLibrary\',\n                MESSAGE: \'sap/base/strings/formatMessage\'\n            }"\n\tcore:require="{MESSAGE: \'sap/base/strings/formatMessage\' }"\n><Dialog\n\t\tstate="Warning"\n\t\tshowHeader="true"\n\t\tcontentWidth="20rem"\n\t\tresizable="true"\n\t\tverticalScrolling="true"\n\t\thorizontalScrolling="true"\n\t\tclass="sapUiContentPadding"\n\t\ttitle="{label>title}"\n\t><template:if test="{= ${entityType>@com.sap.vocabularies.UI.v1.HeaderInfo}}"><template:then><template:with path="entityType>@com.sap.vocabularies.UI.v1.HeaderInfo" var="headerInfo"><VBox><Text\n\t\t\t\t\t\t\ttext="{= MESSAGE( ${totals>/total} === 1 ? ${sap.fe.i18n>C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION} : ${sap.fe.i18n>C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION_PLURAL}, ${totals>/total} ) }"\n\t\t\t\t\t\t/></VBox><List\n\t\t\t\t\t\titems="{path: \'notApplicable>/\', templateShareable: false}"\n\t\t\t\t\t\theaderText="{headerInfo>TypeNamePlural}"\n\t\t\t\t\t\tshowSeparators="None"\n\t\t\t\t\t\tunittest:id="ActionPartialHeaderInfoListHeaderText"\n\t\t\t\t\t><items><CustomListItem><HBox justifyContent="Start"><Text\n\t\t\t\t\t\t\t\t\t\ttext="{= \'{= !${notApplicable>\' + ${headerInfo>Title/Value/$Path} + \'} ? ${sap.fe.i18n>T_MESSAGE_ITEM_SUBTITLE_CREATION_ROW_INDICATOR} : ${notApplicable>\' + ${headerInfo>Title/Value/$Path} + \'}}\' }"\n\t\t\t\t\t\t\t\t\t\tclass="sapUiTinyMarginBegin sapUiTinyMarginTopBottom"\n\t\t\t\t\t\t\t\t\t\tunittest:id="ActionPartialHeaderInfoListItemText"\n\t\t\t\t\t\t\t\t\t/></HBox></CustomListItem></items></List></template:with></template:then><template:elseif test="{= !${entityType>@com.sap.vocabularies.UI.v1.HeaderInfo}}"><HBox justifyContent="SpaceAround"><Text\n\t\t\t\t\t\ttext="{= ${totals>/total} === 1 ? MESSAGE(${sap.fe.i18n>C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION_SEMANTICKEY}) :\n                MESSAGE(${sap.fe.i18n>C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION_SEMANTICKEY_PLURAL}, ${totals>/total})}"\n\t\t\t\t\t\tclass="sapUiTinyMarginBegin sapUiTinyMarginTopBottom"\n\t\t\t\t\t/></HBox><List\n\t\t\t\t\titems="{path: \'notApplicable>/\', templateShareable: false}"\n\t\t\t\t\tshowSeparators="None"\n\t\t\t\t\tunittest:id="ActionPartialSemanticKeyListHeaderText"\n\t\t\t\t><items><CustomListItem><HBox justifyContent="SpaceAround"><template:repeat list="{path:\'entityType>@com.sap.vocabularies.Common.v1.SemanticKey\'}" var="semanticKey"><template:with path="semanticKey>$PropertyPath" var="item"><Text\n\t\t\t\t\t\t\t\t\t\t\ttext="{= \'{notApplicable>\' + ${semanticKey>$PropertyPath} + \'}\'  }"\n\t\t\t\t\t\t\t\t\t\t\tclass="sapUiTinyMarginBegin sapUiTinyMarginTopBottom"\n\t\t\t\t\t\t\t\t\t\t\tunittest:id="ActionPartialSemanticKeyListItemText"\n\t\t\t\t\t\t\t\t\t\t/></template:with></template:repeat></HBox></CustomListItem></items></List></template:elseif></template:if><beginButton><Button text="{sap.fe.i18n>C_ACTION_PARTIAL_FRAGMENT_SAPFE_CONTINUE_ANYWAY}" press="onContinue" type="Emphasized" /></beginButton><endButton><Button text="{sap.fe.i18n>C_COMMON_SAPFE_CLOSE}" press="onClose" /></endButton></Dialog></core:FragmentDefinition>\n',
	"sap/fe/core/controls/DataLossOrDraftDiscard/DataLossDraft.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core"><Dialog title="{sap.fe.i18n>WARNING}" state="Warning" type="Message" contentWidth="22rem"><content><Text\n\t\t\t\ttext="{= !%{HasActiveEntity} ? ${sap.fe.i18n>ST_DRAFT_DATALOSS_POPUP_MESSAGE_CREATE} : ${sap.fe.i18n>ST_DRAFT_DATALOSS_POPUP_MESSAGE_SAVE} }"\n\t\t\t\twrapping="true"\n\t\t\t/><List\n\t\t\t\tmode="SingleSelectLeft"\n\t\t\t\tshowSeparators="None"\n\t\t\t\tincludeItemInSelection="true"\n\t\t\t\tbackgroundDesign="Transparent"\n\t\t\t\tclass="sapUiNoContentPadding"\n\t\t\t><customData><core:CustomData key="listIdentifier" value="draftDataLossOptionsList" /></customData><items><CustomListItem><customData><core:CustomData key="itemKey" value="draftDataLossOptionSave" /></customData><VBox class="sapUiTinyMargin"><Label\n\t\t\t\t\t\t\t\ttext="{= !%{HasActiveEntity} ? ${sap.fe.i18n>ST_DRAFT_DATALOSS_CREATE_ENTITY_RBL} : ${sap.fe.i18n>ST_DRAFT_DATALOSS_SAVE_DRAFT_RBL} }"\n\t\t\t\t\t\t\t\tdesign="Bold"\n\t\t\t\t\t\t\t/><Text\n\t\t\t\t\t\t\t\ttext="{= !%{HasActiveEntity} ? ${sap.fe.i18n>ST_DRAFT_DATALOSS_CREATE_ENTITY_TOL} : ${sap.fe.i18n>ST_DRAFT_DATALOSS_SAVE_DRAFT_TOL} }"\n\t\t\t\t\t\t\t/></VBox></CustomListItem><CustomListItem><customData><core:CustomData key="itemKey" value="draftDataLossOptionKeep" /></customData><VBox class="sapUiTinyMargin"><Label text="{sap.fe.i18n>ST_DRAFT_DATALOSS_KEEP_DRAFT_RBL}" design="Bold" /><Text text="{sap.fe.i18n>ST_DRAFT_DATALOSS_KEEP_DRAFT_TOL}" /></VBox></CustomListItem><CustomListItem><customData><core:CustomData key="itemKey" value="draftDataLossOptionDiscard" /></customData><VBox class="sapUiTinyMargin"><Label text="{sap.fe.i18n>ST_DRAFT_DATALOSS_DISCARD_DRAFT_RBL}" design="Bold" /><Text text="{sap.fe.i18n>ST_DRAFT_DATALOSS_DISCARD_DRAFT_TOL}" /></VBox></CustomListItem></items></List></content><buttons><Button text="{sap.fe.i18n>C_COMMON_DIALOG_OK}" type="Emphasized" press="onDataLossOk" /><Button text="{sap.fe.i18n>C_COMMON_DIALOG_CANCEL}" press="onDataLossCancel" /></buttons></Dialog></core:FragmentDefinition>\n',
	"sap/fe/core/controls/NonComputedVisibleKeyFieldsDialog.fragment.xml":'<core:FragmentDefinition\n\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n\txmlns:mdc="sap.ui.mdc"\n\txmlns:mdcv="sap.ui.mdc.valuehelp"\n\txmlns:mdcvc="sap.ui.mdc.valuehelp.content"\n\txmlns:form="sap.ui.layout.form"\n\txmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"\n\ttemplate:require="{\n\t\tMODEL: \'sap/ui/model/odata/v4/AnnotationHelper\',\n\t\tCOMMON: \'sap/fe/macros/CommonHelper\',\n\t\tID: \'sap/fe/core/helpers/StableIdHelper\',\n\t\tValueHelpTemplating: \'sap/fe/macros/internal/valuehelp/ValueHelpTemplating\',\n\t\tProperty: \'sap/fe/core/templating/PropertyFormatters\',\n\t\tFIELD: \'sap/fe/macros/field/FieldHelper\',\n\t\tUI: \'sap/fe/core/templating/UIFormatters\'\n\t}"\n><template:with path="fields>" var="allFields"><form:SimpleForm><template:repeat list="{allFields>}" var="key"><template:with path="key>" helper="COMMON.getPathToKey" var="immutableKey"><Label text="{= ${immutableKey>@com.sap.vocabularies.Common.v1.Label}}" /><mdc:Field\n\t\t\t\t\t\tdelegate="{name:\'sap/fe/macros/field/FieldBaseDelegate\', payload:{retrieveTextFromValueList:true}}"\n\t\t\t\t\t\tid="{= ID.generate([\'CreateDialog\', ${entitySet>@sapui.name}, ${immutableKey>@sapui.name}]) }"\n\t\t\t\t\t\tvalue="{immutableKey>@@MODEL.format}"\n\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\trequired="{= FIELD.getRequired(${immutableKey>@sapui.name}, ${immutableKey>@@UI.getDataModelObjectPath}, ${requiredProperties>})}"\n\t\t\t\t\t\tdisplay="{immutableKey>@@FIELD.getAPDialogDisplayFormat}"\n\t\t\t\t\t\tchange="{= \'.handleChange($event, \\\'\' + ${immutableKey>@sapui.name} + \'\\\')\' }"\n\t\t\t\t\t\tliveChange=".handleLiveChange"\n\t\t\t\t\t\tfieldHelp="{= ${immutableKey>@@Property.hasValueHelp} ? ID.generate([${immutableKey>@sapui.name},\'VH\']) : undefined }"\n\t\t\t\t\t\tcustomData:fieldName="{immutableKey>@sapui.name}"\n\t\t\t\t\t\teditMode="{= ${immutableKey>@com.sap.vocabularies.Common.v1.FieldControl} &amp;&amp; ${immutableKey>@com.sap.vocabularies.Common.v1.FieldControl/$EnumMember} &amp;&amp; ${immutableKey>@com.sap.vocabularies.Common.v1.FieldControl/$EnumMember} === \'com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly\' ? \'Display\' : \'Editable\'}"\n\t\t\t\t\t><template:if test="{immutableKey>@@Property.hasValueHelp}"><template:then><mdc:dependents><mdc:ValueHelp\n\t\t\t\t\t\t\t\t\t\tid="{= ID.generate([${immutableKey>@sapui.name},\'VH\']) }"\n\t\t\t\t\t\t\t\t\t\tdelegate="{= FIELD.getValueHelpDelegateForNonComputedVisibleKeyField(${immutableKey>@@Property.getPropertyPath}) }"\n\t\t\t\t\t\t\t\t\t\tvalidateInput="{= ValueHelpTemplating.requiresValidation(${immutableKey>@@Property.getProperty})}"\n\t\t\t\t\t\t\t\t\t><mdc:typeahead><mdcv:Popover><mdcvc:MTable\n\t\t\t\t\t\t\t\t\t\t\t\t\tid="{= ID.generate([${immutableKey>@sapui.name},\'VH\']) }::Popover::qualifier::"\n\t\t\t\t\t\t\t\t\t\t\t\t\tcaseSensitive="{= ValueHelpTemplating.useCaseSensitiveFilterRequests(${immutableKey>@@Property.getPropertyObjectPath}, ${immutableKey>/@Org.OData.Capabilities.V1.FilterFunctions})}"\n\t\t\t\t\t\t\t\t\t\t\t\t\tuseAsValueHelp="{= ${immutableKey>@com.sap.vocabularies.Common.v1.ValueListWithFixedValues} || false}"\n\t\t\t\t\t\t\t\t\t\t\t\t/></mdcv:Popover></mdc:typeahead><template:if\n\t\t\t\t\t\t\t\t\t\t\ttest="{= ${immutableKey>@com.sap.vocabularies.Common.v1.ValueListWithFixedValues} ? (${immutableKey>@com.sap.vocabularies.Common.v1.ValueListWithFixedValues} === \'true\') : true}"\n\t\t\t\t\t\t\t\t\t\t><mdc:dialog><mdcv:Dialog /></mdc:dialog></template:if></mdc:ValueHelp></mdc:dependents></template:then></template:if></mdc:Field></template:with></template:repeat></form:SimpleForm></template:with></core:FragmentDefinition>\n',
	"sap/fe/core/controls/massEdit/MassEditDialog.fragment.xml":'<core:FragmentDefinition\n\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\txmlns:core="sap.ui.core"\n\txmlns="sap.m"\n\txmlns:mdc="sap.ui.mdc"\n\txmlns:mdcField="sap.ui.mdc.field"\n\txmlns:control="sap.fe.core.controls"\n\txmlns:f="sap.ui.layout.form"\n\txmlns:l="sap.ui.layout"\n\ttemplate:require="{\n\t\tMED: \'sap/fe/core/helpers/MassEditHelper\'\n\t}"\n><f:Form visible="{= MED.helpers.hasEditableFieldsBinding(${dataFieldModel>}, true) }"><f:layout><f:ResponsiveGridLayout\n\t\t\t\tlabelSpanXL="4"\n\t\t\t\tlabelSpanL="4"\n\t\t\t\tlabelSpanM="12"\n\t\t\t\tlabelSpanS="12"\n\t\t\t\tadjustLabelSpan="false"\n\t\t\t\temptySpanXL="0"\n\t\t\t\temptySpanL="0"\n\t\t\t\temptySpanM="0"\n\t\t\t\temptySpanS="0"\n\t\t\t\tcolumnsXL="2"\n\t\t\t\tcolumnsL="2"\n\t\t\t\tcolumnsM="1"\n\t\t\t\tsingleContainerFullSize="false"\n\t\t\t/></f:layout><f:formContainers><f:FormContainer><f:formElements><template:repeat list="{dataFieldModel>}" var="dataField"><f:FormElement\n\t\t\t\t\t\t\tlabel="{dataField>label}"\n\t\t\t\t\t\t\tvisible="{= \'{fieldsInfo>/values/\' + ${dataField>dataProperty} + \'/visible}\' }"\n\t\t\t\t\t\t><f:fields><template:with path="dataField>propertyInfo" var="property"><core:Fragment fragmentName="sap.fe.core.controls.massEdit.MassEditField" type="XML" /></template:with><template:if test="{dataField>unitInfo}"><template:with path="dataField>unitInfo" var="property"><core:Fragment fragmentName="sap.fe.core.controls.massEdit.MassEditField" type="XML" /></template:with></template:if></f:fields></f:FormElement></template:repeat></f:formElements></f:FormContainer></f:formContainers></f:Form><Text\n\t\tvisible="{= MED.helpers.hasEditableFieldsBinding(${dataFieldModel>}, false) }"\n\t\ttext="{fieldsInfo>/noFields}"\n\t\tclass="sapUiSmallMargin"\n\t/>\n\t/></core:FragmentDefinition>\n',
	"sap/fe/core/controls/massEdit/MassEditField.fragment.xml":'<core:FragmentDefinition\n\txmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1"\n\txmlns:core="sap.ui.core"\n\txmlns="sap.m"\n\txmlns:mdc="sap.ui.mdc"\n\txmlns:mdcField="sap.ui.mdc.field"\n\txmlns:control="sap.fe.core.controls"\n\txmlns:macro="sap.fe.macros"\n\txmlns:f="sap.ui.layout.form"\n\txmlns:l="sap.ui.layout"\n\txmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"\n\ttemplate:require="{\n\t\tProperty: \'sap/fe/core/templating/PropertyFormatters\',\n\t\tID: \'sap/fe/core/helpers/StableIdHelper\',\n\t\tValueHelpTemplating: \'sap/fe/macros/internal/valuehelp/ValueHelpTemplating\'\n\t}"\n><template:if test="{property>hasVH}"><template:then><template:with path="property>propertyPathForValueHelp" var="vhProperty"><mdc:Field\n\t\t\t\t\tdelegate="{name: \'sap/ui/mdc/odata/v4/FieldBaseDelegate\'}"\n\t\t\t\t\tid="{= ID.generate([\'MED_\', ${dataField>entitySet}, ${property>relativePath}, \'_MDCField\']) }"\n\t\t\t\t\tcore:require="{MassEditHandlers: \'sap/fe/core/controls/massEdit/MassEditHandlers\'}"\n\t\t\t\t\tchange="{= \'MassEditHandlers.handleMDCFieldChange($event, \\\'\' + ${property>relativePath} + \'\\\')\' }"\n\t\t\t\t\tlabel="{dataField>label}"\n\t\t\t\t\twidth="100%"\n\t\t\t\t\trequired="{dataField>isFieldRequired}"\n\t\t\t\t\tfieldHelp="{= ID.generate([\'MED_\', ${dataField>entitySet}, \'VHD\', ${vhProperty>@@Property.getRelativePropertyPath} ]) }"\n\t\t\t\t\tdisplay="{dataField>display}"\n\t\t\t\t\tvalue="{= ${property>relativePath} ? \'{path: \\\'\' + ${property>relativePath} + \'\\\', parameters: {$$noPatch: true} }\' : undefined }"\n\t\t\t\t\tadditionalValue="{= ${dataField>descriptionPath} ? \'{path: \\\'\' + ${dataField>descriptionPath} + \'\\\', parameters: {$$noPatch: true} }\' : undefined }"\n\t\t\t\t><mdc:layoutData><l:GridData\n\t\t\t\t\t\t\tspan="{= (!${dataField>unitProperty}) ? \'XL12 L12 M12 S12\' : ((${property>relativePath} === ${dataField>unitProperty}) ? \'XL4 L4 M4 S4\' : \'XL8 L8 M8 S8\') }"\n\t\t\t\t\t\t/></mdc:layoutData><control:MassEditSelect\n\t\t\t\t\t\tcore:require="{MassEditHandlers: \'sap/fe/core/controls/massEdit/MassEditHandlers\'}"\n\t\t\t\t\t\tid="{= ID.generate([\'MED_\', ${dataField>entitySet}, ${property>relativePath}]) }"\n\t\t\t\t\t\titems="{= \'{path : \\\'\' + ${property>runtimePath} + ${property>relativePath} + \'\\\'}\' }"\n\t\t\t\t\t\tchange="MassEditHandlers.handleSelectionChange($event)"\n\t\t\t\t\t\tselectedKey="{= \'{\' + ${property>runtimePath} + ${property>relativePath} + \'/selectedKey}\' }"\n\t\t\t\t\t\tselectValue="{= (${dataField>inputType} !== \'CheckBox\') &amp;&amp; (\'{ parts : [{ path:\\\'\' +  ${property>relativePath} + \'\\\'}, {value: \\\'\' + ${property>relativePath} + \'\\\' }, {value: \\\'\' + ID.generate([\'MED_\', ${dataField>entitySet}, ${property>relativePath}, \'_MDCField\']) + \'\\\' }], formatter: \\\'MassEditHandlers.contextPropertyChange\\\' }\') }"\n\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\tcustomData:fieldPath="{property>relativePath}"\n\t\t\t\t\t><control:items><core:Item key="{fieldsInfo>key}" text="{fieldsInfo>text}" /></control:items><control:layoutData><l:GridData span="XL12 L12 M12 S12" /></control:layoutData></control:MassEditSelect><template:if test="{= ${dataField>inputType} !== \'CheckBox\' }"><mdc:dependents><macro:ValueHelp\n\t\t\t\t\t\t\t\tcontextPath="{contextPath>}"\n\t\t\t\t\t\t\t\tidPrefix="{= ID.generate([\'MED_\', ${dataField>entitySet}, \'VHD\' ]) }"\n\t\t\t\t\t\t\t\tproperty="{vhProperty>}"\n\t\t\t\t\t\t\t\tuseMultiValueField="true"\n\t\t\t\t\t\t\t/></mdc:dependents></template:if></mdc:Field></template:with></template:then><template:else><ComboBox\n\t\t\t\tid="{= ID.generate([\'MED_\', ${dataField>entitySet}, ${property>relativePath}]) }"\n\t\t\t\tcore:require="{MassEditHandlers: \'sap/fe/core/controls/massEdit/MassEditHandlers\'}"\n\t\t\t\titems="{= \'{path : \\\'\' + ${property>runtimePath} + ${property>relativePath} + \'\\\'}\' }"\n\t\t\t\tchange="MassEditHandlers.handleSelectionChange($event)"\n\t\t\t\tselectedKey="{= \'{\' + ${property>runtimePath} + ${property>relativePath} + \'/selectedKey}\' }"\n\t\t\t\tvisible="{= \'{\' + ${property>runtimePath} + ${property>relativePath} + \'/visible}\' }"\n\t\t\t\tcustomData:fieldPath="{property>relativePath}"\n\t\t\t><items><core:Item key="{fieldsInfo>key}" text="{fieldsInfo>text}" /></items><layoutData><l:GridData\n\t\t\t\t\t\tspan="{= (!${dataField>unitProperty}) ? \'XL12 L12 M12 S12\' : ((${property>relativePath} === ${dataField>unitProperty}) ? \'XL4 L4 M4 S4\' : \'XL8 L8 M8 S8\') }"\n\t\t\t\t\t/></layoutData></ComboBox></template:else></template:if></core:FragmentDefinition>\n',
	"sap/fe/core/fpm/manifest.json":'{"_version":"1.14.0","sap.app":{"id":"sap.fe.core.fpm","type":"component","applicationVersion":{"version":"1.111.1"},"title":"Object Page","tags":{"keywords":["Object Page"]},"ach":"CA-UI5-FE","offline":false,"resources":"resources.json"},"sap.ui":{"technology":"UI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true},"supportedThemes":["sap_fiori_3","sap_hcb","sap_bluecrystal","sap_belize","sap_belize_plus","sap_belize_hcw"]},"sap.ui5":{"config":{"sapFiori2Adaptation":{"style":true,"hierarchy":true}},"services":{"templatedViewService":{"factoryName":"sap.fe.core.services.TemplatedViewService","startup":"waitFor","settings":{"converterType":"None"}},"asyncComponentService":{"factoryName":"sap.fe.core.services.AsyncComponentService","startup":"waitFor"}},"handleValidation":true,"dependencies":{"minUI5Version":"${sap.ui5.core.version}","libs":{"sap.f":{},"sap.fe.macros":{},"sap.m":{},"sap.ui.core":{},"sap.ui.layout":{},"sap.ui.mdc":{},"sap.ui.fl":{}}},"contentDensities":{"compact":true,"cozy":true}}}',
	"sap/fe/core/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.fe.core","type":"library","embeds":["fpm"],"applicationVersion":{"version":"1.111.1"},"title":"UI5 library: sap.fe.core","description":"UI5 library: sap.fe.core","ach":"CA-UI5-FE","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":[]},"sap.ui5":{"dependencies":{"libs":{"sap.ui.core":{},"sap.f":{},"sap.fe.navigation":{},"sap.fe.placeholder":{},"sap.m":{},"sap.ui.layout":{"lazy":true},"sap.ui.mdc":{},"sap.ui.fl":{}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":[],"interfaces":[]}}}}',
	"sap/fe/core/rootView/Fcl.view.xml":'<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.f" displayBlock="true" height="100%" controllerName="sap.fe.core.rootView.Fcl"><FlexibleColumnLayout id="appContent" backgroundDesign="Transparent" restoreFocusOnBackNavigation="true" autoFocus="false" /></mvc:View>\n',
	"sap/fe/core/rootView/NavContainer.view.xml":'<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" displayBlock="true" height="100%" controllerName="sap.fe.core.rootView.NavContainer"><NavContainer id="appContent" autoFocus="false" /></mvc:View>\n',
	"sap/fe/core/services/view/TemplatingErrorPage.view.xml":'<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" controllerName="sap.fe.core.services.view.TemplatingErrorPage"><MessagePage\n\t\tshowHeader="false"\n\t\ticon="sap-icon://message-error"\n\t\ttext="{sap.fe.i18n>T_TEMPLATING_ERROR_PAGE_SAPFE_APPSTART_TEMPLATING_FAILED}"\n\t\tdescription="{= ${error>/message} ? ${error>/message} : \'\'}"\n\t/></mvc:View>\n'
});
//# sourceMappingURL=library-preload.js.map
