/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/library","sap/m/MessageBox","sap/ui/core/Core","../../operationsHelper"],function(e,t,n,o,i,s){"use strict";const c=n.ProgrammingModel;async function r(e,n){const o=e.getModel(),i=o.getMetaModel(),c=i.getMetaPath(e.getPath()),r=i.getObject(`${c}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`);if(!r){throw new Error(`Edit Action for Sticky Session not found for ${c}`)}const a=await n.getModel("sap.fe.i18n").getResourceBundle();const d=t.getTranslatedText("C_COMMON_OBJECT_PAGE_EDIT",a);const u=o.bindContext(`${r}(...)`,e,{$$inheritExpandSelect:true});const f="direct";const g=u.execute(f,undefined,s.fnOnStrictHandlingFailed.bind(l,f,{label:d,model:o},a,null,null,null,undefined,undefined));o.submitBatch(f);const S=await g;const p=n.getSideEffectsService().getODataActionSideEffects(r,S);if(p!==null&&p!==void 0&&p.triggerActions&&p.triggerActions.length){await n.getSideEffectsService().requestSideEffectsForODataAction(p,S)}return S}async function a(n,o){const i=n.getModel(),c=i.getMetaModel(),r=c.getMetaPath(n.getPath()),a=c.getObject(`${r}@com.sap.vocabularies.Session.v1.StickySessionSupported/SaveAction`);if(!a){throw new Error(`Save Action for Sticky Session not found for ${r}`)}const d=await o.getModel("sap.fe.i18n").getResourceBundle();const u=t.getTranslatedText("C_OP_OBJECT_PAGE_SAVE",d);const f=i.bindContext(`${a}(...)`,n,{$$inheritExpandSelect:true});const g="direct";const S=f.execute(g,undefined,s.fnOnStrictHandlingFailed.bind(l,g,{label:u,model:i},d,null,null,null,undefined,undefined));i.submitBatch(g);try{return await S}catch(t){const i=c.getObject(`${r}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`);if(i){try{await o.getSideEffectsService().requestSideEffects([{$PropertyPath:i}],n)}catch(t){e.error("Error while requesting side effects",t)}}throw t}}function d(e){const t=e.getModel(),n=t.getMetaModel(),o=n.getMetaPath(e.getPath()),i=n.getObject(`${o}@com.sap.vocabularies.Session.v1.StickySessionSupported/DiscardAction`);if(!i){throw new Error(`Discard Action for Sticky Session not found for ${o}`)}const s=t.bindContext(`/${i}(...)`);const c=s.execute("direct").then(function(){return e});t.submitBatch("direct");return c}function u(t,n,s){const r=n.getModel("ui").getProperty("/isEditable"),a=i.getLibraryResourceBundle("sap.fe.templates"),d=a&&a.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),u=a&&a.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),l=a&&a.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");if(s===c.Sticky&&r){return o.warning(d,{actions:[u,l],emphasizedAction:u,onClose:function(o){if(o===u){const o=n&&n.getModel("internal");e.info("Navigation confirmed.");if(o){o.setProperty("/sessionOn",false);o.setProperty("/stickySessionToken",undefined)}else{e.warning("Local UIModel couldn't be found.")}t()}else{e.info("Navigation rejected.")}}})}return t()}const l={editDocumentInStickySession:r,activateDocument:a,discardDocument:d,processDataLossConfirmation:u};return l},false);
//# sourceMappingURL=sticky.js.map