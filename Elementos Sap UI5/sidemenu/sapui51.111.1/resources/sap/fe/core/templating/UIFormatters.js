/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/MetaModelConverter","sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper"],function(e,t,n,i,o,a,r,l){"use strict";var s={};var d=l.isProperty;var u=l.isPathExpression;var c=l.isKey;var v=l.isImmutable;var f=l.isComputed;var p=l.hasValueHelp;var g=l.getAssociatedUnitProperty;var m=l.getAssociatedCurrencyProperty;var y=r.isRequiredExpression;var h=r.isReadOnlyExpression;var b=r.isNonEditableExpression;var x=r.isDisabledExpression;var E=o.isPathUpdatable;var D=o.getTargetObjectPath;var I=o.getRelativePaths;var T=o.getContextRelativeTargetObjectPath;var $=i.pathInModel;var O=i.or;var M=i.notEqual;var C=i.not;var P=i.isTruthy;var U=i.isConstant;var F=i.ifElse;var V=i.getExpressionFromAnnotation;var j=i.formatWithTypeInformation;var S=i.formatResult;var q=i.equal;var w=i.EDM_TYPE_MAPPING;var A=i.constant;var N=i.compileExpression;var R=i.and;var B=i.addTypeInformation;var W=t.getInvolvedDataModelObjects;var z=t.convertMetaModelContext;var k=e.UI;var H=e.singletonPathVisitor;const L=function(e){return a.getDisplayMode(e.targetObject,e)};s.getDisplayMode=L;const K=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let n=arguments.length>2?arguments[2]:undefined;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:k.IsEditable;return _(e,t,n,true,i)};s.getEditableExpressionAsObject=K;const _=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let n=arguments.length>2?arguments[2]:undefined;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:k.IsEditable;if(!e||typeof e==="string"){return N(false)}let a=A(true);if(t!==null){a=F(b(t),false,o)}const r=u(e)&&e.$target||e;const l=I(n);const s=E(n,{propertyPath:e,pathVisitor:(e,t)=>H(e,n.convertedTypes,t)});const d=F(O(C(s),f(r),c(r),v(r),b(r,l)),F(O(f(r),b(r,l)),false,k.IsTransientBinding),o);if(i){return R(d,a)}return N(R(d,a))};s.getEditableExpression=_;const G=function(e,t){var n;const i=D(e);const o=$(`/collaboration/activities${i}`,"internal");const a=e===null||e===void 0?void 0:(n=e.targetEntityType)===null||n===void 0?void 0:n.keys;const r=[];a===null||a===void 0?void 0:a.forEach(function(e){const t=$(e.name);r.push(t)});return S([o,...r],t)};s.getCollaborationExpression=G;const Y=function(e,t,n){return J(e,t,true,n)};s.getEnabledExpressionAsObject=Y;const J=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3?arguments[3]:undefined;if(!e||typeof e==="string"){return N(true)}let o;if(i){o=I(i)}let a=A(true);if(t!==null){a=F(x(t),false,true)}const r=u(e)&&e.$target||e;const l=F(x(r,o),false,true);if(n){return R(l,a)}return N(R(l,a))};s.getEnabledExpression=J;const Q=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:k.IsEditable;if(!e||typeof e==="string"||(o===null||o===void 0?void 0:o.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){return"Display"}const r=u(e)&&e.$target||e;const l=I(t);const s=K(e,o,t,a);const d=Y(e,o,t);const c=m(r);const p=c||g(r);let y=A("Editable");if(p){const e=h(p,l);y=F(O(e,f(p),R(v(p),C(k.IsTransientBinding)),n),F(!U(e)&&e,"EditableReadOnly","EditableDisplay"),"Editable")}const b=O(h(r,l),h(o));const x=F(d,F(s,y,F(R(!U(b)&&b,a),"ReadOnly","Display")),F(a,"Disabled","Display"));if(i){return x}return N(x)};s.getEditMode=Q;const X=function(e){var t,n,i,o;const a=e.targetObject;const r=(t=a.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.ISOCurrency;const l=r?r:(i=a.annotations)===null||i===void 0?void 0:(o=i.Measures)===null||o===void 0?void 0:o.Unit;if(l){return N(O(P(V(l)),C(k.IsTotal)))}else{return N(A(true))}};s.hasValidAnalyticalCurrencyOrUnit=X;const Z=function(e,t,n){const i=u(e)&&e.$target||e;const o=m(i)||g(i);if(!o){return N(n)}const a=h(o);const r=R(O(!U(a),C(a)),C(f(o)),C(v(o)));return N(F(r,t,n))};s.ifUnitEditable=Z;const ee=function(e,t,n){const i=u(e)&&e.$target||e;return p(i)?N(t):N(F(q(n,"Editable"),"Value",t))};s.getFieldDisplay=ee;const te=function(e,t){var n,i,o,a;const r=w[e===null||e===void 0?void 0:e.type]||(t?w[t]:undefined);const l={type:r.type,constraints:{},formatOptions:{}};if(d(e)){var s,u,c,v,f,p,g,m,y,h,b,x,E,D,I,T,$,O;l.constraints={scale:(s=r.constraints)!==null&&s!==void 0&&s.$Scale?e.scale:undefined,precision:(u=r.constraints)!==null&&u!==void 0&&u.$Precision?e.precision:undefined,maxLength:(c=r.constraints)!==null&&c!==void 0&&c.$MaxLength?e.maxLength:undefined,nullable:(v=r.constraints)!==null&&v!==void 0&&v.$Nullable?e.nullable:undefined,minimum:(f=r.constraints)!==null&&f!==void 0&&f["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN((p=e.annotations)===null||p===void 0?void 0:(g=p.Validation)===null||g===void 0?void 0:g.Minimum)?`${(m=e.annotations)===null||m===void 0?void 0:(y=m.Validation)===null||y===void 0?void 0:y.Minimum}`:undefined,maximum:(h=r.constraints)!==null&&h!==void 0&&h["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN((b=e.annotations)===null||b===void 0?void 0:(x=b.Validation)===null||x===void 0?void 0:x.Maximum)?`${(E=e.annotations)===null||E===void 0?void 0:(D=E.Validation)===null||D===void 0?void 0:D.Maximum}`:undefined,isDigitSequence:l.type==="sap.ui.model.odata.type.String"&&(I=r.constraints)!==null&&I!==void 0&&I["@com.sap.vocabularies.Common.v1.IsDigitSequence"]&&(T=e.annotations)!==null&&T!==void 0&&($=T.Common)!==null&&$!==void 0&&$.IsDigitSequence?true:undefined,V4:(O=r.constraints)!==null&&O!==void 0&&O.$V4?true:undefined}}l.formatOptions={parseAsString:(l===null||l===void 0?void 0:(n=l.type)===null||n===void 0?void 0:n.indexOf("sap.ui.model.odata.type.Int"))===0||(l===null||l===void 0?void 0:(i=l.type)===null||i===void 0?void 0:i.indexOf("sap.ui.model.odata.type.Double"))===0?false:undefined,emptyString:(l===null||l===void 0?void 0:(o=l.type)===null||o===void 0?void 0:o.indexOf("sap.ui.model.odata.type.Int"))===0||(l===null||l===void 0?void 0:(a=l.type)===null||a===void 0?void 0:a.indexOf("sap.ui.model.odata.type.Double"))===0?"":undefined,parseKeepsEmptyString:l.type==="sap.ui.model.odata.type.String"?true:undefined};return l};s.getTypeConfig=te;const ne=function(e,t,i,o){var a,r,l,s,d;const u=e.targetObject;let c=(a=u.annotations)===null||a===void 0?void 0:(r=a.Measures)===null||r===void 0?void 0:r.Unit;const v=I(e);t=j(u,t);if(((l=c)===null||l===void 0?void 0:l.toString())==="%"){if((o===null||o===void 0?void 0:o.showMeasure)===false){return t}return S([t],n.formatWithPercentage)}const f=c?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";c=c?c:(s=u.annotations)===null||s===void 0?void 0:(d=s.Measures)===null||d===void 0?void 0:d.ISOCurrency;const p=c.$target?j(c.$target,V(c,v),i):V(c,v);return B([t,p],f,undefined,o)};s.getBindingWithUnitOrCurrency=ne;const ie=function(e){var t,n,i,o,a;const r=e.targetObject;let l=(t=r.annotations)===null||t===void 0?void 0:(n=t.Measures)===null||n===void 0?void 0:n.Unit;if(((i=l)===null||i===void 0?void 0:i.toString())==="%"){return A("%")}const s=I(e);const d=l?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";l=l?l:(o=r.annotations)===null||o===void 0?void 0:(a=o.Measures)===null||a===void 0?void 0:a.ISOCurrency;const u=l.$target?j(l.$target,V(l,s)):V(l,s);let c=$(T(e));c=j(r,c,true);return B([c,u],d,undefined,{parseKeepsEmptyString:true,emptyString:"",showNumber:false})};s.getBindingForUnitOrCurrency=ie;const oe=function(e,t){var n,i;let o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let r=arguments.length>4?arguments[4]:undefined;const l=e.targetObject;const s=(n=l.annotations)===null||n===void 0?void 0:(i=n.Common)===null||i===void 0?void 0:i.Timezone;const d=I(e);t=j(l,t);const u="sap.fe.core.type.DateTimeWithTimezone";const c=s.$target?j(s.$target,V(s,d),o):V(s,d);let v={};if(a){v={showTimezoneForEmptyValues:false}}if(r!==null&&r!==void 0&&r.showTime){v={...v,...{showTime:r.showTime==="false"?false:true}}}if(r!==null&&r!==void 0&&r.showDate){v={...v,...{showDate:r.showDate==="false"?false:true}}}if(r!==null&&r!==void 0&&r.showTimezone){v={...v,...{showTimezone:r.showTimezone==="false"?false:true}}}return B([t,c],u,undefined,v)};s.getBindingWithTimezone=oe;const ae=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Begin";let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Begin";return N(F(q(e,"Display"),t,n))};s.getAlignmentExpression=ae;const re=function(e,t){if(t&&t.context){return z(t.context)}return null};re.requiresIContext=true;s.getConverterContext=re;const le=function(e,t){if(t&&t.context){return W(t.context)}return null};le.requiresIContext=true;s.getDataModelObjectPath=le;const se=function(e){var t;if((t=e.navigationProperties)!==null&&t!==void 0&&t.length){const t=(e===null||e===void 0?void 0:e.navigationProperties.findIndex(t=>{if(t._type==="NavigationProperty"&&t.isCollection){var n,i;if((n=e.contextLocation)!==null&&n!==void 0&&(i=n.navigationProperties)!==null&&i!==void 0&&i.length){var o;return((o=e.contextLocation)===null||o===void 0?void 0:o.navigationProperties.findIndex(e=>e.name===t.name))===-1}return true}return false}))>-1;if(t){return true}}return false};s.isMultiValueField=se;const de=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return ue(e,t,n,true)};s.getRequiredExpressionAsObject=de;const ue=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};let a=arguments.length>5?arguments[5]:undefined;const r=o.requiredPropertiesFromInsertRestrictions;const l=o.requiredPropertiesFromUpdateRestrictions;if(!e||typeof e==="string"){if(i){return A(false)}return N(A(false))}let s;if(a){s=I(a)}let d=A(true);if(t!==null){d=y(t)}let c=A(false);let v=A(false);const f=u(e)&&e.$target||e;const p=y(f,s);const g=n||k.IsEditable;if(r!==null&&r!==void 0&&r.includes(e.name)){c=R(A(true),k.IsCreateMode)}if(l!==null&&l!==void 0&&l.includes(e.name)){v=R(A(true),M(k.IsCreateMode,true))}const m=O(R(O(p,d),g),c,v);if(i){return m}return N(m)};s.getRequiredExpression=ue;const ce=function(e){var t,n;const i=e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:(n=t.$target)===null||n===void 0?void 0:n.Data;const o=Object.keys(i);const a=[];let r;const l=[];for(const e of o){if(i[e]["$Type"]&&i[e]["$Type"].indexOf("DataField")>-1){a.push(i[e])}}for(const e of a){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(typeof e.Value==="object"){r=e.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(e.Target.$target){if(e.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.Target.$target.$Type==="com.sap.vocabularies.UI.v1.DataPointType"){if(typeof e.Target.$target.Value==="object"){r=e.Target.$target.Value.$target}}else{if(typeof e.Target==="object"){r=e.Target.$target}break}}break}l.push(de(r,e,false))}return N(O(...l))};s.getRequiredExpressionForConnectedDataField=ce;return s},false);
//# sourceMappingURL=UIFormatters.js.map