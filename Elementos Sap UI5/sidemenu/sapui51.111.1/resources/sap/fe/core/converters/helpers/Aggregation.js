/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/helpers/ModelHelper"],function(t){"use strict";var e={};let n=function(){function n(t,e){var n,o,i,r;this._entityType=t;this._converterContext=e;this._oAggregationAnnotationTarget=this._determineAggregationAnnotationTarget();if(((n=this._oAggregationAnnotationTarget)===null||n===void 0?void 0:n._type)==="NavigationProperty"){var g,a;this.oTargetAggregationAnnotations=(g=this._oAggregationAnnotationTarget)===null||g===void 0?void 0:(a=g.annotations)===null||a===void 0?void 0:a.Aggregation}else if(((o=this._oAggregationAnnotationTarget)===null||o===void 0?void 0:o._type)==="EntityType"){var l,s;this.oTargetAggregationAnnotations=(l=this._oAggregationAnnotationTarget)===null||l===void 0?void 0:(s=l.annotations)===null||s===void 0?void 0:s.Aggregation}else if(((i=this._oAggregationAnnotationTarget)===null||i===void 0?void 0:i._type)==="EntitySet"){var u,p;this.oTargetAggregationAnnotations=(u=this._oAggregationAnnotationTarget)===null||u===void 0?void 0:(p=u.annotations)===null||p===void 0?void 0:p.Aggregation}this._bApplySupported=(r=this.oTargetAggregationAnnotations)!==null&&r!==void 0&&r.ApplySupported?true:false;if(this._bApplySupported){var A,d,v,y;this._aGroupableProperties=(A=this.oTargetAggregationAnnotations)===null||A===void 0?void 0:(d=A.ApplySupported)===null||d===void 0?void 0:d.GroupableProperties;this._aAggregatableProperties=(v=this.oTargetAggregationAnnotations)===null||v===void 0?void 0:(y=v.ApplySupported)===null||y===void 0?void 0:y.AggregatableProperties;this.oContainerAggregationAnnotation=e.getEntityContainer().annotations.Aggregation}}e.AggregationHelper=n;var o=n.prototype;o._determineAggregationAnnotationTarget=function e(){var n,o,i,r,g;const a=(n=this._converterContext.getDataModelObjectPath())!==null&&n!==void 0&&(o=n.targetEntitySet)!==null&&o!==void 0&&(i=o.entityType)!==null&&i!==void 0&&(r=i.annotations)!==null&&r!==void 0&&(g=r.Common)!==null&&g!==void 0&&g.ResultContext?true:false;let l;if(a){var s,u,p,A;const t=this._converterContext.getDataModelObjectPath();const e=t===null||t===void 0?void 0:t.targetObject;const n=t===null||t===void 0?void 0:t.targetEntityType;if(e!==null&&e!==void 0&&(s=e.annotations)!==null&&s!==void 0&&(u=s.Aggregation)!==null&&u!==void 0&&u.ApplySupported){l=e}else if(n!==null&&n!==void 0&&(p=n.annotations)!==null&&p!==void 0&&(A=p.Aggregation)!==null&&A!==void 0&&A.ApplySupported){l=n}}else{var d,v;const e=this._converterContext.getEntitySet();if(!t.isSingleton(e)&&e!==null&&e!==void 0&&(d=e.annotations)!==null&&d!==void 0&&(v=d.Aggregation)!==null&&v!==void 0&&v.ApplySupported){l=e}else{l=this._converterContext.getEntityType()}}return l};o.isAnalyticsSupported=function t(){return this._bApplySupported};o.isPropertyGroupable=function t(e){if(!this._bApplySupported){return undefined}else if(!this._aGroupableProperties||this._aGroupableProperties.length===0){return true}else{return this._aGroupableProperties.findIndex(t=>t.$target.fullyQualifiedName===e.fullyQualifiedName)>=0}};o.isPropertyAggregatable=function t(e){if(!this._bApplySupported){return undefined}else{const t=this._converterContext.getAnnotationsByTerm("Aggregation","Org.OData.Aggregation.V1.CustomAggregate",[this._oAggregationAnnotationTarget]);return t.some(t=>e.name===t.qualifier)}};o.getGroupableProperties=function t(){return this._aGroupableProperties};o.getAggregatableProperties=function t(){return this._aAggregatableProperties};o.getEntityType=function t(){return this._entityType};o.getAggregatedProperties=function t(e){if(e==="AggregatedProperties"){return this._converterContext.getAnnotationsByTerm("Analytics","com.sap.vocabularies.Analytics.v1.AggregatedProperties",[this._converterContext.getEntityContainer(),this._converterContext.getEntityType()])}return this._converterContext.getAnnotationsByTerm("Analytics","com.sap.vocabularies.Analytics.v1.AggregatedProperty",[this._converterContext.getEntityContainer(),this._converterContext.getEntityType()])};o.getTransAggregations=function t(){var e;let n=this.getAggregatedProperties("AggregatedProperty");if(!n||n.length===0){n=this.getAggregatedProperties("AggregatedProperties")[0]}return(e=n)===null||e===void 0?void 0:e.filter(t=>{if(this._getAggregatableAggregates(t.AggregatableProperty)){return t}})};o._getAggregatableAggregates=function t(e){const n=this.getAggregatableProperties()||[];return n.find(function(t){return t.Property.value===(e.qualifier?e.qualifier:e.$target.name)})};o.getCustomAggregateDefinitions=function t(){const e=this._converterContext.getAnnotationsByTerm("Aggregation","Org.OData.Aggregation.V1.CustomAggregate",[this._oAggregationAnnotationTarget]);return e};o.getAllowedTransformations=function t(){var e,n,o,i;return((e=this.oTargetAggregationAnnotations)===null||e===void 0?void 0:(n=e.ApplySupported)===null||n===void 0?void 0:n.Transformations)||((o=this.oContainerAggregationAnnotation)===null||o===void 0?void 0:(i=o.ApplySupportedDefaults)===null||i===void 0?void 0:i.Transformations)};return n}();e.AggregationHelper=n;return e},false);
//# sourceMappingURL=Aggregation.js.map