/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/ManifestSettings","sap/fe/core/formatters/FPMFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper"],function(e,n,t,i,o,a,r,l){"use strict";var u={};var s=l.replaceSpecialChars;var c=r.resolveBindingString;var d=r.pathInModel;var v=r.or;var f=r.isConstant;var p=r.ifElse;var b=r.greaterOrEqual;var m=r.getExpressionFromAnnotation;var y=r.formatResult;var g=r.equal;var h=r.compileExpression;var A=r.and;var S=o.ActionType;var C=i.getCustomActionID;var E=t.Placement;var k=n.bindingContextPathVisitor;let x;(function(e){e["Accept"]="Accept";e["Attention"]="Attention";e["Back"]="Back";e["Critical"]="Critical";e["Default"]="Default";e["Emphasized"]="Emphasized";e["Ghost"]="Ghost";e["Negative"]="Negative";e["Neutral"]="Neutral";e["Reject"]="Reject";e["Success"]="Success";e["Transparent"]="Transparent";e["Unstyled"]="Unstyled";e["Up"]="Up"})(x||(x={}));u.ButtonType=x;function F(e,n,t,i){const o=n.find(e=>e.key===i);const a=e[i];const r={...o??a};if(o){r.enabled=(a===null||a===void 0?void 0:a.enabled)??o.enabled;r.visible=(a===null||a===void 0?void 0:a.visible)??o.visible;for(const e in a||{}){if(!o[e]&&e!=="menu"){r[e]=a[e]}}}const l=((r===null||r===void 0?void 0:r.visible)||(r===null||r===void 0?void 0:r.type)===S.DataFieldForAction||(r===null||r===void 0?void 0:r.type)===S.DataFieldForIntentBasedNavigation)&&!t.find(e=>e.key===(r===null||r===void 0?void 0:r.key));return{action:r,canBeMenuItem:l}}function I(e,n,t,i,o){const{action:a,canBeMenuItem:r}=F(n,t,o,e.defaultAction);if(r){e.defaultAction=a}if(a.command){i[a.key]=a}}function M(e,n,t,i,o){const a=[];for(const r of e.menu??[]){const{action:e,canBeMenuItem:l}=F(n,t,o,r);if(l){a.push(e)}if(e.command){i[r]=e}}e.menu=a;const r=a.map(e=>c(e.visible,"boolean"));e.visible=h(A(c(e.visible,"boolean"),v(...r)))}function O(e,n,t){const i={};const o=[];const a={};for(const l in e){const u=e[l];if(u.defaultAction!==undefined){I(u,e,n,a,t)}if(u.type===S.Menu){var r;o.push(...u.menu);M(u,e,n,a,t);if(!((r=u.menu)!==null&&r!==void 0&&r.length)){o.push(u.key)}}if(u.command){a[l]=u}i[l]=u}o.forEach(e=>delete i[e]);return{actions:i,commandActions:a}}const P=function(e,n,t){if(n&&e.enabled===undefined){return undefined}const i=j(e.enabled,t);return h(p(e.requiresSelection===true,A(b(d("numberOfSelectedContexts","internal"),1),i),i))};const B=function(e,n,t){if(n&&e.visible===undefined){return undefined}const i=j(e.visible,t);return h(i)};function N(e,n){if(!n){return}e.type=n.type;e.annotationPath=n.annotationPath;e.press=n.press;e.enabled=e.enabled??n.enabled;e.visible=e.visible??n.visible}function D(e,n){if(n!==null&&n!==void 0&&n.find(n=>n.key===e.key)){e.visible="false"}}function T(e,n,t,i,o,a,r){const l={};for(const d in e){var u,c;const v=e[d];const f=((u=v.press)===null||u===void 0?void 0:u.lastIndexOf("."))||-1;const p=t===null||t===void 0?void 0:t.find(e=>e.key===d);const b=!!p;if(v.facetName){r=v.facetName}l[d]={id:p?d:C(d),type:v.menu?S.Menu:S.Default,visible:B(v,b,n),enabled:P(v,b,n),handlerModule:v.press&&v.press.substring(0,f).replace(/\./gi,"/"),handlerMethod:v.press&&v.press.substring(f+1),press:v.press,text:v.text,noWrap:v.__noWrap,key:s(d),enableOnSelect:v.enableOnSelect,defaultValuesExtensionFunction:v.defaultValuesFunction,position:{anchor:(c=v.position)===null||c===void 0?void 0:c.anchor,placement:v.position===undefined?E.After:v.position.placement},isNavigable:R(v,i,o),command:v.command,requiresSelection:v.requiresSelection===undefined?false:v.requiresSelection,enableAutoScroll:V(v),menu:v.menu??[],facetName:v.inline?r:undefined,defaultAction:v.defaultAction};N(l[d],p);D(l[d],a)}return O(l,t??[],a??[])}u.getActionsFromManifest=T;function j(e,n){const t=c(e,"boolean");let i;if(f(t)&&t.value===undefined){i=true}else if(f(t)&&typeof t.value==="boolean"){i=t.value}else if(f(t)&&typeof t.value==="string"){var o;const e=t.value;i=y([d("/","$view"),e,d("selectedContexts","internal")],a.customBooleanPropertyCheck,((o=n.getDataModelObjectPath().contextLocation)===null||o===void 0?void 0:o.targetEntityType)||n.getEntityType())}else{i=t}return i}const q=e=>{let n={};e.forEach(e=>{var t;if(e!==null&&e!==void 0&&(t=e.menu)!==null&&t!==void 0&&t.length){n=e.menu.reduce((e,n)=>{let{key:t}=n;if(t&&!e[t]){e[t]=true}return e},n)}});return e.filter(e=>!n[e.key])};u.removeDuplicateActions=q;function U(e,n){var t;if((n===null||n===void 0?void 0:n.isBound)!==true){return"true"}if(n!==null&&n!==void 0&&(t=n.parameters)!==null&&t!==void 0&&t.length){var i,o;const t=n===null||n===void 0?void 0:n.parameters[0].fullyQualifiedName,a=m(n===null||n===void 0?void 0:(i=n.annotations.Core)===null||i===void 0?void 0:i.OperationAvailable,[],undefined,n=>k(n,e,t));if((n===null||n===void 0?void 0:(o=n.annotations.Core)===null||o===void 0?void 0:o.OperationAvailable)!==undefined){return h(g(a,true))}}return"true"}u.getEnabledForAnnotationAction=U;function L(e){return e?e.map(e=>({LocalProperty:{$PropertyPath:e.LocalProperty.value},SemanticObjectProperty:e.SemanticObjectProperty})):[]}u.getSemanticObjectMapping=L;function R(e,n,t){var i,o;let a=true;if(t){const e=n&&(n.detail||n.display);a=e!==null&&e!==void 0&&e.route?true:false}if(e&&e.afterExecution&&(((i=e.afterExecution)===null||i===void 0?void 0:i.navigateToInstance)===false||((o=e.afterExecution)===null||o===void 0?void 0:o.enableAutoScroll)===true)||!a){return false}return true}u.isActionNavigable=R;function V(e){var n;return(e===null||e===void 0?void 0:(n=e.afterExecution)===null||n===void 0?void 0:n.enableAutoScroll)===true}u.enableAutoScroll=V;function $(e){var n,t,i;return((n=e.annotations)===null||n===void 0?void 0:(t=n.UI)===null||t===void 0?void 0:(i=t.IsCopyAction)===null||i===void 0?void 0:i.valueOf())===true&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"}u.dataFieldIsCopyAction=$;function w(n){if(n.length===1){return n[0]}if(n.length>1){e.error("Multiple actions are annotated with isCopyAction. There can be only one standard copy action.")}return undefined}u.getCopyAction=w;return u},false);
//# sourceMappingURL=Action.js.map