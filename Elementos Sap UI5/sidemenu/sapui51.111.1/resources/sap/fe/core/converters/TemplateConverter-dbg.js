/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/merge", "sap/fe/core/converters/helpers/IssueManager", "./ConverterContext", "./ManifestSettings", "./MetaModelConverter", "./templates/ListReportConverter", "./templates/ObjectPageConverter"], function (merge, IssueManager, ConverterContext, ManifestSettings, MetaModelConverter, ListReportConverter, ObjectPageConverter) {
  "use strict";

  var _exports = {};
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  var convertTypes = MetaModelConverter.convertTypes;
  var TemplateType = ManifestSettings.TemplateType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategoryType = IssueManager.IssueCategoryType;
  var IssueCategory = IssueManager.IssueCategory;
  function handleErrorForCollectionFacets(oFacets, oDiagnostics, sEntitySetName, level) {
    oFacets.forEach(oFacet => {
      let Message = `For entity set ${sEntitySetName}`;
      if ((oFacet === null || oFacet === void 0 ? void 0 : oFacet.$Type) === "com.sap.vocabularies.UI.v1.CollectionFacet" && !(oFacet !== null && oFacet !== void 0 && oFacet.ID)) {
        var _IssueCategoryType$Fa;
        Message = `${Message}, ` + `level ${level}, the collection facet does not have an ID.`;
        oDiagnostics.addIssue(IssueCategory.Facets, IssueSeverity.High, Message, IssueCategoryType, IssueCategoryType === null || IssueCategoryType === void 0 ? void 0 : (_IssueCategoryType$Fa = IssueCategoryType.Facets) === null || _IssueCategoryType$Fa === void 0 ? void 0 : _IssueCategoryType$Fa.MissingID);
      }
      if ((oFacet === null || oFacet === void 0 ? void 0 : oFacet.$Type) === "com.sap.vocabularies.UI.v1.CollectionFacet" && level >= 3) {
        var _IssueCategoryType$Fa2;
        Message = `${Message}, collection facet ${oFacet.Label} is not supported at ` + `level ${level}`;
        oDiagnostics.addIssue(IssueCategory.Facets, IssueSeverity.Medium, Message, IssueCategoryType, IssueCategoryType === null || IssueCategoryType === void 0 ? void 0 : (_IssueCategoryType$Fa2 = IssueCategoryType.Facets) === null || _IssueCategoryType$Fa2 === void 0 ? void 0 : _IssueCategoryType$Fa2.UnSupportedLevel);
      }
      if (oFacet !== null && oFacet !== void 0 && oFacet.Facets) {
        handleErrorForCollectionFacets(oFacet === null || oFacet === void 0 ? void 0 : oFacet.Facets, oDiagnostics, sEntitySetName, ++level);
        level = level - 1;
      }
    });
  }

  /**
   * Based on a template type, convert the metamodel and manifest definition into a json structure for the page.
   *
   * @param sTemplateType The template type
   * @param oMetaModel The odata model metaModel
   * @param oManifestSettings The current manifest settings
   * @param oDiagnostics The diagnostics wrapper
   * @param sFullContextPath The context path to reach this page
   * @param oCapabilities
   * @param component The template component
   * @returns The target page definition
   */
  function convertPage(sTemplateType, oMetaModel, oManifestSettings, oDiagnostics, sFullContextPath, oCapabilities, component) {
    var _oConvertedMetadata$e;
    const oConvertedMetadata = convertTypes(oMetaModel, oCapabilities);
    oConvertedMetadata.diagnostics.forEach(annotationErrorDetail => {
      const checkIfIssueExists = oDiagnostics.checkIfIssueExists(IssueCategory.Annotation, IssueSeverity.High, annotationErrorDetail.message);
      if (!checkIfIssueExists) {
        oDiagnostics.addIssue(IssueCategory.Annotation, IssueSeverity.High, annotationErrorDetail.message);
      }
    });
    oConvertedMetadata === null || oConvertedMetadata === void 0 ? void 0 : (_oConvertedMetadata$e = oConvertedMetadata.entityTypes) === null || _oConvertedMetadata$e === void 0 ? void 0 : _oConvertedMetadata$e.forEach(oEntitySet => {
      var _oEntitySet$annotatio, _oEntitySet$annotatio2;
      if (oEntitySet !== null && oEntitySet !== void 0 && (_oEntitySet$annotatio = oEntitySet.annotations) !== null && _oEntitySet$annotatio !== void 0 && (_oEntitySet$annotatio2 = _oEntitySet$annotatio.UI) !== null && _oEntitySet$annotatio2 !== void 0 && _oEntitySet$annotatio2.Facets) {
        var _oEntitySet$annotatio3, _oEntitySet$annotatio4;
        handleErrorForCollectionFacets(oEntitySet === null || oEntitySet === void 0 ? void 0 : (_oEntitySet$annotatio3 = oEntitySet.annotations) === null || _oEntitySet$annotatio3 === void 0 ? void 0 : (_oEntitySet$annotatio4 = _oEntitySet$annotatio3.UI) === null || _oEntitySet$annotatio4 === void 0 ? void 0 : _oEntitySet$annotatio4.Facets, oDiagnostics, oEntitySet === null || oEntitySet === void 0 ? void 0 : oEntitySet.name, 1);
      }
    });
    const sTargetEntitySetName = oManifestSettings.entitySet;
    const sContextPath = (oManifestSettings === null || oManifestSettings === void 0 ? void 0 : oManifestSettings.contextPath) || (sFullContextPath === "/" ? sFullContextPath + sTargetEntitySetName : sFullContextPath);
    const oContext = oMetaModel.createBindingContext(sContextPath);
    const oFullContext = getInvolvedDataModelObjects(oContext);
    if (oFullContext) {
      let oConvertedPage = {};
      const converterContext = new ConverterContext(oConvertedMetadata, oManifestSettings, oDiagnostics, merge, oFullContext);
      switch (sTemplateType) {
        case TemplateType.ListReport:
        case TemplateType.AnalyticalListPage:
          oConvertedPage = ListReportConverter.convertPage(converterContext);
          break;
        case TemplateType.ObjectPage:
          oConvertedPage = ObjectPageConverter.convertPage(converterContext);
          break;
      }
      if (component !== null && component !== void 0 && component.extendPageDefinition) {
        oConvertedPage = component.extendPageDefinition(oConvertedPage, converterContext);
      }
      return oConvertedPage;
    }
    return undefined;
  }
  _exports.convertPage = convertPage;
  return _exports;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJoYW5kbGVFcnJvckZvckNvbGxlY3Rpb25GYWNldHMiLCJvRmFjZXRzIiwib0RpYWdub3N0aWNzIiwic0VudGl0eVNldE5hbWUiLCJsZXZlbCIsImZvckVhY2giLCJvRmFjZXQiLCJNZXNzYWdlIiwiJFR5cGUiLCJJRCIsImFkZElzc3VlIiwiSXNzdWVDYXRlZ29yeSIsIkZhY2V0cyIsIklzc3VlU2V2ZXJpdHkiLCJIaWdoIiwiSXNzdWVDYXRlZ29yeVR5cGUiLCJNaXNzaW5nSUQiLCJMYWJlbCIsIk1lZGl1bSIsIlVuU3VwcG9ydGVkTGV2ZWwiLCJjb252ZXJ0UGFnZSIsInNUZW1wbGF0ZVR5cGUiLCJvTWV0YU1vZGVsIiwib01hbmlmZXN0U2V0dGluZ3MiLCJzRnVsbENvbnRleHRQYXRoIiwib0NhcGFiaWxpdGllcyIsImNvbXBvbmVudCIsIm9Db252ZXJ0ZWRNZXRhZGF0YSIsImNvbnZlcnRUeXBlcyIsImRpYWdub3N0aWNzIiwiYW5ub3RhdGlvbkVycm9yRGV0YWlsIiwiY2hlY2tJZklzc3VlRXhpc3RzIiwiQW5ub3RhdGlvbiIsIm1lc3NhZ2UiLCJlbnRpdHlUeXBlcyIsIm9FbnRpdHlTZXQiLCJhbm5vdGF0aW9ucyIsIlVJIiwibmFtZSIsInNUYXJnZXRFbnRpdHlTZXROYW1lIiwiZW50aXR5U2V0Iiwic0NvbnRleHRQYXRoIiwiY29udGV4dFBhdGgiLCJvQ29udGV4dCIsImNyZWF0ZUJpbmRpbmdDb250ZXh0Iiwib0Z1bGxDb250ZXh0IiwiZ2V0SW52b2x2ZWREYXRhTW9kZWxPYmplY3RzIiwib0NvbnZlcnRlZFBhZ2UiLCJjb252ZXJ0ZXJDb250ZXh0IiwiQ29udmVydGVyQ29udGV4dCIsIm1lcmdlIiwiVGVtcGxhdGVUeXBlIiwiTGlzdFJlcG9ydCIsIkFuYWx5dGljYWxMaXN0UGFnZSIsIkxpc3RSZXBvcnRDb252ZXJ0ZXIiLCJPYmplY3RQYWdlIiwiT2JqZWN0UGFnZUNvbnZlcnRlciIsImV4dGVuZFBhZ2VEZWZpbml0aW9uIiwidW5kZWZpbmVkIl0sInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyJUZW1wbGF0ZUNvbnZlcnRlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEZhY2V0VHlwZXMgfSBmcm9tIFwiQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXMvdm9jYWJ1bGFyaWVzL1VJXCI7XG5pbXBvcnQgeyBVSUFubm90YXRpb25UeXBlcyB9IGZyb20gXCJAc2FwLXV4L3ZvY2FidWxhcmllcy10eXBlcy92b2NhYnVsYXJpZXMvVUlcIjtcbmltcG9ydCBtZXJnZSBmcm9tIFwic2FwL2Jhc2UvdXRpbC9tZXJnZVwiO1xuaW1wb3J0IHsgSXNzdWVDYXRlZ29yeSwgSXNzdWVDYXRlZ29yeVR5cGUsIElzc3VlU2V2ZXJpdHkgfSBmcm9tIFwic2FwL2ZlL2NvcmUvY29udmVydGVycy9oZWxwZXJzL0lzc3VlTWFuYWdlclwiO1xuaW1wb3J0IFRlbXBsYXRlQ29tcG9uZW50IGZyb20gXCJzYXAvZmUvY29yZS9UZW1wbGF0ZUNvbXBvbmVudFwiO1xuaW1wb3J0IHR5cGUgQ29udGV4dCBmcm9tIFwic2FwL3VpL21vZGVsL0NvbnRleHRcIjtcbmltcG9ydCB0eXBlIE9EYXRhTWV0YU1vZGVsIGZyb20gXCJzYXAvdWkvbW9kZWwvb2RhdGEvdjQvT0RhdGFNZXRhTW9kZWxcIjtcbmltcG9ydCBDb252ZXJ0ZXJDb250ZXh0IGZyb20gXCIuL0NvbnZlcnRlckNvbnRleHRcIjtcbmltcG9ydCB0eXBlIHsgQmFzZU1hbmlmZXN0U2V0dGluZ3MgfSBmcm9tIFwiLi9NYW5pZmVzdFNldHRpbmdzXCI7XG5pbXBvcnQgeyBUZW1wbGF0ZVR5cGUgfSBmcm9tIFwiLi9NYW5pZmVzdFNldHRpbmdzXCI7XG5pbXBvcnQgdHlwZSB7IEVudmlyb25tZW50Q2FwYWJpbGl0aWVzIH0gZnJvbSBcIi4vTWV0YU1vZGVsQ29udmVydGVyXCI7XG5pbXBvcnQgeyBjb252ZXJ0VHlwZXMsIGdldEludm9sdmVkRGF0YU1vZGVsT2JqZWN0cyB9IGZyb20gXCIuL01ldGFNb2RlbENvbnZlcnRlclwiO1xuaW1wb3J0ICogYXMgTGlzdFJlcG9ydENvbnZlcnRlciBmcm9tIFwiLi90ZW1wbGF0ZXMvTGlzdFJlcG9ydENvbnZlcnRlclwiO1xuaW1wb3J0ICogYXMgT2JqZWN0UGFnZUNvbnZlcnRlciBmcm9tIFwiLi90ZW1wbGF0ZXMvT2JqZWN0UGFnZUNvbnZlcnRlclwiO1xuXG4vKipcbiAqIEB0eXBlZGVmIFBhZ2VEZWZpbml0aW9uXG4gKi9cbmV4cG9ydCB0eXBlIFBhZ2VEZWZpbml0aW9uID0ge1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xufTtcblxuLyoqIEB0eXBlZGVmIElEaWFnbm9zdGljcyAqL1xuZXhwb3J0IGludGVyZmFjZSBJRGlhZ25vc3RpY3Mge1xuXHRhZGRJc3N1ZShcblx0XHRpc3N1ZUNhdGVnb3J5OiBJc3N1ZUNhdGVnb3J5IHwgc3RyaW5nLFxuXHRcdGlzc3VlU2V2ZXJpdHk6IElzc3VlU2V2ZXJpdHksXG5cdFx0ZGV0YWlsczogc3RyaW5nLFxuXHRcdGlzc3VlQ2F0ZWdvcnlUeXBlPzogYW55LFxuXHRcdGlzc3VlU3ViQ2F0ZWdvcnk/OiBzdHJpbmdcblx0KTogdm9pZDtcblx0Z2V0SXNzdWVzKCk6IGFueVtdO1xuXHRjaGVja0lmSXNzdWVFeGlzdHMoXG5cdFx0aXNzdWVDYXRlZ29yeTogSXNzdWVDYXRlZ29yeSxcblx0XHRpc3N1ZVNldmVyaXR5OiBJc3N1ZVNldmVyaXR5LFxuXHRcdGRldGFpbHM6IHN0cmluZyxcblx0XHRpc3N1ZUNhdGVnb3J5VHlwZT86IGFueSxcblx0XHRpc3N1ZVN1YkNhdGVnb3J5Pzogc3RyaW5nXG5cdCk6IGJvb2xlYW47XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVycm9yRm9yQ29sbGVjdGlvbkZhY2V0cyhvRmFjZXRzOiBGYWNldFR5cGVzW10sIG9EaWFnbm9zdGljczogSURpYWdub3N0aWNzLCBzRW50aXR5U2V0TmFtZTogc3RyaW5nLCBsZXZlbDogbnVtYmVyKSB7XG5cdG9GYWNldHMuZm9yRWFjaCgob0ZhY2V0OiBhbnkpID0+IHtcblx0XHRsZXQgTWVzc2FnZSA9IGBGb3IgZW50aXR5IHNldCAke3NFbnRpdHlTZXROYW1lfWA7XG5cdFx0aWYgKG9GYWNldD8uJFR5cGUgPT09IFVJQW5ub3RhdGlvblR5cGVzLkNvbGxlY3Rpb25GYWNldCAmJiAhb0ZhY2V0Py5JRCkge1xuXHRcdFx0TWVzc2FnZSA9IGAke01lc3NhZ2V9LCBgICsgYGxldmVsICR7bGV2ZWx9LCB0aGUgY29sbGVjdGlvbiBmYWNldCBkb2VzIG5vdCBoYXZlIGFuIElELmA7XG5cdFx0XHRvRGlhZ25vc3RpY3MuYWRkSXNzdWUoXG5cdFx0XHRcdElzc3VlQ2F0ZWdvcnkuRmFjZXRzLFxuXHRcdFx0XHRJc3N1ZVNldmVyaXR5LkhpZ2gsXG5cdFx0XHRcdE1lc3NhZ2UsXG5cdFx0XHRcdElzc3VlQ2F0ZWdvcnlUeXBlLFxuXHRcdFx0XHRJc3N1ZUNhdGVnb3J5VHlwZT8uRmFjZXRzPy5NaXNzaW5nSURcblx0XHRcdCk7XG5cdFx0fVxuXHRcdGlmIChvRmFjZXQ/LiRUeXBlID09PSBVSUFubm90YXRpb25UeXBlcy5Db2xsZWN0aW9uRmFjZXQgJiYgbGV2ZWwgPj0gMykge1xuXHRcdFx0TWVzc2FnZSA9IGAke01lc3NhZ2V9LCBjb2xsZWN0aW9uIGZhY2V0ICR7b0ZhY2V0LkxhYmVsfSBpcyBub3Qgc3VwcG9ydGVkIGF0IGAgKyBgbGV2ZWwgJHtsZXZlbH1gO1xuXHRcdFx0b0RpYWdub3N0aWNzLmFkZElzc3VlKFxuXHRcdFx0XHRJc3N1ZUNhdGVnb3J5LkZhY2V0cyxcblx0XHRcdFx0SXNzdWVTZXZlcml0eS5NZWRpdW0sXG5cdFx0XHRcdE1lc3NhZ2UsXG5cdFx0XHRcdElzc3VlQ2F0ZWdvcnlUeXBlLFxuXHRcdFx0XHRJc3N1ZUNhdGVnb3J5VHlwZT8uRmFjZXRzPy5VblN1cHBvcnRlZExldmVsXG5cdFx0XHQpO1xuXHRcdH1cblx0XHRpZiAob0ZhY2V0Py5GYWNldHMpIHtcblx0XHRcdGhhbmRsZUVycm9yRm9yQ29sbGVjdGlvbkZhY2V0cyhvRmFjZXQ/LkZhY2V0cywgb0RpYWdub3N0aWNzLCBzRW50aXR5U2V0TmFtZSwgKytsZXZlbCk7XG5cdFx0XHRsZXZlbCA9IGxldmVsIC0gMTtcblx0XHR9XG5cdH0pO1xufVxuXG4vKipcbiAqIEJhc2VkIG9uIGEgdGVtcGxhdGUgdHlwZSwgY29udmVydCB0aGUgbWV0YW1vZGVsIGFuZCBtYW5pZmVzdCBkZWZpbml0aW9uIGludG8gYSBqc29uIHN0cnVjdHVyZSBmb3IgdGhlIHBhZ2UuXG4gKlxuICogQHBhcmFtIHNUZW1wbGF0ZVR5cGUgVGhlIHRlbXBsYXRlIHR5cGVcbiAqIEBwYXJhbSBvTWV0YU1vZGVsIFRoZSBvZGF0YSBtb2RlbCBtZXRhTW9kZWxcbiAqIEBwYXJhbSBvTWFuaWZlc3RTZXR0aW5ncyBUaGUgY3VycmVudCBtYW5pZmVzdCBzZXR0aW5nc1xuICogQHBhcmFtIG9EaWFnbm9zdGljcyBUaGUgZGlhZ25vc3RpY3Mgd3JhcHBlclxuICogQHBhcmFtIHNGdWxsQ29udGV4dFBhdGggVGhlIGNvbnRleHQgcGF0aCB0byByZWFjaCB0aGlzIHBhZ2VcbiAqIEBwYXJhbSBvQ2FwYWJpbGl0aWVzXG4gKiBAcGFyYW0gY29tcG9uZW50IFRoZSB0ZW1wbGF0ZSBjb21wb25lbnRcbiAqIEByZXR1cm5zIFRoZSB0YXJnZXQgcGFnZSBkZWZpbml0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0UGFnZShcblx0c1RlbXBsYXRlVHlwZTogVGVtcGxhdGVUeXBlLFxuXHRvTWV0YU1vZGVsOiBPRGF0YU1ldGFNb2RlbCxcblx0b01hbmlmZXN0U2V0dGluZ3M6IEJhc2VNYW5pZmVzdFNldHRpbmdzLFxuXHRvRGlhZ25vc3RpY3M6IElEaWFnbm9zdGljcyxcblx0c0Z1bGxDb250ZXh0UGF0aDogc3RyaW5nLFxuXHRvQ2FwYWJpbGl0aWVzPzogRW52aXJvbm1lbnRDYXBhYmlsaXRpZXMsXG5cdGNvbXBvbmVudD86IFRlbXBsYXRlQ29tcG9uZW50XG4pIHtcblx0Y29uc3Qgb0NvbnZlcnRlZE1ldGFkYXRhID0gY29udmVydFR5cGVzKG9NZXRhTW9kZWwsIG9DYXBhYmlsaXRpZXMpO1xuXHRvQ29udmVydGVkTWV0YWRhdGEuZGlhZ25vc3RpY3MuZm9yRWFjaCgoYW5ub3RhdGlvbkVycm9yRGV0YWlsKSA9PiB7XG5cdFx0Y29uc3QgY2hlY2tJZklzc3VlRXhpc3RzID0gb0RpYWdub3N0aWNzLmNoZWNrSWZJc3N1ZUV4aXN0cyhcblx0XHRcdElzc3VlQ2F0ZWdvcnkuQW5ub3RhdGlvbixcblx0XHRcdElzc3VlU2V2ZXJpdHkuSGlnaCxcblx0XHRcdGFubm90YXRpb25FcnJvckRldGFpbC5tZXNzYWdlXG5cdFx0KTtcblx0XHRpZiAoIWNoZWNrSWZJc3N1ZUV4aXN0cykge1xuXHRcdFx0b0RpYWdub3N0aWNzLmFkZElzc3VlKElzc3VlQ2F0ZWdvcnkuQW5ub3RhdGlvbiwgSXNzdWVTZXZlcml0eS5IaWdoLCBhbm5vdGF0aW9uRXJyb3JEZXRhaWwubWVzc2FnZSk7XG5cdFx0fVxuXHR9KTtcblx0b0NvbnZlcnRlZE1ldGFkYXRhPy5lbnRpdHlUeXBlcz8uZm9yRWFjaCgob0VudGl0eVNldDogYW55KSA9PiB7XG5cdFx0aWYgKG9FbnRpdHlTZXQ/LmFubm90YXRpb25zPy5VST8uRmFjZXRzKSB7XG5cdFx0XHRoYW5kbGVFcnJvckZvckNvbGxlY3Rpb25GYWNldHMob0VudGl0eVNldD8uYW5ub3RhdGlvbnM/LlVJPy5GYWNldHMsIG9EaWFnbm9zdGljcywgb0VudGl0eVNldD8ubmFtZSwgMSk7XG5cdFx0fVxuXHR9KTtcblx0Y29uc3Qgc1RhcmdldEVudGl0eVNldE5hbWUgPSBvTWFuaWZlc3RTZXR0aW5ncy5lbnRpdHlTZXQ7XG5cdGNvbnN0IHNDb250ZXh0UGF0aCA9XG5cdFx0b01hbmlmZXN0U2V0dGluZ3M/LmNvbnRleHRQYXRoIHx8IChzRnVsbENvbnRleHRQYXRoID09PSBcIi9cIiA/IHNGdWxsQ29udGV4dFBhdGggKyBzVGFyZ2V0RW50aXR5U2V0TmFtZSA6IHNGdWxsQ29udGV4dFBhdGgpO1xuXHRjb25zdCBvQ29udGV4dCA9IG9NZXRhTW9kZWwuY3JlYXRlQmluZGluZ0NvbnRleHQoc0NvbnRleHRQYXRoKSBhcyBDb250ZXh0O1xuXHRjb25zdCBvRnVsbENvbnRleHQgPSBnZXRJbnZvbHZlZERhdGFNb2RlbE9iamVjdHMob0NvbnRleHQpO1xuXG5cdGlmIChvRnVsbENvbnRleHQpIHtcblx0XHRsZXQgb0NvbnZlcnRlZFBhZ2UgPSB7fTtcblx0XHRjb25zdCBjb252ZXJ0ZXJDb250ZXh0ID0gbmV3IENvbnZlcnRlckNvbnRleHQob0NvbnZlcnRlZE1ldGFkYXRhLCBvTWFuaWZlc3RTZXR0aW5ncywgb0RpYWdub3N0aWNzLCBtZXJnZSwgb0Z1bGxDb250ZXh0KTtcblx0XHRzd2l0Y2ggKHNUZW1wbGF0ZVR5cGUpIHtcblx0XHRcdGNhc2UgVGVtcGxhdGVUeXBlLkxpc3RSZXBvcnQ6XG5cdFx0XHRjYXNlIFRlbXBsYXRlVHlwZS5BbmFseXRpY2FsTGlzdFBhZ2U6XG5cdFx0XHRcdG9Db252ZXJ0ZWRQYWdlID0gTGlzdFJlcG9ydENvbnZlcnRlci5jb252ZXJ0UGFnZShjb252ZXJ0ZXJDb250ZXh0KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFRlbXBsYXRlVHlwZS5PYmplY3RQYWdlOlxuXHRcdFx0XHRvQ29udmVydGVkUGFnZSA9IE9iamVjdFBhZ2VDb252ZXJ0ZXIuY29udmVydFBhZ2UoY29udmVydGVyQ29udGV4dCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRpZiAoY29tcG9uZW50Py5leHRlbmRQYWdlRGVmaW5pdGlvbikge1xuXHRcdFx0b0NvbnZlcnRlZFBhZ2UgPSBjb21wb25lbnQuZXh0ZW5kUGFnZURlZmluaXRpb24ob0NvbnZlcnRlZFBhZ2UsIGNvbnZlcnRlckNvbnRleHQpO1xuXHRcdH1cblx0XHRyZXR1cm4gb0NvbnZlcnRlZFBhZ2U7XG5cdH1cblx0cmV0dXJuIHVuZGVmaW5lZDtcbn1cbiJdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7RUF5Q0Es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