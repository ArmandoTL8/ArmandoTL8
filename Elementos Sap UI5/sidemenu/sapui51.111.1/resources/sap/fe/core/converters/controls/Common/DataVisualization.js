/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/IssueManager","sap/fe/macros/CommonHelper","../../ManifestSettings","./Chart","./Table"],function(t,n,e,a,i){"use strict";var o={};var r=a.createChartVisualization;var s=e.TemplateType;var l=t.IssueType;var u=t.IssueSeverity;var c=t.IssueCategory;const v=function(t,n,e,a){const i=[];const o=e.getManifestWrapper().hasMultipleVisualizations()||e.getTemplateType()===s.AnalyticalListPage;const r=n.split("@")[0];if(a&&!m(t,o)){const t=e.getEntityType();const n=p(t);if(n){i.push({visualization:n,annotationPath:`${r}${e.getRelativeAnnotationPath(n.fullyQualifiedName,t)}`,converterContext:e})}}const l=t.Visualizations;const u=function(t){const n=l===null||l===void 0?void 0:l.find(n=>{var e;return t.indexOf((e=n.$target)===null||e===void 0?void 0:e.term)>=0});if(n){i.push({visualization:n.$target,annotationPath:`${r}${n.value}`,converterContext:e})}};if(o){u(["com.sap.vocabularies.UI.v1.LineItem"]);u(["com.sap.vocabularies.UI.v1.Chart"])}else{u(["com.sap.vocabularies.UI.v1.LineItem","com.sap.vocabularies.UI.v1.Chart"])}return i};o.getVisualizationsFromPresentationVariant=v;function f(t,n,e){if(n){const t=e.getEntityTypeAnnotation(n);const a=t.annotation;if(a){if(a.term==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"){return a}}else{throw new Error("Annotation Path for the SPV mentioned in the manifest is not found, Please add the SPV in the annotation")}}else{var a,i;return(a=t.annotations)===null||a===void 0?void 0:(i=a.UI)===null||i===void 0?void 0:i.SelectionPresentationVariant}}o.getSelectionPresentationVariant=f;function d(t,n){const e=t&&t.PresentationVariant;if(e){return m(e,n)}else{throw new Error("Presentation Variant is not present in the SPV annotation")}}o.isSelectionPresentationCompliant=d;function m(t){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let e=false,a=false;if(n){if(t!==null&&t!==void 0&&t.Visualizations){const n=t.Visualizations;n.forEach(t=>{var n,i;if(((n=t.$target)===null||n===void 0?void 0:n.term)==="com.sap.vocabularies.UI.v1.LineItem"){e=true}if(((i=t.$target)===null||i===void 0?void 0:i.term)==="com.sap.vocabularies.UI.v1.Chart"){a=true}})}return a&&e}else{return(t===null||t===void 0?void 0:t.Visualizations)&&!!t.Visualizations.find(t=>{var n,e;return((n=t.$target)===null||n===void 0?void 0:n.term)==="com.sap.vocabularies.UI.v1.LineItem"||((e=t.$target)===null||e===void 0?void 0:e.term)==="com.sap.vocabularies.UI.v1.Chart"})}}o.isPresentationCompliant=m;function p(t){var n;return(n=t.annotations.UI)===null||n===void 0?void 0:n.LineItem}o.getDefaultLineItem=p;function h(t){var n;return(n=t.annotations.UI)===null||n===void 0?void 0:n.Chart}o.getDefaultChart=h;function g(t){var n,e;return(n=t.annotations)===null||n===void 0?void 0:(e=n.UI)===null||e===void 0?void 0:e.PresentationVariant}o.getDefaultPresentationVariant=g;function I(t){var n,e;return(n=t.annotations)===null||n===void 0?void 0:(e=n.UI)===null||e===void 0?void 0:e.SelectionVariant}o.getDefaultSelectionVariant=I;function P(t,n){const e=n.getManifestWrapper().getDefaultTemplateAnnotationPath();const a=f(t,e,n);let i;if(a){i=a.SelectionVariant;if(i){return i}}else{i=I(t);return i}}o.getSelectionVariant=P;function V(t,n,e,a,o,s,f){const d=t!==""?e.getEntityTypeAnnotation(t):{annotation:undefined,converterContext:e};const m=s?e.getEntityTypeAnnotation(s):null;const p=d.annotation;e=d.converterContext;let h=[];let g;let I="";let P,V;const b=p===null||p===void 0?void 0:p.term;if(b){switch(b){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":g=m===null||m===void 0?void 0:m.annotation;h.push({visualization:p,annotationPath:t,converterContext:e});break;case"com.sap.vocabularies.UI.v1.PresentationVariant":g=p;h=h.concat(v(p,t,e,f));break;case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":g=p.PresentationVariant;I=g.fullyQualifiedName;h=h.concat(v(g,t,e,f));break;default:break}h.forEach(t=>{const{visualization:e,annotationPath:s,converterContext:l}=t;switch(e.term){case"com.sap.vocabularies.UI.v1.Chart":P=r(e,s,l,o);break;case"com.sap.vocabularies.UI.v1.LineItem":default:V=i.createTableVisualization(e,s,l,g,n,a);break}})}else{V=i.createDefaultTableVisualization(e,!f);e.getDiagnostics().addIssue(c.Annotation,u.Medium,l.MISSING_LINEITEM)}const C=[];let U=b==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"?I:p&&p.fullyQualifiedName;if(U===undefined){U="/"}if(P){C.push(P)}if(V){C.push(V)}return{visualizations:C,annotationPath:e.getEntitySetBasedAnnotationPath(U)}}o.getDataVisualizationConfiguration=V;function b(t,e){const a=t.getObject(t.getPath()),i=n.createPresentationPathContext(t),o=t.getModel();if(n._isPresentationVariantAnnotation(i.getPath())){const n=a.Visualizations;if(Array.isArray(n)){for(let t=0;t<n.length;t++){if(n[t].$AnnotationPath.indexOf(e)!==-1){e=n[t].$AnnotationPath;break}}}return o.getMetaContext(t.getPath().split("@")[0]+e)}return t}o.getUiControl=b;return o},false);
//# sourceMappingURL=DataVisualization.js.map