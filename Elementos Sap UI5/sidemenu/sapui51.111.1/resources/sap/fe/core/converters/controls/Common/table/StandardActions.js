/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/formatters/TableFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","../../../helpers/BindingHelper","../../../ManifestSettings"],function(e,t,n,i,a,o){"use strict";var r={};var s=o.TemplateType;var l=o.CreationMode;var d=a.UI;var c=a.singletonPathVisitor;var u=i.isPathUpdatable;var p=i.isPathInsertable;var v=i.isPathDeletable;var f=i.getTargetObjectPath;var g=t.pathInModel;var b=t.or;var h=t.notEqual;var y=t.not;var T=t.length;var C=t.isPathInModelExpression;var M=t.isConstant;var m=t.ifElse;var P=t.greaterThan;var E=t.greaterOrEqual;var D=t.getExpressionFromAnnotation;var S=t.formatResult;var A=t.equal;var x=t.constant;var O=t.compileExpression;var I=t.and;var R;(function(e){e["CreateHidden"]="CreateHidden";e["DeleteHidden"]="DeleteHidden";e["UpdateHidden"]="UpdateHidden"})(R||(R={}));function w(e,t,n,i){return{collectionPath:f(e.getDataModelObjectPath()),hiddenAnnotation:{create:j(e,R.CreateHidden),delete:j(e,R.DeleteHidden),update:j(e,R.UpdateHidden)},creationMode:t,isDraftOrStickySupported:H(e),isViewWithMultipleVisualizations:i?e.getManifestWrapper().hasMultipleVisualizations(i):false,newAction:U(e),tableManifestConfiguration:n,restrictions:V(e)}}r.generateStandardActionsContext=w;function H(e){var t,i,a;const o=e.getDataModelObjectPath();const r=n.isObjectPathDraftSupported(o);const s=(t=o.startingEntitySet)!==null&&t!==void 0&&(i=t.annotations)!==null&&i!==void 0&&(a=i.Session)!==null&&a!==void 0&&a.StickySessionSupported?true:false;return r||s}r.isDraftOrStickySupported=H;function U(e){var t,i,a,o,r,s;const l=e.getEntitySet();const d=!n.isSingleton(l)?(l===null||l===void 0?void 0:(t=l.annotations)===null||t===void 0?void 0:(i=t.Common)===null||i===void 0?void 0:(a=i.DraftRoot)===null||a===void 0?void 0:a.NewAction)||(l===null||l===void 0?void 0:(o=l.annotations)===null||o===void 0?void 0:(r=o.Session)===null||r===void 0?void 0:(s=r.StickySessionSupported)===null||s===void 0?void 0:s.NewAction):undefined;const c=d===null||d===void 0?void 0:d.toString();if(c){var u,p,v;let t=e===null||e===void 0?void 0:(u=e.getEntityType().actions[c])===null||u===void 0?void 0:(p=u.annotations)===null||p===void 0?void 0:(v=p.Core)===null||v===void 0?void 0:v.OperationAvailable;t=t!==undefined?t:true;return{name:c,available:D(t)}}return undefined}r.getNewAction=U;function j(e,t){var n;let i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const a=e.getEntitySet();const o=e.getDataModelObjectPath();const r=o.navigationProperties.length>0&&i?[o.navigationProperties[o.navigationProperties.length-1].name]:[];const s=(a===null||a===void 0?void 0:(n=a.annotations.UI)===null||n===void 0?void 0:n[t])||false;return a?D(s,r,undefined,t=>c(t,e.getConvertedTypes(),r)):x(false)}r.isActionAnnotatedHidden=j;function V(e){const t=e.getDataModelObjectPath();const n=[{key:"isInsertable",function:p},{key:"isUpdatable",function:u},{key:"isDeletable",function:v}];const i={};n.forEach(function(n){const a=n["function"];i[n.key]={expression:a.apply(null,[t,{pathVisitor:(t,n)=>c(t,e.getConvertedTypes(),n)}]),navigationExpression:a.apply(null,[t,{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(t,n)=>c(t,e.getConvertedTypes(),n)}])}});return i}r.getRestrictions=V;function k(e,t,n){return(t||e.creationMode===l.External)&&!n}r.getInsertUpdateActionsTemplating=k;function L(e,t){const n=B(e,t);return{isTemplated:O(_(t,n)),visible:O(n),enabled:O(Q(e,t,n))}}r.getStandardActionCreate=L;function z(e,t){const n=$(e,t);return{isTemplated:O(q(n)),visible:O(n),enabled:O(X(e,t,n))}}r.getStandardActionDelete=z;function F(e,t){const n=B(e,t,true);return{isTemplated:O(_(t,n,true)),visible:O(n),enabled:O(K(e,t,n))}}r.getCreationRow=F;function N(e,t,n){const i=B(e,t);const a=Q(e,t,i);const o=G(e,t,i,n);return{visible:O(o),enabled:O(Y(o,a))}}r.getStandardActionPaste=N;function W(e,t){const n=J(e,t);return{isTemplated:O(q(n)),visible:O(n),enabled:O(Z(e,t,n))}}r.getStandardActionMassEdit=W;function _(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return I(b(I(n,e.creationMode===l.CreationRow),I(!n,e.creationMode!==l.CreationRow)),b(y(M(t)),t))}r.getCreateTemplating=_;function q(e){return b(y(M(e)),e)}r.getDefaultTemplating=q;function B(e,t){var n,i;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const o=t.restrictions.isInsertable.expression;const r=a?j(e,R.CreateHidden,false):t.hiddenAnnotation.create;const c=t.newAction;return m(t.creationMode===l.External,I(y(r),b(e.getTemplateType()===s.ListReport,d.IsEditable)),m(b(I(M(c===null||c===void 0?void 0:c.available),A(c===null||c===void 0?void 0:c.available,false)),I(M(o),A(o,false),!c),I(M(r),A(r,true)),I(t.creationMode===l.InlineCreationRows,((n=t.tableManifestConfiguration)===null||n===void 0?void 0:n.type)==="ResponsiveTable",m((t===null||t===void 0?void 0:(i=t.tableManifestConfiguration)===null||i===void 0?void 0:i.inlineCreationRowsHiddenInEditMode)===false,true,d.IsCreateMode))),false,m(e.getTemplateType()===s.ListReport,b(y(C(r)),y(r)),I(y(r),d.IsEditable))))}r.getCreateVisibility=B;function $(e,t){const n=t.hiddenAnnotation.delete;const i=t.restrictions.isDeletable.expression;return m(e.getTemplateType()===s.AnalyticalListPage,false,m(I(M(i),A(i,false)),false,m(I(M(n),A(n,x(true))),false,m(e.getTemplateType()!==s.ListReport,I(y(n),d.IsEditable),y(I(C(n),n))))))}r.getDeleteVisibility=$;function G(e,t,n,i){return I(h(t.tableManifestConfiguration.enablePaste,false),n,i,[s.ListReport,s.AnalyticalListPage].indexOf(e.getTemplateType())===-1,t.restrictions.isInsertable.expression)}r.getPasteVisibility=G;function J(e,t){var n;const i=t.hiddenAnnotation.update,a=t.restrictions.isUpdatable.expression,o=((n=t.tableManifestConfiguration)===null||n===void 0?void 0:n.enableMassEdit)||false;const r=e.getTemplateType()===s.ObjectPage?d.IsEditable:e.getTemplateType()===s.ListReport;return I(y(I(M(a),A(a,false))),o,r,y(i))}r.getMassEditVisibility=J;function K(t,n,i){const a=p(t.getDataModelObjectPath(),{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(e,n)=>{if(e.indexOf("/")===0){e=c(e,t.getConvertedTypes(),n);return e}const i=t.getDataModelObjectPath().navigationProperties;if(i){const t=i[i.length-1];const n=t._type==="NavigationProperty"&&t.partner;if(n){e=`${n}/${e}`}}return e}});const o=a._type==="Unresolvable"?p(t.getDataModelObjectPath(),{pathVisitor:e=>c(e,t.getConvertedTypes(),[])}):a;return I(i,o,b(!n.tableManifestConfiguration.disableAddRowButtonForEmptyData,S([g("creationRowFieldValidity","internal")],e.validateCreationRowFields)))}r.getCreationRowEnablement=K;function Q(e,t,n){var i;const a=t.restrictions.isInsertable.expression;const o=(i=e.resolveAbsolutePath(t.collectionPath).target)===null||i===void 0?void 0:i._type;return I(n,b(o==="EntitySet",I(a,b(e.getTemplateType()!==s.ObjectPage,d.IsEditable))))}r.getCreateEnablement=Q;function X(e,t,n){const i=g("deletableContexts","internal");const a=g("unSavedContexts","internal");const o=g("draftsWithDeletableActive","internal");const r=g("draftsWithNonDeletableActive","internal");return I(n,m(e.getTemplateType()===s.ObjectPage,b(I(h(i,undefined),P(T(i),0)),I(h(o,undefined),P(T(o),0))),b(I(h(i,undefined),P(T(i),0)),I(h(o,undefined),P(T(o),0)),I(h(r,undefined),P(T(r),0)),I(h(a,undefined),P(T(a),0)))))}r.getDeleteEnablement=X;function Y(e,t){return I(e,t)}r.getPasteEnablement=Y;function Z(e,t,i){const a=t.restrictions.isUpdatable.expression;const o=!M(a)&&t.restrictions.isUpdatable.navigationExpression._type==="Unresolvable";const r=E(g("numberOfSelectedContexts","internal"),1);const s=E(T(g("updatableContexts","internal")),1);const l=n.isObjectPathDraftSupported(e.getDataModelObjectPath());const d=ee(e);const c=m(b(I(d,l),o),I(r,s),I(r));return I(i,m(o,c,I(c,a)))}r.getMassEditEnablement=Z;function ee(e,t){const n=e.getTemplateType();if(n===s.ListReport||n===s.AnalyticalListPage||t&&e.getManifestWrapper().hasMultipleVisualizations(t)){return true}return false}r.isInDisplayMode=ee;return r},false);
//# sourceMappingURL=StandardActions.js.map