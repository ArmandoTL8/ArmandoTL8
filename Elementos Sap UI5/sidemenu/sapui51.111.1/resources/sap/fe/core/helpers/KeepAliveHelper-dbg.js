/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/fe/core/helpers/KeepAliveRefreshTypes", "./ModelHelper"], function (Log, KeepAliveRefreshTypes, ModelHelper) {
  "use strict";

  var RefreshStrategyType = KeepAliveRefreshTypes.RefreshStrategyType;
  var PATH_TO_STORE = KeepAliveRefreshTypes.PATH_TO_STORE;
  // Private functions - start
  const _fnSimplifyEntitySetPath = function (metaModel, entitySetPathToUse) {
    const entitySetPath = ModelHelper.getEntitySetPath(entitySetPathToUse);
    const entitySet = entitySetPath.indexOf("$NavigationPropertyBinding") > -1 && metaModel.getObject(entitySetPath);
    return entitySet ? `/${entitySet}` : entitySetPathToUse;
  };
  const _fnIsApplicable = function (primaryPath, key, strategy) {
    return primaryPath === key || strategy === RefreshStrategyType.IncludingDependents && primaryPath.startsWith(key);
  };
  /**
   * Check if given path resides in the context path provided.
   *
   * @param metaModel MetaModel to be used
   * @param contextPath Context path to be used
   * @param path Path to be used
   * @param strategy Strategy, it could be 'self' | 'includingDependents'
   * @returns Returns true if the context path is applicable.
   */
  const _isPathApplicableToContextPath = function (metaModel, contextPath, path, strategy) {
    let contextPathToCheck = contextPath.startsWith("/") ? contextPath : `/${contextPath}`,
      pathToCheck = path.startsWith("/") ? path : `/${path}`;
    if (!_fnIsApplicable(contextPathToCheck, pathToCheck, strategy)) {
      contextPathToCheck = _fnSimplifyEntitySetPath(metaModel, contextPathToCheck);
      if (!_fnIsApplicable(contextPathToCheck, pathToCheck, strategy)) {
        pathToCheck = _fnSimplifyEntitySetPath(metaModel, pathToCheck);
      } else {
        return true;
      }
    }
    return _fnIsApplicable(contextPathToCheck, pathToCheck, strategy);
  };
  // Private functions - end
  /**
   * Get controls to refresh in a view.
   *
   * @param view View of the controls
   * @param controls Context path to be used
   * @returns Returns controls that need to be refreshed.
   */
  const getControlsForRefresh = function (view, controls) {
    const controlsForRefresh = [];
    const metaModel = view.getModel().getMetaModel();
    const internalModel = view.getModel("internal");
    const refreshStrategy = internalModel.getProperty(PATH_TO_STORE) || {};
    if (controls) {
      controls.forEach(function (control) {
        const contextPath = control.data("targetCollectionPath");
        for (const key in refreshStrategy) {
          const strategy = refreshStrategy[key];
          if (controlsForRefresh.indexOf(control) === -1 && _isPathApplicableToContextPath(metaModel, contextPath, key, strategy)) {
            controlsForRefresh.push(control);
          }
        }
      });
    }
    return controlsForRefresh;
  };
  /**
   * Get refresh strategy for the control for a context path.
   *
   * @param control Control from which refresh info is needed
   * @param contextPath ContextPath for properities
   * @returns Returns strategy for control refresh.
   */
  const getControlRefreshStrategyForContextPath = function (control, contextPath) {
    const metaModel = control.getModel().getMetaModel();
    const internalModel = control.getModel("internal");
    const refreshStrategy = internalModel.getProperty(PATH_TO_STORE) || {};
    let strategy;
    if (contextPath) {
      for (const key in refreshStrategy) {
        const strategyToCheck = refreshStrategy[key];
        if (_isPathApplicableToContextPath(metaModel, contextPath, key, strategyToCheck)) {
          strategy = strategyToCheck;
          if (strategy === "includingDependents") {
            break;
          }
        }
      }
    }
    return strategy;
  };
  /**
   * Get refresh info from view.
   *
   * @param view View from which refresh info is needed
   * @returns Returns strategy for view refresh.
   */
  const getViewRefreshInfo = function (view) {
    const viewData = view.getViewData(),
      contextPath = viewData && ((viewData === null || viewData === void 0 ? void 0 : viewData.contextPath) || `/${viewData === null || viewData === void 0 ? void 0 : viewData.entitySet}`);
    return KeepAliveHelper.getControlRefreshStrategyForContextPath(view, contextPath);
  };

  /**
   * Get refresh strategy for an intent.
   *
   * @param refreshStrategies RefreshStrategies to consider
   * @param semanticObject Outbound Semantic Object
   * @param action Outbound Action
   * @returns Returns refresh strategies to use for the intent.
   */
  const getRefreshStrategyForIntent = function (refreshStrategies, semanticObject, action) {
    const soAction = semanticObject && action && `${semanticObject}-${action}`;
    const intents = refreshStrategies.intents;
    const soActionIntentMatch = intents && soAction && intents[soAction];
    const soIntentMatch = !soActionIntentMatch && intents && semanticObject && intents[semanticObject];
    return soActionIntentMatch || soIntentMatch || (refreshStrategies === null || refreshStrategies === void 0 ? void 0 : refreshStrategies.defaultBehavior) || (refreshStrategies === null || refreshStrategies === void 0 ? void 0 : refreshStrategies._feDefault);
  };
  /**
   * Store control refresh strategy for hash in the internal model.
   *
   * @param control Control for the refresh strategy
   * @param hash Shell hash object
   */
  const storeControlRefreshStrategyForHash = function (control, hash) {
    if (control && control.getModel("viewData") && control.getModel("internal")) {
      const viewData = control.getModel("viewData");
      const refreshStrategies = viewData.getProperty(PATH_TO_STORE);
      if (refreshStrategies) {
        const internalModel = control.getModel("internal");
        const refreshStrategy = KeepAliveHelper.getRefreshStrategyForIntent(refreshStrategies, hash === null || hash === void 0 ? void 0 : hash.semanticObject, hash === null || hash === void 0 ? void 0 : hash.action);
        internalModel.setProperty(PATH_TO_STORE, refreshStrategy);
      }
    }
  };

  /**
   * Method to refresh and restore the view if neccessary.
   *
   * @param view Control for the refresh strategy
   * @returns A promise after view refresh and restore are triggered
   */
  const restoreView = function (view) {
    const internalModelContext = view.getBindingContext("internal");
    const controller = view.getController();
    const viewState = controller === null || controller === void 0 ? void 0 : controller.viewState;
    let refreshBindings = Promise.resolve();
    if (internalModelContext && internalModelContext.getProperty("restoreStatus") === "pending") {
      if (viewState.refreshViewBindings) {
        refreshBindings = viewState.refreshViewBindings();
        refreshBindings.then(function () {
          Log.info(`FE V4: Refresh was triggered successfull: ${view.getId()}`);
        }).catch(function (err) {
          Log.warning(`FE V4: Refresh was unsuccessfull: ${view.getId()}`, err);
        });
      }
      refreshBindings = refreshBindings.then(function () {
        viewState.onRestore();
        internalModelContext.setProperty("restoreStatus", "done");
      }).catch(function (error) {
        Log.warning(`FE V4: Restore was unsuccessfull: ${view.getId()}`, error);
      });
    }
    return refreshBindings;
  };

  /**
   * helper class for KeepAlive feature in sap.fe.
   */
  const KeepAliveHelper = {
    getControlsForRefresh,
    getControlRefreshStrategyForContextPath,
    getViewRefreshInfo,
    getRefreshStrategyForIntent,
    storeControlRefreshStrategyForHash,
    restoreView
  };
  return KeepAliveHelper;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZm5TaW1wbGlmeUVudGl0eVNldFBhdGgiLCJtZXRhTW9kZWwiLCJlbnRpdHlTZXRQYXRoVG9Vc2UiLCJlbnRpdHlTZXRQYXRoIiwiTW9kZWxIZWxwZXIiLCJnZXRFbnRpdHlTZXRQYXRoIiwiZW50aXR5U2V0IiwiaW5kZXhPZiIsImdldE9iamVjdCIsIl9mbklzQXBwbGljYWJsZSIsInByaW1hcnlQYXRoIiwia2V5Iiwic3RyYXRlZ3kiLCJSZWZyZXNoU3RyYXRlZ3lUeXBlIiwiSW5jbHVkaW5nRGVwZW5kZW50cyIsInN0YXJ0c1dpdGgiLCJfaXNQYXRoQXBwbGljYWJsZVRvQ29udGV4dFBhdGgiLCJjb250ZXh0UGF0aCIsInBhdGgiLCJjb250ZXh0UGF0aFRvQ2hlY2siLCJwYXRoVG9DaGVjayIsImdldENvbnRyb2xzRm9yUmVmcmVzaCIsInZpZXciLCJjb250cm9scyIsImNvbnRyb2xzRm9yUmVmcmVzaCIsImdldE1vZGVsIiwiZ2V0TWV0YU1vZGVsIiwiaW50ZXJuYWxNb2RlbCIsInJlZnJlc2hTdHJhdGVneSIsImdldFByb3BlcnR5IiwiUEFUSF9UT19TVE9SRSIsImZvckVhY2giLCJjb250cm9sIiwiZGF0YSIsInB1c2giLCJnZXRDb250cm9sUmVmcmVzaFN0cmF0ZWd5Rm9yQ29udGV4dFBhdGgiLCJzdHJhdGVneVRvQ2hlY2siLCJnZXRWaWV3UmVmcmVzaEluZm8iLCJ2aWV3RGF0YSIsImdldFZpZXdEYXRhIiwiS2VlcEFsaXZlSGVscGVyIiwiZ2V0UmVmcmVzaFN0cmF0ZWd5Rm9ySW50ZW50IiwicmVmcmVzaFN0cmF0ZWdpZXMiLCJzZW1hbnRpY09iamVjdCIsImFjdGlvbiIsInNvQWN0aW9uIiwiaW50ZW50cyIsInNvQWN0aW9uSW50ZW50TWF0Y2giLCJzb0ludGVudE1hdGNoIiwiZGVmYXVsdEJlaGF2aW9yIiwiX2ZlRGVmYXVsdCIsInN0b3JlQ29udHJvbFJlZnJlc2hTdHJhdGVneUZvckhhc2giLCJoYXNoIiwic2V0UHJvcGVydHkiLCJyZXN0b3JlVmlldyIsImludGVybmFsTW9kZWxDb250ZXh0IiwiZ2V0QmluZGluZ0NvbnRleHQiLCJjb250cm9sbGVyIiwiZ2V0Q29udHJvbGxlciIsInZpZXdTdGF0ZSIsInJlZnJlc2hCaW5kaW5ncyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVmcmVzaFZpZXdCaW5kaW5ncyIsInRoZW4iLCJMb2ciLCJpbmZvIiwiZ2V0SWQiLCJjYXRjaCIsImVyciIsIndhcm5pbmciLCJvblJlc3RvcmUiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiS2VlcEFsaXZlSGVscGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2cgZnJvbSBcInNhcC9iYXNlL0xvZ1wiO1xuaW1wb3J0IHR5cGUgeyBCYXNlTWFuaWZlc3RTZXR0aW5ncyB9IGZyb20gXCJzYXAvZmUvY29yZS9jb252ZXJ0ZXJzL01hbmlmZXN0U2V0dGluZ3NcIjtcbmltcG9ydCB0eXBlIHsgUmVmcmVzaFN0cmF0ZWdpZXMsIFNPQWN0aW9uLCBTT1JlZnJlc2hTdHJhdGVneSB9IGZyb20gXCJzYXAvZmUvY29yZS9oZWxwZXJzL0tlZXBBbGl2ZVJlZnJlc2hUeXBlc1wiO1xuaW1wb3J0IHsgUEFUSF9UT19TVE9SRSwgUmVmcmVzaFN0cmF0ZWd5VHlwZSB9IGZyb20gXCJzYXAvZmUvY29yZS9oZWxwZXJzL0tlZXBBbGl2ZVJlZnJlc2hUeXBlc1wiO1xuaW1wb3J0IHR5cGUgQ29udHJvbCBmcm9tIFwic2FwL3VpL2NvcmUvQ29udHJvbFwiO1xuaW1wb3J0IHR5cGUgVmlldyBmcm9tIFwic2FwL3VpL2NvcmUvbXZjL1ZpZXdcIjtcbmltcG9ydCB0eXBlIEpTT05Nb2RlbCBmcm9tIFwic2FwL3VpL21vZGVsL2pzb24vSlNPTk1vZGVsXCI7XG5pbXBvcnQgdHlwZSBPRGF0YU1ldGFNb2RlbCBmcm9tIFwic2FwL3VpL21vZGVsL29kYXRhL3Y0L09EYXRhTWV0YU1vZGVsXCI7XG5pbXBvcnQgdHlwZSB7IEludGVybmFsTW9kZWxDb250ZXh0IH0gZnJvbSBcIi4vTW9kZWxIZWxwZXJcIjtcbmltcG9ydCBNb2RlbEhlbHBlciBmcm9tIFwiLi9Nb2RlbEhlbHBlclwiO1xuXG4vLyBQcml2YXRlIGZ1bmN0aW9ucyAtIHN0YXJ0XG5jb25zdCBfZm5TaW1wbGlmeUVudGl0eVNldFBhdGggPSBmdW5jdGlvbiAobWV0YU1vZGVsOiBPRGF0YU1ldGFNb2RlbCwgZW50aXR5U2V0UGF0aFRvVXNlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRjb25zdCBlbnRpdHlTZXRQYXRoID0gTW9kZWxIZWxwZXIuZ2V0RW50aXR5U2V0UGF0aChlbnRpdHlTZXRQYXRoVG9Vc2UpO1xuXHRjb25zdCBlbnRpdHlTZXQgPSBlbnRpdHlTZXRQYXRoLmluZGV4T2YoXCIkTmF2aWdhdGlvblByb3BlcnR5QmluZGluZ1wiKSA+IC0xICYmIG1ldGFNb2RlbC5nZXRPYmplY3QoZW50aXR5U2V0UGF0aCk7XG5cdHJldHVybiBlbnRpdHlTZXQgPyBgLyR7ZW50aXR5U2V0fWAgOiBlbnRpdHlTZXRQYXRoVG9Vc2U7XG59O1xuY29uc3QgX2ZuSXNBcHBsaWNhYmxlID0gZnVuY3Rpb24gKHByaW1hcnlQYXRoOiBzdHJpbmcsIGtleTogc3RyaW5nLCBzdHJhdGVneTogUmVmcmVzaFN0cmF0ZWd5VHlwZSk6IGJvb2xlYW4ge1xuXHRyZXR1cm4gcHJpbWFyeVBhdGggPT09IGtleSB8fCAoc3RyYXRlZ3kgPT09IFJlZnJlc2hTdHJhdGVneVR5cGUuSW5jbHVkaW5nRGVwZW5kZW50cyAmJiBwcmltYXJ5UGF0aC5zdGFydHNXaXRoKGtleSkpO1xufTtcbi8qKlxuICogQ2hlY2sgaWYgZ2l2ZW4gcGF0aCByZXNpZGVzIGluIHRoZSBjb250ZXh0IHBhdGggcHJvdmlkZWQuXG4gKlxuICogQHBhcmFtIG1ldGFNb2RlbCBNZXRhTW9kZWwgdG8gYmUgdXNlZFxuICogQHBhcmFtIGNvbnRleHRQYXRoIENvbnRleHQgcGF0aCB0byBiZSB1c2VkXG4gKiBAcGFyYW0gcGF0aCBQYXRoIHRvIGJlIHVzZWRcbiAqIEBwYXJhbSBzdHJhdGVneSBTdHJhdGVneSwgaXQgY291bGQgYmUgJ3NlbGYnIHwgJ2luY2x1ZGluZ0RlcGVuZGVudHMnXG4gKiBAcmV0dXJucyBSZXR1cm5zIHRydWUgaWYgdGhlIGNvbnRleHQgcGF0aCBpcyBhcHBsaWNhYmxlLlxuICovXG5jb25zdCBfaXNQYXRoQXBwbGljYWJsZVRvQ29udGV4dFBhdGggPSBmdW5jdGlvbiAoXG5cdG1ldGFNb2RlbDogT0RhdGFNZXRhTW9kZWwsXG5cdGNvbnRleHRQYXRoOiBzdHJpbmcsXG5cdHBhdGg6IHN0cmluZyxcblx0c3RyYXRlZ3k6IFJlZnJlc2hTdHJhdGVneVR5cGVcbik6IGJvb2xlYW4ge1xuXHRsZXQgY29udGV4dFBhdGhUb0NoZWNrID0gY29udGV4dFBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBjb250ZXh0UGF0aCA6IGAvJHtjb250ZXh0UGF0aH1gLFxuXHRcdHBhdGhUb0NoZWNrID0gcGF0aC5zdGFydHNXaXRoKFwiL1wiKSA/IHBhdGggOiBgLyR7cGF0aH1gO1xuXHRpZiAoIV9mbklzQXBwbGljYWJsZShjb250ZXh0UGF0aFRvQ2hlY2ssIHBhdGhUb0NoZWNrLCBzdHJhdGVneSkpIHtcblx0XHRjb250ZXh0UGF0aFRvQ2hlY2sgPSBfZm5TaW1wbGlmeUVudGl0eVNldFBhdGgobWV0YU1vZGVsLCBjb250ZXh0UGF0aFRvQ2hlY2spO1xuXHRcdGlmICghX2ZuSXNBcHBsaWNhYmxlKGNvbnRleHRQYXRoVG9DaGVjaywgcGF0aFRvQ2hlY2ssIHN0cmF0ZWd5KSkge1xuXHRcdFx0cGF0aFRvQ2hlY2sgPSBfZm5TaW1wbGlmeUVudGl0eVNldFBhdGgobWV0YU1vZGVsLCBwYXRoVG9DaGVjayk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gX2ZuSXNBcHBsaWNhYmxlKGNvbnRleHRQYXRoVG9DaGVjaywgcGF0aFRvQ2hlY2ssIHN0cmF0ZWd5KTtcbn07XG4vLyBQcml2YXRlIGZ1bmN0aW9ucyAtIGVuZFxuLyoqXG4gKiBHZXQgY29udHJvbHMgdG8gcmVmcmVzaCBpbiBhIHZpZXcuXG4gKlxuICogQHBhcmFtIHZpZXcgVmlldyBvZiB0aGUgY29udHJvbHNcbiAqIEBwYXJhbSBjb250cm9scyBDb250ZXh0IHBhdGggdG8gYmUgdXNlZFxuICogQHJldHVybnMgUmV0dXJucyBjb250cm9scyB0aGF0IG5lZWQgdG8gYmUgcmVmcmVzaGVkLlxuICovXG5jb25zdCBnZXRDb250cm9sc0ZvclJlZnJlc2ggPSBmdW5jdGlvbiAodmlldzogVmlldywgY29udHJvbHM6IENvbnRyb2xbXSk6IENvbnRyb2xbXSB7XG5cdGNvbnN0IGNvbnRyb2xzRm9yUmVmcmVzaDogQ29udHJvbFtdID0gW107XG5cdGNvbnN0IG1ldGFNb2RlbCA9IHZpZXcuZ2V0TW9kZWwoKS5nZXRNZXRhTW9kZWwoKSBhcyBPRGF0YU1ldGFNb2RlbDtcblx0Y29uc3QgaW50ZXJuYWxNb2RlbCA9IHZpZXcuZ2V0TW9kZWwoXCJpbnRlcm5hbFwiKTtcblx0Y29uc3QgcmVmcmVzaFN0cmF0ZWd5ID0gaW50ZXJuYWxNb2RlbC5nZXRQcm9wZXJ0eShQQVRIX1RPX1NUT1JFKSB8fCB7fTtcblx0aWYgKGNvbnRyb2xzKSB7XG5cdFx0Y29udHJvbHMuZm9yRWFjaChmdW5jdGlvbiAoY29udHJvbCkge1xuXHRcdFx0Y29uc3QgY29udGV4dFBhdGggPSBjb250cm9sLmRhdGEoXCJ0YXJnZXRDb2xsZWN0aW9uUGF0aFwiKTtcblx0XHRcdGZvciAoY29uc3Qga2V5IGluIHJlZnJlc2hTdHJhdGVneSkge1xuXHRcdFx0XHRjb25zdCBzdHJhdGVneSA9IHJlZnJlc2hTdHJhdGVneVtrZXldO1xuXHRcdFx0XHRpZiAoY29udHJvbHNGb3JSZWZyZXNoLmluZGV4T2YoY29udHJvbCkgPT09IC0xICYmIF9pc1BhdGhBcHBsaWNhYmxlVG9Db250ZXh0UGF0aChtZXRhTW9kZWwsIGNvbnRleHRQYXRoLCBrZXksIHN0cmF0ZWd5KSkge1xuXHRcdFx0XHRcdGNvbnRyb2xzRm9yUmVmcmVzaC5wdXNoKGNvbnRyb2wpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0cmV0dXJuIGNvbnRyb2xzRm9yUmVmcmVzaDtcbn07XG4vKipcbiAqIEdldCByZWZyZXNoIHN0cmF0ZWd5IGZvciB0aGUgY29udHJvbCBmb3IgYSBjb250ZXh0IHBhdGguXG4gKlxuICogQHBhcmFtIGNvbnRyb2wgQ29udHJvbCBmcm9tIHdoaWNoIHJlZnJlc2ggaW5mbyBpcyBuZWVkZWRcbiAqIEBwYXJhbSBjb250ZXh0UGF0aCBDb250ZXh0UGF0aCBmb3IgcHJvcGVyaXRpZXNcbiAqIEByZXR1cm5zIFJldHVybnMgc3RyYXRlZ3kgZm9yIGNvbnRyb2wgcmVmcmVzaC5cbiAqL1xuY29uc3QgZ2V0Q29udHJvbFJlZnJlc2hTdHJhdGVneUZvckNvbnRleHRQYXRoID0gZnVuY3Rpb24gKGNvbnRyb2w6IENvbnRyb2wsIGNvbnRleHRQYXRoOiBzdHJpbmcpOiBSZWZyZXNoU3RyYXRlZ3lUeXBlIHwgdW5kZWZpbmVkIHtcblx0Y29uc3QgbWV0YU1vZGVsID0gY29udHJvbC5nZXRNb2RlbCgpLmdldE1ldGFNb2RlbCgpIGFzIE9EYXRhTWV0YU1vZGVsO1xuXHRjb25zdCBpbnRlcm5hbE1vZGVsID0gY29udHJvbC5nZXRNb2RlbChcImludGVybmFsXCIpO1xuXHRjb25zdCByZWZyZXNoU3RyYXRlZ3kgPSBpbnRlcm5hbE1vZGVsLmdldFByb3BlcnR5KFBBVEhfVE9fU1RPUkUpIHx8IHt9O1xuXHRsZXQgc3RyYXRlZ3k7XG5cdGlmIChjb250ZXh0UGF0aCkge1xuXHRcdGZvciAoY29uc3Qga2V5IGluIHJlZnJlc2hTdHJhdGVneSkge1xuXHRcdFx0Y29uc3Qgc3RyYXRlZ3lUb0NoZWNrID0gcmVmcmVzaFN0cmF0ZWd5W2tleV07XG5cdFx0XHRpZiAoX2lzUGF0aEFwcGxpY2FibGVUb0NvbnRleHRQYXRoKG1ldGFNb2RlbCwgY29udGV4dFBhdGgsIGtleSwgc3RyYXRlZ3lUb0NoZWNrKSkge1xuXHRcdFx0XHRzdHJhdGVneSA9IHN0cmF0ZWd5VG9DaGVjaztcblx0XHRcdFx0aWYgKHN0cmF0ZWd5ID09PSBcImluY2x1ZGluZ0RlcGVuZGVudHNcIikge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdHJldHVybiBzdHJhdGVneTtcbn07XG4vKipcbiAqIEdldCByZWZyZXNoIGluZm8gZnJvbSB2aWV3LlxuICpcbiAqIEBwYXJhbSB2aWV3IFZpZXcgZnJvbSB3aGljaCByZWZyZXNoIGluZm8gaXMgbmVlZGVkXG4gKiBAcmV0dXJucyBSZXR1cm5zIHN0cmF0ZWd5IGZvciB2aWV3IHJlZnJlc2guXG4gKi9cbmNvbnN0IGdldFZpZXdSZWZyZXNoSW5mbyA9IGZ1bmN0aW9uICh2aWV3OiBWaWV3KTogUmVmcmVzaFN0cmF0ZWd5VHlwZSB8IHVuZGVmaW5lZCB7XG5cdGNvbnN0IHZpZXdEYXRhID0gdmlldy5nZXRWaWV3RGF0YSgpIGFzIEJhc2VNYW5pZmVzdFNldHRpbmdzLFxuXHRcdGNvbnRleHRQYXRoID0gdmlld0RhdGEgJiYgKHZpZXdEYXRhPy5jb250ZXh0UGF0aCB8fCBgLyR7dmlld0RhdGE/LmVudGl0eVNldH1gKTtcblx0cmV0dXJuIEtlZXBBbGl2ZUhlbHBlci5nZXRDb250cm9sUmVmcmVzaFN0cmF0ZWd5Rm9yQ29udGV4dFBhdGgodmlldywgY29udGV4dFBhdGgpO1xufTtcblxuLyoqXG4gKiBHZXQgcmVmcmVzaCBzdHJhdGVneSBmb3IgYW4gaW50ZW50LlxuICpcbiAqIEBwYXJhbSByZWZyZXNoU3RyYXRlZ2llcyBSZWZyZXNoU3RyYXRlZ2llcyB0byBjb25zaWRlclxuICogQHBhcmFtIHNlbWFudGljT2JqZWN0IE91dGJvdW5kIFNlbWFudGljIE9iamVjdFxuICogQHBhcmFtIGFjdGlvbiBPdXRib3VuZCBBY3Rpb25cbiAqIEByZXR1cm5zIFJldHVybnMgcmVmcmVzaCBzdHJhdGVnaWVzIHRvIHVzZSBmb3IgdGhlIGludGVudC5cbiAqL1xuY29uc3QgZ2V0UmVmcmVzaFN0cmF0ZWd5Rm9ySW50ZW50ID0gZnVuY3Rpb24gKFxuXHRyZWZyZXNoU3RyYXRlZ2llczogUmVmcmVzaFN0cmF0ZWdpZXMsXG5cdHNlbWFudGljT2JqZWN0Pzogc3RyaW5nLFxuXHRhY3Rpb24/OiBzdHJpbmdcbik6IFNPUmVmcmVzaFN0cmF0ZWd5IHwgdW5kZWZpbmVkIHtcblx0Y29uc3Qgc29BY3Rpb24gPSBzZW1hbnRpY09iamVjdCAmJiBhY3Rpb24gJiYgYCR7c2VtYW50aWNPYmplY3R9LSR7YWN0aW9ufWA7XG5cdGNvbnN0IGludGVudHMgPSByZWZyZXNoU3RyYXRlZ2llcy5pbnRlbnRzO1xuXHRjb25zdCBzb0FjdGlvbkludGVudE1hdGNoID0gaW50ZW50cyAmJiBzb0FjdGlvbiAmJiBpbnRlbnRzW3NvQWN0aW9uXTtcblx0Y29uc3Qgc29JbnRlbnRNYXRjaCA9ICFzb0FjdGlvbkludGVudE1hdGNoICYmIGludGVudHMgJiYgc2VtYW50aWNPYmplY3QgJiYgaW50ZW50c1tzZW1hbnRpY09iamVjdF07XG5cblx0cmV0dXJuIHNvQWN0aW9uSW50ZW50TWF0Y2ggfHwgc29JbnRlbnRNYXRjaCB8fCByZWZyZXNoU3RyYXRlZ2llcz8uZGVmYXVsdEJlaGF2aW9yIHx8IHJlZnJlc2hTdHJhdGVnaWVzPy5fZmVEZWZhdWx0O1xufTtcbi8qKlxuICogU3RvcmUgY29udHJvbCByZWZyZXNoIHN0cmF0ZWd5IGZvciBoYXNoIGluIHRoZSBpbnRlcm5hbCBtb2RlbC5cbiAqXG4gKiBAcGFyYW0gY29udHJvbCBDb250cm9sIGZvciB0aGUgcmVmcmVzaCBzdHJhdGVneVxuICogQHBhcmFtIGhhc2ggU2hlbGwgaGFzaCBvYmplY3RcbiAqL1xuY29uc3Qgc3RvcmVDb250cm9sUmVmcmVzaFN0cmF0ZWd5Rm9ySGFzaCA9IGZ1bmN0aW9uIChjb250cm9sOiBDb250cm9sLCBoYXNoOiBTT0FjdGlvbik6IHZvaWQge1xuXHRpZiAoY29udHJvbCAmJiBjb250cm9sLmdldE1vZGVsKFwidmlld0RhdGFcIikgJiYgY29udHJvbC5nZXRNb2RlbChcImludGVybmFsXCIpKSB7XG5cdFx0Y29uc3Qgdmlld0RhdGEgPSBjb250cm9sLmdldE1vZGVsKFwidmlld0RhdGFcIik7XG5cdFx0Y29uc3QgcmVmcmVzaFN0cmF0ZWdpZXM6IFJlZnJlc2hTdHJhdGVnaWVzID0gdmlld0RhdGEuZ2V0UHJvcGVydHkoUEFUSF9UT19TVE9SRSk7XG5cdFx0aWYgKHJlZnJlc2hTdHJhdGVnaWVzKSB7XG5cdFx0XHRjb25zdCBpbnRlcm5hbE1vZGVsID0gY29udHJvbC5nZXRNb2RlbChcImludGVybmFsXCIpO1xuXHRcdFx0Y29uc3QgcmVmcmVzaFN0cmF0ZWd5OiBTT1JlZnJlc2hTdHJhdGVneSB8IHVuZGVmaW5lZCA9IEtlZXBBbGl2ZUhlbHBlci5nZXRSZWZyZXNoU3RyYXRlZ3lGb3JJbnRlbnQoXG5cdFx0XHRcdHJlZnJlc2hTdHJhdGVnaWVzLFxuXHRcdFx0XHRoYXNoPy5zZW1hbnRpY09iamVjdCxcblx0XHRcdFx0aGFzaD8uYWN0aW9uXG5cdFx0XHQpO1xuXHRcdFx0KGludGVybmFsTW9kZWwgYXMgSlNPTk1vZGVsKS5zZXRQcm9wZXJ0eShQQVRIX1RPX1NUT1JFLCByZWZyZXNoU3RyYXRlZ3kpO1xuXHRcdH1cblx0fVxufTtcblxuLyoqXG4gKiBNZXRob2QgdG8gcmVmcmVzaCBhbmQgcmVzdG9yZSB0aGUgdmlldyBpZiBuZWNjZXNzYXJ5LlxuICpcbiAqIEBwYXJhbSB2aWV3IENvbnRyb2wgZm9yIHRoZSByZWZyZXNoIHN0cmF0ZWd5XG4gKiBAcmV0dXJucyBBIHByb21pc2UgYWZ0ZXIgdmlldyByZWZyZXNoIGFuZCByZXN0b3JlIGFyZSB0cmlnZ2VyZWRcbiAqL1xuY29uc3QgcmVzdG9yZVZpZXcgPSBmdW5jdGlvbiAodmlldzogVmlldyk6IFByb21pc2U8YW55PiB7XG5cdGNvbnN0IGludGVybmFsTW9kZWxDb250ZXh0ID0gdmlldy5nZXRCaW5kaW5nQ29udGV4dChcImludGVybmFsXCIpIGFzIEludGVybmFsTW9kZWxDb250ZXh0O1xuXHRjb25zdCBjb250cm9sbGVyID0gdmlldy5nZXRDb250cm9sbGVyKCk7XG5cdGNvbnN0IHZpZXdTdGF0ZSA9IChjb250cm9sbGVyIGFzIGFueSk/LnZpZXdTdGF0ZTtcblx0bGV0IHJlZnJlc2hCaW5kaW5ncyA9IFByb21pc2UucmVzb2x2ZSgpO1xuXHRpZiAoaW50ZXJuYWxNb2RlbENvbnRleHQgJiYgaW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0UHJvcGVydHkoXCJyZXN0b3JlU3RhdHVzXCIpID09PSBcInBlbmRpbmdcIikge1xuXHRcdGlmICh2aWV3U3RhdGUucmVmcmVzaFZpZXdCaW5kaW5ncykge1xuXHRcdFx0cmVmcmVzaEJpbmRpbmdzID0gdmlld1N0YXRlLnJlZnJlc2hWaWV3QmluZGluZ3MoKTtcblx0XHRcdHJlZnJlc2hCaW5kaW5nc1xuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0TG9nLmluZm8oYEZFIFY0OiBSZWZyZXNoIHdhcyB0cmlnZ2VyZWQgc3VjY2Vzc2Z1bGw6ICR7dmlldy5nZXRJZCgpfWApO1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdExvZy53YXJuaW5nKGBGRSBWNDogUmVmcmVzaCB3YXMgdW5zdWNjZXNzZnVsbDogJHt2aWV3LmdldElkKCl9YCwgZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJlZnJlc2hCaW5kaW5ncyA9IHJlZnJlc2hCaW5kaW5nc1xuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR2aWV3U3RhdGUub25SZXN0b3JlKCk7XG5cdFx0XHRcdGludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwicmVzdG9yZVN0YXR1c1wiLCBcImRvbmVcIik7XG5cdFx0XHR9KVxuXHRcdFx0LmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuXHRcdFx0XHRMb2cud2FybmluZyhgRkUgVjQ6IFJlc3RvcmUgd2FzIHVuc3VjY2Vzc2Z1bGw6ICR7dmlldy5nZXRJZCgpfWAsIGVycm9yKTtcblx0XHRcdH0pO1xuXHR9XG5cdHJldHVybiByZWZyZXNoQmluZGluZ3M7XG59O1xuXG4vKipcbiAqIGhlbHBlciBjbGFzcyBmb3IgS2VlcEFsaXZlIGZlYXR1cmUgaW4gc2FwLmZlLlxuICovXG5jb25zdCBLZWVwQWxpdmVIZWxwZXIgPSB7XG5cdGdldENvbnRyb2xzRm9yUmVmcmVzaCxcblx0Z2V0Q29udHJvbFJlZnJlc2hTdHJhdGVneUZvckNvbnRleHRQYXRoLFxuXHRnZXRWaWV3UmVmcmVzaEluZm8sXG5cdGdldFJlZnJlc2hTdHJhdGVneUZvckludGVudCxcblx0c3RvcmVDb250cm9sUmVmcmVzaFN0cmF0ZWd5Rm9ySGFzaCxcblx0cmVzdG9yZVZpZXdcbn07XG5leHBvcnQgZGVmYXVsdCBLZWVwQWxpdmVIZWxwZXI7XG4iXSwibWFwcGluZ3MiOiI7QUFBQTtBQUFBO0FBQUE7Ozs7OztFQVdBO0VBQ0EsTUFBTUEsd0JBQXdCLEdBQUcsVUFBVUMsU0FBeUIsRUFBRUMsa0JBQTBCLEVBQVU7SUFDekcsTUFBTUMsYUFBYSxHQUFHQyxXQUFXLENBQUNDLGdCQUFnQixDQUFDSCxrQkFBa0IsQ0FBQztJQUN0RSxNQUFNSSxTQUFTLEdBQUdILGFBQWEsQ0FBQ0ksT0FBTyxDQUFDLDRCQUE0QixDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUlOLFNBQVMsQ0FBQ08sU0FBUyxDQUFDTCxhQUFhLENBQUM7SUFDaEgsT0FBT0csU0FBUyxHQUFJLElBQUdBLFNBQVUsRUFBQyxHQUFHSixrQkFBa0I7RUFDeEQsQ0FBQztFQUNELE1BQU1PLGVBQWUsR0FBRyxVQUFVQyxXQUFtQixFQUFFQyxHQUFXLEVBQUVDLFFBQTZCLEVBQVc7SUFDM0csT0FBT0YsV0FBVyxLQUFLQyxHQUFHLElBQUtDLFFBQVEsS0FBS0MsbUJBQW1CLENBQUNDLG1CQUFtQixJQUFJSixXQUFXLENBQUNLLFVBQVUsQ0FBQ0osR0FBRyxDQUFFO0VBQ3BILENBQUM7RUFDRDtBQUNBO0FB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