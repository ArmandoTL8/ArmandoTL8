/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/m/MessageBox", "sap/ui/core/Core", "sap/ui/core/util/PasteHelper"], function (Log, MessageBox, Core, CorePasteHelper) {
  "use strict";

  const getInfoForEntityProperty = function (propertyPath, rowBindingPath, metaContext, metaModel) {
    const property = metaContext.getProperty(propertyPath),
      formatOptions = {
        parseKeepsEmptyString: true
      },
      type = metaModel.getUI5Type(`${rowBindingPath}/${propertyPath}`, formatOptions),
      isIgnored = !property || metaContext.getProperty(`${propertyPath}@Org.OData.Core.V1.Computed`);
    return {
      property: propertyPath,
      ignore: isIgnored,
      type: type
    };
  };
  const displayErrorMessages = function (errorMessages) {
    const messageDetails = [...errorMessages];
    const resourceBundle = Core.getLibraryResourceBundle("sap.fe.core"),
      errorCorrectionMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_CORRECTION_MESSAGE"),
      noteMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_CORRECTION_NOTE");
    let pasteErrorMessage;
    if (messageDetails.length > 1) {
      pasteErrorMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_MESSAGE_PLURAL", [messageDetails.length]);
    } else {
      pasteErrorMessage = resourceBundle.getText("C_PASTE_HELPER_SAPFE_PASTE_ERROR_MESSAGE_SINGULAR");
    }
    messageDetails.unshift(""); // To show space between the short text and the list of errors
    messageDetails.unshift(noteMessage);
    messageDetails.unshift(errorCorrectionMessage);
    MessageBox.error(pasteErrorMessage, {
      title: resourceBundle.getText("C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR"),
      details: messageDetails.join("<br>")
    });
  };
  const PasteHelper = {
    displayErrorMessages: displayErrorMessages,
    formatCustomMessage: function (validationMessages, iRowNumber) {
      let errorMessage = "";
      const numberMessages = validationMessages.length;
      const resourceBundle = Core.getLibraryResourceBundle("sap.fe.core"),
        i18nRow = resourceBundle.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW");
      if (numberMessages > 0) {
        errorMessage += `${i18nRow} ${iRowNumber}: `;
        validationMessages.forEach((message, indexMessage) => {
          if (message.messageText) {
            errorMessage += message.messageText + (indexMessage + 1 !== numberMessages ? " " : "");
          }
        });
      }
      return errorMessage;
    },
    getColumnInfo: function (table) {
      const model = table.getRowBinding().getModel(),
        metaModel = model.getMetaModel(),
        rowBindingPath = model.resolve(table.getRowBinding().getPath(), table.getRowBinding().getContext()),
        metaContext = metaModel.getMetaContext(rowBindingPath);
      return table.getControlDelegate().fetchProperties(table).then(propertyInfo => {
        const PropertyInfoDict = Object.assign({}, ...propertyInfo.map(property => ({
          [property.name]: property
        })));
        const columnInfos = [];
        table.getColumns().forEach(column => {
          const infoProperty = PropertyInfoDict[column.getDataProperty()];
          // Check if it's a complex property (property associated to multiple simple properties)
          if (infoProperty.propertyInfos) {
            // Get data from simple property
            infoProperty.propertyInfos.forEach(property => {
              const dataProperty = PropertyInfoDict[property];
              // Non exported columns should be parte of the columnInfos
              if (dataProperty.exportSettings !== null) {
                // Check a navigation property within the current Complex property --> ignore
                if (property.indexOf("/") > -1) {
                  columnInfos.push({
                    property: dataProperty.path,
                    ignore: true
                  });
                } else {
                  columnInfos.push(this.getInfoForEntityProperty(dataProperty.path, rowBindingPath, metaContext, metaModel));
                }
              }
            });
            if (infoProperty.exportDataPointTargetValue) {
              columnInfos.push({
                property: "targetValueFromDataPoint",
                ignore: true
              });
            }
            // Non exported columns should be parte of the columnInfos
          } else if (infoProperty.exportSettings !== null) {
            if (infoProperty.path) {
              columnInfos.push(this.getInfoForEntityProperty(infoProperty.path, rowBindingPath, metaContext, metaModel));
            } else {
              // Empty column --> ignore
              columnInfos.push({
                property: "unused",
                type: null,
                ignore: true
              });
            }
          }
        });
        return columnInfos;
      });
    },
    getInfoForEntityProperty: getInfoForEntityProperty,
    parsePastedData: function (rawData, table) {
      return this.getColumnInfo(table).then(function (pasteInfos) {
        // Check if we have data for at least the first editable column
        const pastedColumnCount = rawData.length ? rawData[0].length : 0;
        let firstEditableColumnIndex = -1;
        for (let I = 0; I < pasteInfos.length && firstEditableColumnIndex < 0; I++) {
          if (!pasteInfos[I].ignore) {
            firstEditableColumnIndex = I;
          }
        }
        return firstEditableColumnIndex < 0 || firstEditableColumnIndex > pastedColumnCount - 1 ? Promise.resolve({}) // We don't have data for an editable column --> return empty parsed data
        : CorePasteHelper.parse(rawData, pasteInfos);
      }).then(parseResult => {
        if (parseResult.errors) {
          const errorMessages = parseResult.errors.map(function (oElement) {
            return oElement.message;
          });
          this.displayErrorMessages(errorMessages);
          return []; // Errors --> return nothing
        } else {
          return parseResult.parsedData ? parseResult.parsedData : [];
        }
      });
    },
    pasteData: function (rawData, table, controller) {
      const oInternalEditFlow = controller._editFlow;
      const tableDefinition = table.getParent().getTableDefinition();
      let aData = [];
      return this.parsePastedData(rawData, table).then(aParsedData => {
        aData = aParsedData || [];
        return Promise.all(aData.map(mData => {
          var _tableDefinition$cont;
          return oInternalEditFlow.getTransactionHelper().validateDocument(table.getBindingContext(), {
            data: mData,
            customValidationFunction: tableDefinition === null || tableDefinition === void 0 ? void 0 : (_tableDefinition$cont = tableDefinition.control) === null || _tableDefinition$cont === void 0 ? void 0 : _tableDefinition$cont.customValidationFunction
          }, controller.getView());
        }));
      }).then(aValidationMessages => {
        const aErrorMessages = aValidationMessages.reduce(function (aMessages, aCustomMessages, index) {
          if (aCustomMessages.length > 0) {
            aMessages.push({
              messages: aCustomMessages,
              row: index + 1
            });
          }
          return aMessages;
        }, []);
        if (aErrorMessages.length > 0) {
          const aRowMessages = aErrorMessages.map(mError => this.formatCustomMessage(mError.messages, mError.row));
          this.displayErrorMessages(aRowMessages);
          return [];
        }
        return aData;
      }).then(aValidatedData => {
        var _tableDefinition$cont2;
        return aValidatedData.length > 0 ? oInternalEditFlow.createMultipleDocuments(table.getRowBinding(), aValidatedData, tableDefinition === null || tableDefinition === void 0 ? void 0 : (_tableDefinition$cont2 = tableDefinition.control) === null || _tableDefinition$cont2 === void 0 ? void 0 : _tableDefinition$cont2.createAtEnd, true, controller.editFlow.onBeforeCreate) : undefined;
      }).catch(oError => {
        Log.error("Error while pasting data", oError);
      });
    }
  };
  return PasteHelper;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRJbmZvRm9yRW50aXR5UHJvcGVydHkiLCJwcm9wZXJ0eVBhdGgiLCJyb3dCaW5kaW5nUGF0aCIsIm1ldGFDb250ZXh0IiwibWV0YU1vZGVsIiwicHJvcGVydHkiLCJnZXRQcm9wZXJ0eSIsImZvcm1hdE9wdGlvbnMiLCJwYXJzZUtlZXBzRW1wdHlTdHJpbmciLCJ0eXBlIiwiZ2V0VUk1VHlwZSIsImlzSWdub3JlZCIsImlnbm9yZSIsImRpc3BsYXlFcnJvck1lc3NhZ2VzIiwiZXJyb3JNZXNzYWdlcyIsIm1lc3NhZ2VEZXRhaWxzIiwicmVzb3VyY2VCdW5kbGUiLCJDb3JlIiwiZ2V0TGlicmFyeVJlc291cmNlQnVuZGxlIiwiZXJyb3JDb3JyZWN0aW9uTWVzc2FnZSIsImdldFRleHQiLCJub3RlTWVzc2FnZSIsInBhc3RlRXJyb3JNZXNzYWdlIiwibGVuZ3RoIiwidW5zaGlmdCIsIk1lc3NhZ2VCb3giLCJlcnJvciIsInRpdGxlIiwiZGV0YWlscyIsImpvaW4iLCJQYXN0ZUhlbHBlciIsImZvcm1hdEN1c3RvbU1lc3NhZ2UiLCJ2YWxpZGF0aW9uTWVzc2FnZXMiLCJpUm93TnVtYmVyIiwiZXJyb3JNZXNzYWdlIiwibnVtYmVyTWVzc2FnZXMiLCJpMThuUm93IiwiZm9yRWFjaCIsIm1lc3NhZ2UiLCJpbmRleE1lc3NhZ2UiLCJtZXNzYWdlVGV4dCIsImdldENvbHVtbkluZm8iLCJ0YWJsZSIsIm1vZGVsIiwiZ2V0Um93QmluZGluZyIsImdldE1vZGVsIiwiZ2V0TWV0YU1vZGVsIiwicmVzb2x2ZSIsImdldFBhdGgiLCJnZXRDb250ZXh0IiwiZ2V0TWV0YUNvbnRleHQiLCJnZXRDb250cm9sRGVsZWdhdGUiLCJmZXRjaFByb3BlcnRpZXMiLCJ0aGVuIiwicHJvcGVydHlJbmZvIiwiUHJvcGVydHlJbmZvRGljdCIsIk9iamVjdCIsImFzc2lnbiIsIm1hcCIsIm5hbWUiLCJjb2x1bW5JbmZvcyIsImdldENvbHVtbnMiLCJjb2x1bW4iLCJpbmZvUHJvcGVydHkiLCJnZXREYXRhUHJvcGVydHkiLCJwcm9wZXJ0eUluZm9zIiwiZGF0YVByb3BlcnR5IiwiZXhwb3J0U2V0dGluZ3MiLCJpbmRleE9mIiwicHVzaCIsInBhdGgiLCJleHBvcnREYXRhUG9pbnRUYXJnZXRWYWx1ZSIsInBhcnNlUGFzdGVkRGF0YSIsInJhd0RhdGEiLCJwYXN0ZUluZm9zIiwicGFzdGVkQ29sdW1uQ291bnQiLCJmaXJzdEVkaXRhYmxlQ29sdW1uSW5kZXgiLCJJIiwiUHJvbWlzZSIsIkNvcmVQYXN0ZUhlbHBlciIsInBhcnNlIiwicGFyc2VSZXN1bHQiLCJlcnJvcnMiLCJvRWxlbWVudCIsInBhcnNlZERhdGEiLCJwYXN0ZURhdGEiLCJjb250cm9sbGVyIiwib0ludGVybmFsRWRpdEZsb3ciLCJfZWRpdEZsb3ciLCJ0YWJsZURlZmluaXRpb24iLCJnZXRQYXJlbnQiLCJnZXRUYWJsZURlZmluaXRpb24iLCJhRGF0YSIsImFQYXJzZWREYXRhIiwiYWxsIiwibURhdGEiLCJnZXRUcmFuc2FjdGlvbkhlbHBlciIsInZhbGlkYXRlRG9jdW1lbnQiLCJnZXRCaW5kaW5nQ29udGV4dCIsImRhdGEiLCJjdXN0b21WYWxpZGF0aW9uRnVuY3Rpb24iLCJjb250cm9sIiwiZ2V0VmlldyIsImFWYWxpZGF0aW9uTWVzc2FnZXMiLCJhRXJyb3JNZXNzYWdlcyIsInJlZHVjZSIsImFNZXNzYWdlcyIsImFDdXN0b21NZXNzYWdlcyIsImluZGV4IiwibWVzc2FnZXMiLCJyb3ciLCJhUm93TWVzc2FnZXMiLCJtRXJyb3IiLCJhVmFsaWRhdGVkRGF0YSIsImNyZWF0ZU11bHRpcGxlRG9jdW1lbnRzIiwiY3JlYXRlQXRFbmQiLCJlZGl0RmxvdyIsIm9uQmVmb3JlQ3JlYXRlIiwidW5kZWZpbmVkIiwiY2F0Y2giLCJvRXJyb3IiLCJMb2ciXSwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIlBhc3RlSGVscGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2cgZnJvbSBcInNhcC9iYXNlL0xvZ1wiO1xuaW1wb3J0IHR5cGUgUGFnZUNvbnRyb2xsZXIgZnJvbSBcInNhcC9mZS9jb3JlL1BhZ2VDb250cm9sbGVyXCI7XG5pbXBvcnQgTWVzc2FnZUJveCBmcm9tIFwic2FwL20vTWVzc2FnZUJveFwiO1xuaW1wb3J0IENvcmUgZnJvbSBcInNhcC91aS9jb3JlL0NvcmVcIjtcbmltcG9ydCAqIGFzIENvcmVQYXN0ZUhlbHBlciBmcm9tIFwic2FwL3VpL2NvcmUvdXRpbC9QYXN0ZUhlbHBlclwiO1xuXG5leHBvcnQgdHlwZSBjdXN0b21WYWxpZGF0aW9uTWVzc2FnZSA9IHtcblx0bWVzc2FnZVRleHQ/OiBzdHJpbmc7XG5cdG1lc3NhZ2VUYXJnZXQ/OiBzdHJpbmc7XG59O1xuXG5jb25zdCBnZXRJbmZvRm9yRW50aXR5UHJvcGVydHkgPSBmdW5jdGlvbiAocHJvcGVydHlQYXRoOiBhbnksIHJvd0JpbmRpbmdQYXRoOiBhbnksIG1ldGFDb250ZXh0OiBhbnksIG1ldGFNb2RlbDogYW55KTogYW55IHtcblx0Y29uc3QgcHJvcGVydHkgPSBtZXRhQ29udGV4dC5nZXRQcm9wZXJ0eShwcm9wZXJ0eVBhdGgpLFxuXHRcdGZvcm1hdE9wdGlvbnMgPSB7IHBhcnNlS2VlcHNFbXB0eVN0cmluZzogdHJ1ZSB9LFxuXHRcdHR5cGUgPSBtZXRhTW9kZWwuZ2V0VUk1VHlwZShgJHtyb3dCaW5kaW5nUGF0aH0vJHtwcm9wZXJ0eVBhdGh9YCwgZm9ybWF0T3B0aW9ucyksXG5cdFx0aXNJZ25vcmVkID0gIXByb3BlcnR5IHx8IG1ldGFDb250ZXh0LmdldFByb3BlcnR5KGAke3Byb3BlcnR5UGF0aH1AT3JnLk9EYXRhLkNvcmUuVjEuQ29tcHV0ZWRgKTtcblx0cmV0dXJuIHtcblx0XHRwcm9wZXJ0eTogcHJvcGVydHlQYXRoLFxuXHRcdGlnbm9yZTogaXNJZ25vcmVkLFxuXHRcdHR5cGU6IHR5cGVcblx0fTtcbn07XG5cbmNvbnN0IGRpc3BsYXlFcnJvck1lc3NhZ2VzID0gZnVuY3Rpb24gKGVycm9yTWVzc2FnZXM6IHN0cmluZ1tdKTogdm9pZCB7XG5cdGNvbnN0IG1lc3NhZ2VEZXRhaWxzID0gWy4uLmVycm9yTWVzc2FnZXNdO1xuXHRjb25zdCByZXNvdXJjZUJ1bmRsZSA9IENvcmUuZ2V0TGlicmFyeVJlc291cmNlQnVuZGxlKFwic2FwLmZlLmNvcmVcIiksXG5cdFx0ZXJyb3JDb3JyZWN0aW9uTWVzc2FnZSA9IHJlc291cmNlQnVuZGxlLmdldFRleHQoXCJDX1BBU1RFX0hFTFBFUl9TQVBGRV9QQVNURV9FUlJPUl9DT1JSRUNUSU9OX01FU1NBR0VcIiksXG5cdFx0bm90ZU1lc3NhZ2UgPSByZXNvdXJjZUJ1bmRsZS5nZXRUZXh0KFwiQ19QQVNURV9IRUxQRVJfU0FQRkVfUEFTVEVfRVJST1JfQ09SUkVDVElPTl9OT1RFXCIpO1xuXHRsZXQgcGFzdGVFcnJvck1lc3NhZ2U7XG5cblx0aWYgKG1lc3NhZ2VEZXRhaWxzLmxlbmd0aCA+IDEpIHtcblx0XHRwYXN0ZUVycm9yTWVzc2FnZSA9IHJlc291cmNlQnVuZGxlLmdldFRleHQoXCJDX1BBU1RFX0hFTFBFUl9TQVBGRV9QQVNURV9FUlJPUl9NRVNTQUdFX1BMVVJBTFwiLCBbbWVzc2FnZURldGFpbHMubGVuZ3RoXSk7XG5cdH0gZWxzZSB7XG5cdFx0cGFzdGVFcnJvck1lc3NhZ2UgPSByZXNvdXJjZUJ1bmRsZS5nZXRUZXh0KFwiQ19QQVNURV9IRUxQRVJfU0FQRkVfUEFTVEVfRVJST1JfTUVTU0FHRV9TSU5HVUxBUlwiKTtcblx0fVxuXHRtZXNzYWdlRGV0YWlscy51bnNoaWZ0KFwiXCIpOyAvLyBUbyBzaG93IHNwYWNlIGJldHdlZW4gdGhlIHNob3J0IHRleHQgYW5kIHRoZSBsaXN0IG9mIGVycm9yc1xuXHRtZXNzYWdlRGV0YWlscy51bnNoaWZ0KG5vdGVNZXNzYWdlKTtcblx0bWVzc2FnZURldGFpbHMudW5zaGlmdChlcnJvckNvcnJlY3Rpb25NZXNzYWdlKTtcblx0TWVzc2FnZUJveC5lcnJvcihwYXN0ZUVycm9yTWVzc2FnZSwge1xuXHRcdHRpdGxlOiByZXNvdXJjZUJ1bmRsZS5nZXRUZXh0KFwiQ19DT01NT05fU0FQRkVfRVJST1JfTUVTU0FHRVNfUEFHRV9USVRMRV9FUlJPUlwiKSxcblx0XHRkZXRhaWxzOiBtZXNzYWdlRGV0YWlscy5qb2luKFwiPGJyPlwiKVxuXHR9KTtcbn07XG5cbmNvbnN0IFBhc3RlSGVscGVyID0ge1xuXHRkaXNwbGF5RXJyb3JNZXNzYWdlczogZGlzcGxheUVycm9yTWVzc2FnZXMsXG5cdGZvcm1hdEN1c3RvbU1lc3NhZ2U6IGZ1bmN0aW9uICh2YWxpZGF0aW9uTWVzc2FnZXM6IGN1c3RvbVZhbGlkYXRpb25NZXNzYWdlW10sIGlSb3dOdW1iZXI6IG51bWJlcik6IHN0cmluZyB7XG5cdFx0bGV0IGVycm9yTWVzc2FnZSA9IFwiXCI7XG5cdFx0Y29uc3QgbnVtYmVyTWVzc2FnZXMgPSB2YWxpZGF0aW9uTWVzc2FnZXMubGVuZ3RoO1xuXHRcdGNvbnN0IHJlc291cmNlQnVuZGxlID0gQ29yZS5nZXRMaWJyYXJ5UmVzb3VyY2VCdW5kbGUoXCJzYXAuZmUuY29yZVwiKSxcblx0XHRcdGkxOG5Sb3cgPSByZXNvdXJjZUJ1bmRsZS5nZXRUZXh0KFwiVF9NRVNTQUdFX0dST1VQX0RFU0NSSVBUSU9OX1RBQkxFX1JPV1wiKTtcblx0XHRpZiAobnVtYmVyTWVzc2FnZXMgPiAwKSB7XG5cdFx0XHRlcnJvck1lc3NhZ2UgKz0gYCR7aTE4blJvd30gJHtpUm93TnVtYmVyfTogYDtcblx0XHRcdHZhbGlkYXRpb25NZXNzYWdlcy5mb3JFYWNoKChtZXNzYWdlLCBpbmRleE1lc3NhZ2UpID0+IHtcblx0XHRcdFx0aWYgKG1lc3NhZ2UubWVzc2FnZVRleHQpIHtcblx0XHRcdFx0XHRlcnJvck1lc3NhZ2UgKz0gbWVzc2FnZS5tZXNzYWdlVGV4dCArIChpbmRleE1lc3NhZ2UgKyAxICE9PSBudW1iZXJNZXNzYWdlcyA/IFwiIFwiIDogXCJcIik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gZXJyb3JNZXNzYWdlO1xuXHR9LFxuXHRnZXRDb2x1bW5JbmZvOiBmdW5jdGlvbiAodGFibGU6IGFueSk6IFByb21pc2U8YW55W10+IHtcblx0XHRjb25zdCBtb2RlbCA9IHRhYmxlLmdldFJvd0JpbmRpbmcoKS5nZXRNb2RlbCgpLFxuXHRcdFx0bWV0YU1vZGVsID0gbW9kZWwuZ2V0TWV0YU1vZGVsKCksXG5cdFx0XHRyb3dCaW5kaW5nUGF0aCA9IG1vZGVsLnJlc29sdmUodGFibGUuZ2V0Um93QmluZGluZygpLmdldFBhdGgoKSwgdGFibGUuZ2V0Um93QmluZGluZygpLmdldENvbnRleHQoKSksXG5cdFx0XHRtZXRhQ29udGV4dCA9IG1ldGFNb2RlbC5nZXRNZXRhQ29udGV4dChyb3dCaW5kaW5nUGF0aCk7XG5cdFx0cmV0dXJuIHRhYmxlXG5cdFx0XHQuZ2V0Q29udHJvbERlbGVnYXRlKClcblx0XHRcdC5mZXRjaFByb3BlcnRpZXModGFibGUpXG5cdFx0XHQudGhlbigocHJvcGVydHlJbmZvOiBhbnkpID0+IHtcblx0XHRcdFx0Y29uc3QgUHJvcGVydHlJbmZvRGljdCA9IE9iamVjdC5hc3NpZ24oe30sIC4uLnByb3BlcnR5SW5mby5tYXAoKHByb3BlcnR5OiBhbnkpID0+ICh7IFtwcm9wZXJ0eS5uYW1lXTogcHJvcGVydHkgfSkpKTtcblx0XHRcdFx0Y29uc3QgY29sdW1uSW5mb3M6IGFueVtdID0gW107XG5cdFx0XHRcdHRhYmxlLmdldENvbHVtbnMoKS5mb3JFYWNoKChjb2x1bW46IGFueSkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGluZm9Qcm9wZXJ0eSA9IFByb3BlcnR5SW5mb0RpY3RbY29sdW1uLmdldERhdGFQcm9wZXJ0eSgpXTtcblx0XHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgY29tcGxleCBwcm9wZXJ0eSAocHJvcGVydHkgYXNzb2NpYXRlZCB0byBtdWx0aXBsZSBzaW1wbGUgcHJvcGVydGllcylcblx0XHRcdFx0XHRpZiAoaW5mb1Byb3BlcnR5LnByb3BlcnR5SW5mb3MpIHtcblx0XHRcdFx0XHRcdC8vIEdldCBkYXRhIGZyb20gc2ltcGxlIHByb3BlcnR5XG5cdFx0XHRcdFx0XHRpbmZvUHJvcGVydHkucHJvcGVydHlJbmZvcy5mb3JFYWNoKChwcm9wZXJ0eTogYW55KSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGRhdGFQcm9wZXJ0eSA9IFByb3BlcnR5SW5mb0RpY3RbcHJvcGVydHldO1xuXHRcdFx0XHRcdFx0XHQvLyBOb24gZXhwb3J0ZWQgY29sdW1ucyBzaG91bGQgYmUgcGFydGUgb2YgdGhlIGNvbHVtbkluZm9zXG5cdFx0XHRcdFx0XHRcdGlmIChkYXRhUHJvcGVydHkuZXhwb3J0U2V0dGluZ3MgIT09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBDaGVjayBhIG5hdmlnYXRpb24gcHJvcGVydHkgd2l0aGluIHRoZSBjdXJyZW50IENvbXBsZXggcHJvcGVydHkgLS0+IGlnbm9yZVxuXHRcdFx0XHRcdFx0XHRcdGlmIChwcm9wZXJ0eS5pbmRleE9mKFwiL1wiKSA+IC0xKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb2x1bW5JbmZvcy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cHJvcGVydHk6IGRhdGFQcm9wZXJ0eS5wYXRoLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZ25vcmU6IHRydWVcblx0XHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb2x1bW5JbmZvcy5wdXNoKFxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLmdldEluZm9Gb3JFbnRpdHlQcm9wZXJ0eShkYXRhUHJvcGVydHkucGF0aCwgcm93QmluZGluZ1BhdGgsIG1ldGFDb250ZXh0LCBtZXRhTW9kZWwpXG5cdFx0XHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRpZiAoaW5mb1Byb3BlcnR5LmV4cG9ydERhdGFQb2ludFRhcmdldFZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdGNvbHVtbkluZm9zLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRcdHByb3BlcnR5OiBcInRhcmdldFZhbHVlRnJvbURhdGFQb2ludFwiLFxuXHRcdFx0XHRcdFx0XHRcdGlnbm9yZTogdHJ1ZVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdC8vIE5vbiBleHBvcnRlZCBjb2x1bW5zIHNob3VsZCBiZSBwYXJ0ZSBvZiB0aGUgY29sdW1uSW5mb3Ncblx0XHRcdFx0XHR9IGVsc2UgaWYgKGluZm9Qcm9wZXJ0eS5leHBvcnRTZXR0aW5ncyAhPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0aWYgKGluZm9Qcm9wZXJ0eS5wYXRoKSB7XG5cdFx0XHRcdFx0XHRcdGNvbHVtbkluZm9zLnB1c2godGhpcy5nZXRJbmZvRm9yRW50aXR5UHJvcGVydHkoaW5mb1Byb3BlcnR5LnBhdGgsIHJvd0JpbmRpbmdQYXRoLCBtZXRhQ29udGV4dCwgbWV0YU1vZGVsKSk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBFbXB0eSBjb2x1bW4gLS0+IGlnbm9yZVxuXHRcdFx0XHRcdFx0XHRjb2x1bW5JbmZvcy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0XHRwcm9wZXJ0eTogXCJ1bnVzZWRcIixcblx0XHRcdFx0XHRcdFx0XHR0eXBlOiBudWxsLFxuXHRcdFx0XHRcdFx0XHRcdGlnbm9yZTogdHJ1ZVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRyZXR1cm4gY29sdW1uSW5mb3M7XG5cdFx0XHR9KTtcblx0fSxcblx0Z2V0SW5mb0ZvckVudGl0eVByb3BlcnR5OiBnZXRJbmZvRm9yRW50aXR5UHJvcGVydHksXG5cblx0cGFyc2VQYXN0ZWREYXRhOiBmdW5jdGlvbiAocmF3RGF0YTogYW55LCB0YWJsZTogYW55KTogUHJvbWlzZTxhbnlbXT4ge1xuXHRcdHJldHVybiB0aGlzLmdldENvbHVtbkluZm8odGFibGUpXG5cdFx0XHQudGhlbihmdW5jdGlvbiAocGFzdGVJbmZvczogYW55W10pIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgd2UgaGF2ZSBkYXRhIGZvciBhdCBsZWFzdCB0aGUgZmlyc3QgZWRpdGFibGUgY29sdW1uXG5cdFx0XHRcdGNvbnN0IHBhc3RlZENvbHVtbkNvdW50ID0gcmF3RGF0YS5sZW5ndGggPyByYXdEYXRhWzBdLmxlbmd0aCA6IDA7XG5cdFx0XHRcdGxldCBmaXJzdEVkaXRhYmxlQ29sdW1uSW5kZXggPSAtMTtcblx0XHRcdFx0Zm9yIChsZXQgSSA9IDA7IEkgPCBwYXN0ZUluZm9zLmxlbmd0aCAmJiBmaXJzdEVkaXRhYmxlQ29sdW1uSW5kZXggPCAwOyBJKyspIHtcblx0XHRcdFx0XHRpZiAoIXBhc3RlSW5mb3NbSV0uaWdub3JlKSB7XG5cdFx0XHRcdFx0XHRmaXJzdEVkaXRhYmxlQ29sdW1uSW5kZXggPSBJO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmlyc3RFZGl0YWJsZUNvbHVtbkluZGV4IDwgMCB8fCBmaXJzdEVkaXRhYmxlQ29sdW1uSW5kZXggPiBwYXN0ZWRDb2x1bW5Db3VudCAtIDFcblx0XHRcdFx0XHQ/IFByb21pc2UucmVzb2x2ZSh7fSkgLy8gV2UgZG9uJ3QgaGF2ZSBkYXRhIGZvciBhbiBlZGl0YWJsZSBjb2x1bW4gLS0+IHJldHVybiBlbXB0eSBwYXJzZWQgZGF0YVxuXHRcdFx0XHRcdDogKENvcmVQYXN0ZUhlbHBlciBhcyBhbnkpLnBhcnNlKHJhd0RhdGEsIHBhc3RlSW5mb3MpO1xuXHRcdFx0fSlcblx0XHRcdC50aGVuKChwYXJzZVJlc3VsdDogYW55KSA9PiB7XG5cdFx0XHRcdGlmIChwYXJzZVJlc3VsdC5lcnJvcnMpIHtcblx0XHRcdFx0XHRjb25zdCBlcnJvck1lc3NhZ2VzID0gcGFyc2VSZXN1bHQuZXJyb3JzLm1hcChmdW5jdGlvbiAob0VsZW1lbnQ6IGFueSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG9FbGVtZW50Lm1lc3NhZ2U7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0dGhpcy5kaXNwbGF5RXJyb3JNZXNzYWdlcyhlcnJvck1lc3NhZ2VzKTtcblx0XHRcdFx0XHRyZXR1cm4gW107IC8vIEVycm9ycyAtLT4gcmV0dXJuIG5vdGhpbmdcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gcGFyc2VSZXN1bHQucGFyc2VkRGF0YSA/IHBhcnNlUmVzdWx0LnBhcnNlZERhdGEgOiBbXTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdH0sXG5cdHBhc3RlRGF0YTogZnVuY3Rpb24gKHJhd0RhdGE6IGFueSwgdGFibGU6IGFueSwgY29udHJvbGxlcjogUGFnZUNvbnRyb2xsZXIpOiBQcm9taXNlPGFueT4ge1xuXHRcdGNvbnN0IG9JbnRlcm5hbEVkaXRGbG93ID0gKGNvbnRyb2xsZXIgYXMgYW55KS5fZWRpdEZsb3c7XG5cdFx0Y29uc3QgdGFibGVEZWZpbml0aW9uID0gdGFibGUuZ2V0UGFyZW50KCkuZ2V0VGFibGVEZWZpbml0aW9uKCk7XG5cdFx0bGV0IGFEYXRhOiBhbnlbXSA9IFtdO1xuXHRcdHJldHVybiB0aGlzLnBhcnNlUGFzdGVkRGF0YShyYXdEYXRhLCB0YWJsZSlcblx0XHRcdC50aGVuKChhUGFyc2VkRGF0YSkgPT4ge1xuXHRcdFx0XHRhRGF0YSA9IGFQYXJzZWREYXRhIHx8IFtdO1xuXHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5hbGwoXG5cdFx0XHRcdFx0YURhdGEubWFwKChtRGF0YSkgPT5cblx0XHRcdFx0XHRcdG9JbnRlcm5hbEVkaXRGbG93LmdldFRyYW5zYWN0aW9uSGVscGVyKCkudmFsaWRhdGVEb2N1bWVudChcblx0XHRcdFx0XHRcdFx0dGFibGUuZ2V0QmluZGluZ0NvbnRleHQoKSxcblx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdGRhdGE6IG1EYXRhLFxuXHRcdFx0XHRcdFx0XHRcdGN1c3RvbVZhbGlkYXRpb25GdW5jdGlvbjogdGFibGVEZWZpbml0aW9uPy5jb250cm9sPy5jdXN0b21WYWxpZGF0aW9uRnVuY3Rpb25cblx0XHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdFx0Y29udHJvbGxlci5nZXRWaWV3KClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdCk7XG5cdFx0XHR9KVxuXHRcdFx0LnRoZW4oKGFWYWxpZGF0aW9uTWVzc2FnZXMpID0+IHtcblx0XHRcdFx0Y29uc3QgYUVycm9yTWVzc2FnZXMgPSBhVmFsaWRhdGlvbk1lc3NhZ2VzLnJlZHVjZShmdW5jdGlvbiAoYU1lc3NhZ2VzLCBhQ3VzdG9tTWVzc2FnZXMsIGluZGV4KSB7XG5cdFx0XHRcdFx0aWYgKGFDdXN0b21NZXNzYWdlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRhTWVzc2FnZXMucHVzaCh7IG1lc3NhZ2VzOiBhQ3VzdG9tTWVzc2FnZXMsIHJvdzogaW5kZXggKyAxIH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gYU1lc3NhZ2VzO1xuXHRcdFx0XHR9LCBbXSk7XG5cdFx0XHRcdGlmIChhRXJyb3JNZXNzYWdlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Y29uc3QgYVJvd01lc3NhZ2VzID0gYUVycm9yTWVzc2FnZXMubWFwKChtRXJyb3I6IGFueSkgPT4gdGhpcy5mb3JtYXRDdXN0b21NZXNzYWdlKG1FcnJvci5tZXNzYWdlcywgbUVycm9yLnJvdykpO1xuXHRcdFx0XHRcdHRoaXMuZGlzcGxheUVycm9yTWVzc2FnZXMoYVJvd01lc3NhZ2VzKTtcblx0XHRcdFx0XHRyZXR1cm4gW107XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGFEYXRhO1xuXHRcdFx0fSlcblx0XHRcdC50aGVuKChhVmFsaWRhdGVkRGF0YSkgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYVZhbGlkYXRlZERhdGEubGVuZ3RoID4gMFxuXHRcdFx0XHRcdD8gb0ludGVybmFsRWRpdEZsb3cuY3JlYXRlTXVsdGlwbGVEb2N1bWVudHMoXG5cdFx0XHRcdFx0XHRcdHRhYmxlLmdldFJvd0JpbmRpbmcoKSxcblx0XHRcdFx0XHRcdFx0YVZhbGlkYXRlZERhdGEsXG5cdFx0XHRcdFx0XHRcdHRhYmxlRGVmaW5pdGlvbj8uY29udHJvbD8uY3JlYXRlQXRFbmQsXG5cdFx0XHRcdFx0XHRcdHRydWUsXG5cdFx0XHRcdFx0XHRcdChjb250cm9sbGVyIGFzIGFueSkuZWRpdEZsb3cub25CZWZvcmVDcmVhdGVcblx0XHRcdFx0XHQgIClcblx0XHRcdFx0XHQ6IHVuZGVmaW5lZDtcblx0XHRcdH0pXG5cdFx0XHQuY2F0Y2goKG9FcnJvcikgPT4ge1xuXHRcdFx0XHRMb2cuZXJyb3IoXCJFcnJvciB3aGlsZSBwYXN0aW5nIGRhdGFcIiwgb0Vycm9yKTtcblx0XHRcdH0pO1xuXHR9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBQYXN0ZUhlbHBlcjtcbiJdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQUE7QUFBQTs7OztFQVdBLE1BQU1BLHdCQUF3QixHQUFHLFVBQVVDLFlBQWlCLEVBQUVDLGNBQW1CLEVBQUVDLFdBQWdCLEVBQUVDLFNBQWMsRUFBTztJQUN6SCxNQUFNQyxRQUFRLEdBQUdGLFdBQVcsQ0FBQ0csV0FBVyxDQUFDTCxZQUFZLENBQUM7TUFDckRNLGFBQWEsR0FBRztRQUFFQyxxQkFBcUIsRUFBRTtNQUFLLENBQUM7TUFDL0NDLElBQUksR0FBR0wsU0FBUyxDQUFDTSxVQUFVLENBQUUsR0FBRVIsY0FBZSxJQUFHRCxZQUFhLEVBQUMsRUFBRU0sYUFBYSxDQUFDO01BQy9FSSxTQUFTLEdBQUcsQ0FBQ04sUUFBUSxJQUFJRixXQUFXLENBQUNHLFdBQVcsQ0FBRSxHQUFFTCxZQUFhLDZCQUE0QixDQUFDO0lBQy9GLE9BQU87TUFDTkksUUFBUSxFQUFFSixZQUFZO01BQ3RCVyxNQUFNLEVBQUVELFNBQVM7TUFDakJGLElBQUksRUFBRUE7SUFDUCxDQUFDO0VBQ0YsQ0FBQztFQUVELE1BQU1JLG9CQUFvQixHQUFHLFVBQVVDLGFBQXVCLEVBQVE7SUFDckUsTUFBTUMsY0FBYyxHQUFH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