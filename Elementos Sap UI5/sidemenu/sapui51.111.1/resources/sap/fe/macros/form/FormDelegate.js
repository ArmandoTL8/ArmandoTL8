/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/macros/CommonHelper","sap/fe/macros/DelegateUtil","sap/ui/model/json/JSONModel","sap/ui/model/ListBinding"],function(e,t,o,n){"use strict";const a={createLayout:async function(n){var a;const i=n.modifier,r=(a=n.appComponent)===null||a===void 0?void 0:a.getMetaModel(),s=n.element;let l=await t.getCustomData(s,"entitySet",i);if(!l){l=await t.getCustomData(s,"navigationPath",i)}const c=l.startsWith("/")?`${l}`:`/${l}`;const d=n.parentSelector?n.modifier.bySelector(n.parentSelector,n.appComponent,n.view):undefined;const u=await t.getCustomData(d,"navigationPath",i);const m=u?`${c}/${u}`:c;const p=r===null||r===void 0?void 0:r.getMetaContext(m);const v=r===null||r===void 0?void 0:r.createBindingContext(`${m}/${n.bindingPath}`);const f=n.element.sId||n.element.id;const g={sPropertyName:n.bindingPath,sBindingPath:m,sValueHelpType:"FormVH",oControl:s,oMetaModel:r,oModifier:i};function h(e){var a;const s=new o({id:f,idPrefix:(a=n.fieldSelector)===null||a===void 0?void 0:a.id}),l={bindingContexts:{entitySet:p,contextPath:p,property:v,this:s.createBindingContext("/")},models:{this:s,entitySet:r,contextPath:r,metaModel:r,property:r}};return t.templateControlFragment(e,l,{},i)}async function y(a,l,c){var d;const u=await t.getCustomData(s,"onChange",i);const m=await t.getCustomData(s,"displayMode",i);const f=new o({_flexId:(d=n.fieldSelector)===null||d===void 0?void 0:d.id,onChange:e.removeEscapeCharacters(u),displayMode:e.removeEscapeCharacters(m),navigationPath:c});const g={bindingContexts:{entitySet:p,dataField:v,this:f.createBindingContext("/")},models:{this:f,entitySet:r,metaModel:r,dataField:r}};return t.templateControlFragment(a,g,{view:l},i)}const C=await t.isValueHelpRequired(g);const P=await t.doesValueHelpExist(g);let b;if(C&&!P){b=await h("sap.fe.macros.form.ValueHelpWrapper")}const F=await y("sap.fe.macros.form.FormElementFlexibility",n.view,u);return{control:F,valueHelp:b}},getPropertyInfo:function(e){function t(e){if(e&&e.$Type){if(e.$Type.toLowerCase().indexOf("edm")!==0){return true}}return false}function o(e,t){return t.some(function(t){return e.startsWith(t)})}function a(e,a,i,r,s,l,c){const d={name:e,bindingPath:e,entityType:r};const u=i["@com.sap.vocabularies.UI.v1.DataFieldDefault"];const m=u&&u.Label||i["@com.sap.vocabularies.Common.v1.Label"];d.label=m||"[LABEL_MISSING: "+e+"]";const p=i["@com.sap.vocabularies.UI.v1.Hidden"];d.hideFromReveal=p;if(p&&p.$Path){var v;d.hideFromReveal=(v=s.getBindingContext())===null||v===void 0?void 0:v.getProperty(p.$Path)}let f;if(!d.hideFromReveal){f=i["@com.sap.vocabularies.Common.v1.FieldControl"];if(f){d.hideFromReveal=f.$EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"}}f=i["@com.sap.vocabularies.Common.v1.FieldControl"];const g=f&&f.Path;if(g&&!d.hideFromReveal){const e=s.getBinding(l)instanceof n;if(!e){var h;const e=(h=s.getBindingContext())===null||h===void 0?void 0:h.getProperty(g);d.hideFromReveal=e===0}}if(u&&(u.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||u.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||u.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction"||u.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation")){d.unsupported=true}if(o(e,c)||t(a)){d.unsupported=true}return d}function i(e,t,o,n,i){const r=[];let s="";const l=[];let c;for(s in e){c=e[s];if(c.$kind==="NavigationProperty"){l.push(s)}}for(s in e){c=e[s];if(c.$kind==="Property"){const e=o.getObject("/"+t+"/"+s+"@");const d=a(s,c,e,t,n,i,l);r.push(d)}}return r}function r(e,t){if(t.path){return t.path}const o=e.getBindingContext();if(o){if(e.data("navigationPath")){return o.getPath()+"/"+e.data("navigationPath")}return o.getPath()}}function s(e,t,o){const n=e.getModel(o.modelName);if(n){if(n.isA("sap.ui.model.odata.v4.ODataModel")){const a=n.getMetaModel();const s=r(e,o);if(s){const o=a.getMetaContext(s);const n=o.getObject();const r=o.getObject(n.$Type);return i(r,n.$Type,a,e,t)}}}return Promise.resolve([])}return Promise.resolve().then(function(){return s(e.element,e.aggregationName,e.payload)})}};return a},false);
//# sourceMappingURL=FormDelegate.js.map