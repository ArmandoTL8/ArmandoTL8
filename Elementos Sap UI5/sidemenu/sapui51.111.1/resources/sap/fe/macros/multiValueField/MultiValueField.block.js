/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/buildingBlocks/BuildingBlockRuntime","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyFormatters","sap/fe/core/templating/UIFormatters","sap/fe/macros/field/FieldHelper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/internal/valuehelp/ValueHelpTemplating"],function(e,t,i,a,r,n,o,l,s,c,u,p){"use strict";var d,f,h,g,m,b,y,v,P,x,M,O,B,w,k,D,E;var $={};var j=u.getVisibleExpression;var V=u.getValueBinding;var z=s.getDisplayMode;var I=o.isPathInsertable;var F=o.isPathDeletable;var L=o.getRelativePaths;var S=o.getContextRelativeTargetObjectPath;var C=o.enhanceDataModelPath;var _=r.or;var T=r.not;var H=r.isConstant;var R=r.ifElse;var N=r.getExpressionFromAnnotation;var U=r.constant;var q=r.compileExpression;var A=r.and;var Q=i.UI;var G=t.xml;var J=e.defineBuildingBlock;var K=e.BuildingBlockBase;var W=e.blockAttribute;function X(e,t,i,a){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(a):void 0})}function Y(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function Z(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;ee(e,t)}function ee(e,t){ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return ee(e,t)}function te(e,t,i,a,r){var n={};Object.keys(a).forEach(function(e){n[e]=a[e]});n.enumerable=!!n.enumerable;n.configurable=!!n.configurable;if("value"in n||n.initializer){n.writable=true}n=i.slice().reverse().reduce(function(i,a){return a(e,t,i)||i},n);if(r&&n.initializer!==void 0){n.value=n.initializer?n.initializer.call(r):void 0;n.initializer=undefined}if(n.initializer===void 0){Object.defineProperty(e,t,n);n=null}return n}function ie(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let ae=(d=J({name:"MultiValueField",namespace:"sap.fe.macros.internal"}),f=W({type:"string"}),h=W({type:"string",defaultValue:"FieldValueHelp"}),g=W({type:"sap.ui.model.Context",required:true,$kind:["Property"]}),m=W({type:"sap.ui.model.Context",required:true,$kind:["EntitySet","NavigationProperty","EntityType","Singleton"]}),b=W({type:"string"}),y=W({type:"string"}),v=W({type:"object",validate:function(e){if(e.displayMode&&!["Value","Description","ValueDescription","DescriptionValue"].includes(e.displayMode)){throw new Error(`Allowed value ${e.displayMode} for displayMode does not match`)}return e}}),d(P=(x=function(e){Z(t,e);t._getMultiInputSettings=function e(i,a){var r;const{collectionPath:n,itemDataModelObjectPath:o}=t._getPathStructure(i);const l=`{path:'${n}', templateShareable: false}`;const s=`{path:'${n}', parameters: {$$ownRequest : true}, templateShareable: false}`;const c=i.targetObject.type==="PropertyPath"?i.targetObject.$target:i.targetObject;const u=(r=c.annotations.Common)===null||r===void 0?void 0:r.Text;const p=L(i);const d=u?q(N(u,p)):V(o,a,true);return{text:d,collectionBindingDisplay:l,collectionBindingEdit:s,key:V(o,a,true)}};t._getPathStructure=function e(t){var i,a;let r="";const n=(i=t.contextLocation)!==null&&i!==void 0&&i.targetEntitySet?t.contextLocation.targetEntitySet:t.startingEntitySet;const o=[];const l=((a=t.contextLocation)===null||a===void 0?void 0:a.navigationProperties)||[];for(const e of t.navigationProperties){if(!t.contextLocation||!t.contextLocation.navigationProperties.some(t=>t.fullyQualifiedName===e.fullyQualifiedName)){o.push(e.name);l.push(e)}if(n.navigationPropertyBinding.hasOwnProperty(e.name)){if(e._type==="NavigationProperty"&&e.isCollection){break}}}r=`${o.join("/")}`;const s=Object.assign({},t);if(s.contextLocation){s.contextLocation.navigationProperties=l}return{collectionPath:r,itemDataModelObjectPath:s}};function t(i){var r;r=e.call(this,i)||this;X(r,"idPrefix",M,Y(r));X(r,"vhIdPrefix",O,Y(r));X(r,"metaPath",B,Y(r));X(r,"contextPath",w,Y(r));X(r,"ariaLabelledBy",k,Y(r));X(r,"key",D,Y(r));X(r,"formatOptions",E,Y(r));let n=a.getInvolvedDataModelObjects(r.metaPath,i.contextPath);const o=a.convertMetaModelContext(r.metaPath);const l=o.Value.path;r.visible=j(n,i.formatOptions);if(l&&l.length>0){n=C(n,l)}const s=I(n);const c=F(n,{ignoreTargetCollection:true,authorizeUnresolvable:true});const u=F(n);const p=R(c._type==="Unresolvable",_(T(H(u)),u),u);r.editMode=r.formatOptions.displayOnly==="true"?"Display":q(R(A(s,p,Q.IsEditable),U("Editable"),U("Display")));r.displayMode=z(n);const d=t._getMultiInputSettings(n,r.formatOptions);r.text=d.text;r.collection=r.editMode==="Display"?d.collectionBindingDisplay:d.collectionBindingEdit;r.key=d.key;return r}$=t;var i=t.prototype;i.getTemplate=function e(){const t=a.getInvolvedDataModelObjects(this.metaPath,this.contextPath);const i=a.convertMetaModelContext(this.metaPath);const r=C(t,i.Value.path);const o=this.idPrefix?n.generate([this.idPrefix,"MultiValueField"]):undefined;const s=c.valueHelpProperty(this.metaPath);const u=this.metaPath.getModel().createBindingContext(s,this.metaPath);const d=p.generateID(undefined,this.vhIdPrefix,l.getRelativePropertyPath(u,{context:this.contextPath}),S(r));const f=c.computeLabelText(t.targetObject.Value,{context:this.metaPath});return G`
		<mdc:MultiValueField
				xmlns:mdc="sap.ui.mdc"
				delegate="{name: 'sap/fe/macros/multiValueField/MultiValueFieldDelegate'}"
				id="${o}"
				items="${this.collection}"
				display="${this.displayMode}"
				width="100%"
				editMode="${this.editMode}"
				fieldHelp="${d}"
				ariaLabelledBy = "${this.ariaLabelledBy}"
				showEmptyIndicator = "${this.formatOptions.showEmptyIndicator}"
				label = "${f}"
		>
		<mdcField:MultiValueFieldItem xmlns:mdcField="sap.ui.mdc.field" key="${this.key}" description="${this.text}" />
		</mdc:MultiValueField>
			`};return t}(K),M=te(x.prototype,"idPrefix",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),O=te(x.prototype,"vhIdPrefix",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),B=te(x.prototype,"metaPath",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),w=te(x.prototype,"contextPath",[m],{configurable:true,enumerable:true,writable:true,initializer:null}),k=te(x.prototype,"ariaLabelledBy",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),D=te(x.prototype,"key",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),E=te(x.prototype,"formatOptions",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),x))||P);$=ae;return $},false);
//# sourceMappingURL=MultiValueField.block.js.map