/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/UriParameters","sap/fe/core/controllerextensions/messageHandler/messageHandling","sap/fe/core/helpers/ClassSupport","sap/fe/macros/messages/MessagePopover","sap/m/Button","sap/m/ColumnListItem","sap/m/Dialog","sap/m/FormattedText","sap/m/library","sap/ui/core/Core","sap/ui/core/library","sap/ui/core/mvc/View","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter"],function(e,t,n,i,o,s,r,a,g,l,c,u,f,d,h,p){"use strict";var T,b,_,m,I,C,P;var y=u.MessageType;var E=l.ButtonType;var S=i.event;var M=i.defineUI5Class;var v=i.aggregation;function w(e,t,n,i){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function x(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function A(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;O(e,t)}function O(e,t){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return O(e,t)}function R(e,t,n,i,o){var s={};Object.keys(i).forEach(function(e){s[e]=i[e]});s.enumerable=!!s.enumerable;s.configurable=!!s.configurable;if("value"in s||s.initializer){s.writable=true}s=n.slice().reverse().reduce(function(n,i){return i(e,t,n)||n},s);if(o&&s.initializer!==void 0){s.value=s.initializer?s.initializer.call(o):void 0;s.initializer=undefined}if(s.initializer===void 0){Object.defineProperty(e,t,s);s=null}return s}function B(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let L=(T=M("sap.fe.macros.messages.MessageButton"),b=v({type:"sap.fe.macros.messages.MessageFilter",multiple:true,singularName:"customFilter"}),_=S(),T(m=(I=function(i){A(l,i);function l(){var e;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++){n[o]=arguments[o]}e=i.call(this,...n)||this;w(e,"customFilters",C,x(e));w(e,"messageChange",P,x(e));e.sGeneralGroupText="";e.sViewId="";e.sLastActionText="";return e}var u=l.prototype;u.init=function e(){s.prototype.init.apply(this);this.attachPress(this.handleMessagePopoverPress,this);this.oMessagePopover=new o;this.oItemBinding=this.oMessagePopover.getBinding("items");this.oItemBinding.attachChange(this._setMessageData,this);const t=this.getId();if(t){this.oMessagePopover.addCustomData(new sap.ui.core.CustomData({key:"messageButtonId",value:t}))}this.attachModelContextChange(this._applyFiltersAndSort.bind(this));this.oMessagePopover.attachActiveTitlePress(this._activeTitlePress.bind(this))};u.handleMessagePopoverPress=function e(t){this.oMessagePopover.toggle(t.getSource())};u._applyGroupingAsync=async function t(i){const o=[];const s=i.getBindingContext();const r=e=>{const t=[];const i=this.oItemBinding.getContexts().map(function(e){return e.getObject()});const o=e.getBindingContext();if(o){const s=e.getContent()[0];n.getVisibleSectionsFromObjectPageLayout(s).forEach(function(e){e.getSubSections().forEach(function(e){e.findElements(true).forEach(function(n){if(n.isA("sap.ui.mdc.Table")){for(let s=0;s<i.length;s++){const r=n.getRowBinding();if(r){const r=`${o.getPath()}/${n.getRowBinding().getPath()}`;if(i[s].target.indexOf(r)===0){t.push({table:n,subsection:e});break}}}}})})})}return t};const a=r.bind(this)(i);a.forEach(function(e){var t;const n=e.table,i=e.subsection;if(!n.getBindingContext()||((t=n.getBindingContext())===null||t===void 0?void 0:t.getPath())!==(s===null||s===void 0?void 0:s.getPath())){i.setBindingContext(s);if(!n.getRowBinding().isLengthFinal()){o.push(new Promise(function(e){n.getRowBinding().attachEventOnce("dataReceived",function(){e()})}))}}});const g=new Promise(e=>{setTimeout(async()=>{this._applyGrouping();e()},0)});try{await Promise.all(o);i.getModel().checkMessages();await g}catch(t){e.error("Error while grouping the messages in the messagePopOver")}};u._applyGrouping=function e(){this.oObjectPageLayout=this._getObjectPageLayout(this,this.oObjectPageLayout);if(!this.oObjectPageLayout){return}const t=this.oMessagePopover.getItems();const i=n.getVisibleSectionsFromObjectPageLayout(this.oObjectPageLayout);const o=this._checkControlIdInSections(t,false);if(o){this._fnEnableBindings(i)}};u._getTableRefErrorContext=function e(t){const n=t.getModel("internal");if(!t.getBindingContext("internal").getProperty("refError")){n.setProperty("refError",{},t.getBindingContext("internal"))}const i=t.getBindingContext("internal").getPath()+"/refError/"+t.getBindingContext().getPath().replace("/","$")+"$"+t.getRowBinding().getPath().replace("/","$");const o=n.getContext(i);if(!o.getProperty("")){n.setProperty("",{},o)}return o};u._updateInternalModel=function e(t,n,i,o,s,r){let a;if(r){a={rowIndex:"CreationRow",targetColProperty:i?i:""}}else{a={rowIndex:t?n:"",targetColProperty:i?i:""}}const g=o.getModel("internal"),l=this._getTableRefErrorContext(o);const c=sap.ui.getCore().getMessageManager().getMessageModel().getData().map(function(e){return e.id});let u;if(l.getProperty()){u=Object.keys(l.getProperty()).filter(function(e){return c.indexOf(e)===-1});u.forEach(function(e){delete l.getProperty()[e]})}g.setProperty(s.getId(),Object.assign({},l.getProperty(s.getId())?l.getProperty(s.getId()):{},a),l)};u._setGroupLabelForTransientMsg=function e(t,n){this.sLastActionText=this.sLastActionText?this.sLastActionText:c.getLibraryResourceBundle("sap.fe.core").getText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_LAST_ACTION");t.setGroupName(`${this.sLastActionText}: ${n}`)};u._computeMessageGroupAndSubTitle=function e(t,i,o,s,r,a){var g;this.oItemBinding.detachChange(this._setMessageData,this);const l=(g=t.getBindingContext("message"))===null||g===void 0?void 0:g.getObject();const u=true;let f,d,h,p,T,b,_;const m=new RegExp("^/").test(l===null||l===void 0?void 0:l.getTargets()[0]),I=c.getLibraryResourceBundle("sap.fe.core");if(m){for(p=0;p<s.length;p++){f=s[p];b=f;if(f.isA("sap.m.Table")||f.isA("sap.ui.table.Table")){d=f.getParent();const e=d.getRowBinding();const i=(e,n)=>{this._setGroupLabelForTransientMsg(t,n)};if(e&&e.isLengthFinal()&&d.getBindingContext()){const o=n.getTableColumnDataAndSetSubtile(l,d,f,e,a,u,i);h=o.oTargetTableInfo;if(o.subTitle){t.setSubtitle(o.subTitle)}t.setActiveTitle(!!h.oTableRowContext);if(h.oTableRowContext){this._formatMessageDescription(t,h.oTableRowContext,h.sTableTargetColName,I,d)}T=h.oTableRowContext&&h.oTableRowContext.getIndex();this._updateInternalModel(h.oTableRowContext,T,h.sTableTargetColProperty,d,l)}}else{t.setActiveTitle(true);const e=n.bIsOrphanElement(b,s);if(e){t.setSubtitle("");break}}}}else{b=s[0];d=this._getMdcTable(b);if(d){h={};h.tableHeader=d.getHeader();const e=this._getTableColumnIndex(b);h.sTableTargetColProperty=e>-1?d.getColumns()[e].getDataProperty():undefined;h.sTableTargetColProperty=h.sTableTargetColProperty;h.sTableTargetColName=h.sTableTargetColProperty&&e>-1?d.getColumns()[e].getHeader():undefined;_=this._getTableRow(b).isA("sap.ui.table.CreationRow");if(!_){T=this._getTableRowIndex(b);h.oTableRowBindingContexts=d.getRowBinding().getCurrentContexts();h.oTableRowContext=h.oTableRowBindingContexts[T]}const i=n.getMessageSubtitle(l,h.oTableRowBindingContexts,h.oTableRowContext,h.sTableTargetColName,I,d,_,e===0&&b.getValueState()==="Error"?b:undefined);if(i){t.setSubtitle(i)}t.setActiveTitle(true);this._updateInternalModel(h.oTableRowContext,T,h.sTableTargetColProperty,d,l,_)}}if(u){const e=n.createSectionGroupName(i,o,r,h,I);t.setGroupName(e);const s=this._getViewId(this.getId());const a=c.byId(s);const g=l.getTargets()[0]&&l.getTargets()[0].split("/").pop();const u=a===null||a===void 0?void 0:a.getModel("internal");if(u&&u.getProperty("/messageTargetProperty")&&g&&g===u.getProperty("/messageTargetProperty")){this.oMessagePopover.fireActiveTitlePress({item:t});u.setProperty("/messageTargetProperty",false)}}this.oItemBinding.attachChange(this._setMessageData,this);return b};u._checkControlIdInSections=function e(t,i){let o,s,r,a,g,l;this.sGeneralGroupText=this.sGeneralGroupText?this.sGeneralGroupText:c.getLibraryResourceBundle("sap.fe.core").getText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_GENERAL");const u=n.getVisibleSectionsFromObjectPageLayout(this.oObjectPageLayout);if(u){var f;const e=this._getViewId(this.getId());const d=c.byId(e);const h=d===null||d===void 0?void 0:(f=d.getBindingContext("internal"))===null||f===void 0?void 0:f.getProperty("sActionName");if(h){(d===null||d===void 0?void 0:d.getBindingContext("internal")).setProperty("sActionName",null)}for(a=t.length-1;a>=0;--a){r=t[a];let e=true;for(g=u.length-1;g>=0;--g){o=u[g];s=o.getSubSections();for(l=s.length-1;l>=0;--l){const t=s[l];const i=r.getBindingContext("message").getObject();const a=n.getControlFromMessageRelatingToSubSection(t,i);if(a.length>0){const n=this._computeMessageGroupAndSubTitle(r,o,t,a,s.length>1,h);if(n&&!n.isA("sap.m.Table")&&!n.isA("sap.ui.table.Table")){g=l=-1}e=false}}}if(e){const e=r.getBindingContext("message").getObject();r.setActiveTitle(false);if(e.persistent&&h){this._setGroupLabelForTransientMsg(r,h)}else{r.setGroupName(this.sGeneralGroupText)}}if(!i&&r.getGroupName()===this.sGeneralGroupText&&this._findTargetForMessage(r)){return true}}}};u._findTargetForMessage=function e(t){const n=t.getBindingContext("message")&&t.getBindingContext("message").getObject();if(n&&n.target){const e=this.oObjectPageLayout&&this.oObjectPageLayout.getModel()&&this.oObjectPageLayout.getModel().getMetaModel(),t=e&&e.getMetaPath(n.target),i=e&&e.getObject(t);if(i&&i.$kind==="Property"){return true}}};u._fnEnableBindings=function e(n){if(t.fromQuery(window.location.search).get("sap-fe-xx-lazyloadingtest")){return}for(let e=0;e<n.length;e++){const t=n[e];let o=false;const s=t.getSubSections();for(let e=0;e<s.length;e++){const t=s[e];const n=t.getBlocks();if(n){for(let e=0;e<t.getBlocks().length;e++){var i;if(n[e].getContent&&!((i=n[e].getContent())!==null&&i!==void 0&&i.isA("sap.fe.macros.table.TableAPI"))){o=true;break}}if(o){t.setBindingContext(undefined)}}if(t.getBindingContext()){this._findMessageGroupAfterRebinding();t.getBindingContext().getBinding().attachDataReceived(this._findMessageGroupAfterRebinding.bind(this))}}}};u._findMessageGroupAfterRebinding=function e(){const t=this.oMessagePopover.getItems();this._checkControlIdInSections(t,true)};u._getViewId=function e(t){let n,i=c.byId(t);while(i){if(i instanceof f){n=i.getId();break}i=i.getParent()}return n};u._setLongtextUrlDescription=function t(n,i){this.oMessagePopover.setAsyncDescriptionHandler(function(t){const o=n;const s=t.item.getLongtextUrl();if(s){jQuery.ajax({type:"GET",url:s,success:function(e){const n=i.getHtmlText()+e;t.item.setDescription(`${o}${n}`);t.promise.resolve()},error:function(){t.item.setDescription(n);const i=`A request has failed for long text data. URL: ${s}`;e.error(i);t.promise.reject(i)}})}})};u._formatMessageDescription=function e(t,i,o,s,r){var a;const l=r.getParent().getIdentifierColumn();let c="";const u=(a=t.getBindingContext("message"))===null||a===void 0?void 0:a.getObject();const f=n.fetchColumnInfo(u,r);if(o){c=`${s.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_COLUMN")}: ${o}`}else if(f){if(f.availability==="Hidden"){if(t.getType()==="Error"){c=l?`${s.getText("T_COLUMN_AVAILABLE_DIAGNOSIS_MSGDESC_ERROR")} ${i.getValue(l)}`+".":`${s.getText("T_COLUMN_AVAILABLE_DIAGNOSIS_MSGDESC_ERROR")}`+"."}else{c=l?`${s.getText("T_COLUMN_AVAILABLE_DIAGNOSIS_MSGDESC")} ${i.getValue(l)}`+".":`${s.getText("T_COLUMN_AVAILABLE_DIAGNOSIS_MSGDESC")}`+"."}}else{if(!this._navigationConfigured(r)){t.setActiveTitle(false)}c=`${s.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_COLUMN")}: ${f.label} (${s.getText("T_COLUMN_INDICATOR_IN_TABLE_DEFINITION")})`}}const d=new g({htmlText:`<html><body><strong>${s.getText("T_FIELDS_AFFECTED_TITLE")}</strong></body></html><br>`});let h;if(l){h=`${d.getHtmlText()}<br>${s.getText("T_MESSAGE_GROUP_TITLE_TABLE_DENOMINATOR")}: ${r.getHeader()}<br>${s.getText("T_MESSAGE_GROUP_DESCRIPTION_TABLE_ROW")}: ${i.getValue(l)}<br>${c}<br>`}else if(c==""||!c){h=""}else{h=`${d.getHtmlText()}<br>${s.getText("T_MESSAGE_GROUP_TITLE_TABLE_DENOMINATOR")}: ${r.getHeader()}<br>${c}<br>`}const p=new g({htmlText:`<html><body><strong>${s.getText("T_DIAGNOSIS_TITLE")}</strong></body></html><br>`});const T=t.getBindingContext("message").getObject().description;t.setDescription(null);let b="";let _="";if(t.getLongtextUrl()){_=`${h}<br>`;this._setLongtextUrlDescription(_,p)}else if(T){b=`${p.getHtmlText()}<br>${T}`;_=`${h}<br>${b}`;t.setDescription(_)}else{t.setDescription(h)}};u._setMessageData=function t(){clearTimeout(this._setMessageDataTimeout);this._setMessageDataTimeout=setTimeout(async()=>{const t="",n=this.oMessagePopover.getItems(),i={Error:0,Warning:0,Success:0,Information:0},o=c.getLibraryResourceBundle("sap.fe.core"),s=n.length;let r=E.Default,a="",g="",l="";if(s>0){for(let e=0;e<s;e++){if(!n[e].getType()||n[e].getType()===""){++i["Information"]}else{++i[n[e].getType()]}}if(i[y.Error]>0){r=E.Negative}else if(i[y.Warning]>0){r=E.Critical}else if(i[y.Success]>0){r=E.Success}else if(i[y.Information]>0){r=E.Neutral}const u=i[y.Error]+i[y.Warning]+i[y.Success]+i[y.Information];this.setText(u.toString());if(i.Error===1){a="C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR"}else if(i.Error>1){a="C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_MULTIPLE_ERROR_TOOLTIP"}else if(!i.Error&&i.Warning){a="C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_WARNING_TOOLTIP"}else if(!i.Error&&!i.Warning&&i.Information){a="C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_INFO"}else if(!i.Error&&!i.Warning&&!i.Information&&i.Success){a="C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_SUCCESS"}if(a){l=o.getText(a);g=i.Error?`${i.Error} ${l}`:l;this.setTooltip(g)}this.setIcon(t);this.setType(r);this.setVisible(true);const f=c.byId(this.sViewId);if(f){const t=f.getController().pageReady;try{await t.waitPageReady();await this._applyGroupingAsync(f)}catch(t){e.error("fail grouping messages")}this.fireMessageChange({iMessageLength:s})}if(s>1){this.oMessagePopover.navigateBack()}}else{this.setVisible(false);this.fireMessageChange({iMessageLength:s})}},100)};u._activeTitlePress=async function t(n){const i=this.getBindingContext("pageInternal");i.setProperty("errorNavigationSectionFlag",true);const o=n.getParameter("item"),s=o.getBindingContext("message").getObject(),r=new RegExp("^/").test(s.getTarget()),a=c.byId(this.sViewId);let g,l;const u=function(e,t){const n={preventScroll:true,targetInfo:e};t.focus(n)};if(o.getGroupName().indexOf("Table:")!==-1){let t;if(r){t=s.controlIds.map(function(e){const t=c.byId(e);const n=t&&t.getParent();return n&&n.isA("sap.ui.mdc.Table")&&n.getHeader()===o.getGroupName().split(", Table: ")[1]?n:null}).reduce(function(e,t){return t?t:e});if(t){l=o.getGroupName().split(", ")[0];try{await this._navigateFromMessageToSectionTableInIconTabBarMode(t,this.oObjectPageLayout,l);const n=this._getTableRefErrorContext(t);const i=n.getProperty(o.getBindingContext("message").getObject().getId());const r=async(e,t)=>{const n=this._getMdcTableRows(e),i=this._getGridTable(e).getFirstVisibleRow();if(n.length>0&&n[0]){const o=n[t-i],r=this.getTargetCell(o,s);if(r){this.setFocusToControl(r);return undefined}else{const t=s.getTarget().split("/").pop();if(t){a.getModel("internal").setProperty("/messageTargetProperty",t)}if(this._navigationConfigured(e)){return a.getController()._routing.navigateForwardToContext(o.getBindingContext())}else{return false}}}return undefined};if(t.data("tableType")==="GridTable"&&i.rowIndex!==""){const n=this._getGridTable(t).getFirstVisibleRow();try{await t.scrollToIndex(i.rowIndex);const e=this._getMdcTableRows(t);let o,a;if(e.length>0&&e[0]){o=e[0].getParent().getFirstVisibleRow();a=n-o!==0}let g;if(a){g=new Promise(function(e){c.attachEvent("UIUpdated",e)})}else{g=Promise.resolve()}await g;setTimeout(async function(){const e=await r(t,i.rowIndex);if(e===false){u(s,t)}},0)}catch(t){e.error("Error while focusing on error")}}else if(t.data("tableType")==="ResponsiveTable"&&i){const e=await this.focusOnMessageTargetControl(a,s,t,i.rowIndex);if(e===false){u(s,t)}}else{this.focusOnMessageTargetControl(a,s)}}catch(t){e.error("Fail to navigate to Error control")}}}else{g=c.byId(s.controlIds[0]);const e=c.byId(this.oObjectPageLayout.getSelectedSection());if((e===null||e===void 0?void 0:e.findElements(true).indexOf(g))===-1){l=o.getGroupName().split(", ")[0];this._navigateFromMessageToSectionInIconTabBarMode(this.oObjectPageLayout,l)}this.setFocusToControl(g)}}else{l=o.getGroupName().split(", ")[0];this._navigateFromMessageToSectionInIconTabBarMode(this.oObjectPageLayout,l);this.focusOnMessageTargetControl(a,s)}};u.getTargetCell=function e(t,n){return n.getControlIds().length>0?n.getControlIds().map(function(e){const n=t.findElements(true,function(t){return t.getId()===e});return n.length>0?c.byId(e):null}).reduce(function(e,t){return t?t:e}):null};u.focusOnMessageTargetControl=async function e(t,n,i,o){const s=t.findElements(true);const a=n.getControlIds().filter(function(e){return s.some(function(t){return t.getId()===e&&t.getDomRef()})}).map(function(e){return c.byId(e)});const g=a.filter(function(e){return!e.isA("sap.m.Table")&&!e.isA("sap.ui.table.Table")});if(g.length>0){this.setFocusToControl(g[0]);return undefined}else if(a.length>0){const e=i?i.findElements(true,function(e){return e.isA(r.getMetadata().getName())}):[];if(e.length>0&&e[0]){const s=e[o];const r=this.getTargetCell(s,n);if(r){const e=r.isA("sap.fe.macros.field.FieldAPI")?r.getContent().getContentEdit()[0]:r.getItems()[0].getContent().getContentEdit()[0];this.setFocusToControl(e);return undefined}else{const e=n.getTarget().split("/").pop();if(e){t.getModel("internal").setProperty("/messageTargetProperty",e)}if(this._navigationConfigured(i)){return t.getController()._routing.navigateForwardToContext(s.getBindingContext())}else{return false}}}return undefined}return undefined};u._getMessageRank=function e(t,n){if(n){let e,i,o,s,r,a,g,l;for(s=n.length-1;s>=0;--s){e=n[s];i=e.getSubSections();for(r=i.length-1;r>=0;--r){o=i[r];g=o.findElements(true);a=g.filter(this._fnFilterUponId.bind(this,t.getControlId()));l=s+1;if(a.length>0){if(e.getVisible()&&o.getVisible()){if(!t.hasOwnProperty("sectionName")){t.sectionName=e.getTitle()}if(!t.hasOwnProperty("subSectionName")){t.subSectionName=o.getTitle()}return l*10+(r+1)}else{return 1}}}}if(!t.sectionName&&!t.subSectionName&&t.persistent){return 1}return 999}return 999};u._applyFiltersAndSort=function e(){let t,n,i,o,s,r,g=null;const l=[];const u=()=>{const e=e=>{let t=Infinity,n=c.byId(e[0]);const i=c.byId(e[0]);while(n){const e=n instanceof a?(i===null||i===void 0?void 0:i.getParent()).findElements(true).indexOf(i):Infinity;if(n instanceof a){if(t>e){t=e;this.setFocusToControl(i)}return false}n=n.getParent()}return true};return new d({path:"controlIds",test:e,caseSensitive:true})};function f(){const e=function(e){if(!e.length){return false}let t=c.byId(e[0]);while(t){if(t.getId()===T){return true}if(t instanceof a){return false}t=t.getParent()}return false};return new d({path:"controlIds",test:e,caseSensitive:true})}if(!this.sViewId){this.sViewId=this._getViewId(this.getId())}const T=this.sViewId;const b=this.getAggregation("customFilters");if(b){b.forEach(function(e){l.push(new d({path:e.getProperty("path"),operator:e.getProperty("operator"),value1:e.getProperty("value1"),value2:e.getProperty("value2")}))})}const _=this.getBindingContext();if(!_){this.setVisible(false);return}else{o=_.getPath();t=new d({filters:[new d({path:"validation",operator:h.EQ,value1:true}),f()],and:true});n=new d({filters:[t,new d({path:"target",operator:h.StartsWith,value1:o})],and:false});r=new d({filters:[u()]})}const m=new d({filters:[n,r],and:true});if(l.length>0){i=new d({filters:[l,m],and:false})}else{i=m}this.oItemBinding.filter(i);this.oObjectPageLayout=this._getObjectPageLayout(this,this.oObjectPageLayout);if(this.oObjectPageLayout){s=new p("",null,null,(e,t)=>{if(!g){g=this.oObjectPageLayout&&this.oObjectPageLayout.getSections()}const n=this._getMessageRank(e,g);const i=this._getMessageRank(t,g);if(n<i){return-1}if(n>i){return 1}return 0});this.oItemBinding.sort(s)}};u._fnFilterUponId=function e(t,n){return t===n.getId()};u._getSectionBySectionTitle=function e(t,n){let i;if(n){const e=t.getSections();for(let t=0;t<e.length;t++){if(e[t].getVisible()&&e[t].getTitle()===n){i=e[t];break}}}return i};u._navigateFromMessageToSectionInIconTabBarMode=function e(t,n){const i=t.getUseIconTabBar();if(i){const e=this._getSectionBySectionTitle(t,n);const i=t.getSelectedSection();if(e&&i!==e.getId()){t.setSelectedSection(e.getId())}}};u._navigateFromMessageToSectionTableInIconTabBarMode=async function e(t,n,i){const o=t.getRowBinding();const s=t.getBindingContext();const r=n.getBindingContext();const a=!(s===r);this._navigateFromMessageToSectionInIconTabBarMode(n,i);return new Promise(function(e){if(a){o.attachEventOnce("change",function(){e()})}else{e()}})};u._getMdcTable=function e(t){let n=t.getParent();while(n&&!n.isA("sap.ui.mdc.Table")){n=n.getParent()}return n&&n.isA("sap.ui.mdc.Table")?n:undefined};u._getGridTable=function e(t){return t.findElements(true,function(e){return e.isA("sap.ui.table.Table")&&e.getParent()===t})[0]};u._getTableRow=function e(t){let n=t.getParent();while(n&&!n.isA("sap.ui.table.Row")&&!n.isA("sap.ui.table.CreationRow")&&!n.isA(r.getMetadata().getName())){n=n.getParent()}return n&&(n.isA("sap.ui.table.Row")||n.isA("sap.ui.table.CreationRow")||n.isA(r.getMetadata().getName()))?n:undefined};u._getTableRowIndex=function e(t){const n=this._getTableRow(t);let i;if(n.isA("sap.ui.table.Row")){i=n.getIndex()}else{i=n.getTable().getItems().findIndex(function(e){return e.getId()===n.getId()})}return i};u._getTableColumnIndex=function e(t){const n=function(e,t){return t.getCells().findIndex(function(t){return t.getId()===e.getId()})};const i=function(e,t){let i=e.getParent(),o=n(i,t);while(i&&o<0){i=i.getParent();o=n(i,t)}return o};const o=this._getTableRow(t);let s;s=i(t,o);if(o.isA("sap.ui.table.CreationRow")){const e=o.getCells()[s].getId(),t=o.getTable().getColumns();s=t.findIndex(function(t){if(t.getCreationTemplate()){return e.search(t.getCreationTemplate().getId())>-1?true:false}else{return false}})}return s};u._getMdcTableRows=function e(t){return t.findElements(true,function(e){return e.isA("sap.ui.table.Row")&&e.getTable().getParent()===t})};u._getObjectPageLayout=function e(t,n){if(n){return n}n=t;while(n&&!n.isA("sap.uxap.ObjectPageLayout")){n=n.getParent()}return n};u._navigationConfigured=function e(t){const n=sap.ui.require("sap/ui/core/Component"),i=t&&n.getOwnerComponentFor(t)&&n.getOwnerComponentFor(t).getNavigation();let o=false,s=false;if(i&&Object.keys(i).indexOf(t.getRowBinding().sPath)!==-1){o=i[t===null||t===void 0?void 0:t.getRowBinding().sPath]&&i[t===null||t===void 0?void 0:t.getRowBinding().sPath].detail&&i[t===null||t===void 0?void 0:t.getRowBinding().sPath].detail.route?true:false}s=o&&(t===null||t===void 0?void 0:t.getRowSettings().getRowActions())&&(t===null||t===void 0?void 0:t.getRowSettings().getRowActions()[0].mProperties.type.indexOf("Navigation"))!==-1;return s};u.setFocusToControl=function t(n){const i=this.oMessagePopover;if(i&&n&&n.focus){const e=()=>{n.focus()};if(!i.isOpen()){setTimeout(e,0)}else{const t=()=>{setTimeout(e,0);i.detachEvent("afterClose",t)};i.attachEvent("afterClose",t);i.close()}}else{e.warning("FE V4 : MessageButton : element doesn't have focus method for focusing.")}};return l}(s),C=R(I.prototype,"customFilters",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),P=R(I.prototype,"messageChange",[_],{configurable:true,enumerable:true,writable:true,initializer:null}),I))||m);return L},false);
//# sourceMappingURL=MessageButton.js.map