/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SideEffectsHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/CommonHelper","sap/fe/macros/internal/valuehelp/ValueListHelper","sap/fe/macros/ResourceModel","sap/ui/base/ManagedObject","sap/ui/core/format/DateFormat","sap/ui/model/json/JSONModel","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,a,r,i,o,s,c,l,u,f,m,p,g,d,v,b){"use strict";var y=u.getAlignmentExpression;var O=l.isProperty;var $=c.isRequiredExpression;var h=s.generate;var P=r.pathInModel;var T=r.or;var x=r.ifElse;var I=r.equal;var F=r.constant;var D=r.compileExpression;var A=a.KeyHelper;var C=n.UI;const j="@Org.OData.Measures.V1.ISOCurrency",E="@Org.OData.Measures.V1.Unit";async function S(e){const t=e.getModel();const n=e.getSetting("sap.fe.macros.internal.Field");const a=n.sideEffects;if(a){return a}return o.generateSideEffectsMapFromMetaModel(t)}const M={displayMode:function(e,t){const n=e["@com.sap.vocabularies.Common.v1.Text"],a=n&&(e&&e["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]||t&&t["@com.sap.vocabularies.UI.v1.TextArrangement"]);if(a){if(a.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){return"Description"}else if(a.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"ValueDescription"}return"DescriptionValue"}return n?"DescriptionValue":"Value"},buildExpressionForTextValue:function(e,t){const n=t.context.getModel();const a=t.context.getPath();const r=n.createBindingContext(`${a}@com.sap.vocabularies.Common.v1.Text`);const i=r.getProperty();const o=i?b.value(i,{context:r}):undefined;let s="";e=b.getNavigationPath(e);if(e.indexOf("/")>-1&&o){s=e.replace(/[^\/]*$/,o.substr(1,o.length-2))}else{s=o}if(s){s="{ path : '"+s.replace(/^\{+/g,"").replace(/\}+$/g,"")+"', parameters: {'$$noPatch': true}}"}return s},buildTargetPathFromDataModelObjectPath:function(e){const t=e.startingEntitySet.name;let n=`/${t}`;const a=e.navigationProperties;for(let e=0;e<a.length;e++){n+=`/${a[e].name}`}return n},hasSemanticObjectTargets:function(e){var t,n,a,r,i;const o=O(e.targetObject)?e.targetObject:e.targetObject.$target;const s=(t=o.annotations)===null||t===void 0?void 0:(n=t.Common)===null||n===void 0?void 0:n.SemanticObject;const c=(a=o.annotations)===null||a===void 0?void 0:(r=a.Common)===null||r===void 0?void 0:r.SemanticObjectUnavailableActions;const l=M.buildTargetPathFromDataModelObjectPath(e);const u=`${l}/${o.name}`;let f;if(s!==null&&s!==void 0&&s.path){f=D(P(s.path))}if(u&&(f||(s===null||s===void 0?void 0:(i=s.valueOf())===null||i===void 0?void 0:i.length)>0)){const e=u.replace(/\//g,"_");if(!f){const t="pageInternal>semanticsTargets/"+(s===null||s===void 0?void 0:s.valueOf())+"/"+e+(!c?"/HasTargetsNotFiltered":"/HasTargets");return"{parts:[{path:'"+t+"'}], formatter:'FieldRuntime.hasTargets'}"}else{return undefined}}else{return false}},getStateDependingOnSemanticObjectTargets:function(e){var t,n,a,r,i;const o=O(e.targetObject)?e.targetObject:e.targetObject.$target;const s=(t=o.annotations)===null||t===void 0?void 0:(n=t.Common)===null||n===void 0?void 0:n.SemanticObject;const c=(a=o.annotations)===null||a===void 0?void 0:(r=a.Common)===null||r===void 0?void 0:r.SemanticObjectUnavailableActions;const l=M.buildTargetPathFromDataModelObjectPath(e);const u=`${l}/${o.name}`;let f;if(s!==null&&s!==void 0&&s.path){f=D(P(s.path))}if(u&&(f||(s===null||s===void 0?void 0:(i=s.valueOf())===null||i===void 0?void 0:i.length)>0)){const e=u.replace(/\//g,"_");if(!f){const t=`pageInternal>semanticsTargets/${s===null||s===void 0?void 0:s.valueOf()}/${e}${!c?"/HasTargetsNotFiltered":"/HasTargets"}`;return`{parts:[{path:'${t}'}], formatter:'FieldRuntime.getStateDependingOnSemanticObjectTargets'}`}else{return"Information"}}else{return"None"}},isNotAlwaysHidden:function(e,t){const n=t.context;let a=false;if(e.Value&&e.Value.$Path){a=n.getObject("Value/$Path@com.sap.vocabularies.UI.v1.Hidden")}if(!a||a.$Path){a=n.getObject("@com.sap.vocabularies.UI.v1.Hidden");if(!a||a.$Path){a=false}}return!a},isDraftIndicatorVisibleInFieldGroup:function(e){if(e&&e.formatOptions&&e.formatOptions.fieldGroupDraftIndicatorPropertyPath&&e.formatOptions.fieldGroupName){return"{parts: ["+"{value: '"+e.formatOptions.fieldGroupName+"'},"+"{path: 'internal>semanticKeyHasDraftIndicator'} , "+"{path: 'HasDraftEntity', targetType: 'any'}, "+"{path: 'IsActiveEntity', targetType: 'any'}, "+"{path: 'pageInternal>hideDraftInfo', targetType: 'any'}], "+"formatter: 'sap.fe.macros.field.FieldRuntime.isDraftIndicatorVisible'}"}else{return false}},isRequired:function(e,t){if(t==="Display"||t==="ReadOnly"||t==="Disabled"){return false}if(e){if(g.bindingParser(e)){return"{= %"+e+" === 7}"}else{return e=="com.sap.vocabularies.Common.v1.FieldControlType/Mandatory"}}return false},getActionParameterVisibility:function(e,t){if(typeof e==="object"){if(e&&e.$If&&e.$If.length===3){const n={$If:[]};n.$If[0]=e.$If[0];n.$If[1]=e.$If[2];n.$If[2]=e.$If[1];return b.value(n,t)}else{return"{= !%{"+e.$Path+"} }"}}else if(typeof e==="boolean"){return b.value(!e,t)}else{return undefined}},propertyName:function(e,t){let n;if(typeof e==="string"){if(t.context.getPath().indexOf("$Path")>-1||t.context.getPath().indexOf("$PropertyPath")>-1){n=e}}else if(e.$Path||e.$PropertyPath){const a=e.$Path?"/$Path":"/$PropertyPath";const r=t.context.getPath();n=t.context.getObject(`${r+a}/$@sapui.name`)}else if(e.Value&&e.Value.$Path){n=e.Value.$Path}else{n=t.context.getObject("@sapui.name")}return n},getFieldGroupIds:function(e,t){if(!t){return undefined}const n=e.getInterface(0);return S(n).then(function(a){const r=n.getSetting("sap.fe.macros.internal.Field");r.sideEffects=a;const i=e.getPath(1).substr(1);const o=M.getSideEffectsOnEntityAndProperty(t,i,a);let s;if(o.length){s=o.reduce(function(e,t){return e&&`${e},${t}`||t})}return s})},getSideEffectsOnEntityAndProperty:function(e,t,n){const a=e.indexOf("/")>0;e=a?e.substr(e.lastIndexOf("/")+1):e;return n[t]&&n[t][0].concat(n[t][1][e]||[])||[]},fieldControl:function(e,t){const n=t&&t.context.getModel();const a=t&&t.context.getPath();const r=n&&n.createBindingContext(`${a}@com.sap.vocabularies.Common.v1.FieldControl`);const i=r&&r.getProperty();if(i){if(i.hasOwnProperty("$EnumMember")){return i.$EnumMember}else if(i.hasOwnProperty("$Path")){return b.value(i,{context:r})}}else{return undefined}},valueHelpProperty:function(e,t){const n=e.getPath();const a=e.getObject()||{};let r=a.$Path?`${n}/$Path`:n;const i=`${r}@`;const o=e.getObject(i);let s;if(o){s=o.hasOwnProperty(j)&&j||o.hasOwnProperty(E)&&E;if(s&&!t){const t=`${r+s}/$Path`;if(e.getObject(t)){r=t}}}return r},valueHelpPropertyForFilterField:function(e){return M.valueHelpProperty(e,true)},getIDForFieldValueHelp:function(e,t,n,a){if(e){return e}let r=a;if(n!==a){r=`${n}::${a}`}return h([t,r])},getFieldHelpPropertyForFilterField:function(e,n,a,r,i,o,s,c){const l=M.propertyName(n,{context:e}),u=c==="true"||c===true;const m=e.getModel(),p=e.getPath(),g=f.getLocationForPropertyPath(m,p),d=t.getFilterRestrictionsByPath(g,m);if((a==="Edm.DateTimeOffset"||a==="Edm.Date")&&u&&d&&d.FilterAllowedExpressions&&d.FilterAllowedExpressions[l]&&(d.FilterAllowedExpressions[l].indexOf("SingleRange")!==-1||d.FilterAllowedExpressions[l].indexOf("SingleValue")!==-1)||a==="Edm.Boolean"&&!s){return undefined}return M.getIDForFieldValueHelp(null,r||"FilterFieldValueHelp",i,o)},getSemanticKeyTitle:function(e,t,n,a,r,i){const o=p.getText("T_NEW_OBJECT");const s=p.getText("T_ANNOTATION_HELPER_DEFAULT_OBJECT_PAGE_HEADER_TITLE_NO_HEADER_INFO");let c,l;let u;const f=function(e){c="($"+e+" === '' || $"+e+" === undefined || $"+e+" === null ? '"+o+"': $"+e+")";l="($"+e+" === '' || $"+e+" === undefined || $"+e+" === null ? '"+s+"': $"+e+")";return"(!%{IsActiveEntity} ? !%{HasActiveEntity} ? "+c+" : "+l+" : "+l+")"};const m=function(e,t){let n;if(i){n=f(e);return t?"{= "+n+"}":n}else{return t?e:"$"+e}};if(e){if(a&&r!=="ObjectIdentifier"){const r=a.$EnumMember;if(r==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"){u=m(e,false);return"{= "+u+" +' (' + "+"($"+t+(n?" || ${"+n+"}":"")+") +')' }"}else if(r==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){u=m(e,false);return"{= ($"+t+(n?" || ${"+n+"}":"")+")"+" + ' (' + "+u+" +')' }"}else{return m(e,true)}}else{return m(e,true)}}else{return m(t,true)}},getObjectIdentifierText:function(e,t,n,a){if(e){if(t&&(t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"||t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"||t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst")){return undefined}else{return n||`{${a}}`}}return undefined},getSemanticObjectsList:function(e){const t=e;const n=[];for(const a in t.getObject()){if(a.indexOf("com.sap.vocabularies.Common.v1.SemanticObject")>-1&&a.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectMapping")===-1&&a.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")===-1){let r=t.getObject()[a];if(typeof r==="object"){r=b.value(r,{context:e})}if(n.indexOf(r)===-1){n.push(r)}}}const a=new v(n);a.$$valueAsPromise=true;return a.createBindingContext("/")},getSemanticObjectsQualifiers:function(e){const t=e;let n=[];const a=function(e){return n.find(function(t){return t.qualifier===e})};for(const e in t.getObject()){if(e.indexOf("com.sap.vocabularies.Common.v1.SemanticObject#")>-1||e.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectMapping#")>-1||e.indexOf("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions#")>-1){const r=t.getObject()[e],i=e.split("#")[0],o=e.split("#")[1];let s=a(o);if(!s){s={qualifier:o};s[i]=r;n.push(s)}else{s[i]=r}}}n=n.filter(function(e){return!!e["@com.sap.vocabularies.Common.v1.SemanticObject"]});const r=new v(n);r.$$valueAsPromise=true;return r.createBindingContext("/")},computeSemanticLinkModelContextChange:function(e,t){if(M.hasSemanticObjectsWithPath(e)){const e=M.buildTargetPathFromDataModelObjectPath(t);return`FieldRuntime.LinkModelContextChange($event, '${t.targetObject.name}', '${e}')`}else{return undefined}},hasSemanticObjectsWithPath:function(e){let t=false;if(e&&e.length){for(let n=0;n<e.length;n++){if(e[n]&&e[n].value&&e[n].value.indexOf("{")===0){t=true;break}}}return t},isSemanticKeyHasFieldGroupColumn:function(e){return e},computeFieldBaseDelegate:function(e,t){if(t){return JSON.stringify({name:e,payload:{retrieveTextFromValueList:t}})}return`{name: '${e}'}`},_getPrimaryIntents:function(t){const n=[];if(t){const e=sap.ushell&&sap.ushell.Container;const a=e&&e.getService("CrossApplicationNavigation");t.forEach(function(e){if(typeof e==="string"){n.push(a.getPrimaryIntent(e,{}))}})}return Promise.all(n).then(function(e){return e}).catch(function(t){e.error("Error fetching primary intents",t);return[]})},_SemanticObjectsHasPrimaryAction:function(e,n){const a=function(e,t,n){for(const a in e.semanticObjectUnavailableActions[n].actions){if(t.intent.split("-")[1].indexOf(e.semanticObjectUnavailableActions[n].actions[a])===0){return false}}return true};e.semanticPrimaryActions=n;const r=e.semanticObjects&&e.mainSemanticObject&&e.semanticPrimaryActions[e.semanticObjects.indexOf(e.mainSemanticObject)];const i=t.getHash();if(e.mainSemanticObject&&r!==null&&r.intent!==i){for(const t in e.semanticObjectUnavailableActions){if(e.mainSemanticObject.indexOf(e.semanticObjectUnavailableActions[t].semanticObject)===0){return a(e,r,t)}}return true}else{return false}},checkPrimaryActions:function(t,n){return this._getPrimaryIntents(t&&t.semanticObjects).then(e=>n?{titleLink:e,hasTitleLink:this._SemanticObjectsHasPrimaryAction(t,e)}:this._SemanticObjectsHasPrimaryAction(t,e)).catch(function(t){e.error("Error in checkPrimaryActions",t)})},_getTitleLinkWithParameters:function(e,t){if(e&&e.titlelink){return e.titlelink}else{return t}},getPrimaryAction:function(e){return e.semanticPrimaryActions[e.semanticObjects.indexOf(e.mainSemanticObject)].intent?M._getTitleLinkWithParameters(e,e.semanticPrimaryActions[e.semanticObjects.indexOf(e.mainSemanticObject)].intent):e.primaryIntentAction},operators:function(e,n,a,r,o){if(!n||!o){return undefined}let s;const c=M.propertyName(n,{context:e});const l=e.getModel(),u=e.getPath(),m=f.getLocationForPropertyPath(l,u),p=n.$Type;if(p==="Edm.Guid"){return t.getOperatorsForGuidProperty()}o=o.slice(0,-1);const g=o.lastIndexOf("/")>0;const d=g&&o!==m||!g&&m.lastIndexOf("/")>0;const v=d&&m.substr(m.indexOf(o)+o.length+1)||"";const b=d&&v+"/"+c||c;if(!g){if(!d){s=t.getOperatorsForProperty(c,m,l,p,a,r)}else{s=t.getOperatorsForProperty(b,o,l,p,a,r);if(s.length===0){s=t.getOperatorsForProperty(c,m,l,p,a,r)}}}else if(!d){var y;s=t.getOperatorsForProperty(b,o,l,p,a,r);if(s.length===0){s=t.getOperatorsForProperty(c,i.getEntitySetPath(o),l,p,a,r)}return((y=s)===null||y===void 0?void 0:y.length)>0?s.toString():undefined}else{s=t.getOperatorsForProperty(b,o,l,p,a,r);if(s.length===0){s=t.getOperatorsForProperty(b,i.getEntitySetPath(o),l,p,a,r)}}if((!s||s.length===0)&&(p==="Edm.Date"||p==="Edm.DateTimeOffset")){s=t.getOperatorsForDateProperty(p)}return s.length>0?s.toString():undefined},getPropertyContextForQuickView:function(e){if(e.getObject("Value")!==undefined){const t=e.getInterface(),n=t.getModel();let a=t.getPath();a=a+(a.endsWith("/")?"Value":"/Value");return n.createBindingContext(a)}else{return e}},getPropertyPathForQuickView:function(e){if(e&&e.getObject("$Path")){const t=e.getInterface(),n=t.getModel();let a=t.getPath();a=a+(a.endsWith("/")?"$Path":"/$Path");return n.createBindingContext(a)}return e},getDataFieldDefault:function(e){const t=e.getModel().getObject(`${e.getPath()}@com.sap.vocabularies.UI.v1.DataFieldDefault`);return t?`${e.getPath()}@com.sap.vocabularies.UI.v1.DataFieldDefault`:e.getPath()},isDataFieldActionButtonVisible:function(e,t,n,a){return t["@com.sap.vocabularies.UI.v1.Hidden"]!==true&&(n!==true||a!==false)},getPressEventForDataFieldActionButton:function(e,t){var n;let a="Isolated";if(t.InvocationGrouping&&t.InvocationGrouping.$EnumMember==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"){a="ChangeSet"}let r=e.navigateAfterAction;r=r==="false"?false:true;const i=e===null||e===void 0?void 0:(n=e.entitySet)===null||n===void 0?void 0:n.getPath().split("/");const o=i[i.length-1];const s={contexts:"${$source>/}.getBindingContext()",invocationGrouping:f.addSingleQuotes(a),model:"${$source>/}.getModel()",label:f.addSingleQuotes(t.Label,true),isNavigable:r,entitySetName:f.addSingleQuotes(o)};return f.generateFunction(".editFlow.invokeAction",f.addSingleQuotes(t.Action),f.objectToString(s))},isNumericDataType:function(e){const t=e;if(t!==undefined){const e=["Edm.Int16","Edm.Int32","Edm.Int64","Edm.Byte","Edm.SByte","Edm.Single","Edm.Decimal","Edm.Double"];return e.indexOf(t)===-1?false:true}else{return false}},isDateOrTimeDataType:function(e){if(e!==undefined){const t=["Edm.DateTimeOffset","Edm.DateTime","Edm.Date","Edm.TimeOfDay","Edm.Time"];return t.indexOf(e)>-1}else{return false}},isDateTimeDataType:function(e){if(e!==undefined){const t=["Edm.DateTimeOffset","Edm.DateTime"];return t.indexOf(e)>-1}else{return false}},isDateDataType:function(e){return e==="Edm.Date"},isTimeDataType:function(e){if(e!==undefined){const t=["Edm.TimeOfDay","Edm.Time"];return t.indexOf(e)>-1}else{return false}},getUnderlyingPropertyDataType:function(e,t,n,a){const r="@com.sap.vocabularies.Common.v1.Text",i="@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement";if(!!e&&!!e[i]&&e[i].$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"&&!!e[r]&&!!e[r].$Path){return t.getObject(`${n}/${e[r].$Path}/$Type`)}return a},getColumnAlignment:function(e,t){const n=t.collection.sPath,a=t.collection.oModel;if((e["$Type"]==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e["$Type"]==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&e.Inline&&e.IconUrl){return"Center"}const r=a.getObject(`${n}/@com.sap.vocabularies.Common.v1.SemanticKey`);if(e["$Type"]==="com.sap.vocabularies.UI.v1.DataField"){const t=e.Value.$Path;const n=r&&!r.every(function(e){return e.$PropertyPath!==t});if(n){return"Begin"}}return M.getDataFieldAlignment(e,a,n)},getPropertyAlignment:function(e,t,n){let a="Begin";const r=t?t.textAlignMode:"";switch(r){case"Form":if(this.isNumericDataType(e)){a="Begin";if(n){a=y(n,"Begin","End")}}break;default:if(this.isNumericDataType(e)||this.isDateOrTimeDataType(e)){a="Right"}break}return a},getDataFieldAlignment:function(e,t,n,a,r){let i,o="Begin",s,c;if(e["$Type"]==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){i=e.Target.$AnnotationPath;if(e.Target["$AnnotationPath"]&&e.Target["$AnnotationPath"].indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>=0){const e=t.getObject(`${n}/${i}`);for(let l=0;l<e.Data.length;l++){s=t.getObject(`${n}/${i}/Data/${l.toString()}/Value/$Path/$Type`);c=t.getObject(`${n}/${i}/Data/${l.toString()}/Value/$Path@`);s=this.getUnderlyingPropertyDataType(c,t,n,s);o=this.getPropertyAlignment(s,a,r);if(o==="Begin"){break}}return o}else if(e.Target["$AnnotationPath"]&&e.Target["$AnnotationPath"].indexOf("com.sap.vocabularies.UI.v1.DataPoint")>=0&&t.getObject(`${n}/${i}/Visualization/$EnumMember`)==="com.sap.vocabularies.UI.v1.VisualizationType/Rating"){return o}else{s=t.getObject(`${n}/${i}/$Type`);if(s==="com.sap.vocabularies.UI.v1.DataPointType"){s=t.getObject(`${n}/${i}/Value/$Path/$Type`);c=t.getObject(`${n}/${i}/Value/$Path@`);s=this.getUnderlyingPropertyDataType(c,t,n,s)}o=this.getPropertyAlignment(s,a,r)}}else{i=e.Value.$Path;s=t.getObject(`${n}/${i}/$Type`);c=t.getObject(`${n}/${i}@`);s=this.getUnderlyingPropertyDataType(c,t,n,s);if(!(t.getObject(`${n}/`)["$Key"].indexOf(i)===0)){o=this.getPropertyAlignment(s,a,r)}}return o},getTypeAlignment:function(e,t,n,a,r,i){const o=e.getInterface(0);const s=o.getModel();if(a==="/undefined"&&i&&i.$target){a=`/${i.$target.fullyQualifiedName.split("/")[0]}`}return M.getDataFieldAlignment(t,s,a,n,r)},isDataFieldActionButtonEnabled:function(e,t,n,a){if(t!==true){return"true"}return(n===null?"{= !${#"+e.Action+"} ? false : true }":n)?a:"true"},getLabelTextForDataField:function(e,t,n,a,r,i){const o=e["@com.sap.vocabularies.Common.v1.DraftRoot"];return M.getSemanticKeyTitle(t["@com.sap.vocabularies.Common.v1.Text"]&&n,a,r,t["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"],i,o)},retrieveTextFromValueList:function(e,t,n){const a=`${e.sPath}/${t}`;const r=n.displayMode;f.setMetaModel(e.getModel());return"{= FieldRuntime.retrieveTextFromValueList(%{"+t+"},'"+a+"','"+r+"')}"},computeLabelText:function(e,t){const n=t.context.getModel();let a=t.context.getPath();if(a.endsWith("/")){a=a.slice(0,a.lastIndexOf("/"))}const r=n.getObject(`${a}/Label`);if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return undefined}if(r){return r}else if(r===""){return""}let i;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(e.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.UI.v1.DataPoint")>-1||e.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.UI.v1.Chart")>-1){i=n.getObject(`${a}/Target/$AnnotationPath@/Title`)}if(e.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")>-1){i=n.getObject(`${a}/Target/$AnnotationPath@/fn/$Path@com.sap.vocabularies.Common.v1.Label`)}}if(i){return i}let o;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){o=n.getObject(`${a}/Target/$AnnotationPath@/Label`)}if(o){return o}const s=n.getObject(`${a}/Value/$Path@com.sap.vocabularies.Common.v1.Label`);if(s){return s}let c;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){c=n.getObject(`${a}/Target/$AnnotationPath/Value/$Path@com.sap.vocabularies.Common.v1.Label`)}if(c){return c}return""},buildExpressionForAlignItems:function(e){const t=F(e);const n=F("com.sap.vocabularies.UI.v1.VisualizationType/Progress");const a=F("com.sap.vocabularies.UI.v1.VisualizationType/Rating");return D(x(T(I(t,n),I(t,a)),F("Center"),x(C.IsEditable,F("Center"),F("Stretch"))))},hasValueHelpAnnotation:function(e){if(e){return e["@com.sap.vocabularies.Common.v1.ValueListReferences"]||e["@com.sap.vocabularies.Common.v1.ValueListMapping"]||e["@com.sap.vocabularies.Common.v1.ValueList"]}return false},getAPDialogDisplayFormat:function(e,n){let a;const r=n.context.getModel();const i=n.context.getPath();const o=e.$Name||n.context.getProperty(`${i}@sapui.name`);const s=r.getObject(`${i}@`);const c=s["@com.sap.vocabularies.Common.v1.ValueList"]||s["@com.sap.vocabularies.Common.v1.ValueListMapping"]||s["@com.sap.vocabularies.Common.v1.ValueListReferences"];const l=function(e){const t=e.Parameters.find(function(e){return e.LocalDataProperty&&e.LocalDataProperty.$PropertyPath===o});return t&&t.ValueListProperty};let u;if(s["@com.sap.vocabularies.Common.v1.TextArrangement"]||s["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]){return t.computeDisplayMode(s,undefined)}else if(c){if(c.CollectionPath){u=l(c);if(!u){return"Value"}a=r.getObject(`/${c.CollectionPath}/${u}@`);return a&&a["@com.sap.vocabularies.Common.v1.Text"]?t.computeDisplayMode(a,undefined):"Value"}else{return r.requestValueListInfo(i,true).then(function(e){u=l(e[""]);if(!u){return"Value"}a=e[""].$model.getMetaModel().getObject(`/${e[""]["CollectionPath"]}/${u}@`);return a&&a["@com.sap.vocabularies.Common.v1.Text"]?t.computeDisplayMode(a,undefined):"Value"})}}else{return"Value"}},getActionParameterDialogFieldHelp:function(e,t,n){return this.hasValueHelpAnnotation(e)?h([t,n]):undefined},getValueHelpDelegate:function(e,t,n,a){const r={name:f.addSingleQuotes("sap/fe/macros/valuehelp/ValueHelpDelegate"),payload:{propertyPath:f.addSingleQuotes(m.getPropertyPath({UnboundAction:!e,EntityTypePath:t,Action:n,Property:a})),qualifiers:{},valueHelpQualifier:f.addSingleQuotes(""),isActionParameterDialog:true}};return f.objectToString(r)},getValueHelpDelegateForNonComputedVisibleKeyField:function(e){const t={name:f.addSingleQuotes("sap/fe/macros/valuehelp/ValueHelpDelegate"),payload:{propertyPath:f.addSingleQuotes(e),qualifiers:{},valueHelpQualifier:f.addSingleQuotes("")}};return f.objectToString(t)},_getEntitySetFromMultiLevel:function(e,t,n,a,r){let i=t.split("/").filter(Boolean);i=i.filter(function(e){return e!=="$NavigationPropertyBinding"});if(i.length>0){for(let t=a;t<i.length-r;t++){n=`/${e.getObject(`${n}/$NavigationPropertyBinding/${i[t]}`)}`}}return n},getPropertyCollection:function(e,t){const n=t&&t.context||e;const a=n.getPath();const r=a.split("/").filter(Boolean);const i=r[0];const o=n.getObject("$Path");let s=`/${i}`;if(a.indexOf("/@com.sap.vocabularies.")>-1){const e=a.indexOf("/@com.sap.vocabularies.");const t=a.substring(0,e);s=M._getEntitySetFromMultiLevel(n,t,s,1,0)}if(o&&o.indexOf("/")>-1){s=M._getEntitySetFromMultiLevel(n,o,s,0,1)}return s},getUnitOrCurrency:function(e){const t=e.getObject();let n=e.sPath;if(t["@Org.OData.Measures.V1.ISOCurrency"]){n=`${n}Org.OData.Measures.V1.ISOCurrency`}else{n=`${n}Org.OData.Measures.V1.Unit`}return n},hasStaticUnitOrCurrency:function(e){return e["@Org.OData.Measures.V1.ISOCurrency"]?!e["@Org.OData.Measures.V1.ISOCurrency"].$Path:!e["@Org.OData.Measures.V1.Unit"].$Path},getStaticUnitOrCurrency:function(e,t){if(t&&t.measureDisplayMode!=="Hidden"){const t=e["@Org.OData.Measures.V1.ISOCurrency"]||e["@Org.OData.Measures.V1.Unit"];const n=d.getDateInstance();const a=n.oLocaleData.mData;if(a&&a.units&&a.units.short&&a.units.short[t]&&a.units.short[t].displayName){return a.units.short[t].displayName}return t}},getEmptyIndicatorTrigger:function(e,t,n){if(n){return e?n:"inactive"}return e?t:"inactive"},getBindingInfoForTextArrangement:function(e,t,n){if(t&&t.$EnumMember&&t.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"&&n){return`{${n.Value.$Path}}`}return undefined},semanticKeyFormat:function(e,t){t.arguments=[{},{groupingEnabled:false}];return b.format(e,t)},getIsMediaContentTypeNullExpr:function(e,t){t=t||"===";return"{= %{"+e+"@odata.mediaContentType} "+t+" null }"},getPathForIconSource:function(e){return"{= FIELDRUNTIME.getIconForMimeType(%{"+e+"@odata.mediaContentType})}"},getFilenameExpr:function(e,t){if(e){if(e.indexOf("{")===0){return"{= $"+e+" ? $"+e+" : $"+t+"}"}return e}return t},calculateMBfromByte:function(e){return e?(e/(1024*1024)).toFixed(6):undefined},getDownloadUrl:function(e){return e+"{= ${internal>/stickySessionToken} ? ('?SAP-ContextId=' + ${internal>/stickySessionToken}) : '' }"},getMarginClass:function(e){return e==="true"||e===true?"sapMTableContentMargin":undefined},getRequired:function(e,t,n){let a=F(false);if(t!==null){a=$(t===null||t===void 0?void 0:t.targetObject)}return D(T(a,n.indexOf(e)>-1))},isFieldPartOfForm:function(e,t){const n=A.generateKeyFromDataField(t.targetObject);const a=e.find(e=>e.key===n);return a?true:false}};M.buildExpressionForTextValue.requiresIContext=true;M.getFieldGroupIds.requiresIContext=true;M.fieldControl.requiresIContext=true;M.getTypeAlignment.requiresIContext=true;M.getPropertyCollection.requiresIContext=true;M.getAPDialogDisplayFormat.requiresIContext=true;M.semanticKeyFormat.requiresIContext=true;M.computeLabelText.requiresIContext=true;M.retrieveTextFromValueList.requiresIContext=true;M.getActionParameterVisibility.requiresIContext=true;return M},false);
//# sourceMappingURL=FieldHelper.js.map