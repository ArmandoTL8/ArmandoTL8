/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/uid","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/buildingBlocks/BuildingBlockRuntime","sap/fe/core/converters/controls/Common/DataVisualization","sap/fe/core/converters/helpers/Aggregation","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/macros/CommonHelper","sap/ui/model/json/JSONModel","../internal/helpers/ActionHelper","../internal/helpers/DefaultActionHandler","../ODataMetaModelUtil","./ChartHelper"],function(e,t,n,a,i,r,o,s,l,c,u,d,g,p,m,b,h){"use strict";var f,v,P,A,y,x,M,C,$,O,D,B,I,T,z,S,_,w,j,E,V,k,F,N,H,U,L,R,W,q,G,J,K,X,Y,Q,Z,ee,te,ne,ae,ie,re,oe,se,le,ce,ue,de,ge,pe,me,be,he,fe,ve,Pe,Ae,ye,xe,Me,Ce,$e,Oe;var De={};var Be=u.getContextRelativeTargetObjectPath;var Ie=c.generate;var Te=s.resolveBindingString;var ze=o.getInvolvedDataModelObjects;var Se=r.AggregationHelper;var _e=i.getVisualizationsFromPresentationVariant;var we=i.getDataVisualizationConfiguration;var je=a.xml;var Ee=a.escapeXMLAttributeValue;var Ve=n.defineBuildingBlock;var ke=n.BuildingBlockBase;var Fe=n.blockEvent;var Ne=n.blockAttribute;var He=n.blockAggregation;function Ue(e,t,n,a){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(a):void 0})}function Le(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function Re(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;We(e,t)}function We(e,t){We=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return We(e,t)}function qe(e,t,n,a,i){var r={};Object.keys(a).forEach(function(e){r[e]=a[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=n.slice().reverse().reduce(function(n,a){return a(e,t,n)||n},r);if(i&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(i):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}function Ge(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}const Je={"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1":"axis1","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis2":"axis2","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis3":"axis3","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis4":"axis4"};var Ke;(function(e){e["Sort"]="Sort";e["Type"]="Type";e["Item"]="Item"})(Ke||(Ke={}));const Xe=function(e){var t;let n=null;const a=e;let i=[];const r=(t=a.getAttribute("key"))===null||t===void 0?void 0:t.replace("InlineXML_","");if(a.children.length&&a.localName==="ActionGroup"&&a.namespaceURI==="sap.fe.macros"){const e=Array.prototype.slice.apply(a.children);let t=0;n=e.reduce((e,n)=>{var a;const i=((a=n.getAttribute("key"))===null||a===void 0?void 0:a.replace("InlineXML_",""))||r+"_Menu_"+t;const o={key:i,text:n.getAttribute("text"),__noWrap:true,press:n.getAttribute("press"),requiresSelection:n.getAttribute("requiresSelection")==="true",enabled:n.getAttribute("enabled")===null?true:n.getAttribute("enabled")===true};e[o.key]=o;t++;return e},{});i=Object.values(n).slice(-a.children.length).map(function(e){return e.key})}return{key:r,text:a.getAttribute("text"),position:{placement:a.getAttribute("placement"),anchor:a.getAttribute("anchor")},__noWrap:true,press:a.getAttribute("press"),requiresSelection:a.getAttribute("requiresSelection")==="true",enabled:a.getAttribute("enabled")===null?true:a.getAttribute("enabled"),menu:i.length?i:null,menuContentActions:n}};let Ye=(f=Ve({name:"Chart",namespace:"sap.fe.macros.internal",publicNamespace:"sap.fe.macros"}),v=Ne({type:"string",isPublic:true}),P=Ne({type:"sap.ui.model.Context"}),A=Ne({type:"sap.ui.model.Context",isPublic:true}),y=Ne({type:"sap.ui.model.Context",isPublic:true}),x=Ne({type:"string",defaultValue:"100%"}),M=Ne({type:"string",defaultValue:"100%"}),C=Ne({type:"string",isPublic:true}),$=Ne({type:"boolean",isPublic:true}),O=Ne({type:"sap.ui.core.TitleLevel",defaultValue:"Auto",isPublic:true}),D=Ne({type:"string",defaultValue:"MULTIPLE",isPublic:true}),B=Ne({type:"string|boolean",isPublic:true}),I=Ne({type:"string",isPublic:true}),T=Ne({type:"string"}),z=Ne({type:"string"}),S=Ne({type:"string"}),_=Ne({type:"sap.ui.model.Context"}),w=Ne({type:"boolean"}),j=Ne({type:"boolean"}),E=Ne({type:"string"}),V=Ne({type:"string"}),k=Ne({type:"string"}),F=Ne({type:"string"}),N=Ne({type:"boolean",defaultValue:false}),H=Ne({type:"string",isPublic:true}),U=Fe(),L=Fe(),R=He({type:"sap.fe.macros.internal.chart.Action | sap.fe.macros.internal.chart.ActionGroup",isPublic:true,processAggregations:Xe}),W=Fe(),q=Fe(),G=Fe(),f(J=(K=(Oe=function(n){Re(a,n);function a(i,r,o){var s,c,u,f,v;var P;P=n.call(this,i,r,o)||this;Ue(P,"id",X,Le(P));Ue(P,"chartDefinition",Y,Le(P));Ue(P,"metaPath",Q,Le(P));Ue(P,"contextPath",Z,Le(P));Ue(P,"height",ee,Le(P));Ue(P,"width",te,Le(P));Ue(P,"header",ne,Le(P));Ue(P,"headerVisible",ae,Le(P));Ue(P,"headerLevel",ie,Le(P));Ue(P,"selectionMode",re,Le(P));Ue(P,"personalization",oe,Le(P));Ue(P,"filterBar",se,Le(P));Ue(P,"noDataText",le,Le(P));Ue(P,"chartDelegate",ce,Le(P));Ue(P,"vizProperties",ue,Le(P));Ue(P,"chartActions",de,Le(P));Ue(P,"draftSupported",ge,Le(P));Ue(P,"autoBindOnInit",pe,Le(P));Ue(P,"visible",me,Le(P));Ue(P,"navigationPath",be,Le(P));Ue(P,"filter",he,Le(P));Ue(P,"measures",fe,Le(P));Ue(P,"_applyIdToContent",ve,Le(P));Ue(P,"variantManagement",Pe,Le(P));Ue(P,"variantSelected",Ae,Le(P));Ue(P,"variantSaved",ye,Le(P));Ue(P,"actions",xe,Le(P));Ue(P,"onSegmentedButtonPressed",Me,Le(P));Ue(P,"selectionChange",Ce,Le(P));Ue(P,"stateChange",$e,Le(P));P._commandActions=[];P.createChartDefinition=(e,t,n)=>{var i;let r=Be(n);if(((i=e.metaPath)===null||i===void 0?void 0:i.getObject().$Type)==="com.sap.vocabularies.UI.v1.PresentationVariantType"){const t=e.metaPath.getObject().Visualizations;r=a.checkChartVisualizationPath(t,r)}const o=we(r,e.useCondensedLayout,t);e.chartDefinition=o.visualizations[0];P.chartDefinition=o.visualizations[0];return P.chartDefinition};P.createBindingContext=function(e,n){const a=`/${t()}`;n.models.converterContext.setProperty(a,e);return n.models.converterContext.createBindingContext(a)};P.getChartMeasures=(t,n)=>{const a=t.chartDefinition.annotationPath.split("/");const i=a.filter(function(e,t){return a.indexOf(e)==t}).toString().replaceAll(",","/");const r=ze(P.metaPath.getModel().createBindingContext(i),P.contextPath).targetObject;const o=h.getUiChart(P.metaPath);const s=o.getObject();const l=n.getAggregatedProperties("AggregatedProperty");let c=[];const u=t.metaPath.getPath();const d=n.getAggregatedProperties("AggregatedProperties");const p=r.Measures?r.Measures:[];const m=r.DynamicMeasures?r.DynamicMeasures:[];const b=d[0]?d[0].filter(function(e){return p.some(function(t){return e.Name===t.value})}):undefined;const f=u.replace(/@com.sap.vocabularies.UI.v1.(Chart|PresentationVariant|SelectionPresentationVariant).*/,"");const v=t.chartDefinition.transAgg;const A=t.chartDefinition.customAgg;if(l.length>0&&!m&&b.length>0){e.warning("The transformational aggregate measures are configured as Chart.Measures but should be configured as Chart.DynamicMeasures instead. Please check the SAP Help documentation and correct the configuration accordingly.")}const y=p.some(e=>{const t=P.getCustomAggMeasure(A,e);return!!t});if(l.length>0&&!m.length&&!y){throw new Error("Please configure DynamicMeasures for the chart")}if(l.length>0){for(const e of m){c=P.getDynamicMeasures(c,e,f,r)}}for(const e of p){const t=e.value;const n=P.getCustomAggMeasure(A,e);const a={};if(n){c=P.setCustomAggMeasure(c,a,n,t)}else if(l.length===0&&v[t]){c=P.setTransAggMeasure(c,a,v,t)}P.setChartMeasureAttributes(s.MeasureAttributes,f,a)}const x=new g(c);x.$$valueAsPromise=true;return x.createBindingContext("/")};P.setCustomAggMeasure=(t,n,a,i)=>{if(i.indexOf("/")>-1){e.error("$expand is not yet supported. Measure: ${sKey} from an association cannot be used")}n.key=a.value;n.role="axis1";n.propertyPath=a.value;t.push(n);return t};P.setTransAggMeasure=(e,t,n,a)=>{const i=n[a];t.key=i.name;t.role="axis1";t.propertyPath=a;t.aggregationMethod=i.aggregationMethod;t.label=i.label||t.label;e.push(t);return e};P.getDynamicMeasures=(t,n,a,i)=>{var r;const o=n.value||"";const s=ze(P.metaPath.getModel().createBindingContext(a+o),P.contextPath).targetObject;if(o.indexOf("/")>-1){e.error("$expand is not yet supported. Measure: ${sKey} from an association cannot be used")}else if(!s){throw new Error("Please provide the right AnnotationPath to the Dynamic Measure "+n.value)}else if(((r=n.value)===null||r===void 0?void 0:r.startsWith("@com.sap.vocabularies.Analytics.v1.AggregatedProperty"))===null){throw new Error("Please provide the right AnnotationPath to the Dynamic Measure "+n.value)}else{const e={key:s.Name,role:"axis1"};e.propertyPath=s.AggregatableProperty.value;e.aggregationMethod=s.AggregationMethod;e.label=Te(s.annotations._annotations["com.sap.vocabularies.Common.v1.Label"]||ze(P.metaPath.getModel().createBindingContext(a+e.propertyPath+"@com.sap.vocabularies.Common.v1.Label"),P.contextPath).targetObject);P.setChartMeasureAttributes(i.MeasureAttributes,a,e);t.push(e)}return t};P.getCustomAggMeasure=(e,t)=>{if(t.value&&e[t.value]){return t}return null};P.setChartMeasureAttributes=(e,t,n)=>{if(e!==null&&e!==void 0&&e.length){for(const a of e){P._setChartMeasureAttribute(a,t,n)}}};P._setChartMeasureAttribute=(e,t,n)=>{var a,i,r;const o=e.DynamicMeasure?e===null||e===void 0?void 0:(a=e.DynamicMeasure)===null||a===void 0?void 0:a.value:e===null||e===void 0?void 0:(i=e.Measure)===null||i===void 0?void 0:i.value;const s=e.DataPoint?e===null||e===void 0?void 0:(r=e.DataPoint)===null||r===void 0?void 0:r.value:null;const l=e.Role;const c=s&&ze(P.metaPath.getModel().createBindingContext(t+s),P.contextPath).targetObject;if(n.key===o){P.setMeasureRole(n,l);P.setMeasureDataPoint(n,c)}};P.setMeasureDataPoint=(e,t)=>{if(t&&t.Value.$Path==e.key){e.dataPoint=P.formatJSONToString(b.createDataPointProperty(t))||""}};P.setMeasureRole=(e,t)=>{if(t){const n=t.$EnumMember;e.role=Je[n]}};P.formatJSONToString=e=>{if(!e){return undefined}let t=JSON.stringify(e);t=t.replace(new RegExp("{","g"),"\\{");t=t.replace(new RegExp("}","g"),"\\}");return t};P.getDependents=e=>{if(P._commandActions.length>0){return P._commandActions.map(t=>P.getActionCommand(t,e))}return je``};P.checkPersonalizationInChartProperties=e=>{if(e.personalization){if(e.personalization==="false"){P.personalization=undefined}else if(e.personalization==="true"){P.personalization=Object.values(Ke).join(",")}else if(P.verifyValidPersonlization(e.personalization)===true){P.personalization=e.personalization}else{P.personalization=undefined}}};P.verifyValidPersonlization=e=>{let t=true;const n=e.split(",");const a=Object.values(Ke);n.forEach(e=>{if(!a.includes(e)){t=false}});return t};P.getVariantManagement=(e,t)=>{let n=e.variantManagement?e.variantManagement:t.variantManagement;n=P.personalization===undefined?"None":n;return n};P.createVariantManagement=()=>{const t=P.personalization;if(t){const e=P.variantManagement;if(e==="Control"){return je`
					<mdc:variant>
					<variant:VariantManagement
						id="${Ie([P.id,"VM"])}"
						for="${P.id}"
						showSetAsDefault="${true}"
						select="${P.variantSelected}"
						headerLevel="${P.headerLevel}"
						save="${P.variantSaved}"
					/>
					</mdc:variant>
			`}else if(e==="None"||e==="Page"){return je``}}else if(!t){e.warning("Variant Management cannot be enabled when personalization is disabled")}return je``};P.getPersistenceProvider=()=>{if(P.variantManagement==="None"){return je`<p13n:PersistenceProvider id="${Ie([P.id,"PersistenceProvider"])}" for="${P.id}"/>`}return je``};P.pushActionCommand=(e,t,n,a)=>{if(t){const i={actionContext:e,onExecuteAction:h.getPressEventForDataFieldForActionButton(P.id,t,n||""),onExecuteIBN:d.getPressHandlerForDataFieldForIBN(t,`\${internal>selectedContexts}`,false),onExecuteManifest:d.buildActionWrapper(a,Le(P))};P._commandActions.push(i)}};P.getActionCommand=(e,t)=>{const n=e.actionContext;const a=n.getObject();const i=a.annotationPath&&P.contextPath.getModel().createBindingContext(a.annotationPath);const r=i&&i.getObject();const o=P.contextPath.getModel().createBindingContext(a.annotationPath+"/Action");const s=d.getActionContext(o);const l=d.getPathToBoundActionOverload(o);const c=P.contextPath.getModel().createBindingContext(l).getObject();const u=Ee(h.getOperationAvailableMap(t.getObject(),{context:t}));const g=a.enabled?a.enabled:h.isDataFieldForActionButtonEnabled(c&&c.$IsBound,r.Action,P.contextPath,u||"",a.enableOnSelect||"");let p;if(a.enabled){p=a.enabled}else if(r.RequiresContext){p="{= %{internal>numberOfSelectedContexts} >= 1}"}const m=je`<internalMacro:ActionCommand
		action="${a}"
		onExecuteAction="${e.onExecuteAction}"
		onExecuteIBN="${e.onExecuteIBN}"
		onExecuteManifest="${e.onExecuteManifest}"
		isIBNEnabled="${p}"
		isActionEnabled="${g}"
		visible="${P.getVisible(i)}"
	/>`;if(a.type=="ForAction"&&(!c||c.IsBound!==true||s["@Org.OData.Core.V1.OperationAvailable"]!==false)){return m}else if(a.type=="ForAction"){return je``}else{return m}};P.getItems=e=>{const t=e.getObject();const n=[];const a=[];if(t.Dimensions){h.formatDimensions(e).getObject().forEach(e=>{e.id=Ie([P.id,"dimension",e.key]);n.push(P.getItem({id:e.id,key:e.key,label:e.label,role:e.role},"_fe_groupable_","groupable"))})}if(P.measures){h.formatMeasures(P.measures).forEach(e=>{e.id=Ie([P.id,"measure",e.key]);a.push(P.getItem({id:e.id,key:e.key,label:e.label,role:e.role},"_fe_aggregatable_","aggregatable"))})}if(n.length&&a.length){return n.concat(a)}return je``};P.getItem=(e,t,n)=>je`<chart:Item
			id="${e.id}"
			name="${t+e.key}"
			type="${n}"
			label="${Te(e.label,"string")}"
			role="${e.role}"
		/>`;P.getToolbarActions=e=>{const t=P.getActions(e);if(P.onSegmentedButtonPressed){t.push(P.getSegmentedButton())}if(t.length>0){return je`<mdc:actions>${t}</mdc:actions>`}return je``};P.getActions=e=>{var t;let n=(t=P.chartActions)===null||t===void 0?void 0:t.getObject();n=P.removeMenuItems(n);return n.map(t=>{if(t.annotationPath){return P.getAction(t,e,false)}else if(t.hasOwnProperty("noWrap")){return P.getCustomActions(t,e)}})};P.removeMenuItems=e=>{for(const t of e){if(t.menu){t.menu.forEach(t=>{if(e.indexOf(t)!==-1){e.splice(e.indexOf(t),1)}})}}return e};P.getCustomActions=(e,t)=>{let n=e.enabled;if((e.requiresSelection??false)&&e.enabled==="true"){n="{= %{internal>numberOfSelectedContexts} >= 1}"}if(e.type==="Default"){return P.getActionToolbarAction(e,{id:Ie([P.id,e.id]),unittestid:"DataFieldForActionButtonAction",label:e.text?e.text:"",ariaHasPopup:undefined,press:e.press?e.press:"",enabled:n,visible:e.visible?e.visible:false},false)}else if(e.type==="Menu"){return P.getActionToolbarMenuAction({id:Ie([P.id,e.id]),text:e.text,visible:e.visible,enabled:n,useDefaultActionOnly:m.getUseDefaultActionOnly(e),buttonMode:m.getButtonMode(e),defaultAction:undefined,actions:e},t)}};P.getMenuItemFromMenu=(e,t)=>{let n;if(e.annotationPath){return P.getAction(e,t,true)}if(e.command){n="cmd:"+e.command}else if(e.noWrap??false){n=e.press}else{n=d.buildActionWrapper(e,Le(P))}return je`<MenuItem
		core:require="{FPM: 'sap/fe/core/helpers/FPMHelper'}"
		text="${e.text}"
		press="${n}"
		visible="${e.visible}"
		enabled="${e.enabled}"
	/>`};P.getActionToolbarMenuAction=(e,t)=>{var n,a;const i=(n=e.actions)===null||n===void 0?void 0:(a=n.menu)===null||a===void 0?void 0:a.map(e=>P.getMenuItemFromMenu(e,t));return je`<mdcat:ActionToolbarAction>
			<MenuButton
			text="${e.text}"
			type="Transparent"
			menuPosition="BeginBottom"
			id="${e.id}"
			visible="${e.visible}"
			enabled="${e.enabled}"
			useDefaultActionOnly="${e.useDefaultActionOnly}"
			buttonMode="${e.buttonMode}"
			defaultAction="${e.defaultAction}"
			>
				<menu>
					<Menu>
						${i}
					</Menu>
				</menu>
			</MenuButton>
		</mdcat:ActionToolbarAction>`};P.getAction=(e,t,n)=>{const a=P.contextPath.getModel().createBindingContext(e.annotationPath||"");if(e.type==="ForNavigation"){return P.getNavigationActions(e,a,n)}else if(e.type==="ForAction"){return P.getAnnotationActions(t,e,a,n)}return je``};P.getNavigationActions=(e,t,n)=>{let a="true";const i=t.getObject();if(e.enabled!==undefined){a=e.enabled}else if(i.RequiresContext){a="{= %{internal>numberOfSelectedContexts} >= 1}"}return P.getActionToolbarAction(e,{id:undefined,unittestid:"DataFieldForIntentBasedNavigationButtonAction",label:i.Label,ariaHasPopup:undefined,press:d.getPressHandlerForDataFieldForIBN(i,`\${internal>selectedContexts}`,false),enabled:a,visible:P.getVisible(t)},n)};P.getAnnotationActions=(e,t,n,a)=>{const i=P.contextPath.getModel().createBindingContext(t.annotationPath+"/Action");const r=P.contextPath.getModel().createBindingContext(d.getActionContext(i));const o=r.getObject();const s=d.getPathToBoundActionOverload(i);const l=P.contextPath.getModel().createBindingContext(s).getObject();const c=n.getObject();if(!l||l.$IsBound!==true||o["@Org.OData.Core.V1.OperationAvailable"]!==false){const i=P.getAnnotationActionsEnabled(t,l,c,e);const s=d.isDialog(o,{context:r});const u=Ee(h.getOperationAvailableMap(e.getObject(),{context:e}))||"";return P.getActionToolbarAction(t,{id:Ie([P.id,ze(n)]),unittestid:"DataFieldForActionButtonAction",label:c.Label,ariaHasPopup:s,press:h.getPressEventForDataFieldForActionButton(P.id,c,u),enabled:i,visible:P.getVisible(n)},a)}return je``};P.getActionToolbarAction=(e,t,n)=>{if(n){return je`
			<MenuItem
				text="${t.label}"
				press="${e.command?"cmd:"+e.command:t.press}"
				enabled="${t.enabled}"
				visible="${t.visible}"
			/>`}else{return P.buildAction(e,t)}};P.buildAction=(e,t)=>{let n="";if(e.hasOwnProperty("noWrap")){if(e.command){n="cmd:"+e.command}else if(e.noWrap===true){n=t.press}else if(!e.annotationPath){n=d.buildActionWrapper(e,Le(P))}return je`<mdcat:ActionToolbarAction>
			<Button
				core:require="{FPM: 'sap/fe/core/helpers/FPMHelper'}"
				unittest:id="${t.unittestid}"
				id="${t.id}"
				text="${t.label}"
				ariaHasPopup="${t.ariaHasPopup}"
				press="${n}"
				enabled="${t.enabled}"
				visible="${t.visible}"
			/>
		   </mdcat:ActionToolbarAction>`}else{return je`<mdcat:ActionToolbarAction>
			<Button
				unittest:id="${t.unittestid}"
				id="${t.id}"
				text="${t.label}"
				ariaHasPopup="${t.ariaHasPopup}"
				press="${e.command?"cmd:"+e.command:t.press}"
				enabled="${t.enabled}"
				visible="${t.visible}"
			/>
		</mdcat:ActionToolbarAction>`}};P.getAnnotationActionsEnabled=(e,t,n,a)=>e.enabled!==undefined?e.enabled:h.isDataFieldForActionButtonEnabled(t&&t.$IsBound,n.Action,P.contextPath,h.getOperationAvailableMap(a.getObject(),{context:a}),e.enableOnSelect||"");P.getSegmentedButton=()=>je`<mdcat:ActionToolbarAction layoutInformation="{
			aggregationName: 'end',
			alignment: 'End'
		}">
			<SegmentedButton
				id="${Ie([P.id,"SegmentedButton","TemplateContentView"])}"
				select="${P.onSegmentedButtonPressed}"
				visible="{= \${pageInternal>alpContentView} !== 'Table' }"
				selectedKey="{pageInternal>alpContentView}"
			>
				<items>
					${P.getSegmentedButtonItems()}
				</items>
			</SegmentedButton>
		</mdcat:ActionToolbarAction>`;P.getSegmentedButtonItems=()=>{const e=[];if(d.isDesktop()){e.push(P.getSegmentedButtonItem("{sap.fe.i18n>M_COMMON_HYBRID_SEGMENTED_BUTTON_ITEM_TOOLTIP}","Hybrid","sap-icon://chart-table-view"))}e.push(P.getSegmentedButtonItem("{sap.fe.i18n>M_COMMON_CHART_SEGMENTED_BUTTON_ITEM_TOOLTIP}","Chart","sap-icon://bar-chart"));e.push(P.getSegmentedButtonItem("{sap.fe.i18n>M_COMMON_TABLE_SEGMENTED_BUTTON_ITEM_TOOLTIP}","Table","sap-icon://table-view"));return e};P.getSegmentedButtonItem=(e,t,n)=>je`<SegmentedButtonItem
			tooltip="${e}"
			key="${t}"
			icon="${n}"
		/>`;P.getVisible=e=>{const t=e.getObject();if(t["@com.sap.vocabularies.UI.v1.Hidden"]&&t["@com.sap.vocabularies.UI.v1.Hidden"].$Path){const n=P.contextPath.getModel().createBindingContext(e.getPath()+"/@com.sap.vocabularies.UI.v1.Hidden/$Path",t["@com.sap.vocabularies.UI.v1.Hidden"].$Path);return h.getHiddenPathExpressionForTableActionsAndIBN(t["@com.sap.vocabularies.UI.v1.Hidden"].$Path,{context:n})}else if(t["@com.sap.vocabularies.UI.v1.Hidden"]){return!t["@com.sap.vocabularies.UI.v1.Hidden"]}else{return true}};P.getContextPath=()=>P.contextPath.getPath().lastIndexOf("/")===P.contextPath.getPath().length-1?P.contextPath.getPath().replaceAll("/",""):P.contextPath.getPath().split("/")[P.contextPath.getPath().split("/").length-1];const A=ze(i.metaPath,i.contextPath);const y=P.getConverterContext(A,undefined,o);const x=a.getVisualizationPath(i,A,y);const M=a.getExtraParams(i,x);const C=P.getConverterContext(A,undefined,o,M);const $=new Se(C.getEntityType(),C);const O=i.chartDefinition===undefined||i.chartDefinition===null?P.createChartDefinition(i,C,A):i.chartDefinition;P.navigationPath=O.navigationPath;P.autoBindOnInit=O.autoBindOnInit;P.vizProperties=O.vizProperties;P.chartActions=P.createBindingContext(O.actions,o);P.selectionMode=i.selectionMode.toUpperCase();if(i.filterBar){P.filter=P.getContentId(i.filterBar)}else if(!i.filter){P.filter=O.filterId}P.onSegmentedButtonPressed=O.onSegmentedButtonPressed;P.checkPersonalizationInChartProperties(i);P.variantManagement=P.getVariantManagement(i,O);P.visible=O.visible;let D=i.contextPath.getPath();D=D[D.length-1]==="/"?D.slice(0,-1):D;P.draftSupported=l.isDraftSupported(o.models.metaModel,D);if(i._applyIdToContent??false){P._apiId=i.id+"::Chart";P._contentId=i.id}else{P._apiId=i.id;P._contentId=P.getContentId(i.id)}const B=h.getUiChart(P.metaPath);const I=B.getObject();P._chartType=h.formatChartType(I.ChartType);const T=h.getOperationAvailableMap(B.getObject(),{context:B});if(Object.keys((s=P.chartDefinition)===null||s===void 0?void 0:s.commandActions).length>0){var z;Object.keys((z=P.chartDefinition)===null||z===void 0?void 0:z.commandActions).forEach(e=>{var t;const n=(t=P.chartDefinition)===null||t===void 0?void 0:t.commandActions[e];const a=P.createBindingContext(n,o);const i=n.annotationPath&&P.contextPath.getModel().createBindingContext(n.annotationPath);const r=i&&i.getObject();const s=Ee(T);P.pushActionCommand(a,r,s,n)})}P.measures=P.getChartMeasures(i,$);const S=d.createPresentationPathContext(P.metaPath);P._sortCondtions=h.getSortConditions(P.metaPath,P.metaPath.getObject(),S.getPath(),P.chartDefinition.applySupported);const _=P.contextPath.getModel().createBindingContext(B.getPath()+"/Actions",I.Actions);const w=P.contextPath.getModel().createBindingContext(P.contextPath.getPath(),P.contextPath);const j=d.getContextPath(P.contextPath,{context:w});const E=d.getTargetCollection(P.contextPath);const V=P.contextPath.getModel().createBindingContext(E,P.contextPath);P._customData={targetCollectionPath:j,entitySet:typeof V.getObject()==="string"?V.getObject():V.getObject("@sapui.name"),entityType:j+"/",operationAvailableMap:d.stringifyCustomData(JSON.parse(T)),multiSelectDisabledActions:p.getMultiSelectDisabledActions(I.Actions,{context:_})+"",segmentedButtonId:Ie([P.id,"SegmentedButton","TemplateContentView"]),customAgg:d.stringifyCustomData((c=P.chartDefinition)===null||c===void 0?void 0:c.customAgg),transAgg:d.stringifyCustomData((u=P.chartDefinition)===null||u===void 0?void 0:u.transAgg),applySupported:d.stringifyCustomData((f=P.chartDefinition)===null||f===void 0?void 0:f.applySupported),vizProperties:P.vizProperties,draftSupported:P.draftSupported,multiViews:(v=P.chartDefinition)===null||v===void 0?void 0:v.multiViews};P._actions=P.chartActions?P.getToolbarActions(B):je``;return P}De=a;var i=a.prototype;i.getContentId=function e(t){return`${t}-content`};a.getExtraParams=function e(t,n){const a={};if(t.actions){var i;(i=Object.values(t.actions))===null||i===void 0?void 0:i.forEach(e=>{t.actions={...t.actions,...e.menuContentActions};delete e.menuContentActions})}if(n){a[n]={actions:t.actions}}return a};i.getTemplate=function e(){const t=h.getUiChart(this.metaPath);const n=t.getObject();let a="";if(this.chartDelegate){a=this.chartDelegate}else{const e=this.getContextPath();a="{name:'sap/fe/macros/chart/ChartDelegate', payload: {contextPath: '"+e+"', parameters:{$$groupId:'$auto.Workers'}, selectionMode: '"+this.selectionMode+"'}}"}const i="{internal>controls/"+this.id+"}";if(!this.header){this.header=n.Title}return je`
			<macro:ChartAPI xmlns="sap.m" xmlns:macro="sap.fe.macros.chart" xmlns:variant="sap.ui.fl.variants" xmlns:p13n="sap.ui.mdc.p13n" xmlns:unittest="http://schemas.sap.com/sapui5/preprocessorextension/sap.fe.unittesting/1" xmlns:macrodata="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1" xmlns:internalMacro="sap.fe.macros.internal" xmlns:chart="sap.ui.mdc.chart" xmlns:mdc="sap.ui.mdc" xmlns:mdcat="sap.ui.mdc.actiontoolbar" xmlns:core="sap.ui.core" id="${this._apiId}" selectionChange="${this.selectionChange}" stateChange="${this.stateChange}">
				<macro:layoutData>
					<FlexItemData growFactor="1" shrinkFactor="1" />
				</macro:layoutData>
				<mdc:Chart
					binding="${i}"
					unittest:id="ChartMacroFragment"
					id="${this._contentId}"
					chartType="${this._chartType}"
					sortConditions="${this._sortCondtions}"
					header="${this.header}"
					headerVisible="${this.headerVisible}"
					height="${this.height}"
					width="${this.width}"
					headerLevel="${this.headerLevel}"
					p13nMode="${this.personalization}"
					filter="${this.filter}"
					noDataText="${this.noDataText}"
					autoBindOnInit="${this.autoBindOnInit}"
					delegate="${a}"
					macrodata:targetCollectionPath="${this._customData.targetCollectionPath}"
					macrodata:entitySet="${this._customData.entitySet}"
					macrodata:entityType="${this._customData.entityType}"
					macrodata:operationAvailableMap="${this._customData.operationAvailableMap}"
					macrodata:multiSelectDisabledActions="${this._customData.multiSelectDisabledActions}"
					macrodata:segmentedButtonId="${this._customData.segmentedButtonId}"
					macrodata:customAgg="${this._customData.customAgg}"
					macrodata:transAgg="${this._customData.transAgg}"
					macrodata:applySupported="${this._customData.applySupported}"
					macrodata:vizProperties="${this._customData.vizProperties}"
					macrodata:draftSupported="${this._customData.draftSupported}"
					macrodata:multiViews="${this._customData.multiViews}"
					visible="${this.visible}"
				>
				<mdc:dependents>
					${this.getDependents(t)}
					${this.getPersistenceProvider()}
				</mdc:dependents>
				<mdc:items>
					${this.getItems(t)}
				</mdc:items>
				${this._actions}
				${this.createVariantManagement()}
			</mdc:Chart>
		</macro:ChartAPI>`};return a}(ke),Oe.checkChartVisualizationPath=(e,t)=>{e.forEach(function(e){if(e.$AnnotationPath.indexOf("@com.sap.vocabularies.UI.v1.Chart")>-1){t=e.$AnnotationPath}});return t},Oe.getVisualizationPath=(t,n,a)=>{var i;let r=Be(n);if(n.targetObject.term==="com.sap.vocabularies.UI.v1.Chart"){return r}if(((i=t.metaPath)===null||i===void 0?void 0:i.getObject().$Type)==="com.sap.vocabularies.UI.v1.PresentationVariantType"){const e=t.metaPath.getObject().Visualizations;r=Oe.checkChartVisualizationPath(e,r)}if(r){var o;const t=a.getEntityTypeAnnotation(r);let i=[];switch((o=n.targetObject)===null||o===void 0?void 0:o.term){case"com.sap.vocabularies.UI.v1.SelectionPresentationVariant":if(n.targetObject.PresentationVariant){i=_e(n.targetObject.PresentationVariant,r,t.converterContext)}break;case"com.sap.vocabularies.UI.v1.PresentationVariant":i=_e(n.targetObject,r,t.converterContext);break;default:e.error(`Bad metapath parameter for chart : ${n.targetObject.term}`)}const s=i.find(e=>e.visualization.term==="com.sap.vocabularies.UI.v1.Chart");if(s){return s.annotationPath}else{return r}}else{e.error(`Bad metapath parameter for chart : ${n.targetObject.term}`);return r}},Oe),X=qe(K.prototype,"id",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),Y=qe(K.prototype,"chartDefinition",[P],{configurable:true,enumerable:true,writable:true,initializer:null}),Q=qe(K.prototype,"metaPath",[A],{configurable:true,enumerable:true,writable:true,initializer:null}),Z=qe(K.prototype,"contextPath",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),ee=qe(K.prototype,"height",[x],{configurable:true,enumerable:true,writable:true,initializer:null}),te=qe(K.prototype,"width",[M],{configurable:true,enumerable:true,writable:true,initializer:null}),ne=qe(K.prototype,"header",[C],{configurable:true,enumerable:true,writable:true,initializer:null}),ae=qe(K.prototype,"headerVisible",[$],{configurable:true,enumerable:true,writable:true,initializer:null}),ie=qe(K.prototype,"headerLevel",[O],{configurable:true,enumerable:true,writable:true,initializer:null}),re=qe(K.prototype,"selectionMode",[D],{configurable:true,enumerable:true,writable:true,initializer:null}),oe=qe(K.prototype,"personalization",[B],{configurable:true,enumerable:true,writable:true,initializer:null}),se=qe(K.prototype,"filterBar",[I],{configurable:true,enumerable:true,writable:true,initializer:null}),le=qe(K.prototype,"noDataText",[T],{configurable:true,enumerable:true,writable:true,initializer:null}),ce=qe(K.prototype,"chartDelegate",[z],{configurable:true,enumerable:true,writable:true,initializer:null}),ue=qe(K.prototype,"vizProperties",[S],{configurable:true,enumerable:true,writable:true,initializer:null}),de=qe(K.prototype,"chartActions",[_],{configurable:true,enumerable:true,writable:true,initializer:null}),ge=qe(K.prototype,"draftSupported",[w],{configurable:true,enumerable:true,writable:true,initializer:null}),pe=qe(K.prototype,"autoBindOnInit",[j],{configurable:true,enumerable:true,writable:true,initializer:null}),me=qe(K.prototype,"visible",[E],{configurable:true,enumerable:true,writable:true,initializer:null}),be=qe(K.prototype,"navigationPath",[V],{configurable:true,enumerable:true,writable:true,initializer:null}),he=qe(K.prototype,"filter",[k],{configurable:true,enumerable:true,writable:true,initializer:null}),fe=qe(K.prototype,"measures",[F],{configurable:true,enumerable:true,writable:true,initializer:null}),ve=qe(K.prototype,"_applyIdToContent",[N],{configurable:true,enumerable:true,writable:true,initializer:null}),Pe=qe(K.prototype,"variantManagement",[H],{configurable:true,enumerable:true,writable:true,initializer:null}),Ae=qe(K.prototype,"variantSelected",[U],{configurable:true,enumerable:true,writable:true,initializer:null}),ye=qe(K.prototype,"variantSaved",[L],{configurable:true,enumerable:true,writable:true,initializer:null}),xe=qe(K.prototype,"actions",[R],{configurable:true,enumerable:true,writable:true,initializer:null}),Me=qe(K.prototype,"onSegmentedButtonPressed",[W],{configurable:true,enumerable:true,writable:true,initializer:null}),Ce=qe(K.prototype,"selectionChange",[q],{configurable:true,enumerable:true,writable:true,initializer:null}),$e=qe(K.prototype,"stateChange",[G],{configurable:true,enumerable:true,writable:true,initializer:null}),K))||J);De=Ye;return De},false);
//# sourceMappingURL=ChartBuildingBlock.js.map