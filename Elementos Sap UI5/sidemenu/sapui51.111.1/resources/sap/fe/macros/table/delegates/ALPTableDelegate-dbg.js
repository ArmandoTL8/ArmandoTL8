/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/deepClone", "sap/fe/core/CommonUtils", "sap/fe/macros/chart/ChartUtils", "sap/fe/macros/DelegateUtil", "sap/fe/macros/table/delegates/TableDelegate", "sap/fe/macros/table/Utils", "sap/ui/model/Filter"], function (deepClone, CommonUtils, ChartUtils, DelegateUtil, TableDelegate, TableUtils, Filter) {
  "use strict";

  /**
   * Helper class for sap.ui.mdc.Table.
   * <h3><b>Note:</b></h3>
   * The class is experimental and the API/behaviour is not finalised and hence this should not be used for productive usage.
   *
   * @author SAP SE
   * @private
   * @experimental
   * @since 1.69
   * @alias sap.fe.macros.ALPTableDelegate
   */
  const ALPTableDelegate = Object.assign({}, TableDelegate, {
    _internalUpdateBindingInfo: function (table, bindingInfo) {
      var _getChartControl, _ref;
      let filterInfo;
      let chartFilterInfo = {},
        tableFilterInfo = {};
      let chartFilters;

      // We need to deepClone the info we get from the custom data, otherwise some of its subobjects (e.g. parameters) will
      // be shared with oBindingInfo and modified later (Object.assign only does a shallow clone)
      Object.assign(bindingInfo, deepClone(DelegateUtil.getCustomData(table, "rowsBindingInfo")));
      if (table.getRowBinding()) {
        bindingInfo.suspended = false;
      }
      const view = CommonUtils.getTargetView(table);
      const mdcChart = (_getChartControl = (_ref = view.getController()).getChartControl) === null || _getChartControl === void 0 ? void 0 : _getChartControl.call(_ref);
      const chartSelectionsExist = ChartUtils.getChartSelectionsExist(mdcChart, table);
      tableFilterInfo = TableUtils.getAllFilterInfo(table);
      const tableFilters = tableFilterInfo && tableFilterInfo.filters;
      filterInfo = tableFilterInfo;
      if (chartSelectionsExist) {
        chartFilterInfo = ChartUtils.getAllFilterInfo(mdcChart);
        chartFilters = chartFilterInfo && chartFilterInfo.filters;
        filterInfo = chartFilterInfo;
      }
      const finalFilters = (tableFilters && chartFilters ? tableFilters.concat(chartFilters) : chartFilters || tableFilters) || [];
      const oFilter = finalFilters.length > 0 && new Filter({
        filters: finalFilters,
        and: true
      });
      if (filterInfo.bindingPath) {
        // In case of parameters
        bindingInfo.path = filterInfo.bindingPath;
      }

      // Prepare binding info with filter/search parameters
      TableUtils.updateBindingInfo(bindingInfo, filterInfo, oFilter);
    },
    rebind: function (table, bindingInfo) {
      const internalModelContext = table.getBindingContext("pageInternal");
      const templateContentView = internalModelContext === null || internalModelContext === void 0 ? void 0 : internalModelContext.getProperty(`${internalModelContext.getPath()}/alpContentView`);
      if (templateContentView !== "Chart") {
        TableDelegate.rebind(table, bindingInfo);
      }
    }
  });
  return ALPTableDelegate;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBTFBUYWJsZURlbGVnYXRlIiwiT2JqZWN0IiwiYXNzaWduIiwiVGFibGVEZWxlZ2F0ZSIsIl9pbnRlcm5hbFVwZGF0ZUJpbmRpbmdJbmZvIiwidGFibGUiLCJiaW5kaW5nSW5mbyIsImZpbHRlckluZm8iLCJjaGFydEZpbHRlckluZm8iLCJ0YWJsZUZpbHRlckluZm8iLCJjaGFydEZpbHRlcnMiLCJkZWVwQ2xvbmUiLCJEZWxlZ2F0ZVV0aWwiLCJnZXRDdXN0b21EYXRhIiwiZ2V0Um93QmluZGluZyIsInN1c3BlbmRlZCIsInZpZXciLCJDb21tb25VdGlscyIsImdldFRhcmdldFZpZXciLCJtZGNDaGFydCIsImdldENvbnRyb2xsZXIiLCJnZXRDaGFydENvbnRyb2wiLCJjaGFydFNlbGVjdGlvbnNFeGlzdCIsIkNoYXJ0VXRpbHMiLCJnZXRDaGFydFNlbGVjdGlvbnNFeGlzdCIsIlRhYmxlVXRpbHMiLCJnZXRBbGxGaWx0ZXJJbmZvIiwidGFibGVGaWx0ZXJzIiwiZmlsdGVycyIsImZpbmFsRmlsdGVycyIsImNvbmNhdCIsIm9GaWx0ZXIiLCJsZW5ndGgiLCJGaWx0ZXIiLCJhbmQiLCJiaW5kaW5nUGF0aCIsInBhdGgiLCJ1cGRhdGVCaW5kaW5nSW5mbyIsInJlYmluZCIsImludGVybmFsTW9kZWxDb250ZXh0IiwiZ2V0QmluZGluZ0NvbnRleHQiLCJ0ZW1wbGF0ZUNvbnRlbnRWaWV3IiwiZ2V0UHJvcGVydHkiLCJnZXRQYXRoIl0sInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyJBTFBUYWJsZURlbGVnYXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkZWVwQ2xvbmUgZnJvbSBcInNhcC9iYXNlL3V0aWwvZGVlcENsb25lXCI7XG5pbXBvcnQgQ29tbW9uVXRpbHMgZnJvbSBcInNhcC9mZS9jb3JlL0NvbW1vblV0aWxzXCI7XG5pbXBvcnQgQ2hhcnRVdGlscyBmcm9tIFwic2FwL2ZlL21hY3Jvcy9jaGFydC9DaGFydFV0aWxzXCI7XG5pbXBvcnQgRGVsZWdhdGVVdGlsIGZyb20gXCJzYXAvZmUvbWFjcm9zL0RlbGVnYXRlVXRpbFwiO1xuaW1wb3J0IFRhYmxlRGVsZWdhdGUgZnJvbSBcInNhcC9mZS9tYWNyb3MvdGFibGUvZGVsZWdhdGVzL1RhYmxlRGVsZWdhdGVcIjtcbmltcG9ydCBUYWJsZVV0aWxzIGZyb20gXCJzYXAvZmUvbWFjcm9zL3RhYmxlL1V0aWxzXCI7XG5pbXBvcnQgdHlwZSB7IEJhc2VQcm9wZXJ0eUluZm8gfSBmcm9tIFwic2FwL3VpL2Jhc2UvTWFuYWdlZE9iamVjdFwiO1xuaW1wb3J0IHR5cGUgVGFibGUgZnJvbSBcInNhcC91aS9tZGMvVGFibGVcIjtcbmltcG9ydCBGaWx0ZXIgZnJvbSBcInNhcC91aS9tb2RlbC9GaWx0ZXJcIjtcbi8qKlxuICogSGVscGVyIGNsYXNzIGZvciBzYXAudWkubWRjLlRhYmxlLlxuICogPGgzPjxiPk5vdGU6PC9iPjwvaDM+XG4gKiBUaGUgY2xhc3MgaXMgZXhwZXJpbWVudGFsIGFuZCB0aGUgQVBJL2JlaGF2aW91ciBpcyBub3QgZmluYWxpc2VkIGFuZCBoZW5jZSB0aGlzIHNob3VsZCBub3QgYmUgdXNlZCBmb3IgcHJvZHVjdGl2ZSB1c2FnZS5cbiAqXG4gKiBAYXV0aG9yIFNBUCBTRVxuICogQHByaXZhdGVcbiAqIEBleHBlcmltZW50YWxcbiAqIEBzaW5jZSAxLjY5XG4gKiBAYWxpYXMgc2FwLmZlLm1hY3Jvcy5BTFBUYWJsZURlbGVnYXRlXG4gKi9cbmNvbnN0IEFMUFRhYmxlRGVsZWdhdGUgPSBPYmplY3QuYXNzaWduKHt9LCBUYWJsZURlbGVnYXRlLCB7XG5cdF9pbnRlcm5hbFVwZGF0ZUJpbmRpbmdJbmZvOiBmdW5jdGlvbiAodGFibGU6IFRhYmxlLCBiaW5kaW5nSW5mbzogQmFzZVByb3BlcnR5SW5mbykge1xuXHRcdGxldCBmaWx0ZXJJbmZvO1xuXHRcdGxldCBjaGFydEZpbHRlckluZm86IGFueSA9IHt9LFxuXHRcdFx0dGFibGVGaWx0ZXJJbmZvOiBhbnkgPSB7fTtcblx0XHRsZXQgY2hhcnRGaWx0ZXJzO1xuXG5cdFx0Ly8gV2UgbmVlZCB0byBkZWVwQ2xvbmUgdGhlIGluZm8gd2UgZ2V0IGZyb20gdGhlIGN1c3RvbSBkYXRhLCBvdGhlcndpc2Ugc29tZSBvZiBpdHMgc3Vib2JqZWN0cyAoZS5nLiBwYXJhbWV0ZXJzKSB3aWxsXG5cdFx0Ly8gYmUgc2hhcmVkIHdpdGggb0JpbmRpbmdJbmZvIGFuZCBtb2RpZmllZCBsYXRlciAoT2JqZWN0LmFzc2lnbiBvbmx5IGRvZXMgYSBzaGFsbG93IGNsb25lKVxuXHRcdE9iamVjdC5hc3NpZ24oYmluZGluZ0luZm8sIGRlZXBDbG9uZShEZWxlZ2F0ZVV0aWwuZ2V0Q3VzdG9tRGF0YSh0YWJsZSwgXCJyb3dzQmluZGluZ0luZm9cIikpKTtcblx0XHRpZiAodGFibGUuZ2V0Um93QmluZGluZygpKSB7XG5cdFx0XHRiaW5kaW5nSW5mby5zdXNwZW5kZWQgPSBmYWxzZTtcblx0XHR9XG5cdFx0Y29uc3QgdmlldyA9IENvbW1vblV0aWxzLmdldFRhcmdldFZpZXcodGFibGUpO1xuXHRcdGNvbnN0IG1kY0NoYXJ0ID0gKHZpZXcuZ2V0Q29udHJvbGxlcigpIGFzIGFueSkuZ2V0Q2hhcnRDb250cm9sPy4oKTtcblx0XHRjb25zdCBjaGFydFNlbGVjdGlvbnNFeGlzdCA9IENoYXJ0VXRpbHMuZ2V0Q2hhcnRTZWxlY3Rpb25zRXhpc3QobWRjQ2hhcnQsIHRhYmxlKTtcblx0XHR0YWJsZUZpbHRlckluZm8gPSBUYWJsZVV0aWxzLmdldEFsbEZpbHRlckluZm8odGFibGUpO1xuXHRcdGNvbnN0IHRhYmxlRmlsdGVycyA9IHRhYmxlRmlsdGVySW5mbyAmJiB0YWJsZUZpbHRlckluZm8uZmlsdGVycztcblx0XHRmaWx0ZXJJbmZvID0gdGFibGVGaWx0ZXJJbmZvO1xuXHRcdGlmIChjaGFydFNlbGVjdGlvbnNFeGlzdCkge1xuXHRcdFx0Y2hhcnRGaWx0ZXJJbmZvID0gQ2hhcnRVdGlscy5nZXRBbGxGaWx0ZXJJbmZvKG1kY0NoYXJ0KTtcblx0XHRcdGNoYXJ0RmlsdGVycyA9IGNoYXJ0RmlsdGVySW5mbyAmJiBjaGFydEZpbHRlckluZm8uZmlsdGVycztcblx0XHRcdGZpbHRlckluZm8gPSBjaGFydEZpbHRlckluZm87XG5cdFx0fVxuXHRcdGNvbnN0IGZpbmFsRmlsdGVycyA9ICh0YWJsZUZpbHRlcnMgJiYgY2hhcnRGaWx0ZXJzID8gdGFibGVGaWx0ZXJzLmNvbmNhdChjaGFydEZpbHRlcnMpIDogY2hhcnRGaWx0ZXJzIHx8IHRhYmxlRmlsdGVycykgfHwgW107XG5cdFx0Y29uc3Qgb0ZpbHRlciA9XG5cdFx0XHRmaW5hbEZpbHRlcnMubGVuZ3RoID4gMCAmJlxuXHRcdFx0bmV3IEZpbHRlcih7XG5cdFx0XHRcdGZpbHRlcnM6IGZpbmFsRmlsdGVycyxcblx0XHRcdFx0YW5kOiB0cnVlXG5cdFx0XHR9KTtcblxuXHRcdGlmIChmaWx0ZXJJbmZvLmJpbmRpbmdQYXRoKSB7XG5cdFx0XHQvLyBJbiBjYXNlIG9mIHBhcmFtZXRlcnNcblx0XHRcdGJpbmRpbmdJbmZvLnBhdGggPSBmaWx0ZXJJbmZvLmJpbmRpbmdQYXRoO1xuXHRcdH1cblxuXHRcdC8vIFByZXBhcmUgYmluZGluZyBpbmZvIHdpdGggZmlsdGVyL3NlYXJjaCBwYXJhbWV0ZXJzXG5cdFx0VGFibGVVdGlscy51cGRhdGVCaW5kaW5nSW5mbyhiaW5kaW5nSW5mbywgZmlsdGVySW5mbywgb0ZpbHRlcik7XG5cdH0sXG5cdHJlYmluZDogZnVuY3Rpb24gKHRhYmxlOiBUYWJsZSwgYmluZGluZ0luZm86IGFueSkge1xuXHRcdGNvbnN0IGludGVybmFsTW9kZWxDb250ZXh0ID0gdGFibGUuZ2V0QmluZGluZ0NvbnRleHQoXCJwYWdlSW50ZXJuYWxcIik7XG5cdFx0Y29uc3QgdGVtcGxhdGVDb250ZW50VmlldyA9IGludGVybmFsTW9kZWxDb250ZXh0Py5nZXRQcm9wZXJ0eShgJHtpbnRlcm5hbE1vZGVsQ29udGV4dC5nZXRQYXRoKCl9L2FscENvbnRlbnRWaWV3YCk7XG5cdFx0aWYgKHRlbXBsYXRlQ29udGVudFZpZXcgIT09IFwiQ2hhcnRcIikge1xuXHRcdFx0VGFibGVEZWxlZ2F0ZS5yZWJpbmQodGFibGUsIGJpbmRpbmdJbmZvKTtcblx0XHR9XG5cdH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBBTFBUYWJsZURlbGVnYXRlO1xuIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFBQTtBQUFBOzs7O0VBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtFQUNBLE1BQU1BLGdCQUFnQixHQUFHQyxNQUFNLENBQUNDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRUMsYUFBYSxFQUFFO0lBQ3pEQywwQkFBMEIsRUFBRSxVQUFVQyxLQUFZLEVBQUVDLFdBQTZCLEVBQUU7TUFBQTtNQUNsRixJQUFJQyxVQUFVO01BQ2QsSUFBSUMsZUFBb0IsR0FBRyxDQUFDLENBQUM7UUFDNUJDLGVBQW9CLEdBQUcsQ0FBQyxDQUFDO01BQzFCLElBQUlDLFlBQVk7O01BRWhCO01BQ0E7TUFDQVQsTUFBTSxDQUFDQyxNQUFNLENBQUNJLFdBQVcsRUFBRUssU0FBUyxDQUFDQyxZQUFZLENBQUNDLGFBQWEsQ0FBQ1IsS0FBSyxFQUFFLGlCQUFpQixDQUFDLENBQUMsQ0FBQztNQUMzRixJQUFJQSxLQUFLLENBQUNTLGFBQWEsRUFBRSxFQUFFO1FBQzFCUixXQUFXLENBQUNTLFNBQVMsR0FBRyxLQUFLO01BQzlCO01BQ0EsTUFBTUMsSUFBSSxHQUFHQyxXQUFXLENBQUNDLGFBQWEsQ0FBQ2IsS0FBSyxDQUFDO01BQzdDLE1BQU1jLFFBQVEsdUJBQUcsUUFBQ0gsSUFBSSxDQUFDSSxhQUFhLEVBQUUsRUFBU0MsZUFBZSxxREFBN0MsMkJBQWlEO01BQ2xFLE1BQU1DLG9CQUFvQixHQUFHQyxVQUFVLENBQUNDLHVCQUF1QixDQUFDTCxRQUFRLEVBQUVkLEtBQUssQ0FBQztNQUNoRkksZUFBZSxHQUFHZ0IsVUFBVSxDQUFDQyxnQkFBZ0IsQ0FBQ3JCLEtBQUssQ0FBQztNQUNwRCxNQUFNc0IsWUFBWSxHQUFHbEIsZUFBZSxJQUFJQSxlQUFlLENBQUNtQixPQUFPO01BQy9EckIsVUFBVSxHQUFHRSxlQUFlO01BQzVCLElBQUlhLG9CQUFvQixFQUFFO1FBQ3pCZCxlQUFlLEdBQUdlLFVBQVUsQ0FBQ0csZ0JBQWdCLENBQUNQLFFBQVEsQ0FBQztRQUN2RFQsWUFBWSxHQUFHRixlQUFlLElBQUlBLGVBQWUsQ0FBQ29CLE9BQU87UUFDekRyQixVQUFVLEdBQUdDLGVBQWU7TUFDN0I7TUFDQSxNQUFNcUIsWUFBWSxHQUFHLENBQUNGLFlBQVksSUFBSWpCLFlBQVksR0FBR2lCLFlBQVksQ0FBQ0csTUFBTSxDQUFDcEIsWUFBWSxDQUFDLEdBQUdBLFlBQVksSUFBSWlCLFlBQVksS0FBSyxFQUFFO01BQzVILE1BQU1JLE9BQU8sR0FDWkYsWUFBWSxDQUFDRyxNQUFNLEdBQUcsQ0FBQyxJQUN2QixJQUFJQyxNQUFNLENBQUM7UUFDVkwsT0FBTyxFQUFFQyxZQUFZO1FBQ3JCSyxHQUFHLEVBQUU7TUFDTixDQUFDLENBQUM7TUFFSCxJQUFJM0IsVUFBVSxDQUFDNEIsV0FBVyxFQUFFO1FBQzNCO1FBQ0E3QixXQUFXLENBQUM4QixJQUFJLEdBQUc3QixVQUFVLENBQUM0QixXQUFXO01BQzFDOztNQUVBO01BQ0FWLFVBQVUsQ0FBQ1ksaUJBQWlCLENBQUMvQixXQUFXLEVBQUVDLFVBQVUsRUFBRXdCLE9BQU8sQ0FBQztJQUMvRCxDQUFDO0lBQ0RPLE1BQU0sRUFBRSxVQUFVakMsS0FBWSxFQUFFQyxXQUFnQixFQUFFO01BQ2pELE1BQU1pQyxvQkFBb0IsR0FBR2xDLEtBQUssQ0FBQ21DLGlCQUFpQixDQUFDLGNBQWMsQ0FBQztNQUNwRSxNQUFNQyxtQkFBbUIsR0FBR0Ysb0JBQW9CLGFBQXBCQSxvQkFBb0IsdUJBQXBCQSxvQkFBb0IsQ0FBRUcsV0FBVyxDQUFFLEdBQUVILG9CQUFvQixDQUFDSSxPQUFPLEVBQUcsaUJBQWdCLENBQUM7TUFDakgsSUFBSUYsbUJBQW1CLEtBQUssT0FBTyxFQUFFO1FBQ3BDdEMsYUFBYSxDQUFDbUMsTUFBTSxDQUFDakMsS0FBSyxFQUFFQyxXQUFXLENBQUM7TUFDekM7SUFDRDtFQUNELENBQUMsQ0FBQztFQUFDLE9BRVlOLGdCQUFnQjtBQUFBIn0=