/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/fe/core/ActionRuntime", "sap/fe/core/CommonUtils", "sap/fe/core/controllerextensions/BusyLocker", "sap/fe/core/helpers/DeleteHelper", "sap/fe/core/library", "sap/fe/macros/field/FieldRuntime", "sap/fe/macros/table/TableHelper"], function (Log, ActionRuntime, CommonUtils, BusyLocker, deleteHelper, FELibrary, FieldRuntime, TableHelper) {
  "use strict";

  const CreationMode = FELibrary.CreationMode;
  /**
   * Static class used by Table building block during runtime
   *
   * @private
   * @experimental This module is only for internal/experimental use!
   */
  const TableRuntime = {
    displayTableSettings: function (oEvent) {
      /*
      		 Temporary solution
      		 Wait for mdc Table to provide public api to either get button 'Settings' or fire event on this button
      		 */
      const oParent = oEvent.getSource().getParent(),
        oSettingsButton = sap.ui.getCore().byId(`${oParent.getId()}-settings`);
      CommonUtils.fireButtonPress(oSettingsButton);
    },
    executeConditionalActionShortcut: function (sButtonMatcher, oSource) {
      // Get the button related to keyboard shortcut
      const oMdcTable = oSource.getParent();
      if (sButtonMatcher !== CreationMode.CreationRow) {
        const oButton = oMdcTable.getActions().reduce(function (aActionButtons, oActionToolbarAction) {
          return aActionButtons.concat(oActionToolbarAction.getAction());
        }, []).find(function (oActionButton) {
          return oActionButton.getId().endsWith(sButtonMatcher);
        });
        CommonUtils.fireButtonPress(oButton);
      } else {
        const oCreationRow = oMdcTable.getAggregation("creationRow");
        if (oCreationRow && oCreationRow.getApplyEnabled() && oCreationRow.getVisible()) {
          oCreationRow.fireApply();
        }
      }
    },
    setContexts: function (oTable, sDeletablePath, draft, sCollection, sNavigationAvailableMap, sActionsMultiselectDisabled, sUpdatablePath) {
      BusyLocker.lock(oTable);
      return TableRuntime.setContextsAsync(oTable, sDeletablePath, draft, sCollection, sNavigationAvailableMap, sActionsMultiselectDisabled, sUpdatablePath).then(() => {
        Log.info("Selections updated");
      }).catch(error => {
        Log.error(error);
      }).finally(() => {
        BusyLocker.unlock(oTable);
      });
    },
    setContextsAsync: async function (oTable, sDeletablePath, draft, sCollection, sNavigationAvailableMap, sActionsMultiselectDisabled, sUpdatablePath) {
      try {
        const aActionsMultiselectDisabled = sActionsMultiselectDisabled ? sActionsMultiselectDisabled.split(",") : [];
        const oActionOperationAvailableMap = JSON.parse(sCollection);
        const oNavigationAvailableMap = sNavigationAvailableMap && sNavigationAvailableMap !== "undefined" && JSON.parse(sNavigationAvailableMap);
        let aSelectedContexts = oTable.getSelectedContexts();
        const aDeletableContexts = [];
        const bReadOnlyDraftEnabled = oTable.data("displayModePropertyBinding") === "true" && draft !== "undefined";
        const aUpdatableContexts = [];
        // oDynamicActions are bound actions that are available according to some property
        // in each item
        const oDynamicActions = {};
        const oIBN = {};
        const oInternalModelContext = oTable.getBindingContext("internal");
        if (!oInternalModelContext) {
          return;
        }
        //do not consider empty rows as selected context
        aSelectedContexts = aSelectedContexts.filter(function (oContext) {
          return !oContext.isInactive();
        });
        const oModelObject = Object.assign(oInternalModelContext.getObject() || {}, {
          selectedContexts: aSelectedContexts,
          numberOfSelectedContexts: aSelectedContexts.length,
          dynamicActions: oDynamicActions,
          ibn: oIBN,
          deleteEnabled: true,
          deletableContexts: aDeletableContexts,
          unSavedContexts: [],
          lockedContexts: [],
          draftsWithNonDeletableActive: [],
          draftsWithDeletableActive: [],
          createModeContexts: [],
          controlId: "",
          updatableContexts: aUpdatableContexts,
          semanticKeyHasDraftIndicator: oInternalModelContext.getProperty("semanticKeyHasDraftIndicator") ? oInternalModelContext.getProperty("semanticKeyHasDraftIndicator") : undefined
        });
        for (const oSelectedContext of aSelectedContexts) {
          const oContextData = oSelectedContext.getObject();
          for (const key in oContextData) {
            if (key.indexOf("#") === 0) {
              let sActionPath = key;
              sActionPath = sActionPath.substring(1, sActionPath.length);
              oModelObject.dynamicActions[sActionPath] = {
                enabled: true
              };
              oInternalModelContext.setProperty("", oModelObject);
            }
          }
          // The updatable contexts with mass edit depend on the following:
          // 1. Update is dependendent on current entity property (sUpdatablePath).
          // 2. The table is read only and draft enabled(like LR), in this case only active contexts can be mass edited(not draft contexts).
          //    So, update depends on 'IsActiveEntity' value which needs to be checked.
          const bUpdatableByPath = sUpdatablePath.length === 0 || !!oSelectedContext.getProperty(sUpdatablePath);
          const bNotDraftInReadOnlyMode = !bReadOnlyDraftEnabled || oContextData.IsActiveEntity;
          if (bUpdatableByPath && bNotDraftInReadOnlyMode) {
            aUpdatableContexts.push(oSelectedContext);
          }
        }
        deleteHelper.updateDeleteInfoForSelectedContexts(oInternalModelContext, aSelectedContexts);
        if (!oTable.data("enableAnalytics")) {
          TableHelper.setIBNEnablement(oInternalModelContext, oNavigationAvailableMap, aSelectedContexts);
        }
        if (aSelectedContexts.length > 1) {
          this.disableAction(aActionsMultiselectDisabled, oDynamicActions);
        }
        if (oModelObject) {
          oModelObject["updatableContexts"] = aUpdatableContexts;
          oModelObject["controlId"] = oTable.getId();
          oInternalModelContext.setProperty("", oModelObject);
        }
        return ActionRuntime.setActionEnablement(oInternalModelContext, oActionOperationAvailableMap, aSelectedContexts, "table");
      } catch (error) {
        throw error;
      }
    },
    disableAction: function (aActionsMultiselectDisabled, oDynamicActions) {
      aActionsMultiselectDisabled.forEach(function (sAction) {
        oDynamicActions[sAction] = {
          bEnabled: false
        };
      });
    },
    onFieldChangeInCreationRow: function (oEvent, oCustomValidationFunction) {
      // CREATION ROW CASE
      const mField = FieldRuntime.getFieldStateOnChange(oEvent),
        oSourceField = mField.field,
        sFieldId = oSourceField.getId();
      const oInternalModelContext = oSourceField.getBindingContext("internal"),
        mFieldValidity = oInternalModelContext.getProperty("creationRowFieldValidity"),
        mNewFieldValidity = Object.assign({}, mFieldValidity);
      mNewFieldValidity[sFieldId] = mField.state;
      oInternalModelContext.setProperty("creationRowFieldValidity", mNewFieldValidity);

      // prepare Custom Validation
      if (oCustomValidationFunction) {
        const mCustomValidity = oInternalModelContext.getProperty("creationRowCustomValidity"),
          mNewCustomValidity = Object.assign({}, mCustomValidity);
        mNewCustomValidity[oSourceField.getBinding("value").getPath()] = {
          fieldId: oSourceField.getId()
        };
        oInternalModelContext.setProperty("creationRowCustomValidity", mNewCustomValidity);
        // Remove existing CustomValidation message
        const oMessageManager = sap.ui.getCore().getMessageManager();
        const sTarget = `${oSourceField.getBindingContext().getPath()}/${oSourceField.getBindingPath("value")}`;
        oMessageManager.getMessageModel().getData().forEach(function (oMessage) {
          if (oMessage.target === sTarget) {
            oMessageManager.removeMessages(oMessage);
          }
        });
      }
    }
  };
  return TableRuntime;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDcmVhdGlvbk1vZGUiLCJGRUxpYnJhcnkiLCJUYWJsZVJ1bnRpbWUiLCJkaXNwbGF5VGFibGVTZXR0aW5ncyIsIm9FdmVudCIsIm9QYXJlbnQiLCJnZXRTb3VyY2UiLCJnZXRQYXJlbnQiLCJvU2V0dGluZ3NCdXR0b24iLCJzYXAiLCJ1aSIsImdldENvcmUiLCJieUlkIiwiZ2V0SWQiLCJDb21tb25VdGlscyIsImZpcmVCdXR0b25QcmVzcyIsImV4ZWN1dGVDb25kaXRpb25hbEFjdGlvblNob3J0Y3V0Iiwic0J1dHRvbk1hdGNoZXIiLCJvU291cmNlIiwib01kY1RhYmxlIiwiQ3JlYXRpb25Sb3ciLCJvQnV0dG9uIiwiZ2V0QWN0aW9ucyIsInJlZHVjZSIsImFBY3Rpb25CdXR0b25zIiwib0FjdGlvblRvb2xiYXJBY3Rpb24iLCJjb25jYXQiLCJnZXRBY3Rpb24iLCJmaW5kIiwib0FjdGlvbkJ1dHRvbiIsImVuZHNXaXRoIiwib0NyZWF0aW9uUm93IiwiZ2V0QWdncmVnYXRpb24iLCJnZXRBcHBseUVuYWJsZWQiLCJnZXRWaXNpYmxlIiwiZmlyZUFwcGx5Iiwic2V0Q29udGV4dHMiLCJvVGFibGUiLCJzRGVsZXRhYmxlUGF0aCIsImRyYWZ0Iiwic0NvbGxlY3Rpb24iLCJzTmF2aWdhdGlvbkF2YWlsYWJsZU1hcCIsInNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCIsInNVcGRhdGFibGVQYXRoIiwiQnVzeUxvY2tlciIsImxvY2siLCJzZXRDb250ZXh0c0FzeW5jIiwidGhlbiIsIkxvZyIsImluZm8iLCJjYXRjaCIsImVycm9yIiwiZmluYWxseSIsInVubG9jayIsImFBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCIsInNwbGl0Iiwib0FjdGlvbk9wZXJhdGlvbkF2YWlsYWJsZU1hcCIsIkpTT04iLCJwYXJzZSIsIm9OYXZpZ2F0aW9uQXZhaWxhYmxlTWFwIiwiYVNlbGVjdGVkQ29udGV4dHMiLCJnZXRTZWxlY3RlZENvbnRleHRzIiwiYURlbGV0YWJsZUNvbnRleHRzIiwiYlJlYWRPbmx5RHJhZnRFbmFibGVkIiwiZGF0YSIsImFVcGRhdGFibGVDb250ZXh0cyIsIm9EeW5hbWljQWN0aW9ucyIsIm9JQk4iLCJvSW50ZXJuYWxNb2RlbENvbnRleHQiLCJnZXRCaW5kaW5nQ29udGV4dCIsImZpbHRlciIsIm9Db250ZXh0IiwiaXNJbmFjdGl2ZSIsIm9Nb2RlbE9iamVjdCIsIk9iamVjdCIsImFzc2lnbiIsImdldE9iamVjdCIsInNlbGVjdGVkQ29udGV4dHMiLCJudW1iZXJPZlNlbGVjdGVkQ29udGV4dHMiLCJsZW5ndGgiLCJkeW5hbWljQWN0aW9ucyIsImlibiIsImRlbGV0ZUVuYWJsZWQiLCJkZWxldGFibGVDb250ZXh0cyIsInVuU2F2ZWRDb250ZXh0cyIsImxvY2tlZENvbnRleHRzIiwiZHJhZnRzV2l0aE5vbkRlbGV0YWJsZUFjdGl2ZSIsImRyYWZ0c1dpdGhEZWxldGFibGVBY3RpdmUiLCJjcmVhdGVNb2RlQ29udGV4dHMiLCJjb250cm9sSWQiLCJ1cGRhdGFibGVDb250ZXh0cyIsInNlbWFudGljS2V5SGFzRHJhZnRJbmRpY2F0b3IiLCJnZXRQcm9wZXJ0eSIsInVuZGVmaW5lZCIsIm9TZWxlY3RlZENvbnRleHQiLCJvQ29udGV4dERhdGEiLCJrZXkiLCJpbmRleE9mIiwic0FjdGlvblBhdGgiLCJzdWJzdHJpbmciLCJlbmFibGVkIiwic2V0UHJvcGVydHkiLCJiVXBkYXRhYmxlQnlQYXRoIiwiYk5vdERyYWZ0SW5SZWFkT25seU1vZGUiLCJJc0FjdGl2ZUVudGl0eSIsInB1c2giLCJkZWxldGVIZWxwZXIiLCJ1cGRhdGVEZWxldGVJbmZvRm9yU2VsZWN0ZWRDb250ZXh0cyIsIlRhYmxlSGVscGVyIiwic2V0SUJORW5hYmxlbWVudCIsImRpc2FibGVBY3Rpb24iLCJBY3Rpb25SdW50aW1lIiwic2V0QWN0aW9uRW5hYmxlbWVudCIsImZvckVhY2giLCJzQWN0aW9uIiwiYkVuYWJsZWQiLCJvbkZpZWxkQ2hhbmdlSW5DcmVhdGlvblJvdyIsIm9DdXN0b21WYWxpZGF0aW9uRnVuY3Rpb24iLCJtRmllbGQiLCJGaWVsZFJ1bnRpbWUiLCJnZXRGaWVsZFN0YXRlT25DaGFuZ2UiLCJvU291cmNlRmllbGQiLCJmaWVsZCIsInNGaWVsZElkIiwibUZpZWxkVmFsaWRpdHkiLCJtTmV3RmllbGRWYWxpZGl0eSIsInN0YXRlIiwibUN1c3RvbVZhbGlkaXR5IiwibU5ld0N1c3RvbVZhbGlkaXR5IiwiZ2V0QmluZGluZyIsImdldFBhdGgiLCJmaWVsZElkIiwib01lc3NhZ2VNYW5hZ2VyIiwiZ2V0TWVzc2FnZU1hbmFnZXIiLCJzVGFyZ2V0IiwiZ2V0QmluZGluZ1BhdGgiLCJnZXRNZXNzYWdlTW9kZWwiLCJnZXREYXRhIiwib01lc3NhZ2UiLCJ0YXJnZXQiLCJyZW1vdmVNZXNzYWdlcyJdLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiVGFibGVSdW50aW1lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2cgZnJvbSBcInNhcC9iYXNlL0xvZ1wiO1xuaW1wb3J0IEFjdGlvblJ1bnRpbWUgZnJvbSBcInNhcC9mZS9jb3JlL0FjdGlvblJ1bnRpbWVcIjtcbmltcG9ydCBDb21tb25VdGlscyBmcm9tIFwic2FwL2ZlL2NvcmUvQ29tbW9uVXRpbHNcIjtcbmltcG9ydCBCdXN5TG9ja2VyIGZyb20gXCJzYXAvZmUvY29yZS9jb250cm9sbGVyZXh0ZW5zaW9ucy9CdXN5TG9ja2VyXCI7XG5pbXBvcnQgZGVsZXRlSGVscGVyIGZyb20gXCJzYXAvZmUvY29yZS9oZWxwZXJzL0RlbGV0ZUhlbHBlclwiO1xuaW1wb3J0IHR5cGUgeyBJbnRlcm5hbE1vZGVsQ29udGV4dCB9IGZyb20gXCJzYXAvZmUvY29yZS9oZWxwZXJzL01vZGVsSGVscGVyXCI7XG5pbXBvcnQgRkVMaWJyYXJ5IGZyb20gXCJzYXAvZmUvY29yZS9saWJyYXJ5XCI7XG5pbXBvcnQgRmllbGRSdW50aW1lIGZyb20gXCJzYXAvZmUvbWFjcm9zL2ZpZWxkL0ZpZWxkUnVudGltZVwiO1xuaW1wb3J0IFRhYmxlSGVscGVyIGZyb20gXCJzYXAvZmUvbWFjcm9zL3RhYmxlL1RhYmxlSGVscGVyXCI7XG5pbXBvcnQgQnV0dG9uIGZyb20gXCJzYXAvbS9CdXR0b25cIjtcbmltcG9ydCB0eXBlIFRhYmxlIGZyb20gXCJzYXAvdWkvbWRjL1RhYmxlXCI7XG5pbXBvcnQgeyBWNENvbnRleHQgfSBmcm9tIFwidHlwZXMvZXh0ZW5zaW9uX3R5cGVzXCI7XG5cbmNvbnN0IENyZWF0aW9uTW9kZSA9IEZFTGlicmFyeS5DcmVhdGlvbk1vZGU7XG4vKipcbiAqIFN0YXRpYyBjbGFzcyB1c2VkIGJ5IFRhYmxlIGJ1aWxkaW5nIGJsb2NrIGR1cmluZyBydW50aW1lXG4gKlxuICogQHByaXZhdGVcbiAqIEBleHBlcmltZW50YWwgVGhpcyBtb2R1bGUgaXMgb25seSBmb3IgaW50ZXJuYWwvZXhwZXJpbWVudGFsIHVzZSFcbiAqL1xuY29uc3QgVGFibGVSdW50aW1lID0ge1xuXHRkaXNwbGF5VGFibGVTZXR0aW5nczogZnVuY3Rpb24gKG9FdmVudDogYW55KSB7XG5cdFx0Lypcblx0XHRcdFx0IFRlbXBvcmFyeSBzb2x1dGlvblxuXHRcdFx0XHQgV2FpdCBmb3IgbWRjIFRhYmxlIHRvIHByb3ZpZGUgcHVibGljIGFwaSB0byBlaXRoZXIgZ2V0IGJ1dHRvbiAnU2V0dGluZ3MnIG9yIGZpcmUgZXZlbnQgb24gdGhpcyBidXR0b25cblx0XHRcdFx0ICovXG5cdFx0Y29uc3Qgb1BhcmVudCA9IG9FdmVudC5nZXRTb3VyY2UoKS5nZXRQYXJlbnQoKSxcblx0XHRcdG9TZXR0aW5nc0J1dHRvbiA9IHNhcC51aS5nZXRDb3JlKCkuYnlJZChgJHtvUGFyZW50LmdldElkKCl9LXNldHRpbmdzYCk7XG5cdFx0Q29tbW9uVXRpbHMuZmlyZUJ1dHRvblByZXNzKG9TZXR0aW5nc0J1dHRvbiBhcyBCdXR0b24pO1xuXHR9LFxuXHRleGVjdXRlQ29uZGl0aW9uYWxBY3Rpb25TaG9ydGN1dDogZnVuY3Rpb24gKHNCdXR0b25NYXRjaGVyOiBhbnksIG9Tb3VyY2U6IGFueSkge1xuXHRcdC8vIEdldCB0aGUgYnV0dG9uIHJlbGF0ZWQgdG8ga2V5Ym9hcmQgc2hvcnRjdXRcblx0XHRjb25zdCBvTWRjVGFibGUgPSBvU291cmNlLmdldFBhcmVudCgpO1xuXHRcdGlmIChzQnV0dG9uTWF0Y2hlciAhPT0gQ3JlYXRpb25Nb2RlLkNyZWF0aW9uUm93KSB7XG5cdFx0XHRjb25zdCBvQnV0dG9uID0gb01kY1RhYmxlXG5cdFx0XHRcdC5nZXRBY3Rpb25zKClcblx0XHRcdFx0LnJlZHVjZShmdW5jdGlvbiAoYUFjdGlvbkJ1dHRvbnM6IGFueSwgb0FjdGlvblRvb2xiYXJBY3Rpb246IGFueSkge1xuXHRcdFx0XHRcdHJldHVybiBhQWN0aW9uQnV0dG9ucy5jb25jYXQob0FjdGlvblRvb2xiYXJBY3Rpb24uZ2V0QWN0aW9uKCkpO1xuXHRcdFx0XHR9LCBbXSlcblx0XHRcdFx0LmZpbmQoZnVuY3Rpb24gKG9BY3Rpb25CdXR0b246IGFueSkge1xuXHRcdFx0XHRcdHJldHVybiBvQWN0aW9uQnV0dG9uLmdldElkKCkuZW5kc1dpdGgoc0J1dHRvbk1hdGNoZXIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdENvbW1vblV0aWxzLmZpcmVCdXR0b25QcmVzcyhvQnV0dG9uKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3Qgb0NyZWF0aW9uUm93ID0gb01kY1RhYmxlLmdldEFnZ3JlZ2F0aW9uKFwiY3JlYXRpb25Sb3dcIik7XG5cdFx0XHRpZiAob0NyZWF0aW9uUm93ICYmIG9DcmVhdGlvblJvdy5nZXRBcHBseUVuYWJsZWQoKSAmJiBvQ3JlYXRpb25Sb3cuZ2V0VmlzaWJsZSgpKSB7XG5cdFx0XHRcdG9DcmVhdGlvblJvdy5maXJlQXBwbHkoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0c2V0Q29udGV4dHM6IGZ1bmN0aW9uIChcblx0XHRvVGFibGU6IFRhYmxlLFxuXHRcdHNEZWxldGFibGVQYXRoOiBzdHJpbmcsXG5cdFx0ZHJhZnQ6IHN0cmluZyxcblx0XHRzQ29sbGVjdGlvbjogc3RyaW5nLFxuXHRcdHNOYXZpZ2F0aW9uQXZhaWxhYmxlTWFwOiBzdHJpbmcsXG5cdFx0c0FjdGlvbnNNdWx0aXNlbGVjdERpc2FibGVkOiBzdHJpbmcsXG5cdFx0c1VwZGF0YWJsZVBhdGg6IHN0cmluZ1xuXHQpIHtcblx0XHRCdXN5TG9ja2VyLmxvY2sob1RhYmxlKTtcblx0XHRyZXR1cm4gVGFibGVSdW50aW1lLnNldENvbnRleHRzQXN5bmMoXG5cdFx0XHRvVGFibGUsXG5cdFx0XHRzRGVsZXRhYmxlUGF0aCxcblx0XHRcdGRyYWZ0LFxuXHRcdFx0c0NvbGxlY3Rpb24sXG5cdFx0XHRzTmF2aWdhdGlvbkF2YWlsYWJsZU1hcCxcblx0XHRcdHNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCxcblx0XHRcdHNVcGRhdGFibGVQYXRoXG5cdFx0KVxuXHRcdFx0LnRoZW4oKCkgPT4ge1xuXHRcdFx0XHRMb2cuaW5mbyhcIlNlbGVjdGlvbnMgdXBkYXRlZFwiKTtcblx0XHRcdH0pXG5cdFx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XG5cdFx0XHRcdExvZy5lcnJvcihlcnJvcik7XG5cdFx0XHR9KVxuXHRcdFx0LmZpbmFsbHkoKCkgPT4ge1xuXHRcdFx0XHRCdXN5TG9ja2VyLnVubG9jayhvVGFibGUpO1xuXHRcdFx0fSk7XG5cdH0sXG5cblx0c2V0Q29udGV4dHNBc3luYzogYXN5bmMgZnVuY3Rpb24gKFxuXHRcdG9UYWJsZTogVGFibGUsXG5cdFx0c0RlbGV0YWJsZVBhdGg6IHN0cmluZyxcblx0XHRkcmFmdDogc3RyaW5nLFxuXHRcdHNDb2xsZWN0aW9uOiBzdHJpbmcsXG5cdFx0c05hdmlnYXRpb25BdmFpbGFibGVNYXA6IHN0cmluZyxcblx0XHRzQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQ6IHN0cmluZyxcblx0XHRzVXBkYXRhYmxlUGF0aDogc3RyaW5nXG5cdCk6IFByb21pc2U8dm9pZFtdIHwgdW5kZWZpbmVkPiB7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGFBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCA9IHNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZCA/IHNBY3Rpb25zTXVsdGlzZWxlY3REaXNhYmxlZC5zcGxpdChcIixcIikgOiBbXTtcblx0XHRcdGNvbnN0IG9BY3Rpb25PcGVyYXRpb25BdmFpbGFibGVNYXAgPSBKU09OLnBhcnNlKHNDb2xsZWN0aW9uKTtcblx0XHRcdGNvbnN0IG9OYXZpZ2F0aW9uQXZhaWxhYmxlTWFwID1cblx0XHRcdFx0c05hdmlnYXRpb25BdmFpbGFibGVNYXAgJiYgc05hdmlnYXRpb25BdmFpbGFibGVNYXAgIT09IFwidW5kZWZpbmVkXCIgJiYgSlNPTi5wYXJzZShzTmF2aWdhdGlvbkF2YWlsYWJsZU1hcCk7XG5cdFx0XHRsZXQgYVNlbGVjdGVkQ29udGV4dHMgPSBvVGFibGUuZ2V0U2VsZWN0ZWRDb250ZXh0cygpIGFzIFY0Q29udGV4dFtdO1xuXHRcdFx0Y29uc3QgYURlbGV0YWJsZUNvbnRleHRzOiBWNENvbnRleHRbXSA9IFtdO1xuXHRcdFx0Y29uc3QgYlJlYWRPbmx5RHJhZnRFbmFibGVkID0gb1RhYmxlLmRhdGEoXCJkaXNwbGF5TW9kZVByb3BlcnR5QmluZGluZ1wiKSA9PT0gXCJ0cnVlXCIgJiYgZHJhZnQgIT09IFwidW5kZWZpbmVkXCI7XG5cdFx0XHRjb25zdCBhVXBkYXRhYmxlQ29udGV4dHM6IFY0Q29udGV4dFtdID0gW107XG5cdFx0XHQvLyBvRHluYW1pY0FjdGlvbnMgYXJlIGJvdW5kIGFjdGlvbnMgdGhhdCBhcmUgYXZhaWxhYmxlIGFjY29yZGluZyB0byBzb21lIHByb3BlcnR5XG5cdFx0XHQvLyBpbiBlYWNoIGl0ZW1cblx0XHRcdGNvbnN0IG9EeW5hbWljQWN0aW9uczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCB1bmRlZmluZWQgPSB7fTtcblx0XHRcdGNvbnN0IG9JQk4gPSB7fTtcblx0XHRcdGNvbnN0IG9JbnRlcm5hbE1vZGVsQ29udGV4dCA9IG9UYWJsZS5nZXRCaW5kaW5nQ29udGV4dChcImludGVybmFsXCIpIGFzIEludGVybmFsTW9kZWxDb250ZXh0O1xuXG5cdFx0XHRpZiAoIW9JbnRlcm5hbE1vZGVsQ29udGV4dCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHQvL2RvIG5vdCBjb25zaWRlciBlbXB0eSByb3dzIGFzIHNlbGVjdGVkIGNvbnRleHRcblx0XHRcdGFTZWxlY3RlZENvbnRleHRzID0gYVNlbGVjdGVkQ29udGV4dHMuZmlsdGVyKGZ1bmN0aW9uIChvQ29udGV4dDogVjRDb250ZXh0KSB7XG5cdFx0XHRcdHJldHVybiAhb0NvbnRleHQuaXNJbmFjdGl2ZSgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGNvbnN0IG9Nb2RlbE9iamVjdCA9IE9iamVjdC5hc3NpZ24ob0ludGVybmFsTW9kZWxDb250ZXh0LmdldE9iamVjdCgpIHx8IHt9LCB7XG5cdFx0XHRcdHNlbGVjdGVkQ29udGV4dHM6IGFTZWxlY3RlZENvbnRleHRzLFxuXHRcdFx0XHRudW1iZXJPZlNlbGVjdGVkQ29udGV4dHM6IGFTZWxlY3RlZENvbnRleHRzLmxlbmd0aCxcblx0XHRcdFx0ZHluYW1pY0FjdGlvbnM6IG9EeW5hbWljQWN0aW9ucyxcblx0XHRcdFx0aWJuOiBvSUJOLFxuXHRcdFx0XHRkZWxldGVFbmFibGVkOiB0cnVlLFxuXHRcdFx0XHRkZWxldGFibGVDb250ZXh0czogYURlbGV0YWJsZUNvbnRleHRzLFxuXHRcdFx0XHR1blNhdmVkQ29udGV4dHM6IFtdLFxuXHRcdFx0XHRsb2NrZWRDb250ZXh0czogW10sXG5cdFx0XHRcdGRyYWZ0c1dpdGhOb25EZWxldGFibGVBY3RpdmU6IFtdLFxuXHRcdFx0XHRkcmFmdHNXaXRoRGVsZXRhYmxlQWN0aXZlOiBbXSxcblx0XHRcdFx0Y3JlYXRlTW9kZUNvbnRleHRzOiBbXSxcblx0XHRcdFx0Y29udHJvbElkOiBcIlwiLFxuXHRcdFx0XHR1cGRhdGFibGVDb250ZXh0czogYVVwZGF0YWJsZUNvbnRleHRzLFxuXHRcdFx0XHRzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yOiBvSW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0UHJvcGVydHkoXCJzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yXCIpXG5cdFx0XHRcdFx0PyBvSW50ZXJuYWxNb2RlbENvbnRleHQuZ2V0UHJvcGVydHkoXCJzZW1hbnRpY0tleUhhc0RyYWZ0SW5kaWNhdG9yXCIpXG5cdFx0XHRcdFx0OiB1bmRlZmluZWRcblx0XHRcdH0pO1xuXG5cdFx0XHRmb3IgKGNvbnN0IG9TZWxlY3RlZENvbnRleHQgb2YgYVNlbGVjdGVkQ29udGV4dHMpIHtcblx0XHRcdFx0Y29uc3Qgb0NvbnRleHREYXRhID0gb1NlbGVjdGVkQ29udGV4dC5nZXRPYmplY3QoKTtcblx0XHRcdFx0Zm9yIChjb25zdCBrZXkgaW4gb0NvbnRleHREYXRhKSB7XG5cdFx0XHRcdFx0aWYgKGtleS5pbmRleE9mKFwiI1wiKSA9PT0gMCkge1xuXHRcdFx0XHRcdFx0bGV0IHNBY3Rpb25QYXRoOiBzdHJpbmcgPSBrZXk7XG5cdFx0XHRcdFx0XHRzQWN0aW9uUGF0aCA9IHNBY3Rpb25QYXRoLnN1YnN0cmluZygxLCBzQWN0aW9uUGF0aC5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0b01vZGVsT2JqZWN0LmR5bmFtaWNBY3Rpb25zW3NBY3Rpb25QYXRoXSA9IHsgZW5hYmxlZDogdHJ1ZSB9O1xuXHRcdFx0XHRcdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwiXCIsIG9Nb2RlbE9iamVjdCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIFRoZSB1cGRhdGFibGUgY29udGV4dHMgd2l0aCBtYXNzIGVkaXQgZGVwZW5kIG9uIHRoZSBmb2xsb3dpbmc6XG5cdFx0XHRcdC8vIDEuIFVwZGF0ZSBpcyBkZXBlbmRlbmRlbnQgb24gY3VycmVudCBlbnRpdHkgcHJvcGVydHkgKHNVcGRhdGFibGVQYXRoKS5cblx0XHRcdFx0Ly8gMi4gVGhlIHRhYmxlIGlzIHJlYWQgb25seSBhbmQgZHJhZnQgZW5hYmxlZChsaWtlIExSKSwgaW4gdGhpcyBjYXNlIG9ubHkgYWN0aXZlIGNvbnRleHRzIGNhbiBiZSBtYXNzIGVkaXRlZChub3QgZHJhZnQgY29udGV4dHMpLlxuXHRcdFx0XHQvLyAgICBTbywgdXBkYXRlIGRlcGVuZHMgb24gJ0lzQWN0aXZlRW50aXR5JyB2YWx1ZSB3aGljaCBuZWVkcyB0byBiZSBjaGVja2VkLlxuXHRcdFx0XHRjb25zdCBiVXBkYXRhYmxlQnlQYXRoID0gc1VwZGF0YWJsZVBhdGgubGVuZ3RoID09PSAwIHx8ICEhb1NlbGVjdGVkQ29udGV4dC5nZXRQcm9wZXJ0eShzVXBkYXRhYmxlUGF0aCk7XG5cdFx0XHRcdGNvbnN0IGJOb3REcmFmdEluUmVhZE9ubHlNb2RlID0gIWJSZWFkT25seURyYWZ0RW5hYmxlZCB8fCBvQ29udGV4dERhdGEuSXNBY3RpdmVFbnRpdHk7XG5cdFx0XHRcdGlmIChiVXBkYXRhYmxlQnlQYXRoICYmIGJOb3REcmFmdEluUmVhZE9ubHlNb2RlKSB7XG5cdFx0XHRcdFx0YVVwZGF0YWJsZUNvbnRleHRzLnB1c2gob1NlbGVjdGVkQ29udGV4dCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0ZGVsZXRlSGVscGVyLnVwZGF0ZURlbGV0ZUluZm9Gb3JTZWxlY3RlZENvbnRleHRzKG9JbnRlcm5hbE1vZGVsQ29udGV4dCwgYVNlbGVjdGVkQ29udGV4dHMpO1xuXG5cdFx0XHRpZiAoIW9UYWJsZS5kYXRhKFwiZW5hYmxlQW5hbHl0aWNzXCIpKSB7XG5cdFx0XHRcdFRhYmxlSGVscGVyLnNldElCTkVuYWJsZW1lbnQob0ludGVybmFsTW9kZWxDb250ZXh0LCBvTmF2aWdhdGlvbkF2YWlsYWJsZU1hcCwgYVNlbGVjdGVkQ29udGV4dHMpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYVNlbGVjdGVkQ29udGV4dHMubGVuZ3RoID4gMSkge1xuXHRcdFx0XHR0aGlzLmRpc2FibGVBY3Rpb24oYUFjdGlvbnNNdWx0aXNlbGVjdERpc2FibGVkLCBvRHluYW1pY0FjdGlvbnMpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAob01vZGVsT2JqZWN0KSB7XG5cdFx0XHRcdG9Nb2RlbE9iamVjdFtcInVwZGF0YWJsZUNvbnRleHRzXCJdID0gYVVwZGF0YWJsZUNvbnRleHRzO1xuXHRcdFx0XHRvTW9kZWxPYmplY3RbXCJjb250cm9sSWRcIl0gPSBvVGFibGUuZ2V0SWQoKTtcblx0XHRcdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwiXCIsIG9Nb2RlbE9iamVjdCk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBBY3Rpb25SdW50aW1lLnNldEFjdGlvbkVuYWJsZW1lbnQob0ludGVybmFsTW9kZWxDb250ZXh0LCBvQWN0aW9uT3BlcmF0aW9uQXZhaWxhYmxlTWFwLCBhU2VsZWN0ZWRDb250ZXh0cywgXCJ0YWJsZVwiKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0dGhyb3cgZXJyb3I7XG5cdFx0fVxuXHR9LFxuXG5cdGRpc2FibGVBY3Rpb246IGZ1bmN0aW9uIChhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQ6IGFueSwgb0R5bmFtaWNBY3Rpb25zOiBhbnkpIHtcblx0XHRhQWN0aW9uc011bHRpc2VsZWN0RGlzYWJsZWQuZm9yRWFjaChmdW5jdGlvbiAoc0FjdGlvbjogYW55KSB7XG5cdFx0XHRvRHluYW1pY0FjdGlvbnNbc0FjdGlvbl0gPSB7IGJFbmFibGVkOiBmYWxzZSB9O1xuXHRcdH0pO1xuXHR9LFxuXHRvbkZpZWxkQ2hhbmdlSW5DcmVhdGlvblJvdzogZnVuY3Rpb24gKG9FdmVudDogYW55LCBvQ3VzdG9tVmFsaWRhdGlvbkZ1bmN0aW9uOiBhbnkpIHtcblx0XHQvLyBDUkVBVElPTiBST1cgQ0FTRVxuXHRcdGNvbnN0IG1GaWVsZCA9IEZpZWxkUnVudGltZS5nZXRGaWVsZFN0YXRlT25DaGFuZ2Uob0V2ZW50KSxcblx0XHRcdG9Tb3VyY2VGaWVsZCA9IG1GaWVsZC5maWVsZCxcblx0XHRcdHNGaWVsZElkID0gb1NvdXJjZUZpZWxkLmdldElkKCk7XG5cblx0XHRjb25zdCBvSW50ZXJuYWxNb2RlbENvbnRleHQgPSBvU291cmNlRmllbGQuZ2V0QmluZGluZ0NvbnRleHQoXCJpbnRlcm5hbFwiKSxcblx0XHRcdG1GaWVsZFZhbGlkaXR5ID0gb0ludGVybmFsTW9kZWxDb250ZXh0LmdldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dGaWVsZFZhbGlkaXR5XCIpLFxuXHRcdFx0bU5ld0ZpZWxkVmFsaWRpdHkgPSBPYmplY3QuYXNzaWduKHt9LCBtRmllbGRWYWxpZGl0eSk7XG5cblx0XHRtTmV3RmllbGRWYWxpZGl0eVtzRmllbGRJZF0gPSBtRmllbGQuc3RhdGU7XG5cdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dGaWVsZFZhbGlkaXR5XCIsIG1OZXdGaWVsZFZhbGlkaXR5KTtcblxuXHRcdC8vIHByZXBhcmUgQ3VzdG9tIFZhbGlkYXRpb25cblx0XHRpZiAob0N1c3RvbVZhbGlkYXRpb25GdW5jdGlvbikge1xuXHRcdFx0Y29uc3QgbUN1c3RvbVZhbGlkaXR5ID0gb0ludGVybmFsTW9kZWxDb250ZXh0LmdldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dDdXN0b21WYWxpZGl0eVwiKSxcblx0XHRcdFx0bU5ld0N1c3RvbVZhbGlkaXR5ID0gT2JqZWN0LmFzc2lnbih7fSwgbUN1c3RvbVZhbGlkaXR5KTtcblx0XHRcdG1OZXdDdXN0b21WYWxpZGl0eVtvU291cmNlRmllbGQuZ2V0QmluZGluZyhcInZhbHVlXCIpLmdldFBhdGgoKV0gPSB7XG5cdFx0XHRcdGZpZWxkSWQ6IG9Tb3VyY2VGaWVsZC5nZXRJZCgpXG5cdFx0XHR9O1xuXHRcdFx0b0ludGVybmFsTW9kZWxDb250ZXh0LnNldFByb3BlcnR5KFwiY3JlYXRpb25Sb3dDdXN0b21WYWxpZGl0eVwiLCBtTmV3Q3VzdG9tVmFsaWRpdHkpO1xuXHRcdFx0Ly8gUmVtb3ZlIGV4aXN0aW5nIEN1c3RvbVZhbGlkYXRpb24gbWVzc2FnZVxuXHRcdFx0Y29uc3Qgb01lc3NhZ2VNYW5hZ2VyID0gc2FwLnVpLmdldENvcmUoKS5nZXRNZXNzYWdlTWFuYWdlcigpO1xuXHRcdFx0Y29uc3Qgc1RhcmdldCA9IGAke29Tb3VyY2VGaWVsZC5nZXRCaW5kaW5nQ29udGV4dCgpLmdldFBhdGgoKX0vJHtvU291cmNlRmllbGQuZ2V0QmluZGluZ1BhdGgoXCJ2YWx1ZVwiKX1gO1xuXHRcdFx0b01lc3NhZ2VNYW5hZ2VyXG5cdFx0XHRcdC5nZXRNZXNzYWdlTW9kZWwoKVxuXHRcdFx0XHQuZ2V0RGF0YSgpXG5cdFx0XHRcdC5mb3JFYWNoKGZ1bmN0aW9uIChvTWVzc2FnZTogYW55KSB7XG5cdFx0XHRcdFx0aWYgKG9NZXNzYWdlLnRhcmdldCA9PT0gc1RhcmdldCkge1xuXHRcdFx0XHRcdFx0b01lc3NhZ2VNYW5hZ2VyLnJlbW92ZU1lc3NhZ2VzKG9NZXNzYWdlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGRlZmF1bHQgVGFibGVSdW50aW1lO1xuIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFBQTtBQUFBOzs7O0VBYUEsTUFBTUEsWUFBWSxHQUFHQyxTQUFTLENBQUNELFlBQVk7RUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0EsTUFBTUUsWUFBWSxHQUFHO0lBQ3BCQyxvQkFBb0IsRUFBRSxVQUFVQyxNQUFXLEVBQUU7TUFDNUM7QUFDRjtBQUNBO0FBQ0E7TUFDRSxNQUFNQyxPQUFPLEdBQUdELE1BQU0sQ0FBQ0UsU0FBUyxFQUFFLENBQUNDLFNBQVMsRUFBRTtRQUM3Q0MsZUFBZSxHQUFHQyxHQUFHLENBQUNDLEVBQUUsQ0FBQ0MsT0FBTyxFQUFFLENBQUNDLElBQUksQ0FBRSxHQUFFUCxPQUFPLENBQUNRLEtBQUssRUFBRyxXQUFVLENBQUM7TUFDdkVDLFdBQVcsQ0FBQ0MsZUFBZSxDQUFDUCxlQUFlLENBQVc7SUFDdkQsQ0FBQztJQUNEUSxnQ0FBZ0MsRUFBRSxVQUFVQyxjQUFtQixFQUFFQyxPQUFZLEVBQUU7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