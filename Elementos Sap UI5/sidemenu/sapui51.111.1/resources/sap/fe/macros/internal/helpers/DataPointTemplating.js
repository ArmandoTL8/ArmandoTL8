/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/ui/model/odata/v4/AnnotationHelper"],function(t,e,n,o,i,r){"use strict";var a={};var s=i.getDisplayMode;var l=i.getBindingWithUnitOrCurrency;var u=i.getBindingWithTimezone;var d=o.isProperty;var c=o.hasStaticPercentUnit;var v=n.getRelativePaths;var g=n.enhanceDataModelPath;var p=e.unresolvableExpression;var f=e.isPathInModelExpression;var m=e.getExpressionFromAnnotation;var O=e.formatWithTypeInformation;var T=e.formatResult;var I=e.EDM_TYPE_MAPPING;var b=e.compileExpression;const _=t=>t!==null&&t!==void 0&&t.TargetValue?m(t.TargetValue):p;const E=sap.ui.getCore().getLibraryResourceBundle("sap.fe.macros");const P=e=>{var n;const o=(e===null||e===void 0?void 0:(n=e.targetObject)===null||n===void 0?void 0:n.Value)||"";const i=v(e);let r=m(o,i);const a=_(e.targetObject);if(r&&a){var s,l,u,g;let n=e.targetObject.Value;if(!d(n)){n=e.targetObject.Value.$target}const v=((s=n.annotations)===null||s===void 0?void 0:(l=s.Measures)===null||l===void 0?void 0:l.Unit)||((u=n.annotations)===null||u===void 0?void 0:(g=u.Measures)===null||g===void 0?void 0:g.ISOCurrency);if(!v){return E.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[b(r),b(a)])}if(c(o===null||o===void 0?void 0:o.$target)){return`${b(r)} %`}r=O(n,r);const p=v.$target?O(v.$target,m(v,i)):m(v,i);return b(T([r,a,p],t.formatProgressIndicatorText))}return undefined};a.buildExpressionForProgressIndicatorDisplayValue=P;const A=t=>{var e,n,o,i,r,a;const s=v(t);const l=t===null||t===void 0?void 0:(e=t.targetObject)===null||e===void 0?void 0:(n=e.Value)===null||n===void 0?void 0:n.$target;if(!d(l)){return""}const u=((o=l.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.Unit)||((r=l.annotations)===null||r===void 0?void 0:(a=r.Measures)===null||a===void 0?void 0:a.ISOCurrency);return u?b(m(u,s)):""};a.buildUnitBindingExpression=A;const D=(t,e)=>{if(e){return N(r.value(e,{context:t}))}};const N=t=>{if(t){const e=t>1?E.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):E.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL");return E.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE",[String(t),e])}};const h=(t,e)=>{let n;if(e&&e.SampleSize){n=D(t,e.SampleSize)}else if(e&&e.Description){const o=r.value(e.Description,{context:t});n="${path:"+o+"}"}return n};h.requiresIContext=true;a.getHeaderRatingIndicatorText=h;const x=t=>{var e,n,o;const i=v(t);if(t!==null&&t!==void 0&&(e=t.targetObject)!==null&&e!==void 0&&(n=e.annotations)!==null&&n!==void 0&&(o=n.Common)!==null&&o!==void 0&&o.Text){var r,a;const e=m(t===null||t===void 0?void 0:(r=t.targetObject.annotations)===null||r===void 0?void 0:(a=r.Common)===null||a===void 0?void 0:a.Text,i);if(f(e)){e.parameters={$$noPatch:true}}return e}return undefined};const M=(t,e,n)=>{if(!t.constraints){t.constraints={}}t.constraints=Object.assign(t.constraints,{precision:e.$target.precision,scale:n?n:e.$target.scale});if(n){if(!t.formatOptions){t.formatOptions={}}t.formatOptions=Object.assign(t.formatOptions,{preserveDecimals:false})}return t};const V=(t,e,n,o)=>{var i;let r;const a=(e===null||e===void 0?void 0:(i=e.path)===null||i===void 0?void 0:i.indexOf("/"))===-1?v(t):[];r=m(e,a);const s=t.targetObject;if(n&&f(r)){var l;O(s,r);r.type=(l=I[n])===null||l===void 0?void 0:l.type;switch(n){case"Edm.Decimal":r=M(r,e,o);break;default:}}return r};a.getValueFormatted=V;const j=(e,n,o)=>{var i,r,a,l;const d=e.targetObject;const c=(d===null||d===void 0?void 0:d.Value)||"";const v=c===null||c===void 0?void 0:(i=c.$target)===null||i===void 0?void 0:i.type;let p;if(v==="Edm.Decimal"&&d.ValueFormat){if(d.ValueFormat.NumberOfFractionalDigits){p=d.ValueFormat.NumberOfFractionalDigits}}const f=g(e,c.path);const m=f?x(f):undefined;const O=V(f,c,v,p);const I=m?n.displayMode||s(f):"Value";let _;switch(I){case"Description":_=m;break;case"ValueDescription":_=T([O,m],t.formatWithBrackets);break;case"DescriptionValue":_=T([m,O],t.formatWithBrackets);break;default:if((r=f.targetObject)!==null&&r!==void 0&&(a=r.annotations)!==null&&a!==void 0&&(l=a.Common)!==null&&l!==void 0&&l.Timezone){_=u(f,O)}else{_=y(f,O,o||(n===null||n===void 0?void 0:n.measureDisplayMode)==="Hidden")}}return b(_)};a.buildFieldBindingExpression=j;const y=(t,e,n)=>{var o,i,r,a,s,u;if((o=t.targetObject)!==null&&o!==void 0&&(i=o.annotations)!==null&&i!==void 0&&(r=i.Measures)!==null&&r!==void 0&&r.Unit||(a=t.targetObject)!==null&&a!==void 0&&(s=a.annotations)!==null&&s!==void 0&&(u=s.Measures)!==null&&u!==void 0&&u.ISOCurrency){if(n&&c(t.targetObject)){return e}return l(t,e,undefined,n?{showMeasure:false}:undefined)}return e};a._computeBindingWithUnitOrCurrency=y;const R=e=>{var n,o,i,r,a;const s=(e===null||e===void 0?void 0:(n=e.targetObject)===null||n===void 0?void 0:n.Value)||"";const l=v(e);const u=m(s,l);const d=_(e.targetObject);const c=s.$target;const g=((o=c.annotations)===null||o===void 0?void 0:(i=o.Measures)===null||i===void 0?void 0:i.Unit)||((r=c.annotations)===null||r===void 0?void 0:(a=r.Measures)===null||a===void 0?void 0:a.ISOCurrency);if(g){const e=g.$target?O(g.$target,m(g,l)):m(g,l);return b(T([u,d,e],t.computePercentage))}return b(T([u,d,""],t.computePercentage))};a.buildExpressionForProgressIndicatorPercentValue=R;return a},false);
//# sourceMappingURL=DataPointTemplating.js.map