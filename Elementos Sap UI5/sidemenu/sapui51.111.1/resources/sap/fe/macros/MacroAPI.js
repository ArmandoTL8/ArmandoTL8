/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/merge","sap/base/util/uid","sap/fe/core/buildingBlocks/BuildingBlockRuntime","sap/fe/core/converters/ConverterContext","sap/fe/core/helpers/ClassSupport","sap/ui/core/Component","sap/ui/core/Control","sap/ui/core/util/XMLPreprocessor"],function(e,t,n,r,i,o,a,s){"use strict";var c,l,u,p,f,d,g,h,m,b,v,C;var y=i.property;var P=i.implementInterface;var _=i.defineUI5Class;var w=i.aggregation;var M=n.registerBuildingBlock;function x(e,t,n,r){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function B(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function D(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;O(e,t)}function O(e,t){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return O(e,t)}function z(e,t,n,r,i){var o={};Object.keys(r).forEach(function(e){o[e]=r[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o);if(i&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(i):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function j(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}const I="sap.fe.macros.MacroAPI";let A=(c=_(I),l=P("sap.ui.core.IFormContent"),u=y({type:"string"}),p=y({type:"string"}),f=w({type:"sap.ui.core.Control",multiple:false,isDefault:true}),c(d=(g=(C=function(e){D(t,e);function t(n){var r;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++){o[a-1]=arguments[a]}r=e.call(this,n,...o)||this;x(r,"__implements__sap_ui_core_IFormContent",h,B(r));x(r,"contextPath",m,B(r));x(r,"metaPath",b,B(r));x(r,"content",v,B(r));r.parentContextToBind={};t.registerInstance(B(r));return r}var n=t.prototype;n.init=function t(){e.prototype.init.call(this);if(!this.getModel("_pageModel")){var n;const e=(n=o.getOwnerComponentFor(this))===null||n===void 0?void 0:n.getModel("_pageModel");if(e){this.setModel(e,"_pageModel")}}};t.registerInstance=function e(t){if(!this.instanceMap.get(t.constructor)){this.instanceMap.set(t.constructor,[])}this.instanceMap.get(t.constructor).push(t)};t.render=function e(t,n){t.renderControl(n.content)};n.rerender=function e(){this.content.rerender()};n.getDomRef=function t(){const n=this.content;return n?n.getDomRef():e.prototype.getDomRef.call(this)};n.getController=function e(){return this.getModel("$view").getObject().getController()};t.getAPI=function e(t){let n=t.getSource();if(this.isDependentBound){while(n&&!n.isA(I)&&n.getParent){const e=n.getDependents();const t=e.find(e=>e.isA(I));if(t){n=t}else{n=n.getParent()}}}else{while(n&&!n.isA(I)&&n.getParent){n=n.getParent()}}if(!n||!n.isA(I)){const e=this.instanceMap.get(this);n=e===null||e===void 0?void 0:e[e.length-1]}return n&&n.isA(I)&&n};t.setDefaultValue=function e(t,n,r){if(t[n]===undefined){t[n]=r}};t.register=function e(){M(this)};t.unregister=function e(){s.plugIn(null,this.namespace,this.macroName)};n.setParentBindingContext=function e(t,n){this.parentContextToBind[t]=n};n.setParent=function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++){r[i]=arguments[i]}e.prototype.setParent.call(this,...r);Object.keys(this.parentContextToBind).forEach(e=>{this.getParent().bindObject({path:this.parentContextToBind[e],model:e,events:{change:function(){const e=this.getBoundContext();if(e&&!e.getObject()){e.setProperty("",{})}}}})})};return t}(a),C.namespace="sap.fe.macros",C.macroName="Macro",C.fragment="sap.fe.macros.Macro",C.hasValidation=true,C.instanceMap=new WeakMap,C.isDependentBound=false,C.getConverterContext=function(t,n,i){const o=i.appComponent;const a=i.models.viewData&&i.models.viewData.getData();return r.createConverterContextForMacro(t.startingEntitySet.name,i.models.metaModel,o&&o.getDiagnostics(),e,t.contextLocation,a)},C.createBindingContext=function(e,n){const r=`/uid--${t()}`;n.models.converterContext.setProperty(r,e);return n.models.converterContext.createBindingContext(r)},C),h=z(g.prototype,"__implements__sap_ui_core_IFormContent",[l],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),m=z(g.prototype,"contextPath",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),b=z(g.prototype,"metaPath",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),v=z(g.prototype,"content",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),g))||d);return A},false);
//# sourceMappingURL=MacroAPI.js.map