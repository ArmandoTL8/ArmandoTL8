/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/BusyLocker","sap/fe/macros/ResourceModel","sap/fe/macros/situations/SituationsText","sap/m/Button","sap/m/CustomListItem","sap/m/HBox","sap/m/Label","sap/m/List","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/ResponsivePopover","sap/m/Text","sap/m/Toolbar","sap/m/VBox"],function(t,e,n,a,s,i,o,c,l,p,d,r,u,m,g){"use strict";var S={};var f=a.bindText;function x(t){return{path:t,type:"sap.ui.model.odata.type.DateTimeOffset",constraints:{precision:7},formatOptions:{relative:true}}}let y;function w(t,a){let s=null;const c=new r({showHeader:false,contentHeight:`${a*4.5}em`,contentWidth:"25em",busyIndicatorDelay:200,placement:"Horizontal",content:[new l({items:{path:"_Instance",events:{dataReceived:()=>{c.setContentHeight()}},parameters:{$orderby:"SitnInstceLastChgdAtDateTime desc",$expand:"_InstanceAttribute($expand=_InstanceAttributeValue)"},template:new i({type:"Navigation",press:m,content:[new o({items:[new d({icon:"sap-icon://alert",state:"Warning",tooltip:n.getText("situation")}).addStyleClass("sapUiTinyMarginEnd"),new p({title:f("SituationTitle"),text:x("SitnInstceLastChgdAtDateTime")})]}).addStyleClass("sapUiSmallMarginBeginEnd").addStyleClass("sapUiSmallMarginTopBottom")]}),templateShareable:false},showNoData:false})]});function u(){if(s){s.unbindObject();s.close()}if(y){c.openBy(y)}}async function m(n){const a=n.getSource();const i=a.getBindingContext();if(i&&y){if(s===null){s=await b(t,u);t.getView().addDependent(s)}s.bindElement({path:i.getPath(),parameters:{$expand:"_InstanceAttribute($expand=_InstanceAttributeValue)"},events:{dataReceived:()=>{e.unlock(s)}}});c.close();e.lock(s);s.openBy(y)}}return c}async function b(e,a){const i=[];if(a){i.push(new s({type:"Back",tooltip:n.getText("back"),press:a}).addStyleClass("sapUiNoMarginEnd"))}i.push(new d({state:"Warning",icon:"sap-icon://alert",tooltip:n.getText("situationIconTooltip")}).addStyleClass("sapUiSmallMarginBegin"));i.push(new p({titleActive:false,title:f("SituationTitle")}).addStyleClass("sapUiSmallMarginEnd"));const o={contentWidth:"25em",contentHeight:"7em",placement:"Horizontal",customHeader:new m({content:i}),busyIndicatorDelay:100,content:[new g({items:[new c({text:x("SitnInstceLastChgdAtDateTime")}),new u({text:f("SituationText")}).addStyleClass("sapUiTinyMarginTop")]})]};const l=t.getShellServices(e.getView());const S={target:{action:"displayExtended",semanticObject:"SituationInstance"}};const y=await l.isNavigationSupported([S]);if(y[0].supported){o.endButton=new s({text:n.getText("showDetails"),press:t=>{var e;const n=(e=t.getSource().getBindingContext())===null||e===void 0?void 0:e.getObject(`SitnInstceKey`);if(n!==undefined&&n!==null&&l.crossAppNavService){S.params={SitnInstceKey:n};l.crossAppNavService.toExternal(S)}}})}return new r(o).addStyleClass("sapUiPopupWithPadding").addStyleClass("sapUiResponsivePadding--header")}async function h(t,e,n){y=e.getSource();const a=y.getBindingContext(),s=a.getObject(`${n}/SitnNumberOfInstances`);let i;const o=a.getModel().bindContext(n,a,{$expand:"_Instance($expand=_InstanceAttribute($expand=_InstanceAttributeValue))"}).getBoundContext();if(s<=1){i=await b(t);i.setBindingContext(o);i.bindElement({path:"_Instance/0"})}else{i=w(t,s);i.setBindingContext(o)}t.getView().addDependent(i);i.openBy(y)}S.showPopover=h;h.__functionName="rt.showPopover";return S},false);
//# sourceMappingURL=SituationsPopover.js.map