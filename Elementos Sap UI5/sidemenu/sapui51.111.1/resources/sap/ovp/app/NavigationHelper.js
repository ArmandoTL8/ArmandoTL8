sap.ui.define(["sap/fe/navigation/PresentationVariant","sap/ovp/cards/AnnotationHelper","sap/ovp/cards/CommonUtils","sap/ovp/cards/Integration/Helpers/Filters","sap/ovp/helpers/ODataAnnotationHelper"],function(t,e,a,r,i){"use strict";function n(t){if(t.startsWith("#")){t=t.slice(1)}var e=t.split("-");var a=e[0]||"";var r=e[1]?e[1].split("?")[0]:"";var i={};var n=e[1]?e[1].split("?")[1]:undefined;if(n){var o=n.split("&");for(var s=0;s<o.length;s++){var c=o[s];var v=c.split("=")[0];var l=c.split("=")[1];i[v]=l}}return{semanticObject:a,action:r,parameters:i}}function o(t){if(!t){return false}var e=t.getEntityType();var a=t.getCardPropertiesModel();if(e&&a){var r=a.getProperty("/identificationAnnotationPath");var i=e[r];if(t.isNavigationInAnnotation(i)){return true}}var a=t.getCardPropertiesModel();var n=a&&a.getProperty("/template");var o=["sap.ovp.cards.table","sap.ovp.cards.list","sap.ovp.cards.v4.table","sap.ovp.cards.v4.list"];if(o.indexOf(n)>-1&&t.checkLineItemNavigation()){return true}return false}function s(t,e){var a=t.getEntityNavigationEntries()||[];var r=a.length>0?a[0]:{};if(e.cardComponentName==="List"||e.cardComponentName==="Table"){var i=t.getCardItemsBinding(),n=i&&i.getAllCurrentContexts(),o=n&&n[0],s=t.getCardPropertiesModel().getProperty("/annotationPath"),v=t.getEntityNavigationEntries(o,s),l=v.length>0?v[0]:{};var p={};var f={};if(r&&r.type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){f=c(t,r)}else if(r&&r.type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){f=u(t,r)}if(l&&l.type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){p=c(t,l)}else if(l&&l.type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){p=u(t,l)}if(p.semanticObject&&p.action&&f.semanticObject&&f.action){f["lineItemSemanticObject"]=p.semanticObject;f["lineItemAction"]=p.action}else if(p.semanticObject&&p.action){p["lineItemSemanticObject"]=p.semanticObject;p["lineItemAction"]=p.action;p.semanticObject="";p.action="";return p}return f}if(r&&r.type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return c(t,r)}if(r&&r.type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return u(t,r)}}function c(t,e){if(!sap.ushell.Container){return}var a=sap.ushell.Container.getService("URLParsing");if(!a.isIntentUrl(e.url)){return{type:"url",url:e.url}}else{var r=u(t,e);if(r.semanticObject){return r}else{var i=a.parseShellHash(e.url);return u(t,i)}}}function v(t){var e=p(t);var i=e&&e["sNavPresentationVariant"];if(i&&!a.isJSONData(i)){e["sNavPresentationVariant"]=r.removeExtraInfoVariant(i)}return e}function l(t){var e=[];for(var a=0;a<t.property.length;a++){if(t.property[a]["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]&&t.property[a]["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"].Bool){e.push(t.property[a].name)}}return e}function p(a){var r=a.getCardPropertiesModel(),i=r&&r.getProperty("/staticContent");var n,o;if(!i){var s=e.getCardSorters(a.getCardPropertiesModel());var c=a.getEntityType();o=s&&new t(s);n=r&&r.getProperty("/staticParameters")}var v=l(c);return{sensitiveProperties:v,staticPropertyMap:n,sNavPresentationVariant:o?o.toJSONObject():null}}function u(t,e){return{type:"intent",semanticObject:e.semanticObject,action:e.action,staticParams:v(t)}}function f(t,e){if(t&&t.length){var r=a.isODataV4(e);for(var i=0;i<t.length;i++){var n=t[i];if(r&&n.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return true}else if(!r&&n.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return true}}}return false}function g(t){if(t){var e=t.getProperty("/template");var a=t.getProperty("/navigation");if(a=="noHeaderNav"&&["sap.ovp.cards.charts.analytical","sap.ovp.cards.charts.smart.chart"].indexOf(e)>-1){return false}else{return true}}return false}function d(t,e,a){if(e&&t){var r=t.getProperty("/identificationAnnotationPath");var n=i.getRecords(e,r,a);return f(n,a)}return false}function m(t,e){if(e&&t){if(t.getProperty("/template")==="sap.ovp.cards.charts.analytical"){var a=t.getProperty("/kpiAnnotationPath");if(a){var r=e[a];if(r&&r.Detail){var i=r.Detail.SemanticObject&&r.Detail.SemanticObject.String;var n=r.Detail.Action&&r.Detail.Action.String;if(i&&n){return true}}}}}return false}function y(t,e,a){if(e&&t){var r=t.getProperty("/annotationPath");var n=i.getRecords(e,r,a);return f(n,a)}return false}return{getNavigationIntentFromAuthString:n,bCheckNavigationForCard:o,getNavigationParameters:s,checkHeaderNavForChart:g,checkLineItemNavigation:y,checkIdentificationAnnotationNavigation:d,checkKPIAnnotationNavigation:m}},true);
//# sourceMappingURL=NavigationHelper.js.map