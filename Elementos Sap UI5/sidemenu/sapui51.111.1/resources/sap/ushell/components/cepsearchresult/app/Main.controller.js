//Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ushell/components/cepsearchresult/app/util/SearchResultManager","sap/ui/integration/Host"],function(e,t,s){"use strict";return e.extend("sap.ushell.components.cepsearchresult.app.Main",{onInit:function(){this.initCard();this.initSearchResultManager()},initCard:function(){var e=this.getView().byId("searchResultWidget");if(!this.oHost){this.oHost=new s({actions:[{type:"Navigation",action:this.handleCardAction.bind(this)}],id:"searchAppHost",resolveDestination:function(e){return null}});e.setHost(this.oHost)}},initSearchResultManager:function(){this.oSearchResultManager=new t(this.getOwnerComponent().getSearchConfig());var e=this.oSearchResultManager.getModel();this.oSearchResultManager._loaded.then(function(){if(e.getProperty("/categories/0/name")==="all"&&e.getProperty("/categories").length===2){this.setCategory(e.getProperty("/categories/1/name"));this.byId("searchCategoriesTabs").getItems()[0].setVisible(false)}else{this.setCategory(this.getOwnerComponent().getCategory())}this.getView().setVisible(true);this.byId("searchResultWidget").setManifest(sap.ui.require.toUrl("sap/ushell/components/cepsearchresult/app/cards/searchresultwidget/manifest.json"))}.bind(this));this.getView().setModel(e,"manager")},onExit:function(){if(this.oHost){this.oHost.destroy()}this.oSearchResultManager=null;this.oHost=null},tabSelectionChange:function(e){this.setCategory(e.getParameters().item.getKey())},setCategory:function(e){this.byId("searchCategoriesTabs").setSelectedKey(e);this.updateResultCard()},updateResultCard:function(){var e=this.byId("searchResultWidget");var t=e.getParent();t.removeItem(e);e.setParameters({categories:this.byId("searchCategoriesTabs").getSelectedKey(),searchTerm:this.getOwnerComponent().getSearchTerm(),edition:this.getOwnerComponent().getSearchConfig()});t.addItem(e)},onAfterRendering:function(){var e=this.getView().getDomRef().querySelector(".sapUiCEPSRAppScroll");e.style.height="calc( 100% - "+e.offsetTop+"px )"},handleCardAction:function(e){if(e.mParameters&&e.mParameters.type==="Navigation"&&e.mParameters.parameters.category){this.setCategory(e.mParameters.parameters.category)}return true},translateTitle:function(e){return e.replace("{0}",this.getOwnerComponent().getSearchTerm()).replace("{1}","--")}})});
//# sourceMappingURL=Main.controller.js.map