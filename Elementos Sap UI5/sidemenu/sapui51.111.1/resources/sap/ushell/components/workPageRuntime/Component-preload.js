//@ui5-bundle sap/ushell/components/workPageRuntime/Component-preload.js
sap.ui.require.preload({
	"sap/ushell/components/workPageRuntime/Component.js":function(){
//Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/UIComponent"],function(t){"use strict";return t.extend("sap.ushell.components.workPageRuntime.Component",{metadata:{manifest:"json",library:"sap.ushell"},getNavigationDisabled:function(){var t=this.getComponentData()||{};return!!t.navigationDisabled},hideRuntime:function(){this.getRootControl().getController().hideRuntime()},onRouteMatched:function(){this.getRootControl().getController().onRouteMatched()}})});
},
	"sap/ushell/components/workPageRuntime/controller/WorkPageRuntime.controller.js":function(){
//Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/ui/core/mvc/Controller","sap/ushell/components/workPageRuntime/services/WorkPage","sap/base/util/deepExtend","sap/ushell/EventHub","sap/ushell/components/pages/controller/PagesAndSpaceId","sap/ushell/resources","sap/ushell/Config","sap/base/util/ObjectPath"],function(e,t,i,o,n,a,r,s,d){"use strict";return t.extend("sap.ushell.components.workPageRuntime.controller.WorkPageRuntime",{onInit:function(){var e=sap.ushell.Container.getRenderer();var t=new URLSearchParams(window.location.search);this.oWorkPageService=new i;this.oWorkPageNavContainer=this.byId("workpageNavContainer");this.oEmptyPage=this.byId("emptyPage");this._oWorkPageBuilderComponentCreatedPromise=new Promise(function(e,t){this._oWorkPageBuilderComponentResolve=e;this._oWorkPageBuilderComponentReject=t}.bind(this));return this._getPageId().then(function(i){this._sPageId=i;this._sSiteId=t.get("siteId")||s.last("/core/site/siteId");this._bWorkPageIsDirty=false;var o=this._oWorkPageBuilderComponentCreatedPromise.then(function(e){e.attachEvent("workPageEdited",this._onWorkPageChanged.bind(this,true));e.attachEvent("visualizationFilterApplied",this._loadFilteredVisualizations.bind(this));e.attachEvent("closeEditMode",this._closeEditMode.bind(this))}.bind(this));var a=this._onWorkPageLoad().finally(function(){n.emit("CenterViewPointContentRendered");if(!this.getOwnerComponent().getNavigationDisabled()){this.oContainerRouter=e.getRouter();this.oContainerRouter.getRoute("home").attachMatched(this.onRouteMatched.bind(this,false));this.oContainerRouter.getRoute("openFLPPage").attachMatched(this.onRouteMatched.bind(this,false))}}.bind(this));return Promise.all([o,a])}.bind(this)).catch(this._handleErrors.bind(this))},_handleEditModeButton:function(e){var t=e;var i=sap.ushell.Container.getUser().isAdminUser();if(t&&i){return this._createEditModeButton(this._createEditButtonControlProperties())}this._hideEditModeButton();return Promise.resolve()},_onWorkPageChanged:function(e){this._bWorkPageIsDirty=!!e;sap.ushell.Container.setDirtyFlag(!!e)},_navigate:function(){this.oWorkPageNavContainer.to(this.byId("workPage"))},_createEditButtonControlProperties:function(){var t=r.i18n.getText("WorkpageRuntime.EditMode.Activate");e.debug("cep/editMode: create Edit Button","Workpage runtime");return{id:"EditModeBtn",text:t,icon:"sap-icon://edit",press:[this.pressEditModeButton,this]}},_createEditModeButton:function(e){var t={controlType:"sap.ushell.ui.launchpad.ActionItem",oControlProperties:e,bIsVisible:true,aStates:["home"]};this._showEditModeButton();return sap.ushell.Container.getRenderer("fiori2").addUserAction(t).then(function(e){if(s.last("/core/extension/enableHelp")){e.addStyleClass("help-id-EditModeBtn")}})},_setEditButtonText:function(e){if(e){var t=sap.ui.getCore().byId("EditModeBtn");if(t){var i=r.i18n.getText(e);t.setText(i);t.setTooltip(i)}}},pressEditModeButton:function(){if(this._oWorkPageBuilderComponent.getEditMode()){if(this._bWorkPageIsDirty){this._saveChanges()}else{this._toggleEditMode(false)}}else{this._toggleEditMode(true)}},_toggleEditMode:function(t){n.emit("enableMenuBarNavigation",!t);e.debug("cep/editMode: toggle edit mode"," Work Page runtime");this._oWorkPageBuilderComponent.setEditMode(t);this._setEditButtonText(t?"PageRuntime.EditMode.Exit":"WorkpageRuntime.EditMode.Activate");this._onWorkPageChanged(false)},_cancelChanges:function(){this._toggleEditMode(false);this._oWorkPageBuilderComponent.setPageData(o({},this._oOriginalData))},_saveChanges:function(){var e=this.getView();e.setBusy(true);return this._updateWorkPage().then(function(e){sap.ui.require(["sap/m/MessageToast"],function(e){e.show(r.i18n.getText("savedChanges"),{duration:4e3})});this._toggleEditMode(false);this._oOriginalData=o({},e);this._oWorkPageBuilderComponent.setPageData(e)}.bind(this)).catch(function(e){var t=e.responseText||e;sap.ui.require(["sap/m/MessageBox"],function(i){i.error(t,{title:e.statusText})})}).finally(function(){e.setBusy(false)})},_closeEditMode:function(e){(e.getParameter("saveChanges")?this._saveChanges:this._cancelChanges).bind(this)()},onWorkPageBuilderCreated:function(e){this._oWorkPageBuilderComponent=e.getParameter("component");this._oWorkPageBuilderComponent.setShowFooter(true);this._oWorkPageBuilderComponentResolve(this._oWorkPageBuilderComponent)},_loadFilteredVisualizations:function(e){var t=e.getParameter("filters")||[];var i;var o=[];if(t.length>0){i=t.find(function(e){return e.filterKey==="Type"});if(i&&i.filterValue&&i.filterValue.length>0){o=i.filterValue}}return this.oWorkPageService.loadFilteredVisualizations("",o).then(function(e){this._oWorkPageBuilderComponent.setVisualizationData(e)}.bind(this))},_updateWorkPage:function(){var e=this._oWorkPageBuilderComponent.getPageData();var t=o({Id:this._sPageId},e);return this.oWorkPageService.updateWorkPage(this._sPageId,d.get("WorkPage.Contents",t))},_hideEditModeButton:function(){var t=sap.ui.getCore().byId("EditModeBtn");e.debug("cep/editMode: hide Edit Mode button","Work Page runtime");if(t){t.setVisible(false)}},_showEditModeButton:function(){var t=sap.ui.getCore().byId("EditModeBtn");e.debug("cep/editMode: show Edit Mode button","Work Page runtime");if(t){t.setVisible(true)}},_handleErrors:function(t){this._hideEditModeButton();e.error("An error occurred while loading the page",t);e.debug("cep/editMode: on Route matched: Handle errors","Work Page runtime");this.oWorkPageNavContainer.to(this.byId("errorPage"))},onRouteMatched:function(){e.debug("cep/editMode: on Route matched","Work Page runtime");return this._getPageId().then(function(e){this._sPageId=e;return this._onWorkPageLoad()}.bind(this)).catch(this._handleErrors.bind(this))},_onWorkPageLoad:function(){this._oLoadWorkPageAndVisualizationsPromise=this.oWorkPageService.loadWorkPageAndVisualizations(this._sSiteId,this._sPageId);return Promise.all([this._oWorkPageBuilderComponentCreatedPromise,this._oLoadWorkPageAndVisualizationsPromise]).then(function(e){var t=e[0];var i=e[1];this._oOriginalData=o({},i);t.setPageData(i);this._navigate();return this._handleEditModeButton(i.WorkPage.Editable)}.bind(this))},_getPageId:function(){if(s.last("/core/workPages/myHome/pageId")){return Promise.resolve(s.last("/core/workPages/myHome/pageId"))}return a._getPageAndSpaceId().then(function(e){return e.pageId})},hideRuntime:function(){e.debug("cep/editMode: navigate to empty page","Page runtime");this._hideEditModeButton();this.oWorkPageNavContainer.to(this.oEmptyPage)}})});
},
	"sap/ushell/components/workPageRuntime/manifest.json":'{"_version":"1.39.0","sap.app":{"id":"sap.ushell.components.workPageRuntime","applicationVersion":{"version":"1.111.1"},"ach":"CA-FLP-FE-UI","type":"component","title":""},"sap.ui":{"fullWidth":false,"technology":"UI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"componentUsages":{"pageBuilder":{"name":"sap.ushell.components.workPageBuilder","lazy":true}},"componentName":"sap.ushell.components.workPageRuntime","rootView":{"viewName":"sap.ushell.components.workPageRuntime.view.WorkPageRuntime","type":"XML","async":true},"dependencies":{"minUI5Version":"1.99","libs":{"sap.ui.core":{},"sap.m":{}}},"contentDensities":{"compact":true,"cozy":true}}}',
	"sap/ushell/components/workPageRuntime/services/NavigationResolver.js":function(){
// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/ObjectPath","sap/ui/core/Core","sap/ushell/Config","sap/base/Log"],function(e,t,n,o){"use strict";var r=function(){this._sBaseUrl=n.last("/core/workPages/navigationApiUrl");this._sSiteId=e.get("ushell.site.siteId",window["sap-ushell-config"])};r.prototype._fetchCsrfToken=function(){if(this._oFetchCsrfTokenPromise){return this._oFetchCsrfTokenPromise}this._oFetchCsrfTokenPromise=fetch(this._sBaseUrl,{method:"HEAD",headers:{"x-csrf-token":"fetch","Accept-Language":t.getConfiguration().getLanguageTag()}}).then(function(e){return e.headers.get("x-csrf-token")});return this._oFetchCsrfTokenPromise};r.prototype.resolveByInbound=function(e,n){return this._fetchCsrfToken().then(function(o){return fetch(this._sBaseUrl+"/resolve/inbound",{method:"POST",headers:{"Content-Type":"application/json; utf-8",Accept:"application/json","x-csrf-token":o,"Accept-Language":t.getConfiguration().getLanguageTag()},body:JSON.stringify({inboundIdentifier:e,intentParameters:n,queryParameters:{siteId:this._sSiteId},launchType:"standalone"})}).then(function(e){if(e.ok===false){return Promise.reject(e.statusText)}return e.json()}).then(function(e){var t=e.value||e;var n=Array.isArray(t)?t[0].url:t.url;return{additionalInformation:"",url:n,applicationType:"URL",navigationMode:"newWindow"}})}.bind(this)).catch(function(t){o.error("Tile target for inboundId '"+e+"' could not be resolved. The tile will be shown but will not navigate.");o.error(t);return{additionalInformation:"",url:"",applicationType:"URL",navigationMode:"newWindow"}})};return r},true);
},
	"sap/ushell/components/workPageRuntime/services/WorkPage.js":function(){
// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Core","sap/ushell/utils/HttpClient","sap/base/util/ObjectPath","sap/ushell/Config","sap/base/Log"],function(e,t,r,a,s){"use strict";var o=function(){this.httpClient=new t;this._sBaseUrl=a.last("/core/workPages/contentApiUrl")};o.prototype._validateData=function(e){s.debug("cep/editMode: load Page: validate","Work Page service");if(e.errors&&e.errors.length>0){return Promise.reject(e.errors.map(function(e){return e.message}).join(",\n"))}if(!r.get("data.WorkPage",e)){s.debug("cep/editMode: load Page: validate: reject: data is empty","Work Page service");return Promise.reject("Work Page data is empty")}return Promise.resolve(e)};o.prototype.loadWorkPageAndVisualizations=function(e,t){var a="{"+"WorkPage("+'SiteId:"'+e+'",'+'WorkPageId:"'+t+'"'+") {"+"Id,"+"Contents,"+"Editable,"+"UsedVisualizations{"+"nodes{"+"Id,"+"Type,"+"Descriptor,"+"DescriptorResources{"+"BaseUrl,"+"DescriptorPath"+"}"+"}"+"}"+"}"+"}";return this._doRequest(a).then(this._validateData).then(function(e){var t=r.get("data.WorkPage.Contents",e);var a=r.get("data.WorkPage.UsedVisualizations.nodes",e)||[];var s=r.get("data.WorkPage.Editable",e)===true;return{WorkPage:{Contents:t,UsedVisualizations:{nodes:a},Editable:s}}})};o.prototype.updateWorkPage=function(t,a){function s(e){for(var t in e){if(e[t]!==null&&typeof e[t]==="object"){if(e.DescriptorSchemaVersion){return e.DescriptorSchemaVersion}return s(e[t])}}return""}var o=s(a);function n(e,t){if(e&&e.DescriptorSchemaId){delete e.DescriptorSchemaId}for(var r in e){if(e[r]!==null&&typeof e[r]==="object"){n(e[r],!isNaN(r))}}if(e&&t){e.Descriptor=e.Descriptor||{};e.DescriptorSchemaVersion=e.DescriptorSchemaVersion||o}}function i(e){if(e.Rows){e.Rows.forEach(function(e){if(e.Columns){e.Columns.forEach(function(e){if(!e.Cells){e.Cells=[]}})}})}}n(a,true);i(a);var u="mutation updateWorkPage($WorkPageId: String!, $Contents: JSON) {"+"updateWorkPage(WorkPageId: $WorkPageId, Contents: $Contents ) {"+"Id,"+"Contents,"+"Editable,"+"UsedVisualizations{"+"nodes{"+"Id,"+"Type,"+"Descriptor,"+"DescriptorResources{"+"BaseUrl,"+"DescriptorPath"+"}"+"}"+"}"+"}"+"}";var p={query:u,variables:{WorkPageId:t,Contents:a}};return this.httpClient.post(this._sBaseUrl,{data:p,headers:{"Content-Type":"application/json",Accept:"application/json","Accept-Language":e.getConfiguration().getLanguageTag()}}).then(function(e){if(e.status<200||e.status>=300){return Promise.reject({statusText:"HTTP request failed with status: "+e.status,responseText:e.statusText})}var t={};try{t=JSON.parse(e.responseText||"{}")}catch(t){return Promise.reject({statusText:undefined,responseText:e.responseText})}var r;var a;if(t.errors){try{var s=t.errors[0].split("[");r=s[0];var o=JSON.parse("["+s[1]);a=JSON.stringify(o,null,"  ")}catch(e){r=null;a=t.errors}return Promise.reject({statusText:r,responseText:a})}return t}).then(function(e){var t=r.get("data.updateWorkPage.Contents",e);var a=r.get("data.updateWorkPage.UsedVisualizations.nodes",e)||[];var s=r.get("data.updateWorkPage.Editable",e)===true;return{WorkPage:{Contents:t,UsedVisualizations:{nodes:a},Editable:s}}})};o.prototype.loadFilteredVisualizations=function(e,t){var a=t.map(function(e){return'"'+e+'"'}).join(",");var s="{"+"Visualizations("+'SiteId:"'+e+'",'+"QueryInput:{filter:{Type:{in:["+a+"]}}}"+") {"+"nodes{"+"Id,"+"Type,"+"Descriptor,"+"DescriptorResources{"+"BaseUrl,"+"DescriptorPath"+"}"+"}"+"}"+"}";return this._doRequest(s).then(function(e){var t=r.get("data.Visualizations.nodes",e)||[];return{Visualizations:{nodes:t}}})};o.prototype._doRequest=function(t){return this.httpClient.get(this._sBaseUrl+"?query="+t,{headers:{"Content-Type":"application/json",Accept:"application/json","Accept-Language":e.getConfiguration().getLanguageTag()}}).then(function(e){if(e.status<200||e.status>=300){return Promise.reject("HTTP request failed with status: "+e.status+" - "+e.statusText)}return JSON.parse(e.responseText||"{}")})};return o},true);
},
	"sap/ushell/components/workPageRuntime/view/WorkPageRuntime.view.xml":'<mvc:View\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:mvc="sap.ui.core.mvc"\n    controllerName="sap.ushell.components.workPageRuntime.controller.WorkPageRuntime"\n    height="100%"><NavContainer id="workpageNavContainer"><Page\n            id="workPage"\n            busy="{= !${/loaded}}"\n            enableScrolling="false"\n            showHeader="false"><core:ComponentContainer\n                height="100%"\n                usage="pageBuilder"\n                manifest="true"\n                async="true"\n                componentCreated="onWorkPageBuilderCreated"\n            /></Page><MessagePage\n            id="errorPage"\n            showHeader="false"\n            description="" /><Page\n            id="emptyPage"\n            showHeader="false" /></NavContainer></mvc:View>\n'
});
//# sourceMappingURL=Component-preload.js.map
