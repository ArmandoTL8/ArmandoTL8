// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Configuration","sap/ui/core/Control","sap/ui/core/Core","sap/ui/Device","sap/ui/performance/Measurement","sap/ui/thirdparty/jquery","sap/ui/util/Storage","sap/ushell/EventHub","sap/ushell/library"],function(e,t,a,i,n,jQuery,o,s,l){"use strict";var r=t.extend("sap.ushell.ui.shell.FloatingContainer",{metadata:{library:"sap.ushell",properties:{},aggregations:{content:{type:"sap.ui.core.Control",multiple:true}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.class("sapUshellFloatingContainer");e.openEnd();if(t.getContent()&&t.getContent().length){e.renderControl(t.getContent()[0])}e.close("div")}}});r.prototype.init=function(){i.resize.attachHandler(r.prototype._handleResize,this)};r.prototype._getWindowHeight=function(){return jQuery(window).height()};r.prototype._setContainerHeight=function(e,t){e.css("max-height",t)};r.prototype._handleResize=function(t){n.start("FLP:FloatingContainer_handleResize","resizing floating container","FLP");if(jQuery(".sapUshellFloatingContainer").parent()[0]&&jQuery(".sapUshellContainerDocked").length===0){this.oWrapper=jQuery(".sapUshellFloatingContainer").parent()[0];this.oWrapper.style.cssText=this.oStorage.get("floatingContainerStyle");var l=window.matchMedia?window.matchMedia("(max-width: 417px)").matches:false;this.adjustPosition(t,l)}else if(jQuery(".sapUshellFloatingContainer").parent()[0]&&jQuery(".sapUshellContainerDocked").length){if(jQuery("#canvas").hasClass("sapUshellContainer-Narrow-Right")){var r;if(e.getRTL()){jQuery("#sapUshellFloatingContainerWrapper").css("left",416/jQuery(window).width()*100+"%");r=416/jQuery(window).width()*100+"%;"}else{jQuery("#sapUshellFloatingContainerWrapper").css("left",100-416/jQuery(window).width()*100+"%");r=100-416/jQuery(window).width()*100+"%;"}this.oWrapper.style.cssText="left:"+r+this.oWrapper.style.cssText.substring(this.oWrapper.style.cssText.indexOf("top"));this.oStorage.put("floatingContainerStyle",this.oWrapper.style.cssText)}}if(jQuery(".sapUshellContainerDocked").length>0){a.getEventBus().publish("launchpad","shellFloatingContainerDockedIsResize");s.emit("ShellFloatingContainerDockedIsResized",Date.now())}var p=i.media.getCurrentRange(i.media.RANGESETS.SAP_STANDARD);if(p.name!=="Desktop"&&jQuery(".sapUiMedia-Std-Desktop").width()-416<p.from&&jQuery(".sapUshellContainerDocked").length){jQuery("#canvas, .sapUshellShellHead").removeClass("sapUshellContainerDocked");if(jQuery("#canvas").hasClass("sapUshellContainer-Narrow-Right")){jQuery("#canvas").removeClass("sapUshellContainer-Narrow-Right sapUshellMoveCanvasRight")}else{jQuery("#canvas").removeClass("sapUshellContainer-Narrow-Left sapUshellMoveCanvasLeft")}jQuery(".sapUshellShellFloatingContainerFullHeight").removeClass("sapUshellShellFloatingContainerFullHeight");a.byId("mainShell").getController()._handleAnimations(false);var h=new o(o.Type.local,"com.sap.ushell.adapters.local.CopilotLastState");if(h){h.put("lastState","floating")}a.getEventBus().publish("launchpad","shellFloatingContainerIsUnDockedOnResize");jQuery("#sapUshellFloatingContainerWrapper").removeClass("sapUshellContainerDocked sapUshellContainerDockedMinimizeCoPilot sapUshellContainerDockedExtendCoPilot");var d=a.byId("viewPortContainer");if(d){d._handleSizeChange()}}n.end("FLP:FloatingContainer_handleResize")};r.prototype.adjustPosition=function(t,a){var i=t?t.width:jQuery(window).width(),n=t?t.height:jQuery(window).height(),o=this.oContainer.width(),s=this.oContainer.height(),l,r,p,h,d=e.getRTL();a=a!==undefined?a:false;if(this.oWrapper){p=this.oWrapper.style.left.replace("%","");p=i*p/100;h=this.oWrapper.style.top.replace("%","");h=n*h/100;if(!isNaN(p)&&!isNaN(h)&&!a){if(d){l=p<o||p>i;if(l){p=p<o?o:i}}else{l=p<0||i<p+o;if(l){p=p<0?0:i-o}}r=h<0||n<h+s;if(r){h=h<0?0:n-s}if(!l&&!r){this.oWrapper.style.left=p*100/i+"%";this.oWrapper.style.top=h*100/n+"%";this.oWrapper.style.position="absolute";return}this.oWrapper.style.left=p*100/i+"%";this.oWrapper.style.top=h*100/n+"%";this.oWrapper.style.position="absolute"}}};r.prototype.handleDrop=function(){if(this.oWrapper){this.adjustPosition();this.oStorage.put("floatingContainerStyle",this.oWrapper.style.cssText)}};r.prototype.setContent=function(e){if(this.getDomRef()){var t=a.createRenderManager();t.renderControl(e);t.flush(this.getDomRef());t.destroy()}this.setAggregation("content",e,true)};r.prototype.onAfterRendering=function(){this.oStorage=this.oStorage||new o(o.Type.local,"com.sap.ushell.adapters.local.FloatingContainer");this.oContainer=jQuery(".sapUshellFloatingContainer");this.oWrapper=jQuery(".sapUshellFloatingContainer").parent()[0]};r.prototype.exit=function(){i.resize.detachHandler(r.prototype._resizeHandler,this)};return r});
//# sourceMappingURL=FloatingContainer.js.map