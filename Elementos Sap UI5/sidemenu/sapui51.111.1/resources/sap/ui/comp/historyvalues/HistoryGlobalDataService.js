/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object","./Constants"],function(t,e){"use strict";var i;var s=t.extend("sap.ui.comp.historyvalues.HistoryGlobalDataService",{constructor:function(){t.apply(this,arguments);this._initialize()}});s.prototype._initialize=function(){this._initializeHistoryData=this._initializeHistoryData.bind(this);this._sContainerId=e.getHistoryPrefix()+"HistorySettings";this._sItemId=e.getHistoryPrefix()+"settings";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=this._getPersonalizer().getPersData().then(this._initializeHistoryData)};s.prototype._initializeHistoryData=function(t){this._oData=t||this._getDefaultData();this._oData=Object.assign({suggestionsEnabled:true},this._oData);return Object.assign({},this._oData)};s.prototype._getPersonalizer=function(){if(this._oPersonalizer){return this._oPersonalizer}var t=sap.ushell.Container.getService("Personalization"),e={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},i={container:this._sContainerId,item:this._sItemId};this._oPersonalizer=t.getPersonalizer(i,e);return this._oPersonalizer};s.prototype._getDefaultData=function(){return{historyEnabled:true,suggestionsEnabled:true,apps:{}}};s.prototype._isDataReady=function(){return this._oDataReadyPromise};s.prototype.getHistoryEnabled=function(){return this._isDataReady().then(function(){return this._oData.historyEnabled}.bind(this))};s.prototype.setHistoryEnabled=function(t){return this._isDataReady().then(function(){this._oData.historyEnabled=t;return this._getPersonalizer().setPersData(this._oData)}.bind(this))};s.prototype.getSuggestionsEnabled=function(){return this._isDataReady().then(function(){return true})};s.prototype.setSuggestionsEnabled=function(t){return this._isDataReady().then(function(){this._oData.suggestionsEnabled=t;return this._getPersonalizer().setPersData(this._oData)}.bind(this))};s.prototype.getApps=function(){return this._isDataReady().then(function(){return Object.assign({},this._oData.apps)}.bind(this))};s.prototype.setApps=function(t){return this._isDataReady().then(function(){this._oData.apps=t;return this._getPersonalizer().setPersData(this._oData)}.bind(this))};s.prototype.deleteHistory=function(){return this._isDataReady().then(function(){var t=this._oData,e=[],i=t.apps;Object.keys(i).forEach(function(t){e.push(sap.ushell.Container.getService("Personalization").delContainer(i[t]))});return Promise.all(e)}.bind(this))};s.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._sContainerId="";this._sItemId="";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){if(!i){i=new s}return i}}});
//# sourceMappingURL=HistoryGlobalDataService.js.map