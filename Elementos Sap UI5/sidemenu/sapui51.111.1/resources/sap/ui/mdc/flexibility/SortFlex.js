/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/p13n/Engine","sap/ui/mdc/flexibility/Util","sap/ui/fl/changeHandler/Base"],function(e,r,n){"use strict";var t=function(r){var n=r&&r.isA&&r.isA("sap.ui.mdc.Table")&&r.isTableBound();var t=r&&r.isA&&r.isA("sap.ui.mdc.Chart");if(n||t){if(!r._bWaitForBindChanges){r._bWaitForBindChanges=true;e.getInstance().waitForChanges(r).then(function(){if(n){r.rebind()}else if(t){r.rebind()}delete r._bWaitForBindChanges})}}};var i=function(e,r,n,i){if(i){e.resetRevertData()}else{e.setRevertData(n)}t(r)};var a=function(e,n,t,a){return new Promise(function(o,s){var c=a===r.REVERT;var d=t.modifier;var v=c?e.getRevertData():e.getContent();Promise.resolve().then(d.getProperty.bind(d,n,"sortConditions")).then(function(r){var t=r?r.sorters:[];var a={name:v.key||v.name,descending:v.descending};t.splice(v.index,0,a);r={sorters:t};d.setProperty(n,"sortConditions",r);i(e,n,a,c);o()}).catch(function(e){s(e)})})};var o=function(e,t,a,o){return new Promise(function(s,c){var d=a.modifier;var v=o===r.REVERT;var f=v?e.getRevertData():e.getContent();Promise.resolve().then(d.getProperty.bind(d,t,"sortConditions")).then(function(r){var a=r?r.sorters:[];if(!a){c()}var o=a.filter(function(e){return e.name===f.name});var u=a.indexOf(o[0]);if(u>-1){a.splice(u,1)}else{return n.markAsNotApplicable("The specified change is already existing - change appliance ignored",true)}r={sorters:a};d.setProperty(t,"sortConditions",r);i(e,t,f,v);s()}).catch(function(e){c(e)})})};var s=function(e,n,t,a){return new Promise(function(o,s){var c=a===r.REVERT;var d=t.modifier;var v=c?e.getRevertData():e.getContent();Promise.resolve().then(d.getProperty.bind(d,n,"sortConditions")).then(function(r){var t=r?r.sorters:[];var a=t.filter(function(e){return e.name===v.name});var s=t.indexOf(a[0]);t.splice(v.index,0,t.splice(s,1)[0]);r={sorters:t};d.setProperty(n,"sortConditions",r);i(e,n,v,c);o()}).catch(function(e){s(e)})})};var c={};c.removeSort=r.createChangeHandler({apply:o,revert:a});c.addSort=r.createChangeHandler({apply:a,revert:o});c.moveSort=r.createChangeHandler({apply:s,revert:s});return c});
//# sourceMappingURL=SortFlex.js.map