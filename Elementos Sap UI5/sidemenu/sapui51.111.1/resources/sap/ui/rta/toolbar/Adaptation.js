/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["require","sap/ui/core/Fragment","sap/ui/core/Popup","sap/ui/core/IconPool","sap/ui/fl/write/api/Version","sap/ui/rta/toolbar/contextBased/SaveAsAdaptation","sap/ui/rta/toolbar/contextBased/ManageAdaptations","sap/ui/rta/toolbar/translation/Translation","sap/ui/rta/toolbar/versioning/Versioning","sap/ui/rta/appVariant/Feature","sap/ui/rta/toolbar/Base","sap/ui/rta/Utils","sap/ui/Device","./AdaptationRenderer"],function(t,e,i,o,n,s,a,r,h,l,p,u,c,d){"use strict";var g=p.extend("sap.ui.rta.toolbar.Adaptation",{renderer:d,animation:true,metadata:{library:"sap.ui.rta",events:{undo:{},redo:{},exit:{},save:{},restore:{},publishVersion:{},modeChange:{},activate:{},discardDraft:{},switchVersion:{},openChangeCategorySelectionPopover:{}}}});g.modes={MOBILE:"sapUiRtaToolbarMobile",TABLET:"sapUiRtaToolbarTablet",DESKTOP:"sapUiRtaToolbarDesktop"};var f="sapUiRtaToolbar";g.prototype.init=function(){this._pFragmentLoaded=p.prototype.init.apply(this,arguments).then(function(){if(!c.media.hasRangeSet(f)){c.media.initRangeSet(f,[900,1200],"px",[g.modes.MOBILE,g.modes.TABLET,g.modes.DESKTOP])}c.media.attachHandler(this._onSizeChanged,this,f)}.bind(this));o.registerFont({collectionName:"BusinessSuiteInAppSymbols",fontFamily:"BusinessSuiteInAppSymbols",fontURI:t.toUrl("sap/ushell/themes/base/fonts/"),lazy:true})};g.prototype._hideElementsOnIntersection=function(t){if(t[0].intersectionRatio===0){this._observeActionToolbarIntersection();return}if(t[0].intersectionRatio<1){if(!this._mSizeLimits.switchToIcons){var e=t[0].boundingClientRect.width-t[0].intersectionRect.width;this._mSizeLimits.switchToIcons=window.innerWidth+e;this._switchToIcons()}}};g.prototype.onFragmentLoaded=function(){return this._pFragmentLoaded};g.prototype.exit=function(){c.media.detachHandler(this._onSizeChanged,this,f);p.prototype.exit.apply(this,arguments)};g.prototype.show=function(){this._onSizeChanged(c.media.getCurrentRange(f),true);return p.prototype.show.apply(this,arguments)};function b(t,e,i,o){var n=this.getControl(t);var s=i?this.getTextResources().getText(i):"";var a=o?this.getTextResources().getText(o):"";n.setText(s||"");n.setTooltip(a||"");n.setIcon(e||"")}g.prototype.formatPublishVersionVisibility=function(t,e,i,o){return this.getExtension("versioning",h).formatPublishVersionVisibility(t,e,i,o)};g.prototype.formatDiscardDraftVisible=function(t,e,i){return this.getExtension("versioning",h).formatDiscardDraftVisible(t,e,i)};g.prototype.formatVersionButtonText=function(t,e){return this.getExtension("versioning",h).formatVersionButtonText(t,e)};g.prototype.showVersionHistory=function(t){return this.getExtension("versioning",h).showVersionHistory(t)};g.prototype._openVersionTitleDialog=function(t){return this.getExtension("versioning",h).openActivateVersionDialog(t)};g.prototype.showActionsMenu=function(t){var o=t.getSource();if(!this._oActionsMenuFragment){return e.load({id:this.getId()+"_actionsMenu_fragment",name:"sap.ui.rta.toolbar.ActionsMenu",controller:{openDownloadTranslationDialog:m.bind(this),openUploadTranslationDialog:v.bind(this),manageApps:B.bind(this),overviewForKeyUser:x.bind(this),overviewForDeveloper:I.bind(this),restore:this.eventHandler.bind(this,"Restore"),formatSaveAsEnabled:T,saveAs:y.bind(this)}}).then(function(t){t.addStyleClass(u.getRtaStyleClassName());this.addDependent(t);t.openBy(o,true,i.Dock.CenterTop,i.Dock.CenterBottom);this._oActionsMenuFragment=t}.bind(this))}this._oActionsMenuFragment.openBy(o,true,i.Dock.CenterTop,i.Dock.CenterBottom);return Promise.resolve()};g.prototype._showButtonIcon=function(t,e,i){b.call(this,t,e,"",i)};g.prototype._showButtonText=function(t,e){b.call(this,t,"",e,"")};g.prototype._switchToIcons=function(){var t=this.getControl("iconBox");var e=this.getControl("iconSpacer");t.setVisible(false);e.setVisible(false);this._showButtonIcon("adaptationSwitcherButton","sap-icon://wrench","BTN_ADAPTATION");this._showButtonIcon("navigationSwitcherButton","sap-icon://explorer","BTN_NAVIGATION");this._showButtonIcon("visualizationSwitcherButton","sap-icon://show","BTN_VISUALIZATION")};g.prototype._switchToTexts=function(){var t=this.getControl("iconBox");var e=this.getControl("iconSpacer");t.setVisible(true);e.setVisible(true);this._showButtonText("adaptationSwitcherButton","BTN_ADAPTATION");this._showButtonText("navigationSwitcherButton","BTN_NAVIGATION");this._showButtonText("visualizationSwitcherButton","BTN_VISUALIZATION")};g.prototype._onSizeChanged=function(t,e){if(t){var i=t.name;this.sMode=i;switch(i){case g.modes.MOBILE:this._switchToIcons();break;case g.modes.TABLET:case g.modes.DESKTOP:if(!e){this._switchToTexts()}break;default:}}};g.prototype.buildControls=function(){return e.load({name:"sap.ui.rta.toolbar.Adaptation",id:this.getId()+"_fragment",controller:{activate:this._openVersionTitleDialog.bind(this),discardDraft:this.eventHandler.bind(this,"DiscardDraft"),formatDiscardDraftVisible:this.formatDiscardDraftVisible.bind(this),formatPublishVersionVisibility:this.formatPublishVersionVisibility.bind(this),modeChange:this.eventHandler.bind(this,"ModeChange"),undo:this.eventHandler.bind(this,"Undo"),redo:this.eventHandler.bind(this,"Redo"),openChangeCategorySelectionPopover:this.eventHandler.bind(this,"OpenChangeCategorySelectionPopover"),saveAsAdaptation:A.bind(this),manageAdaptations:w.bind(this),publishVersion:this.eventHandler.bind(this,"PublishVersion"),save:this.eventHandler.bind(this,"Save"),exit:this.eventHandler.bind(this,"Exit"),formatVersionButtonText:this.formatVersionButtonText.bind(this),showVersionHistory:this.showVersionHistory.bind(this),showActionsMenu:this.showActionsMenu.bind(this)}})};function m(){var t={layer:this.getRtaInformation().flexSettings.layer,selector:this.getRtaInformation().rootControl};this.getExtension("translation",r).openDownloadTranslationDialog(t)}function v(){this.getExtension("translation",r).openUploadTranslationDialog()}function T(t,e){return t&&e!==n.Number.Draft}function y(){l.onSaveAs(true,true,this.getRtaInformation().flexSettings.layer,null)}function A(){this.getExtension("contextBasedSaveAs",s).openAddAdaptationDialog(this.getRtaInformation().flexSettings.layer)}function w(){this.getExtension("contextBasedManage",a).openManageAdaptationDialog()}function x(){return l.onGetOverview(true,this.getRtaInformation().flexSettings.layer)}function I(){return l.onGetOverview(false,this.getRtaInformation().flexSettings.layer)}function B(){l.onGetOverview(true,this.getRtaInformation().flexSettings.layer)}g.prototype.getControl=function(t){var e=sap.ui.getCore().byId(this.getId()+"_fragment--sapUiRta_"+t);if(!e&&this._oActionsMenuFragment){e=sap.ui.getCore().byId(this._oActionsMenuFragment.getId().replace("sapUiRta_actions","sapUiRta_")+t)}return e};return g});
//# sourceMappingURL=Adaptation.js.map