{"version":3,"file":"HitTester.js","names":["sap","ui","define","Log","three","HitTester","this","_maskMaterial","THREE","MeshBasicMaterial","side","DoubleSide","fog","_depthMaterial","ShaderMaterial","vertexShader","join","fragmentShader","clipping","_renderTarget","WebGLRenderTarget","minFilter","NearestFilter","magFilter","texture","generateMipmaps","depthBuffer","testCamera","matViewProj","Matrix4","frustum","Frustum","inverseMatrix","screenPos","Vector2","raycaster","Raycaster","ray","Ray","sphere","Sphere","objects","data","Uint8Array","point","Vector3","getMeshNode","object","parent","userData","closed","skipIt","prototype","hitTest","x","y","width","height","renderer","scene","camera","clippingPlanes","options","constructor","copy","view","w","h","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","updateMatrixWorld","updateProjectionMatrix","multiplyMatrices","projectionMatrix","matrixWorldInverse","setFromProjectionMatrix","setFromCamera","set","gl","getContext","rBits","Math","min","getParameter","RED_BITS","gBits","GREEN_BITS","bBits","BLUE_BITS","rgBits","rMask","gMask","bMask","rMaskInv","gMaskInv","bMaskInv","maskMaterial","oldClearColor","Color","getClearColor","oldClearAlpha","getClearAlpha","oldAutoClear","autoClear","setRenderTarget","setClearColor","clear","color","index","length","underlayObjects","ignoreUnderlay","regularObjects","overlayObjects","ignoreOverlay","traverseVisible","node","renderStage","visible","selectable","geometry","material","intersectsObject","matrixWorld","boundingSphere","computeBoundingSphere","applyMatrix4","intersectsSphere","invert","boundingBox","intersectsBox","push","children","i","l","renderObject","setRGB","render","forEach","clearDepth","readRenderTargetPixels","z","projectionMatrixInverse","distance","origin","distanceTo","hitTestPrecise","pi","plane","dist","distanceToPoint","t","normal","dot","direction","near","max","far","intersects","intersectObjects","Infinity","result","isBillboard","isDetailView","hitTestPoint"],"sources":["HitTester-dbg.js"],"mappings":"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"}