//@ui5-bundle sap/insights/library-preload.js
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 * This extension is for OVP Analytical cards delivered in 2208.
 */
sap.ui.predefine("sap/insights/CardExtension", ["sap/ui/integration/Extension","sap/ui/core/format/NumberFormat","sap/fe/navigation/SelectionVariant","sap/base/Log","sap/ui/core/format/DateFormat","sap/ui/core/ValueState","sap/m/ValueColor","sap/ui/integration/util/Utils","sap/m/DynamicDateUtil","sap/ui/core/Core","sap/fe/navigation/NavError","sap/insights/utils/UrlGenerateHelper"],function(e,t,r,a,i,n,s,o,f,l,c,u){"use strict";var m={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var p=a.getLogger("sap.insights.CardExtension");var v=function(e,t){return e&&e.indexOf(t,e.length-t.length)!==-1};var g=function(e,t){var r;if(t){r=t.None;if(e&&e.EnumMember){var a=e.EnumMember;if(v(a,"Negative")){r=t.Negative}else if(v(a,"Critical")){r=t.Critical}else if(v(a,"Positive")){r=t.Positive}}}return r};var d=function(e,t,r,a,i,n,s){var o={};o.EnumMember="None";var f=Number.NEGATIVE_INFINITY;var l=Number.POSITIVE_INFINITY;if(!i&&i!==0&&(r||r===0)){i=r}if(!n&&n!==0&&(a||a===0)){n=a}if(!r&&r!==0){r=f}if(!a&&a!==0){a=l}if(e!==undefined){e=Number(e);if(v(t,"Minimize")||v(t,"Minimizing")){if((n||n===0)&&(a||a===0)){if(e<=parseFloat(n)){o.EnumMember="Positive"}else if(e>parseFloat(a)){o.EnumMember="Negative"}else{o.EnumMember="Critical"}}}else if(v(t,"Maximize")||v(t,"Maximizing")){if((i||i===0)&&(r||r===0)){if(e>=parseFloat(i)){o.EnumMember="Positive"}else if(e<parseFloat(r)){o.EnumMember="Negative"}else{o.EnumMember="Critical"}}}else if(v(t,"Target")){if((n||n===0)&&(a||a===0)&&(i||i===0)&&(r||r===0)){if(e>=parseFloat(i)&&e<=parseFloat(n)){o.EnumMember="Positive"}else if(e<parseFloat(r)||e>parseFloat(a)){o.EnumMember="Negative"}else{o.EnumMember="Critical"}}}}return g(o,s)};var b=function(e,t,r,a){if(!e||!t){return}e=Number(e);if(!a&&e-t>=0){return"Up"}if(!r&&e-t<=0){return"Down"}if(t&&a&&e-t>=a){return"Up"}if(t&&r&&e-t<=r){return"Down"}};var h=function(e,r,a){var i=r||{},n=e;var s=t.getFloatInstance({minFractionDigits:i.NumberOfFractionalDigits,maxFractionDigits:i.NumberOfFractionalDigits,style:"short",showScale:true,shortRefNumber:n});var o=s.format(Number(n)),f=s.getScale()||"";if(!a&&o){var l=o[o.length-1];return l===f?o.slice(0,o.length-1):o}if(a&&i.percentageAvailable){return f+"%"}if(a&&!i.percentageAvailable){return f}return""};var N=function(){var e=this.getCard().getCombinedParameters();return e._headerDataUrl};var S=function(){var e=this.getCard().getCombinedParameters();return e._contentDataUrl};var D=function(e,r,a){var i,n,s;if(isNaN(+e)){return""}if(e==0){s=r}else{s=e}if(a.NumberOfFractionalDigits){n=+a.NumberOfFractionalDigits}if(r){i=r}else if(a.manifestTarget){i=a.manifestTarget}if(!n||n<0){n=0}else if(n>2){n=2}if(i){var o=t.getFloatInstance({minFractionDigits:n,maxFractionDigits:n,style:"short",showScale:true,shortRefNumber:s});return o.format(+i)}};var P=function(e,r,a){var i,n;if(isNaN(+e)){return""}e=+e;if(a.NumberOfFractionalDigits){i=+a.NumberOfFractionalDigits}if(r){n=+r}else if(a.manifestTarget){n=+a.manifestTarget}if(!i||i<0){i=0}else if(i>2){i=2}if(n){var s=(e-n)/n;var o=t.getPercentInstance({style:"short",minFractionDigits:i,maxFractionDigits:i,showScale:true});return o.format(s)}};var O=function(e){var t={};t.EnumMember="None";if(Number(e)===1){t.EnumMember="Negative"}else if(Number(e)===2){t.EnumMember="Critical"}else if(Number(e)===3){t.EnumMember="Positive"}return g(t,m.ColorValues)};var y=function(){var e=arguments[arguments.length-1];var t=1;return d(arguments[0],e.sImprovementDirection,e.bIsDeviationLowBinding?arguments[t++]:e.deviationLow,e.bIsDeviationHighBinding?arguments[t++]:e.deviationHigh,e.bIsToleranceLowBinding?arguments[t++]:e.toleranceLow,e.bIsToleranceHighBinding?arguments[t++]:e.toleranceHigh,e.oCriticalityConfigValues)};var C=function(){var e=arguments[arguments.length-1];var t=1;return b(arguments[0],e.bIsRefValBinding?arguments[t++]:e.referenceValue,e.bIsDownDiffBinding?arguments[t++]:e.downDifference,e.bIsUpDiffBinding?arguments[t++]:e.upDifference)};var I=function(e){var t;var r=arguments[arguments.length-1],a=r&&r.propertyType;switch(a){case"yearmonth":var i=parseInt(e.substr(0,4),10),n=e.substr(4),s=parseInt(n,10)-1;t=new Date(Date.UTC(i,s));break;case"yearquarter":var i=parseInt(e.substr(0,4),10),o=e.substr(4),f=parseInt(o,10)*3-2,s=f-1;t=new Date(Date.UTC(i,s));break;case"yearweek":var i=parseInt(e.substr(0,4),10),l=e.substr(4),c=1+(parseInt(l,10)-1)*7;t=new Date(Date.UTC(i,0,c));break;default:break}return t};var w=function(e,t){if(e){var r=o.parseJsonDateTime(e);return i.getInstance(t).format(new Date(r),t.bUTC)}};var E=function(e){if(e){var r=t.getIntegerInstance({minFractionDigits:0,maxFractionDigits:1,decimalSeparator:".",style:"short"});return r.format(Number(e))}};var F=function(e,r,a,i){var n;if(e){e.maxFractionDigits=e.numberOfFractionalDigits||0;e.minFractionDigits=e.numberOfFractionalDigits||0;e.style=e.style||"short";e.showScale=e.showScale||true;e.shortRefNumber=e.scaleFactor;n=t.getFloatInstance(e)}var s=[];if(!isNaN(parseFloat(a))&&n){s.push(n.format(a))}else{s.push(a)}if(!isNaN(parseFloat(i))&&n){s.push(n.format(i))}else{s.push(i)}var o="";if(r&&r.length){r.forEach(function(e){if(typeof e==="number"){o=o+s[e]}else{o=o+e}})}return o};var V=function(e,t){if(t==="state"){switch(String(e)){case"1":case"Error":return n.Error;case"2":case"Warning":return n.Warning;case"3":case"Success":return n.Success;default:return n.None}}if(t==="color"){switch(String(e)){case"1":case"Error":return s.Error;case"2":case"Critical":return s.Critical;case"3":case"Good":return s.Good;default:return s.Neutral}}};var M=function(e,t){var r=this.getCard().getModel().getProperty("/content/d/results")||this.getCard().getModel().getProperty("/d/results")||[];var a=r.map(function(t){return t[e]});if(a.indexOf("0")===-1){a.push(0)}return Math[t].apply(Math,a)};var T=function(e,t,r){var a=1;var i=2;var n=4;for(var s in e){if(e.hasOwnProperty(s)){var o=e[s];if(o instanceof Date){o=o.toJSON()}else if(Array.isArray(o)||o&&typeof o==="object"){o=JSON.stringify(o)}else if(typeof o==="number"||typeof o==="boolean"){o=o.toString()}if(o===""){if(r&a){p.info("Semantic attribute "+s+" is an empty string and due to the chosen Suppression Behiavour is being ignored.");continue}}if(o===null){if(r&i){throw new p.error("NavigationHandler.INVALID_INPUT")}else{p.warning("Semantic attribute "+s+" is null and ignored for mix in to selection variant");continue}}if(o===undefined){if(r&n){throw new p.error("NavigationHandler.INVALID_INPUT")}else{p.warning("Semantic attribute "+s+" is undefined and ignored for mix in to selection variant");continue}}if(typeof o==="string"||o instanceof String){t.addSelectOption(s,"I","EQ",o)}else{throw new p.error("NavigationHandler.INVALID_INPUT")}}}return t};var x=function(e,t,a){var i=new r(t);var n=new r;if(i.getFilterContextUrl()){n.setFilterContextUrl(i.getFilterContextUrl())}if(i.getParameterContextUrl()){n.setParameterContextUrl(i.getParameterContextUrl())}if(Array.isArray(e)){e.forEach(function(e){T(e,n,a)})}else{T(e,n,a)}var s=i.getParameterNames();var o;for(o=0;o<s.length;o++){if(!n.getSelectOption(s[o])){n.addSelectOption(s[o],"I","EQ",i.getParameter(s[o]))}}var f=i.getSelectOptionsPropertyNames();for(o=0;o<f.length;o++){var l=i.getSelectOption(f[o]);if(!n.getSelectOption(f[o])){for(var c=0;c<l.length;c++){n.addSelectOption(f[o],l[c].Sign,l[c].Option,l[c].Low,l[c].High)}}}return n};function U(e){if(e){if(e.hasOwnProperty("SelectionVariantID")){delete e.SelectionVariantID}else if(e.hasOwnProperty("PresentationVariantID")){delete e.PresentationVariantID}delete e.Text;delete e.ODataFilterExpression;delete e.Version;delete e.FilterContextUrl;delete e.ParameterContextUrl;return e}return e}var H=function(e){try{if(JSON.parse(e)){return true}}catch(e){return false}};var L=function(e){var t=e&&e.length===1,r=e&&e[0];return t&&r["Option"]==="EQ"&&!r["High"]&&r["Low"]&&r["Sign"]==="I"};function A(e,t){var r=this.getCard().getManifestEntry("sap.card"),a=r&&r.configuration.parameters,i=new sap.fe.navigation.SelectionVariant,n=a._relevantODataFilters.value||[];e=e&&JSON.parse(e);var s=e&&e.sensitiveProps,o=r&&r.header.actions[0].parameters.ibnParams,f=r&&r.content.actions[0].parameters.ibnParams;n.forEach(function(e){var t=H(a[e].value);if(t&&!(s&&s[e])){var r=JSON.parse(a[e].value);var n=r.SelectOptions.Ranges;if(n&&n.length){var l=L(n);if(o[e]&&f[e]){if(l){o[e]=n[0].Low;f[e]=n[0].Low}else if(!l){delete f[e];delete o[e];i.massAddSelectOption(e,n)}}else{i.massAddSelectOption(e,n)}}}});if(t){var l=Object.keys(t)||[];for(var c=0;c<l.length;c++){if(s&&s[l[c]]||l[c]==="__metadata"){delete t[l[c]]}}var u=x(t,i&&i.toJSONObject());u=U(u.toJSONObject());e.selectionVariant=u}if(e&&e.sensitiveProps){delete e.sensitiveProps}return JSON.stringify(e)}var J=function(e){var t=i.getDateInstance({pattern:"''yyyy-MM-dd'T'HH:mm:ss.SSS'Z'''",calendarType:"Gregorian"});if(e){var r=t.format(e,true);return String(r).replace(/'/g,"")}};var _=function(e){var t=i.getDateInstance({pattern:"''yyyy-MM-dd'T'HH:mm:ss.SSS''",calendarType:"Gregorian"});var r=e instanceof Date?e:new Date(e);var a=t.format(r);return String(a).replace(/'/g,"")};var k=function(e,t,r){var a=[];if(e.operation==="DATE"&&e.value1){a=f.toDates({values:[e.value1],operator:e.operation})||[]}else{a=f.toDates({values:[],operator:e.operation})||[]}var i=a[0]&&a[0].oDate;var n=a[1]&&a[1].oDate;var s="",o="";if(e["sap:filter-restriction"]==="single-value"){if(e.type==="Edm.DateTime"&&i instanceof Date){s=_(i);if(s){t.massAddSelectOption(r,[{Sign:"I",Option:e.operator,Low:s,High:null}])}}else if(e.type==="Edm.String"){s=J(i);if(s){t.massAddSelectOption(r,[{Sign:"I",Option:e.operator,Low:s,High:null}])}}}else if(e["sap:filter-restriction"]==="interval"){if(e.type==="Edm.DateTime"){if(i instanceof Date){s=_(i)}if(n instanceof Date){o=_(n)}if(s&&o){t.massAddSelectOption(r,[{Sign:"I",Option:e.operator,Low:s,High:o}])}}else if(e.type==="Edm.String"){if(i instanceof Date){s=J(i)}if(n instanceof Date){o=J(n)}if(s&&o){t.massAddSelectOption(r,[{Sign:"I",Option:e.operator,Low:s,High:o}])}}}};function j(e){var t={};var a;if(typeof e==="string"){a=new r(e)}else if(typeof e==="object"){a=e}else{throw new c("NavigationHandler.INVALID_INPUT")}var i=a.getSelectOptionsPropertyNames();for(var n=0;n<i.length;n++){var s=a.getSelectOption(i[n]);if(s.length===1&&s[0].Sign==="I"&&s[0].Option==="EQ"){t[i[n]]=s[0].Low}}var o=a.getParameterNames();for(var n=0;n<o.length;n++){var f=a.getParameter(o[n]);t[o[n]]=f}return t}function B(e,t){var a=this.getCard().getManifestEntry("sap.card"),i=a&&a.configuration.parameters,n=new r,s=i._relevantODataFilters.value||[],o=i._mandatoryODataParameters.value||[],f=e&&JSON.parse(e)||{},l=f&&f.parameters,c=l&&l.ibnParams,u=c&&c.sensitiveProps,m=f&&f.sensitiveProps,p=i._semanticDateRangeSetting,v,g=[];if(p){v=JSON.parse(p.value);g=Object.keys(v)||[]}var d={};o.forEach(function(e){var t=H(i[e].value);if(t&&(u&&!u[e]||m&&!m.includes(e))){var r=JSON.parse(i[e].value);if(r&&r.operation){k(r,n,e)}}});i._relevantODataParameters.value.forEach(function(e){if(i[e].value&&!g.includes(e)){if(c){c[e]=i[e].value}else if(f&&f.ibnParams){f.ibnParams[e]=i[e].value}}});s.forEach(function(e){var t=H(i[e].value);if(t&&(u&&!u[e]||m&&!m.includes(e))){var r=JSON.parse(i[e].value);if(r&&r.operation){k(r,n,e)}else{var a=r.SelectOptions.Ranges||r.SelectOptions&&r.SelectOptions[0]&&r.SelectOptions[0].Ranges;if(a&&a.length){var s=L(a);if(s){if(c){c[e]=a[0].Low}else if(f&&f.ibnParams){f.ibnParams[e]=a[0].Low}}else{if(c&&c[e]&&!s){delete c[e]}n.massAddSelectOption(e,a)}}}}});var b=t||{};var h=Object.keys(b)||[];for(var N=0;N<h.length;N++){if(u&&u[h[N]]||m&&m.includes(h[N])||h[N]==="__metadata"){delete b[h[N]]}}var S=x(b,n&&n.toJSONObject());var D=j(S);S=U(S.toJSONObject());if(c&&c.presentationVariant){d["presentationVariant"]=c.presentationVariant}else if(f&&f.ibnParams&&f.ibnParams.presentationVariant){d["presentationVariant"]=f.ibnParams.presentationVariant}if(S.Parameters.length||S.SelectOptions.length){d["selectionVariant"]=S}if(l&&!l.ibnParams){l.ibnParams={}}if(d["selectionVariant"]||d["presentationVariant"]){if(l&&l.ibnParams){l.ibnParams["sap-xapp-state-data"]=JSON.stringify(d)}else if(f&&f.ibnParams){f.ibnParams["sap-xapp-state-data"]=JSON.stringify(d)}}if(c&&c.sensitiveProps){delete c.sensitiveProps}for(var P in D){if(l&&l.ibnParams){l.ibnParams[P]=D[P]}else if(f&&f.ibnParams){f.ibnParams[P]=D[P]}}if(c){delete c.selectionVariant;delete c.presentationVariant}if(f&&f.ibnParams&&f.ibnParams.presentationVariant){delete f.ibnParams.presentationVariant}return f.parameters?f.parameters:f}function R(){var e={descriptorContent:{}};e.descriptorContent=this.getCard().getManifestEntry("/");var t=q(e,"header");return t}function G(){var e={descriptorContent:{}};e.descriptorContent=this.getCard().getManifestEntry("/");var t=e.descriptorContent["sap.card"]["configuration"]["csrfTokens"]["token1"].data.request.url;var r=q(e,"content");if(e.descriptorContent["sap.card"]["data"]["request"]&&e.descriptorContent["sap.card"]["data"]["request"]["batch"]){return r}return t+"/"+r}function q(e,t){var r=u.processPrivateParams(e,null,true);if(t==="header"&&r.header){return r.header}else if(t==="content"&&r.content){return r.content}}return e.extend("sap.insights.CardExtension",{init:function(){e.prototype.init.apply(this,arguments);this.setFormatters({kpiformatter:h,formatHeaderUrl:N.bind(this),formatContentUrl:S.bind(this),returnPercentageChange:P,targetValueFormatter:D,kpiValueCriticality:O,formatValueColor:y,formatTrendIcon:C,formatDateValue:I,addPropertyValueToAppState:A.bind(this),getNavigationContext:B.bind(this),formatDate:w,formatNumber:F,formatHeaderCount:E,formatCriticality:V,getMinMax:M.bind(this),formatHeaderDataUrlForSemanticDate:R.bind(this),formatContentDataUrlForSemanticDate:G.bind(this)})},loadDependencies:function(){var e=this.getCard(),t=e.getManifestEntry("/sap.card/type");if(t!=="Analytical"){return Promise.resolve()}return l.loadLibrary("sap.viz",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/insights/OVPChartFormatter"],function(t){t.registerCustomFormatters();e()})})})}})});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/CardHelper", ["sap/base/Log","sap/ui/model/json/JSONModel","sap/ui/core/Core"],function(e,r,t){"use strict";var a="/sap/opu/odata4/ui2/insights_srv/srvd/ui2/";var i=a+"insights_cards_repo_srv/0001/";var n="INSIGHTS_CARDS";var s=a+"insights_cards_read_srv/0001/"+n;var o="POST";var d="PUT";var c=e.getLogger("sap.insights.CardHelper");var u=sap.ui.getCore().getLibraryResourceBundle("sap.insights");var p="sap.insights.preview.Preview",l="sap.insights.selection.Selection",h="sap.insights.selection.SelectionDialog",f="sap.insights.copy.Copy";function g(e){return i+n+"('"+e+"')"}function C(){return fetch(i,{method:"HEAD",headers:{"X-CSRF-Token":"Fetch"}}).then(function(e){var r=e.headers.get("X-CSRF-Token");if(e.ok&&r){return r}L(u.getText("tokenFetchError"))})}function v(e,r,t){if([d,o].indexOf(t)===-1){L("Method not supported.")}var a=e["sap.app"].id;var s=t===d?g(a):i+n;e={descriptorContent:JSON.stringify(e),id:a};var c=JSON.stringify(e);return fetch(s,{method:t,headers:{"X-CSRF-Token":r,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"},body:c}).then(function(e){return e.json()}).then(function(e){if(e.error){L(e.error.message)}return JSON.parse(e.descriptorContent)})}function m(e,r){var t=i+n+"/com.sap.gateway.srvd.ui2.insights_cards_repo_srv.v0001.setRank?";var a=JSON.stringify({changedCards:JSON.stringify(e)});return fetch(t,{method:o,headers:{"X-CSRF-Token":r,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"},body:a}).then(function(e){return e.json()}).then(function(e){if(e.error){L(e.error.message)}e.value.forEach(function(e){if(e.descriptorContent){e.descriptorContent=JSON.parse(e.descriptorContent)}});return e.value})}function y(e){var r=e.split(".");if(r[0]!=="user"){L("sap.app.id value should start with user.<id>.")}}function b(e,r){return fetch(g(e),{method:"DELETE",headers:{"X-CSRF-Token":r}}).then(function(e){return e.ok?{}:e.json()}).then(function(r){if(r.error){L(r.error.message)}return e})}function S(){var e="sap.insights is not enabled for this system.";var r="ux.eng.s4producthomes1";try{var t=window["sap-ushell-config"];var a=t.apps.insights.enabled;var i=t.ushell.homeApp.component.name;var n=i===r;var s=t.ushell.spaces.myHome.enabled;var o=t.ushell.spaces.enabled;if(a&&s&&n&&o){return Promise.resolve(true)}return Promise.reject(new Error(e))}catch(r){return Promise.reject(new Error(e))}}function L(e){c.error(e);throw new Error(e)}function P(e){var r=false;if(e&&e.parameters&&e.parameters.ibnTarget&&e.parameters.ibnTarget.semanticObject&&e.parameters.ibnTarget.action){r=true}if(e&&e.ibnTarget&&e.ibnTarget.semanticObject&&e.ibnTarget.action){r=true}return r}function w(e){var r=false;if(!e["sap.app"]){c.error("Invalid card manifest. sap.app namespace do not exists.");r=true}if(!r&&!e["sap.app"].id){c.error("Invalid card manifest. sap.app.id do not exists.");r=true}if(!r){y(e["sap.app"].id,false)}if(!r&&!e["sap.app"].type){c.error("Invalid card manifest. sap.app.type do not exists.");r=true}if(!r&&e["sap.app"].type.toLowerCase()!=="card"){c.error("Invalid card manifest. invalid value for sap.app.type, expected card.");r=true}if(!r&&!e["sap.card"]){c.error("Invalid card manifest. sap.card namespace do not exists.");r=true}if(!r&&!e["sap.card"].type){c.error("Invalid card manifest. sap.card.type do not exists.");r=true}var t=["Analytical","List","Table"];if(!r&&t.indexOf(e["sap.card"].type)===-1){c.error("Invalid card manifest. Invalid value for sap.card.type. Supported types: "+t);r=true}if(!r&&!e["sap.insights"]){c.error("Invalid card manifest. sap.insights namespace do not exists.");r=true}if(!r&&!e["sap.insights"].parentAppId){c.error("Invalid card manifest. sap.insights.parentAppId do not exists.");r=true}if(!r&&!e["sap.insights"].cardType){c.error("Invalid card manifest. sap.insights.cardType do not exists.");r=true}if(!r&&e["sap.insights"].cardType!=="RT"){c.error("Invalid card manifest. Invalid value for sap.insights.cardType, supported value is RT");r=true}if(!r&&!e["sap.insights"].versions||!e["sap.insights"].versions.ui5){c.error("Invalid card manifest. Invalid value for sap.insights version");r=true}if(!r&&e["sap.insights"].templateName==="OVP"){var a,i,n,s=false,o=e["sap.card"].type;if(o==="Analytical"){a=e["sap.card"].content.actions||[];i=e["sap.card"].header.actions||[];a=a.filter(function(e){return e.type==="Navigation"&&e.parameters&&e.parameters.ibnTarget&&e.parameters.ibnTarget.semanticObject&&e.parameters.ibnTarget.action});i=i.filter(function(e){return e.type==="Navigation"&&e.parameters&&e.parameters.ibnTarget&&e.parameters.ibnTarget.semanticObject&&e.parameters.ibnTarget.action});if(a.length>0||i.length>0){s=true}if(e["sap.card"].configuration.parameters.state&&e["sap.card"].configuration.parameters.state.value){n=JSON.parse(e["sap.card"].configuration.parameters.state.value);s=P(n)}}if(o==="List"||o==="Table"){a=(o==="List"?e["sap.card"].content.item.actions:e["sap.card"].content.row.actions)||[];i=e["sap.card"].header.actions||[];a=a.filter(function(e){return e.type==="Navigation"});i=i.filter(function(e){return e.type==="Navigation"});if(a.length>0||i.length>0){var d={},p={};if(e["sap.card"].configuration.parameters.headerState&&e["sap.card"].configuration.parameters.headerState.value){d=JSON.parse(e["sap.card"].configuration.parameters.headerState.value)}if(e["sap.card"].configuration.parameters.lineItemState&&e["sap.card"].configuration.parameters.lineItemState.value){p=JSON.parse(e["sap.card"].configuration.parameters.lineItemState.value)}var l=P(d),h=P(p);s=l||h}}if(!s){c.error("Invalid card manifest. Card should have navigation.");r=true}}if(r){throw new Error(u.getText("invalidManifest"))}}var T={localCardCache:{},userCardModel:(new r).setDefaultBindingMode("OneWay"),suggestedCardModel:(new r).setDefaultBindingMode("OneWay"),parentAppDetailsCache:{},_mergeCard:function(e,r){try{w(e)}catch(e){return Promise.reject(e)}return C().then(function(t){return v(e,t,r)}).then(function(e){this.localCardCache={};this.suggestedCardModel.setProperty("/isLoading",false);return e}.bind(this))},createCard:function(e){this.suggestedCardModel.setProperty("/isLoading",true);return this._mergeCard(e,o)},updateCard:function(e){this.suggestedCardModel.setProperty("/isLoading",true);return this._mergeCard(e,d)},deleteCard:function(e){try{y(e)}catch(e){return Promise.reject(e)}this.suggestedCardModel.setProperty("/isLoading",true);return C().then(function(r){return b(e,r)}).then(function(e){this.localCardCache={};this.suggestedCardModel.setProperty("/isLoading",false);return e}.bind(this))},getUserCards:function(){if(this.localCardCache.userCards){return Promise.resolve(this.localCardCache.userCards)}var e=s+"?$orderby=rank";return this._readCard(e).then(function(e){this.localCardCache.userCards=e;return e}.bind(this))},getUserCardModel:function(){return this.getUserCards().then(function(e){var r=e.filter(function(e){return e.visibility});this.userCardModel.setProperty("/cards",e);this.userCardModel.setProperty("/cardCount",e.length);this.userCardModel.setProperty("/visibleCardCount",r.length);return this.userCardModel}.bind(this))},getSuggestedCards:function(){if(this.localCardCache.suggestedCards){return Promise.resolve(this.localCardCache.suggestedCards)}var e=s+"?$filter=visibility eq true&$select=descriptorUrl,visibility,rank&$orderby=rank&$skip=0&$top=10";return this._readCard(e).then(function(e){this.localCardCache.suggestedCards=e;return e}.bind(this))},getSuggestedCardModel:function(){return this.getSuggestedCards().then(function(e){this.suggestedCardModel.setProperty("/cards",e);this.suggestedCardModel.setProperty("/cardCount",e.length);this.suggestedCardModel.setProperty("/isLoading",false);return this.suggestedCardModel}.bind(this))},_readCard:function(e){return fetch(e).then(function(e){if(e.ok){return e.json()}L("Cannot read user's suggested cards.")}).then(function(e){e.value.forEach(function(e){if(e.descriptorContent){e.descriptorContent=JSON.parse(e.descriptorContent)}});return e.value})},setCardsRanking:function(e){this.suggestedCardModel.setProperty("/isLoading",true);return C().then(function(r){return m(e,r)}).then(function(e){this.localCardCache={};this.suggestedCardModel.setProperty("/isLoading",false);return e}.bind(this))},_refreshUserCards:function(e){this.suggestedCardModel.setProperty("/isLoading",true);var r=e?{deleteAllCards:"X"}:{};return new Promise(function(e){fetch(i,{method:"HEAD",headers:{"X-CSRF-Token":"Fetch"}}).then(function(t){var a=t.headers.get("X-CSRF-Token");fetch(i+n+"/com.sap.gateway.srvd.ui2.insights_cards_repo_srv.v0001.deleteCards?",{method:"POST",headers:{"X-CSRF-Token":a,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"},body:JSON.stringify(r)}).then(function(){this.localCardCache={};this.suggestedCardModel.setProperty("/isLoading",false);e()}.bind(this))}.bind(this))}.bind(this))},getParentAppDetails:function(e){if(this.parentAppDetailsCache[e.descriptorContent["sap.app"].id]){return Promise.resolve(this.parentAppDetailsCache[e.descriptorContent["sap.app"].id])}var r={};return sap.ushell.Container.getServiceAsync("ClientSideTargetResolution").then(function(t){var a=t._oAdapter._aInbounds||[];var i=a.find(function(r){return r.resolutionResult&&r.resolutionResult.applicationDependencies&&r.resolutionResult.applicationDependencies.name===e.descriptorContent["sap.insights"].parentAppId});if(i){r.semanticObject=i.semanticObject;r.action=i.action;r.semanticURL="#"+i.semanticObject+"-"+i.action;r.title=e.descriptorContent["sap.app"].title;this.parentAppDetailsCache[e.descriptorContent["sap.app"].id]=r}return r}.bind(this))}};var _={_oViewCache:{},_getLoadLibraryPromise:function(e){var r;switch(e){case p:r=Promise.all([t.loadLibrary("sap.m"),t.loadLibrary("sap.ui.integration"),t.loadLibrary("sap.viz")]);break;case l:case h:r=Promise.all([t.loadLibrary("sap.m"),t.loadLibrary("sap.ui.core"),t.loadLibrary("sap.f"),t.loadLibrary("sap.ui.integration"),t.loadLibrary("sap.ui.layout"),t.loadLibrary("sap.viz")]);break;case f:r=Promise.all([t.loadLibrary("sap.m"),t.loadLibrary("sap.ui.core"),t.loadLibrary("sap.f"),t.loadLibrary("sap.ui.integration"),t.loadLibrary("sap.ui.layout")]);break;default:break}return r},_getXMLView:function(e){return new Promise(function(r,t){if(this._oViewCache[e]){return r(this._oViewCache[e])}return this._getLoadLibraryPromise(e).then(function(){return sap.ui.core.mvc.XMLView.create({viewName:e}).then(function(t){this._oViewCache[e]=t;return r(this._oViewCache[e])}.bind(this))}.bind(this))}.bind(this))},showCardPreview:function(e,r){return this._getXMLView(p).then(function(t){return t.getController().showPreview(e,r)})},_showCardSelectionDialog:function(e){return this._getXMLView(h).then(function(r){return r.getController().showSelectionDialog(e)})}};return{getServiceAsync:function(e){return S().then(function(){if(e==="UIService"){return _}return T}).catch(function(e){return Promise.reject(e)})}}});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/OVPChartFormatter", ["sap/viz/library","sap/viz/ui5/format/ChartFormatter","sap/viz/ui5/api/env/Format","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat"],function(t,e,r,a,n){"use strict";var i=10;var o=[{prefix:"CURR",fn:f},{prefix:"axisFormatter",fn:c},{prefix:"0.0%",fn:u}];var s=["YearMonthDay","YearMonth","MMM","YearQuarter","Quarter","YearWeek","Week"];function f(t,e){var r;if(t===-1){r=a.getCurrencyInstance({style:"short",currencyCode:false})}else{r=a.getCurrencyInstance({style:"short",currencyCode:false,minFractionDigits:t,maxFractionDigits:t})}return r.format(Number(e))}function c(t,e){var r;if(t===-1){r=a.getFloatInstance({style:"short"})}else{r=a.getFloatInstance({style:"short",minFractionDigits:t,maxFractionDigits:t?t:1})}return r.format(Number(e))}function u(t,e){var r;if(t===-1){r=a.getPercentInstance({style:"short",minFractionDigits:1,maxFractionDigits:1})}else{r=a.getPercentInstance({style:"short",minFractionDigits:t,maxFractionDigits:t})}return r.format(Number(e))}function m(t,e){if(e.constructor===Date){var r=n.getDateTimeInstance({pattern:t});if(t==="YearMonthDay"){r=n.getDateInstance({style:"medium"})}if(t==="YearMonth"||t==="MMM"){r=n.getDateTimeInstance({format:"MMM"})}if(t==="YearQuarter"||t==="Quarter"){r=n.getDateTimeInstance({format:"QQQ"})}if(t==="YearWeek"||t==="Week"){r=n.getDateTimeInstance({format:"www"})}e=r.format(new Date(e),true)}return e}return{registerCustomFormatters:function(){var t=e.getInstance();var a=[];o.forEach(function(t){a.push({name:t.prefix,fn:t.fn.bind(null,2)});for(var e=-1;e<=i;e++){var r="/"+e+"/";a.push({name:t.prefix+r,fn:t.fn.bind(null,e)})}});s.forEach(function(t){a.push({name:t,fn:m.bind(null,t)})});a.forEach(function(e){t.registerCustomFormatter(e.name,e.fn)});r.numericFormatter(t)}}});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/base/Base.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","../utils/MetadataAnalyser","../utils/SelectionVariantHelper","sap/fe/navigation/SelectionVariant","sap/m/Token","../utils/oDataModelProvider","sap/ui/core/CustomData","sap/m/DynamicDateUtil","sap/ui/comp/util/DateTimeUtil","sap/ui/core/format/DateFormat","../utils/AppConstants","../utils/UrlGenerateHelper","sap/ui/core/IconPool","sap/base/util/deepClone"],function(e,t,a,r,i,n,o,s,l,d,g,u,c,p,f){"use strict";var h="smartForm";var v="copyCardSmartForm";return e.extend("sap.insights.base.BaseController",{constructor:function(){this._oParentViewModel=new t({oCard:{}});this.oSmartFormMap={};this.oDraftCardParams={};this.bEnableCardEdit=true},_createOdataModelsforDialog:function(e){var t=[];e.forEach(function(e){t.push(o.getOdataModel(e.descriptorContent["sap.app"].dataSources))});if(t.length){return Promise.all(t)}},setFilterTextForNoData:function(e,t,a){sap.ui.getCore().loadLibrary("sap.ui.comp",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/smartform/Group","sap/ui/comp/smartform/GroupElement","sap/ui/comp/smartform/Layout","sap/m/Text"],function(r,i,n,o){e.removeAllGroups();var s=new r;var l=new i;var d=new o({text:t?this.i18Bundle.getText("noFilterMsg"):this.i18Bundle.getText("noFilterLoaded"),textAlign:"Center"});l.addElement(d);s.addGroupElement(l);e.setLayout(new n);e.addGroup(s);if(a){e.getAggregation("content").getLayout().setBackgroundDesign("Transparent")}}.bind(this))}.bind(this))},_setSmartFormForCardEdit:function(e){this._oParentViewModel.setProperty("/oCard",e);var t=e.descriptorContent["sap.app"].id,a=this.oSmartFormMap[t]&&!this.smartFormEditable?Promise.resolve(this.oSmartFormMap[t]):this._createSmartFormForCardEdit(e,this.smartFormEditable);a.then(function(t){if(this.smartFormEditable){t.setEditable(true)}var a=this.byId(h)||this.byId(v);a.removeAllItems();var r=e.descriptorContent["sap.app"].dataSources;o.getOdataModel(r).then(function(e){var r=e&&e.loaded;var i=false;if(t.getGroups()&&t.getGroups().length&&t.getGroups()[0].getGroupElements()){i=t.getGroups()[0].getGroupElements().some(function(e){return e.getElements().some(function(e){return e.getVisible()})})}if(t.getAggregation("content").getFormContainers().length&&r&&i){t.setVisible(true);setTimeout(function(){var e=t.getAggregation("content").getLayout();if(e){e.setBackgroundDesign("Transparent")}a.addItem(t)},0)}else{this.setFilterTextForNoData(t,r,true);a.addItem(t)}}.bind(this))}.bind(this))},_createSmartFormForCardEdit:function(e){return new Promise(function(t){sap.ui.getCore().loadLibraries(["sap.ui.comp","sap.m"],{async:true}).then(function(){sap.ui.require(["sap/ui/comp/smartmultiinput/SmartMultiInput","sap/ui/comp/smartform/SmartForm","sap/ui/comp/smartform/Group","sap/ui/comp/smartform/GroupElement","sap/ui/comp/smartform/Layout","sap/m/Title","sap/m/Toolbar"],function(l,d,g,u,p,f,h){var v=e.descriptorContent;var m=v["sap.card"].configuration.parameters;var y=v["sap.insights"].filterEntitySet;var S=m&&m._entitySet.value;var C=v["sap.app"].dataSources;o.getOdataModel(C).then(function(o){var C=o&&o.loaded;this._oParentViewModel.setProperty("/oCard",e);var D={layout:new p({labelSpanS:6}),customToolbar:new h({content:[new f({text:this.i18Bundle.getText("filterBy"),titleStyle:"H5"})],style:"Clear"})};var T=new d(D);var b=new g;var E=[],P=[],I=[],_=[],F,O,V=[];if(m){E=m._mandatoryODataParameters.value||[];P=m._mandatoryODataFilters.value||[];I=m._relevantODataParameters.value||[];_=m._relevantODataFilters.value||[];O=m._semanticDateRangeSetting;if(O){F=JSON.parse(O.value);V=Object.keys(F)||[]}}T.attachEditToggled(function(e){var t=e.getParameters().editable;var a=e.getSource().getGroups()&&e.getSource().getGroups().length?e.getSource().getGroups()[0]:null;if(t&&a){a.getGroupElements().forEach(function(e){e.getFields().forEach(function(e){e.attachInnerControlsCreated(function(e){var t=e.getSource(),a=t.getBindingPath("value");if((E.includes(a)||P.includes(a))&&t.getProperty("editable")){t.setMandatory(true)}else if(t.getMandatory()){t.setMandatory(false)}t.checkClientError()})})})}});var k=function(e,t){if(t){var a=new s({key:"date",value:t});e.insertCustomData(a)}};var A=o&&a.getParameterisedEntitySetByEntitySet(o.oData,y);var x=A?a.getPropertyNamesOfEntitySet(o.oData,A):[];if(C){if(I.length){I.forEach(function(e){var t=A;var r=true;if(x.indexOf(e)===-1){t=S;r=false}var i=a.isValueListWithFixedValues(o.oData,t,e);var s=a.isDate(o.oData,t,e);var d=V.includes(e);var g=new u;var p=new l({entitySet:t,value:"{"+e+"}",editable:r,visible:r,singleTokenMode:true,supportRanges:false,innerControlsCreated:this._handleVisibilityChange.bind(this,d,true)});if(i){p.attachInnerControlsCreated(function(e){var t=e.getSource();if(t.getMode()==="edit"){var a=t.getInnerControls();if(Array.isArray(a)&&a.length){var r=t.getAggregation("_initialTokens");if(t.getSingleTokenMode()){var i=a[0],n=Array.isArray(r)&&r.length?r[0]:null;if(i.setForceSelection){i.setForceSelection(false);if(n){i.setSelectedKey(n.getKey())}else{i.setSelectedItem(null)}}}else{var o=a[0];if(Array.isArray(r)&&r.length){o.setSelectedKeys(r.map(function(e){return e.getKey()}))}}if(t.getMandatory()){t.checkClientError()}}}});p.checkClientError=function(){return this._checkClientError(p)}.bind(this);p.attachSelectionChange(this._handleParameterSelectionChange.bind(this))}else{if(d){p.addStyleClass("semanticDateInsight")}p.attachTokenUpdate(this._handleParameterTokenUpdate.bind(this,null,d))}var f=m[e].value;var h=m[e].label;if(f){var v=new n({key:f,text:h?h:f});if(s){if(!V.includes(e)){k(v,new Date(f))}else{if(F&&this.smartFormEditable){var y=this._getOptionsForDynamicDate(F,e);var C=this.byId("hiddenDDR");C.setOptions(y)}f=c.formatSemanticDateTime(f,"Parameter")[0];k(v,f)}}if(i&&p.getInnerControls().length){var D=p.getInnerControls()[0];D.setSelectedKey(v.getKey())}p.addAggregation("_initialTokens",v)}if(f&&p.getVisible()){g.addElement(p);b.addGroupElement(g)}else if(this.bEnableCardEdit&&p.getVisible()){g.addElement(p);b.addGroupElement(g)}this._attachInitialiseToGroupElement(g)}.bind(this))}var M=a.getPropertyNamesOfEntitySet(o.oData,y);_.forEach(function(e){var t=e;if(!(t==="DisplayCurrency"&&I.indexOf("P_DisplayCurrency")>-1)){var n=y;var s=true;if(M.indexOf(t)===-1){var d="P_"+t;if(x.indexOf(d)>-1){n=A;t=d}else{n=S;s=false}}var g=a.isValueListWithFixedValues(o.oData,n,t);var p=a.isDate(o.oData,n,t);var f=V.includes(t);var h=new u;var v;if(t.indexOf("P_")===0){v=true}else{v=a.getPropertyFilterRestrictionByEntitySet(o.oData,n,t)}var C=new l({entitySet:n,value:"{"+t+"}",editable:s,visible:s,supportRanges:!v,singleTokenMode:v,innerControlsCreated:this._handleVisibilityChange.bind(this,f,false)});if(g){C.attachInnerControlsCreated(function(e){var t=e.getSource();if(t.getMode()==="edit"){var a=t.getInnerControls();if(Array.isArray(a)&&a.length){var r=t.getAggregation("_initialTokens");if(t.getSingleTokenMode()){var i=a[0],n=Array.isArray(r)&&r.length?r[0]:null;if(i.setForceSelection){i.setForceSelection(false);if(n){i.setSelectedKey(n.getKey())}else{i.setSelectedItem(null)}}}else{var o=a[0];if(Array.isArray(r)&&r.length){o.setSelectedKeys(r.map(function(e){return e.getKey()}))}}if(t.getMandatory()){t.checkClientError()}}}});C.checkClientError=function(){return this._checkClientError(C)}.bind(this);C.attachSelectionChange(this._handleFilterSelectionChange.bind(this))}else{if(f){C.setSingleTokenMode(true);C.addStyleClass("semanticDateInsight")}C.attachTokenUpdate(this._handleFilterTokenUpdate.bind(this,null,f))}var D=new i(m[e].value);var T=D.getSelectOption(e);if(T&&T.length){var E=[],P=[];E=r.getTokenFromSelectOptions(T,e);E.forEach(function(t,a){if(p){if(!V.includes(e)){k(t,new Date(t.getKey()))}else{if(F&&this.smartFormEditable){var r=this._getOptionsForDynamicDate(F,e);var i=this.byId("hiddenFilterDDR");i.setOptions(r)}P=c.formatSemanticDateTime(null,T[a],"Filter");P=c.formatSemanticDateTime(T[a],"Filter");P.forEach(function(e){k(t,e)})}}if(g&&C.getInnerControls().length){var n=C.getInnerControls()[0];n.setSelectedKey(t.getKey())}C.addAggregation("_initialTokens",t)}.bind(this));h.addElement(C);b.addGroupElement(h)}else if(this.bEnableCardEdit){h.addElement(C);b.addGroupElement(h)}this._attachInitialiseToGroupElement(h)}}.bind(this))}if(b.getAggregation("formElements")&&b.getAggregation("formElements").length){T.addGroup(b)}var w=v["sap.app"].id;if(C){T.setModel(o.oData)}this.oSmartFormMap[w]=T;t(T)}.bind(this))}.bind(this))}.bind(this))}.bind(this))},_handleVisibilityChange:function(e,t,a){var r=a.getSource();var i=this.byId(h);var n=i&&i.getItems()[0];var o=false;if(e&&r.getMode()==="edit"){var s=t?this.byId("hiddenDDR"):this.byId("hiddenFilterDDR");s.setValue(null);var l=r.getBinding("value").sPath;var d=r.getInnerControls();if(d.length){var g=d[0];r.setShowValueHelp(false);r.setShowSuggestion(false);if(!sap.ui.getCore().byId(g.getId()+"-dynamicDateIcon")){g.addEndIcon({id:g.getId()+"-dynamicDateIcon",src:p.getIconURI("check-availability"),press:t?this._handleParameterTokenUpdate.bind(this,r,true):this._handleFilterTokenUpdate.bind(this,r,true)});g.attachLiveChange(function(){this.bValueApplied=true;g.setValue("");s.attachEventOnce("change",null,t?this._onSemanticParameterDateChange.bind(this,l,r):this._onSemanticFilterDateChange.bind(this,l,r),s);s.openBy(r.getDomRef())}.bind(this))}}}setTimeout(function(){if(n){var e=n.getGroups()&&n.getGroups().length?n.getGroups()[0]:null;var t=e&&e.getGroupElements();if(t&&t.length){t.forEach(function(t){var a=t.getFields();a.forEach(function(e){if(!this.smartFormEditable&&e.getId()===r.getId()&&(e.getTokens&&e.getTokens().length===0)){t.removeField(e)}if(t.getVisible()&&e.getTokens&&e.getTokens().length){o=true}}.bind(this));if(!t.getFields().length){e.removeGroupElement(t)}}.bind(this))}}if(!o&&i){i.removeAllItems();this.setFilterTextForNoData(n,true,false);i.addItem(n)}}.bind(this),0)},_handleFilterTokenUpdate:function(e,t,n){var o=e?e:n.getSource();if(o.getMandatory()){o.checkClientError()}var s=o.getBinding("value").sPath;var l=o.getTokens();var g=this._oParentViewModel.getProperty("/oCard");var c=g.descriptorContent["sap.app"].id;var p=o.getModel();var f=a.isDate(p,o.getEntitySet(),s);var h,v="",m,y={value:"",label:"",description:""};m=g.descriptorContent["sap.card"].configuration.parameters;if(t&&(!l.length||e)){h=this.byId("hiddenFilterDDR");h.attachEventOnce("change",null,this._onSemanticFilterDateChange.bind(this,s,o),h);this.bValueApplied=true;h.openBy(o.getDomRef());if(!l.length){y.value=r.getEmptySVStringforProperty(s)}else{v=h._parseValue(l[0].getKey());if(v){h.setValue(v)}else{y.description=h.getValue()?JSON.stringify(h.getValue()):"";if(!h.getValue()&&m[s]&&m[s].description){var S;y.description=m[s].description;y.value=m[s].value;S=JSON.parse(y.description);S.values.forEach(function(e,t){if(u.DATE_OPTIONS.DATE_LIST.includes(S.operator)){var a=new Date(e);if(e.match&&!(e.match(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3})Z$/gm)&&e.match(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3})Z$/gm).length)){S.values[t]=d.utcToLocal(a);if(!["DATETIMERANGE","FROMDATETIME","TODATETIME","DATETIME"].includes(S.operator)){S.values[t]=d.normalizeDate(S.values[t],true)}}else{S.values[t]=a}}});h.setValue(S)}else{h.setValue(h.getValue())}}}}else if(l.length){var C=new i;var D=[];var T="";l.forEach(function(e){T="";if(e.data("selectOption")){var t=e.data("selectOption");if(!t.Text){t.Text=e.getText?e.getText():null}D.push(t)}else if(e.data("range")){var a=e.data("range");var i=r.getSelectOptionFromRange(a,e.getText());D.push(i)}else if(f){var n=p.formatValue(e.getKey(),"Edm.DateTime");C.addSelectOption(s,"I","EQ",n,null,n)}else if(o._parseValue){var l=o._parseValue(e.getKey());T=e.getText()?e.getText():e.getKey();C.addSelectOption(s,"I","EQ",l,null,T)}else{T=e.getText()?e.getText():e.getKey();C.addSelectOption(s,"I","EQ",e.getKey(),null,T)}});C.massAddSelectOption(s,D);y.value=C.toJSONString()}else{y.value=r.getEmptySVStringforProperty(s)}this.oDraftCardParams[c][s]=y.value?y:this.oDraftCardParams[c][s]},getLabelForField:function(e,t,a,r){if(e&&t){var i=r==="Parameter"?this.byId("hiddenDDR"):this.byId("hiddenFilterDDR");var n=i.getIdForLabel()||"";n=n.substring(0,n.lastIndexOf("-"));if(n){var o=sap.ui.getCore().byId(n);return o&&o.getValue()}else if(i&&i.getProperty("value")){return i.getProperty("value")}else if(a&&typeof a.getTokens==="function"){var s=a.getTokens()||[],l=s.map(function(e){return e.getText()});return{type:"filters",value:l}}}},_handleFilterSelectionChange:function(e){var t=e.getParameters();var a=e.getSource().getBinding("value").getPath();var o=this._oParentViewModel.getProperty("/oCard");var s=o.descriptorContent["sap.app"].id;var l=e.getSource();var d=new i;var g="",u={value:"",label:"",description:""};if(t.selectedItem){l.setValueState("None");var c=e.getParameter("selectedItem");if(c){g=c.getText()?c.getText():c.getKey();l.removeAllAggregation("_initialTokens");l.addAggregation("_initialTokens",new n({key:c.getKey(),text:g}));d.addSelectOption(a,"I","EQ",c.getKey(),null,g);u.value=d.toJSONString()}else{u.value=r.getEmptySVStringforProperty(a)}}else{var p=e.getSource().getInnerControls()[0].getSelectedItems();if(p.length){l.setValueState("None");l.removeAllAggregation("_initialTokens");p.forEach(function(e){g=e.getText()?e.getText():e.getKey();l.addAggregation("_initialTokens",new n({key:e.getKey(),text:g}));d.addSelectOption(a,"I","EQ",e.getKey(),null,g)});u.value=d.toJSONString()}else{u.value=r.getEmptySVStringforProperty(a)}}this.oDraftCardParams[s][a]=u},_handleParameterSelectionChange:function(e){var t=e.getParameter("selectedItem");var a=e.getSource(),r="";var i={value:"",label:"",description:""};if(t){a.setValueState("None");r=t.getText()?t.getText():t.getKey();i.value=t.getKey();i.label=r}a.removeAllAggregation("_initialTokens");a.addAggregation("_initialTokens",new n({key:i.value,text:i.label}));var o=e.getSource().getBinding("value").getPath();var s=this._oParentViewModel.getProperty("/oCard").descriptorContent["sap.app"].id;this.oDraftCardParams[s][o]=i},_handleParameterTokenUpdate:function(e,t,r){var i=e?e:r.getSource();if(i.getMandatory()){i.checkClientError()}var n=i.getBinding("value").sPath;var o=i.getTokens();var s=this._oParentViewModel.getProperty("/oCard").descriptorContent["sap.app"].id;var l={value:"",label:"",description:""};var d=i.getModel();var g=a.isDate(d,i.getEntitySet(),n);var p,f;if(t&&(!o.length||e)){f=this.byId("hiddenDDR");f.attachChange(this._onSemanticParameterDateChange.bind(this,n,i));f.openBy(i.getDomRef())}if(o.length){l.label=o[0].getText()?o[0].getText():o[0].getKey();if(t&&!f){f=this.byId("hiddenDDR")}if(f&&f._parseValue){p=f._parseValue(o[0].getKey());if(p){f.setValue(p);l.value=c.getDateRangeValue(p,true);l.description=JSON.stringify(p);var h=this.getLabelForField(n,p,e,"Parameter");var v="";var m=p.operator==="DATE";if(h&&typeof h==="string"){v=h.substring(0,h.indexOf("(")-1);if(!v&&m){v=h}}l.label=v?v:p.operator}else{l.value=o[0].getKey();if(Date.parse(l.value)){l.value=new Date(l.value)}l.description=f.getValue()?JSON.stringify(f.getValue()):"";var y=this._oParentViewModel.getProperty("/oCard").descriptorContent["sap.card"].configuration.parameters;if(!f.getValue()&&y[n]&&y[n].description){var S;l.description=y[n].description;S=JSON.parse(l.description);if(u.DATE_OPTIONS.DATE_LIST.includes(S.operator)){S.values[0]=new Date(S.values[0]);l.value=typeof o[0].getKey()==="string"?new Date(o[0].getKey()):o[0].getKey()}f.setValue(S)}else{f.setValue(f.getValue())}}}else{p=i._parseValue&&i._parseValue(o[0].getKey());if(g&&p){p=i.getModel().formatValue(p,i.getDataType());l.value=p}else if(p){l.value=p}else{p=o[0].getKey();l.value=p}}}this.oDraftCardParams[s][n]=l},_mergeDraftParamsIncard:function(e){var t=e.descriptorContent["sap.card"].configuration.parameters;var a=e.descriptorContent["sap.app"].id;var r=this.oDraftCardParams[a];Object.keys(r).forEach(function(e){if(r[e]){if(t[e]){if(t[e].type==="datetime"&&typeof t[e].value==="string"&&t[e].value.includes("operation")){var a=JSON.parse(t[e].value);a.operation=r[e];t[e].value=JSON.stringify(a)}else{t[e].value=r[e].value?r[e].value:r[e];if(r[e].label){t[e].label=r[e].label}t[e].description=r[e].description}}else if(e.indexOf("P_")===0&&t[e.replace("P_","")]){r[e.replace("P_","")]=r[e].replace("P_","");t[e.replace("P_","")].value=r[e].replace("P_","");delete r[e]}}});c.processPrivateParams(e,r);Object.keys(t).forEach(function(e){var a=t[e].value;if(t[e].type==="datetime"&&typeof a==="string"&&a.includes("datetime")){a=a.split("datetime");a=a[a.length-1];a=a.replace(/["']/g,"");t[e].value=a}});return e},_checkClientError:function(e){var t=e.getSingleTokenMode()?!e.getInnerControls()[0].getSelectedKey():!e.getInnerControls()[0].getSelectedKeys().length,a=e.getMandatory()&&t;e.setValueState(a?"Error":"None");return a},_attachInitialiseToGroupElement:function(e){if(e.getFields()&&e.getFields().length){e.getFields()[0].attachInitialise(function(){if(e.getFields().length&&e.getLabelControl()&&!e.getLabelControl().getText()){var t=e.getFields()[0].getBindingPath("value");if(t&&e.getFields()[0].getVisible()){e.getFields()[0].setTextLabel(t)}}})}},_onSemanticParameterDateChange:function(e,t,a){var r=a.getParameter("value");var i=this._oParentViewModel.getProperty("/oCard");var o=i.descriptorContent["sap.app"].id;var s=this.getLabelForField(e,r,t,"Parameter");var l="";var d=r.operator==="DATE";if(s&&typeof s==="string"){l=s.substring(0,s.indexOf("(")-1);if(!l&&d){l=s}}if(!this.oDraftCardParams[o][e]){this.oDraftCardParams[o][e]={}}this.oDraftCardParams[o][e].value=d?r.values[0]:r.operator;this.oDraftCardParams[o][e].label=d?r.values[0]:r.operator;this.oDraftCardParams[o][e].description=JSON.stringify(r);t.getInnerControls()[0].setTokens([]);if(l){this.oDraftCardParams[o][e].label=l}var g=new n({key:this.oDraftCardParams[o][e].value,text:this.oDraftCardParams[o][e].label});t.getInnerControls()[0].setTokens([g]);var u=a.getParameter("valid");t.setValueState(u?"None":"Error")},_onSemanticFilterDateChange:function(e,t,a){if(this.bValueApplied){var n=a.getParameter("value");var o=this.getLabelForField(e,n,t,"Filter");var s=f(n);var l=c.getDateRangeValue(s,false,o);var d=this._oParentViewModel.getProperty("/oCard");var g=d.descriptorContent["sap.app"].id;var u=new i;if(!l.High){l.High=""}if(!this.oDraftCardParams[g][e]){this.oDraftCardParams[g][e]={}}u.addSelectOption(e,"I",l.Option,l.Low,l.High,l.Text);this.oDraftCardParams[g][e].value=u.toJSONString();this.oDraftCardParams[g][e].description=JSON.stringify(s);t.getInnerControls()[0].setTokens([]);var p=r.getTokenFromSelectOptions(u.getSelectOption(e),e);t.getInnerControls()[0].setTokens(p);var h=a.getParameter("valid");t.setValueState(h?"None":"Error");this.bValueApplied=false}},_getOptionsForDynamicDate:function(e,t){var a;if(e[t]["sap:filter-restriction"]==="single-value"){a=u.DATE_OPTIONS.SINGLE_OPTIONS}else if(e[t]["sap:filter-restriction"]==="interval"){a=u.DATE_OPTIONS.RANGE_OPTIONS;a=a.concat(u.DATE_OPTIONS.SINGLE_OPTIONS)}if(e&&e[t].exclude){a=a.filter(function(a){return!e[t].selectedValues.includes(a)})}return a}})});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/copy/Copy.controller", ["sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","../base/Base.controller","../CardHelper","sap/m/MessageToast","sap/base/Log"],function(e,t,r,a,i,o){"use strict";var s=o.getLogger("sap.insights.CardHelper");return r.extend("sap.insights.copy.Copy",{onInit:function(){this._oCopyCardViewModel=new e({oOrgCard:{},oCard:{},aCards:[]});this.getView().setModel(this._oCopyCardViewModel,"copyCardView");var r=sap.ui.getCore().getLibraryResourceBundle("sap.insights");this.getView().setModel(new t({bundle:r}),"i18n");this.i18Bundle=this.getView().getModel("i18n").getResourceBundle();this.smartFormEditable=true},_getCopyCardPage:function(){return this.getView().byId("copyCardPage")},initCopyCard:function(e){var t=e.descriptorContent["sap.app"].id;if(this.oDraftCardParams){this.oDraftCardParams[t]={}}a.getServiceAsync().then(function(e){return e.getUserCards().then(function(e){this._oCopyCardViewModel.setProperty("/aCards",e)}.bind(this))}.bind(this));var r=e;this._oCopyCardViewModel.setProperty("/oOrgCard",r);var i=JSON.parse(JSON.stringify(r));this._oCopyCardViewModel.setProperty("/oCard",i);var o=this._oCopyCardViewModel.createBindingContext("/oCard");this.byId("copyCardPreview").refresh();this.getView().byId("copyCardPage").setBindingContext(o,"copyCardView");this.getView().byId("CopyCardsEditTitleField").setValueState("None");this._setSmartFormForCopyCard(e)},handleCopyCardDialogCancel:function(){this.byId("CopyCardsEditTitleField").setValueState("None");this.isCopyCardDialogOpen=false;this._getCopyCardPage().close()},_setSmartFormForCopyCard:function(e){this.byId("copyCardSmartForm").removeAllItems();this._setSmartFormForCardEdit(e)},_handleCardPreviewPress:function(e){if(this._oCopyCardViewModel.getProperty("/oCard").descriptorContent["sap.card"].header.title){var t=this._mergeDraftParamsIncard(this._oCopyCardViewModel.getProperty("/oCard"));this._oCopyCardViewModel.setProperty("/oCard",t);this._oCopyCardViewModel.refresh();this.byId("copyCardPreview").refresh()}},handleCardsInputChange:function(e){var t=e.getSource(),r=t.getValue(),a=t.getId();if(a&&a.includes("CopyCardsEditTitleField")){if(!r){t.setValueState("Error")}else{t.setValueState("None")}this._oCopyCardViewModel.getProperty("/oCard").descriptorContent["sap.card"].header.title=r}else if(a&&a.includes("CopyCardsEditSubTitleField")){this._oCopyCardViewModel.getProperty("/oCard").descriptorContent["sap.card"].header.subTitle=r}},handleCardCopyPress:function(){var e=this.byId("copyCardSmartForm"),t=e&&e.getItems()[0];if(t&&!t.getSmartFields().some(function(e){return e.checkClientError({handleSuccess:true})})){if(this._oCopyCardViewModel.getProperty("/oCard").descriptorContent["sap.card"].header.title){this._getCopyCardPage().setBusy(true);var r=this._oCopyCardViewModel.getProperty("/oOrgCard");var o=r.descriptorContent["sap.app"].id;var d=this._oCopyCardViewModel.getProperty("/oCard");var n=o+"."+Date.now();var C=this._oCopyCardViewModel.getProperty("/aCards")||[];if(C&&C.length){var p=C.reduce(function(e,t){return e.rank>t.rank?e:t});d.descriptorContent["sap.insights"].rank=p.rank+1;d.rank=p.rank+1}this.oDraftCardParams[n]={};d=this._mergeDraftParamsIncard(d);d.descriptorContent["sap.app"].id=n;var l=C.filter(function(e){return e.visibility});d.descriptorContent["sap.insights"].visible=l.length<10?true:false;d.visibility=l.length<10?true:false;d.descriptorContent["sap.insights"].parentAppId=r.descriptorContent["sap.insights"].parentAppId;d.descriptorContent["sap.insights"].isDtCardCopy=false;d.descriptorContent["sap.ui5"].componentName=n;a.getServiceAsync().then(function(e){e.createCard(d.descriptorContent).then(function(){var t=r.descriptorContent["sap.card"].header.title;var a=this.i18Bundle.getText("copyCardSuccessMsg",t);i.show(a);e.getUserCardModel();var o=this.getView().getParent().getPages()[0];this.getView().getParent().to(o)}.bind(this)).catch(function(e){i.show(e.message)}).finally(function(){this._getCopyCardPage().setBusy(false)}.bind(this))}.bind(this))}}else{s.error(this.i18Bundle.getText("cardCopyErrorMsg"))}},onNavBack:function(){this.getView().getParent().back()}})});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/library", ["sap/ui/core/Core","sap/ui/core/library"],function(){"use strict";var e=sap.ui.getCore().initLibrary({name:"sap.insights",dependencies:["sap.ui.core"],types:[],interfaces:[],controls:[],elements:[],version:"1.111.0",extensions:{}});return e});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/preview/Preview.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/m/MessageToast","../CardHelper"],function(e,t,i,r,s){return e.extend("sap.insights.preview.Preview",{onInit:function(){this.getView().setModel(new t({descriptor:{}}),"cardPreviewModel");this.I18_BUNDLE=sap.ui.getCore().getLibraryResourceBundle("sap.insights");this.getView().setModel(new i({bundle:this.I18_BUNDLE}),"i18n")},save:function(){var e=this.getView().getModel("cardPreviewModel").getProperty("/descriptor");if(e["sap.card"].header.title){e["sap.insights"].visible=true;this._getPreviewDialog().setBusy(true);s.getServiceAsync().then(function(t){t.createCard(e).then(function(e){r.show("Card created Successfully.");this._getPreviewDialog().setBusy(false);this._getPreviewDialog().close()}.bind(this)).catch(function(e){r.show(e.message);this._getPreviewDialog().setBusy(false)}.bind(this))}.bind(this))}else{var t=this.getView().byId("titleTextInput");t.focus()}},cancel:function(){this._getPreviewDialog().close()},handleTitleChange:function(e){var t=e.getSource();var i=t.getValue();var r=this.getView().byId("insightsCard");if(i){t.setValueState("None");t.setValueStateText("");r.getCardHeader().setTitle(i)}else{t.setValueState("Error");t.setValueStateText(this.I18_BUNDLE.getText("INT_Preview_Title_ValueStateText"))}},handleSubTitleChange:function(e){var t=e.getSource();var i=t.getValue();var r=this.getView().byId("insightsCard");r.getCardHeader().setSubtitle(i)},handleVisibilityChange:function(e){var t=this.getView().getModel("cardPreviewModel");var i=e.getParameter("state");var r=t.getProperty("/descriptor");r["sap.insights"].visible=i;t.setProperty("/descriptor",r)},showCardSelectionDialog:function(){this._getPreviewDialog().close();var e=this.getView().getModel("cardPreviewModel");var t=e.getProperty("/descriptor");s.getServiceAsync("UIService").then(function(e){e._showCardSelectionDialog(t)})},_getPreviewDialog:function(){return this.getView().byId("previewDialog")},_onCardManifestApplied:function(e){var t=e.getSource();t.attachEvent("_error",this._onCardLoadFailure.bind(this,t));t.attachEvent("stateChanged",this._onCardStateChanged.bind(this,t))},_onCardLoadFailure:function(e,t){if(t&&t.getParameters()&&t.getParameters().message){this.bCardError=true}},_onCardStateChanged:function(e){var t=this.getView().getModel("cardPreviewModel");if(e.isReady()&&!this.bCardError){t.setProperty("/bAddButton",true)}else{t.setProperty("/bAddButton",false)}},showPreview:function(e,t){var i=this.getView().getModel("cardPreviewModel");return s.getServiceAsync().then(function(r){return r.getUserCards().then(function(r){var s=r.filter(function(e){return e.visibility});if(s.length>9){e["sap.insights"].visible=false}i.setProperty("/descriptor",e);if(!t){i.setProperty("/bAddButton",false)}this.bCardError=false;this._getPreviewDialog().open();return Promise.resolve()}.bind(this))}.bind(this))}})});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/selection/Selection.controller", ["sap/ui/model/resource/ResourceModel","../CardHelper","sap/m/MessageBox","sap/m/MessageToast","../base/Base.controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/base/util/UriParameters","sap/m/FormattedText","sap/m/Link"],function(e,t,i,r,s,n,a,o,d,l){var c=500;return s.extend("sap.insights.selection.Selection",{onInit:function(){var t=sap.ui.getCore().getLibraryResourceBundle("sap.insights");this.getView().setModel(new e({bundle:t}),"i18n");this.i18Bundle=this.getView().getModel("i18n").getResourceBundle();this.oNavCon=this.getView().byId("selectionNavCon");this.oNavCon.setBusy(true);this.bHasRankingProperty=false;this.initUserCards()},showSelectionDialog:function(e){this.orgCard=e;this.getView().getModel("view").setProperty("/selectionDialogOpen",true);this._getSelectionDialog().open()},_getSelectionDialog:function(){return this.getView().byId("insightsSelectionDialog")},_getSelectionFragment:function(){return this.getView().byId("flexContainerCardsContent")},_getCardListPage:function(){return this.getView().byId("insightCardPage")},_getPreviewPage:function(){return this.getView().byId("previewPage")},closeDialog:function(){t.getServiceAsync("UIService").then(function(e){this.oNavCon.to(this._getCardListPage());this.getView().getModel("view").setProperty("/selectionDialogOpen",false);this._getSelectionDialog().close();e.showCardPreview(this.orgCard,true)}.bind(this))},handleCardListItemPress:function(e,t){var i=this.getView().getModel("view");if(e){this.currentCardPreviewPath=e.getSource().getBindingContextPath()}else if(t){this.currentCardPreviewPath=t.getBindingContextPath()}var r=i.getProperty(this.currentCardPreviewPath).descriptorContent["sap.card"].header.title;i.setProperty("/selectedCardTitle",r);var s=this.getView().byId("previewPage");this.oNavCon.to(s);var n=i.createBindingContext(this.currentCardPreviewPath);this.byId("previewCard").setBindingContext(n,"view");this.byId("insightsPreviewOverflowLayer").setBindingContext(n,"view");var a=this.byId("smartForm");a.removeAllItems();this._setSmartFormForCardEdit(i.getProperty(this.currentCardPreviewPath));this.oCardHelperServiceInstance.getParentAppDetails(i.getProperty(this.currentCardPreviewPath)).then(function(e){i.setProperty("/parentAppTitle",e.title);i.setProperty("/parentAppUrl",e.semanticURL);i.setProperty("/parentAppsectionVisible",this.getIsNavigationEnabled(e))}.bind(this))},setCopyVisible:function(e){var t=this.getView().getModel("view");t.setProperty("/showCopyButton",false);if(e){var i=e["sap.app"].dataSources;var r=i.filterService;var s=r&&r.uri;var n=r&&r.settings;if(s&&n&&n.odataVersion==="2.0"){t.setProperty("/showCopyButton",true)}}},handleCardVisibilityToggle:function(e){this._getSelectionFragment().setBusy(true);var t=e.getSource();var i=t.getBindingContext("view").getPath();var s=this.getView().getModel("view").getProperty(i);var n=t.getSelected();s.visibility=n;s.descriptorContent["sap.insights"].visible=n;this.setSelectedCards();this.oCardHelperServiceInstance.updateCard(s.descriptorContent).then(function(){this._getSelectionFragment().setBusy(false)}.bind(this)).catch(function(e){s.visibility=!n;s.descriptorContent["sap.insights"].visible=!n;this.getView().getModel("view").refresh();this._getSelectionFragment().setBusy(false);r.show(e.message)}.bind(this))},setSelectedCards:function(){var e=this.byId("insightsCardsListTable");if(e){this.getView().getModel("view").setProperty("/visibleCardCount",this.getSelectedCards().length)}},onEditInsightCardsDrop:function(e){if(this.bHasRankingProperty){r.show(this.i18Bundle.getText("cardDnDUnavailable"));return}var t=e.getParameter("draggedControl"),i=t.getParent().indexOfItem(t),s=e.getParameter("droppedControl"),n=t.getParent().indexOfItem(s);if(i!==n){var a=this._setCardsRanking(i,n);try{this._getSelectionFragment().setBusy(true);this.oCardHelperServiceInstance.setCardsRanking(a).then(function(e){var t=this.getView().getModel("view");t.setProperty("/cards",e);t.setProperty("/cardCount",e.length);this._createOdataModelsforDialog(e);this.setDTCards()}.bind(this)).finally(function(){this._getSelectionFragment().setBusy(false)}.bind(this))}catch(e){this._getSelectionFragment().setBusy(false)}}},handleCardDeleteConfirm:function(){i.show(this.i18Bundle.getText("deleteCardMsg"),{icon:i.Icon.WARNING,title:this.i18Bundle.getText("delete"),actions:[i.Action.DELETE,i.Action.CANCEL],emphasizedAction:i.Action.DELETE,onClose:function(e){if(e===i.Action.DELETE){this.handleCardDelete(this.currentCardPreviewPath)}}.bind(this)})},handleCardDelete:function(e){var t=this.getView().getModel("view");this._getPreviewPage().setBusy(true);var i=t.getProperty(e);var s=i.descriptorContent["sap.app"].id;var n=i.descriptorContent["sap.card"].header.title;this.oCardHelperServiceInstance.deleteCard(s).then(function(){this._getPreviewPage().setBusy(false);r.show(this.i18Bundle.getText("deleteCardSuccess",n));var e=t.getProperty("/cards").filter(function(e){return e.descriptorContent["sap.app"].id!==s});var i=e.filter(function(e){return e.visibility});t.setProperty("/cards",e);t.setProperty("/cardCount",e.length);t.setProperty("/visibleCardCount",i.length);this.setDTCards();this.oNavCon.back();this.setSelectedCards()}.bind(this)).catch(function(e){this._getPreviewPage().setBusy(false);r.show(e.message)}.bind(this))},getSelectedCards:function(){var e=this.getView().getModel("view").getProperty("/cards");e=e.filter(function(e){return e.visibility});return e},initUserCards:function(){return t.getServiceAsync().then(function(e){this.oCardHelperServiceInstance=e;return this.oCardHelperServiceInstance.getUserCardModel().then(function(e){this.getView().setModel(e,"view");var t=this.getView().getModel("view").getProperty("/cards");var i=0;t.forEach(function(e){if(e.visibility){if(++i>10){e.visibility=false}}if(e.rank===0){e.rank=500}if(e.descriptorContent["sap.insights"].ranking){this.bHasRankingProperty=true}}.bind(this));var r=this.getView().getModel("view");r.setProperty("/selectionDialogOpen",false);r.setProperty("/cards",t);this.oSmartFormMap={};this._createOdataModelsforDialog(t);this.setDTCards();var s=this.isDeleteAllCardsEnabled();r.setProperty("/deleteAllEnabled",s);this.oNavCon.setBusy(false);return Promise.resolve()}.bind(this))}.bind(this))},_setCardsRanking:function(e,t){var i=this.byId("insightsCardsListTable").getItems().map(function(e){return e.getBindingContext("view").getObject()}),r=[];var s=function(e){var t=i[e].rank;if(t!==c){r.push({id:i[e+1].descriptorContent["sap.app"].id,rank:t+1})}else{r.push({id:i[e+1].descriptorContent["sap.app"].id,rank:null});if(e){s(e-1)}else{r.push({id:i[e].descriptorContent["sap.app"].id,rank:null})}}};var n=function(){r.forEach(function(e,t){if(t===0){if(!e.rank){r[t].rank=1}}else{e.rank=r[t-1].rank+1}})};var a=i[t].rank;if(a!==c){if(e<t){r.push({id:i[e].descriptorContent["sap.app"].id,rank:a+1})}else{r.push({id:i[e].descriptorContent["sap.app"].id,rank:a})}}else{if(t===0){r.push({id:i[e].descriptorContent["sap.app"].id,rank:1})}else{var o=i.splice(e,1);i.splice(t,0,o[0]);s(t-1);r.reverse();n();r.reverse()}}return{Ranking:r}},onNavBack:function(){this.oNavCon.back()},navigateToCopyCard:function(){var e=this.getView().byId("insightsCopyCardView");var t=this.getView().getModel("view").getProperty(this.currentCardPreviewPath);this.oNavCon.to(e);e.getController().initCopyCard(t)},onCardSearch:function(e){var t=e.getSource().getValue();var i=new n("descriptorContent/sap.card/header/title",a.Contains,t);var r=[];r.push(i);var s=this.byId("insightsCardsListTable");var o=s.getBinding("items");o.filter(r,"Application")},refreshCardList:function(){var e=this.isDeleteAllCardsEnabled(),t;if(e){t=this.i18Bundle.getText("deleteAllCardsMsg")}else{var r=this.getView().getModel("view").getProperty("/DTCards");var s="<p>"+this.i18Bundle.getText("refreshAllCards")+"</p>";s+="<ul>";r.forEach(function(e){s+='<li class="sapUiTinyMarginBottom">'+e.descriptorContent["sap.card"].header.title+"</li>"});s+="</ul>";t=new d({htmlText:s})}i.show(t,{icon:i.Icon.WARNING,title:this.i18Bundle.getText("refresh"),actions:[i.Action.OK,i.Action.CANCEL],emphasizedAction:i.Action.OK,onClose:function(t){if(t===i.Action.OK){this.oNavCon.setBusy(true);this.oCardHelperServiceInstance._refreshUserCards(e).then(function(){this.initUserCards()}.bind(this))}}.bind(this)})},isDeleteAllCardsEnabled:function(){var e=o.fromQuery(window.location.search).get("delete-all-cards")||"";return e.toUpperCase()==="TRUE"?true:false},navigateToParentApp:function(){var e=this.getView().getModel("view");var t=e.getProperty("/parentAppUrl");sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(e){e.toExternal({target:{shellHash:t}});this.oNavCon.back()}.bind(this))},navigateToCardPreview:function(e){var t=this.getView().getModel("view");var i=t.getProperty("/cards");var r=i.findIndex(function(t){return t.descriptorContent["sap.app"].id===e});if(r!==-1){var s=this.getView().byId("insightsCardsListTable").getItems();this.handleCardListItemPress(null,s[r])}},getIsNavigationEnabled:function(e){return sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(t){return t.isNavigationSupported([{target:{semanticObject:e.semanticObject,action:e.action}}])}).then(function(e){return e[0].supported||false})},setDTCards:function(){var e=this.getView().getModel("view");var t=e.getProperty("/cards");var i=t.filter(function(e){return e.descriptorContent["sap.insights"].isDtCardCopy});e.setProperty("/DTCards",i)}})});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/utils/AppConstants", [],function(){"use strict";return{DATE_OPTIONS:{SINGLE_OPTIONS:["DATE","YESTERDAY","TOMORROW","TODAY","FIRSTDAYWEEK","LASTDAYWEEK","FIRSTDAYMONTH","LASTDAYMONTH","FIRSTDAYQUARTER","LASTDAYQUARTER","FIRSTDAYYEAR","LASTDAYYEAR"],RANGE_OPTIONS:["THISWEEK","LASTWEEK","NEXTWEEK","THISMONTH","LASTMONTH","NEXTMONTH","THISQUARTER","LASTQUARTER","NEXTQUARTER","QUARTER1","QUARTER2","QUARTER3","QUARTER4","THISYEAR","LASTYEAR","NEXTYEAR","YEARTODATE","DATETOYEAR","DATERANGE","DATETIMERANGE","FROM","FROMDATETIME","LASTDAYS","LASTMONTHS","LASTQUARTERS","LASTWEEKS","LASTYEARS","NEXTDAYS","NEXTMONTHS","NEXTQUARTERS","NEXTWEEKS","NEXTYEARS","SPECIFICMONTH","TO","TODATETIME","TODAYFROMTO"],DATE_LIST:["DATE","DATERANGE","DATETIME","DATETIMERANGE","FROM","TO","FROMDATETIME","TODATETIME"],SPECIAL_RANGE:["LASTDAYS","LASTMONTHS","LASTQUARTERS","LASTWEEKS","LASTYEARS","NEXTDAYS","NEXTMONTHS","NEXTQUARTERS","NEXTWEEKS","NEXTYEARS","TODAYFROMTO"]}}});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/utils/MetadataAnalyser", [],function(){"use strict";return{getPropertyNamesOfEntitySet:function(t,e){if(!t||!t.getMetaModel){return[]}var a=t.getMetaModel();var r=a.getODataEntitySet(e);var n=[];if(r){var i=a.getODataEntityType(r.entityType);i.property.forEach(function(t){n.push(t.name)})}return n},getParameterisedEntitySetByEntitySet:function(t,e){if(!t||!t.getMetaModel){return}var a=t.getMetaModel();var r=a.getODataEntitySet(e);if(r){var n=a.getODataEntityType(r.entityType);var i=n.navigationProperty;if(!i){return}var o=i.filter(function(t){var e=a.getODataAssociationEnd(n,t.name);var r=a.getODataEntityType(e.type);return r["sap:semantics"]==="parameters"&&r.key});if(o&&o.length){return a.getODataAssociationSetEnd(n,o[0].name).entitySet}}return},getPropertyFilterRestrictionByEntitySet:function(t,e,a){if(!t||!t.getMetaModel){return false}var r=t.getMetaModel();var n=r.getODataEntitySet(e);if(n){var i=r.getODataEntityType(n.entityType);var o;o=i.property.find(function(t){return t.name===a});if(o&&o["sap:filter-restriction"]&&o["sap:filter-restriction"]==="single-value"){return true}}return false},isDate:function(t,e,a){if(!t||!t.getMetaModel){return false}var r=t.getMetaModel(),n=r.getODataEntitySet(e);if(!n){return false}var i=r.getODataEntityType(n.entityType),o=i.property.find(function(t){return t.name===a});return o&&o.type==="Edm.DateTime"},isValueListWithFixedValues:function(t,e,a){if(!t||!t.getMetaModel){return false}var r=t.getMetaModel(),n=r.getODataEntitySet(e),i,o;if(n){var u=r.getODataEntityType(n.entityType),y=u.property.find(function(t){return t.name===a}),f="com.sap.vocabularies.Common.v1.ValueList",s="com.sap.vocabularies.Common.v1.ValueListWithFixedValues",l=y&&y[f],p=y&&y[s],g=y&&y["sap:value-list"];i=l&&g==="fixed-values";o=!!p&&p.Bool==="true"}return i||o||false}}});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/utils/SelectionVariantHelper", ["sap/base/security/encodeURL","sap/m/Token","sap/ui/core/CustomData"],function(e,a,r){"use strict";var t=function(e){return"("+e+")"};var n=function(e,a,r){var t="or";var n=a;if(r==="E"){t="and"}if(e===""){return n}return[e,t,n].join(" ")};var o=function(e,a){if(a==="number"){return e+"m"}if(!(a==="integer"||a==="boolean"||a==="datetime")){return"'"+e+"'"}return e};var i=function(e,a,r,i){var u="";a.forEach(function(a){var s;switch(a.Option){case"BT":s=t([e,"ge",o(a.Low,i),"and",e,"le",o(a.High,i)].join(" "));break;case"CP":s="substringof("+o(a.Low,i)+","+e+")";break;default:s=[e,a.Option.toLowerCase(),o(a.Low,i)].join(" ");break}u=n(u,s,r)});return u};var u=function(e,a,r){var n=[],o=[];a.forEach(function(e){if(e.Sign==="I"){if(e.Option==="NE"){o.push(e)}else{n.push(e)}}else{if(e.Option==="NE"){n.push(e)}else{o.push(e)}}});var u=i(e,n,"I",r);var s=[];if(u){s.push(t(u))}var c=i(e,o,"E",r);if(c){s.push(t(c))}return s.join(" and ")};var s=function(a,r){var t=[];a.getSelectOptionsPropertyNames().forEach(function(e){t.push(u(e,a.getSelectOption(e),r[e]))});return t.length?"$filter="+e(t.join(" and ")):null};var c=function(a,r){var n="";a.getParameterNames().forEach(function(e){if(n!==""){n+=","}n+=e+"=";var t=a.getParameter(e);n+=o(t,r[e])});return n===""?null:t(e(n))};var f=function(e){var a=e.Option;switch(e.Option){case"CP":var r=e.Low;var t=r.indexOf("*")===0;var n=r.indexOf("*",1)===r.length-1;if(t&&!n){a="StartsWith"}else if(!t&&n){a="EndsWith"}else if(t&&n){a="Contains"}break;case"EQ":if(e.Low===""){a="Empty"}break}return a};var v=function(e,a){return new r({key:"range",value:{exclude:e.Sign==="E",keyField:a,operation:f(e),value1:e.Option==="CP"?e.Low.replace(/\*/g,""):e.Low,value2:e.High}})};var l=function(e,n){var o=[];var i=0;e.forEach(function(e){var u="";var s="";switch(e.Option){case"BT":u+=e.Low+" .. "+e.High;s="range_"+i++;break;case"CP":u+=e.Low;s="range_"+i++;break;case"EQ":if(e.Low===""){u+="<EMPTY>";s="<EMPTY>"}else{u+=e.Text?e.Text:e.Low;s=e.Low}break;case"NE":u+="!"+e.Low;s="range_"+i++;break;case"GT":u+=">"+e.Low;s="range_"+i++;break;case"GE":u+=">="+e.Low;s="range_"+i++;break;case"LT":u+="<"+e.Low;s="range_"+i++;break;case"LE":u+="<="+e.Low;s="range_"+i++;break}if(e.Sign==="E"){u="!"+t(u)}var c=new a({key:s,text:e.Text?e.Text:u});if(s!==e.Low){c.addCustomData(v(e,n))}c.addCustomData(new r({key:"selectOption",value:e}));o.push(c)});return o};var w=function(){var e=new sap.fe.navigation.SelectionVariant;return e.toJSONString()};var p=function(e){switch(e.Option){case"BT":e.Text+=e.Low+" .. "+e.High;break;case"EQ":if(e.Low===""){e.Text+="<EMPTY>"}else{e.Text+=e.Low}break;case"NE":e.Text+="!"+e.Low;break;case"GT":e.Text+=">"+e.Low;break;case"GE":e.Text+=">="+e.Low;break;case"LT":e.Text+="<"+e.Low;break;case"LE":e.Text+="<="+e.Low;break;default:e.Text+=e.Low;break}return e.Text};var g=function(e,a){var r={Sign:e.exclude?"E":"I",Option:e.operation,Low:e.value1.toString(),High:e.value2?e.value2.toString():"",Text:a?a:""};switch(e.operation){case"Contains":r.Option="CP";if(e.value1){r.Low="*"+e.value1+"*"}break;case"StartsWith":r.Option="CP";if(e.value1){r.Low=e.value1+"*"}break;case"EndsWith":r.Option="CP";if(e.value1){r.Low="*"+e.value1}break;case"Empty":r.Option="EQ";r.Low="";break}if(!r.Text){r.Text=p(r)}return r};return{getFilterQueryFromSV:s,getParameterQueryFromSV:c,getTokenFromSelectOptions:l,getEmptySVStringforProperty:w,getSelectOptionFromRange:g}});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/utils/UrlGenerateHelper", ["../utils/SelectionVariantHelper","sap/fe/navigation/SelectionVariant","sap/m/DynamicDateUtil","sap/ui/comp/util/DateTimeUtil","sap/ui/core/format/DateFormat","../utils/AppConstants","sap/ui/model/odata/v2/ODataModel"],function(e,t,a,r,i,n,o){function l(a,r,i){var n=a.descriptorContent["sap.card"].configuration.parameters;var l=a.descriptorContent["sap.card"]["data"]["request"];var p=false,v={},m={};if(l&&l.batch){p=true;v=l.batch.header||{};m=l.batch.content||{}}var d=a&&n._headerDataUrl,T=a&&n._contentDataUrl;var E=new t;var D=n._relevantODataFilters.value;var g=n._relevantODataParameters.value;var h=n._semanticDateRangeSetting,S=[];if(h){h=JSON.parse(h.value);S=Object.keys(h)||[]}D.forEach(function(e){var a=new t(n[e].value);var r=a.getSelectOption(e);var i=[];if(r&&r.length){if(S.includes(e)){i=c(r[0],"Filter");if(i.length){r[0].Low=i[0];r[0].High=i[1]?i[1]:null;if(r[0].Low&&r[0].High&&r[0].Option!=="BT"){r[0].Option="BT"}E.massAddSelectOption(e,r)}else if(o&&o.prototype.formatValue&&r[0]){r[0].Low=o.prototype.formatValue(r[0].Low,"Edm.DateTime");if(r[0].High){r[0].High=o.prototype.formatValue(r[0].High,"Edm.DateTime")}E.massAddSelectOption(e,r)}}else{if(o&&o.prototype.formatValue&&r[0]&&n[e].type==="datetime"){r[0].Low=o.prototype.formatValue(r[0].Low,"Edm.DateTime");if(r[0].High){r[0].High=o.prototype.formatValue(r[0].High,"Edm.DateTime")}E.massAddSelectOption(e,r)}E.massAddSelectOption(e,r)}}});g.forEach(function(e){var t="";if(n[e].value&&typeof n[e].value==="string"){t=n[e].value.toString()}else if(n[e].value.value){t=n[e].value.value.toString()}else if(n[e].value&&n[e].value instanceof Date){t=n[e].value}if(n[e].type==="datetime"&&!S.includes(e)&&!t.includes("datetime")){if(o&&o.prototype.formatValue){t=o.prototype.formatValue(t,"Edm.DateTime");E.addParameter(e,t)}}else if(n[e].type==="datetime"&&S.includes(e)){t=typeof n[e].value==="string"&&Date.parse(n[e].value)?c(new Date(t),"Parameter"):c(t,"Parameter");E.addParameter(e,t[0])}else{E.addParameter(e,t)}});var y=n._entitySet.value;var A=y;if(g.length){var O={};g.forEach(function(e){O[e]=n[e].type});A+=e.getParameterQueryFromSV(E,O);var M=A;if(M&&Array.isArray(M.match(/%27datetime[a-zA-Z0-9%-:]*[,)%2c]/gm))&&M.match(/%27datetime[a-zA-Z0-9%-:]*[,)%2c]/gm).length){A=f(M)}}if(n._urlSuffix.value){A+=n._urlSuffix.value}var I={};D.forEach(function(e){I[e]=n[e].type});var H=e.getFilterQueryFromSV(E,I);var R=H;if(R&&Array.isArray(R.match(/%27datetime[a-zA-Z0-9%-:]*[,)%2c]/gm))&&R.match(/%27datetime[a-zA-Z0-9%-:]*[,)%2c]/gm).length){H=f(R)}var N="",L="",Q="",_="",F={header:"",content:""};if(p){N=s(n,"_header",H,a.descriptorContent["sap.card"].type);L=N?A+"?"+N:A;if(d&&d.value){var w=u(S,L);if(w){v.url="{= extension.formatters.formatHeaderDataUrlForSemanticDate() }";d.value=""}else{d.value=L;if(r){r._headerDataUrl=d.value}}}else if(d){F.header=L}}if(n._contentDataUrl){Q=s(n,"_content",H,a.descriptorContent["sap.card"].type);_=Q?A+"?"+Q:A;if(n._contentDataUrl.value){var x=u(S,_);if(x){if(p){m.url="{= extension.formatters.formatContentDataUrlForSemanticDate() }"}else{l.url="{= extension.formatters.formatContentDataUrlForSemanticDate() }"}T.value=""}else{T.value=_;if(r){r._contentDataUrl=T.value}}}else{F.content=_;return F}if(i){F.header=L;F.content=_;return F}}}function u(e,t){var a=e.length?e:[];if(a.length&&t){return a.some(function(e){return t&&t.indexOf(e)>-1})}}function s(e,t,a,r){var i=[];if(a){i.push(a)}if(e[t+"SelectQuery"]&&e[t+"SelectQuery"].value){i.push(e[t+"SelectQuery"].value)}if(e[t+"ExpandQuery"]&&e[t+"ExpandQuery"].value){i.push(e[t+"ExpandQuery"].value)}if(e[t+"SortQuery"]&&e[t+"SortQuery"].value){var n=e[t+"SortQuery"].value;i.push(decodeURI(n)===n?encodeURI(n):n)}if(r==="Table"||r==="List"){i.push("$inlinecount=allpages");i.push("$skip=0&$top=13")}else{if(e[t+"TopQuery"]&&e[t+"TopQuery"].value){i.push(e[t+"TopQuery"].value)}if(e[t+"SkipQuery"]&&e[t+"SkipQuery"].value){i.push(e[t+"SkipQuery"].value)}}return i.length?i.join("&"):null}function f(e){var t=e.match(/%27datetime[a-zA-Z0-9%-:]*[,)%2c]/gm).length;var a=function(){var t=e.match(/%27datetime[a-zA-Z0-9%-:]*[,)%2c]/gm)[0];var a=t;a=a.replace("%27","");var r=a.lastIndexOf("%27");var i=a.substr(0,r)+a.substr(r+3,a.length-1);return i};for(var r=0;r<t;r++){e=e.replace(e.match(/%27datetime[a-zA-Z0-9%-:]*[,)%2c]/gm)[0],a)}return e}function c(e,t){var r,i=[],o=[],l=false;if(t==="Parameter"){r=e}else if(t==="Filter"){e=typeof e==="string"?JSON.parse(e):e;r=e.Low;if(n.DATE_OPTIONS.SPECIAL_RANGE.includes(r)){i=e.High.split(",")}}var u;if(n.DATE_OPTIONS.RANGE_OPTIONS.includes(r)||n.DATE_OPTIONS.SINGLE_OPTIONS.includes(r)){if(t==="Filter"){u=a.toDates({values:i,operator:r});o.push(u[0].oDate);o.push(u[1].oDate)}else{u=a.toDates({values:i,operator:r});o.push(u[0].oDate)}}if(["DATETIMERANGE","FROMDATETIME","TODATETIME","DATETIME"].includes(r)){l=true}if(o.length){o=p(o,true,l);return o}else if(Date(e)instanceof Date||e instanceof Date||Date.parse(e)){return p([e],true,l)}return[]}function p(e,t,a){var n;e.forEach(function(o,l){if(o.match){if(o.match(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3})Z?$/gm)&&o.match(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3})Z?$/gm).length){o=new Date(o)}}o=r.localToUtc(o);if(!a){o=r.normalizeDate(o,true)}if(t){n=i.getDateInstance({pattern:"'datetime'''yyyy-MM-dd'T'HH:mm:ss''",calendarType:"Gregorian"});e[l]=n.format(o,true)}else{var u=i.getDateInstance({pattern:"''yyyy-MM-dd'T'HH:mm:ss.SSS''",calendarType:"Gregorian"});var s=o instanceof Date?o:new Date(o);var f=u.format(s);e[l]=String(f).replace(/'/g,"")}});return e}function v(e,t,r){var i=r;if(e&&t){var n=e.operator;if(n!=="DATE"){return n}else{return e.values[0]}}if(!t){var o=e.operator;var l=e.values;var u="";if(o){switch(o){case"DATE":case"DATERANGE":case"SPECIFICMONTH":case"DATETIMERANGE":case"DATETIME":u="";if(typeof i==="string"){u=i}var s=a.toDates(e);l=s;var f=p(l,false,o==="DATETIMERANGE"||o==="DATETIME");if(!f[1]){f[1]=""}var c={Low:f[0],High:f[1],Option:"BT",Text:u};if(c){c.Text=u;return c}break;case"FROM":case"TO":case"FROMDATETIME":case"TODATETIME":u="";if(typeof i==="string"){u=i}var v=p(l,false,o==="FROMDATETIME"||o==="TODATETIME"),m;m=o==="FROM"||o==="FROMDATETIME"?"GE":"LE";var d={Low:v[0],High:"",Option:m,Text:u};if(d){d.Text=u;return d}break;case"LASTDAYS":case"LASTWEEKS":case"LASTMONTHS":case"LASTQUARTERS":case"LASTYEARS":case"NEXTDAYS":case"NEXTWEEKS":case"NEXTMONTHS":case"NEXTQUARTERS":case"NEXTYEARS":u="";if(typeof i==="string"){u=i}return{Low:o,High:l[0].toString(),Option:"BT",Text:u};case"TODAYFROMTO":u="";if(typeof i==="string"){u=i}var T=l&&l[0];var E=l&&l[1];return{Low:o,High:T.toString()+","+E.toString(),Option:"BT",Text:u};default:u="";if(typeof i==="string"){u=i.substring(0,i.indexOf("(")-1)}return{Low:o,High:null,Option:"EQ",Text:u}}}}}return{processPrivateParams:l,formatSemanticDateTime:c,getDateRangeValue:v}});
/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.predefine("sap/insights/utils/oDataModelProvider", ["sap/ui/model/odata/v2/ODataModel"],function(e){var r={};function t(r){var t=r.filterService;var a=t&&t.uri;var n=t&&t.settings;var i=[];if(n){n.annotations.forEach(function(e){var t=r[e];var a=t.uri;i.push(a)});if(n.odataVersion==="2.0"){return new e(a,{annotationURI:i,loadAnnotationsJoined:true})}}}function a(e){var a=e.filterService.uri;var n=t(e);r[a]={oData:n,loaded:undefined};return new Promise(function(e){if(n){n.attachMetadataLoaded(function(t){return t.getSource().getMetaModel().loaded().then(function(){r[a].loaded=true;e(r[a])})});n.attachMetadataFailed(function(){r[a].loaded=false;e(r[a])})}else{e(r[a])}})}function n(e){if(e.filterService&&e.filterService.uri){var t=e.filterService.uri;if(r[t]){return Promise.resolve(r[t])}else{return a(e)}}else{return Promise.resolve(undefined)}}return{getOdataModel:n}});
sap.ui.require.preload({
	"sap/insights/copy/Copy.view.xml":'<mvc:View displayBlock="true" \n  controllerName="sap.insights.copy.Copy"\n  xmlns="sap.m"\n  xmlns:mvc="sap.ui.core.mvc"\n  xmlns:core="sap.ui.core"\n  xmlns:w="sap.ui.integration.widgets"\n  xmlns:f="sap.ui.layout.form"\n  xmlns:l="sap.ui.layout"><Page id="copyCardPage" backgroundDesign="List" enableScrolling="true" title="{i18n>copyCard}"><headerContent><VBox direction="Row"><Button\n                        class="sapUiTinyMarginEnd"\n                        type="Emphasized"\n                        text="{i18n>save}"\n                        press=".handleCardCopyPress"/><Button\n                        text="{i18n>cancelButton}"\n                        press=".onNavBack"/></VBox></headerContent><FlexBox id="CopyCardFlexWrapper" alignItems="Start" justifyContent="SpaceBetween" height="100%" direction="Column" class="sapUiTinyMarginBegin sapUiSmallMarginEnd"><Title id="CopyCardEditDetailsTitle" text="{i18n>editDetails}" titleStyle="H5" width="100%" class="sapUiSmallMarginTop sapUiSmallMarginBegin" /><f:SimpleForm id="CopyCardsEditDetailsForm" class="sapContrastPlus sapUiSmallMarginBegin" backgroundDesign="Transparent" width="100%" editable="true" layout="ColumnLayout"><f:content><Label id="CopyCardsEditTitleLabel" text="{i18n>title}" required="true" /><Input id="CopyCardsEditTitleField" value="{copyCardView>descriptorContent/sap.card/header/title}" change=".handleCardsInputChange" valueStateText="{i18n>emptyTitle}" /><Label id="CopyCardsEditSubTitleLabel" text="{i18n>subTitle}" /><Input id="CopyCardsEditSubTitleField" value="{copyCardView>descriptorContent/sap.card/header/subTitle}" change=".handleCardsInputChange"/></f:content></f:SimpleForm><FlexBox id="copyCardSmartForm" class="sapUiTinyMarginTop" justifyContent="Center" direction="Column" width="100%"/><DynamicDateRange id="hiddenDDR" hideInput="true"/><DynamicDateRange id="hiddenFilterDDR" hideInput="true"/><VBox id="CopyCardPreviewVBoxWrapper" class="sapUiMediumMarginTop" backgroundDesign="Transparent" height="100%" width="100%" ><HBox id="CopyCardPreviewHBox" alignItems="Center" justifyContent="SpaceBetween" width="100%"><Title id="CopyCardPreviewTitle" text="{i18n>preview}" titleStyle="H5" class="sapUiSmallMarginBegin" /><Button type="Transparent" id="CopyCardPreviewRefreshButton" text="{i18n>refresh}" press="_handleCardPreviewPress"/></HBox><VBox id="CopyCardsPreviewVBox" alignItems="Center" class="sapUiMediumMarginBottom"><w:Card id="copyCardPreview" manifest="{copyCardView>descriptorContent}" parameters="{copyCardView>params}" width="17rem" height="23.5rem"/><HBox id="insightsCopyOverflowLayer" class="sapMFlexBoxJustifyCenter" height="0" visible="{= ${copyCardView>descriptorContent/sap.card/type}  === \'Analytical\' ? false : true}"><HBox  id="insightsCopyOverflowInnerHBox" class="insightsCardOverflowLayer insightsPreviewOverLaySize"/></HBox></VBox></VBox></FlexBox></Page></mvc:View>',
	"sap/insights/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.insights","type":"library","embeds":[],"applicationVersion":{"version":"1.111.0"},"title":"SAP UI library: sap.insights","description":"SAP UI library: sap.insights","ach":"CA-FLP-EXT-INS","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.111","libs":{"sap.ui.core":{"minVersion":"1.111.0"},"sap.viz":{"minVersion":"1.111.0","lazy":true},"sap.m":{"minVersion":"1.111.0","lazy":true},"sap.ui.integration":{"minVersion":"1.111.0","lazy":true},"sap.f":{"minVersion":"1.111.0","lazy":true},"sap.ui.layout":{"minVersion":"1.111.0","lazy":true}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":[],"interfaces":[]}}}}',
	"sap/insights/preview/Preview.view.xml":'<mvc:View displayBlock="true" controllerName="sap.insights.preview.Preview" xmlns="sap.m" xmlns:w="sap.ui.integration.widgets" xmlns:mvc="sap.ui.core.mvc" id="previewView"><Dialog id="previewDialog" title="{i18n>INT_PREVIEW_POPOVER_BUTTON_TITLE}" resizable="true" contentWidth= "352px" draggable="true"><content><VBox class="sapUiSmallMargin"><w:Card id="insightsCard" manifest="{cardPreviewModel>/descriptor}" width="100%" height="500px" manifestApplied="._onCardManifestApplied($event)"/><Label id="labelTitle" class="sapUiTinyMarginTop" text="{i18n>INT_Preview_TitleField_Label}" required="true" labelFor="titleTextInput"/><Input id="titleTextInput" change=".handleTitleChange" value="{cardPreviewModel>/descriptor/sap.card/header/title}" /><Label id="labelSubTitle" text="{i18n>INT_Preview_SubTitleTitleField_Label}" class="sapUiTinyMarginTop" labelFor="subTitleTextInput"/><Input id="subTitleTextInput" change=".handleSubTitleChange" value="{cardPreviewModel>/descriptor/sap.card/header/subTitle}"/></VBox></content><buttons><Button text="{i18n>INT_DIALOG_Ok}" type="Emphasized" press=".save" enabled="{= ${cardPreviewModel>/bAddButton} ? true : false}"/><Button text="{i18n>INT_DIALOG_CANCEL}" press=".cancel" /><Button text="{i18n>INT_SELECTION_DIALOG_OPEN}" press=".showCardSelectionDialog" /></buttons></Dialog></mvc:View>',
	"sap/insights/selection/CardList.fragment.xml":'<core:FragmentDefinition xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:dnd="sap.ui.core.dnd"\n    xmlns:l="sap.ui.layout"\n    xmlns:f="sap.f"\n    xmlns:w="sap.ui.integration.widgets"><Page id="insightCardPage" showHeader="false" backgroundDesign="List" enableScrolling="false"><FlexBox id="flexContainerCardsContent" class="flexContainerCards" alignItems="Start" justifyContent="Start" height="100%" width="100%" direction="Column"><VBox id="insightCardMessageVBox" alignItems="Start" width="calc(100% - 2rem)" class="sapUiSmallMarginTop sapUiSmallMarginBegin" visible="{= ${view>/cardCount} === 0 ? false : true}"><MessageStrip id="insightMaxCardMsg" text="{i18n>insightMaxCardText}" type="Warning" showIcon="true" visible="{= ${view>/visibleCardCount} &gt; 9 ? true : false}"/><Text id="insightCardText" text="{i18n>insightCardTabText}" class="sapUiSmallMarginTop" textAlign="Start"  width="100%" visible="{= (${view>/visibleCardCount} &lt; 10 &amp;&amp; ${view>/cards/length} &gt; 0) ? true : false}"/><HBox id="insightCardMessageHBox" class="sapUiTinyMarginTop" alignItems="Center" visible="{= ${view>/deleteAllEnabled} ? true : ${view>/DTCards/length} &gt; 0}"><Text id="insightsRefreshText" text="{i18n>refreshText}" /><Button\n                        id="insightsRefreshIcon"\n                        tooltip="{i18n>refresh}"\n                        icon="sap-icon://refresh"\n                        type="Transparent"\n                        press="refreshCardList" /></HBox></VBox><VBox id="insightCardTitleVBox" width="calc(100% - 2rem)" class="sapUiSmallMarginTop sapUiSmallMarginBegin" visible="{= ${view>/cardCount} === 0 ? false : true}"><Title id="availableInsightsCardsTitle" text="{i18n>availableCards} ({view>/visibleCardCount}/{view>/cardCount})" titleStyle="H5"/><SearchField ariaLabelledBy="availableInsightsCardsTitle" id="editInsightsSearch" liveChange=".onCardSearch" width="100%"/></VBox><FlexBox id="editInsightsCardsFlex" class="sapUiSmallMarginBegin sapUiSmallMarginTop flexContainerCards" alignItems="Start" justifyContent="Start" height="100%" width="calc(100% - 2rem)" direction="Row" visible="{= ${view>/cardCount} === 0 ? false : true}"><VBox id="insightsCardsVBox" height="100%" width="100%" justifyContent="Start" direction="Column"><ScrollContainer id="idCardsScrollContainer" vertical="true" horizontal="false" height="100%" width="100%"><Table id="insightsCardsListTable" class="sapContrastPlus" items="{path: \'view>/cards\'}"><columns><Column id="idTableCheckBoxColumn" hAlign="Center" width="10%"/><Column id="idSectionTitleColumn" width="90%"/></columns><dragDropConfig><dnd:DragInfo\n                                    id="idCardsDragInfo"\n                                    groupName="editInsightCards"\n                                    sourceAggregation="items" /><dnd:DropInfo\n                                    id="idCardsDropInfo"\n                                    groupName="editInsightCards"\n                                    targetAggregation="items"\n                                    dropPosition="On"\n                                    drop=".onEditInsightCardsDrop" /></dragDropConfig><items><ColumnListItem id="idCardsListItem" press=".handleCardListItemPress" class="insightsListItem insightsListMargin" type="Navigation"><cells><HBox><core:Icon id="editInsightsCardsDnDIcon" src="sap-icon://BusinessSuiteInAppSymbols/icon-grip" class="insightsDndIcon" /><CheckBox id="idSectionsSelect" selected="{view>visibility}" blocked="{= !${view>visibility} &amp;&amp; ${view>/visibleCardCount} === 10 ? true : false}" select=".handleCardVisibilityToggle" /></HBox></cells><cells><ObjectIdentifier id="idCardTitle" title="{view>descriptorContent/sap.card/header/title}" text="{view>descriptorContent/sap.card/header/subTitle}" tooltip="{view>descriptorContent/sap.card/header/title}"/></cells></ColumnListItem></items></Table></ScrollContainer></VBox></FlexBox><ScrollContainer id="idNoInsightsCardsScrollContainer" visible="{= ${view>/cardCount} === 0 ? true : false}" vertical="true" horizontal="false" height="100%" width="100%"><f:IllustratedMessage id="editInsightNoInsightsCardsMsg" class="sapFIllustratedMessageAlign sapFFrequentIllustratedMessageAlign sapUiMargin-24Top" illustrationSize="Auto" illustrationType="sapIllus-SimpleEmptyList" title="{i18n>editInsightsEmptyCardTitle}" description="{i18n>editInsightsEmptyCardSubTitle}"/></ScrollContainer></FlexBox></Page></core:FragmentDefinition>',
	"sap/insights/selection/CardPreview.fragment.xml":'<core:FragmentDefinition xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:l="sap.ui.layout"\n    xmlns:f="sap.f"\n    xmlns:w="sap.ui.integration.widgets"><FlexBox id="idCardsPreviewFlex" height="100%" direction="Column" class="sapUiTinyMarginBegin"><ScrollContainer id="idCardsPreviewContainer" vertical="true" horizontal="false" height="100%"><VBox id="idPreviewTitleVBox" height="100%" width="100%"><Title id="previewTitle" text="{i18n>preview}" titleStyle="H4" class="sapUiSmallMargin" /><VBox id="idCardsPreviewVBox" alignItems="Center" justifyContent="Center"><w:Card id="previewCard" manifest="{view>descriptorContent}" width="17rem" height="23.5rem" visible="{= ${view>/cards/length} === 0 ? false : true}" host="previewHost" manifestReady=".setCopyVisible(${view>descriptorContent})"/><HBox id="insightsPreviewOverflowLayer" class="sapMFlexBoxJustifyCenter" height="0" visible="{= ${view>descriptorContent/sap.card/type}  === \'Analytical\' ? false : true}"><HBox id="insightsPreviewOverflowInnerHBox" class="insightsCardOverflowLayer insightsPreviewOverLaySize"/></HBox></VBox><FlexBox id="smartForm" class="sapUiTinyMarginTop" justifyContent="Center" direction="Column" visible="{= ${view>/showCopyButton}}"/><HBox id="otherSectionHBox" direction="Column" visible="{view>/parentAppsectionVisible}"><VBox id="otherSectionTitleVBox" width="100%"><Title id="otherSectionTitle" text="{i18n>otherSectionTitle}" titleStyle="H5" class="sapUiSmallMargin" /></VBox><l:Grid\n                        id="parentAppLinkGrid"\n                        width="100%"\n                        vSpacing="0"\n                        hSpacing="1"\n                        position="Left"\n                        defaultSpan="XL6 L6 M4 S6"\n                        defaultIndent="XL0 L0 M0 S0"><VBox id="parentAppLabelVBox" width="100%" alignItems="End" class="sapUiSmallMarginEnd"><Label id="parentAppLabel" text="{i18n>parentApp}" /></VBox><VBox id="parentAppLinkVBox" width="100%"><Link id="parentAppLink" text="{view>/parentAppTitle}" ariaLabelledBy="parentAppLabel parentAppLink" wrapping="true" press=".navigateToParentApp"/></VBox></l:Grid></HBox></VBox><VBox></VBox></ScrollContainer></FlexBox></core:FragmentDefinition>',
	"sap/insights/selection/Selection.fragment.xml":'<core:FragmentDefinition xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:dnd="sap.ui.core.dnd"\n    xmlns:l="sap.ui.layout"\n    xmlns:f="sap.f"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns:w="sap.ui.integration.widgets"><NavContainer id="selectionNavCon"><core:Fragment fragmentName="sap.insights.selection.CardList" type="XML" /><Page id="previewPage" showNavButton="true" navButtonPress="onNavBack" backgroundDesign="Transparent" title="{view>/selectedCardTitle}"><headerContent><VBox direction="Row"><Button\n                            class="sapUiTinyMarginEnd"\n                            text="{i18n>delete}"\n                            press=".handleCardDeleteConfirm"/><Button\n                            text="{i18n>copy}"\n                            press=".navigateToCopyCard" visible="{= (${view>/showCopyButton} &amp;&amp; !${view>/selectionDialogOpen}) ? true : false}"/></VBox></headerContent><core:Fragment fragmentName="sap.insights.selection.CardPreview" type="XML" /></Page><mvc:XMLView viewName="sap.insights.copy.Copy" id="insightsCopyCardView" /></NavContainer></core:FragmentDefinition>',
	"sap/insights/selection/Selection.view.xml":'<mvc:View displayBlock="true" controllerName="sap.insights.selection.Selection" xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc"><core:Fragment fragmentName="sap.insights.selection.Selection" type="XML" /></mvc:View>',
	"sap/insights/selection/SelectionDialog.view.xml":'<mvc:View displayBlock="true" controllerName="sap.insights.selection.Selection" xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc"><Dialog id="insightsSelectionDialog" title="{i18n>CARD_SELECTION_DIALOG_HEADER}" contentHeight="65rem" contentWidth="32rem" verticalScrolling="false" class="sapContrastPlus" resizable="true" draggable="true"><content><core:Fragment fragmentName="sap.insights.selection.Selection" type="XML" /></content><buttons><Button id="idSectionsCancelBtn" text="{i18n>INT_DIALOG_Close}" type="Transparent" press=".closeDialog" /></buttons></Dialog></mvc:View>'
});
//# sourceMappingURL=library-preload.js.map
